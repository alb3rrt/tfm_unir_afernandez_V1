Locally accurate tensor networks for thermal states and time evolution
A´ lvaro M. Alhambra1, 2,  and J. Ignacio Cirac1, 2 1Max-Planck-Institut fu¨r Quantenoptik, Hans-Kopfermann-Straße 1, D-85748 Garching, Germany 2Munich Center for Quantum Science and Technology (MCQST), Schellingstr. 4, D-80799 Mu¨nchen, Germany
(Dated: June 3, 2021)
Tensor network methods are routinely used in approximating various equilibrium and nonequilibrium scenarios, with the algorithms requiring a small bond dimension at low enough time or inverse temperature. These approaches so far lacked a rigorous mathematical justification, since existing approximations to thermal states and time evolution demand a bond dimension growing with system size. To address this problem, we construct PEPOs that approximate, for all local observables, i) their thermal expectation values and ii) their Heisenberg time evolution. The bond dimension required does not depend on system size, but only on the temperature or time. We also show how these can be used to approximate thermal correlation functions and expectation values in quantum quenches.

arXiv:2106.00710v1 [quant-ph] 1 Jun 2021

I. INTRODUCTION
The classical simulation of quantum many-body systems is an important challenge for many different fields, including condensed matter physics, quantum chemistry, quantum information and high energy physics. Approximating generic settings efficiently is widely believed to be impossible, due to the exponential growth of the Hilbert space dimension with the system size. However, many situations of interest do not occur on generic regions of the Hilbert space, but are rather confined to the "physical corner" of it . This can then be covered by appropriate variational ans¨atze, with tensor networks being the most prominent example.
Indeed, tensor network methods based on the DMRG algorithm [1] are routinely used for the simulation of many important physical situations. Most prominently, they are used for low energy properties in one and even two dimensions, with great success [2]. They are also widely used in the approximation of finite temperature phenomena [3­13], and in the simulation of dynamics [8, 14­25] for short times. This allows for the computation of properties on large system sizes in many situations of interest.
These methods are supported by a series of mathematically rigorous results. For ground states, it is known that ground states of gapped models in 1d have good matrix product state (MPS) approximations [26­28], and that these approximations can be found efficiently with explicit algorithms [29­31] (see [32, 33] for current progress in two dimensions). For thermal states, it is known that they can be approximated in any dimension by tensor networks if  is not too large [34­37]. Similar results are also known for the unitary time evolution at short times e-itH [37­39]. All of these previous works aim at approximating the whole ground state, thermal state or unitary, respectively. This can be achieved with a bond dimension that grows with system size.
 alvaro.alhambra@mpq.mpg.de

However, for many physical applications, such as calculating local order parameters, one does not necessarily require a full global approximation, but just a tensor network that describes the relevant local properties well. The success of existing numerical implementations suggests that a much smaller bond dimension, independent of system size, is required in this case.
This problem has been previously explored for ground states: that such local approximations exist in 1d gapped models has been shown in a mathematically rigorous way. First, with matrix product operators (MPOs) [40, 41] and more recently with MPS [42­44], as well as with projected entangled pairs (PEPS) for 2D ground states with an area law [43, 44] (see [45] for a perspective). For thermal states and time evolution, previous results indicate that it is possible to simulate specific local properties in an efficient way [36, 39]. However, it was previously not known whether there exist particular tensor networks that approximate all the local properties of a system with a bond dimension independent of system size.
Here we address this question, by constructing tensor networks with a provably small bond dimension that approximate, for any local operator A and in any spatial dimension:

· Thermal expectation values

A   Tr

A e-H
Z

.

· The Heisenberg time evolution e-itH Ae-itH .

By linearity, they also approximate extensive sums of lo-

cal

observables

A

=

1 N

N x=0

Ax.

The results hold for

Hamiltonians H that are short-ranged, but not neces-

sarily translation-invariant. The bond dimension has a

similar dependence on  and t as previous global approx-

imations, but it now does not grow with system size.

We achieve this with the aid of previous results on

global approximations [34­38], combined with ideas that

allow us to exploit the locality of the problem. For ther-

mal states, this is the principle usually known as the local

indistinguishability [36, 46­48], which relies on the clus-

tering of correlations [48, 49]. For time evolution it is

the Lieb-Robinson bound [50, 51]. We also introduce a

2

tensor network construction of a linear map that outputs different PEPO approximations for the unitary dynamics of local operators depending on their support, which may be of independent interest.
We then show how results allow us to compute quantities of interest. We focus on approximations to autocorrelation functions (such as current operators in transport problems [52­58]), and the time evolution of local expectation values in quantum quenches [21, 25, 59­ 61]. These two are particularly relevant to current experiments in quantum simulation platforms such as cold atoms, superconducting qubits or trapped ions, since they are some of the most easily measurable and informative quantities.
The paper is structured as follows. First, we explain the definitions and the setting in Sec. II. Then, we show our result for local thermal states in Sec. III, and for time evolution in Sec. IV. We explain the impact of our results for correlation functions and quantum quenches in V, and conclude. The technical proofs and some further background are placed in the Appendices.

{v}  V as [35, 63, 65]

MD =

Xv(ev1 ),...,(evz (v)),

(2)

:E{1,...,D} vV

where Xv(ev1 ),...,(evz(v)) is an operator acting on vertex v, z(v) is its degree and ev1, ..., evz(v) are the vertices going through it. See [35, 63] for more detailed descriptions.
We also introduce the notion of a PEPO map, which appears in one of our main results (Result 3). This is a linear map M(A) that takes a PEPO A as an input, and outputs another PEPO with a potentially larger bond dimension. Schematically, it can be understood as

()



II. SETTING AND DEFINITIONS

Throughout this work, the notions of approximation used are in terms of closeness in 1-norm or trace norm X 1 for quantum states and their PEPO approximations [62], and the operator norm X for operators. The big-O notation indicates that a quantity f = O(n) is such that for some constant c, f  cn. O~(n) indicates polylogarithmic corrections f  cn × polylog(n), and o(n) that the scaling is strictly smaller than linear in n.
We focus on systems governed by a local Hamiltonian H = x hx with uniformly bounded, short range interactions maxx hx  h between N particles of small local dimension. The interactions have the graph structure of a d-dimensional lattice  with growth constant  and maximum degree z. We denote the small connected regions we focus on as R, which have a maximum length k, such that |R|  kd (that is, the small region can be embedded on a hypercube of length k).
The operators that approximate e-itH and e-H are MPOs and their higher-dimensional generalization PEPOs [63] which are operator generalizations of MPS and PEPS, respectively. In d = 1, an MPO MD of bond dimension D can be written simply as [3, 63, 64]

N

MD =

Tr

s1 ,s2 ,...,sn =1 s1 ,s2 ,...,sn =1

B1[s1,s1]B2[s2,s2] · · · Bn[sn,sn]

|s1, s2, . . . , sn s1, s2, . . . , sn| , (1)

where each of the matrices {Bi[si,si]}i,si,si is of dimension D × D.
On the other hand, PEPOs are defined in terms of the interaction graph with edges {e}  E and vertices

.
That is, it can be written as a product of PEPOs acting on each of the two physical indices of A, and with an additional "physical" index (in the figure, orange and dashed) that is contracted, such that M(A) = i MD(i)A(MD(i)) for some PEPOs MD(i).

III. LOCAL APPROXIMATIONS TO THERMAL STATES

We start with local approximations to thermal states.

Let R be a small region as defined in Sec. II. The local

thermal

state

is

then

Tr\R

[

e-H Z

],

and

the

marginal

of

the PEPO approximation ~k is Tr\R[~k].

A first idea to approximate the marginals could be

to simply consider a product

i

Tr\Ri

[

e-H Z

]

for

some

choice of adjacent regions {Ri}. However, this clearly

yields a large error in the regions that lie within two ad-

jacent Ri. Since we want to approximate all of them at once, we need a scheme that has no preferred partition

of the lattice {Ri}. This is possible with a uniform average over large enough partitions, and aided by local

indistinguishability.

One key assumption we need is the decay of correla-

tions

max | X  Y  - X  Y |  ||X|| ||Y || (l), (3)
X,Y

where X, Y are arbitrary observables separated by a distance l on the lattice, and (l) is a function decreasing with l.

3

The most prominent decay is exponential (l)  e-l/,

which defines the thermal correlation length . This has

been proven for translation invariant chains [49, 66], and

there is strong evidence that it holds in any 1d ther-

mal state [49, 67]. In higher dimensions it only holds

above the finite threshold temperature , as shown in

[36, 68], which also give a bound on the correlation

length. However, we can also consider the polynomial

decay

(l) 

R ld+1

for

some constant

R > 0.

This

might

correspond to the behaviour at certain thermal phase

transitions.

The decay of correlations is required to simulate local

properties without a system size dependence, since one

needs to be able to isolate them from distant regions.

This is only possible if the correlations decay sufficiently

fast, so that regions of width  O() can be approxi-

mated independently of the rest.

With this, we now show the main result of this section.

Result 1. There is an explicit construction of a PEPO ~k such that for any region R on the lattice  it locally approximates the thermal state

e-H

||Tr\R[ Z ] - Tr\R[~k]||1  .

(4)

The bond dimension is bounded as follows.

· For d = 1, assuming correlations decay exponentially, it is a MPO with bond dimension

k+

D

(5)

× exp O~

max{,

k+  log( 2 )}

,

which is quasilinear in (k + )/ for any  O(1).

· In higher dimensions d > 1 and at high temperature     log (1 + 1 + 4/)/2 /2h the bond dimension is

kd d2d()d2

O(d)

D  C d max 2 , d+1

, (6)

where C is constant and the correlation length is ()  log[e2h(e2h - 1)] -1 .

· For lower temperatures, if the correlations decay poly-

nomially

(l)



, R
ld+1

D

is

bounded

as

in

Eq.(5),

(6)

but replacing d with R.

The bond dimension in both cases grows with k, ,  and -1, as expected. This result implies a good approx-
imation in any local expectation value, since ||Tr\R[] - Tr\R[]||1 = maxsupp(A)R, A =1 Tr [A( - )].
The proof is shown in Appendix B. It draws inspi-
ration from previous results on local approximations of

pure states [40­43]. The PEPO here is the uniform av-

erage of tensor products of approximations to local ther-

mal states. These lie on consecutive hypercubes of a given size l0d, which span the whole lattice. The average is taken over all the different l0d partitions of the lattice (that is, the different displacements of a given partition

into hypercubes, see Fig. 1).

Each of the PEPOs on the hypercubes approximates

Tr\R[

e-H Z

]

well

for

a

given

partition

provided

that

R

is far from the boundary between adjacent hypercubes.

That this happens for most partitions is guaranteed by a

result from [48], which shows that any local marginal of

a thermal state does not depend on the regions far away

from it (here how "far away" is determined by the ther-

mal correlation length). This is exactly the idea behind

local indistinguishability [48], and the related concept of

locality of temperature [36, 69­72], which states that i)

subsystems of thermal states of quantum Hamiltonians

are robust to distant perturbations and that ii) they are

close to the marginals of the thermal state of their vicin-

ity (see [36] for further discussions on this idea).

The smaller PEPOs within the hypercubes can then

be taken to be any of the existing global approximations

to thermal states. The current best estimates are given

in [37] for 1d, which is D  exp(O  log(l0/ ) ) and

in [35] for higher dimensions, which is D 

l0d

O(d)
.

In the proof, one has to choose l0 small to keep the bond dimension controlled, but still large enough such that the error from the local indistinguishability estimate is O( ). This leads to Eq. (5) (by choosing l0  k+ ) and Eq. (6) (by choosing l0  max{k -d, dd }).
Let us comment on the algorithmic implications of Result 1. To build the MPO/PEPO here one just needs to construct them as given by the prescriptions of [37] and [35] respectively. In [37], the 1-dimensional approximation is defined as a product of the Taylor expansion of operators e-Hj , where Hj is the Hamiltonian in a small region. Similar algorithms have already appeared in the literature [10, 11]. In [35], the higher dimensional approximation is based on a linked cluster expansion [34], which can in principle also be implemented numerically [73]. Standard MPO/PEPO results [2, 63] guarantee that these approximations can be computed via an algorithm with run-time poly (D, N ).

IV. LOCAL APPROXIMATIONS TO TIME EVOLUTION
We now focus on efficient approximations to the Heisenberg time evolution e-itH Ae-itH . The existing results on global approximations [35­38] show that the bond dimension of a PEPO M t that approximates
e-itH - M t  must grow with system size. We again drop this dependence when our target is the Heisenberg evolution of local operators.

4

To simulate this evolution, the first idea could be to simply reduce the problem to simulating the LiebRobinson lightcone, which only requires a unitary in a region of size  O(vLRt + log( -1)), with vLR is the Lieb-Robinson velocity. While this can be done with a bond dimension independent of system size, as previously pointed in [39], it would only be a good approximation for observables in a specific small region.
Here we show how this idea can be pushed further in order to build a single tensor network that approximates the Lieb-Robinson lightcone of any local operator. The statements for one and higher dimensions differ significantly, and are presented separately.

A. One dimension

In one dimension, our main result essentially shows that the previous global approximation scheme from [38] simulates well any Lieb-Robinson lightcone, and that in order to do so one only requires a bond dimension depending on the size of the lightcone, and not on N . The result is as follows.

Result 2. For any operator A with support on a small region R, the Heisenberg time evolution is well approximated as

||e-itH Ae-itH - MktA(M t)k||  3 ||A||,

(7)

where Mkt is an MPO with bond dimension

D  eO(|t|) × poly k + vLRt + log 1 .

(8)

That is, the bond dimension scales polynomially in k, -1 with a constant degree, and exponentially in time, which is consistent with the expected linear growth in entanglement along a generic time evolution [74­76]. The numerator in the polynomial of Eq. (8) corresponds to the size of the light-cone that needs to be approximated.
The proof is shown in Appendix C 1. The construction is that of [38], which shows that e-itH can be approximated by a quantum circuit of depth two, in which the size of the gates grows with t, -1 and system size N . To drop the system size dependence we give an argument based on the Lieb-Robinson bound which shows that to simulate the ligh-cone of A one just needs to approximate the effective region of size  O(vLRt + log( -1)). The important point is that this can be done such that the same MPO simulates the lightcone of any local operator. For the argument to hold, it is crucial that the MPO of [38] is a depth-2 quantum circuit, which is impossible in higher dimensions [77].
This MPO can also be implemented in practice [39], following the explicit construction of [38], which consists on the subsequent application of two local Hamiltonian evolutions. Thus, Result 2 also guarantees an efficient 1d algorithm for short times. The result naturally extends

to the simulation of any extensive sum of local operators by linearity.
The exponential scaling in time originates from the error in the Lieb-Robinson bound. For systems with different lightcones, the growth in the bond dimension may be much smaller. For instance, many-body localized systems with a "zero velocity" Lieb-Robinson bound  te-l [78, 79] can instead be approximated with a bond dimension growing polynomially in time [39].

B. Higher dimensions

For higher dimensions, we resort to the idea in Sec. III of using partitions of the lattice into hypercubes of length l0. The simple approach taken here is to first show that e-itH AeitH is close to the evolution of an effective Hamiltonian in the hypercube, and then approximate that effective evolution with a PEPO of small bond dimension. This PEPO can be constructed with the cluster expansion results from [35, 36], adapted to real time evolution (as described in Appendix A 2). The bond dimension of each of these is Dl0  exp O |t| log |t|l0d .
The approximation is then accurate if i) the hypercube is large enough and ii) A is sufficiently far away from the boundary between hypercubes. However, to construct a scheme that applies to local operators A in any region, we need a tensor network that implements the approximation of a hypercubes conditioned on the support of A. This conditioning requires something more involved than just acting with a single PEPO and its adjoint: a tensor map as described in Sec. II. In Appendix C 2 we construct a map that implements a PEPO Mp among a possible list as MpAMp, where Mp is determined by the region R that supports A. Since the map is linear, it can also act on extensive sums of local operators.
Given that there are l0d possible partitions into hypercubes, we show that this can be done with a tensor network of bond dimension O(l03dDl20 ). Choosing l0 = O~ k + vLRt + log 1 then yields the following result.

Result 3. For any operator A with support on a small region R, the Heisenberg time evolution is well approximated as

||e-itH Ae-itH - Mtk(A)||  3 ||A||,

(9)

where Mtk(·) is a linear PEPO map. If A is a product of Pauli matrices, the map has bond dimension

D  O d|t| k + vLRt + log 1/

O(|t|d)
.

(10)

whereas for arbitrary A the bond dimension is

DO

d|t|4k vLRt + k(1 + log 4/ )

O(|t|d)
.

(11)

5

The proof is shown in C 2, where we also explain how to construct the tensor network that applies a given PEPO conditioned on the support of the input A. This construction of a tensor network map that acts differently depending on some feature of the input (here, the nontrivial support of the observable) has, as far as we know, not previously appeared in the literature. We believe that this or similar schemes have the potential for further applications.

V. APPLICATIONS
Our results apply to a wide range of physical situations. For instance, Result 1 directly shows that it is possible to compute local thermal averages of arbitrary local operators, such as the energy or average magnetization. They can, however, also be used to guarantee approximations of more complex objects. We now elaborate on two of them.

A. Correlation functions

A quantity that appears in many relevant situations, mostly pertaining to linear response theory [80], is the 2-point correlation function

A(t)A  = Tr

e-H e-itH Ae-itH A Z

,

(12)

where A is often taken to be an extensive operator. By

this, we mean that it has uniform support throughout

the

lattice as

A

=

1 N

x Ax  I\x, where each term

has bounded norm Ax  A and acts on at most k

consecutive sites. This is the central object in various ar-

eas of quantum dynamics, such as the study of quantum

transport, for which A is taken to be a current operator

[58] of the relevant conserved quantities.

In the next result, we show how our constructions serve

to approximate it. We focus in the one dimensional case,

for which we again assume that Eq. (3) holds with an

exponential decay. In higher dimensions Eq. (12) in-

volves a contraction which is typically computationally

hard [81, 82] (although this is potentially not a problem

in physically relevant contexts, see [47]). The result is as

follows.

Result 4. The correlation function of an extensive observable A in one dimension can be approximated as
| Tr ~k MktA(Mkt)A - A(t)A |  14 A 2 , (13)
where k = O  log 1 + vLRt + k , and the operators ~k and Mkt are as defined in Results 1 and 2.
The proof is shown in Appendix D. In simple terms, Result 4 implies that A(t)A  can well be approximated

by a contraction of MPOs of bond dimension at most

D  eO(|t|) × poly k + vLRt +  log 1 .

(14)

The biggest drawback of this result is the fast growth in time t, which is nevertheless expected in general. This does not necessarily prevent the algorithms from reaching interesting timescales [83], and is likely an overestimation for many important situations at late times. Nevertheless, we believe that this result mathematically justifies the success of previous tensor network approaches to computing correlation functions [52­58].

B. Quantum quenches

In quantum quenches, one starts with a pure initial state | . This is often an easy-to-prepare state, such as a ground state of a gapped model, or a product state. Then, the Hamiltonian is suddenly switched to some arbitrary H, and the subsequent time evolution is tracked through expectation values of local observables A(t)  | A(t) | . This time evolution can be simulated with the results in Sec. IV, which give an upper bound on the bond dimension required (e.g. Eq. (8)).
This upper bound, however, grows very fast with time, and may become too large at relevant timescales such as the thermalization or Thouless times [84]. This is so even if the local marginals of the evolved state are simply described by a thermal state or a GGE, which depends on very few parameters. In those cases, it is expected that local evolution at late times can also be approximated with a small bond dimension [59, 60, 85­87].
One of the main results of [42] (applicable in 1d) can help in this setting: the local marginals of any state |(t) on k sites can be approximated with an MPS | with bond dimension D  exp (k/ ). One can then potentially simulate A(t) in 1d with a bond dimension

D  min eO(|t|) × poly

k + vLRt + log 1

k
,e

.

(15) It is not clear whether an efficient algorithm to find | exists [42]. However, numerical schemes for approximating A(t) at long times with low bond dimension have already been devised [59, 60].

VI. CONCLUSIONS
We have shown how to construct tensor network representations of thermal states and time evolution, in a way that local observables are well approximated. This allows us to provably achieve a bond dimension independent of system size in all cases, which contrasts with what is achieved by previous global approximations. These results have implications on the tensor network simulation

6

of various equilibrium and out of equilibrium situations, and help to mathematically justify the success of previous numerical results.
Since they hold for any local Hamiltonian, and any timescale and temperature, they are likely not tight in particular cases of interest. For instance, when simulating the long time dynamics of a system that has already thermalized, it seems likely that only a much smaller bond dimension (perhaps independent of time) is required. This intuition is present in previous specific algorithms [59, 60].
In all of the proofs, except for Result 2, the construction involved an average over "local approximations", which we expect to be unnecessary in practice. This also applies to previous results for ground state approximations [28, 41­43]. It would be interesting to find arguments to circumvent this proof idea, perhaps akin to the

proof of Result 2 or to other features such as the Markov property of thermal states [88, 89]. This would significantly improve the result for one dimensional thermal states, for which it the bond dimension needed is likely sub-linear in k, , -1. It may also be possible to obtain a better higher dimensional generalization of Result 2 that does not require a tensor map, as Result 3 does.
ACKNOWLEDGMENTS
The authors acknowledge funding from the Alexander von Humboldt Foundation and from ERC Advanced Grant QUENOCOBA under the EU Horizon 2020 program (Grant Agreement No. 742102) and within the D-ACH Lead-Agency Agreement through project No. 414325145 (BEYOND C).

[1] S. R. White, Phys. Rev. Lett. 69, 2863 (1992). [2] U. Schollwo¨ck, Annals of Physics 326, 96­192 (2011). [3] F. Verstraete, J. J. Garc´ia-Ripoll, and J. I. Cirac,
Physical Review Letters 93 (2004), 10.1103/physrevlett.93.207204. [4] R. Oru´s and G. Vidal, Physical Review B 78 (2008), 10.1103/physrevb.78.155117. [5] S. R. White, Physical Review Letters 102 (2009), 10.1103/physrevlett.102.190601. [6] E. M. Stoudenmire and S. R. White, New Journal of Physics 12, 055026 (2010). [7] W. Li, S.-J. Ran, S.-S. Gong, Y. Zhao, B. Xi, F. Ye, and G. Su, Physical Review Letters 106 (2011), 10.1103/physrevlett.106.127202. [8] M. Binder and T. Barthel, Physical Review B 92 (2015), 10.1103/physrevb.92.125119. [9] P. Czarnik and J. Dziarmaga, Physical Review B 92 (2015), 10.1103/physrevb.92.035152. [10] B.-B. Chen, Y.-J. Liu, Z. Chen, and W. Li, Physical Review B 95 (2017), 10.1103/physrevb.95.161104. [11] B.-B. Chen, L. Chen, Z. Chen, W. Li, and A. Weichselbaum, Physical Review X 8 (2018), 10.1103/physrevx.8.031082. [12] A. Kshetrimayum, M. Rizzi, J. Eisert, and R. Oru´s, Physical Review Letters 122 (2019), 10.1103/physrevlett.122.070502. [13] C.-M. Chung and U. Schollwo¨ck, "Minimally entangled typical thermal states with auxiliary matrix-productstate bases," (2019), arXiv:1910.03329 [cond-mat.str-el]. [14] A. J. Daley, C. Kollath, U. Schollwo¨ck, and G. Vidal, Journal of Statistical Mechanics: Theory and Experiment 2004, P04005 (2004). [15] A. E. Feiguin and S. R. White, Physical Review B 72 (2005), 10.1103/physrevb.72.020404. [16] S. R. Manmana, AIP Conference Proceedings (2005), 10.1063/1.2080353. [17] J. J. Garc´ia-Ripoll, New Journal of Physics 8, 305­305 (2006). [18] G. Vidal, Physical Review Letters 98 (2007), 10.1103/physrevlett.98.070201.

[19] J. Haegeman, J. I. Cirac, T. J. Osborne, I. Pizorn, H. Verschelde, and F. Verstraete, Physical Review Letters 107 (2011), 10.1103/physrevlett.107.070601.
[20] M. L. Wall and L. D. Carr, New Journal of Physics 14, 125015 (2012).
[21] C. Karrasch, J. E. Moore, and F. HeidrichMeisner, Physical Review B 89 (2014), 10.1103/physrevb.89.075139.
[22] M. P. Zaletel, R. S. K. Mong, C. Karrasch, J. E. Moore, and F. Pollmann, Physical Review B 91 (2015), 10.1103/physrevb.91.165112.
[23] J. Haegeman, C. Lubich, I. Oseledets, B. Vandereycken, and F. Verstraete, Physical Review B 94 (2016), 10.1103/physrevb.94.165116.
[24] E. Ronca, Z. Li, C. A. Jimenez-Hoyos, and G. K.-L. Chan, Journal of Chemical Theory and Computation 13, 5560­5571 (2017).
[25] S. Paeckel, T. Ko¨hler, A. Swoboda, S. R. Manmana, U. Schollwo¨ck, and C. Hubig, Annals of Physics 411, 167998 (2019).
[26] M. B. Hastings, Journal of Statistical Mechanics: Theory and Experiment 2007, P08024­P08024 (2007).
[27] I. Arad, A. Kitaev, Z. Landau, and U. Vazirani, "An area law and sub-exponential algorithm for 1d systems," (2013), arXiv:1301.1162 [quant-ph].
[28] Y. Huang, "Area law in one dimension: Degenerate ground states and renyi entanglement entropy," (2015), arXiv:1403.0327 [cond-mat.str-el].
[29] Z. Landau, U. Vazirani, and T. Vidick, Nature Physics 11, 566 (2015).
[30] Y. Huang, "A polynomial-time algorithm for the ground state of one-dimensional gapped hamiltonians," (2015), arXiv:1406.6355 [cond-mat.str-el].
[31] C. T. Chubb and S. T. Flammia, Chicago Journal of Theoretical Computer Science 22, 1­35 (2016).
[32] N. d. Beaudrap, T. J. Osborne, and J. Eisert, New Journal of Physics 12, 095007 (2010).
[33] A. Anshu, I. Arad, and D. Gosset, "An area law for 2d frustration-free spin systems," (2021), arXiv:2103.02492 [quant-ph].

7

[34] M. B. Hastings, Physical Review B 73 (2006), 10.1103/physrevb.73.085115.
[35] A. Molnar, N. Schuch, F. Verstraete, and J. I. Cirac, Physical Review B 91 (2015), 10.1103/physrevb.91.045138.
[36] M. Kliesch, C. Gogolin, M. Kastoryano, A. Riera, and J. Eisert, Physical Review X 4 (2014), 10.1103/physrevx.4.031019.
[37] T. Kuwahara, A. M. Alhambra, and A. Anshu, Physical Review X 11 (2021), 10.1103/physrevx.11.011047.
[38] T. J. Osborne, Physical Review Letters 97 (2006), 10.1103/physrevlett.97.157202.
[39] M. B. Hastings, Physical Review B 77 (2008), 10.1103/physrevb.77.144302.
[40] Y. Huang, "Computing energy density in one dimension," (2015), arXiv:1505.00772 [cond-mat.str-el].
[41] N. Schuch and F. Verstraete, "Matrix product state approximations for infinite systems," (2017), arXiv:1711.06559 [cond-mat.str-el].
[42] A. M. Dalzell and F. G. S. L. Branda~o, Quantum 3, 187 (2019).
[43] Y. Huang, "Approximating local properties by tensor network states with constant bond dimension," (2019), arXiv:1903.10048 [quant-ph].
[44] Y. Huang, "Computing local properties in the trivial phase," (2020), arXiv:2001.10763 [cond-mat.str-el].
[45] Y. Huang, Quantum Views 3, 26 (2019). [46] S. Michalakis and J. P. Zwolak, Communications in
Mathematical Physics 322, 277­302 (2013). [47] M. Schwarz, O. Buerschaper, and J. Eisert, Physical
Review A 95 (2017), 10.1103/physreva.95.060102. [48] F. G. S. L. Branda~o and M. J. Kastoryano, Communica-
tions in Mathematical Physics 365, 1 (2019). [49] A. Bluhm, A´ ngela Capel, and A. P´erez-Herna´ndez, "Ex-
ponential decay of mutual information for gibbs states of local hamiltonians," (2021), arXiv:2104.04419 [quantph]. [50] E. H. Lieb and D. W. Robinson, in Statistical mechanics (Springer, 1972) pp. 425­431. [51] S. Bravyi, M. B. Hastings, and F. Verstraete, Physical Review Letters 97 (2006), 10.1103/physrevlett.97.050401. [52] T. Barthel, U. Schollwo¨ck, and S. R. White, Physical Review B 79 (2009), 10.1103/physrevb.79.245101. [53] C. Karrasch, J. H. Bardarson, and J. E. Moore, Physical Review Letters 108 (2012), 10.1103/physrevlett.108.227206. [54] C. Karrasch, J. H. Bardarson, and J. E. Moore, New Journal of Physics 15, 083031 (2013). [55] T. Barthel, New Journal of Physics 15, 073010 (2013). [56] A. C. Tiegel, S. R. Manmana, T. Pruschke, and A. Honecker, Physical Review B 90 (2014), 10.1103/physrevb.90.060406. [57] C. Karrasch, D. M. Kennes, and F. HeidrichMeisner, Physical Review B 91 (2015), 10.1103/physrevb.91.115130. [58] B. Bertini, F. Heidrich-Meisner, C. Karrasch, T. Prosen, R. Steinigeweg, and M. Znidaric, "Finite-temperature transport in one-dimensional quantum lattice models," (2020), arXiv:2003.03334 [cond-mat.str-el]. [59] C. D. White, M. Zaletel, R. S. K. Mong, and G. Refael, Physical Review B 97 (2018), 10.1103/physrevb.97.035127.

[60] E. Leviatan, F. Pollmann, J. H. Bardarson, D. A. Huse, and E. Altman, "Quantum thermalization dynamics with matrix-product states," (2017), arXiv:1702.08894 [condmat.stat-mech].
[61] B. Kloss, Y. B. Lev, and D. Reichman, Physical Review B 97 (2018), 10.1103/physrevb.97.024307.
[62] A. Gilchrist, N. K. Langford, and M. A. Nielsen, Physical Review A 71 (2005), 10.1103/physreva.71.062310.
[63] B. Pirvu, V. Murg, J. I. Cirac, and F. Verstraete, New Journal of Physics 12, 025012 (2010).
[64] M. Zwolak and G. Vidal, Physical Review Letters 93 (2004), 10.1103/physrevlett.93.207205.
[65] F. Verstraete and J. I. Cirac, (2004), arXiv:0407066. [66] H. Araki, Communications in Mathematical Physics 14,
120 (1969). [67] A. W. Harrow, S. Mehraban, and M. Soleimanifar,
Proceedings of the 52nd Annual ACM SIGACT Symposium on Theory of Computing (2020), 10.1145/3357713.3384322. [68] J. Fro¨hlich and D. Ueltschi, Journal of Mathematical Physics 56, 053302 (2015). [69] M. Hartmann, Contemporary Physics 47, 89­102 (2006). [70] A. Ferraro, A. Garc´ia-Saez, and A. Ac´in, EPL (Europhysics Letters) 98, 10009 (2012). [71] S. Herna´ndez-Santana, A. Riera, K. V. Hovhannisyan, M. Perarnau-Llobet, L. Tagliacozzo, and A. Ac´in, New Journal of Physics 17, 085007 (2015). [72] S. H. Santana, A. Molnar, C. Gogolin, J. I. Cirac, and A. Ac´in, "Locality of temperature and correlations in the presence of non-zero-temperature phase transitions," (2020), arXiv:2010.15256 [quant-ph]. [73] M. Rigol, T. Bryant, and R. R. P. Singh, Physical Review Letters 97 (2006), 10.1103/physrevlett.97.187202. [74] S. Bravyi, Physical Review A 76 (2007), 10.1103/physreva.76.052319. [75] J. Eisert and T. J. Osborne, Physical Review Letters 97 (2006), 10.1103/physrevlett.97.150404. [76] M. Mari¨en, K. M. Audenaert, K. Van Acoleyen, and F. Verstraete, Communications in Mathematical Physics 346, 35 (2016). [77] J. Haah, M. B. Hastings, R. Kothari, and G. H. Low, SIAM Journal on Computing , FOCS18­250­FOCS18­284 (2021). [78] C. K. Burrell and T. J. Osborne, Physical Review Letters 99 (2007), 10.1103/physrevlett.99.167201. [79] E. Hamza, R. Sims, and G. Stolz, Communications in Mathematical Physics 315, 215­239 (2012). [80] R. Kubo, Journal of the Physical Society of Japan 12, 570 (1957), https://doi.org/10.1143/JPSJ.12.570. [81] N. Schuch, M. M. Wolf, F. Verstraete, and J. I. Cirac, Physical Review Letters 98 (2007), 10.1103/physrevlett.98.140506. [82] J. Haferkamp, D. Hangleiter, J. Eisert, and M. Gluza, Physical Review Research 2 (2020), 10.1103/physrevresearch.2.013010. [83] A. M. Alhambra, J. Riddell, and L. P. Garc´ia-Pintos, Physical Review Letters 124 (2020), 10.1103/physrevlett.124.110605. [84] L. D'Alessio, Y. Kafri, A. Polkovnikov, and M. Rigol, Advances in Physics 65, 239­362 (2016). [85] M. Berta, F. G. S. L. Brand~ao, J. Haegeman, V. B. Scholz, and F. Verstraete, Physical Review B 98 (2018), 10.1103/physrevb.98.235154.

8

[86] S. Xu and B. Swingle, Nature Physics 16, 199­204 (2019).
[87] A. Hallam, J. G. Morley, and A. G. Green, Nature Communications 10 (2019), 10.1038/s41467-019-10336-4.
[88] K. Kato and F. G. S. L. Brand~ao, Communications in Mathematical Physics 370, 117­149 (2019).

[89] T. Kuwahara, K. Kato, and F. G. Branda~o, Physical Review Letters 124 (2020), 10.1103/physrevlett.124.220601.
[90] M. B. Hastings, Physical Review B 76 (2007), 10.1103/physrevb.76.201102.

Appendix A: Review of the cluster expansion approximation to thermal and real time evolution in arbitrary dimension
We briefly review the main result of [35], which provides PEPO approximations for global thermal states in arbitrary spatial dimensions via the cluster expansion [34, 36]. We then explain how an analogous statement holds for the operator eitH .

1. Thermal state at any temperature

Let us recall the definitions from Sec. II: H = x hx is a k-local Hamiltonian on an arbitrary d-dimensional lattice, with up to K  N terms, and such that maxx ||hx||  h  O(1), and the interaction graph has degree at most z. We also define the lattice growth constant as .
It was shown in [34] that there exists an operator ~, defined as a cluster expansion approximation (see [36] for
a detailed proof), which is a good approximation to the thermal state for high temperatures. The statement is as follows. Let  be a constant such that e(2z-1)h(eh - 1) < 1 (that is,   1/hd). If    , then

||e-H - ~||1  ||e-H ||1

xL exp K
1-x

-1

,

(A1)

where x  e(2z-1)h(eh - 1) < 1. Here, L is a free parameter that determines the size of the clusters in the

approximation.

Importantly, Eq.

A1 also holds for the norm ||...||2M

if we change the temperature to 

=

 2M

,

such

that

||e-

 2M

H

- ~||2M



||e-

 2M

H

||2M

exp

xL K
1-x

-1 ,

(A2)

with x





e(2z

-1)

h 2M

h
(e 2M

- 1) < 1.

Then, Proposition 1 in [35] allows us to approximate the thermal state at any

temperature.

Proposition 1. If < 1/3 and

it follows that

||e-

 2M

H

- ~||2M



M

||e-

 2M

H

||2M

(A3)

||e-H - (~~)2M ||1  M ||e-H ||1.

(A4)

To choose an -close approximation in 1-norm at any temperature, we need to set M large enough such that

 2M







1 hd

,

which

amounts

to

M

=

O(hd).

Then,

for

large

L

the

error

in

Eq.

(A2)

is

xL

exp K

-1

1-x

Kx L(1 - x )-1,

(A5)

where x = O(1). That is, we need to set L = O log KM = O log Nd .
Moreover, it was shown in [35] that ~ is a PEPO with bond dimension D  eL, and thus (~~)2M has D  e2ML. We conclude that to achieve an error one requires a bond dimension

D  eO(d log dN ).

(A6)

9

2. Real time evolution

It can be easily seen that the proof of Eq. (A1) from [36], and the cluster expansion analysis, also hold for an approximation of e-itH in operator norm, simply if one substitutes  with |t|. This just follows from the observation
that all the steps in the proof of [36] remain unchanged if one changes all the norms to operator norms, and that there is no further fundamental differences between the operators e-H and e-itH . In the same way, one also has the
analogue of Proposition 1 for operator norms, which allows us to extend the approximation for arbitrarily long times. From this observations we conclude that there exists an PEPO U~t with bond dimension D such that

||e-itH - U~t|| 

(A7)

and

D  eO(|t|d log |t|dN ).

(A8)

Appendix B: Local approximations to thermal states

Here we show the main result regarding local approximations to thermal states. First, we need the following key assumption for the thermal state  = e-H /Z.

Definition 1 (Clustering of correlations). The state  on a lattice system has (l)-clustering of correlations if

max |Tr [X  Y ] - Tr [X] Tr [Y ]|  ||X|| ||Y || (l),
X,Y

(B1)

where M has support of region A and N on region B, and l  dist(A, B).

The following result on local indistinguishability shows that marginals of thermal states when tracing out a big region are well approximated by the marginal of the thermal state of a much smaller lattice. This is the key ingredient to guarantee the faithfulness of local approximations.

Lemma 1. [Theorem 4, [48]] Let H be a local bounded Hamiltonian,  an inverse temperature and AB = e-H / Tr e-H . Let AB1B2 be a separation of the lattice such that B1 shields A from B2 by a distance of at
least l. Let AB1 be the Gibbs state on region AB1 only (that is, with the terms of the Hamiltonian H that have support on AB1 only). If the system has (l)-clustering of correlations, then

||TrB[AB] - TrB1 [AB1 ]||1  C|B2|((l/2) + c1e-c2l),

(B2)

where C > 0 and c1, c2 > 0 are constant and |B2| is the size of the boundary between B1 and B2.
This lemma relies on the technique of quantum belief propagation from [90], from which the contribution c1e-c2l arises. See also Theorem 4 in [36] for a similar statement at high temperatures only.
To prove the main result of the section, we need to first define the partitions Gp of the d-dimensional lattice  into hypercubes of length l0:

Gp = {(l0i),p : i(l0i),p = }

(B3)

such that |(l0i),p|  l0d. The parameter p can for instance represent one of the corners of a given hypercube, which defines the position of the boundaries of all the hypercubes, and can adopt l0d values. The hypercubes near the boundaries may have a smaller number of lattice sites. An illustration of these and the other elements of the proof is
shown in Fig. 1.
Let ((l0i),p) be the thermal state with Hamiltonian containing the terms of H with support only on (l0i),p. Each ((l0i),p) can now be approximated to /3 precision in 1-norm by an PEPO ~((l0i),p) of bond dimension Dl0 . In one dimension we have Theorem 3 in [37], which guarantees

log Dl0  O max{,  log( l0 )} × log  log( l0 ) ,

(B4)

10
(0,)

0







(0,)

FIG. 1. Schematic illustration of the idea behind the proof of the local approximations to thermal states. R is our region of
interest, and the black and red grids represent two different partitions of the lattice, so that R is at a distance l and l from each grid. The shaded regions correspond to the hypercubes (in this case, squares) (l0i),p, (l0i),p of size l0d on which R lies.

which is sub-polynomial in l0. In higher dimensions, the result from [35] described in Appendix A 1 yields Dl0  exp O d log dl0d .
We also need that each of these PEPOs has trace 1, which can be achieved with a small price in the precision as

||((l0i),p)

-

~((l0i),p) Tr ~((l0i),p)

||1



||((l0i),p)

-

~((l0i),p)||1

+

||~((l0i),p)

-

~((l0i),p) Tr ~((l0i),p)

||1





1

 + (1 + ) 1 -

 .

3

3

Tr ~((l0i),p)

(B5) (B6)

For simplicity, we will assume Tr ~((l0i),p) = 1. Now define the PEPO ~l0,p = i ~((l0i),p). Our local PEPO approximation is the uniform average over all the
partitions of the lattice into hypercubes

1 ~ = l0d p ~l0,p,

(B7)

which has bond dimension D  Dl0 × l0d. We now show this is a good approximation to the marginal of any region R   of maximum length k < l0. First, we separate the terms in the sum over p by whether R lies strictly inside

11

one of the hypercubes (l0i),p or not,

1 ||Tr\R[] - Tr\R[~]||1  l0d p ||Tr\R[] - Tr\R[~l0,p]||1

(B8)





1



l0d

 

p:R

||Tr\R[] - Tr\R[~l0,p]||1 +

||Tr\R

[]

-

Tr\R

[~l0

,p

]||1

 

(l0ip,p)

p:R(l0ip,p)





(B9)



1 l0d

2kd 

+

||Tr\R

[]

-

Tr\R

[~l0

,p

]||1

 

,

p:R(l0ip,p)

(B10)

where ip denotes the hypercube (l0ip,p) on which R lies, for a given p (see Fig. 1). Here, we just used the triangle inequality and the trivial bound || - ||1  2.
The remaining terms can be bounded with Lemma 1. For a given lattice partition p, let l be the minimum distance between R and the boundary of (l0ip,p). Then,

||Tr\R[] - Tr\R[~l0,p]||1  ||Tr\R[] - Tr(l0ip,p)\R[((l0i),p)]||1 + ||Tr(l0ip,p)\R[(l(0i),p)] - Tr\R[~l0,p]||1

(B11)

= ||Tr\R[] - Tr(l0ip,p)\R[((l0i),p)]||1 + ||Tr(l0ip,p)\R[((l0i),p)] - Tr(l0ip,p)\R[~((l0i),p)]||1 (B12)

 2Cdl0d-1((l/2) + c1e-c2l) + 3

(B13)

where in the first line we used the triangle inequality, in the second the fact that the PEPOs have trace 1 by assumption and in the third Lemma 1 (with |B2| = 2dl0d-1) and the definition of . Given that the area of a hypercube of edge l is 2dld-1,

||Tr\R[] - Tr\R[~]||1



2kd l0d

+

3

+ 2Cdl0-1

((l/2) + c1e-c2l)

p:l=dist(R, (l0i),p )



2kd l0d

+

3

(l0 -k)/2

+ 4d2Cl0-1

ld-1((l/2) + c1e-c2l).

l=0

(B14) (B15)

We now focus on the two different types of decay of the function (l/2): exponential and polynomial. Exponential: In this case (l/2)  e-l/2. This has been shown in 1d translation invariant chains [49, 66], and it is believed to hold for all 1d systems [49, 67]. It has also been shown for higher dimensional systems at high temperature
using the cluster expansion technique in [36]. There, it is shown that, given   log (1 + 1 + 4/)/2 /2h, for
every  < , it holds that

(l)



4 min{|A|, |B|} log 3(1 - e-1/())

e-l/(),

(B16)

where the correlation length is () = log[e2h(e2h - 1)] -1 . Starting from the sum in (B15), then

(l0 -k)/2



ld-1((l/2) + c1e-c2l)  (c1 + 1) ld-1exp

l=0

l=0

l -
(c2 + 2)

= O(d).

(B17)

Choosing l0 = C max{k -d, d2d } for some constant C > 0, we obtain ||Tr\R[] - Tr\R[~]||1  . The bond dimension in 1d is hence

k+

k+

k+

D

× exp O max{,  log( 2 )} × log  log( 2 ) ,

(B18)

12

which for  = O(1) is quasilinear in (k + )/ , D  C

(k+)

1+o(1)
. In higher dimensions, it is

kd d2dd2 O(d)

D  C d max{ ,

}

,

2 d+1

(B19)

which is polynomial in k and -1.

Polynomial:

Now assume (l/2) 

R ld+1

for any d (note that this assumption is likely not necessary in 1d).

Then

the following sum converges

(l0 -k)/2
ld-1((l/2) + c1e-c2l)  (R + c1)



ld-1

1 ld+1

= O(R),

l=0

l=0

(B20)

so we simply need to choose l0 = C max{k -d, dR } for some constant C > 0. The resulting bond dimension is thus the same as Eq. (B18), (B19) with d replaced with R.

Appendix C: Local approximations to time evolution
Unlike for thermal states, the proofs and statements for one and higher dimensions differ significantly, and are presented separately.

1. One dimension

This is based on the main result of [38], and also relies on the Lieb-Robinson bound [50, 51].

Lemma 2 (Lieb-Robinson bound). Let A be a local observable on k sites and H = x hx a uniformly bounded Hamiltonian with finite interaction range. Then there exist constants c, vLR  0 such that for all X with l := dist(A, Xc)  2d - 1 we have

e-itH AeitH - e-itHX AeitHX  A cld-1evLRt-l,

(C1)

where HX contains only the terms of H away from A by a distance at most l. That is

HX =

hx.

x:supp(hx )X

(C2)

The result of [38] is that the time evolution e-itH on N particles can be approximated with a matrix product unitary MNt of bond dimension Dt such that

||e-itH - MNt ||  ,

(C3)

and

Dt  eO(|t|)+O(log(N/ )).

(C4)

The operator MNt is in fact a quantum circuit of depth 2, where the gates act on |N |  O(|t|)+O (log(N/ )) adjacent qubits. That is, let {j} be a partition of the chain into sets of size |N |, and let {j} be the same partition, displaced by an amount |N |/2. Then







N/|N |

N/|N |

MNt = 

Uj (t) 

Vj (t) .

j=1

j=1

(C5)

Our local approximation is MNt (l0), which is defined in the same way as MNt except for the fact that the partition is into much smaller sets of adjacent sites, each of which has length |l0 | = O(|t|) + O (log(l0/ )) instead of |N |. Here l0 is a free parameter such that |l0 | < l0 < N , otherwise independent of N . See Fig. 2 for an illustration of this and the other definitions in the proof.

13

0



0

- 0





-1



+ 0

......



+1

......

A





 

FIG. 2. Schematic illustration of the proof of the local approximation to time evolution. The green area represents the effective
Lieb-Robinson lightcone of A, and the Uj , Vj are the gates on |l0 | sites that constitute the approximation. A unitary can be applied to regions ±l0 to have the circuit act independently on the region of length 2l0, and such that the resulting unitary on that region is an approximation to e-itHAl0 which, when acting on A, gives a good approximation to e-itH AeitH .

The goal is to bound the norm ||e-itH AeitH - MNt (l0)A(MNt (l0))||, for any operator A with support on at most k adjacent sites. First, with the triangle inequality and the Lieb-Robinson bound,

||e-itH AeitH - MNt (l0)A(MNt (l0))||  cevLRt-l + ||e-itHA(l) AeitHA(l) - MNt (l0)A(MNt (l0))||,

(C6)

where HA(l) is the Hamiltonian containing the terms of H that are a distance l away from A, and such that l0-k-|l0 |  l < l0 - k.
Now, let ±l0 be the nearest sets at a distance strictly greater than l from A, from the left and the right. The key is to notice that, since Mlt0 is a depth-2 circuit, there exists a unitary Ul0  U-l0  U+l0 acting on ±l0 such that Ul0 MNt (l0) = U Mlt0 for some U with support at distance strictly larger than l0 from A (see Fig. 2). By construction, the supports of Ul0 and HAl do not overlap.
The MPO Mlt0 is the approximation of the unitary e , -itHA(l0) on a region of size  l0, which allows us to use Eq. C3. That is

||e-itHA(l) AeitHA(l) - MNt (l0)A(MNt (l0))|| = ||Ul0 e-itHA(l) AeitHA(l) Ul0 - Ul0 MNt (l0)A(MNt (l0))Ul0 || = ||e-itHA(l) AeitHA(l) - (U  Mlt0 )A(U  Mlt0 )|| = ||e-itHA(l) AeitHA(l) - Mlt0 A(Mlt0 )||  2||A||cevLRt-l + ||e-itHA(l0) AeitHA(l0) - Mlt0 A(Mlt0 )||  2||A||cevLRt-l + 2 ||A||
 2||A||cevLRt+k+|l0 |-l0 + 2 ||A||.

(C7) (C8) (C9) (C10) (C11) (C12)

In the second line we have used the unitary invariance of the norm, in the third line the fact that Ul0 decouples the region at a distance l from the rest, and in the fourth line the Lieb-Robinson bound again, to relate e-itHA(l) to

e . -itHA(l0)

Thus, since |l0 |

l0, if we choose l0 = O (k + vLRt + log( 1 ) , we achieve the approximation error

||e-itHA(l) AeitHA(l) - MNt (l0)A(MNt (l0))||  3 ||A||. Finally, since MNt (l0)  Mkt is by definition a depth-2 circuit with gates acting on |l0 | sites, the bond dimension required to represent it exactly is

O(|t|)+O log k+vLRt+log 1
Dt  e

= eO(|t|) × poly k + vLRt + log 1 .

(C13)

14

2. Higher dimensions

For local approximations in higher dimensions, we cannot straightforwardly generalize the proof of the 1d case because we cannot approximate the unitary evolution with a depth-2 circuit, since in higher dimensions one requires depth at least d + 1 (see Appendix B of [77]).
Instead, we use an argument similar to that for thermal states in Appendix B. We use the global approximation of e-itH described in Appendix A to approximate the evolution of the Hamiltonian within the hypercube that has the local operator in the middle. Since this will only work for individual regions, we have to condition the particular partition used on the support of the input, which as we show can be done with a tensor map as defined in Sec. II.
Let us start with the approximation within each of the hypercubes. Lemma 2 guarantees that to simulate the evolution of a local observable e-itH AeitH where supp(A)  R we only need the Hamiltonian of a smaller region HX such that l := dist(A, Xc)  2d - 1.
We now define the same set of hypercubes covering the lattice as in Appendix B (also see Fig. 1)

Gp = {(l0i),p : i(l0i),p = }

(C14)

such that |(l0i),p|  l0d. Again the parameter p defines e.g one of the corners of the hypercubes, or any other parameter that determines the whole partition. It can adopt l0d values. To simulate A(t) we then define the PEPO

Mp(l0) =

Mi(,lp0),

i

(C15)

where Mi(,lp0) is an approximation in operator norm to e-itHi , and Hi = x:supp(hx)(l0i),p hx contains the terms of H with support in (l0i),p. Given Eq. (A8), this can be achieved with bond dimension

O |t|d log |t|dld0

Dp  e

.

(C16)

For later convenience we also define the p = 0 as a special case,

M0(l0) = I.

(C17)

To approximate A(t) we shall choose the partition Gp so that there exists a hypercube l(0ip,p) such that dist(A, \(l0ip,p))  l = l0/2 - k (that is, the region R is in the middle of the hypercube). This yields an error 2 + cld-1evt-l A , from which we have to then choose l0 = O~ k + vLRt + log 1 to get 3 A .
However, we want a PEPO that approximates any A, no matter the region in which it lies. This can be achieved by constructing a linear map Mtk(A) made of tensor contractions such that when applied to A it results on the operator Mi(,lp0) (with the correct partition p and position i) being applied as Mi(,lp0)A(Mi(,lp0)).
For it to be a good approximation of the dynamics, it should be such that the value of p is conditioned on the
position of A, so that A is in the middle of one of the hypercubes (l0i),p. Thus, it should contain the description of the different Mp(l0) (there are l0d, one for each value of p). Importantly, notice that we need to apply a single Mi(,lp0) and
not the full Mp(l0). Applying Mp(l0) in every region far from A will incur in additional errors growing with system size,
since they are not exactly unitaries and Mi(,lp0)Mi(,lp0) = I. Thus, on top of being able to implement the right partition p, we have to make sure that the support beyond the lightcone is trivial.
As we now show, all these requirements can be achieved with a bond dimension Dp2 × (l0 + k)3d, and so we obtain

D  O~ d|t| k + vLRt + log 1/

O(|t|d)
,

(C18)

that is, exponential in t (as expected) and polynomial in k, -1 now with a degree growing with t. We now explain how to construct this PEPO map Mtk(A). Let us first limit ourselves to the cases where A is a
product of Pauli matrices A = x x(j) with j  {0, 1, 2, 3}, which stand for, respectively, the Pauli {I, X, Y, Z} (the generalization to higher local dimensions is straightforward). By definition the only non-identity elements in A have
support on a small connected region R of size k. The result extends to arbitrary local operators by linearity.

15

One dimension: We first consider the one-dimensional case, which serves as an illustrative example, and then extend it to larger dimensions. If we simplify the picture by putting the two physical indices of the output and the input together, the tensor network can be drawn schematically as follows.

Output

Physical indices

Virtual indices
  

Input

(-1)

()

(+1)

We have three virtual indices with different functions: p is the index that determines the partition into hypercubes
from Eq. (C14) to use, and as such is fixed by the position of the non-identity Pauli matrices in A (i.e. the region R).
It can adopt l0 + 1 different values. For a given p, index r contains the information about the tensors from the MPO Mp(l0) that are applied to the Pauli, and thus has bond dimension given by Eq. (C16). Finally, s = {s1, s2} are the indices that determine the support of the output MPO, ensuring that it is trivial outside the ligthcone, as required.
The r index is thus determined by the MPOs Ml(0l0). The p, s indices work as follows: starting from the left of the chain, s1 is zero until it reaches a non-trivial Pauli input at site xR. At that point it turns into (l0 + k)/2, and then decreases by 1 at each tensor until it reaches a value we label as 0 , which indicates the end of the lightcone at the right. Beyond that point, the desired outcome Mtk(A) must have trivial support, which we enforce by setting the output tensor to be the identity M0(l0) = I. The point xR also determines the particular value of p = p, which then sets the PEPO Mp(l0) to act within the lightcone. The index p is chosen in such a way that the boundary of the hypercubes is (l0 - k)/2 away from the left and (l0 + k)/2 from the right of xR. This sets the right part of the lightcone. For the left side of the lightcone, we use index s2. It starts with value (l0 - k)/2 at xR, and decreases by 1 to the left, while being 0 all the way to the right. The values from (l0 - k)/2 to 1 to the left of xR allow us to set the output tensor to be that of Mp(l0)A(Mp(l0)). Then, it goes from 1 to another 0 , after which the output of the tensor is the identy, thus setting the end of the lightcone to the right.
We now illustrate this with the particular tensors. The following combinations of indices are the ones that add to
the final result. First, the ones that contribute to the lightcone region are the following.

 

1 = 0

2 =

0 -  2

 

1

=

0+ 2

2 = 0

 
1 =  2 = 0

 
1 =  - 1 2 = 0

 
1 = 1 2 = 0

 
1 = 0 2 = 0

()

(02+    2) , ()



(a)

(b)

(c)

  1 = 0 2 =  - 1
(02-    2) , ()

 
1 = 0 2 = 

 
1 = 0 2 = 0

 
1 = 0 2 = 1



(d)

(e)

FIG. 3. Tensors: (a) at position xR indicating the start of region R, fixing p = p (b) to the right of xR (c) indicating the right end of the lightcone (d) to the left of xR (e) indicating left end of the lightcone. The s index has been split into {s1, s2}.

16
All of these have as output the tensors corresponding to the MPO Mi(,lp0)A(Mi(,lp0)) within the lightcone. The configuration around xR can be illustrated as follows.

...

 = 

 = 

 = 

 = 

...

-2

1 = 0

2 =

0

- 2



-

1

1 = 0

 2

=

0

- 2



-1

()

1

=

0

+ 2



2 = 0

1

=

0

+ 2



(´+) 1

-1 2 = 0

+2

Start of 

Then, the ones required to set the output beyond the lightcone to be the identity are the following.

 
1 = 0 2 = 0

 
1 = 0 2 = 0



 
1 = 0 2 = 0

 
1 = 0 2 = 0



(a)

(b)

FIG. 4. Tensors: (a) to the left and (b) to the right of the lightcone. Their output is the identity.

To summarize, p determines the right set of hypercubes, and s1, s2 indicates how far we are to starting point of R, from the right and the left. The tensors apply Mp(l0) to A (so that the output is Mp(l0)A(Mp(l0))) unless either
s1, s2 = 0 , in which case they output I. The result is then Mi(,lp0)A(Mi(,lp0)) as desired. This is illustrated in Fig. 5. Higher dimensions: This can be done by establishing the same index configurations as for 1d for every individual
direction. Now, we have two s indices s(1q), s(2q) for each dimension q  {X, Y, ...}, as well as one index p(q) for each. Let us begin with a particular spatial direction, say q = X, with coordinates adopting values x  {0, 1, ..., LX } (LX being the length in that direction). Starting from the first position x = 0, the index sX1 is 0 until any non-trivial Pauli appears at the input, with an X coordinate xR. It is possible that there is more than one non-trivial input with the
same initial coordinate xR, but this does not affect the scheme. At xR, the index sX1 is then again changed to (l0 + k)/2, and sX2 is changed to (l0 - k)/2. Beyond xR, sX1 decreases
along the increasing X direction, and sX2 decreases along the decreasing X direction (while being 0 in the increasing

...





 ()





(,0)((,0))  -



... 

=













0
FIG. 5. Final illustration of the scheme in one dimension.

17
X direction). When either sX1 = 0 , sX2 = 0 , the tensor acts as the identity M0(l0) = I. Also, the position of that first non-trivial Pauli(s) determines the position of the hypercubes in the X direction, as pX = pX in the same way as in one dimension. We then repeat the same scheme for every dimension. This can be illustrated in 2d as follows.

1 = 0

2

=

0

- 2



1

=

0

+ 2



2 = 0

...



 


...

+1,

+2,

+2

+2

...

,+1

+1,
+1

+2,
+1

1

=

0

+ 2



+

1

2 = 0

+1,

+2,

1

=

0

+ 2





2 = 0

...

1 = 0

2

=

0

- 2





FIG. 6. In the figure, the  represent sites at which the input is not the identity but any other Pauli matrix. The green shaded region is the square region R in which the observable A has support. The index sX 1 grows to the right, sX 2 decreases to the left, and sY1 , sY2 respectively grow and decrease downwards. p has two components of l0 + 1 possible values each and is fixed across
the entire lattice. We only show virtual indices, and omit the input and output legs of the tensors explicitly for simplicity.

With this, we obtain a fixed partition into hypercubes as determined by p = {pq}, and also a set of indices s whose
non-zero value indicate where the output light-cone lies. That is, whenever any one of the 2 × d indices s is 0 , we set the local tensor to be that of M0(l0), and otherwise to be Mp(l0). This is illustrated as follows.

0 -  2

(2> 0)

0 +  2

(1> 0)

(0),

(1> 0)
0 +  2

(2> 0)
0 -  2

FIG. 7. The orange region represents the hypercube (l0i),p within the larger lattice in which the output Mtk(A) = Mi(,lp0)AMi(,lp0) has support. It is determined by the positivity of indices s1(q,2). When any s1(q,2) = 0 , we are outside of the hypercube.

18
Given this scheme, the map outputs Mi(,lp0)AMi(,lp0) with the right {i, p} chosen, such that R is in the middle of the corresponding hypercube. From our discussion above, this is an -close approximation to e-itH AeitH in operator norm. The whole map involves, on each side of the input A, a virtual index r with dimension Dp, and two additional virtual indices p, s with dimension (l0 + 1)d, ((l0 + k)/2)2d respectively, to connect the tensors at each site. Thus, the bond dimension can be taken as Dp2 × (l0 + k)3d, as stated above.
Finally, our result assumed that A was a product of Paulis. Since the map is linear and any local operator can be written as a linear sum of up to 4k Pauli matrices, the result follows by replacing  4-k in the bound for the bond dimension Eq. (C18).

Appendix D: Auto-correlation functions

We now study how to approximate the correlation functions in one dimension described in the main text

A(t)A  = Tr

e-H e-itH Ae-itH A Z

,

(D1)

with the MPOs from our approximations, as Tr

~k Mkt

AMkt A

.

Again, A =

1 N

x Ax, with Ax being supported

on k sites and Ax  A . The region sizes k , k are parameters to be determined. Throughout the proof, there

are different sources of -size errors (coming from Results 1 and 2, and repeated applications of the Lieb-Robinson

and the decay of correlations), which we set to be equal.

First, with Result 2 and H¨older's inequality, and setting k = k, we have that

| Tr ~k MktA(Mkt)A - Tr ~k e-itH AeitH A |  3 A 2 ~k 1 .

(D2)

We now focus on each term of the sum

A(t)A



=

1 N2

x,y Ax(t)Ay  separately. Using the Lieb-Robinson bound

Lemma 2,

| Tr ~k e-itH AxeitH Ay - Tr ~k e-itHl AxeitHl Ay |  A 2 ~k 1 cevLRt-l  3 A 2 ~k 1 ,

(D3)

where Hl only has support on a region a distance l = O(vLRt + log 1/ ) away from Ax. In both Eq. (D2) and (D3),
we inevitably obtain the factor ~k 1 from the application of H¨older's inequality. We show in Sec. D 1 below that we can always set ~k 1 = 1.
By construction, the MPO ~k has the following clustering of correlations property, for arbitrary operators F, G:

k

| Tr [~k F G] - Tr [~k F ] Tr [~k G] | = 0 if dist(F, G) > O

,

(D4)

| Tr [~k F G] - Tr [~k F ] Tr [~k G] |  (2 + Ke-dist(F,G)/) F

G

k if dist(F, G)  O

,

(D5)

where here comes from the error in the approximation in Result 1. The first line is due to the fact that ~k is constructed as a mixture of partitions, which are product over distances larger than O (k / ). The second is due to the fact that, when the observables are close (and within the same "cell" in the partition), one recovers the correlation length  in the thermal state from Eq. (3), with an additional error 2 . Moreover, notice that | Tr [~k F ] Tr [~k G] - F  G |  2 F G as long as |sup(F )|, |sup(F )|  k .
Applying this to Ax, Ay this means that, for far away pairs x, y,

| Tr ~k e-itHl AxeitHl Ay - e-itHl AxeitHl  Ay  |  3 A 2

k if dist(x, y) > O

+ O(vLRt + k + log 1/ )

(D6)

which follows from Eq. (D4). Also, from Eq. (D5)

| Tr ~k e-itHl AxeitHl Ay - e-itHl AxeitHl  Ay  |  6

k

if O

+ O(vLRt + k + log 1/ )  dist(x, y) > O

A2 1
 log

+ O(vLRt + k + log 1/ ).

(D7)

Let us set k = O  log 1 + vLRt + k , so that Eq. (D6) and (D7) cover all pairs x, y at a distance larger than O  log 1 + vLRt + k . In these two situations, we also automatically have that | e-itHl AxeitHl  Ay  -

19

e-itH AxeitH Ay |  A 2 from the finite correlation length of the thermal state and the Lieb-Robinson bound. We conclude that

| Tr ~k e-itHl AxeitHl Ay - e-itH AxeitH Ay  ||  7

A2

1 if dist(x, y) > O  log + vLRt + k

(D8)

Finally, since we have set k = O  log 1 + vLRt + k , Result 1 and the Lieb-Robinson bound guarantee that

| Tr ~k e-itHl AxeitHl Ay - e-itH AxeitH Ay  |  2

A2

1 if dist(x, y)  O  log + vLRt + k .

(D9)

Together

with

Eq.

(D2)

and

(D3),

and

the

definition

A

=

1 N

x Ax, these imply

| Tr ~k MktA(Mkt)A - A(t)A |  7 A 2 ( ~k 1 + 1) = 14 A 2 ,

where ~k has bond dimension set by our choice of k and Result 1

DO

vLRt +  log 1 + k

1+o(1)
,

(D10) (D11)

and Mkt has bond dimension as given in Result 2.

1. Proof of ~k = 1: positivity of ~k

As part of the proof of this section, we need to show that ~k = 1. From the definition (see Eq. (B5) in App. B)
we have that Tr [~k ] = 1, so we just need to show that the MPO is positive. From its definition in Eq. (B7), ~k is a convex mixture of operators ~l0,p = i ~((l0i),p), where each term, in one
dimension, is defined as the MPO of Theorem 3 from [37]. We thus need to show that this MPO ~((l0i),p) is positive. The construction of that MPO is explicitly given in Eq. (E.12) in Appendix E1 of [37]. It is a product of Taylor
approximations of degree m to the exponential function ex Tm(x), as

~((l0i),p)  Tm(-H1)Tm(H1)Tm(-H1,2)Tm(H2).....Tm(-Hl0-1,l0 ),

(D12)

where the Hi, Hi,j are certain segments of the 1d Hamiltonian (the exact details are not crucial here). Notice that the domain of the Taylor approximation spans both positive and negative x. By Taylor's remainder theorem, it can
be easily seen that if m is even, it is guaranteed that Tm(x)  0 (since either x > 0 or the remainder is negative), making ~((l0i),p)  0 and by extension ~k  0. It is always possible to set the degree of the Taylor expansion to be even, since it is only specified up to a constant (see Eq. E.25 in [37]). This finishes the proof.

