arXiv:2106.00968v1 [math.AC] 2 Jun 2021

ON THE ARITHMETIC OF MONOIDS OF IDEALS
ALFRED GEROLDINGER AND M. AZEEM KHADAM
Abstract. We study the algebraic and arithmetic structure of monoids of invertible ideals (more precisely, of r-invertible r-ideals for certain ideal systems r) of Krull and weakly Krull Mori domains. We also investigate monoids of all nonzero ideals of polynomial rings with at least two indeterminates over noetherian domains. Among others, we show that they are not transfer Krull but they share several arithmetical phenomena with Krull monoids having infinite class group and prime divisors in all classes.
1. Introduction
Let R be a (commutative integral) domain, r be an ideal system on R, Ir(R) be the semigroup of nonzero r-ideals with r-multiplication, and Ir(R)  Ir(R) be the subsemigroup of r-invertible r-ideals. As usual, we denote by v the system of divisorial ideals and for the d-system of usual ring ideals we omit all suffices (i.e., I(R) = Id(R), and so on). Factoring ideals into finite products of special ideals (such as prime ideals, radical ideals, and more) is a central topic of multiplicative ideal theory. The monograph [28] of Fontana, Houston, and Lucas shows the rich variations of this theme. Algebraic and arithmetic properties of ideal semigroups help to understand the multiplicative structure of the underlying domain. To mention some classical results, R is a Dedekind domain if and only if I(R) = I(R) if and only if I(R) is a factorial monoid, and R is a Krull domain if and only if Iv(R) is a factorial monoid. Recent progress in such directions can be found in the work by Anderson, Juett, Klingler, Olberding, Reinhart, and others (e.g., [49, 58, 3, 50, 56, 57, 52]).
In the present paper, we first study factorizations of r-invertible r-ideals into multiplicatively irreducible r-ideals of weakly Krull Mori domains and, in particular, of Krull domains. Clearly, monoids Ir(R) of r-invertible r-ideals are commutative cancellative monoids. After some preparations in the setting of abstract monoids in Section 3, we show in Section 4 that the monoid of invertible ideals of a weakly Krull Mori domain is a weakly Krull Mori monoid again and that a domain R is Krull if and only if the monoid Ir(R) (with r-multiplication) is a Krull monoid (Theorems 4.3 and 4.5). Much is known about the arithmetic of weakly Krull monoids and, in particular, of Krull monoids. The arithmetic of the latter is uniquely determined by its class group and the distribution of prime divisors in the classes. We focus on two arithmetical properties, namely on the structure of unions of sets of lengths and on being fully elastic (definitions are recalled at the beginning of Section 3). Our arithmetical results on the monoids of invertible ideals (as given in Corollary 4.4 and Proposition 4.9) are based on our understanding of their algebraic structure.
In Section 5, we study the semigroup of all nonzero ideals. In general, these semigroups are not cancellative, and for this reason only first steps have been made towards the understanding of their arithmetic. However, under natural ideal-theoretic assumptions they are unit-cancellative and even BFmonoids (Propositions 2.1 and 2.2). In the last years, parts of the existing machinery of factorization theory, developed in the setting of cancellative monoids, was generalized to the setting of unit-cancellative monoids (for a first paper, see [26]). In Section 2, we introduce all the required arithmetical concepts
2010 Mathematics Subject Classification. 13A15, 13B25, 13F05, 13F20, 20M12, 20M13. Key words and phrases. monoids of ideals, polynomial ideal theory, Krull domains, weakly Krull domains, sets of lengths, elasticity. This work was supported by the Austrian Science Fund FWF, Project P33499-N.
1

2

ALFRED GEROLDINGER AND M. AZEEM KHADAM

in the setting of unit-cancellative monoids. The monoid of all nonzero ideals was studied for orders in Dedekind domains with finite class group [16, 38, 14]. In this setting, monoids of all nonzero ideals share arithmetical finiteness properties with monoids of invertible ideals and, more generally, with Krull monoids having finite class group. Our main result in Section 5 deals with the monoid of nonzero ideals of polynomial rings R with at least two variables over noetherian domains, and they show a completely different behaviour. Theorem 5.1 shows that I(R) is not transfer Krull and that factorizations in I(R) are as wild as possible. Indeed, they share arithmetical phenomena with Krull monoids having infinite class group and prime divisors in all classes (see Theorem 5.1, Conjecture 5.12, Example 5.13 and the preceding discussion). The methods, used in the proof of Theorem 5.1, stem from the theory of Gr¨obner bases in polynomial ideal theory.

2. Background on the ideal theory and the arithmetic of monoids

We denote by N the set of positive integers. For real numbers a, b  R, we let [a, b] = {x  Z : a  x  b} denote the discrete interval between a and b. Let A, B  Z be subsets. Then A + B = {a + b : a  A, b  B} denotes their sumset and the set of distances (A)  N is the set of all d  N for which there is a  A such that A  [a, a + d] = {a, a + d}. If A  N, then (A) = sup A/ min A  Q1  {} denotes the elasticity of A, and we set ({0}) = 1.
Let H be a multiplicatively written commutative semigroup with identity element. We denote by H× the group of invertible elements of H, and we say that H is reduced if H× = {1}. An element a  H is said to be
· cancellative if b, c  H and ab = ac implies that b = c, and · unit-cancellative if a  H and a = au implies that u  H×.
By definition, every cancellative element is unit-cancellative. The semigroup H is said to be cancellative resp. unit-cancellative if every element u  H is cancellative resp. unit-cancellative.

Throughout this paper, a monoid means a commutative unit-cancellative semigroup with identity element.

For a set P , we denote by F (P ) the free abelian monoid with basis P . Elements a  F (P ) are written

in the form

a = pvp(a) , where vp : F (P )  N0

pP

is the p-adic valuation. We denote by |a| = pP vp(a)  N0 the length of a and by supp(a) = {p  P : vp(a) > 0}  P the support of a. Let H be a monoid. A monoid H is cancellative if and only if it
has a quotient group, which will be denoted by q(H). Let H be a cancellative monoid. We denote by

· H = {x  q(H) : there is N  N such that xn  H for all n  N }  q(H) the seminormalization of H, and by
· H = {x  q(H) : there is c  H such that cxn  H for all n  N}  q(H) the complete integral

closure of H.

Then H  H  H  q(H), and H is called

· seminormal if H = H (equivalently, if x  q(H) and x2, x3  H, then x  H), and

· completely integrally closed if H = H.

A submonoid S  H is called divisor-closed if a  S and b  H with b | a implies that b  S. For a
subset S  H, we denote by [[S]] the smallest divisor-closed submonoid generated by S. Let  : H  D be a monoid homomorphism to a cancellative monoid D. We set H = {a-1b : a, b  H, (a) |D (b)} and we say that  is a divisor homomorphism if a, b  H and (a) | (b) in D implies that a | b in H
(equivalently, H = H).

Ideal Theory of Monoids. Our notation of ideal theory follows [47], but note that the monoids in this paper do not contain a zero element. An ideal system on a cancellative monoid H is a map

ON THE ARITHMETIC OF MONOIDS OF IDEALS

3

r : P(H)  P(H), where P(H) is the power set of H, such that the following conditions are satisfied for all subsets X, Y  H and all elements a  H:
· X  Xr, · X  Yr implies that Xr  Yr, · aH  {a}r, and · aXr = (aX)r.
We say that r is finitary if, for all X  H, Xr is the union of all Er over all finite subsets E  X. As usual, the v-system denotes the system of divisorial ideals. The monoid H is said to be
· a Mori monoid if it is cancellative and satisfies the ACC on divisorial ideals, and · a Krull monoid if it is a completely integrally closed Mori monoid.
Let r be any ideal system on H. A subset I  H is called an r-ideal if Ir = I, and Ir(H) is the set of nonempty r-ideals. Then Ir(H) together with r-multiplication (defined by I ·r J = (IJ)r for all I, J  Ir(H)) is a reduced semigroup with identity element H. Let Fr(H) denote the semigroup of fractional r-ideals and Fr(H)× the group of r-invertible fractional r-ideals. Then Ir(H) = Fr(H)×  Ir(H) is the cancellative monoid of r-invertible r-ideals with r-multiplication and Ir(H)  Ir(H) is a divisor-closed submonoid. If q is a further ideal system on H with Iq(H)  Ir(H), then, by [47, Theorem 12.1],
(2.1) Fr(H)×  Fq(H)×  Fv(H)× are subgroups and Ir(H)  Iq(H)  Iv(H) are submonoids .
The cokernel of the group homomorphism q(H)  Fr(H)×, a  aH, is called the r-class group of H. It will be denoted by Cr(H) and written additively. Thus, if I, J  Fr(H)×, then [I ·r J] = [I]+ [J]  Cr(H). We denote by X(H) the set of all minimal nonempty prime s-ideals of H and note that X(H)  t-spec(H). We say that H satisfies the r-Krull Intersection Theorem if
(In)r =  for all I  Ir(H) \ {H} .
n0
Arithmetic of Monoids. Let H be a monoid. An element p  H is said to be · irreducible (an atom) if p / H× and p = ab with a, b  H implies that a  H× or b  H×, · primary if p / H× and p | ab with a, b  H implies that p | a or p | bn for some n  N, and · prime if p / H× and p | ab with a, b  H implies that p | a or p | b.
We denote by A(H) the set of atoms of H. The free abelian monoid Z(H) = F (A(Hred)) is the factorization monoid of H and  : Z(H)  Hred, defined by (u) = u for all u  A(Hred), denotes the factorization homomorphism of H. For a  H,
· Z(a) = -1(aH×)  Z(H) is the set of factorizations of a, · L(a) = {|z| : z  Z(a)}  N0 is the set of lengths of a, and · L(H) = {L(a) : a  H} is the system of sets of lengths of H.
If S  H is a divisor-closed submonoid and a  S, then Z(S)  Z(H), ZS(a) = ZH (a), and LS(a) = LH (a). We say that H is
· atomic if L(a) is nonempty for all a  H, · half-factorial if |L(a)| = 1 for all a  H, · a BF-monoid if L(a) is finite and nonempty for all a  H, · an FF-monoid if Z(a) is finite and nonempty for all a  H, and · locally finitely generated if [[a]]red  Hred is finitely generated for all a  H.
Every Mori monoid H is a BF-monoid and if, in addition, r-max(H) = X(H), then H is of finite rcharacter ([34, Theorems 2.2.5.1 and 2.2.9]). Krull monoids are locally finitely generated and locally finitely generated monoids are FF-monoids ([34, Proposition 2.7.8]).
The next lemma gathers the properties of ideal semigroups needed in the sequel.
Proposition 2.1. Let H be a cancellative monoid and r be an ideal system on H.

4

ALFRED GEROLDINGER AND M. AZEEM KHADAM

1. If H is a Mori monoid, then
(In)r =  for all I  Ir(H) \ {H} .
n0
2. If H is r-noetherian, then (Ir(H), ·r) is a Mori monoid. 3. If (Ir(H), ·r) is a Mori monoid, then H is a Mori monoid. 4. If r is finitary and H satisfies the r-Krull Intersection Theorem, then Ir(H) is unit-cancellative
and if, in addition, H has finite r-character, then Ir(H) is a BF-monoid.
Proof. 1. See [47, Theorem 12.5]. 2. and 3. follow from [35, Example 2.1]. 4. See [14, Lemma 4.1] and [38, Section 4].

Rings. By a ring, we mean a commutative ring with identity element and by a domain, we mean a
commutative integral domain with identity element. Let R be a ring. Then its multiplicative semigroup R· of regular elements is a cancellative monoid. All arithmetic concepts introduced for monoids will be
used for the monoids of regular elements of rings. Thus, we say that R is atomic (factorial, and so on) if R· has the respective property and we set (R) := (R·) and similarly for all arithmetical invariants. If R is a v-Marot ring, then R is a Mori ring resp. a Krull ring if and only if R· is a Mori monoid resp. a
Krull monoid ([37, Theorem 3.5]).
Let R be a domain. We denote by H(R) the monoid of nonzero principal ideals of R, and note that H(R) = Rr·ed. Let r be an ideal system on R. Then r restricts to an ideal system r on R·, whence for every subset I  R, we have Ir = (I·)r  {0}. We use all ideal theoretic concepts introduced for monoids for domains. In particular, Ir(R) is the semigroup of nonzero r-ideals of R, Ir(R) is the subsemigroup of r-invertible r-ideals of R, and Cr(R) = Fr(R)×/q(H(R)) is the r-class group of R.
The usual ring ideals form a finitary ideal system (the d-system), and for these ideals we omit all suffices, whence I(R) = Id(R), and the d-class group Cd(R) = F (R)×/q(H(R)) is the Picard group Pic(R) of R. Throughout this paper, we suppose that Ir(R)  I(R), whence

(2.2)

I(R)  Ir(R)  Iv(R) .

If R satisfies the r-Krull Intersection Theorem, then Ir(R) is unit-cancellative by Proposition 2.1.4. If R is a Mori domain, then (Iv(R), ·v) is a Mori monoid by Proposition 2.1.2. If R is a one-dimensional Mori domain, then Iv(R) = I(R), R has finite character by [31, Lemma 3.11], I(R) is unit-cancellative by [38, Corollary 4.4], whence I(R) is a BF-monoid by Proposition 2.1.4. For I  I(R), we define (I)  N0  {} to be the smallest N having the following property:
If n  N and J1, . . . , Jn  I(R) with J1 · . . . · Jn  I, then there exists a subset   [1, n] such that ||  N and  J  I. The invariant (I) is closely related to a well-studied invariant (·) where, in the definition, containment is replaced by divisibility (see, for example, [26, 35]). Thus, for invertible ideals I  I(R), we have (I) = (I).
Suppose that R is noetherian. Then the integral closure R is a Krull domain by the Theorem of Mori-
Nagata. Since noetherian domains are Mori, they are BF-domains but they need not be FF-domains.
An algebraic characterization of when noetherian domains are locally finitely generated is given in [51,
Theorem 1]. The next proposition shows that I(R) is a BF-monoid.

Proposition 2.2. Let R be a noetherian domain and I  I(R).
1. If J  I(R) with I  J and J/I = R/P (as R-modules) for some prime ideal P  R, then (I)  (J ) + 1.
2. (I) < . 3. sup LI(R)(I)  (I). In particular, I(R) is a BF-monoid.

ON THE ARITHMETIC OF MONOIDS OF IDEALS

5

Proof. Since R satisfies Krull's Intersection Theorem, I(R) is unit-cancellative by Proposition 2.1.4. 1. Since J/I = R/P , we obtain P J  I and P = {s  R : sr  I} for every r  J \ I. If
J1, . . . , Jn  I(R) with J1 · . . . · Jn  I, then J1 · . . . · Jn  J. Therefore, there exists a subset   [1, n] such that ||  (J ) and  J  J . If  J  I, then the statement follows. If  J  I, then there exists r  R with r   J \ I  J \ I. Then

implies that

r·

J  J1 · . . . · Jn  I

[1,n]\

[1,n]\ J  P . Therefore, there exists   [1, n] \  such that J  P , whence

J · J  P J  I .

2. We need the following module theoretic result: if M is a nonzero finitely generated R-module and N  M a submodule, then there exist a chain of submodules N = N0  N1  . . .  Nm = M and prime ideals Pi  R such that Ni+1/Ni = R/Pi for all i  [0, m - 1] ( [53, Theorem 6.4]). Thus since (R) = 0, the claim follows by 1.
3. Let I, J1, . . . , Jn  I(R) with I = J1 · . . . · Jn. Then there exists a subset   [1, n] such that ||  (I) and J  =  J  I. Setting J  = [1,n]\ J, we obtain that
J   I = J J   J  ,
whence J = JJ. Therefore J = R,  = [1, n], and n = ||  (I). Finally, the in particular statement follows now by 2. .

3. On unions of sets of lengths and sets of elasticities

Let H be a BF-monoid. Then

(H) =

(L)  N

LL(H)

is the set of distances of H. Let k  N0. If H = H×, then we set Uk(H) = {k}, and otherwise we set

Uk(H) =

L  N0

kLL(H)

is the union of sets of lengths containing k. Then k(H) = sup Uk(H) is the k-th elasticity of H and

(H )

=

sup{(L) :

L



L(H )}

=

lim
k

k (H ) k

is the elasticity of H. By definition, H is half-factorial if and only if (H) =  if and only if (H) = 1. If H is not half-factorial, then min (H) = gcd (H).
We start with a discussion on elasticities. In [20, 13], Chapman et al. initiated the study of the set {(L) : L  L(H)}  Q1 of elasticities of all sets of lengths. By definition, H is half-factorial if and only if (H) = 1 and clearly this is equivalent to {(L) : L  L(H)} = {1}. The reverse extremal case, namely when the set of elasticities is as large as possible, found special attention. We say that H is fully elastic if for every rational number q with 1 < q < (H) there is an L  L(H) such that (L) = q. Thus, by definition, every half-factorial monoid is fully elastic. For a detailed study of sets of elasticities in the setting of locally finitely generated monoids we refer to [61].
Next we discuss the structure of sets of lengths and of their unions. To do so, we need the concept of almost arithmetical (multi) progressions. Let d  N, M  N0, and {0, d}  D  [0, d]. A subset L  Z is called an

6

ALFRED GEROLDINGER AND M. AZEEM KHADAM

· almost arithmetical multiprogression (AAMP) with difference d, period D, and bound M if

L = y + (L  L  L)  y + D + dZ ,

where y  Z is a shift parameter, L is finite nonempty, with min L = 0 and L = (D + dZ)  [0, max L], L  [-M, -1], and L  max L + [1, M ], and
· almost arithmetical progression (AAP) with difference d and bound M if L can be written in the

form

L = y + (L  L  L)  y + dZ ,

where y  Z is a shift parameter, L  [-M, -1], L is a nonempty arithmetical progression with difference d and min L = 0, L  max L + [1, M ] if L is finite, and L =  if L is infinite.

Note that AAPs need not be finite, whereas AAMPs are finite. Moreover, an AAMP with period D = {0, d} is an AAP with difference d. We say that H satisfies the

· Structure Theorem for Sets of Lengths if there are M  N0 and a finite nonempty set   N such that every L  L(H) is an AAMP with difference d   and bound M .
· Structure Theorem for Unions if there are d  N and M  N0 such that Uk(H) is an AAP with difference d and bound M for all sufficiently large k  N.

We refer to [34, Chapter 4.7] for background on the Structure Theorem for Sets of Lengths and to [32, 26, 60, 62], [15, Theorem 6.6], [19, Proposition 4.9], [11, Theorem 1.1], [10, Theorem 3.9], [55, Theorem 5.4], [54, Theorem 5.5] for background and recent progress on the Structure Theorem for Unions.
The next lemma gathers simple properties of unions of sets of lengths which we need in the sequel.

Lemma 3.1. Let H be a BF-monoid and k,   N. 1. Uk(H) + U(H)  Uk+(H). 2. We have k  U(H) if and only if   Uk(H). 3. If U2(H) = N2, then Uk(H) = N2 for all k  2.
Proof. 1. and 2. follow immediately by the definitions. 3. Suppose that U2(H) = N2. We proceed by induction on k. Let k  2 and suppose that
Uk(H) = N2. Then 1. implies that
N3 = 1 + N2 = 1 + Uk(H)  Uk+1(H) .
Since k + 1  U2(H), 2. implies that 2  Uk+1(H). Thus, we obtain that Uk+1(H) = N2.

In [12] it was proved that every commutative cancellative monoid having a prime element and accepted elasticity is fully elastic. We generalize this result.

Proposition 3.2. Let H be a BF-monoid. Consider the following conditions. (a) There are submonoids H1 and H2 such that H = H1 × H2, where H1 is half-factorial but not a group. This holds true in particular if H has a cancellative prime element. (b) For every q  Q with 1 < q < (H), there is an element c  H such that
(L(ck)) = (L(c)) > q for all k  N .
This holds true in particular if H has accepted elasticity. (b') For every m  N2 there is L  L(H2) with min L = 2 and max L = m. If Conditions (a) and (b) or Conditions (a) and (b') hold, then H is fully elastic.
Proof. If (H) = 1, then Condition (b) holds trivially, H is half-factorial, and hence it is fully elastic. From now on we suppose that (H) > 1.
1. We first check the two in particular statements stated in (a) and (b).

ON THE ARITHMETIC OF MONOIDS OF IDEALS

7

(i) If p  H is a cancellative prime element of H, then

H = F ({p}) × T , where T = {a  H : p  a} .

If a  H and k  N, then

max L(ak)  k max L(a) and min L(ak)  k min L(a) ,

whence (3.1)

(L(ak ))

=

max L(ak) min L(ak)



k max L(a) k min L(a)

=

(L(a)) .

(ii) Suppose that H has accepted elasticity, say (L(a)) = (H). By (3.1), we infer that (L(ak)) = (L(a)) = (H) for all k  N and, if (L(ak)) = (L(a)) for some k  N, then

(3.2)

max L(ak) = k max L(a) and min L(ak) = k min L(a) .

(iii) Suppose that (a) and (b) hold. To show that H is fully elastic, we choose an atom p  H1. Then for every a = a1a2  H = H1 × H2 and every k  N, we have

(3.3)

LH (pka) = LH1 (pka1) + LH2 (a2) = k + LH1 (a1) + LH2 (a2) = k + LH (a) .

Let q  Q with 1 < q < (H), and let c  H with

(L(ck)) = (L(c)) > q for all k  N .

We set
i = r - s, Then, by (3.2) and (3.3),

q

=

r s

with

r, s  N ,

j = s max L(c) - r min L(c), and

b := cipj .

max L(b) = j + i max L(c) and min L(b) = j + i min L(c) .

Putting all together we obtain that

(L(b))

=

max L(b) min L(b)

=

j + i max L(c) j + i min L(c)

=

(r (r

- s) max L(c) - s) min L(c)

+ +

s max L(c) s max L(c)

- -

r min L(c) r min L(c)

=

r(max s(max

L(c) L(c)

- -

min min

L(c)) L(c))

=

r s

=

q.

2. Suppose that (a) and (b') hold and let q  Q with 1 < q < (H). Then there are r, s  N such that q = r/s. By assumption, there is a2  H2 such that min L(a2) = 2 and max L(a2) = r - s + 2. We choose an atom u  H1 and define
b = us-2a2 .

Then

(L(b))

=

max L(b) min L(b)

=

max L(us-2) min L(us-2)

+ max L(a2) + min L(a2)

=

(s - 2) + (r (s - 2)

-s+ +2

2)

=

q.

8

ALFRED GEROLDINGER AND M. AZEEM KHADAM

Example 3.3. 1. Consider the additive monoid H2 = (N2 {(0, 0)}, +)  (N20, +). For every m  2, (m-1, 1), (1, m-
1)  A(H2) and we have
(m, m) = (m - 1, 1) + (1, m - 1) = (1, 1) + . . . + (1, 1) ,
m-times
whence min L((m, m)) = 2 and max L((m, m)) = m. Thus, Condition (b') of Proposition 3.2 is satisfied. Moreover, U2(H) = N2, whence Uk(H) = N2 for all k  2 by Lemma 3.1. The forthcoming Proposition 4.2 shows that H2 is not fully elastic (because H2 is strongly primary). However, if H1 is any half-factorial monoid, then H1 × H2 is fully elastic by Proposition 3.2.
2. In Section 5, we show that the monoid of nonzero ideals of a polynomial ring with at least two variables also satisfy Conditions (a) and (b') of Proposition 3.2 (Theorem 5.1).

4. On monoids of invertible ideals of weakly Krull domains
In this section we study the algebraic structure of monoids of invertible ideals and we derive some consequences for their arithmetic. Our focus will be on weakly Krull domains and Krull domains. We start with a result in the setting of r-invertible r-ideals. Then our discussion is divided into four subsections, namely on weakly Krull domains 4.1, Krull domains 4.2, transfer Krull monoids 4.3, and on the arithmetic of transfer Krull monoids 4.4.
Let H be a cancellative monoid and r be an ideal system on H. An ideal I  Fr(H) is called an r-cancellation ideal if whenever I ·r J1 = I ·r J2 for J1, J2  Ir(H), then J1 = J2. It is easily seen that I is an r-cancellative if and only if whenever I ·r J1  I ·r J2 for all J1, J2  Ir(H), then J1  J2. All r-invertible ideals (whence all principal ideals) are r-cancellation ideals, whence Ir(H) is a cancellative monoid. A divisorial ideal is v-invertible if and only if it is v-cancellative ([47, Chapter 13.4]). Let R be a domain. An ideal I of R is a cancellation ideal if and only if I is locally principal ([5] and [30]), and I(R) is a cancellative monoid if and only if R is almost Dedekind ([47, Theorem 23.2]). If R is a Mori domain, then every nonzero locally principal ideal is invertible ([6, Corollary 1]). If p  R is prime, then pR is a cancellative prime element of I(R) and of I(R). Moreover, if R is noetherian, then p is also prime element of R ([23, Lemma 4.7]; for more on prime elements in noetherian domains, we refer to [22]).
Theorem 4.1. Let H be a cancellative monoid and let r be an r-noetherian ideal system of H. 1. If Ir(H) has a prime element, and if either Ir(H) has accepted elasticity or is locally finitely generated, then Ir(H) is fully elastic. 2. Suppose that H has finite r-character and satisfies the r-Krull Intersection Theorem. If H has an r-invertible prime r-ideal, and if either Ir(H) or all divisor-closed submonoids generated by one element have accepted elasticity, then Ir(H) is fully elastic.
Proof. In both cases we verify the assumptions of Proposition 3.2. 1. Since r is r-noetherian, Ir(H) is a Mori monoid by Proposition 2.1.2 and hence it is a BF-monoid.
Let P  Ir(H) be a prime element. Since Ir(H) is a cancellative monoid, P is a cancellative prime element.
Let q be a rational number with 1 < q < (I(R)). If Ir(H) has accepted elasticity, then there is J  Ir(H) such that (L(J)) = (Ir(R)), whence
(L(Jk)) = (L(J)) > q for all k  N .
Now suppose that Ir(H) is locally finitely generated. We choose an ideal I  Ir(H) with (L(I)) > q. We consider the divisor-closed submonoid S = [[I]]  Ir(H). Then S is a finitely generated monoid. Thus, by [34, Theorem 3.1.4], there is an ideal J  S with (S) = (L(J))  (L(I)) > q. Therefore, we obtain that
(L(Jk)) = (L(J)) > q for all k  N .

ON THE ARITHMETIC OF MONOIDS OF IDEALS

9

Thus, Conditions (a) and (b) of Proposition 3.2 are satisfied, whence the assertion follows. 2. Since H is r-noetherian, r is a finitary ideal system by [47, Theorem 3.5]. Thus Ir(H) is a BF-
monoid by Proposition 2.1.4. Let P be an r-invertible prime r-ideal, then P is a cancellative prime element of Ir(H). Arguing as in 1., we obtain an r-ideal J such that
(L(Jk)) = (L(J)) > q for all k  N .
Thus, Conditions (a) and (b) of Proposition 3.2 are satisfied, whence the assertion follows.

4.1. Weakly Krull domains. In this subsection, we consider weakly Krull domains. We start with the local case and for this we need the concept of primary monoids. Let H be a cancellative monoid and m = H \ H×. Then H is called
· primary if H = H× and for all a, b  m there is n  N such that bn  aH, and · strongly primary if H = H× and for every a  m there is n  N such that mn  aH (we denote
by M(a) the smallest n  N having this property).
Primary Mori monoids are strongly primary and strongly primary monoids are BF-monoids. The multiplicative monoid of nonzero elements of a domain is primary if and only if R is one-dimensional and local. If R is a one-dimensional local Mori domain, then Iv(R) = I(R) = R· and R· is locally tame strongly primary ([39, Corollary 3.10]).

Proposition 4.2. Let H be a strongly primary monoid. 1. If H is not half-factorial, then there is   Q>1 such that (L)   for all L  L(H) with (L) = 1. In particular, H is fully elastic if and only if it is half-factorial. 2. If H is locally tame, then H satisfies the Structure Theorem for Sets of Lengths and the Structure Theorem for Unions.
Proof. 1. The first statement follows by [40, Theorem 5.5]. Since half-factorial monoids are fully elastic, the in particular statement holds.
2. This follows from [33, Theorem 4.1].

A family of monoid homomorphisms  = (p : H  Dp)pP is said to be
· of finite character if the set {p  P : p(a) / Dp×} is finite for all a  H, and · a defining family (for H) if it is of finite character and

H = Hp .
pP
If  is of finite character, then it induces a monoid homomorphism

: H  D =

(Dp)red ,

defined by

(a) =

p(a)Dp×

,
pP

pP

and  is a defining family if and only if  is a divisor homomorphism.

We recall the concept of weak divisor theories and weakly Krull monoids ([46], [47, Chapter 22]). A monoid is said to be weakly factorial if it is cancellative and every nonunit is a finite product of primary elements. Every reduced weakly factorial monoid has a unique decomposition in the form

D = Dp, where Dp  D are reduced primary submonoids .
pP
Let D be a reduced weakly factorial monoid as above. If (a(i))iI is a family of elements a(i)  D with components a(pi), then a is called a strict greatest common divisor of (a(i))iI , we write
a = (a(i))iI ,
if the following two properties are satisfied for all p  P :

10

ALFRED GEROLDINGER AND M. AZEEM KHADAM

· ap | a(pi) for all i  I; · ap = a(pi) for at least one i  I.
A monoid homomorphism  : H  D is called a weak divisor theory if the following two conditions are satisfied:
(a)  is a divisor homomorphism and D is reduced weakly factorial. (b) For every a  D there are a1, . . . , am  H such that a = (a1)  . . .  (am).
A monoid is said to be a weakly Krull monoid if it is cancellative and one of the following equivalent conditions is satisfied:
· H has a weak divisor theory  : H  D. · The family of embeddings (p : H  Hp)pX(H) is a defining family for H. ·  : H  pX(H)(Hp)red is a weak divisor theory.
By the uniqueness of weak divisor theories, the (weak divisor) class group C(H) = q(D)/q((H)) depends on H only and it is isomorphic to the t-class group Ct(H) of H ([47, Theorems 20.4 and 20.5]). If H is Mori weakly Krull, then C(H) = Ct(H) = Cv(H). A monoid is weakly factorial if and only if it is weakly Krull with trivial class group. The localizations Hp are primary for all p  X(H).
A domain R is a weakly Krull domain if R· is a weakly Krull monoid. If R is a one-dimensional Mori domain, then R is a Mori weakly Krull domain, Iv(R) = I(R), and Cv(R) = Pic(R) ([34, Proposition 2.10.5]). To mention higher-dimensional weakly Krull domains, recall that all Cohen-Macaulay domains are weakly Krull and there is a recent characterization of when monoid algebras are weakly Krull. Let D be a domain with quotient field K and let S be a cancellative monoid with torsion-free quotient group G = q(S). Suppose that G satisfies the ACC on cyclic subgroups. Then the monoid algebra D[S] is weakly Krull if and only if D is a weakly Krull domain satisfying the G-UMT property and S is a weakly Krull monoid satisfying the K-UMT property ([24, Theorem 3.7]).

Theorem 4.3. Let R be a weakly Krull Mori domain. Then Iv(R) is a reduced weakly factorial Mori monoid. The inclusion I(R)  Iv(R) is a weak divisor theory, I(R) is a weakly Krull Mori monoid and its class group is isomorphic to Cv(R)/ Pic(R).

Proof. By [36, Proposition 5.3], we have a monoid isomorphism

(4.1)

Iv(R) -

(Rp·)red ,

pX(R)

whence Iv(R) is a reduced weakly factorial Mori monoid (the Mori property follows from Proposition 2.1.2). Since R is a weakly Krull domain, the inclusion H(R)  Iv(R) is a weak divisor theory. To verify that the inclusion I(R)  Iv(R) is a divisor homomorphism, let I, J  R be invertible ideals such that I | J in Iv(R). Then I-1J  F (R)×  Iv(R)  F (R)×  I(R) = I(R). Thus, the inclusion I(R)  Iv(R) is a divisor homomorphism. This implies that I(R) is a Mori monoid by [34, Proposition 2.4.4]. Since H(R)  Iv(R) is a weak divisor theory, every I  Iv(R) is a strict greatest common divisor of principal ideals and hence a strict greatest common divisor of invertible ideals. Therefore, I(R)  Iv(R) is a weak divisor theory and for the class group we have

q(Iv(R))/q(I(R)) = Fv(R)×/F (R)× = Fv(R)×/q(H(R)) F (R)×/q(H(R)) = Cv(R)/ Pic(R) .

Let R be a weakly Krull Mori domain. Many aspects of the arithmetic of Iv(R) have been studied in a variety of settings, from orders in quadratic number fields to seminormal weakly Krull domains to stable
weakly Krull domains (see [36, Theorem 5.8], [40, Theorem 5.8], [41, Corollary 4.6], [16, Theorem 1.1], [38,
Theorem 5.13], [14, Theorem 5.10]). The following corollary characterizes when - under some additional assumptions - Iv(R) is fully elastic (compare with Proposition 4.9.1). For the sake of completeness and

ON THE ARITHMETIC OF MONOIDS OF IDEALS

11

in order to compare it with Theorem 5.1, we also recall two results on the structure of sets of lengths and their unions.

Corollary 4.4. Let R be a weakly Krull Mori domain with nonzero conductor (R : R).
1. Iv(R) satisfies the Structure Theorem for Sets of Lengths. 2. Suppose that Rp×/Rp× is a torsion group for all p  X(R) and that Iv(R) has finite elasticity.
Then Iv(R) satisfies the Structure Theorem for Unions, and it is fully elastic if and only if there is q  X(R) such that Rq is half-factorial. If Iv(R) is not fully elastic, then R is a one-dimensional semilocal Mori domain with Cv(R) = 0.

Proof. 1. See [43, Theorem 7.4.3]. 2. The additional assumptions imply that Iv(R) has accepted elasticity ([41, Theorem 4.4.(ii)]),
whence it satisfies the Structure Theorem of Unions by [60, Theorem 1.2]. We set f = (R : R), P = {p  X(R) : p  f}, P = X(R) \ P, and

T=

(Rp·)red .

pP 

By (4.1), we obtain that

(4.2)

Iv(R) =

(Rp·)red = (Rp·)red × T = F (P) × T .

pX(R)

pP

The localization Rp is a discrete valuation domain if and only if p  P. For all p  P, Rp· is a primary Mori domain, whence it is strongly primary.
(i) Let q  X(R) such that Rq is half-factorial. Then

Iv(R) = (Rq·)red ×

(Rp·)red ×

(Rp·)red .

pP \{q} H1

pP \{q}

H2,1

H2,2

If X(R) = {q}, then Iv(H) is half-factorial, whence it is fully elastic. Suppose that X(R) = {q}. Then

H2 := H2,1 × H2,2 is a nontrivial monoid. Since H2,1 is free abelian, it has accepted elasticity. Since

Rp×/Rp× is a torsion group for all p  X(R) and since Iv(R) has finite elasticity, (Rp·)red has accepted

elasticity by [41, Lemma 4.1 and Theorem 4.4] for all p  P \ {q}. Thus H2 has accepted elasticity by

[41, Lemma 2.6]. Therefore, Iv(R) is fully (ii) Suppose that Rq is not half-factorial

elastic by for all q 

Proposition X(R). Then

3.2. X(R)

=

P

is

finite,

whence

Iv(R)

=

T

is a finite product of non-half-factorial strongly primary monoids, say T = T1 × . . . × Tn. Let i  [1, n].

By Proposition 4.2, there is   Q>1 such that (L)   for all L  L(Ti) with (L) = 1. We set

mi = Ti \ Ti× and we choose ai  mi with |L(ai )| > 1. If M = max{M(a1), . . . , M(an)}, then

mM i  miM(ai )  ai Ti .

Now let a  T with (L(a)) > 1. Then a = a1 · . . . · an and, after renumbering if necessary, we may assume
that (L(ai)) > 1 for all i  [1, m] and (L(ai)) = 1 for all i  [m + 1, n] with m  [1, n]. If i  [m + 1, n], then (L(ai)) = 1 implies that ai / mM i , whence L(ai) = {ki} for some ki  [0, M - 1]. Then

(L(a1

·...

· am))

=

max L(a1 · . . . · am) min L(a1 · . . . · am)

=

max L(a1) + min L(a1) +

... ...

+ max L(am) + min L(am)



,

and

(L(a))

=

max L(a1 · . . . · am) + km+1 + . . . + kn min L(a1 · . . . · am) + km+1 + . . . + kn

.

Thus, there is   Q>1 such that (L(a))   for all a  T with (L(a)) > 1, whence T = Iv(R) is not

fully elastic.

12

ALFRED GEROLDINGER AND M. AZEEM KHADAM

(iii) Suppose that Iv(R) is not fully elastic. Since v-spec(R) = X(R) ([47, Theorem 24.5]), the equivalence of (i) and (ii) shows that v-spec(R) is finite. Thus, v-max(R) = max(R) and R is one-
dimensional with Cv(R) = 0 by [34, Propositions 2.10.4 and 2.10.5].

4.2. Krull domains. Let H be a cancellative monoid. A divisor theory for H is a weak divisor theory  : H  D, where D is a free abelian monoid. The following statements are equivalent ([34, Chapter 2.4].
(a) H is a Krull monoid (i.e., H is a completely integrally closed Mori monoid). (b) The map  : H  Iv(H), defined by a  aH for all a  H, is a divisor theory. (c) H has a divisor theory  : H  F (P ). (d) There is a divisor homomorphism  : H  D, where D is a factorial monoid.
Let H be a Krull monoid. Then there is a free abelian monoid F (P ) such that the inclusion Hred  F (P ) is a divisor theory. Then
C(H) = q(F (P ))/q(Hred)
is called the (divisor) class group of H and GP = {[p] = pq(Hred) : p  P }  C(H) is the set of classes containing prime divisors. By the uniqueness of divisor theories, C(H) and the set GP  C(H) depend on H only. In particular, C(H) is isomorphic to Cv(H).
Theorem 4.5. Let R be a domain and r be an ideal system on R with Ir(R)  I(R). Then the following statements are equivalent.
(a) R is a Krull domain. (b) The monoid of principal ideals H(R) is a Krull monoid. (c) The monoid of invertible ideals I(R) is a Krull monoid. (d) The monoid of r-invertible r-ideals Ir(R) is a Krull monoid. (e) The monoid of v-invertible v-ideals Iv(R) is a Krull monoid. If these conditions hold, then the inclusion Ir(R)  Iv(R) is a divisor theory with class group C(Ir(R)) being isomorphic to Cv(R)/Cr(R). Moreover, if every class of Cv(R) contains at least one prime divisor resp. infinitely many prime divisors, then the same is true for C(Ir(R)).
Remark. Clearly, there is a redundancy in the above formulation. If r = d is the system of usual ideals, then Ir(R) = I(R) and if r = v is the system of divisorial ideals, then Ir(R) = Iv(R). But, we want to emphasize these two important special cases.
Proof. A monoid H is Krull if and only if the associated reduced monoid Hred is Krull and, clearly, H(R) = (R·)red. Thus (a) and (b) are equivalent by [34, Chapter 2]. Therefore, it remains to verify that (a) and (b) are equivalent to (d). We have
q(Ir(R)) = Fr(R)× and q(Iv(R)) = Fv(R)× .
By Equation (2.1), Fr(R)× is a subgroup of Fv(R)× and, in particular, r-ideal multiplication in Fr(R)× coincides with the v-multiplication. We continue with three assertions.
A1. H(R)  Ir(R) is a divisor homomorphism. A2. Ir(R)  Iv(R) is a divisor homomorphism. A3. If D is a Krull monoid and H  D is a divisor homomorphism, then H is a Krull monoid. Proof of A1. If a, b  R· such that aR | bR in Ir(R), then bR = aR ·r I for some I  Ir(R), and a-1bR = I  R implies that a | b in R. Proof of A2. Let I, J  Ir(R) such that I divides J in Iv(R). Then I-1J  Fr(R)×  Iv(R)  Fr(R)×  I(R) = Ir(R). Thus, the inclusion Ir(R)  Iv(R) is a divisor homomorphism. Proof of A3. If D is Krull, then there is a divisor homomorphism  : D  F , where F is a factorial monoid. Since the composition of divisor homomorphisms is a divisor homomorphism again, we obtain a divisor homomorphism H  D  F from H to a factorial monoid, whence H is a Krull monoid.

ON THE ARITHMETIC OF MONOIDS OF IDEALS

13

Suppose that (a) and (b) hold. Then Iv(R) is free abelian by [34, Theorem 2.3.11] and hence Krull. Thus, Ir(R) is Krull by A2 and A3, which means that (d) holds. Conversely, if (d) holds, then H(R) is Krull by A1 and A3.
Now suppose that (a) ­ (e) hold. Since the inclusion H(R)  Iv(R) is a divisor theory, every I  Iv(R) is a greatest common divisor of principal ideals and hence a greatest common divisor of r-invertible rideals. This, together with A2, shows that the inclusion Ir(R)  Iv(R) is a divisor theory with class group
q(Iv(R))/q(Ir(R)) = Fv(R)×/Fr(R)× = Fv(R)×/q(H(R)) Fr(R)×/q(H(R)) = Cv(R)/Cr(R) .
The monoid Iv(R) is free abelian with basis v-spec(R). If every class of Cv(R) contains at least one resp. infinitely many prime v-ideals, then the same is true for the factor group Cv(R)/Cr(R).
Thus, if R is a Krull domain, then the monoid I(R) of invertible ideals is a Krull monoid with class group isomorphic to Cv(R)/ Pic(R). This factor group shows a wide range of behavior. Daniel D. Anderson gave a characterization when the factor group is a torsion group and he showed that the factor group is trivial if and only if Rm is factorial for all m  max(R) ([2, Theorems 3.1 and 3.3]; see also [7]). We consider monoid algebras that are Krull. For a domain D and a cancellative monoid S, the monoid algebra D[S] has the following properties:
· D[S] is Krull if and only if D is Krull, S is Krull, q(S) is torsion-free, and S× satisfies the ACC on cyclic subgroups (this was first proved by Chouinard in [21]; see also [44, Theorem 15.6]).
· D[S] is seminormal if and only if D and S are seminormal ([17, Theorem 4.76]).

Corollary 4.6. Let D be a domain and S be a cancellative monoid such that the monoid algebra R = D[S] is Krull. Then I(R) is a Krull monoid with class group C(I(R)) = Cv(R)/ Pic(R), Cv(R) = Cv(D)  Cv(S), Pic(R) = Pic(D), and every class of Cv(I(R)) contains infinitely many prime divisors.
Proof. Since D[S] is Krull, the previous remark implies that D is a Krull domain and S is a Krull monoid, whence D and S are seminormal. Thus, the natural map
Pic(D[S]) - Pic(D)
is an isomorphism by [8, Corollary 1] (note, since D is completely integrally closed, D is strongly quasinormal in the sense of [8]). We have Cv(R) = Cv(D)  Cv(S) by [44, Corollary 16.8]. Since every class of Cv(R) contains infinitely many prime divisors by [25], the same is true for the factor group Cv(I(R)) by Theorem 4.5.

Most arithmetical results, valid for weakly Krull Mori monoids H, are established under the additional
assumption that H has nonempty conductor (H : H) to its complete integral closure. Now let R be a weakly Krull Mori domain. We already know that I(R) is a weakly Krull Mori monoid. The next corollary shows that, if R has nonzero conductor (R : R), then also I(R) has nonempty conductor,
whence all arithmetical results, valid for weakly Krull Mori monoids with nonempty conductor, also apply to I(R).

Corollary 4.7. Let R be a weakly Krull Mori domain with (R : R) = {0}. Then Iv(R) and I(R) are weakly Krull Mori monoids with (Iv(R) : Iv(R)) =  and with (I(R) : I(R)) = .

Proof. Iv(R) and I(R) are weakly Krull Mori monoids by Theorem 4.3, whence it remains to prove the statements on the conductor.
(i) To prove the claim on Iv(R), we use the same notation as in the proof of Corollary 4.4. Thus, we set f = (R : R), P = {p  X(R) : p  f}, P = X(R) \ P, and by Equation (4.2) we have

(4.3)

Iv(R) =

(Rp·)red = F (P) ×

(Rp·)red .

pX(R)

pP 

14

ALFRED GEROLDINGER AND M. AZEEM KHADAM

Note that P is finite. We use the following simple facts on the complete integral closure of cancellative monoids S1, S2, and S.
(a) If S = S1 × S2, then S = S1 × S2. Thus, if (Si : Si) =  for all i  [1, 2], then (S : S) = . (b) If (S : S) =  and p  X(S) = , then (Sp : Sp) = . Since (R : R) = {0}, it follows that (Rp· : Rp·) =  for all p  P. Thus, by the isomorphism in (4.3) and by Property (a), it follows that (Iv(R) : Iv(R)) = . (ii) Next we show that (I(R) : I(R)) = . By Theorem 4.5, the inclusion I(R)  Iv(R) is a divisor theory, whence Iv(R)  q I(R) = I(R). By (i), there is I  (Iv(R) : Iv(R)) = . Then there is J  Iv(R) and a  R such that I ·v J = (IJ )v = aR  (Iv(R) : Iv(R)). Then
(aR)I(R)  (aR)Iv(R)  q I(R)  Iv(R)  q I(R) = I(R) ,
whence aR  (I(R) : I(R)) = .

4.3. Transfer Krull monoids. A monoid homomorphism  : H  B is called a transfer homomorphism if it has the following properties: (T 1) B = (H)B× and -1(B×) = H×. (T 2) If u  H, b, c  B and (u) = bc, then there exist v, w  H such that u = vw, (v)  bB×,
and (w)  cB×.
Transfer homomorphisms allow to pull back arithmetical properties from B to H. In particular, we have LH (a) = LB((a)) for all a  H, whence L(H) = L(B). This implies that an element a  H is an atom of H if and only if (a) is an atom of B. A monoid H is called transfer Krull if there are a Krull monoid B and a transfer homomorphism  : H  B. A commutative ring R is said to be transfer Krull if its monoid R· of regular elements is a transfer Krull monoid.
If H is half-factorial, then  : H  (N0, +), defined by (u) = 1 for all u  A(H) and () = 0 for every   H×, is a transfer homomorphism, whence all half-factorial monoids are transfer Krull. Furthermore, all Krull monoids are transfer Krull (with  being the identity). Since transfer homomorphisms preserve lengths of factorizations, all transfer Krull monoids are BF-monoids but they need neither be v-noetherian nor completely integrally closed. We refer to [43, Example 5.4] for a list of transfer Krull monoids and domains that are not Krull. On the other hand, here are some monoids that are not transfer Krull.
· Int(Z) is not transfer Krull, by [29, Remark 12]. · The monoid of polynomials having non-negative integer coefficients is not transfer Krull, by [18,
Remark 54.]. · The monoid of finite nonempty subsets of the nonnegative integers (with set addition as operation)
is not transfer Krull, by [27, Proposition 4.12]. Moreover, let R be a weakly Krull Mori domain. Then Iv(R) is transfer Krull if and only if it is halffactorial (in the local case this follows from Proposition 4.2.1 and from Proposition 4.9; the general case is a simple consequence, see [43, Proposition 7.3] and also [14, Theorem 5.9]). For more results of this flavor, see the references given in the discussion before Corollary 4.4).
We continue with a simple lemma which we will use to show that the monoid of nonzero ideals over a polynomial ring with at least two variables is not transfer Krull (Theorem 5.1).
Lemma 4.8. Let H be a cancellative monoid and r be an ideal system on H. Suppose there is a non-r-cancellative ideal I  Ir(H), an ideal J1  A(Ir(H)), and a J2  Ir(H) \ A(Ir(H)) such that I ·r J1 = I ·r J2. Then Ir(H) is not a transfer Krull monoid.
Proof. Assume to the contrary that there are a Krull monoid B and a transfer homomorphism  : Ir(H)  B. Then (I)(J1) = (I)(J2), whence (J1) = (J2) because B is cancellative. Since J1 is an atom of Ir(H), (J1) = (J2) is an atom of B and hence J2 is an atom of Ir(H), a contradiction.

ON THE ARITHMETIC OF MONOIDS OF IDEALS

15

4.4. Arithmetic of transfer Krull monoids. The arithmetic of Krull monoids is determined by their class groups and by the distribution of prime divisors in the classes. There is an abundance of literature on the arithmetic of Krull monoids (see [34] and the survey [59]). We briefly summarize some results valid not only for Krull monoids but more generally for transfer Krull monoids, but we restrict for results on sets of lengths. This will allow us to compare them with the arithmetic of the monoids of ideals discussed in Section 5. In order to do so we recall the monoid of zero-sum sequences over an abelian group.
Let G be an additive abelian group and G0  G be a subset. An element S = g1 · . . . · g  F (G0), with   N0 and g1, . . . , g  G0, is called a sequence over G0. Then |S| =   N0 is the length of S, (S) = g1 + . . . + g  G is the sum of S, and
B(G0) = {T  F (G0) : (T ) = 0}  F (G0)
is the monoid of zero-sum sequences over G0. Since the inclusion B(G0)  F (G0) is a divisor homomorphism, B(G0) is a Krull monoid. As usual, we set L(G0) := L(B(G0)), (G0) := (B(G0)), and Uk(G0) := Uk(B(G0)) for all k  N.
Let B be a Krull monoid,  : B  D = F (P ) be a divisor theory, and let GP = {[p] : p  P }  G denote the set of classes containing prime divisors. The map
 : B  B(GP ), defined by (a) = [p1] · . . . · [p] ,
where (a) = p1 · . . . · p with p1, . . . , p  P , is a transfer homomorphism. Let H be a transfer Krull monoid and 1 : H  B be a transfer homomorphism to a Krull monoid
B. If G is an abelian group, G0  G a subset, and 2 : B  B(G0), then  = 2  1 : H  B(G0) is a transfer homomorphism from H to the monoid of zero-sum sequences over G0. In this case, we say that H is a transfer Krull monoid over G0. Since every Krull monoid has a transfer homomorphism onto a monoid of zero-sum sequences, every transfer Krull monoid has a transfer homomorphism to a monoid of zero-sum sequences. If H is a Krull monoid with class group G and every class contains at least one prime divisor, then H is a transfer Krull monoid over the class group G.
Proposition 4.9. Let H be a transfer Krull monoid and let  : H  B(G0) be a transfer homomorphism, where G0  G is a subset of an abelian group.
1. H is fully elastic. 2. If G0 is finite, then the elasticity (H) < , H satisfies the Structure Theorem for Sets of Lengths
as well as the Structure Theorem for Unions. 3. If G0 contains an infinite abelian group, then for every finite subset L  N2, there is a  H such
that L(a) = L, whence Uk(H) = N2 for all k  2.
Proof. 1. This follows from [42, Theorem 3.1]. 2. Suppose that G0 is finite. We have L(H) = L(G0), whence (H) = (G0), and Uk(H) = Uk(G0)
for all k  N. Since G0 is finite, B(G0) is finitely generated, whence (G0) <  by [34, Theorem 3.1.4]. Furthermore, H satisfies the Structure Theorem for Sets of Lengths by [34, Chapter 4.7] and the Structure Theorem for Unions by [32, Corollary 3.6 and Theorem 4.2].
3. Suppose that G0 contains an infinite abelian group G1. By [34, Theorem 7.4.1], every finite subset L  N2 lies in L(G1), and hence L  L(G1)  L(G0) = L(H). Since {2, k}  L(H) for every k  N2, it follows that U2(H) = N2, whence Uk(H) = N2 for every k  2 by Lemma 3.1.
Let  : H  B(G0) be as above. If G0 is a finite abelian group, then there is a rich literature on invariants controlling the structure of sets of lengths ([59]). The elasticity (H) can be finite even if G0 is infinite (if G is finitely generated, then [45] offers a characterization of when (H) is finite, and if (H) < , then also the Structure Theorem for Unions holds). The unions Uk(H) are intervals if G0 is a group, but they need not be intervals in general. There are Krull monoids that do not satisfy the Structure Theorem for Unions ([26, Theorem 4.2]), and there are Krull monoids that neither satisfy the Structure Theorem for Sets of Lengths nor does every finite subset L  N2 occur as a set of lengths.

16

ALFRED GEROLDINGER AND M. AZEEM KHADAM

5. On the monoid of nonzero ideals of polynomial rings

The main goal of this section is to prove the result given in Theorem 5.1. We start with a couple of remarks. Let D be a noetherian domain, n  2, S = (Nn0 , +), and R = D[S] = D[X1, . . . , Xn]. Then D is Krull if and only if D is integrally closed if and only if R is Krull if and only if I(D) resp. I(R) are
Krull (see Theorem 4.5). Furthermore, C(D) and C(R) are isomorphic, D is factorial if and only if R is factorial if and only if C(D) is trivial. If D is factorial (for example, if D is a field), then

(5.1)

{aR : a  R·} = I(R) = Iv(R) = Iv(R) and all these monoids are factorial.

In orders of Dedekind domains with finite class group, monoids of all nonzero ideals and monoids of invertible ideals have similar arithmetical properties ([16, 38, 14]). In contrast to (5.1) and in contrast to orders in Dedekind domains, our conjecture (Conjecture 5.12) is that the arithmetic of the monoid I(R) is completely different from the arithmetic of I(R) and that it is as wild as it is for Krull monoids with infinite class group and prime divisors in all classes (see Proposition 4.9.3). The main result of this section (Theorem 5.1) is a first step towards this conjecture.

Theorem 5.1. Let R = D[X1, . . . , Xn] be the polynomial ring in n  2 indeterminates over a domain D, and suppose that I(R) is a BF-monoid.
1. I(R) is neither transfer Krull nor locally finitely generated. Moreover, if D× is infinite, then I(R)
is not an FF-monoid. 2. Uk(I(R)) = N2 for all k  2. 3. LI(R)( X1, X2 k) = [2, k] for all k  2. 4. I(R) is fully elastic.

We briefly discuss the assumption that I(R) is a BF-monoid (made in Theorem 5.1, Lemma 5.3, and Conjecture 5.12). If R is noetherian or a one-dimensional Mori domain, then I(R) is a BF-monoid (see Proposition 2.2 and the discussion after Proposition 2.1). But the property, that I(R) is a BF-monoid, should be much weaker than the above two assumptions. A crucial property in this context is Krull's Intersection Theorem, which guarantees that the semigroup I(R) is unit-cancellative. We mention two further classes of polynomial rings which satisfy Krull's Intersection Theorem (for more on the validity of Krull's Intersection Theorem, we refer to [4, 47]).
(i) Let D be a domain, D its integral closure (in the quotient field of D), and let D be any domain with D  D  D. The integral closure of D[X1, . . . , Xn] equals D[X1, . . . , Xn], and we have
D[X1, . . . , Xn]  D[X1, . . . , Xn]  D[X1, . . . , Xn] .
If D is noetherian, then D[X1, . . . , Xn] is noetherian, whence D[X1, . . . , Xn] satisfies Krull's Intersection Theorem by [1, Theorem 5]. Moreover, if D is noetherian, then D is Krull and if D is Krull, then D[X1, . . . , Xn] is a Krull domain with class group isomorphic to C(D) and infinitely prime divisors in all classes (compare with Corollary 4.6). (ii) If the integral closure R of R = D[X1, . . . , Xn] in some field extension of the quotient field of R is noetherian, then R satisfies Krull's Intersection Theorem by [48, Proposition 2.6].
We proceed in a series of lemmas. Let R be a domain and X1, X2  R·. For all i  N, we consider the following four families of non-zero ideals of R:
(i) ai(X1, X2) := X1, X2 i, (ii) bi(X1, X2) := X1i, X2i , (iii) c2i+1(X1, X2) := {X12i+1, X12iX2}  {X12i-jX2j+1 : j  [1, 2i + 1] is even } , and (iv) c2i(X1, X2) := {X12i, X12i-1X2}  {X12i-j X2j : j  [1, 2i] is even} .
Lemma 5.2. Let R be a domain and X1, X2  R·. 1. a1(X1, X2)k = ak(X1, X2) for all k  N.

ON THE ARITHMETIC OF MONOIDS OF IDEALS

17

2. ak(X1, X2) · b(X1, X2) = ak+(X1, X2) for all k,   N with k   - 1. 3. a1(X1, X2) · c2k+1(X1, X2) = a2k+2(X1, X2) for all k  N. 4. a1(X1, X2) · c2k(X1, X2) = a2k+1(X1, X2) for all k  N.
Proof. This follows by direct calculations.

Lemma 5.3. Let R be a domain such that I(R) is a BF-monoid. Suppose there exist distinct X1, X2  R· such that a1(X1, X2), b2(X1, X2), and c2i+1(X1, X2) are atoms of I(R) for all i  N. Then I(R) has the following properties.
1. I(R) is not a transfer Krull monoid. 2. I(R) is not locally finitely generated. 3. Uk(I(R)) = N2 for all k  2.

Proof. 1. By Lemma 5.2 (items 1 and 2), we obtain that

a1(X1, X2) · b2(X1, X2) = a3(X1, X2) = a1(X1, X2) · a2(X1, X2) .
Therefore, Lemma 4.8 implies that I(R) is not transfer Krull. 2. By Lemma 5.2.3, the divisor-closed submonoid [[a1(X1, X2)]]  I(R) contains infinitely many atoms,
whence I(R) is not locally finitely generated. 3. By Lemma 3.1.3, it suffices to prove that U2(I(R)) = N2. Since c2i+1(X1, X2) is an atom of I(R)
for all i  N, Lemma 5.2.3 implies that

{  N :   0 mod 2}  U2(I(R)).

Furthermore, by Lemma 5.2 (items 2 and 3), we observe that

a2i(X1, X2) · b2(X1, X2) = a2i-1(X1, X2) · a3(X1, X2) = a2i+2(X1, X2) = a1(X1, X2) · c2i+1(X1, X2)

for all i  N, whence

{  N3 :   1 mod 2}  U2(I(R)) .

Lemma 5.4. Let R be a domain and q be a p-primary ideal of R for some p  spec(R). Let q = IJ, where I and J are ideals of R such that q I, J R. Then Rad I = Rad J = p.
Proof. Since p = Rad q = Rad I  Rad J, so either Rad I = p or Rad J = p, say Rad I = p. It remains to prove that Rad J = p. Clearly p  Rad J. Conversely, if g  Rad J, then there exists some positive integer s such that gs  J. Since q I, so there exists an element f  I \ q. As f gs  IJ = q and f  q, therefore there exists some positive integer t such that gst  q and hence g  Rad q = p.
From now on till the end of the proof of Theorem 5.1, we fix the following notation. Let D be a domain with quotient field K, R = D[X1, . . . , Xn], and S = K[X1, . . . , Xn] be the polynomial rings in n  2 variables X1, . . . , Xn. They are equipped with the natural N-grading such that deg(X1) = . . . = deg(Xn) = 1. We set
R = t0Rt, and S = t0St ,
where Rt  St are the corresponding t-components. Every f  S can be written uniquely in the form f = i0 fi with fi  Si for every i  N0. We denote by < the lexicographic order on monomials of K[X1, . . . , Xn] with X1 > X2 > . . . > Xn. For f  K[X1, . . . , Xn], we denote by in(f ) the initial monomial of f with respect to the order <.
The min-degree m-deg(f ) of a nonzero polynomial f  S is the smallest non-negative integer d such that fd is non-zero. We set m-deg(0) = +. The m-deg function satisfies the following two properties for all f, g  S·:
(i) m-deg(f g) = m-deg(f ) + m-deg(g), and (ii) m-deg(f + g)  min {m-deg(f ), m-deg(g)}, with equality if m-deg(f ) = m-deg(g).

18

ALFRED GEROLDINGER AND M. AZEEM KHADAM

Next we introduce the minimal degree of an ideal of R. Let I  R be an ideal. We define the mindegree m-deg(I) of I to be the smallest non-negative integer d such that I contains a polynomial whose min-degree is equal to d. We set the min-degree of the zero ideal equal to +.
The next lemma says that the map
m-deg : I(R) - N0 given by I - m-deg(I)
is a semigroup homomorphism.

Lemma 5.5. For every I, J  I(R), we have m-deg(IJ) = m-deg(I) + m-deg(J).
Proof. We set d = m-deg(I), e = m-deg(J), m = m-deg(IJ), and we choose f  I with m-deg(f ) = d, g  J with m-deg(g) = e, and h  IJ such that m-deg(h) = m. By the above property (i), we have m  d + e. On the other hand, we have h = f1g1 + . . . + fsgs, where fi  I and gi  J for all i  [1, s]. Then the above property (ii) implies that
m = m-deg(h)  min{m-deg(fi) + m-deg(gi) : i  [1, s]}  d + e .

Let I, J  I(R). We set I[i] = {fi : f  I} and note that I[i]  Ri is a D-module. For i, j  N0,

k

I[i] · J[j] =

asbs : k  1, as  I[i], bs  J [j]

s=1

is also a D-module. Let IK [i] = SpanK { I[i] }, JK [j] = SpanK { J[j] } and, for m  N0, (IJ)K [m] = SpanK { (IJ )[m] }. Clearly, IK [i]  Si, JK [j]  Sj, and (IJ )K [m]  Sm, whence IK [i], JK[j], (IJ )K [m]
are finite dimensional K-vector spaces.

Lemma 5.6. Let I, J  I(R) with m-deg(I) = d, m-deg(J) = e, and m-deg(IJ) = m.
1. (IJ)[m] = I[d] · J[e]. 2. (IJ )K [m] = IK [d] · JK [e].

Proof. 1. Let a  (IJ)[m]. Then there exists h  IJ such that hm = a, say h =

k i=1

f

(i)g(i),

where

f (i)  I and g(i)  J for all i  [1, k]. By Lemma 5.5, we obtain that a = hm =

k i=1

fd(i)ge(i),

whence

a  I[d] · J[e]. Conversely, if a  I[d] · J[e], then a =

k i=1

ai

bi

where

ai



I[d], bi



J [e]

for

all

i  [1, k]. Thus, there exist f (i)  I, g(i)  J such that fd(i) = ai and ge(i) = bi for all i  [1, k]. Hence

h=

k i=1

f

(i)g(i)



IJ

with

hm

=

a



(I J )[m].

2. Let a  (IJ)K [m]. Then, by definition, a =

r =1

(

/

)h

,

where

r



N,

h



(I J )[m],

 ,   D and  = 0 for every   [1, r]. By 1. , we obtain h =

s j =1

aj( )bj( ),

where

aj( )



I [d]

and

bj()  J [e] for every j  [1, s]. Hence,

r s

a=

( / aj())bj()  IK [d] · JK [e] .

=1 j =1

Conversely, let

r =1

a b



IK [d]·JK [e].

Then

a

=

s j

=1

(,j

/,j

)aj( )

and

b

=

t k

=1

(,k

/,k

)bk()

,

where aj()  I[d], bk()  J [e] and ,j , ,j , ,k , ,k  D with ,j = 0 = ,k for all , j , k . If we

denote  =

s j =1

,j

and



=

t k

=1

,k

,

then

a b

can

be

written

as

s t

a b = (1/  )

j ,k aj( )bk() ,

j =1 k =1

ON THE ARITHMETIC OF MONOIDS OF IDEALS

19

where all j,k  D. Setting  =

r 

=1



and



=

r =1



we

obtain

that

r

r s t

ab = (1/)

j ,k aj( )bk(),

=1

=1 j =1 k =1

where all j,k  D. Therefore, (

r =1

a b )



I [d]

·

J [e]

and

hence,

again

by

using

1. ,

we

get

r

( ab) = hm,

=1

where h  IJ. Thus, we obtain that

r =1

a b



(IJ)K [m].

Before moving further we demonstrate in a simple special case how our techniques work for studying factorizations in the monoid of non-zero ideals of polynomial rings.

Example 5.7. 1. We claim that the ideal X2, Y 2 is an atom of I(K[X, Y ]). Assume to the contrary that there are
two non-zero proper ideals I, J of K[X, Y ] with m-deg(I) = d, m-deg(J) = e and

X2, Y 2 = IJ.

By Lemma 5.6 we obtain

(5.2)

SpanK {X2, Y 2} = IK [d] · JK [e],

and we have d + e = 2 by Lemma 5.5. Furthermore, we have Rad I = Rad J = X, Y , whence d = e = 1.

Clearly dimK I[d]  1 and dimK J[e]  1. Assume to the contrary that one of these dimensions equals

one, say IK [d] = SpanK {f } and JK [e] = SpanK {g1, . . . , gs}. Then X2 =

s j=1

j

f

gj

where

j



K

for

all j  [1, s]. This implies that f = X for some   K×, which is not possible since Y 2  IK [d] · JK [e].

Therefore, dimK IK [d]  2 and dimK J[e]  2. Since IK [d], JK [e]  SpanK {X, Y }, it follows that IK [d] = JK [e] = SpanK {X, Y }. This implies that IK [d] · JK [e] = SpanK {X2, XY, Y 2}, a contradiction to (5.2).

2. We claim that the ideal X3 + Y 3, X2Y, XY 2 is an atom of I(K[X, Y ]). Assume to the contrary that there are two non-zero proper ideals I, J of K[X, Y ] with m-deg(I) = d, m-deg(J) = e and

X3 + Y 3, X2Y, XY 2 = IJ.

By Lemma 5.6 we obtain

(5.3)

SpanK {X3 + Y 3, X2Y, XY 2} = IK [d] · JK [e],

and we have d + e = 3 by Lemma 5.5. Since X, Y 4  X3 + Y 3, X2Y, XY 2 , we infer that Rad I =

Rad J = X, Y . Thus, d, e  1, and after renumbering if necessary we suppose that d = 1 and e = 2.

Clearly dimK I[d]  1 and dimK J[e]  1. Assume to the contrary that one of these dimensions equals

one, say IK [d] = SpanK {f } and JK [e] = SpanK {g1, . . . , gs}. Then X2Y =

s j=1

j

f

gj

where

j



K

for all j  [1, s]. This implies that f = X or f = Y for some ,   K×, which is not possible since

X3 + Y 3  IK [d] · JK [e]. Therefore, dimK IK [d]  2 and dimK J[e]  2. Since IK [d]  SpanK {X, Y }, it follows that IK [d] = SpanK {X, Y }. For every i  [1, s], we have Xgi  IK [d] · JK [e] and thus, by (5.3),

X gi = i,1(X 3 + Y 3) + i,2X 2Y + i,3X Y 2

where i,j  K for every j  [1, 3]. This implies that i,1 = 0 and gi = i,2XY + i,3Y 2. Similarly, Y gi  IK [d] · JK [e] yields
Y gi = i,1(X 3 + Y 3) + i,2X 2Y + i,3X Y 2
where i,j  K for every j  [1, 3]. This implies that i,1 = 0 and gi = i,2X2 + i,3XY . Hence i,3 = i,2 = 0 and gi = i,2XY . Therefore, JK [e] = SpanK {XY }, a contradiction to dimK JK [e]  2.

20

ALFRED GEROLDINGER AND M. AZEEM KHADAM

3. The following equation
X2, Y 2 X3 + Y 3, X2Y, XY 2 = X, Y 5
involves only atoms of I(K[X, Y ]), whence it shows that 2, 5  LI(K[X,Y ])( X, Y 5).
Example 5.7.1 was already settled in [48, Proposition 4.6], but our techniques allow us to study larger classes of polynomial ideals over arbitrary domains (see Proposition 5.10). For m  N0, let Mm;1,2 denote the set of all monomials of the form X1rX2s with r + s = m and r, s  N0.
Lemma 5.8. The ideals
c(X1, X2) = X13 + X23, X12X2, X1X22 and a(X1, X2) = {X1m, X2m}  N , where m  N and N  Mm;1,2 is any subset, are X1, X2 -primary in R. In particular, if c(X1, X2) = IJ or a(X1, X2) = IJ, where I and J are proper ideals of R, then m-deg(I)  1 and m-deg(J)  1.
Proof. We set c := c(X1, X2) and a := a(X1, X2). It is a well known fact that if an ideal q  R is p-primary, then its extension q[X]  R[X] is p[X]-primary, cf. [9, Exercise 4.7 (iii)]. We proceed by induction on the number of indeterminates n  2.
Let n = 2. Then the ideal extensions cK[X1, X2] and aK[X1, X2] are X1, X2 K[X1, X2]-primary, because X1, X2 K[X1, X2]4  cK[X1, X2], X1, X2 K[X1, X2]2m-1  aK[X1, X2] and X1, X2 K[X1, X2] is a maximal ideal. Therefore the ideal contractions cK[X1, X2]  D[X1, X2] and aK[X1, X2]  D[X1, X2] are X1, X2 K[X1, X2]  D[X1, X2]-primary. If we prove that X1, X2 K[X1, X2]D[X1, X2]  X1, X2 , cK[X1, X2]D[X1, X2]  c and aK[X1, X2]D[X1, X2]  a,
then we are done. Let f / = g  X1, X2 K[X1, X2]  D[X1, X2], where f  X1, X2 , g  D[X1, X2] and   D·. Then g  X1, X2 and hence g  X1, X2 .
Let now f / = g  cK[X1, X2]  D[X1, X2], where f  c, g  D[X1, X2] and   D·. Then g  c and it only requires to show that g  c. But g  c implies that g = (X13 +X23)+g21X12X2 +g12X1X22 + g, where , g21, g12  D and g  D[X1, X2] with m-deg(g) = 4. Since g  X1, X2 4  c, so g  c.
Let now f / = g  aK[X1, X2]  D[X1, X2], where f  a, g  D[X1, X2] and   D·. Then g  a and hence by using similar calculations as above we get g  a.
Assume now the result is true for n  2 and consider the ring R[Xn+1]. So c[Xn+1] and a[Xn+1] are X1, X2 [Xn+1]-primary ideals of R[Xn+1], but in R[Xn+1] we have
c[Xn+1] = c, a[Xn+1] = a and X1, X2 [Xn+1] = X1, X2 .
Thus a and c are X1, X2 -primary. The in particular statement follows by Lemma 5.4.

Lemma 5.9. Let V  Sd, with d  N, be a K-vector subspace of dimension dimK (V ) = s. Then there are linearly independent elements f1, . . . , fs  V such that in(f1) > . . . > in(fs).

Proof. Let g1, . . . , gs be linearly independent elements of V . If we consider the canonical isomorphism

Sd

=

K

( ) d+n-1 d

,

then

g1, . . . , gs

will

represent

the

corresponding

linearly

independent

vectors

of

V



K

( ) d+n-1 d

.

Let A be an s ×

d+n-1 d

matrix whose rows are g1, . . . , gs.

Now we apply the Gaussian

elimination on A and reduce it to row echelon form. The resulting matrix is represented by rows, say

f1, . . . , fs  V , which are again linearly independent elements and satisfy our requirement in(f1) > . . . >

in(fs).

Proposition 5.10. The following ideals cannot be written as a product of two proper ideals of R.
1. bi(X1, X2) for every i  N, 2. c2i+1(X1, X2) for every i  N, 3. c2i(X1, X2) for every i  N3, and 4. c(X1, X2) = X13 + X23, X12X2, X1X22 .

ON THE ARITHMETIC OF MONOIDS OF IDEALS

21

Proof. For all i  N, we use the abbreviations bi := bi(X1, X2), c2i+1 := c2i+1(X1, X2), c2i := c2i(X1, X2), and c := c(X1, X2).
1. Let i  N and assume to the contrary that bi = IJ with bi I, J R such that m-deg(I) = d and m-deg(J) = e. Then, by Lemma 5.8, we have d  1 and e  1, and by Lemma 5.6.2 we obtain that

(5.4)

SpanK {Xi, Y i} = IK [d] · JK [e].

Note that IK [d] and JK [e] are finite vector spaces and by Equation 5.4 it is not possible that dimK IK [d] =

dimK JK [e] = 1. Thus, without loss of generality, we may assume that dimK IK [d]  2 and dimK JK [e] 

1. Let f1, f2  IK [d] be linearly independent and g  JK [e] any non-zero element.

By Lemma 5.9, we may assume that in(f1) > in(f2). If in(fi) does not equal X1d or X2d, then in(fig) (=

in(fi) in(g)) does not equal X1i or X2i, which is not possible by (5.4). This means we must have in(f1) = X1d

and in(f2) = X2d. If in(g) = X1e, in(g) = X1a1 · . . . · Xnan such that

then in(f2g) =

n j=1

ai

=

e

with

X1eX2d, a1 < e

a contradiction to (5.4). If in(g) = X1e, say and aj  1 for some j  [2, n], then in(f1g) is

divisible by X1Xj, again a contradiction to (5.4).

2. Let i  N and assume to the contrary that c2i+1 = IJ with c2i+1 I, J R such that m-deg(I) = d and m-deg(J) = e. Then, by Lemma 5.8, we have d  1 and e  1, by Lemma 5.5, we have 2i + 1 = d + e,

and Lemma 5.6.2 implies that

(5.5) SpanK {{X12i+1, X12iX2}  {X12i-jX2j+1 : j  [1, 2i + 1] and j  0 mod 2}} = IK [d] · JK [e].
We claim that dimK I[d]  2 and dimK J[e]  2. Indeed, if IK [d] = SpanK {f } and JK [e] = SpanK {g1, . . . , gs}, then IK [d] · JK [e] = SpanK {f g1, . . . , f gs}. From (5.5), we get
s
X12i+1 = jf gj, where j  K for all j  [1, s] ,
j=1

and we deduce f = X1d for some   K×. Hence X22i+1 cannot belong to IK [d] · JK [e], a contradiction to (5.5).

Let dimK I[d] = r  2 and f1, f2, . . . , fr  IK [d] be linearly independent such that in(f1) > in(f2) >

. . . > in(fr) (we use Lemma 5.9). Similarly, let dimK JK [e] = s  2 and let g1, . . . , gs  JK [e] be

linearly independent such that in(g1) > . . . > in(gs). If in(f1) = X1d, then in(f1g) = X12i+1 for any

g  JK [e], which is not possible by 5.5. Thus, we have in(f1) = X1d, and hence in(g1) = X1e. Without

loss of generality assume that d is odd, while e is even. If in(f2) = X1d-uX2u for an even u  N, then

in(f2g1) = X1d+e-uX2u, a contradiction to (5.5). If in(f2) = X1d-uX2u for an odd u  N, then we consider

in(g2). If in(g2) = X1e-vX2v for an odd v  N, we get a contradiction as in(f2g2) = X1d+e-u-vX2u+v. If

in(g2) = X1e-vX2v for an even v  N, we get a contradiction as in(f1g2) = X1d+e-vX2v. Note that a case of

in(fi0 ) = X1j1 · . . . · Xnjn (similarly for gi0 ) with

n =1

j

=

d

and

j

>

0

for

some





[3, n]

is

not

possible

by the same argument.

3. Let i  N3 and assume to the contrary that c2i = IJ with c2i I, J R such that m-deg(I) = d and m-deg(J) = e. Then, by Lemma 5.8, we have d  1 and e  1, by Lemma 5.5, we have 2i = d + e,
and Lemma 5.6.2 implies that

(5.6)

SpanK {{X12i, X12i-1X2}  {X12i-jX2j : j  [1, 2i] and j  0 mod 2}} = IK [d] · JK [e].

As in 2., IK [d] and JK [e] are finite dimensional vector spaces of dimension at least two. Moreover, since i  3, dimK IK [d] or dimK JK [e] must be at least three, say dimK I[d]  3. Let dimK I[d] = r  3
and let f1, . . . , fr  IK [d] be linearly independent such that in(f1) > in(f2) > . . . > in(fr) (again we use Lemma 5.9). Similarly, let dimK JK [e] = s  2 and let g1, . . . , gs  JK [e] be linearly independent such that in(g1) > . . . > in(gs). As in 2., we have in(f1) = X1d, and hence in(g1) = X1e.
Consider now f2 and g2 such that in(f2) = X1d-aX2a and in(g2) = X1e-bX2b, where a, b  N. We distinguish two cases.
CASE 1: a = 1.

22

ALFRED GEROLDINGER AND M. AZEEM KHADAM

If b is even, then in(f2g2) = X1d+e-b-1X2b+1 which is not possible, see (5.6). If b  3 is odd, then in(f1g2) = X1d+e-bX2b which again is not possible. Thus, b = 1 and dimK JK [e] = 2. Consider now f3 such that in(f3) = X1d-cX2c with c  N2. If c is even, then in(f3g2) = X1d+e-c-1X2c+1, a contradiction to (5.6), and if c is odd, then in(f3g1) = X1d+e-cX2c, again a contradiction to (5.6). Hence dimK IK [d] = 2, which is not possible.
CASE 2: a  2. If a is odd, then in(f2g1) = X1d+e-aX2a we get a contradiction to (5.6). Therefore, a is even and, hence
b is also even. In general, there are only the following possibilities for in(fu) and in(gv):

in(fu) = X1d-auX2au with all au are even and 0 = a1 < . . . < ar  d

and

in(gv) = X1e-bv X2bv with all bv are even and 0 = b1 < . . . < bs  e.

Now as X12i-1X2  IK [d] · JK [e], so X12i-1X2 =

r u=1

s v=1

uv fu gv

with uv  K for every u, v.

If

11 = 0, then initial monomial of the right hand side would be X12i, a contradiction. If 11 = 0, then

X12i-1X2 = in

rs
uv fu gv
u=1 v=1

 max in(fugv) : u  [1, r], v  [1, s]

which

is

not

possible,

since

the

right

hand

side

of

the

above

inequality

is

X X d+e-au0 -bv0 au0 +bv0

1

2

which

is always less than X12i-1X2.

4. Assume to the contrary that c = IJ with c I, J R such that m-deg(I) = d and m-deg(J) = e.

Then, by Lemma 5.8, we have d  1 and e  1, by Lemma 5.5, we have d + e = 3, and Lemma 5.6.2

implies that

(5.7)

SpanK {X13 + X23, X12X2, X1X22} = IK [d] · JK [e].

We may assume that d = 1 and e = 2. We claim that dimK I[d]  2 and dimK J[e]  2. Indeed, if
IK [d] = SpanK {f } and JK [e] = SpanK {g1, . . . , gs}, then IK [d] · JK [e] = SpanK {f g1, . . . , f gs}. From (5.7), we get

s
X12X2 = jf gj, where j  K for all j  [1, s] ,
j=1

and we deduce either f = X1 or f = X2 for some ,   K×. Hence X13 + X23 cannot belong to IK [d] · JK [e], a contradiction to (5.7). Note that similar argument works if we consider d = 2.
Let dimK I[d] = r  2 and let f1, . . . , fr  IK [d] be linearly independent such that in(f1) > . . . > in(fr) (we use Lemma 5.9). Similarly, let dimK JK [e] = s  2 and let g1, . . . , gs  JK [e] be linearly independent such that in(g1) > . . . > in(gs). On the other hand, for j  [3, n] in(fi0 ) = Xj is not possible, whence
dimK I[d] = 2 and in(f1) = X1, in(f2) = X2. Similarly, we obtain that dimK J[e] = 2 and in(g1) = X12, in(g2) = X1X2. Assume g1 = X12 + aX22 + · · · . Then by (5.7)

f2g1 = 1(X13 + X23) + 2X12X2 + 3X1X22,

where 1, 2, 3  K

which implies that a = 0. Similarly, the coefficient of the term X22 in g2 is zero as well. This shows that X13 + X23 does not belong to IK [d] · JK [e], a contradiction.

Remark 5.11. If 2 is a unit of D, then c4(X1, X2) = X14, X13X2, X12X22, X24 = X12, X1X2 + X22 X12, X1X2 - X22 ,
whence c4(X1, X2) is not an atom of I(R).

ON THE ARITHMETIC OF MONOIDS OF IDEALS

23

Proof of Theorem 5.1. 1. and 2. We need to show the claim concerning the finite factorization property. All other statements follow by Lemma 5.3 and Proposition 5.10 (clearly, a1(X1, X2) is an atom). Suppose that D× is infinite. For every   D×, we have the identity
X1, X2 · X12 + X22, X1X2 = X1, X2 3 . If ,   D× are distinct, then X12 + X22, X1X2 = X12 + X22, X1X2 . Thus, the element X1, X2 3 has infinitely many divisors, whence I(R) is not an FF-monoid by [34, Proposition 1.5.5].
3. In order to show that LI(R)(ak(X1, X2))  [2, k] for all k  2, we choose   N2 and consider a factorization ak(X1, X2) = I1 · . . . · I, where I1, . . . , I are atoms in I(R). By Lemma 5.8, we have m-deg(Ij )  1 for all j  [1, ]. Using Lemma 5.5 we obtain that

k = m-deg(ak) = m-deg(Ij )   ,
j=1
whence   k and LI(R)(ak(X1, X2))  [2, k]. To verify the reverse inclusion we proceed by induction on k. This is clear for k = 2. By Lemma 5.2.2 (with  = 2 and k = 1), we obtain that
a3(X1, X2) = a1(X1, X2) · b2(X1, X2) .
Since the involved ideals are atoms by Proposition 5.10.1, the assertion holds for k = 3. Suppose that claim holds for k  3. Since ak+1(X1, X2) = a1(X1, X2) · ak(X1, X2) and a1(X1, X2) is an atom, it follows that
[3, k + 1]  1 + L(ak(X1, X2))  L(ak+1(X1, X2)) . It remains to verify that 2  L(ak+1(X1, X2)). If k  N3\{4}, then the following identity (see Lemma 5.2)
ak+1(X1, X2) = a1(X1, X2) · ck(X1, X2)
together with Proposition 5.10 show that 2  L(ak+1(X1, X2)). If k = 4, then 2  L(ak+1(X1, X2)) because a5(X1, X2) = b2(X1, X2) · c(X1, X2) (use Proposition 5.10.4).
4. We set p0 = X1 , H1 = F ({p0}) and H2 = {a  I(R) : p0  a}. Since p0 is an invertible prime ideal, it is a cancellative prime element of I(R), whence we get that
I(R) = H1 × H2 .
Note that ak(X1, X2)  H2 for all k  N. Thus, 3. shows that Conditions (a) and (b') of Proposition 3.2 hold, whence I(R) is fully elastic.
Theorem 5.1 shows, among others, that unions of sets of lengths of the monoid of all nonzero ideals are equal to N2, as it is true for transfer Krull monoids (which include monoids of invertible ideals of Krull domains) with infinite class group and prime divisors in all classes (Proposition 4.9). We post the conjecture that also their sets of lengths coincide, namely that every finite subset L  N2 occurs as a set of lengths. We first formulate this conjecture and then further support it by comparison with the monoid of finite subsets of the nonnegative integers.
Conjecture 5.12. Let R = D[X1, . . . , Xn] be the polynomial ring in n  2 indeterminates over a domain D, and suppose that I(R) is a BF-monoid. Then, for every finite subset L  N2 there is a  I(R) such that LI(R)(a) = L.
Let us consider the power monoid of N0, that is the semigroup Pfin(N0) of finite nonempty subsets of N0 with set addition as operation (i.e., for finite nonempty subsets A, B  N0, their sumset A + B is defined as A + B = {a + b : a  A, b  B}). Then Pfin(N0) is a commutative reduced unit-cancellative semigroup (whence a monoid in the present sense) and {0} is its zero-element. Power monoids are objects of primary interest in additive combinatorics and their arithmetic is studied in detail by Fan and Tringali in [27]. Among others, they show that unions of sets of lengths of Pfin(N0) are equal to N2 and that the set of distances equals N. The standing conjecture is that every finite subset L  N2 occurs as a set of

24

ALFRED GEROLDINGER AND M. AZEEM KHADAM

lengths of Pfin(N0) ([27, Section 5]). Our final example shows that the monoid of nonzero ideals I(R) of R = D[X1, . . . , Xn] has a submonoid that is isomorphic to Pfin(N0).

Example 5.13. Let R = D[X1, . . . , Xn] be as in Conjecture 5.12 (thus, as in Theorem 5.1). We consider
the monoid M(X1, X2) of all monomial ideals in the indeterminates X1, X2. This is a submonoid of I(R). Recall that, for every m  N0, we denote by Mm;1,2 the set of all monomials of the form X1rX2s with r + s = m and r, s  N0. Let M2(X1, X2)  M(X1, X2) consist of all ideals

N  {X2m} ,
where m  N0 and N  Mm;1,2 is any subset (note that, for example, X2 and X13, X12X2, X23 are in M2(X1, X2), whereas X13, X12X2 and X12 do not belong to M2(X1, X2)). Then M2(X1, X2)  I(R) is a submonoid.
For A  Pfin(N0), say A = {m1, . . . , m} with   1 and 0  m1 < m2 < . . . < m. We denote by

IA :=

X1m-m1

X2m1

,

X1m

-m2

X2m2

,

.

.

.

,

X1m

-m-1

X m-1
2

,

X2m

an ideal which clearly belongs to M2(X1, X2). Thus, we obtain a map

Pfin(N0) - M2(X1, X2) , given by A - IA ,

which is easily seen to be a monoid isomorphism. Therefore, I(R) has a submonoid that is isomorphic to the additive monoid Pfin(N0).

Acknowledgement. We would like to thank our colleagues, Rob Eggermont, Azhar Farooq, Florian Kainrath, Andreas Reinhart, and Daniel Smertnig, for many helpful discussions.

References

[1] D.D. Anderson, The Krull intersection theorem, Pac. J. Math. 57 (1975), 11 ­ 14.

[2] D.D. Anderson, Globalization of some local properties in Krull domains, Proc. Am. Math. Soc. 85 (1982), 141 ­ 145.

[3] D.D. Anderson, J.R. Juett, and C.P. Mooney, Factorization of ideals, Comm. Algebra 47 (2019), no. 4, 1742­1772.

[4] D.D. Anderson, J. Matijevic, and W. Nichols, The Krull intersection theorem II, Pac. J. Math. 66 (1976), 15 ­ 22.

[5] D.D. Anderson and M. Roitman, A characterization of cancellation ideals, Proc. Am. Math. Soc. 125 (1997), 2853 ­

2854.

[6] D.D. Anderson and M. Zafrullah, Integral domains in which nonzero locally principal ideals are invertible, Comm.

Algebra 39 (2011), no. 3, 933­941. MR 2782574

[7] D.F. Anderson, A general theory of class groups, Commun. Algebra 16 (1988), 805 ­ 847.

[8]

, The Picard group of a monoid domain, J. Algebra 115 (1988), 342 ­ 351.

[9] M.F. Atiyah and I.G. Macdonald, Introduction to Commutative Algebra, Addison-Wesley, 1969.

[10] N.R. Baeth and R. Sampson, Upper triangular matrices over information algebras, Linear Algebra Appl. 587 (2020),

334 ­ 357.

[11] N.R. Baeth and D. Smertnig, Arithmetical invariants of local quaternion orders, Acta Arith. 186 (2018), 143 ­ 177.

[12] P. Baginski, S.T. Chapman, C. Crutchfield, K.G. Kennedy, and M. Wright, Elastic properties and prime elements,

Result. Math. 49 (2006), 187 ­ 200.

[13] P. Baginski, S.T. Chapman, M. Holden, and T. Moore, Asymptotic elasticity in atomic monoids, Semigroup Forum

72 (2006), 134 ­ 142.

[14] A. Bashir, A. Geroldinger, and A. Reinhart, On the arithmetic of stable domains, Commun. Algebra, to appear.

[15] V. Blanco, P. A. Garc´ia-S´anchez, and A. Geroldinger, Semigroup-theoretical characterizations of arithmetical invariants

with applications to numerical monoids and Krull monoids, Illinois J. Math. 55 (2011), 1385 ­ 1414.

[16] J. Brantner, A. Geroldinger, and A. Reinhart, On monoids of ideals of orders in quadratic number fields, in Advances

in Rings, Modules, and Factorizations, vol. 321, Springer, 2020, pp. 11 ­ 54.

[17] W. Bruns and J. Gubeladze, Polytopes, Rings, and K-Theory, Springer, 2009.

[18] F. Campanini and A. Facchini, Factorizations of polynomials with integral non-negative coefficients, Semigroup Forum

99 (2019), 317 ­ 332.

[19] S.T. Chapman, F. Gotti, and M. Gotti, Factorization invariants of Puiseux monoids generated by geometric sequences,

Comm. Algebra 48 (2020), 380 ­ 396.

[20] S.T. Chapman, M. Holden, and T. Moore, Full elasticity in atomic monoids and integral domains, Rocky Mt. J. Math.

36 (2006), 1437 ­ 1455.

ON THE ARITHMETIC OF MONOIDS OF IDEALS

25

[21] L.G. Chouinard II, Krull semigroups and divisor class groups, Can. J. Math. 33 (1981), 1459 ­ 1468.

[22] E.D. Davis, Prime elements and prime sequences in polynomial rings, Proc. Amer. Math. Soc. 72 (1978), no. 1, 33­38.

[23] A.K. Dutta and N. Onoda, On finite generation of R-subalgebras of R[X], J. Algebra 320 (2008), no. 1, 57­80.

[24] V. Fadinger and D. Windisch, A characterization of weakly Krull monoid algebras, https://arxiv.org/abs/2009.04182.

[25]

, On the distribution of prime divisors in Krull monoid algebras, https://arxiv.org/abs/2101.04398.

[26] Y. Fan, A. Geroldinger, F. Kainrath, and S. Tringali, Arithmetic of commutative semigroups with a focus on semigroups

of ideals and modules, J. Algebra Appl. 11 (2017), 1750234 (42 pages).

[27] Y. Fan and S. Tringali, Power monoids: A bridge between factorization theory and arithmetic combinatorics, J. Algebra

512 (2018), 252 ­ 294.

[28] M. Fontana, E. Houston, and T. Lucas, Factoring Ideals in Integral Domains, Lecture Notes of the Unione Matematica

Italiana, vol. 14, Springer, 2013.

[29] S. Frisch, A construction of integer-valued polynomials with prescribed sets of lengths of factorizations, Monatsh. Math.

171 (2013), 341 ­ 350.

[30] S. Gabelli, Locally principal ideals and finite character, Bull. Math. Soc. Sci. Math. Roumanie (N.S.) 56(104) (2013),

no. 1, 99­108. MR 3076694

[31] S. Gabelli and M. Roitman, On finitely stable domains I, J. Comm. Algebra 11 (2019), 49 ­ 67.

[32] W. Gao and A. Geroldinger, On products of k atoms, Monatsh. Math. 156 (2009), 141 ­ 157.

[33] A. Geroldinger, F. Gotti, and S. Tringali, On strongly primary monoids with a focus on Puiseux monoids, J. Algebra

567 (2021), 310 ­ 345.

[34] A. Geroldinger and F. Halter-Koch, Non-Unique Factorizations. Algebraic, Combinatorial and Analytic Theory, Pure

and Applied Mathematics, vol. 278, Chapman & Hall/CRC, 2006.

[35] A. Geroldinger and W. Hassler, Local tameness of v-noetherian monoids, J. Pure Appl. Algebra 212 (2008), 1509 ­

1524.

[36] A. Geroldinger, F. Kainrath, and A. Reinhart, Arithmetic of seminormal weakly Krull monoids and domains, J.

Algebra 444 (2015), 201 ­ 245.

[37] A. Geroldinger, S. Ramacher, and A. Reinhart, On v-Marot Mori rings and C-rings, J. Korean Math. Soc. 52 (2015),

1 ­ 21.

[38] A. Geroldinger and A. Reinhart, The monotone catenary degree of monoids of ideals, Internat. J. Algebra Comput.

29 (2019), 419 ­ 457.

[39] A. Geroldinger and M. Roitman, On strongly primary monoids and domains, Comm. Algebra 48, 4085 ­ 4099.

[40] A. Geroldinger, W.A. Schmid, and Q. Zhong, Systems of sets of lengths: transfer Krull monoids versus weakly Krull

monoids, in Rings, Polynomials, and Modules, Springer, Cham, 2017, pp. 191 ­ 235.

[41] A. Geroldinger and Q. Zhong, Long sets of lengths with maximal elasticity, Can. J. Math. 70 (2018), 1284 ­ 1318.

[42]

, Sets of arithmetical invariants in transfer Krull monoids, J. Pure Appl. Algebra 223 (2019), 3889 ­ 3918.

[43]

, Factorization theory in commutative monoids, Semigroup Forum 100 (2020), 22 ­ 51.

[44] R. Gilmer, Commutative Semigroup Rings, The University of Chicago Press, 1984.

[45] D.J. Grynkiewicz, The characterization of finite elasticities, https://arxiv.org/abs/2012.12757.

[46] F. Halter-Koch, Divisor theories with primary elements and weakly Krull domains, Boll. Un. Mat. Ital. B 9 (1995),

417 ­ 441.

[47]

, Ideal Systems. An Introduction to Multiplicative Ideal Theory, Marcel Dekker, 1998.

[48] A.J. Hetzel, A.L. Lawson, and A. Reinhart, On finite molecularization domains, J. Commut. Algebra 13 (2021), 69 ­

87.

[49] J. Juett, Generalized comaximal factorization of ideals, J. Algebra 352 (2012), 141 ­ 166.

[50] J.R. Juett, C.P. Mooney, and L. W. Ndungu, Unique factorization of ideals in commutative rings with zero divisors,

Communications in Algebra 49 (2021), no. 5, 2101­2125.

[51] F. Kainrath, On some arithmetical properties of noetherian domains, Advances in Rings, Modules and Factorizations,

Springer Proc. Math. Stat., vol. 321, Springer, 2020, pp. 217 ­ 222.

[52] L. Klingler and A. Omairi, Unique decomposition into ideals for commutative Noetherian rings, J. Pure Appl. Algebra

224 (2020), no. 9, 106364, 12.

[53] H. Matsumura, Commutative Ring Theory, Cambridge university press, 1989.

[54] J.S. Oh, On the algebraic and arithmetic structure of the monoid of product-one sequences, J. Commut. Algebra 12

(2020), 409 ­ 433.

[55] J.S. Oh and Q. Zhong, On minimal product-one sequences of maximal length over dihedral and dicyclic groups,

Communications of the Korean Math. Soc. 35 (2020), 83 ­ 116.

[56] B. Olberding and A. Reinhart, Radical factorization in commutative rings, monoids, and multiplicative lattices, Algebra

Universalis 80 (2019), Article 24.

[57]

, Radical factorization in finitary ideal systems, Commun. Algebra 48 (2020), 228 ­ 253.

[58] A. Reinhart, Structure of general ideal semigroups of monoids and domains, J. Commut. Algebra 4 (2012), 413 ­ 444.

26

ALFRED GEROLDINGER AND M. AZEEM KHADAM

[59] W.A. Schmid, Some recent results and open problems on sets of lengths of Krull monoids with finite class group, in

Multiplicative Ideal Theory and Factorization Theory, Springer, 2016, pp. 323 ­ 352.

[60] S. Tringali, Structural properties of subadditive families with applications to factorization theory, Israel J. Math. 234

(2019), 1 ­ 35.

[61] Q. Zhong, On elasticities of locally finitely generated monoids, J. Algebra 534 (2019), 145­167.

[62]

, On the arithmetic of Mori monoids and domains, Glasgow Math. Journal 62 (2020), 313 ­ 322.

University of Graz, NAWI Graz, Institute of Mathematics and Scientific Computing, Heinrichstraße 36, 8010 Graz, Austria
Email address: alfred.geroldinger@uni-graz.at, azeem.khadam@uni-graz.at URL: https://imsc.uni-graz.at/geroldinger, https://sites.google.com/view/azeemkhadam

