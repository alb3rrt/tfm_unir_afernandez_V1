arXiv:2106.00836v1 [math.DS] 1 Jun 2021

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS
JIMMY TSENG
Abstract. Consider a shrinking neighborhood of a cusp of the unit tangent bundle of a noncompact hyperbolic surface of finite area, and let the neighborhood shrink into the cusp at a rate of T -1 as T  . We show that a closed horocycle whose length  goes to infinity or even a segment of that horocycle becomes equidistributed on the shrinking neighborhood when normalized by the rate T -1 provided that T /  0 and, for any  > 0, the segment remains larger than max T -1/6, (T /)1/2 (T /)-. We also have an effective result for a smaller range of rates of growth of T and .

Contents

1. Introduction

1

1.1. Test functions on cusps

2

1.2. Statement of results

3

1.3. Outline of the main proofs

5

Acknowledgements

5

2. Auxiliary functions and the double coset decomposition

5

3. An application of the method of stationary phase

7

3.1. Proof of Proposition 3.1

8

4. Renormalizing a shrinking neighborhood to a fixed neighborhood

16

5. Horocycle equidistribution for fixed functions

18

6. Proof of Theorem 1.1

21

7. Proof of Theorem 1.2

26

8. Proof of Theorem 3.4

28

References

29

1. Introduction

Let G := PSL2(R),   G be a cofinite Fuchsian group, 1, · · · , q  R  {} be inequivalent cusps with stabilizer groups 1, · · · , q where q  N, H be the upper-half plane model of the hyperbolic plane, and T 1H be its unit tangent bundle. We may assume, by conjugation
of , that 1 =  and has stabilizer group

1 :=  :=

1b 01

bZ .

The author was supported by EPSRC grant EP/T005130/1. 1

2

JIMMY TSENG

The cusp 1 is called the standard cusp. The group G acts on H and T 1H as follows: for any

 :=

a c

b d

 G, we have

(1.1)

(z) =

az + b cz + d

(z, ) =

az cz

+ +

b d

,



-

2

arg(cz

+

d)

.

Let z := x + iy. We may identify G with T 1H via the mapping   (i, 0) and also identify \G with \T 1H. The Haar measure µ on G (which is unique up to a multiplicative constant) is identified with the Liouville volume measure y-2dx dy d on T 1H. Let T 1 (\H) be the unit tangent bundle of the surface \H. Then we have T 1 (\H) = \T 1H except at elliptic fixed points (where \H is an orbifold).
Let  <  be real numbers and consider the horocycle {(x + iy, 0) :   x  }. As y  0,
this horocycle equidistributes, namely

1 -

 

f (x

+

iy, 0)

dx



1 µ(\G)

f (z, ) dµ
\G

for any f  Cc (\G). Such equidistribution results have been studied by many mathematicians such as Zagier [16], Sarnak [12], Hejhal [4, 5], Flaminio and Forni [3], and Stro¨mbergsson [13,

14]. A natural question, asked by Hejhal, is the question of what happens if  - also shrinks.

Clearly, if  - shrinks too quickly relative to y, then the horocycle can not equidistribute. If,

however,  -   yC()-, then the horocycle equidistributes uniformly, as Hejhal [4] showed

for the exponent C() = 1/3 and Stro¨mbergsson [14] showed for the best possible exponent

C() = 1/2. Some of these results are even effective, namely an error rate is computed.

In this paper, we study another natural and related question, namely the question of what

happens if we take a family of test functions with supports shrinking into one of the cusps at a rate of, say, T -1 for T  . If y shrinks fast enough and  -  does not shrink too fast,

then we would expect the horocycle to equidistribute uniformly, provided that we divide by the rate T -1:

(1.2)

T


· dx 

1

· dµ

- 

µ(\G) \G

as T   and y  0.

Let us refer to (1.2) as shrinking target horocycle equidistribution (STHE) for such a family of test functions. Shrinking target horocycle equidistribution is what we show in this paper (see Theorem 1.1) for a large collection of such test functions. A necessary condition for STHE, for our large collection of test functions, is T y  0. On the other hand, if T y  0, then there are cases for which STHE does not hold (even if  -  is fixed). See Example 1.3. With more constraints on the various rates, we can also show an effective result (see Theorem 1.2).

1.1. Test functions on cusps. Before we define our test functions, let us briefly describe
the space that contains their support. To each cusp j, there is an element j  G (called a scaling matrix) such that j = j and j-1jj = . We require that 1 be the identity element of G. Let F  [0, 1] × (0, )  H be a canonical fundamental domain for the action of  on H and F be its topological closure (in the Riemann sphere). By modifying j for j  {2, · · · , q}, we can ensure that

(1.3)

j-1(F )  {z  H : y  B} = [0, 1] × [B, )

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

3

holds for all j  {1, · · · , q} and for all B  B0 > 1 (see [14, (2.2)] or [6, Page 268]). Here B0 is a fixed constant depending on . Note that F × [0, 2) is a fundamental domain for the action of  on T 1H.
For any cusp j, we will define our test functions in two steps. The first step is to construct suitable functions with support in [0, 1] × [B1, ) × [0, 2). For a set S  (0, ), define its
indictor function ½S : (0, )  [0, 1] by

½S(y) :=

1 0

yS

.

y  (0, )\S

Let

h

:

R/Z × R/(2Z)



C

be

a

C-

function

and

h2(x, )

:=



2 h(x,) x2

.

Choose a fixed

constant B1 > B0. holds. Then define

Let T  B1 and  be a real number for which min
fT,0 := ½[T,)(y)h(x, ), which is our main interest

B1 -B0 2

,

in this

1 4

 || > 0

paper. But,

in order to give an effective result (see Theorem 1.2), we will use (and also give results for)

approximations by the smooth functions fT, := ½[T,),(y)h(x, ). Here, ½[T,), : (0, )  [0, 1] is an approximation to ½[T,),0(y) := ½[T,)(y) defined by the C-function ½[T,),(y) := ½[-T +/2,)  ||/2(y - 2T ) where  denotes convolution and   Cc(R) is the well-known mollifer defined in (6.1). Note that 0  ½[T,),  1 and

supp(½[T,),) 

[T - ||, ) [T, )

if  < 0 . if  > 0

The second step is to use (1.3) to construct, for each fT,, the related automorphic function on T 1(H) defined by

T,(z, ) := (T,j)(z, ) :=

fT,(j-1(z, )).

j \

Here,  can also be zero. Note that, as fT, is supported in the unit tangent bundle of the
standard cusp, all but at most one term in the automorphic function (T,j) is zero. Of course,
the functions (T,j) themselves are supported in the cusp j. The collection of T(,j) is our collection of test functions.

1.2. Statement of results. Our two main results, Theorems 1.1 and 1.2, both give shrinking target horocycle equidistribution. Theorem 1.2 is effective while Theorem 1.1 allows for a larger range of the rate of growth of T versus decay of y (or, more precisely, the decay of T y). Note that T y  0 is necessary; see Example 1.3.

Theorem 1.1. Let j  {1, · · · , q},  > 0, T > y, and 0 < T y < 1. Then we have

T -

 

(T,0j )(x

+

iy, 0)

dx



1 µ(\G)

2 0

1
h(x, ) dx d
0

as T   and T y  0, uniformly for

 -   max

T -1/6,

Ty B1

1/2

Ty B1

-
.

4

JIMMY TSENG

Theorem

1.2.

Let

0





<





1,

j



{1, · · ·

, q},

1 2





>

0,

T

- min

B1-B0 2

,

1 4

> y, and

0

<

Ty

<

3 4

.

Then,

for



=

0,

we

have

T -


(T,j)(x + iy, 0) dx 
 T(,j) + E(, , T, y, B1, s1, s1, ) + O =  T(,j) + E(, , T, y, B1, s1, s1, ) + O

T y /2

B1

Ty B1

 + 1
T

if  = 0 or  = 1 if  = 0 and  = 1

and, for  = 0 and any 0 < ||  min

B1 -B0 2

,

1 4

, we have

T -

(T,0j)(x + iy, 0) dx 
 T(,0j) + E(, , T, y, B1, s1, s1, ) + O =  T(,0j) + E(, , T, y, B1, s1, s1, ) + O

Ty B1

/2

+

1 T

Ty B1



+

1 T

if  = 0 or  = 1 if  = 0 and  = 1

as T   and T y  0, uniformly for

1   -   max

T4

Ty B1

1/2
, T -1/6

Ty B1

-
.

Here,

(T,j )

=

T µ(\G)

2 0

1 0

0



½[T

,),(y)h(x,

)

dydxd y2

,

(T,0j )

=

1 µ(\G)

2 0

1
h(x, ) dx d,
0

E(, , T, y, B1, s1, s1, ·) := O T 4| · |-4

×

Ty ( - )2B1

1/2
log2

( - )B1 Ty

+

Ty ( - )2B1

1-s1
+

Ty

1-s1

( - )B1

,

s1, s1 are as in (5.1), and the implied constants (including the one coming from E) depend on , 1, j, and h.

We also give an example of a case for which T y  0:

Example 1.3. For this example, set  = PSL(2, Z). Define

gT,0(z, ) := ½[T,)(y) g00(z, ) := ½[2,)(y)

and

T,0(z, ) :=

gT,0((z, )) 00(z, ) :=

g00((z, )).

\

  \

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

5

Let T y = 1/4. Then (1.4) as T  , but

T

1 0

T ,0 (x

+

iy, 0)

dx

=

 3 2

2 µ(\G)

\G

00(p)

dµ(p)

=

1 µ(\G)

2 0

1 0

dx d =

3 

.

Note that the derivation of (1.4) follows easily from Proposition 3.1. The gist of this derivation is to consider the left-hand side of (1.5) without the limit but, instead, with x set to 2.

Remark 1.4. If, in the example, we let T y  0, then Theorem 1.1 applies, from which the

identity

(1.5)

lim 2
x

x

 (c) x2 - c2

c

x2

=

3 

c=1

follows by Proposition 3.1. Here (·) is the Euler totient function and · is the floor function.

Thus, we have obtained a number-theoretic identity. The same identity will also follow from

applying a version of Proposition 3.1 to [14, Theorem 2] (or the other versions of horocycle

equidistribution mentioned above).

1.3. Outline of the main proofs. The basic idea is to eliminate the growth of T by renormalizing in the y-coordinate to a fixed value B1 (see Section 4) and to apply the usual horocycle equidistribution (see Section 5). Dealing with general h(x, ·) is a difficulty, which we handle by taking the Fourier expansion of h(x, ·) and using the double coset decomposition to reduce the integral over the horocycle to a sum of integrals, the latter of which, using the method of stationary phase, we show for the non-constant Fourier modes to be negligible. This allows us to replace h(x, ·) with its average. See Section 3. Dealing with general  -  is another difficulty, which we handle by taking the Fourier expansion of a suitable smoothing and applying a theorem of Jackson to handle the high Fourier modes. See Sections 6 and 7 in which the proofs of Theorems 1.1 and 1.2, respectively, are given.

Acknowledgements. I wish to thank Jens Marklof for helpful discussions.

2. Auxiliary functions and the double coset decomposition

In this section, we define functions to help us study, throughout the paper, our test functions (T,j) and, to both these auxiliary functions and our test functions, we will develop a useful expansion via the double coset decomposition.

The auxiliary functions that we would like to define are as follows. Let mw(y) := wy for w  C. Consider

1
gT,(z, ) := ½[T,),(y) h(t, ) dt 0

T,(z, ) := (T,j)(z, ) :=

gT,(j-1(z, )),

j \

1

f0(z, ) := ½[T,),  m T (y) h(t, ) dt

B1

0

0(z, ) := 0,(j)(z, ) :=

f0(j-1(z, )).

j \

6

JIMMY TSENG

Note that, since  is small (see Section 1.1), the support of f0 in the y-variable is approximately [B1, ).
More generally, we can consider a cuspidal function in the unit tangent bundle of the standard cusp f : T 1(\H)  C such that the support of f (z, ) is [B0, ) in the y-
variable. We note that f is periodic: f (z + 1, ) = f (z, ) = f (z,  + 2). We can now define a family of automorphic functions on T 1(H) by

(j)(z, ) :=

f (j-1(z, )) =

f ((z, ))

j \

  \j-1 

for each j  {1, · · · , q}. The double coset decomposition (see [7, Section 2.4] for example) allows us, furthermore, to write

(2.1) where

(j)(z, ) = 1j f (z, ) +

f ((z + n, ))

nZ \j-1/ =

 := 

1 0

0 1

,

1j :=

1 0

if j = 1

.

if j  {2, · · · , q}

Note that  =  can only occur in the case j = 1.
The following expansion, which applies to the auxiliary functions and our test functions, is the key setting of our proofs. For conciseness of notation, we will use e(w) := e2iw for any
w  C.

Lemma 2.1. Let m  Z. We have

1

1

(j)(x + iy, 0) e(mx) dx = 1j f (x + iy, 0) e(mx) dx

0

0

+y a
 c

b d

  \j-1 /


f
-

a c

-

1 c2y

x

1 +

i , -2

arg(x

+

i)

e

mxy

-

m

d c

dx.

c>0

Proof. In the double coset decomposition, the condition 

a c

b d

 =  is equivalent to

the condition c > 0. Summing over n, we have


f
-

a(x + iy) + b c(x + iy) + d)

,

-2

arg(cx

+

d

+

icy)

e(mx) dx


=f
-

a c

-

1 c2

x

1 +

iy

,

-2

arg(x

+

iy)

e

mx

-

m

d c

dx,

where we have changed variables x + d/c  x and simplified. To obtain the desired result, we again change variables x/y  x.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

7

3. An application of the method of stationary phase

In this section, we state Proposition 3.1, its corollary (Corollary 3.3), and a generalization of the corollary (Theorem 3.4). We prove Proposition 3.1 and Corollary 3.3, leaving the proof of Theorem 3.4 to Section 8 . Proposition 3.1 is the most important tool in this paper. It comes from an application of the method of stationary phase to the relevant integrals in Lemma 2.1. See Corollary 3.7.

Proposition 3.1. Let j  {1, · · · , q} and m  Z. If T -min

B1 -B0 2

,

1 4

> y, then, as T  ,

we have that

1(T,j)(x + iy, 0)e(mx) dx
0

=O

1 T 3/2



+y a
 c

b d

  \j-1 /

B  -B

1
h(t, -2 arg(x + i)) dt
0

e

mxy

-

m

d c

dx

c>0

where B := max{1/T yc2 - 1, 0} and the implied constant depends on h, 1, and j.

Remark 3.2.
(1) Note that, for fixed T and y, the sum over the double cosets is finite because B = 0 when c is large.
(2) Also, note that there is aminimum strictly positive c (which depends on the cusps 1 and j) in this setup. If B is strictly less than this minimum, then
1 (T,0j)(x + iy, 0)e(mx) dx = 0.
0
As the corollary of the proposition, we note that the constant term of the Fourier expansion of h with respect to x gives the dominant behavior for our setup.

Corollary 3.3. Let j  {1, · · · , q}, m  Z, and T - min

B1 -B0 2

,

1 4

> y. Then, as T  ,

we have that

1

1

(T,j)(x + iy, 0)e(mx) dx = (T,j)(x + iy, 0)e(mx) dx + O

0

0

1 T 3/2

where the implied constant depends on h, 1, and j. Here,  is a real number such that

||  min

B1 -B0 2

,

1 4

.

Proof. Apply the proposition to (T,j) and Lemma 2.1 to (T,0j). For  = 0, the error between

the application of Lemma 2.1 to (T,0j) and to (T,j) is O

|| T 3/2

where the implied constant

depends on h, 1, and j. The proof is the same as the proof of the analogous additional error in the proof of Proposition 3.1. This yields the desired result.

8

JIMMY TSENG

More generally, we have

Theorem 3.4. Let j  {1, · · · , q}, T - min

B1-B0 2

,

1 4

> y,

1 2



> 0.

Then,

as

T

 ,

we have that

(T,j)(x + iy, 0) dx =  (T,j)(x + iy, 0) dx + O





1 T

so long as  -  remains bounded and bigger than T -3/4+. Here,  is a real number such

that ||  min

B1 -B0 2

,

1 4

and the implied constant depends on h, 1, j, and the maximum

value of  - .

3.1. Proof of Proposition 3.1.

Proof of Proposition 3.1. We first give the proof for (T,0j). Let f = fT,0 and c > 0. Let us compute


f
-

a c

-

1 c2y

x

1 +

i , -2

arg(x

+

i)

e

mxy

-

m

d c

dx.

Now

f

a c

-

1 c2y

x

1 +

i,



= ½[T,)

1 yc2(x2 + 1)

h

a c

-

1 yc2

x x2 +

1,



,

which is zero if

(3.1)

x2  1/T yc2 - 1 =: A

does not hold. If A < 0, then (3.1) cannot hold for any value of x, and, thus, the integral is zero.
Otherwise, when A  0, (3.1) holds for some values of x, and, thus, the integral may be nonzero. We now estimate the integral when A  0. Note that, since A  0, we have

(3.2)

T yc2  1

 holds, and we can replace the integration bounds with - A to A. By smoothness and

periodicity, we have the Fourier series representation of h,

h(x,

)

=

jZ

h(j,

)e(-jx)

=

jZ

h2(j, ) -42j2

e(-jx).

We consider the integral term-by-term (because the Fourier series converges uniformly to h).

Thus, for each j  Z, we need to evaluate the following integral:

I(T, j) := e

-m

d c

-

j

a c

 A
 eiT p(x)q(x) dx
-A

where

p(x)

:=

2j(A

+

1)

x2

x +

1

,

q(x) := h(j, -2 arg(x + i))e(mxy).

We wish to compute the asymptotics of the integral as T  , uniformly for all A  0 and all y  0, using the method of stationary phase (see, for example, [11] for an introduction). The stationary points are x = ±1.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

9

For convenience, let us introduce the following notation. Let X be a topological space. The function g : X  C is locally zero at x0  X if there exists an open neighborhood U of x0 in X such that g(x) = 0 for every point x  U .

Lemma 3.5. Let j  Z\{0}. We have that

where

I(T ) = I1(T ) + I-1(T )

I1(T ) := 

OO

h(j,-/2)
|j|T
h(j,0)

O

|j|T
 |h(j,-2 arg(+i))|+|h(j,-2 arg( A+i))|
jT

+o

1 j2T

I-1(T ) :=



O O

h(j,/2)
|j|T
h(j,1)

O

|j|T
 |h(j,-2 arg(+i))|+|h(j,-2 arg(- A+i))|
jT

+o

1 j2T

if h(j, -/2) = 0

if h(j, -/2) = 0 and

h(j, )

is

not

locally

zero

at



=

-

 2

if

h(j,

)

is

locally

zero

at



=

-

 2

if h(j, /2) = 0

if h(j, /2) = 0 and

h(j, )

is

not

locally

zero

at



=

 2

if

h(j, )

is

locally

zero

at



=

 2

as T  . Here 0 and 1 are any values in [0, 2) for which h(j, 0) = 0 and -1 <  < 1 is any value bounded away from both -1 and 1. The first implied constant of the third case for
I-1(T ) depends on h and the first implied constant of the third case for I1(T ) depends on h. All other implied constants have no dependence.

Remark 3.6.

· One can choose 0 arbitrarily close to -/2 and 1 arbitrarily close to /2 if desired.

· The error terms o

1 j2T

can be replaced by o

1 jT

where  is any natural number

because h is a C-function.

· The dependence on h in the two implied constants can be made explicit by inspection

of the proof below.

·

In

the

case

that

h(j, )

is

locally

zero

at



=

 2

and



=

-

 2

,

we

can

have





I(T ) = O

|h(j, -2 arg( A + i))| + |h(j, -2 arg(- A + i))| jT

+o

1 jT

where where  is any natural number. Here, the first implied constant depends on h (and can be made explicit) and the second has no dependence.

Proof. We assume that j  1. The proof for j  -1 is analogous. We break I(T ) into four (or, if A  1, two) integrals so that {±1, ±A} appears as only one endpoint (and the other

10

JIMMY TSENG

endpoint of each integral does not matter). To start, let us assume that h(j, /2) = 0 and h(j, -/2) = 0. We will remove thisassumption at the end. There are a number of cases of which we start with the case 1 < A. The stationary points (except in a special case of h(j, -2 arg(x + i)) being locally zero at both -1 and 1, detailed below) will contribute the main term and we consider them first. Let us first consider an integral of the form

I1+(T ) := e

-m

d c

-

j

a c


eiT p(x)q(x) dx
1

where



:=

 A.

Using

Taylor

series

for

-p(x)

and

q(x),

we

have

that,

as

x



1+,

-p(x) + p(1)  1 j(A + 1)(x - 1)2, 2

q(x)  h(j, -/2)e(my)

and, thus, the function q(x)/p(x) is of bounded variation over every closed interval [k, ]

where k  (1, ) because both the numerator and denominator are of bounded variation and

the denominator is bounded away from zero. Now we may apply [11, Chapter 3, Theorem 13.1]

to obtain



I1+(T ) 

 2

e

-m

d c

-

j

a c

e-i/4h(j,

-/2)e(my)

(

1 2

eiT p(1) j(A + 1)T

)1/2

as T   uniformly for all A > 1 and y  0. Now substituting A = 1/T yc2 - 1 from (3.1) yields

(3.3)

I1+(T )



1 e 2

-m

d c

-

j

a c

+

j

1 2yc2

-

1 8

h(j, -/2)e(my) cjy

as T  . Applying (3.2) gives

I1+(T ) = O

h(j, -/2) jT

as T  . Here the implied constant has no dependence.

Let

I1-(T ) := e

-m

d c

-

j

a c

1
eiT p(x)q(x) dx


where -1 <  < 1. Then the analogous proof gives

I1-(T ) = O

h(j, -/2) jT

as T  . In fact, (3.3) holds when I1+(T ) is replaced by I1-(T ). Let I-+1(T ) and I--1(T ) denote the analogous integrals for the stationary point -1, then the analogous proof gives

I-+1(T ) = O

h(j, /2) jT

= I--1(T )

as T  . The implied constants for these latter three integral also have no dependence. When A = 1, only the integrals I1-(T ) and I-+1(T ) are needed.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

11

For 0  A < 1, we must consider the two analogous integrals I- (T ) and I+ (T ). To

A

-A

obtain a result uniform in A  0, we write

I-A(T ) = e

-m

d c

-

j

a c

1

1

eiT p(x)q(x) dx -  eiT p(x)q(x) dx ,



A

from which it immediately follows that

I-A(T ) = O

h(j, -/2) jT

as T  . Similarly, for I-+A(T ), we have that

I-+A(T ) = O

h(j, /2) jT

as T  . The implied constants for these two integrals have no dependence. This proves

the desired result in the cases for which both h(j, /2) = 0 and h(j, -/2) = 0.

Finally let us consider when h(j, -/2) = 0 or h(j, /2) = 0. As we have seen, the integrals

I1±(T )

and

I- (T )
A

depend

on

h(j, -/2)

and

the

integrals

I-±1(T )

and

I+ (T )
-A

depend

on

h(j, /2). Let us assume that h(j, -/2) = 0. There are two cases to consider.

The first case is that h(j, -2 arg(x + i)) is not locally zero at x = 1. Thus, we have that,

for every  > 0, there exists x  (1 - , 1 + ) such that h(j, -2 arg(x + i)) = 0. Let 0 be

chosen such that h(j, 0) = 0. We note that





I1+(T ) = e

-m

d c

-

j

a c

A

A

eiT p(x) q(x) + h(j, 0) dx -

eiT p(x)h(j, 0) dx .

1

1

Apply the above proof for I1+(T ), we obtain

I1+(T ) = O

h(j, 0) jT

as T  . Similarly, we have

I1-(T ) = O

h(j, 0) jT

= I-A(T )

as T  . The implied constants have no dependence for any of these estimates. Note that [11, Chapter 3, Theorem 13.2] does not apply to the first case as the hypothesis on bounded variation does not hold.
The second case is that h(j, -2 arg(x + i)) is locally zero at x = 1. Thus, we have that,
there exists a  > 0 for which h(j, -2 arg(x + i)) = 0 for every x  (1 - , 1 + ). Let N denote
the union of all open intervals U containing 1 such that h(j, -2 arg(x + i)) = 0 for every x  U . Since we are in the second case, N is not the empty set. Thus, we have N =: (r, s) where r < s are unique values determined solely by h. Here r may be - and s may be . We note that h(j, -2 arg(x + i)) = 0 for every x in the topological closure N . If s is finite,
then there exists an interval (s, s+) such that h(j, -2 arg(x + i)) = 0 for every x  (s, s+).

12

JIMMY TSENG

Likewise, if r is finite, then there exists an interval (r-, r) such that h(j, -2 arg(x + i)) = 0

for every x  (r-, r).



Let us consider the case 1 < A first.

If N



 (1, A),

then

I1+(T )

=

0.

Otherwise, we

have that A > s > 1. Let x0  (s, s+). We note that

I1+(T ) = e

-m

d c

-

j

a c





A

A

eiT p(x)q1(x) dx +

eiT p(x)q2(x) dx

s

s

where q1(x) := q(x) - q(x0) and q2(x) = q(x0). Using Taylor series, we have, as x  s+,

-p(x)

+

p(s)



2j(A

+

1)

s2 - 1 (s2 + 1)2

(x

-

s),

q1(x)  -q(x0),

q2(x)  q(x0).

We may now apply [11, Chapter 3, Theorem 13.2] to obtain, as T  ,

I1+(T ) = e

-m

d c

-

j

a c

q(A)eiT p(A) iT p( A)

+

1(T )

+

2(T )

where



1(T

)

:=

1 iT

s

A

eiT

p(x)

d dx



q1(x) -p(x)

dx

=

-

1 42ij2T

s

A

eiT

p(x)

d dx

h2(j, -2 arg(x + i))e(mxy) - h2(j, -2 arg(x0 + i))e(mx0y) -p(x)

dx

=o

1 j2T

,



2(T

)

:=

1 iT

s

A

eiT

p(x)

d dx



q2(x) -p(x)

dx

=

-

1 42ij2T

s

A

eiT

p(x)

d dx

h2(j, -2 arg(x0 + i))e(mx0y) -p(x)

dx

=o

1 j2T

.

Here the three implied constants have no dependence. Note the expressions for 1(T ) and 2(T ) follow immediately from integration by parts for I1+(T ), and the third equality for both 1(T ) and 2(T ) follow from the Riemann-Lebesgue lemma (see [11, Chapter 3, (13.03) and

Section 13.3]). Consequently, we have, as T  ,



I1+(T ) = O

h(j, -2 arg( A + i)) jT

+o

1 j2T

.

Note

that,

since

A

>

s2

>

1,

we

have

that

-2j

<

p

 ( A)

<

2j

2 s2+1

-

1

is bounded away

from zero. Here the first implied constant depends on s and the second implied constant has

no dependence. As s is uniquely determined by h, we can also state that the first implied

constant depends on h.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

13

Next we consider the integral I1-(T ) for  (which, in our notation, denotes the lower integration bound) such that -1 <  < 1 is bounded away from -1. If N  (, 1), then I1-(T ) = 0. Otherwise, we have that  < r < 1. Now, by the analogous proof for I1+(T ), we have, as T  ,

I1-(T ) = e

-m

d c

-

j

a c

q()eiT p() -iT p()

+

(T )

where (T ) = o

1 j2T

. Here the implied constants have no dependence. Now, as -T p() =

2j

2 -1 yc2 (2 +1)2

,

we

have,

by

(3.2),

that

I1-(T ) = O

h(j, -2 arg( + i)) jT

+o

1 j2T

as T  . Here the first implied constant depends on r and the second has no dependence.

As r is uniquely determined by h, Now, for the case A = 1, we

we can also say that the first constant depends on only need to consider the integral I1-(T ) as above

h. for

the

case A > 1.  For the case A < 1, we only need to 
 < A is bounded away from -1. If N

consider the 
 (, A),

integral then I-

I-A(T ) for  such that -1 < (T ) = 0. Otherwise, we have



A

that  < r < A. Now, by the analogous proof to the case A > 1, we have, as T  ,



I-A(T ) = O

|h(j, -2 arg( + i))| + |h(j, -2 arg( A + i))| jT

+o

1 j2T

where the first implied constant depends on r and the second has no dependence. Finally, we consider when h(j, /2) = 0. As for h(j, -/2) = 0, there are two cases. The
first case is that h(j, -2 arg(x + i)) is not locally zero at x = -1. Thus, we have that, for every  > 0, there exists x  (-1 - , -1 + ) such that h(j, -2 arg(x + i)) = 0. Let 1 be chosen such that h(j, 1) = 0. By the proofs analogous to when h(j, -/2) = 0, we have

I-±1(T ) = O

h(j, 1) jT

= I-A(T )

as T  . The implied constants have no dependence for any of these estimates. The second case is that h(j, -2 arg(x + i)) is locally zero at x = -1. Thus, we have that
there exists a  > 0 for which h(j, -2 arg(x + i)) = 0 for every x  (-1 - , -1 + ). Let N denote the union of all open intervals U containing -1 such that h(j, -2 arg(x + i)) = 0 for every x  U and set N =: (r, s). By the analogous proof for when when h(j, -/2) = 0, we

14

JIMMY TSENG

have, as T  ,



I--1(T ) = O

h(j, -2 arg(- A + i)) jT

+o

1 j2T

I-+1(T ) = O

h(j, -2 arg( + i)) jT

+o

1 j2T



I-+A(T ) = O

|h(j, -2 arg( + i))| + |h(j, -2 arg(- A + i))| jT

+o

1 j2T

for -1 <  < 1 bounded away from 1. For I--1(T ), the first implied constant depends on

r and the second has no dependence.

For

I-+1(T )

and

I+ (T ),
-A

the

first

implied

constant

depends on s and the second has no dependence. This concludes all cases and proves the

desired result.

Corollary 3.7. Let j  Z\{0}. We have, as T  ,

 O I(T, j) = O

1 j2T
1 j2 T

if

h(j, )

is

locally

zero

at

both



=

-

 2

and



=

 2

otherwise

where the implied constants depend only on h.

Proof.

By

the smoothness

of

h,

we

can

apply

h(j, )

=

h2 (j,) -4 2 j 2

to

the

lemma

to

obtain

the

desired result.

 Applying the corollary, we have that jZ\{0} I(T, j) = O(1/ T ) where the implied constant depends on h. Thus, we have, as T  ,

(3.4)


f
-

a c

-

1 c2y

x

1 +

i,

-2

arg(x

+

i)



e

mxy

-

m

d c

dx

A
=
-A

1
h(t, -2 arg(x + i)) dt
0

e

mxy

-

m

d c

dx + O

H(A) T

where

H(A) := 1 if A > 0 0 if A = 0

and the implied constant depends on h. This finishes the estimate for the integral when A  0, and, thus, in all cases. Note, in particular, for A = 0, the all the integrals we considered are zero including those which give the error term.
Now the number of terms in the sum over the double cosets is counted by a suitable Kloosterman sum (see [7, (2.24)]). Using the trivial bound over the average of the Kloosterman

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

15

sum, namely [7, (2.38)], and H¨older's inequality, we have

y a
 c

1 T

 C y Ty T

=

C

T

1
3/2

b d

  \j-1 /

1T y c>0

where the constant C depends on the cusps 1 and j. Note that terms corresponding to

c>

1 Ty

in the double coset summation are identically zero.

This yields the desired error

term.

Finally, as T > y, we have that

1
f (x + iy, 0) e(mx) dx = 0.

0

Apply Lemma 2.1 yields the desired result for (T,0j).

terWmeOnowT3c/2on,siwdehricthh,etchausse,

 is

> 0. We claim, for this case, negligible. Here, the implied

that there is an additional error constant depends on h, 1, and

j. Let f := fT, and g := f - f. Similar to the case  = 0, the c = 0 term is zero. Let

A

:=

1 (T -)yc2

- 1.

For

any

other

term,

we

compute


g
-

a c

-

1 c2y

x

1 +

i, -2

arg(x + 

i)

 A - A

e

mxy

-

m

d c

if

A

>

 T

dx

 2M 0 A

if

A

 T

and A

0

if A < 0

where

M := max{|h(x, )| : x  [0, 1] and   [0, 2]}.

We note that A > A here. Let us consider first A >
2T  yc . Now we have

 T

.

From this, it follows that

1T T yc2 T +

 > 1 and, thus, A >

 A - A =

A - A A + A



 2 AT (T - )yc2



4 T yc .

For that

A



 T

A 

and T4yc .

A



0,

we

have

that

A



2 T -

and

1



 T

-1yc

,

from

which

it

follows

Now any term for which c >  1 is zero. Using the trivial bound over the average of

the

Kloosterman

sum

([7,

(T -)y
(2.38)]), we have

that

the

additional

error

term

is

y

T4y

1
(T -)y

=

O


T  3/2

,

as

desired.

Finally,

for

the

case



<

0,

the

analogous

proof

gives

an

additional

error

of O

|| T 3/2

. This completes the proof of Proposition 3.1.

16

JIMMY TSENG

4. Renormalizing a shrinking neighborhood to a fixed neighborhood

In this section, we prove Proposition 4.1, which, roughly speaking, allows us to renormalize a neighborhood, namely the support of our test function (T,j), shrinking into the cusp j as T   to a fixed neighborhood, namely the support of a suitable auxiliary function.

Proposition

4.1.

Let

j



{1, · · ·

, q},

1 2

>



>

0,

T

- min

B1 -B0 2

,

1 4

>

y,

0

<

Ty

<

B12

-

1 4

and m  Z be such that |m| 

Ty B1

-1/2+
. Then, as T   and T y  0, we have

T 1(T,j)(x + iy, 0)e(mx) dx
0

= B1

1+O

Ty B1



1 0,(j )
0

x

+

i

T B1

y,

0

e(mx) dx + O

1 T

where  is a real number such that ||  min

B1-B0 2

,

1 4

.

Here, the first implied constant

depends on 1 and j and the second depends on h, 1, and j.

Proof. We will show the desired result by equating each term of the summation over the double coset decomposition given by Lemma 2.1. It is known that the decomposition is uniquely determined by c and d(modc) [7, Theorem 2.7]. We first prove the proposition for T := (T,0j) and 0 := 0,(j). Let fT := fT,0 and f 0 := f00. Proposition 3.1 gives the desired expression for
1
T (x + iy, 0)e(mx) dx.
0
We now compute the desired expression for

1
0
0

x

+

i

T B1

y,

0

e(mx) dx.

As

Ty

<

B12

-

1 4

,

we

have

1
f0
0

x

+

i

T B1

y,

0

e(mx) dx = 0.

Thus, we have shown that the c = 0 term in both summations are equal to zero, as desired. Now let c > 0 and consider the term in the summation determined uniquely by c and d( mod c). We have that

T B1

y


f0
-

a c

-

B1 c2T y

x

1 +

i , -2

arg(x

+

i)



e

mx

T B1

y

-

m

d c

dx

=

T B1

y

B  -B

1
h(t, -2 arg(x + i)) dt
0

e

mx

T B1

y

-

m

d c

dx

where B := max{1/T yc2 - 1, 0}.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

17

Now,

over

the

integration

bounds,

we

have

that

|2

imx

T B1

y

|



2

Ty B1


, which implies

that, as T y  0, we have that

T B1

y


f0
-

a c

-

B1 c2T y

x

1 +

i,

-2

arg(x

+

i)

e

mx

T B1

y

-

m

d c

dx

=

T B1

y

1+O

Ty B1



e

-m

d c

 B
 -B

1
h(t, -2 arg(x + i)) dt dx
0

where the implied constant has no dependence. By Proposition 3.1, the corresponding term in the double coset decomposition for T is



y

fT

-

a c

-

1 c2y

x

1 +

i,

-2

arg(x

+

i)

e

mxy

-

m

d c

dx



B
=y 
-B

1
h(t, -2 arg(x + i)) dt
0

e

mxy

-

m

d c

dx

as T  . If B = 0, then

T B1

y


f0
-

a c

-

B1 c2T y

x

1 +

i

,

-2

arg(x

+

i)

e

mx

T B1

y

-

m

d c

dx = 0

=

T B1

y


fT
-

a c

-

1 c2y

x

1 +

i,

-2 arg(x

+

i)

e

mxy

-

m

d c

dx.

Moreover, the error term from Proposition 3.1 for T(,0j) is also zero.

Otherwise, B > 0, and, thus, (3.1) in the proof of Proposition 3.1 applies, and, over the

 integration bounds - B to B, we have |2imxy|  O

 B1

Ty 

T B1

O

Ty B1


, where

the implied constants depend on 1 and j. Consequently, we derive the following expression for corresponding term in the double coset decomposition for T :

y


fT
-

a c

-

1 c2y

x

1 +

i , -2

arg(x

+

i)

e

=y

1+O

Ty B1



e

-m

d c

mxy

-

m

d c

dx



B

1



h(t, -2 arg(x + i)) dt

-B 0

dx

as T  . Here, the implied constant depends on 1 and j. Thus, as T   and T y  0, we have that

T B1

y


fT
-

a c

-

1 c2y

x

1 +

i,

-2

arg(x

+

i)

e

mxy

-

m

d c

dx

= T y 1+O Ty 

B1

B1


f0
-

a c

-

B1 c2T y

x

1 +

i,

-2

arg(x

+

i)

e

mx

T B1

y

-

m

d c

dx

18

JIMMY TSENG

where the implied constant depends on 1 and j. Adding in the error term of O

1 B1 T

,

we have, thus, shown the desired equality of each corresponding term in the double coset

decompositions. Here, the implied constant depends on h, 1, and j. This proves the desired

result when  = 0 = .



For  = 0, we must add another error term of O

|| B1 T

as shown in the proof of Proposi

tion 3.1. For  = 0, we must add in yet another error term, namely O || . This follows

B1 T

because the functions

½[T -,)  m T B1

B1 T yc2(x2 + 1)

½[T -,)

1 yc2(x2 + 1)

are the same. Then applying the proof of the additional error term in Proposition 3.1 (with the  from the proposition replaced by ) yields the desired error term. Both of the implied constants depend on h, 1, and j. This proves the desired result in all cases.

5. Horocycle equidistribution for fixed functions

In this section, we give a variant of a general formulation of horocycle equidistribution for

fixed functions due to Stro¨mbergsson. There are two formulations, an effective one and a non-

effective one. Stro¨mbergsson's results are for continuous functions, while, in our setting, the

non-effective version also needs to handle functions that are not continuous, as these functions

involve indicator functions. A simple approximation is needed to prove our variant of the non-

effective result (Lemma 5.3), namely use the smooth Urysohn lemma (see [10, Lemma 2.1.17]

for example) to give an upper and lower approximation for the indicator function and apply

Stro¨mbergsson's results. For the convenience of the reader, we will give the details in the

proof of Lemma 5.3 below.

First, let us prove our variant of the effective result, Lemma 5.1. Let  be the Laplacian

on

\H.

If

there

exist

small

eigenvalues





(0,

1 4

)

in

the

discrete

spectrum

of

,

let

1

be

the

smallest.

Likewise,

if

it

exists,

let

(1j)



[1,

1 4

)

be

the

smallest

positive

eigenvalue

for

which

there exists an eigenfunction which has non-zero constant term (see [2, Chapter 7]) at cusp

j. Define

(5.1)

 1+ 1-41

s1 := 1 2

2

s(1j)

:=

 1+ 1

1-4(1j) 2

2

if there exists small eigenvalues if there does not exist small eigenvalues
if (1j) exists if (1j) does not exist

s1 := max s(11), · · · , s(1q) .

Note

that

1 2



s1



s1

<

1.

Our variant of the results in [13] is the following:

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

19

Lemma 5.1. Let j  {1, · · · , q},  > 0, and || > 0. Then

1 -


0,(j )(x


+

iy, 0)

dx

=

T B1µ(\G)

2 0

1 0

 ½[T,),(y)h(x, ) dy
0

dx y2

d

+ O(B1-1T 4||-4)

y1/2 -

log2

- y

+

(

y1-s1 - )2(1-s1)

+

y

1-s1

-

where the implied constant depends on , 1, j and h.

Remark 5.2. The main term is bounded for all T

>

1 4

.

For fixed T , the error term goes

uniformly to 0 as y  0 so long as 1   -   y1/2-. Moreover, the implied constant in the

error term is effective, meaning that, in principle, it can be computed from the proof of [13,

Proposition 3.1] and the proof of the lemma.

Proof. The proof is applying [13, Proposition 3.1] (c.f. [13, Remark 3.4]) to f := 0,(j). The details are as follows. Let

n(t) :=

1 0

t 1

a(y) :=

y1/2 0

0 y-1/2

.

As n()a(y)n(t)i = yt +  + iy by(1.1), we have

1 T

T 0

f (n()a(y)n(t))

=



1 -




f (x + iy, 0) dx


and  -  = yT .

To finish, it remains only to estimate the Sobolev norm f W4. We first show that it is finite. Let  denote the right regular representation of G on L2(\G), g denote the Lie algebra

of SL2(R), and U (g) denote the universal enveloping algebra of g. Then the action of g on the smooth functions of L2(\G) is by the (left) Lie derivative, and, for a fixed basis X1, X2, X3 of g and all k  N, the Sobolev norm f Wk is equivalent to the norm given by (X )f where the sum runs over all monomials X = Xi1 Xi2 · · · Xil  U (g) of degree  k and the norm · is the L2-norm (see [13, Section 2], [1, Section 3.2], and [2, Chapter 14]).

A standard basis for g is

H :=

1 0

0 -1

X- :=

0 1

0 0

X+ :=

0 0

1 0

and the associated Lie derivatives to these basis elements are [9, Chapter IV, §4]

LH

=

-2y

sin

2

 x

+

2y

cos

2

 y

+

sin

2

 

LX+

=

y

cos

2

 x

+

y

sin

2

 y

+

sin2



 

LX-

=

y

cos

2

 x

+

y

sin

2

 y

-

cos2



 

.

As

f

is

constant

in

x

and

i yi

½[T,),(mT /B1 (y))

has support in [B1-||, B1 +||] for every

i  N, any term of LXl · · · LX1f having y as a factor must have support in [B1 - ||, B1 + ||]

for the y-variable by elementary calculus. Likewise, any term not having y as a factor must

20

JIMMY TSENG

have support in [B1 - ||, ) for the y-variable. Here, for 1  j  l, Xj is one of the standard

basis elements of g. Recalling that dµ = y-2 dx dy d, we have that LXl · · · LX1f  L2(\G).

Consequently, f Wk < .

Also

note

that,

by

elementary

calculus,

every

term

of

LXl

·

·

·

LX1 f

is

of

the

form

g()yi

i+j f yij

for some (i, j)  (N  {0}) × (N  {0}) and some C-function g().

We now estimate f Wk . By the above, we need only consider a finite number of monomials

of the form LXl · · · LX1f where 1  l  k, and, thus, only a finite number of terms of the

form

g

()yi

i+j f yij

where 1  i + j

 k.

By the above, terms for which i  1 have support

in [B1 - ||, B1 + ||]. Applying Young's inequality (as in the proof of Lemma 6.1) and the

chain rule, we have

½ i
yi

[T,),(mT /B1 (y))

  O(T iB1-i||-(i+1)) and, consequently, the

contribution to f Wk from these terms are bounded by O(T iB1-3/2||-i)  O(T kB1-3/2||-k).

(Note that, here, (B1 + ||)i-1/2 - (B1 - ||)i-1/2 contributes a factor of B1i-3/2||.) The contribution from the terms for which i = 0 are bounded by O(B1-1). Consequently, f Wk  O(T kB1-1||-k). Here, all of the implied constants depend on h.

Our variant of [14, Theorem 2] is the following:

Lemma 5.3. Let j  {1, · · · , q},  > 0 and fix A > B0 > 1. Then

1 -

 

(Aj)(x+iy, 0)

dx



1 µ(\G)

\G

(Aj )(p)

dµ(p)

=

1 Aµ(\G)

2 0

1
h(x, ) dx d
0

uniformly as y  0 so long as  -  remains bigger than y1/2-.

Proof. Let A - B0 >  > 0. Using the smooth Urysohn lemma, define C-functions ½+ : (0, )  [0, 1] and ½- : (0, )  [0, 1] by

½+(y) := ½[A,+,)(y) :=

1 0

if y  [A, ) if y  (0, A - ]

½-(y) := ½[A,-,)(y) :=

1 0

if y  [A + , ) . if y  (0, A]

(Here, we are not giving an explicit formula for ½+|(A-,A) or for ½-|(A,A+).) These functions,
furthermore, define the C-functions

f +(z, ) = ½+(y)h(x, ) and +(z, ) =

f +((z, ))

  \j-1 

f -(z, ) = ½-(y)h(x, ) and -(z, ) =

f -((z, )).

  \j-1 

Recall that

A(x + iy, 0) =

fA((z, )),

  \j-1 

and, thus, we have that the inequalities -  A  + hold pointwise. Let

M := max{|h(x, )| : x  [0, 1] and   [0, 2]}.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

21

Let

us

first

give

the

proof

for

the

case

h

0.

Let



>

0.

Choose



such

that

2M  A-

<

/2.

The inequalities imply that

1 -

 

A(x

+

iy, 0)

dx





1 -




+(x + iy, 0) dx




1 Aµ(\G)

2 0

1 0

h(x,

)

dx

d

+

2M  A-

+

 2



1 Aµ(\G)

2 1
h(x, ) dx d + 
00

for y small enough and all    such that  -   y1/2-. Here the second inequality follows from [14, Theorem 2]. Using the analogous proof for -, we obtain

1 -

 

A(x

+

iy, 0)

dx



1 Aµ(\G)

2 1
h(x, ) dx d - 
00

for y small enough and all    such that  -   y1/2-. Consequently, we have that

1 -

 

A(x

+

iy, 0)

dx

-

1 Aµ(\G)

2 1
h(x, ) dx d < 
00

for y small enough and all    such that  -   y1/2-, which proves the desired result when h  0.
Since h + M  0, applying the above proof with h replaced by h + M yields the desired result for h + M . Applying the above proof with h replaced by M yields the desired result for M . Subtracting these two results yields the desired result for general h and proves the desired result in all cases.

6. Proof of Theorem 1.1

In this section, we prove Theorem 1.1, which is our non-effective main result and which allows a greater range for the rate of growth of T versus the decay of T y than our effective main result. The idea of the proof is as follows. We will approximate integrating from  to  via C-functions constructed from a well-known mollifier. Using the Fourier series of these approximations, we apply Proposition 4.1 to the low modes of these Fourier series. Using a classical result for the uniform convergence of the Fourier series for smooth functions, we show the high modes are negligible. This allows us to apply horocycle equidistribution for fixed functions, namely Lemma 5.3, to obtain the desired result.

Proof of Theorem 1.1. Let T := (T,0j), 0 := 00,(j), and  < . Without loss of generality, we may assume that 0  ,   1, and 1/2   > 0. Otherwise, we can break the integral

into a finite number of pieces and use the periodicity in x. Let us first assume that either

0   <  < 1 or 0 <  <   1. The final case of  = 0 and  = 1 is a simplification and

will be proved at the end.

Let

1 2

(

- )

>



>

0

and

M := max{|h(x, )| : x  [0, 1] and   [0, 2]}.

22

JIMMY TSENG

Define the indicator function  : R  [0, 1] by

(x) := [,](x) :=

1 0

if x  [, ] . if x / [, ]

Because we require explicit Lipschitz constants, we will approximate  via convolutions with an explicit C-function, namely the well-known mollifier (see [15, Example 9.23] for example)
 : R  R defined by

(6.1)

(x) :=

-1

e-

1 1-x2

0

if |x| < 1 if |x|  1

(x)

:=

1 



x 

where

 :=

e 1

-

1 1-x2

dx.

-1
Define C-functions + : R  [0, 1] and - : R  [0, 1] by the convolutions

+(x) := [,+,](x) := -(x) := [,-,](x) :=


[-r+,r+](x - y)/2(y) dy
- 
[-r-,r-](x - y)/2(y) dy
-

where

r+

:=

-+ 2

and

r-

:=

-- 2

.

Translating these functions, we obtain our desired

upper and lower approximations:

+(x) := [,+,](x) := +

x

-



+ 2



-(x) := [,-,](x) := -

x

-



+ 2



Note that here + and - are both C-functions with 0  +  1 and 0  -  1 such that

+|[,] = 1,

+|(-,-][+,) = 0

-|[+,-] = 1,

-|(-,][,) = 0.

Now, as  is smooth and compactly supported, the bounds M(n) := max

dn  dxn

(x)

:xR

are

finite

for

every

n  N.

For

concision,

let

us

define

d0 + dx0

to

be

+

and

d0 - dx0

to

be

-.

Lemma

6.1.

Let

n  N  {0}.

A

Lipschitz

constant

for

dn + dxn

is

2 

n+2 ( -  + )M(n + 1)

and

a

Lipschitz

constant

for

dn- dxn

is

2 

n+2 ( -  - )M(n + 1).

Proof. By the mean value theorem, a bound for the derivative will be a Lipschitz constant for the function. By induction on the chain rule, we have

dn+1/2 dxn+1

(x)



2 

n+2
M(n + 1)

for all x  R. Applying Young's inequality gives

dn+1+ dxn+1




[-r+,r+] 1

dn+1/2 dxn+1





2 

and the desired result. The proof for - is analogous.

n+2
( -  + )M(n + 1)

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

23

Corollary 6.2. Let n  N  {0}. The functions

+,n(t) :=

2 

n+2
( -  + )M(n + 1)

t

-,n(t) :=

2 

n+2
( -  - )M(n + 1)

t

are

moduli

of

continuity

for

dn + dxn

and

dn - dxn

,

respectively.

Proof. This is immediate from the definitions.

Lemma 6.3. Let n  N  {0} and m  Z. We have that

dn+ dxn

(m)

 2( -  + )

2 

n
M(n)

dn- dxn

(m)

 2( -  - )

2 

n
M(n)

for all small enough .

Proof.

Since

the

supports

of

dn+ dxn

and

dn- dxn

are

contained

in

[0, 1]

(perhaps

after

applying

the periodicity in x and, because  is small enough, there are no overlaps), we can replace

the Fourier transform over the circle by that over the line. By elementary properties of

convolutions and Fourier analysis, it suffices to give a bound for

 -

dn/2 dxn

(x)e(-mx)

dx

=

2 n+1  dn



- dxn

2x 

e(-mx) dx

=

2 n+1 /2 dn



-/2 dxn

2x 

e(-mx) dx

=

2 

n

1 -1

dn dxn

(x)

e(-mx/2)

dx

2

2 

n
M(n).

The first equality follows from induction on the chain rule, second equality follows from the

fact that the support of the all the derivatives of  is contained in the support of , namely

the

closed

interval

[-1, 1],

and

the

third

equality

follows

from

changing

variables

2x 



x.

The

desired result now follows.

By smoothness and periodicity, we have

+(x) = +(m)e(mx)
mZ

-(x) = -(m)e(mx)
mZ

where +(m) and -(m) are the Fourier transforms on R/Z of +(x) and -(x), respectively. Moreover, the convergence of each sum to each function is uniform, and, we have, by a classical

24

JIMMY TSENG

theorem due to Jackson [8, Page 21]

+(x) -

N

+(m)e(mx)



K0+,n(2/N

)

log N

N
n

=

K1( -  + ) log n+2N n+1

N

m=-N

-(x) -

N

-(m)e(mx)



K0-,n(2/N

)

log N

N
n

=

K1( -  - ) log n+2N n+1

N

m=-N

where K0 > 0 is a fixed constant independent of x, N , n, , , , and  and where K1 := 2n+3K0M(n + 1). Note that both bounds are uniform in x.
Let us first give the proof for the case h  0. In particular, this implies that T  0 pointwise, from which it follows that T -  T   T + pointwise. Let

n

:=

2 



:=

1 8

max

T -1/6,

Ty B1

1/2

T y -/2 B1

>0

N :=

Ty B1

-1/2+/4

.

We have that

(6.2)

T -

 

T (x

+

iy, 0)

dx

=



T -



1
T (x + iy, 0)(x) dx
0





T -



N

+(m)

m=-N

1
T (x + iy, 0)e(mx) dx
0

+



T -



K1( -  + ) log n+2N n+1

N

1
T (x + iy, 0) dx.
0

Applying Proposition 4.1, we obtain, as T   and T y  0,

(6.3)

1

T K1 T (x + iy, 0) dx
0

= B1K1

1+O

Ty B1



1
0
0

x

+

i

T B1

y,

0

dx + O

K1 T

.

Now, by Lemma 5.3 , we have that, as T y  0,

1
B1K1 0
0

x

+

i

T B1

y,

0

dx



K1 µ(\G)

2 0

1 0

h(x,

)

dx

d



2M

K1 µ(\G)

.

Now, as  -   max

T -1/6,

T y 1/2 B1

Ty B1

-
, we have

(6.4)

0





 -





1 8

Ty B1

/2
,

and we also have that

0



1 n+2N n+1-/2

 22/+1-/282/+2

Ty

/2+2 /8
.

B1

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

25

Consequently, for all T large enough and all T y small enough, we have that

(6.5)

T K1( -  + ) log N

-

n+2N n+1

1 0

T (x

+

iy, 0)

dx



 4

.

Another application of Proposition 4.1 yields, as T   and T y  0,

T -

N

+(m)

m=-N

1
T (x + iy, 0)e(mx) dx
0

=

B1 -

1+O

Ty  B1

N

1

+(m) 0

m=-N

0

x

+

i

T B1

y

,

0

N

e(mx) dx +

O

m=-N

+(m) ( - ) T



B1 -

1+O

Ty B1



1
0
0

x

+

i

T B1

y,

0

+(x) dx

+

B1 -

1+O

Ty  B1

K1( -  + ) log N n+2N n+1

1
0
0

x

+

i

T B1

y,

0





N

+(m)

dx +

O



m=-N

( - ) T

Note, as h  0, we have that 0  0 pointwise. By (6.3, 6.5), we have, for all T large enough and all T y small enough, that

(6.6)

B1 -

1+O

Ty  B1

K1( -  + ) log N n+2N n+1

1
0
0

x

+

i

T B1

y,

0

dx



 4

.

Now, by Lemma 6.3, we have that

(6.7)





N

+(m)

O

 O

m=-N

( - ) T

1 ( - ) T






mZ\{0}

d2 + dx2

(m)

42m2

+

1 +(x) dx
0

=O

1  O

2( - ) T

T y 2 B1

.

Note that the implied constant depends on h, 1, and j. Consequently, for all T large enough and all T y small enough, we have that





N m=-N

+(m)

O



( - ) T





 4

.

Finally, to obtain an upper bound for the left-hand side of (6.2), we must give an upper

bound for

D

:=

B1 -

1+O

Ty B1



1
0
0

x

+

i

T B1

y,

0

+(x) dx.

26

JIMMY TSENG

Since 0  0 pointwise, we have that

(6.8)

D

1

+



2 -

B1  -  + 2

1+O

Ty  B1

+
0
-

x

+

i

T B1

y,

0

dx.

Applying (6.4) and Lemma 5.3, we have, for all T large enough and T y small enough, that

(6.9)

D



1 µ(\G)

2 0

1 0

h(x,

)

dx

d

+

 4

.

Note that Lemma 5.3 applies because  -  + 2   -  

Ty B1

1/2-
holds. Consequently,

we can conclude that

T -

 

T (x

+

iy, 0)

dx



1 µ(\G)

2 0

1
h(x, ) dx d + .
0

Using the analogous proof for -, we obtain that

T -

 

T (x

+

iy, 0)

dx



1 µ(\G)

2 0

1
h(x, ) dx d - ,
0

where we are able to apply Lemma 5.3 to compute the main term in the analogous proof because

 -  - 2  max

T -1/6,

Ty B1

1/2

Ty B1

-

-

1 4

max

T -1/6,

Ty B1

1/2

T y -/2 B1

 max

T -1/6,

Ty B1

1/2

T y -/2 B1

for T y small enough. This yields the desired result for the case h  0. Since h + M  0, applying the above proof with h replaced by h + M yields the desired
result for h + M . Applying the above proof with h replaced by M yields the desired result for M . Subtracting these two results yields the desired result for general h.
The final case to consider is when  = 0 and  = 1 (namely, the case of complete horocycles). This final case follows by applying Proposition 4.1 (with m = 0) and Lemma 5.3. This proves the desired result in all cases.

7. Proof of Theorem 1.2

In this section, we prove Theorem 1.2, which is our effective main result. The proof is analogous to that of Theorem 1.1 except that we replace Lemma 5.3 with its effective version, namely Lemma 5.1, and keep track of the error terms. For  = 0, there is an additional step of obtaining the correct main term. Before we give the details, let us first note that

max

T4

Ty B1

1/2
, T -1/6

T y - B1

can decay provided the relative rate of decay of y to the growth of T is constrained. For ex-

ample,

if

we

substitute

y

=

T -10

and



=

1 60

into

this

expression,

then

we

obtain

T -1/60B11/60,

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

27

which decays as T  . Also note that, as this expression is larger than or equal to the analogous expression for Theorem 1.1, there is no hinderance to applying the proof of Theorem 1.1 with the noted changes.

Proof of Theorem 1.2. Let 0 < ||  min

B1 -B0 2

,

1 4

,

T

:= T(,j), and 0 := 0,(j).

As

mentioned, we follow the proof of Theorem 1.1. Let

Q

:=

T µ(\G)

2 0

1 0

0



½[T

,),

(y)h(x,

)

dydxd y2

R := R() := O T 4||-4

Ty

1/2
log2

B1

+

T y 1-s1

B1

Ty

B1

R := R() := O T 4||-4

×

Ty ( - )2B1

1/2
log2

( - )B1 Ty

+

Ty ( - )2B1

1-s1
+

Ty

1-s1

( - )B1

.

Note that |Q| 

8M 3µ(\G)

.

By applying Lemma 5.1 in place of Lemma 5.3, we replace (6.5)

with the following:

(7.1)

T K1( -  + ) log N

-

n+2N n+1

1
T (x + iy, 0) dx
0

 22/ 82/ K1

T y /2+2/8 B1

1

+

1 8

T y /2 B1

1+O

Ty B1



(Q + R) + O

1 T

Note

that

(7.1)

holds

when

log N N /2



128,

a

condition

which,

for

the

given



>

0,

we

can

ensure

for all T y small enough. Also, the left-hand side of (6.6) is also bounded by the right-hand

side of (7.1). Moreover, (6.7) holds, giving an additional error term of O

Ty B1

2
.

Finally, we compute D, which will yield the main term (and additional error terms). By

applying Lemma 5.1 in place of Lemma 5.3 to (6.8), we obtain the analog of (6.9):

D

1+O

T y /2 B1

Q+R .

Note

that



1 8

(

-

).

Thus,

the

main

term

is

Q

and

the

error

terms

that

are

significant

coming from this expression are O(|Q|)

Ty B1

/2
=O

Ty B1

/2 and R.1

Here, the implied

constant depends on h, 1, and j. Note that the error term coming from (6.7) is negligible

compared to these terms. Similarly, for T y small enough, the bound coming from the right-

hand side of (7.1) is negligible.

Consequently, we have that

T -


T (x + iy, 0) dx  Q + R + O


Ty B1

/2

1Theorem 1.2 provides a meaningful result only when the term R decays.

28

JIMMY TSENG

for T   and T y  0. Giving the analogous proof for -, yields the reverse inequality and, thus, equality for h  0:

(7.2)

T -


T (x + iy, 0) dx = Q + R + O


Ty B1

/2
.

Here, the implied constant depends on h, 1, and j. In the analogous way as in the proof of Theorem 1.1, we obtain (7.2) for general h.
Similar to the proof of Theorem 1.1, it remains to show the analog of (7.2) for the case of  = 0 and  = 1. By applying Lemma 5.1 in place of Lemma 5.3 in the proof of Theorem 1.1, we obtain

(7.3)

1
T T (x + iy, 0) dx = Q + R + O
0

Ty B1

 + 1 T

.

Here, the implied constant depends on h, 1, and j. Now, for  = 0, set  =  to obtain the

desired result.

Finally, for  = 0, we can pick any 0 < ||  min

B1 -B0 2

,

1 4

.

Let us first assume that

 > 0. Note that

Q

=

T µ(\G)

2 0

1 0

 h(x, ) dy
T

dx y2

d

+

T µ(\G)

2 0

1 0

T T -

½[T,),(y)h(x, ) dy

dx y2

d

=

1 µ(\G)

2 1
h(x, ) dx d + O
00

|| T

The implied constant depends on h and . A similar proof for  < 0 yields the same result. This obtains the desired result and concludes the proof of the theorem.

8. Proof of Theorem 3.4
This proof is a simplification of the proof of Theorem 1.1. For the convenience of the reader, we now give the details.
Proof of Theorem 3.4. Let T := (T,j), 0 := 0,(j), and  < . Without loss of generality, we may assume that 0   and   1. Otherwise, we can break the integral into a finite number of pieces and use the periodicity in x. If  = 0 and  = 1, then apply Corollary 3.3 to obtain the desired result. Otherwise, let us assume that either 0   <  < 1 or 0 <  <   1. Define , ±, M , and M(n) as in the proof of Theorem 1.1.

SHRINKING TARGET EQUIDISTRIBUTION OF HOROCYCLES IN CUSPS

29

Now

set



:=

1 4

T

-3/4+/2 .

Let

us

first

consider

the

case

h



0.

We

have,

for

all

T

sufficiently

large, that



1

T (x + iy, 0) dx  T (x + iy, 0)+(x) dx



0





1
 T (x + iy, 0)+(x) dx + O
0

1 T 3/2


mZ\{0}

d2 + dx2

(m)

42m2

+

1 +(x) dx
0




T (x + iy, 0) dx + 2M + O


1 2T 3/2




T (x + iy, 0) dx + O


1 T

where the implied constant depends on h, 1, and j. The second inequality follows an application of Corollary 3.3 and that + is smooth, and the third inequality comes from Lemma 6.3. The analogous proof using - in place of + allows us to obtain the desired
lower bound. Consequently, we have that





T (x + iy, 0) dx = T (x + iy, 0) dx + O





1 T

where the implied constant depends on h, 1, and j. Since h + M  0, applying the above proof with h replaced by h + M yields the desired
result for h + M . Applying the above proof with h replaced by M yields the desired result for M . Subtracting these two results yields the desired result for general h and proves the desired result in all cases.

References
[1] J. Bernstein and A. Reznikov, Analytic continuation of representations and estimates of automorphic forms, Ann. of Math. (2) 150 (1999), no. 1, 329­352.
[2] A. Borel, "Automorphic forms on SL2(R)." Cambridge Tracts in Mathematics, 130. Cambridge University Press, Cambridge, 1997.
[3] L. Flaminio and G. Forni, Invariant distributions and time averages for horocycle flows, Duke Math. J. 119 (2003), no. 3, 465­526.
[4] D. A. Hejhal, On the uniform equidistribution of long closed horocycles in "Loo-Keng Hua: a great mathematician of the twentieth century." Asian J. Math. 4 (2000), no. 4, 839­853.
[5] D. A. Hejhal, Dennis A. On value distribution properties of automorphic functions along closed horocycles in "XVIth Rolf Nevanlinna Colloquium" (Joensuu, 1995), 39­52, de Gruyter, Berlin, 1996.
[6] D. A. Hejhal, "The Selberg Trace Formula for PSL(2, R)," Vol. 2, Lecture Notes in Math. 1001, Springer, Berlin, 1983.

30

JIMMY TSENG

[7] H. Iwaniec, "Spectral methods of automorphic forms," Second edition. Graduate Studies in Mathematics, 53 American Mathematical Society, Providence, RI; Revista Matema´tica Iberoamericana, Madrid, 2002.
[8] D. Jackson, "The theory of approximation." Reprint of the 1930 original. American Mathematical Society Colloquium Publications, 11. American Mathematical Society, Providence, RI, 1994.
[9] S. Lang, "SL2(R)." Reprint of the 1975 edition. Graduate Texts in Mathematics, 105. Springer-Verlag, New York, 1985.
[10] A. Mukherjee, "Differential topology," Second edition. Hindustan Book Agency, New Delhi; Birkh¨auser/Springer, Cham, 2015.
[11] F. W. J. Olver, "Asymptotics and special functions." Computer Science and Applied Mathematics. Academic Press [A subsidiary of Harcourt Brace Jovanovich, Publishers], New York-London, 1974.
[12] P. Sarnak, Asymptotic behavior of periodic orbits of the horocycle flow and Eisenstein series, Comm. Pure Appl. Math. 34 (1981) 719­739.
[13] A. Str¨ombergsson, On the deviation of ergodic averages for horocycle flows, J. Mod. Dyn. 7 (2013), no. 2, 291­328.
[14] A. Str¨ombergsson, On the uniform equidistribution of long closed horocycles, Duke Math. J. 123 (2004), no. 3, 507­547.
[15] A. Taheri, "Function spaces and partial differential equations. Vol. 1. Classical analysis." Oxford Lecture Series in Mathematics and its Applications, 40. Oxford University Press, Oxford, 2015.
[16] D. Zagier, Eisenstein series and the Riemann zeta function in "Automorphic forms, representation theory and arithmetic" (Bombay, 1979), pp. 275­301, Tata Inst. Fund. Res. Studies in Math., 10, Tata Inst. Fundamental Res., Bombay, 1981.

Department of Mathematics, University of Exeter, Exeter EX4 4QF, U.K Email address: j.tseng@exeter.ac.uk

