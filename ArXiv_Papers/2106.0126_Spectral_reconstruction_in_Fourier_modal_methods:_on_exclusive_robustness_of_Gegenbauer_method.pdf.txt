Spectral reconstruction in Fourier modal methods: on exclusive robustness of Gegenbauer method
Ehsan Faghihifara, Mahmood Akbaria
aSharif University of Technology, Azadi Ave., Tehran, 1136511155, Iran

arXiv:2106.00126v1 [physics.comp-ph] 28 May 2021

Abstract
Fourier spectral methods constitute a rigorous memory-minimizing technology for the analysis of photonic structures. However, the discrete geometry of these artifacts can lead to the Gibbs phenomenon, and consequently, a dramatic deterioration of the exponential rate convergence. In this paper, we study the applicability of spectral reconstructions for the resolution of the Gibbs phenomenon in Fourier modal methods. We show in practice, the emergence and propagation of a computational disorder potentially incapacitate most of the popular post-processing techniques from retrieving a Fourier spectral solution in the vicinity of discontinuities. Nonetheless, we numerically substantiate and rigorously prove that the classical Gegenbauer method remains exceptionally robust against this phenomenon. Specifically, we show the Gegenbauer reconstruction error at worst diminishes proportional to O(N -1) for the Fourier order N , while the convergence can be even exponentially fast up to a constant summand.
Keywords: Fourier modal method, Gibbs phenomenon, Spectral reconstruction, Gegenbauer method, Computational disorder.

1. Introduction
Spectral methods emerged as an alternative to the finite-difference and finite-element methods for the numerical solution of partial differential equations. They involve representing the solution to a boundary value, eigenvalue, or time-dependent problem, as a truncated series of known basis functions with global (or at least extended) support on the domain [1, 2]. The coefficients of the basis functions can be considered as a spectrum of the solution, which explains the name of the method. Long before the first unifying mathematical assessment of the theory was provided by Gottlieb and Orszag in [3], spectral methods had found applications in various problems, particularly as a large-scale computational tool in fluid dynamics [4]. The fascinating merit of spectral methods is the infinite-order convergence rate; i.e. under fortunate circumstances, the error can go to zero faster than any finite power of the number of retained modes [3], while finite-difference and finite-element methods can not normally converge faster than algebraically [1, 5]. The superior accuracy, however, comes at the expense of less geometrical flexibility, which can be improved using multidomain techniques [6, 7]. The geometry also predominantly determines the choice of basis functions. The use of the Fourier series, in particular, has been most dramatically successful in problems with periodic geometries. Thanks to the computational simplicity and availability of fast Fourier transform, Fourier spectral methods are now utilized
Email addresses: ehsan.faghihifar@alum.sharif.edu (Ehsan Faghihifar), makbari@sharif.edu (Mahmood Akbari)

Preprint submitted to Elsevier

June 2, 2021

Figure 1: The incidence of a plane wave on typical lamellar and crossed gratings with normalized dimensions indicated.
in a wide variety of applications, particularly in photonics wherein periodic structures play a major role [8, 9, 10, 11]. Not to mention nonperiodic structures can also benefit from spectral analyses, using supercell approximations [12], or perfectly matched layers [13]. Depending on the computational methodology, spectral methods can be directly employed for the expansion of the electromagnetic fields in terms of primarily nonphysical basis functions, e.g. in the derivation of band structures in photonic crystals[14, 15, 16, 17, 18], or as an intermediary tool in the modal framework.
The rigorous coupled-wave analysis [19, 20], also known as the Fourier modal method [21], represents one of the most popular techniques in the modal framework, for the efficient analysis of periodic structures; compared to the more computationally expensive alternatives, e.g. the finite elements [22], the finite-difference time-domain [23], the integral equation [24], and the boundary variation methods [25]. This method and its variants are particularly pertinent to the analysis of lamellar/crossed gratings, i.e. one/two-dimensionally periodic structures with invariant geometries along the surface normal (figure 1). However, despite the unequaled convenience of these Fourier methods, they have to deal with the inevitable emergence of the Gibbs phenomenon, due to the predominantly discrete geometry of gratings. This phenomenon, not only significantly deteriorates the convergence of near-field distributions, but it may also have indirect detrimental implications on the derivation of far-field parameters, e.g. reflectance, etc. Such far-field effects were initially recognized from the notoriously slow convergence of diffraction analyses in metallic lamellar gratings with the TM polarization [26]. Notwithstanding the prior discovery of an empirical treatment [27, 28] for this problem, it was Li's influential paper [29] that provided the first analytical explanation and led to further generalization and extensive applications [30, 31, 32, 33]. He attributed the problem to the erroneous convolution of functions with concurrent jumps (a consequence of the Gibbs phenomenon) and introduced the Fourier factorization rules to modify it. However, despite their ameliorative effect, the very presence of the Gibbs phenomenon could not be eliminated by these rules. Specifically, uniform resolution and fluctuations of the permittivity expansion can still deleteriously affect the convergence of
2

far-field parameters [34, 35], not to mention the field distribution of eigenmodes. The latter effects can particularly be significant in Fast-Fourier-based mode solvers, where the computational algorithm does not leave room for the application of the factorization rules [18, 36, 37, 38, 39]. Overall, despite the scarcity of rigorous mathematical results on the validity or convergence of Fourier modal methods such as [40], it seems safe to conclude that their convergence for either of the near-field or far-field parameters, could not exceed a modest polynomial rate (as illustrated in [41, 42]).
Notwithstanding the seeming inevitability, circumvention of the Gibbs phenomenon and its implications is still possible within the spectral context. Elegant use of subsectional or nonsmooth basis functions, e.g. the B-spline modal method [43, 44, 41], multi-domain spectral [42, 45, 46] or pseudo-spectral [47, 48] polynomial expansions, can provide exponential or highdegree algebraic convergence rates [42, 41], though, to the detriment of simplicity and flexibility. On the other side, one could take a totally different approach towards the Gibbs phenomenon, using spectral reconstruction tools. These post-processing techniques bring together the accuracy of multi-domain polynomial-based and the versatility of single-domain Fourier-based methods. Note that other specialized techniques like Fourier factorization or adaptive spatial resolution [29, 34, 49], rely on reformulating the governing equation to mitigate manifestations of the Gibbs phenomenon, whereas post-processing methods merely depend on the solution, making them potentially applicable to a broader range of problems. Over the years, the Gibbs phenomenon has been subject to extensive scrutiny [50], resulting in the development of a variety of interesting techniques to deal with it; e.g. frequency-domain filters [51, 52], physical-domain and adaptive filters [53, 54, 55], polynomial subtraction or Eckhoff method [56, 57, 58, 59], singular FourierPad´e approximation [60], spectral reprojection using Gegenbauer and Freud polynomials [61, 62, 63, 64, 65, 66], inverse polynomial reconstruction [67, 68, 69], polynomial least-squares [70, 71, 72], Fourier extension [73, 74, 75, 76], etc. These techniques extract the information from the slowlyconverging expansion of nonperiodic or discontinuous spectral solutions with an exponential (or high-degree algebraic) rate. However, despite sporadic research works [77, 78, 79], capacities and limitations of these methods have hardly been explored in applied contexts.
We propound a rigorous mathematical foundation to assess the applicability of spectral reconstructions in Fourier eigenproblems. Due to an inevitable computational disorder, we reveal the unexpected inefficacy of all but one approach, due to lack of robustness. This paper comprises three main sections. In section 2, the Gibbs phenomenon and its resolution are numerically investigated in Fourier modal methods. In section 3, the formalism and application of the Gegenbauer method (as the only applicable method) is concisely studied. Eventually, in section 4 we explain and prove our main theorem on the robustness of the Gegenbauer method.
2. Gibbs Phenomenon and Its Resolution
Consider a differential equation with periodic boundary conditions over a finite interval, or equivalently with periodic coefficients over the real axis. The Fourier spectral expansion of a solution can converge uniformly with an exponential or super-algebraic rate, provided that the solution is analytical or smooth everywhere. However, the problem arises when the function or its k-th derivative becomes discontinuous at the boundaries (we assume it to be smooth elsewhere). Then the convergence at the boundaries and interior points will be of the rates O(N -k+1) and O(N -k), respectively. As a result, when the solution is expected to be non-periodic (discontinuous at the boundaries), the uniform spectral convergence deteriorates with L2-norm, and totally perish with the stronger L-norm, as a direct consequence of the Gibbs phenomenon. Post-processing methods for defeating the Gibbs phenomenon, i.e. spectral reconstructions in this context, use the truncated Fourier series of a piecewise smooth function and try to rebuild
3

it more accurately. As these methods have evolved significantly over the past three decades, one may expect them to be readily applicable in physical problems. However, in this section, we show how the emergence of a computational disorder makes all but one approach practically impotent for algebraic or eigenproblems.
2.1. Convolutional Fourier Series
The essence of all computational techniques for solving differential equations necessitates that somehow the information characterizing the coefficients and the solution be truncated into a finite sets of numbers, i.e. vectors. In Fourier spectral methods, truncation orders are the key factors that specify to what extent the information are preserved during the solution process, and consequently, how much the spectral solution resembles the original one.
With the exact Fourier coefficients of a truncated single domain spectral solution, the Gibbs phenomenon would be the most substantial obstacle to gain the highest achievable accuracy. Consequently, we expect the reconstruction methods to advance the spectral approximation, by suppressing the Gibbs phenomenon. However, performing algebraic manipulations while keeping the number of retained orders constant, causes the spectral solution to have slightly different Fourier coefficients than the original one. Although this phenomenon makes little deviation in the form of the function, it can still harm the efficacy of post-processing techniques.
Without loss of generality, let all the functions and solutions henceforth be defined over [-1, 1]. Letting {k = eikx} denote the Fourier basis functions, the partial Fourier expansion of the function f is defined as follows:

fN (x) =

f^k k ,

|k| N

f^k

=

1 2

f, k

1 =
2

1
f (x) k(x)dx.
-1

(1)

According to Carlson's theorem, if f  L2(-1, 1) then limN fN = f almost everywhere [80].

It implies that point-wise disagreement between a function and its Fourier series could exception-

ally occur even at continuities, as corroborated by specially fabricated examples. Nonetheless,

the solutions we typically encounter are well-behaved partially smooth functions with at most,

a finite number of discontinuities. Hence, we will presume that f = f holds everywhere except

at discontinuities.

Now, let us assume f is the product of two given functions g and h. Note that in a Fourier

spectral framework, multiplication is a nontrivial operation. According to the popular relation-

ship f^k =

 =-

g^

h^ k-

with g^

and h^

denoting Fourier coefficients of the multiplicands, exact

characterization of fN is not possible within a spectral framework of the N-th order, as it also

depends on the Fourier coefficients of g - gN and h - hN which are not retained in the process.

Hence, in practice, the truncated series fN = {gh}N is estimated and replaced by an estimate,

called the N-th order convolutional Fourier series, which we denote and define as follows:

f~N (x) = {gN hN } (x) = |k| N c^kk,

c^k = | | N g^ h^k- .

(2)

The operation f~N = gN hN , which can simply be realized through the multiplication of a Toeplitz matrix by a vector, constitutes a key part in Fourier spectral and modal methods. This simplification naturally comes at the expense of a numerical deviation, which insignificant as it might be compared to the truncation error, it can still disrupt the performance of spectral reconstructions substantially. In explaining what makes the convolutional Fourier series of two functions f and g with concurrent jumps at x = x1, effectively different from the Fourier series, we will invoke Li's important finding [29, 81]. It follows that subtracting the convolutional Fourier

4

series of a multiplicative function from its truncated Fourier series, gives rise to the emergence of an oscillatory function at the point of discontinuity, as follows:

{gh}N - gN hN = dgdh/22 N (x - x1) + o (1)

(3)

Wherein dg and dh are the corresponding jumps of g and h, the term o(1)  0 uniformly as N  , and N (x) which will be called the Li's function henceforth, is defined as follows:

N (x) = |n| N nn,

n

=

1 - n 2 |n|

1 = 1 - n |k|>N k - |n| 2 |n|

HN+|n| - HN-|n| .

(4)

In the above equation, Hm>0 =

m i=1

i-1

denote

harmonic

numbers,

H0 = 0,

and

n = n,0

is

the Kronecker delta. A fundamental property of Li's function is that when N  , the function

tends to zero at all points, except at x = 0 where it tends to 2/4. Hence, from one point of

view, Li's function can be thought of as an approximation to a single point discontinuity at the

origin. Note that the underlying assumption of all spectral methods for the elimination of the

Gibbs phenomenon is that the function should be smooth over the reconstruction interval, while

the presence of a multiplicative disorder means that the Fourier expansion of the function in the

limiting case, does not satisfy the presumptions of the problem. Thus, it can be expected from

the reconstruction methods to lose their efficacy near discontinuities.

On the other side, the derivational process of equation 3 offers another interpretation of Li's

function as a first-order perturbative term that is produced during algebraic manipulation of

Fourier series retaining a constant order [81]. Specifically, by decomposing the partially smooth

function as the sum of a continuous term and a number of linear terms (ramp functions) which

are the properly scaled and shifted replica of the same function (for each discontinuity), it can

be shown that the non-vanishing dominant term, i.e. the noted Li's function, stems from the

multiplication of two periodically extended linear terms. Of course in Li's derivation, only a

first-order continuity is taken into account (as was important in devising Fourier factorizations).

Therefore, this process can be naturally generalized to consider higher-order discontinuities as

well, resulting in higher-order perturbations that are already incorporated in the o(1) term of

equation 3. However, they might not be comparably useful in practice, since they will have a more

complicated formulation and much less numerical significance, and hence, will be disregarded in

the analytical characterization of robustness in section 4.

As an instance, consider the simple algebraic equation af + b = 0 for given functions a(x) and

b(x) with a(x) = 0. From a spectral perspective and according to equation 3, the accurate N-

th order solution can be expressed as fN = -(a-1)N bN + µ0N for some constant µ0, however in practice, we can only compute f~N = -(a-1)N bN as the spectral solution, leading to the

manifestation of Li's function. More specifically, since no disturbance should be in the accurate

truncated solution fN , then a perturbative term -µ0N should have appeared in the spectral solution f~N to be canceled out in the expression for fN .

As for the next instance, consider an eigenvalue differential equation of the form (D + )f = f,

where D is a differential operator, is a periodic partially smooth function, f is an eigenfunction,

and  denotes the corresponding eigenvalue. Moreover, we assume the only discontinuity of (x)

over the whole interval to be at x = 0. The spectral form of the equation can clearly be expressed

as (Df)N + ( f)N = fN , however, it is not manageable in this form. Using the convolutional Fourier series, the latter equation can be restated as below for a constant µ0, provided that f(x)

is also discontinuous at x = 0:

DN fN + N fN + µ0N (x) = fN .

(5)

5

Wherein the truncated scalar (or vectorial) differential operation DN can typically be modeled using a simple (or block) diagonal matrix. The above equation is the ideal form, however, what in practice one tries to solve is as follows:

DN f~N + N f~N = f~N .

(6)

Comparing the last two equations, we guess a relationship of the form fN = f~N + aN (x) approximately holds. To assert such a relationship and obtain a, we will perform a first-order approximation in our calculations, which will be explained subsequently. Recall that for large values of N, the function N (x) acts like a (periodic) delta function. Hence, performing any differential operation on it results in higher-order distributions which we neglect in our first-order approximation. On the other side, N N can be approximated by c0N (x) where c0 = (0-)/2 + (0+)/2. Note that the residual term of this approximation can also be best approximated using the derivative of a delta function and therefore ignored here. Accordingly, let us replace fN = f~N + aN (x) in equation 5. It simply follows that:

DN f~N + N f~N + ac0N + µ0N = f~N + aN .

(7)

Trying to balance both sides of the above equation with the perturbative terms, a is found, and the following relationship holds consequently:

fN = f~N + µ0( - c0)-1N .

(8)

Since no first-order disturbance should appear in the original truncated solution fN , it follows that a perturbative term -µ0( - c0)-1N should dominate in the spectral solution f~N .
Eventually, let us point out how Li's function appear in a grating eigenmode. If we denote
the free-space wavenumber with k = 2/, in which  is the free-space wavelength, Fourier modal
methods commonly lead to an eigenproblem as expressed below:

P - 2I et = 0.

(9)

In which P is the modal matrix, et is the electric field eigenvector comprised of the Fourier coefficients of the lateral components, and  = kz/k is the normalized longitudinal propagation constant and the square root of an eigenvalue. The detailed expansion of the modal matrix P is expressed in Appendix .1. Considering a one-dimensional (lamellar) grating, the modal matrix can be elaborated as follows, in which F = T ( ) is a Toeplitz matrix of the Fourier coefficients of the periodic dielectric function (x), Nx is diagonal matrix equivalent to the operator  = k-1/x, Ny0 = ky0/k is a constant, and  = Ny20 + 2 is the translated eigenvalue:

F - NxF -1NxF - I

0

Ny0 Nx - F -1NxF F - Nx2 - I

ex ey

= 0.

(10)

Here, we will consider the equation for the x-component of the electric field, denoted by Ex = Ex(x). The equivalent differential form of the equation would be ( -  -1 - )Ex = 0. Depending on the methodology in Fourier modal methods, the inverse matrix F -1 may be replaced with T ( -1), asymptotically producing the same matrix [82]. For the sake of simplicity, let us
use the latter case and write the undisturbed truncated equation for Ex,N :

6

N Ex,N + µ0N - Ex,N = N

-1 N

{N { N

Ex,N + µ0N }} + µ1N .

(11)

Where µ0 and µ1 are constants with respect to x. On the other side, what we practically solve in an algebraic form with E~x,N as the eigenfunction, is the same as the above equation without
the N terms:

N E~x,N - E~x,N = N

-1 N

{N { N

E~x,N }} .

(12)

Now, assuming the relationship Ex,N = E~x,N + aN for the original and perturbed solutions,
the constant a should be found such that equation 11 consistently leads to equation 12. Given the
estimating rules of the previous example, it would be straightforward to show a = µ0( - c0)-1, where c0 = (0-)/2 + (0+)/2. Now, since N does not manifest in Ex,N , it should inevitably appear in E~x,N . Same process could be repeated to analyze Ey = Ey(x), using the following equation:

Ny0

N Ex,N -

-1 N

{x { x

Ex,N + µ0N }} + µ1N

+N

Ey,N - N2 {Ey,N } - Ey,N = 0. (13)

Note that since Ey is continuous, no additional N term needs to be placed in the right-hand side convolutional series of this equation. Equation 13 is the unperturbed form, however, the equation that is practically solved for E~x,N and E~y,N is obtained by letting µ0 = µ1 = 0 in the above equation. Now, assuming Ex,N = E~x,N + aN and Ey,N = e~y,N + bN , replacing in equation 13, and retaining first-order perturbative terms only, the relationship b = Ny0µ1( - c0)-1 is obtained. Note that Ex is discontinuous and besides a first-order Gibbs phenomenon, it also includes a first-order disorder n(x) as well. On the other hand, Ey is a continuous function and hence does not show a first-order Gibbs phenomenon, however, depending on the formulation, it can still
incorporate a first-order multiplicative disorder.

2.2. Performance of Spectral Reconstructions
In the literature, it is common to substantiate the efficacy of mathematical techniques for the removal or amelioration of the Gibbs phenomenon through properly defined test functions. Despite the seeming triviality of this process, however, a simple yet different approach towards their definition may lead to the unexpected. In the previous subsection, we explained how a multiplicative disorder can propagate through an eigenproblem and most dominantly (aside from the Gibbs phenomenon) perturb the eigenfunctions.
Accordingly, we propose that if instead of a simple discontinuous test function and its Fourier series, one defines a test function as the product of two discontinuous functions and employs the associated convolutional Fourier series, the performance of a post-processing method for retrieving a spectral solution can be more pragmatically assessed. In other words, using multiplicative test functions can be considered as an indicator as to what extent a method is robust against the emergence of a local disorder or a point discontinuity. On the other side, note that the solutions to a Fourier eigenproblem do not have a closed-form, hence, exclusive reliance upon their application for the performance analysis of recovery techniques could hardly be as elucidative and inspiring as properly defined test functions.
Let f(x) = g(x)h(x) be the product of two piece-wise smooth functions g(x) and h(x) with concurrent jumps at x = 0.5. We consider two different sets of definitions for g(x) and h(x). The first set of functions are such that their product is smooth everywhere as follows, with g(x) denoting the Heaviside step function:

7

1.3

2

1.15

1.5

1

0.85

-1

-0.5

0

0.5

1

(a)

1

0.5

-1

-0.5

0

0.5

1

(b)

Figure 2: Depiction of test functions, their convolutional Fourier series, and reconstructions (via Vandeven filter) for: (a) continuous product 14, and (b) discontinuous product 15.



g(x) = 4 - 2u (x - 0.5) - 0.3 sin(5 2x)

(14)

h(x) = exp{0.2 sin(x)}/g(x)

As the product is continuous, the Gibbs phenomenon is not directly present in its convolutional Fourier series, and consequently, it would the multiplicative disorders that give rise to the observable oscillations. We define the second set such that the product of discontinuous functions g(x) and h(x) is also discontinuous at x = 0.5, as follows:



g(x) = 4 - 2u (x - 0.5) - 0.3sin(5 2x) 

(15)

h(x) = 0.25 + 0.75u (x - 0.5) + 0.1 sin(5 2x)

The test functions f, and their convolutional Fourier series f~N = gN hN are depicted in figure 2a and figure 2b, respectively. For a comparison, the application of the Vandeven filter on both spectra are also depicted as well [52].
Resolution of the Gibbs phenomenon predominantly depends on prior knowledge of the location of discontinuities, which otherwise should be estimated using edge detection techniques [83, 84]. Fortunately, in Fourier modal methods and grating problems, the location of discontinuities is available, however, the value of the jump in the solution is unknown. Hence, those techniques which also require the amplitude of the jumps, e.g. the Eckhoff method [56], are not directly applicable, and hence not studied here. The methods we evaluate their performance here are the Vandeven filter [52], polynomial least-squares [71], Fourier extension [73], singular Fourier-Pad´e [60], Freud reconstruction [66], and Gegenbauer reconstruction methods [61], each representing a type of spectral reconstruction. While the formulation of the latter method is discussed in section 3, a very concise explanation of the rest and their associated parameters could be found in Appendix .2. Still, for elaborate theoretical discussions and generalizations refer to the references specified here and throughout the text. Although the extent of existing algorithms and techniques is by no means limited to the above list, the methods considered here characterize the highlights of the endeavors to overcome the Gibbs phenomenon.
In figure 3, we have plotted point-wise error graphs regrading the methods listed above, for both the continuous (with the Fourier order N = 40) and discontinuous (with the Fourier order N = 120) test functions of equations 14 and 15. Each plot in this figure includes four logarithmic error graphs (in terms of dB) as follows: the Fourier series error e(x) = 10 log |f - fN | in yellow, the convolutional Fourier series error e~(x) = 10 log |f - f~N | in red, the reconstruction error from

8

0

-20

-40

-60

-1

-0.5

0

0.5

1

0

-20

-40

-60

-1

-0.5

0

0.5

1

0

-20

-40

-1

-0.5

0

0.5

1

0

-20

-40

-60

-1

-0.5

0

0.5

1

0

-20

-40

-60

-1

-0.5

0

0.5

1

0

-20

-40

-1

-0.5

0

0.5

1

(a)

(b)

(c)

0

-40

-80

-120

-1

-0.5

0

0.5

1

0

-40

-80

-120

-1

-0.5

0

0.5

1

0

-40

-80

-120

-1

-0.5

0

0.5

1

0

-40

-80

-120

-1

-0.5

0

0.5

1

0

-40

-80

-120

-1

-0.5

0

0.5

1

0

-40

-80

-120

-1

-0.5

0

0.5

1

(d)

(e)

(f )

Figure 3: Point-wise Fourier series and reconstruction error of the test functions 14 and 15 vs. the Fourier order (a) Vandeven filter, (b) Legendre polynomial least-squares, (c) Fourier extension, (d) singular Fourier-Pad´e, (e) Freud reconstruction, and (f) Gegenbauer reconstruction methods.

the Fourier series eR(x) = 10 log |f - RfN | in blue, and the reconstruction error with convolutional Fourier series e~R(x) = 10 log |f - Rf~N | in black, wherein R denotes the reconstruction operator acting on a Fourier series.
In figure 3a, the error graphs are plotted for the Vandeven filter. We have numerically investigated many filters and mollifies, and selected this filter thoughtfully to represent the whole category, as one of the most efficient filters for this application. In figure 3b,same graphs are plotted for the polynomial least-squares method. We have chosen the Legendre polynomials asthe reconstruction basis due to their stability and simplicity, with the parameters (1, 2) = (3 3/4, 3/4) for the two smooth sub-domains. In figure 3c, the corresponding graphs are plotted for the Fourier extension method, with the parameters (T1, 1, T2, 2) = (2, 6, 6, 2) for the two sub-domains. In figure 3d, the error graphs are plotted for the singular Fourier-Pad´e method. In this method, a singular point may emerge at the discontinuity that should be manually modified not to get a misleading L error later. Eventually, figures 3e and 3f, pertain to the spectral reprojection using Freud and Gegenbauer polynomials respectively. Besides the point-wise error plots, we have also plotted the maximum error (L error) of each method versus the Fourier order N in figure 4. Similarly, each graph includes four error plots, in the respective order mentioned above.

9

1

0

-1

-2

-3

0

20 40 60 80 100 120 140 160

0

-10

-20

-30 0

20 40 60 80 100 120 140 160

(a)

10

0

-10

-20

-30 0

20 40 60 80 100 120 140 160

(b)

20 10
0 -10 -20 -30 -40
0

20 40 60 80 100 120 140 160

(c)

10 0
-10 -20 -30 -40
0

20 40 60 80 100 120 140 160

(d)

10 0
-10 -20 -30 -40 -50
0

20 40 60 80 100 120 140 160

(e)

(f )

Figure 4: Fourier series and reconstruction error of the test function 15 vs. the Fourier order, for(a) Vandeven filter, (b) Legendre polynomial least-squares, (c) Fourier extension, (d) singular Fourier-Pad´e, (e) Freud reconstruction, and (f) Gegenbauer reconstruction methods.

In this figure, we have only plotted the error graphs for the discontinuous test function, as the corresponding graphs of the other function demonstrate quite similar behavior.
Observing the comparative results, let us make some key points on the performance of the above-mentioned methods. We begin with the point-wise error graphs of figure 3. First of all, note that either with the original or convolutional Fourier coefficients, retrieving a function becomes less accurate at the boundaries of the reconstruction interval, regardless of the Gibbs phenomenon or the multiplicative disorders. Moreover, post-processing methods predominantly does not make a distinction between a continuous or discontinuous function to provide a certain accuracy, wether unperturbed Fourier series are employed or the convolutional ones. Besides, comparing the red and black plots reveals that no method, except for the Freud and Gegenbauer reconstruction, is capable of removing the Gibbs phenomenon (and its implications) around the discontinuities from the convolutional Fourier series. Whereas, using the original Fourier series, only the filtering method cannot improve the retrieval around these points as filters are not universal solutions to the Gibbs phenomenon. Nonetheless, unlike most other methods, the Vandeven filter remains quite indifferent to the presence of multiplicative perturbations at a distance from discontinuities, making it one of the most efficient approaches away from critical

10

neighborhoods. Let us also consider the convergence behavior of the methods in figure 4. As expected, the
Vandeven filter error decreases very slowly with both the original and the convolutional Fourier series. On the other side, excluding the last two methods, the emergence of multiplicative disorders totally disrupts the convergence of other techniques. This is a pivotal observation, as it reveals that despite potential superiorities of more modern techniques, only the spectral reprojections seem to be robust enough. On the downside, note how the beginning point of the convergence in various methods compare, given the ideal Fourier coefficients (blue graphs). As it can be seen, the convergence of the last two methods start at significantly higher-orders compared to other alternatives. This phenomenon is attributed to the poor resolution power of these methods, i.e., the ability to recover the oscillatory behavior of a function [62], while for instance, the Fourier extension method is proven to have an excellent resolution power [75]. Moreover, there are serious stability concerns with the Gegenbauer method stemming from the round-off error [85, 66] or other complications such as the generalized Runge phenomenon [86]. In fact, the instability is proven to be an intrinsic property to any exponentially fast method [87]. Not to mention more modern methods seem to have successfully improved the resolution power and the stability of the Gegenbauer method. Nonetheless, this paper reveals they lack a fundamental robustness property that might totally incapacitate them.
We will conclude this part by comparing the two spectral reprojection (direct reconstruction) techniques, i.e. Freud and Gegenbauer methods. The former lacks a rigorous mathematical theory of convergence, and its applicability is only numerically substantiated. Besides, since the Freud polynomials do not have a closed-form, they should be estimated on a discrete stencil using Stieltjes algorithm [66]. As a result, gaining a higher accuracy requires a higher number of points, making it a much more computationally expensive approach, and leaving the classical Gegenbauer as the only proven method to be robust against the multiplicative disorders. Later in section 4, we will rigorously prove the robustness of the Gegenbauer method.

3. Gegenbauer Method and Its Application
The first complete solution to the long-standing question on how to extract the information from a Gibbs-polluted spectral series with a super-algebraic rate was discovered and explained by Gottlieb et al. in a series of papers [61, 62, 63], proposing the idea of spectral reprojection. In this section, we present the basic formulation and the application the Gegenbauer method for retrieving the eigenmodes in Fourier modal methods.
3.1. Basic Formalism
In the spectral reprojection method, the finite expansion of a function in terms of the basis functions (here complex exponentials) is projected onto another space with different bases (such as polynomials). Let {k = eikx}Nk=-N and { }M=0 denote the expansion and projection spaces respectively, and f be an analytic function over [-1, 1], with truncated finite Fourier series as defined in equation 1. The spectral reprojection fN,M of the truncated expansion fN , would be defined as the follows:

M

fN,M (x) =

{
=0

fN , 

w/  , 

w} (x).

(16)

The idea is that by selecting the appropriate bases l, the new spectral expansion can converge to the main function at a faster rate. According to the spectral theory, for a spectral expansion of such a function to be successfully reconstructed via a second set of bases, the new

11

bases should fulfill two conditions [66]: firstly, the expansion of the function in the reconstruction space should converge to the main function exponentially fast, and secondly, the projection of the higher-order basis functions of the first space, on the lower order bases of the reconstruction space should become exponentially small. A set of bases that meets such conditions is called a Gibbs' complement. The former condition that is met by the likes of Chebyshev or Legendre polynomials, is established easily, while the latter creates more complexity. Gottlieb et al. showed that Gegenbauer polynomials  = C(x), under certain circumstances, constitute a Gibbs' complement. Later Gelb et al. speculated that a properly tailored set of Freud polynomials can be another Gibbs' complement. However, to date, no other bases with such properties have been discovered.
The principles of the spectral reprojection using Gegenbauer polynomials are briefly noted here. Given the weight parameter  > -1/2 (not to be mixed up with the wavelength) and for
 N  {0}, Gegenbauer polynomials C(x) are a group of orthogonal polynomials defined over the interval [-1, 1] with the weight function w(x) = (1 - x2)-1/2, satisfying a weighted orthogonality relationship as follows:

1

C , Cn w =

C (x) Cn (x) w(x)dx = l,nhn

-1

In which  ,n is the Kronecker delta and:

(17)

hn

=

1/2Cn

(1)

(+1/2) ()(n+)

,

Cn (1)

=

(n+2) (2)n!

.

(18)

In the above notations, (·) denotes the famous gamma function. Gegenbauer polynomials have many closed-forms, however, the following is particularly useful in numerical calculations:

Cn (cos ) =

n  (k + )  (n - k + ) cos (n - 2k) 
k=0 k! () (n - k)! ()

(19)

Eventually, the following identity plays a pivotal role in simplifying the relations, extracting a closed relationship for the reconstructed series, and proving the convergence of the method, wherein J(·) denotes the Bessel function of the first kind:

1 h

einx, C w =  () (n/2)-i (

+ ) J + (n) .

(20)

Let us denote the image of a typical function u(x) on the space of Gegenbauer polynomials of the maximum order M + 1 and the parameter  with GM, {u}, elaborated as follows:

GM, {u} =

M1 =0 h

u, C

w C(x).

(21)

Later, we will also need a modified version of the Gegenbauer image defined as follows, which is the same as above equation except without the initial summand of = 0:

GM, {u} = GM, {u} - u, C0 wC0/h0 .

(22)

12

Since Gegenbauer polynomials constitute a complete set of bases, the expansion of the function f in terms of Gegenbauer polynomials can be expressed as follows, in which f^ ( ) denotes
the -th coefficient:

f = G, {f } =

 f^ ( ) C,
=0

f^ (

)

=

1 h

f, C w .

(23)

Due to equation 16, we need to compute the first M coefficients of GM, {fN }, as approximations to f^ (l). To do so, we use equation 20 to obtain the associated coefficients g^ ( ), as
follows:

g^ (l)

=

1 hl

fN , Cl w =  () il (l + )

|k| N Jl+ (k) (k/2)-f^(k).

(24)

The first term of the above summation at k = 0 simply equals 0,lf^(0), otherwise, the functions are well behaved and the series is not difficult to calculate numerically. Though, fast Fourier transform-based methods are also available to calculate the Gegenbauer coefficients [88]. Equation 23 can also be generalized to reconstruct the function in any subinterval [a, b] over which the function is analytic, in case f is piecewise analytic and 2N + 1 the first coefficients of its Fourier series are available. To do so, we define  = (a + b) /2 and  = (b - a) /2 such that the mapping x =  +  corresponds any   [-1, 1] and x  [a, b] bijectively. Accordingly, the Gegenbauer expansion we use for the function in terms of the new variable , can be expressed as follows:

f (x =  + ) = G  {f ( + )} =

 l=0

f^

(l)

Cl

(),

f^

(l)

=

1 hl

f ( + ), Cl() w .

(25)

Correspondingly, Gegenbauer reconstruction coefficients which will serve as approximations to f^ (l), can be rewritten as below:

g^ (l) =  () il (l + ) |k| N f^(k)eik(k/2)-Jl+ (k) .

(26)

The above equation, provides the conclusive relationship characterizing the spectral reprojection via Gegenbauer polynomials. The obtained coefficients {g^ ( )}M=0 can then be used with corresponding polynomials C { = (x - )/} terms to reconstruct the function over [a, b]. What Gottlieb et al. proved was that constant parameters (, ) can be found such that given M = N and  = N , the reconstruction error satisfies f - GM, {fN }  = O(qN ) as N  , for some q < 1. In particular, they showed that for  =  = 0.25, the exponential convergence is guaranteed, though, the choice might not be optimum. The reliance of the Gegenbauer convergence to the choice of parameters is known to be significant, and despite scarce reports on the optimization of Gegenbauer parameters [85], the underlying theory still lacks a systematic study.

3.2. Application in Fourier Modal Methods
All variations of Fourier modal methods essentially rely on a consequent matrix eigenvalue equation, wherein the eigenvalues are longitudinal propagation constants and the eigenvectors characterize the field distribution of the corresponding modes. These eigenmodes are the constituents of any modal field expression; hence, tackling the Gibbs phenomenon in individual eigenmodes could be a key step towards its total resolution in Fourier modal methods.

13

(a) (b)
Figure 5: The unit cell of a (a) lamellar grating, and a (b) crossed grating.

Consider a grating structure positioned in the xy-plane and uniformly stretched along the z-axis, as depicted in figure 1, with the relative permittivity (x) or (x, y) for lamellar or crossed gratings. Let  denote the vacuum wavelength and k = 2/ the corresponding wavenumber. We define Tx and Ty to be the normalized periods along x and y-axes, so that (x + Tx) = (x) and (x + Tx, y) = (x, y + Ty) = (x, y), for the one or two-dimensional gratings respectively.
The resultant eigenvalue equation of the wave propagation in the grating is as given by equation 9 and expanded in appendix Appendix .1. Accordingly, the Floquet-Bloch electric field expansion of each component in a one/two-dimensional grating mode has the following form, in which (kx, ky) is the lateral component of the incident plane wave, kz the longitudinal propagation constant and the corresponding eigenvalue, r = (x, y, z) the position vector, Eu the corresponding eigenmode field component with u  {x, y, z}, and E~u a periodic function over the normalized unit cell.

Eu(r) = e-ikzze-i(kxx+kyy)E~u (r/) .

(27)

Note that the component Ez is continuous over the unit cell and converges practically fast enough. Hence, the problem of retrieving the eigenmodes predominantly attributes to the lateral components Ex/y that have a normal constituent to the boundaries of the discontinuity.
Let us illustrate how the Gegenbauer method can retrieve an eigenmode in a lamellar or crossed grating with two numerical examples. Note in a grating problem, if we sort the eigenmodes according to the real part of the associated squared eigenvalues, i.e. Re(kz2), an asymptotically well-defined ordinal relationship is obtained to characterize the modes independent from truncation orders [89]. Now, consider the lamellar grating of figure 5a under a plane wave with the incidence and azimuthal angles  =  = 45. Due to the periodicity of the grating along the x-axis, the electric component Ex for any mode should be discontinuous, while Ey remains continuous. We'd like to reconstruct Ex for the 12th and 30th modes of this structure with corresponding kz/k = 1.405 and kz/k = 1.023i. Considering a truncation order N = 48 and discretizing the integrations using L = 1001 points, we obtain the expansion of the modes and reconstruct them using the Gegenbauer method with the parameters (, ) = (0.25, 0.6). The second parameter is cautiously selected higher than the popular choice  = 0.25 to accelerate the convergence. The Fourier expansion and Gegenbauer reconstruction of Re(Ex) are plotted for both modes in figures 6a and 6b.
For the second example, let us consider the crossed grating of figure 5b. Although a twodimensional Gegenbauer reconstruction is feasible on rectangular smooth regions [65], it might

14

1

0.5

0

-1

-0.5

0

0.5

1

0.5

0

-0.5

-1

-0.5

0

0.5

1

(a)

(b)

Figure 6: The Fourier expansion (N = 48) and reconstruction of Re(Ex) for the (a) 12th mode (kz/k = 1.405), and (b) 30th mode (kz/k = 1.023i) of the lamellar grating figure 5a.

(a)
(b) Figure 7: The Fourier expansion (Nx = Ny = 16) and reconstruction of the 9th mode electric field components (kz/k = 0.773) for the crossed grating figure 5b: (a) Re(Ex), and (b) Re(Ey).
prove inefficient in practice. Instead, we notice that the continuity property of the tangential field components implies that in this problem, the much simpler one-dimensional Gegenbauer reconstruction suffices to retrieve the modal fields. Since all the discontinuities of Re(Ex) within the unit cell lie on a line y = c, by partitioning the cell along this line, Re(Ex) could be reconstructed in either of the two regions using basis functions of the form Cm {(x - )/ Tx} exp{iny/Ty}. Sim-
15

ilarly, Re(Ey) may be reconstructed in two regions separated by a line x = c , in terms of basis functions of the form exp{imx/Tx}Cn {(y -  )/ Ty}. If we didn't use this property, unit cell should have been at least partitioned into three rectangular sections and the basis functions in each sections would have been like Cm {(x - )/ Tx} Cn {(y -  )/ Ty}. Now, assuming a plane wave is incident on the grating of figure 5b, with (, ) = (45, 60), we form and solve the associate eigenproblem with the truncations orders N1 = N2 = 16 and use L1 = L2 = 1001 points in both directions for the dicretization. Using the two partitions specified in figure 5b, the electric components Ex and Ey of the 9th mode with kz/k = 0.773 are reconstructed with the parameters (, ) = (0.25, 0.25) and depicted in figures 7a and 7b, respectively.
4. Robustness Theorem and Its Proof
As noted earlier, the Gegenbauer method can restore a function from its truncated Fourier series exponentially fast. However, we showed a deterministic perturbation can also appear in the expansion of spectral solutions. Consequently, the overall performance of the method largely depends on to what extent it is robust against this computational disorder. This section proves the robustness of the Gegenbauer method, signifying a pivotal, novel, and almost exclusive property of this classical technique. Robustness as we define implies that the spectral reconstruction of the first-order perturbative function N (x - 1) = N (x + 1) converges to zero under the Lnorm, as the Fourier order tends to infinity. Note that in single domain spectral reprojection, the function should be smooth within the interval, hence, the Li's function is shifted accordingly to place the perturbation at the discontinuity x1 = -1 = 1. Let us start by denoting the Gegenbauer reconstruction and modified reconstruction of the shifted Li's function as follwos, according to the definitions 21 and 22:

N (x) = GM, {N (x - 1)} ,

N (x) = GM, {N (x - 1)} .

(28)

In figure 8, the shifted Li's function N (x - 1) and its projection on the Gegenbauer space for N = 10 and N = 50 are plotted, which seems to become smaller overall by increasing the Fourier order N. Here, we will quantify and prove this observation as the following theorem:
Theorem 4.1. The Gegenbauer and modified Gegenbauer projection of the Li's shifted function diminish as N  , satisfying the following asymptotic relationships:

N (x)  = O N -1 , N (x)  = O ln(N )N -1/2e-0.232N .

(29)

Proof. For the sake of simplicity, we will use the notations E = N (x)  and E = N (x)  henceforth. Let us begin by introducing a weighted summation of the Bessel functions. For
nonnegative real  and nonnegative integer m, we define the following summation:

Sm,(n) =

n
(-1)
=1

-Jm+ ( ).

(30)

Our proof highly depends on a particular property of the above summation, expressed as the following lemma:
Lemma 4.1. Given the aforementioned prerequisites, the following relationship holds:

lim
n

Sm,(n)

=

-

(/2) 2(+1)

m

+

Cm,em,

Cm, = 0. 16

(31)

0.5

0.5

0

0

-0.5

-0.5

-1

-0.5

0

0.5

1 -1

-0.5

0

0.5

1

Figure 8: Shifted Li's function N (x - 1) and its Gegenbauer image N (x) for N = 10 and N = 50.

In which Cm, is a constant with respect to n, em = sin2 (m/2) returning 0 for even subscripts and 0 for odd ones, and m = m,0 denotes the Kronecker delta.
As the rest of the arguments do not depend on the proof of this lemma, we postpone it to the end of this section. A difference form of equation 30, can be expressed as follows:

Sm, = Sm,(n) - Sm,(n - 1) = (-1)nn-Jm+ (n) .

(32)

Bessel functions exhibit the asymptotic behavior J (x)  (x/2)-1/2 cos (x - /2 - /4) for x/ 1. Hence, given that n is sufficiently larger than m + , the difference term in equation 32 can be approximated with (-1)nn-Jm+ (n)  cn--1/2 for some constant c. As a result, after a certain point, say = n0, the summands do not change sign (without loss of generality assume they are positive), and the summation of equation 30 behaves as a p-series, converging as n  , if and only if  > 1/2. On the other hand, irrespective of the limit to the series, the rate of convergence/divergence for Sm,(n) may be evaluated through the summation (approximated by integration) over the difference-terms of equation 32. In other words, for sufficiently large n/(m + ):

Sm,(n) = A0 +

n
Sm,( )  A0 + A1
=nn0

n

--1/2

=n0

 A0 + A1

--1/2d  A + O ||-1n-+1/2 .

n0

(33)

In which A0, A1, and A are constants. Note that unlike the aforementioned asymptotic relationship for Bessel functions which holds for sufficiently large arguments, we could have used Landau's inequality that holds everywhere, i.e. |J (x)| b|x|-1/3 for all positive  and real x with b  0.7875 [90], though slightly weakening the bound. In other words, by replacing Landau's bound, equation 33 would have held for relatively smaller values of n (it still needs to be large enough for terms of equation 32 not to change sign). In practice, by taking the square root relationship, one should have at least x > 3(m + ), yet by taking the cubic root bound, even x > m +  seems to suffice. In our final application, the argument will be large enough to utilize the first bound, however, for the sake of generality, we may rewrite equation 33 using |J (x)| b|x|- for  [1/3, 1/2].
According to Lemma 4.1. for nonzero even values of m and real  > 1/2, the constant A in equation 33 should be zero to satisfy the zero limit. On the other hand, for  < 1/2, the sum

17

tends to infinity and the amount of the constant does not matter anyway. Consequently, for large enough n/(m + ), equation 33 can be rewritten as follows:

Sm,(n) = (em + m)Am, + O ||-1n-- +1 .

(34)

Where Am, is a nonzero constant. Now, let p(·) denote a polynomial of the order , which depending on the parity of , comprises only even or odd order terms. Moreover, assume p(n) is a nonnegative increasing function for n  N. We will denote the set all such polynomials with P. Note that any p  P can be expressed as below:

p (x) =

r xr .

0r 2| -r

(35)

Now, we would like to generalize the Bessel sums of equation 30, based on a polynomial p  P. We define:

Sm, (n; p ) =

n
(-1)
=1

p (

)

-Jm+ (

).

(36)

Notice that the generalized form of equation 36 can be expressed in terms of the simple forms of equation 30, as follows:

Sm, (n; p ) =

r Sm+r,-r (n).

0r 2| -r

(37)

If we assume  is an even number and n/(m + ) is large enough, it is straightforward using equations 34 and 37 to conclude Sm, (·; p) should have the following asymptotic form, wherein Am, and c are some constants:

Sm, (n; p ) = (em+ + e+1m) Am, + O(nc).

(38)

The above equation specifies the form of the constant term accurately enough. However, to further characterize the n-dependant term O(nc), we need to use a similar approach to what we practiced earlier for the derivation of equation 34. Writing down the difference-form of equation 36 accordingly, we have:

Sm, (n; p ) = Sm, (n; p ) - Sm, (n - 1; p ) = (-1)np (n)n-Jm+ (n)  p (n)n-- . (39)
Wherein we have assumed for the sake of simplicity (though without loss of generality) that the difference-terms are positive. Now, similar to equation 33, we may conclude:

Sm, (n; p ) = A0 + n Sm, ( ; p )  A + B n p ( ) --

=n0 n
A + Bp (n)

=n0
--  A + Bp (n)||-1n-- +1.

=n0

(40)

In which A0, A, and B are constants, and we have used the fact that p is positive and increasing over positive integers. If we let  = O(N) for some N such that n N, then:

18

Sm, (n; p )  (em+ + e+1m) Am, + O p (n)n-- .

(41)

Provided that  and m are both even, the following result will consequently hold, using Lemma 4.1:

Sm, (n; p ) = Amp (0) + O p (n)n-- ,

A



lim
n

S0,(n)



(/2)/

(

+

1).

(42)

Considering a polynomial p  P with an even , now we define a perturbative test function as below, an try to evaluate how the Gegenbauer method reprojects it:

N (x; p ) =

(-1)np (|n|) einx.

0<|n| N

(43)

We denote the corresponding reconstruction of the above function as follows:

 (x; p ) = GM, {N (x; p )} .

(44)

Considering the above function, let us define Ep = (1; p). Notice that since both the perturbative functions N (x; p) and the Gegenbauer polynomials take their maximum absolute value at the boundaries, we may conclude:

(·; p )  = |(1; p )| = |Ep | .

(45)

Our strategy henceforth would be to estimate Ep , expand (x - 1) in terms of N (x; p) functions, and try to estimate E in terms of Ep . To estimate the former, we begin by noting that N (x; p) and w(x) = (1 - x2)-1/2 are both even functions. As a result, the following orthogonality relationship holds for all the odd-ordered Gegenbauer polynomials (being odd
functions):

N (·; p ), Cm =2k+1

= 0.
w

(46)

Now, using the above property, equation 44 could be expanded as follows:

 (x; p ) =

M/2 1 k=0 h2k

N (·; p ), C2k

w C2k (x).

As a result and by definition:

(47)

M/2

E p

=

k=0

1 h2k

N (·; p ), C2k

w

C2k (1)

=

2

M/2 k=0

N n=1

(-1)n p (n) h2k

einx, C2k

w

 (2k + 2) .
(2k)! (2)

In which we have used equation 18 to replace C2k(1) and the fact that:

(48)

(-n/2)-J2k+ (-n) = (n/2)-J2k+ (n) .

(49)

19

Now, using equation 20 to evaluate einx, C2k w, equation 48 can be expressed in terms of S2k,(·; p) terms, as follows:

E p = 2 (/2)-

M/2 (-1)kk,S2k,(N ; p ).
k=0

Wherein the coefficients are:

(50)

k,

=

(2k+2)()(2k+) (2k)!(2)

.

(51)

Measuring the absolute value of both sides of the above equation, applying the triangle inequality, and using the estimation given by equation 42, we get:

|E p | A0 (/2)-

M/2
k,

p (N )N -- + Ap (0)k

.

k=0

(52)

In order to simplify the above equation, we need the Stirling's approximation to estimate the gamma function:

 (x) = (x - 1)!  xx-1/2e-x.

(53)

Now, using the above estimate and separating the 0, summand from the rest, equation 52 can be simplified as follows:

|E p | A0(/2)- Ap (0)0, + p (N )N -- e- ~k, = {k (k + )}-1/2 (2k + ) (k + )2k+2k-2k-2.

M/2
k=1 ~k, ,

(54)

In which k,  e-~k, and A0 is a constant. Now, by defining  = k/, the terms ~k, can be expressed as follows:

~k, = { (1 + )}-1/2 (1 + 2)

(1 + )2+2 -2


.

(55)

Wherein -1  1/2 . Its not difficult to see for sufficiently large , ~k, would be an increasing function with respect to  within the above boundaries. The asymptotic form of the first and last terms are given below for comparison:

~k, 

5/2 (27/4)

k=1 .
k = M/2

(56)

Now, by noting that 0, = ( + 1), replacing all the k summands in equation 54 with ~M/2,, and the asymptotic form of A as in equation 42, the following estimate is obtained using the Gegenbauer classical parameters (M, ) = (N/4, N/4), for some nonzero constants A and B:

|E p |

Ap (0) + Bp (N )N --

e 2

-(

M 2

)

27 4

 = Ap (0) + O

p (N )N - +1

8e -N/4 27

. (57)

20

On the other side, given the numerical criterion noted earlier for the asymptotic behavior of Bessel functions, with the classical Gegenbauer parameters we obtain N/(m + ) 2, that is large enough to utilize  = 1/2 in our estimations. Accordingly, the above relationship may be simplified as follows:

|E p | = Ap (0) + O p (N )N 1/2e-0.232N ,

2 | .

(58)

Now, we try to express N (x - 1) in terms of N (x; p) functions. Let us begin with expanding N (x - 1) and reformulating its Fourier coefficients N form equation 4:

N (x - 1) = |n| N (-1)nneinx,

1

n

1

n

=

2n(N

+ 1/2)
r=1-n

1-

.
r-1/2 N +1/2

(59)

By elaborating each summand of the above relationship as a geometric series and recombining similar terms of each expansion, we may write:

n

=

1 2n(N +1/2)

n r=1-n

 r - 1/2 =
=0 N + 1/2

 =0

(N

u2 (n) + 1/2)2

+1 .

(60)

In which u2 (·) is defined as follows, with B2 +1(·) denoting the 2 + 1-th Bernoulli polynomial:

u2

(n)

=

1 n

n

(r - 1/2)2

=

B2

+1(n

+

1/2) .

r=1

n(2 + 1)

(61)

A generalized form of this identity can be found in [91]. The reader should note that u0(n) = 1. Now, since x = 0 is a root of the equation B2k+1(x + 1/2) = 0 for > 0, n-1B2 +1(n + 1/2) and consequently u2 (n) are also polynomials of n. Furthermore, from equation 61, it follows trivially that u2 (n) is an increasing function over positive integers. On the other side, since Bernoulli polynomials satisfy Bm(1 - x) = (-1)mBm(x) for any real x, it can be easily found that n-1B2 +1(n + 1/2) is an even polynomial in terms of n, which means that the polynomial representation of u2 (n) is also comprised of even-order terms only, and that u2  P. Eventually, we would also need to find u2 (0) as the following limit, which is easily calculated using L'Hospital's rule:

u2 (0) = lim {(2 + 1)x}-1 B2 +1(x + 1/2) = B2 (1/2) = (21-2 - 1)B2 .
x0

(62)

In which B2 denotes the 2 -th Bernoulli number. Now, let us rewrite equation 60 for the Fourier coefficients as follows, in which, q2L is clearly a polynomial itself:

n = lim q2L(n),
L

q2L(n) =

L
(N
=0

+ 1/2)-2

-1u2

(n).

Consequently by definition (from equations 59 and 43):

(63)

N (x - 1) = lim
L

L =0

(N

+

1/2)-2

-1N (x; u2

).

(64)

Projecting both sides of the above equation on the Gegenbauer space:

21

N (x) = lim
L

L
(N
=0

+ 1/2)-2

-1(x; u2

).

(65)

By evaluating the L-norm from both sides, applying the triangle inequality, and using equations 45 and 58, we get:

E lim
L

L (N + 1/2)-2 -1 |E u2 | E1 + E2.
=0

In which, for some constant A:

(66)

E1 = A lim

L (N + 1/2)-2 -1u2 (0),

L

=0

E2 = lim

L (N + 1/2)-2 -1O u2 (N )N 1/2e-0.232N .

L

=0

(67)

Notice that for a sequence of positive functions fi : N  R+, the relationship

 i

O(fi)

=

O(

 i

fi)

holds provided that supi O(fi)/fi  is finite. As a result, since limL q2L(N ) = N  ln(N )/N ,

we may express E2 as follows through collapsing the summation into the parentheses:

E2 = lim O q2L(N )N 1/2e-0.232N = O N N 1/2e-0.232N = O ln(N )N -1/2e-0.232N .
L

(68)

In which the finiteness condition is an implication of the fact that Sm, (n; p) /p(n)n-- in equation 39 remains bounded for large enough arguments n, even as   . On the other side, for the error E1:

E1 = A lim q2L(0) 
L

 =0

(N

u2 (0) + 1/2)2

+1

=

 =0

(21-2 - 1)B2 (N + 1/2)2 +1

.

(69)

We need to show the above series is finite (as Bernoulli numbers grow faster than exponen-

tially), and find the rate at which its value decreases with N. To do so, note the following

asymptotic

expansion

of

the

trigamma

function



(z)

=

d2 dz2

ln (z),

as

a

Laurent

series:



(z)



1 z

+

1 2z2

+

 =1

B2 z2 +1

,

z  .

(70)

The trigamma function is decreasing for positive arguments such that for large arguments  (z)  0, and its descent rate is dominated by the first-order term z-1. Accordingly, the series appearing in equation 69 can be asymptotically expressed in terms of trigamma functions as follows:

E1  4 (2N + 1) -  (N + 1/2),

N  .

(71)

On the other side, the following identity holds for all the polygamma functions [91]:



(2x)

=

1 4

{

(x)

+



(x

+

1/2)}.

(72)

22

By replacing x = N + 1/2 in the above equation, and using equations 66, 68, and 71, it follows that for large enough N, the following result holds:

E A (N + 1) + O ln(N )N -1/2e-0.232N = O N -1 .

(73)

This result concludes the proof of the first proposition in Theorem 4.1. For the second proposition, let us point out an important implication of our derivations. As we observed, the reconstruction error of the shifted Li's function incorporates diminishing terms of the order O(N -k) and O(e-cN ). Notice that the former terms arise from the appearance of the constant part of u2 polynomials in E1. On the other side, according to equation 52, the constant part of the polynomials are sustained only if the first Gegenbauer polynomial C0(x) exists among the reprojection bases. In other words, by omitting the first Gegenbauer polynomial from the reconstruction space, only the E2 term will appear in E, and hence, according to definition 22:

E = N (x)  = O ln(N )N -1/2e-0.232N .

(74)

Which proves the second part of Theorem 4.1. and concludes it. As an important implication of the above result, note that since projecting a Fourier series upon the C0(x) only contributes to the correction of the DC part of the reconstructed function, regardless of a constant summand, the modified Gegenbauer reconstruction of series can also retrieve a function. More specifically, as the modified method resolves both the Gibbs phenomenon and the multiplicative disorder exponentially fast, we may conclude its overall convergence rate is exponential, though up to constant summand.
Finally, let us get back to proving the lemma we stated at the beginning of this section. Proof of Lemma 4.1. The relationship 31 will be tackled with for m = 0, m = 2p > 0, and m = 2p + 1 separately, and the results will eventually be combined together. According to Poisson's integral [91], the following property holds for Re{} > -1/2:

1

J(z) = 2K

z 



cos(zt)w(t)dt.

0

In which:

(75)

K = -1/2(/2) ( + 1/2)-1, Now if we define:

w(t) = (1 - t2)-1/2.

(76)

Qm,n(t) = n (-1) mcos ( t).
=l

(77)

Then, equation 75 may be used to express the summation of equation 30 as an integral, with Km+ as defined in equation 76:

Sm,(n) =

n
(-1)
=1

-Jm+ ( ) = 2Km+

1
Qm,n(t)wm+(t)dt.
0

(78)

First of all, note that due to Lagrange's trigonometric identity, Q0,n(t) constitutes of two terms, as follows:

23

Q0,n(t)

=

-

1 2

+

Q~0,n(t),

Q~0,n(t)

=

(-1)n 2

cos((n+1/2)t) cos(t/2)

.

(79)

By replacing the above relationship in equation 78 and simplifying the integral for each constituent, S0,(n) can be expressed as follows:

1

S0,(n)

=

-

(/2) 2(+1)

+

(-1)nK

f (t) cos (t) dt.

0

(80)

Wherein  = (n + 1/2) and f (t) = sec(t/2)w(t) is a nonnegative function. Note that sec(t/2) is singular at t = 1 and behaves as  (1 - t)-1 at the vicinity of the singularity. Besides, the weight function w(·) behaves as  (1 - t)-1/2. Now, since we had assumed  > 1/2, the limiting behavior of f(t) would be as  (1 - t) -1 for a positive , and hence the function would be L1-integrable over the interval. On the other hand, the latter statement would be a sufficient condition for the
Riemann-Lebesgue lemma to hold for the integral term of the above eqution [91]. As a result,
the integral tends to zero as  approaches infinity and:

lim
n

S0,(n)

=

-

(/2) 2(+1)

=

0.

(81)

Having concluded the case m = 0, we continue by considering the case of positive even m.
Notice that for m > 0, the function Qm,n(t) of equation 77, may be obtained as a coefficient of the m-th derivative of Q0,n(t) or Q~0,n(t):

(-1)m/2mQm,n(t) = Q(0m,n)(t) = Q~(0m,n)(t).

(82)

By replacing this equivalent form in equation 78, we get:

1
Sm,(n) = 2(-1)m/2-mKm+ Q(0m,n)(t)wm+(t)dt.
0

(83)

Here, we use induction to prove that for any positive even number m, the following relationship holds, in which µ > m + 1/2 is a constant:

1

lim
n

0

Q(0m,n)(t)wµ(t)dt = 0,

µ > m + 1/2.

(84)

Using integration by parts two consecutive times, we get:

1
Q(0m,n)wµdt =
0

Q(0m,n-1)wµ - Q(0m,n-2)wµ

1
+
0

1
Q0(m,n-2)wµdt.
0

(85)

Since m 2, it follows that µ > 5/2 and hence, wµ(1) = wµ(1) = wµ(0) = 0. On the other side, since Q(0m,n-1) is an odd order derivative of a sum of cos( t)-terms, it will only comprise sin( t)terms, meaning that Q(0m,n-1)(0) = 0. As a result of this argument, the content of the braces in the above equation simply vanishes. Now, applying two times integration by parts on the remaining
right-hand side integral in equation 85, we obtain:

24

1

1

1

Q(0m,n)wµdt = 4µ(µ - 1) Q(0m,n-2)wµ-2dt - 2µ(2µ - 1) Q(0m,n-2)wµ-1dt.

0

0

0

(86)

Hypothesizing equation 84 holds with any pair (m , µ ) that m < m is a positive even number and µ > m + 1/2, we need to prove that a similar relationship holds for the pair (m, µ) with the specified conditions. However, this argument is quite clear according to the above equation, as both the right-hand side integrals of equation 86 satisfy the induction hypothesis, and hence the induction step holds. It only remains to verify the induction base case for m = 2. Let us go back to equation 85 and expand the right-hand side integral using equation 79:

1
Q(02,n) wµdt =
0

1

1

0 Q0,nwµdt = - 2

wµ(t)

1 + (-1)n

0

2

1
f (t) cos (t) dt.
0

(87)

Wherein  = (n + 1/2) and f (t) = sec(t/2)wµ(t). The content of the braces clearly equals to zero. Now, note that µ > 5/2 and wµ = Awµ-2 - Bwµ-1 for some constant A and B. Accordingly, it would be straightforward to tailor the argument we presented under equation 80, and show the right-hand side integral also satisfies the Riemann-Lebesgue lemma prerequisites and consequently tends to zero. The latter step completes the induction and concludes the following result:

lim
n

Sm,(n)

=

0,

m > 0 and 2 | m.

(88)

Eventually, let us consider a last case where m is and odd number. We start by defining the following series:

Pm,n(t) =

n (-1) msin ( t).
=l

(89)

Another Lagrange's trigonometric identity provides an explicit relationship for P0,n, as follows:

P0,n(t)

=

-

1 2

tan(t/2)

+

Rn(t),

Rn(t)

=

(-1)n 2

sin((n+1/2)t) cos(t/2)

.

Here, a similar relationship to equation 82, may be expressed as below for an odd m:

(90)

(-1)

m-1 2



m

Qm,n

=

P0(m ,n)

=

-

1 2

{tan(t/2)}(m)

+

R(nm).

(91)

Again, we use induction to prove the following feature, provided that m is an odd number and µ > m + 1/2 a constant:

1

lim
n

0

R(nm)(t)wµ(t)dt = 0,

µ > m + 1/2.

(92)

Let us begin by considering the base case m = 1. Using integration by parts, we get:

1

1

R(n1)(t)wµ(t)dt = {Rn(t)wµ(t)}10 - (-1)n(µ - 1/2) f (t) sin(t)dt.

0

0

25

(93)

In which  = (n + 1/2) and f (t) = t sec(t/2)wµ-1(t). We know Rn(0) = 0 and wµ(1) = 0, hence, the content of the braces vanishes. As for the right-hand side integral of above equation, since we assumed µ - 1 > 1/2, a similar argument to the one we made previously, shows that f(t) is absolutely integrable over the interval (a sufficient condition for the Riemann-Lebesgue lemma) and consequently its value tends to zero as n  . This result affirms the induction base case. Now, assuming m 3, we perform two times integration by parts on the integral of equation 92 to reach:

1

1

1

R(nm)wµdt = R(nm-1)wµ - Rn(m-2)wµ +

R(nm-2)wµdt.

0

0

0

(94)

One easily finds that wµ(1) = wµ(1) = wµ(0) = 0. Moreover, since m - 1 is a positive even number, it is easy to check from equation 90 that Rn(m-1)(t) can be expressed as a finite sum of sin( t/2)-terms and the (m - 1)-th derivative of a tan(t/2)-term. The former terms clearly equal
to zero at t = 0. As for the latter, note the Taylor series for the tangent function with |x| < /2:

tan(x) =

 (-1)n+1 4n(4n - 1)B2n x2n-1 = x + x3 + 2x5 + 17x7 + · · · .

n=1

(2n)!

3 12 315

(95)

In which B2n denote Bernoulli numbers and all the coefficients are positive. Since only odd orders appear in the Taylor series, all the even order derivatives at zero must equal to zero. This point concludes that R(nm-1)(0) = 0 and hence, the content of the braces in equation 94 also equals to zero. Now, we perform another two times of integration by part on the right-hand side
integral of equation 94 and simplify it:

1

1

1

R(nm)wµdt = 4µ(µ - 1) R(nm-2)wµ-2dt - 2µ(2µ - 1) Rn(m-2)wµ-1dt.

0

0

0

(96)

Having obtained a similar relationship to equation 86, a quite similar argument easily proves the induction step, concluding the relationship 92. Accordingly, replacing the representation 91 in the integral form of 78 leads to the following:

1

(-1)

m+1 2

mSm,(n)

=

Km+

tan (t/2)(m) wm+(t)dt + o(1).

0

(97)

Wherein limn o(1) = 0. It is clear that the integral appearing in the right-hand side of the above equation is independent from n. Hence it only remains to show the value of this integral is nonzero, which is quite clear according to the Taylor series of equation 95. In fact, the expansion of tan (t/2) comprises only positive coefficients for t  (0, 1), which means that any derivative of the function is positive over the integration interval (0, 1). Furthermore, the weight function wm+(t) is also positive over (0, 1). Consequently, the product of two positive functions have a positive integral, proving the following result:

lim
n

Sm,(n)

=

0,

m > 0 and 2 m.

(98)

Now, combining the results of equations 81, 88, and 98, concludes the relationship 31 of Lemma 4.1.

26

5. Conclusion
Notwithstanding the rich literature of spectral reconstructions for the resolution of the Gibbs phenomenon, rigorous study of their applicability in applied contexts remains to a substantial extent unprecedented. In this paper, we have proposed a new criterion of robustness to assess the efficacy of post-processing techniques for retrieving spectral solutions in the presence of the Gibbs phenomenon. Specifically, by focusing on the Fourier analysis of gratings, we have shown the emergence of a multiplicative perturbation potentially disrupts most of the plausible methods in the vicinity of discontinuities. On the other side, we have formulated and proved a significant theorem on the robustness of the classical Gegenbauer method against this computational disorder. This finding propounds a new perspective to the theory of spectral reconstructions.

Appendices

Appendix .1. Expansion of the Modal Matrix
The eigenmodes or eigenfunctions of a lamellar/crossed grating structure may be obtained through the following steps: expanding the dielectric function and the electric field, forming a matrix eigenvalue equation, extracting the eigenvectors, and restating them in terms of Fourier series. The eigenvalue equation is conventionally derived from the Maxwell equations [20, 30], however, our formalism here is based on direct manipulation of the wave equation of equation A-1, as described in [89]. Note again that using any formulation, even reinforced by Fourier factorization rules, can not totally prevent the emergence of the Gibbs phenomenon in spectral representation of individual modes in discrete media.

 ×  × E(r) - k2 (r)E(r) = 0.

(A-1)

In the above equation, k is the vacuum wavenumber. The dielectric function of a lamellar or crossed grating can be expressed in terms of a Fourier series as following, in which m and m,n are the one and two-dimensional Fourier coefficients:

(x) =

meimx(2/Tx),

m

(x, y) =

m,n eimx(2/0 Tx ) einy(2/Ty ) .

m,n

(A-2)

If M and N denote Fourier truncation orders along x and y axes, the total number of Fourier orders will be S = 2M + 1 and S = (2M + 1)(2N + 1), for one or two-dimensional problems respectively. Let us define Jn = {-n, ..., 0, ..., n} and Kn = {1, 2, ..., n} for any positive integer n. Now, in order to include/exclude Fourier products and arrange the equations in the matrix form, one needs to define a bijective relation  : JM  KS or  : JM × JN  KS so that every one or twodimensional index with m  JM and n  JN , corresponds to some unique ordinal number s  KS. The most trivial and common choice of order functions are as following:

s = 1d (m) = m + M + 1,

s = 2d (m, n) = (2N + 1) (m + M ) + n + N + 1.

(A-3)

If we denote (m, n) = -1(i) and (p, q) = -1(j) for any i, j  KS and consider that u  {x, y}, the building blocks of the matrix eigenvalue equation could be constructed as follows:

[F ]i,j = m-p,n-q, [eu]i = Eum,n,

[Nx]i,j = ij (kx0/k + m/Tx), [Ny]i,j = ij (ky0/k + n/Ty).
27

(A-4)

In which F is a (block) Toeplitz matrix of the Fourier coefficients, Nx and Ny are diagonal matrices, and eu are vertical vectors. Now, let us define et = [ex, ey], N = [Nx, Ny], Nt = [-Ny, Nx], Q = F - Nx2 - Ny2, F2 = I2  F , and Q2 = I2  Q, where  is the Kronecker product, Ik denotes a k × k identity matrix, and [·, ·] means the two vectors/matrices are vertically put together.
Note that for a one-dimensional (lamellar) grating, the relationship Ny = (ky0/k)I simply holds. Eventually, the modal matrix P can be elaborated as follows, in which denotes the conjugate
transpose:

P = I2S + N Q-1N -1 (F2 - NtNt) = Q2 + N N - F N F2-1 .

(A-5)

Appendix .2. Methods of Removing the Gibbs Phenomenon Here, we will briefly point out the most popular post-processing methods for the resolution of
the Gibbs phenomenon, which have been utilized throughout the text. The reconstruction methods are described in the simplest form with only one point of discontinuity (at the boundaries, where needed). Hence, the function f(x) would be smooth over [-1, 1]. The truncated Fourier series of the functions would be as given by equation 1.

Vandeven filter The Vandeven filter is a method with a proven exponential rate convergence outside a certain
neighborhood of discontinuities. Application of this filter on a truncated series is as follows:

V{fN } = |k| N  (k/N ) f^keikx,

(2p - 1)!  (t) = 1 - (p - 1) !2

t
[r (1 - r)]p-1dr.
0

(B-1)

Singular Fourier-Pad´e method In this method, the transform z = e-jx is used first, and the Fourier expansion is converted
to the sum of two Taylor series with variables z and z-1, as follows:

f (z = e-jx) =

 n=0

cnzn +

 n=0

c-nz-n = f +(z) + f -(z-1).

(B-2)

In which in summations means the first summand is halved. Given the discontinuity at x1 = 1 and considering  = e-jx1, the following singular representation for the constituent functions is sought, wherein g0±,1 are rational functions which are analytic in z = 1.

f ± (z) = g0± (z) + g1± (z) ln 1 - z/±1 .

(B-3)

For multiple discontinuities, more singular logarithmic terms appear in the above equation.

Polynomial least-squares If TM = {1, ..., M } is a set of linearly independent polynomials of the maximum order M - 1
with M = O( 2N + 1), a polynomial reconstruction  of the function f to remove the Gibbs phenomenon could be the solution to the following least-squares equation, in which bracket notation simply denotes the L2(-1, 1) inner product.

minTM

|k| N f^k - , eikx 2 .

(B-4)

For multiple discontinuities, a separate extension for each subdomain is considered and the equations are aggregated. Overall, the reconstruction over the i-th smooth subinterval will require a constant i = Mi/ 2N + 1, in which Mi denotes the polynomial order of the reconstruction over the i-th smooth subdomain.

28

Fourier extension Let GM denote the set of 2T -periodic functions defined as follows:

g



GM

:

g (x)

=

0 2

+

M
k=1 k cos (kx/T ) + k sin (kx/T ).

(B-5)

The M-th order Fourier extension of the function f over [-T, T ] is defined to be the solution to the following optimization problem:

gn

:=

arg

min ||f
gGM

-

g||2.

(B-6)

If the Fourier extension is performed over truncated Fourier series with M = O(2N + 1), it can be shown to eliminate the Gibbs phenomenon and retrieve the function. The solution to the above equation has a closed-form, though it is more convenient to compute it directly. For multiple discontinuities, a separate extension for each subdomain is considered and the equations are aggregated. Overall, the Fourier extension over the i-th smooth subdomain will require a pair of parameters (Ti, i = Mi/2N + 1), in which Ti and Mi denote the extension factor and the Fourier extension order of the i-th subdomain, respectively.

Freud Reconstruction
The formulism of spectral reprojections was elaborated in section 3 for Gegenbauer polynomials. The use of Freud orthogonal polynomials is quite similar. These orthogonal polynomials have the weight function w(x) = exp -c|x|2p , in which c = - ln( 1) and p = N (b - a)/2 - 2 2 , for the reconstruction interval [a, b]. Moreover, the reconstruction order would be M = N(b - a)/8. Note that Freud polynomials are defined on the whole domain of real numbers R, though in the reprojection framework we confine them to the [-1, 1] interval. These polynomials don't have a closed-form, though they can be estimated numerically using the Stieltjes algorithm.

References
[1] J. Boyd, Chebyshev and Fourier Spectral Methods: Second Revised Edition, Dover Books on Mathematics, Dover Publications, 2013. URL https://books.google.com/books?id=b4TCAgAAQBAJ
[2] J. Hesthaven, S. Gottlieb, D. Gottlieb, Spectral Methods for Time-Dependent Problems, Cambridge Monographs on Applied and Computational Mathematics, Cambridge University Press, 2007. URL https://books.google.com/books?id=dpZg1YEr4GEC
[3] D. Gottlieb, S. Orszag, Numerical Analysis of Spectral Methods: Theory and Applications, CBMS-NSF Regional Conference Series in Applied Mathematics, Society for Industrial and Applied Mathematics, 1977. URL https://books.google.com/books?id=7afHrqGFjSoC
[4] C. Canuto, Spectral methods in fluid dynamics, Springer series in computational physics, Springer-Verlag, 1988. URL https://books.google.com/books?id=2TbvAAAAMAAJ

29

[5] I. Babuska, B. Szabo, On the rates of convergence of the finite element method, International Journal for Numerical Methods in Engineering 18 (3) (1982) 323­341. arXiv: https://onlinelibrary.wiley.com/doi/pdf/10.1002/nme.1620180302, doi:10.1002/ nme.1620180302. URL https://onlinelibrary.wiley.com/doi/abs/10.1002/nme.1620180302
[6] B. Yang, D. Gottlieb, J. Hesthaven, Spectral simulations of electromagnetic wave scattering, Journal of Computational Physics 134 (2) (1997) 216 ­ 230. doi:https://doi.org/10. 1006/jcph.1997.5686. URL http://www.sciencedirect.com/science/article/pii/S0021999197956862
[7] J. Hesthaven, P. Dinesen, J. Lynov, Spectral collocation time-domain modeling of diffractive optical elements, Journal of Computational Physics 155 (1999) 287­306. doi:10.1006/ jcph.1999.6333.
[8] M. A. Antoniades, G. V. Eleftheriades, Compact linear lead/lag metamaterial phase shifters for broadband applications, IEEE Antennas and Wireless Propagation Letters 2 (2003) 103­ 106. doi:10.1109/LAWP.2003.815280.
[9] N. I. Landy, S. Sajuyigbe, J. J. Mock, D. R. Smith, W. J. Padilla, Perfect metamaterial absorber, Phys. Rev. Lett. 100 (2008) 207402. doi:10.1103/PhysRevLett.100.207402. URL https://link.aps.org/doi/10.1103/PhysRevLett.100.207402
[10] A. V. Kildishev, A. Boltasseva, V. M. Shalaev, Planar photonics with metasurfaces, Science 339 (6125).
[11] N. Grady, J. Heyes, D. Roy Chowdhury, Y. Zeng, M. Reiten, A. Azad, A. Taylor, D. Dalvit, H.-T. Chen, Terahertz metamaterials for linear polarization conversion and anomalous refraction, Science (New York, N.Y.) 340. doi:10.1126/science.1235399.
[12] M. C. Payne, M. P. Teter, D. C. Allan, T. A. Arias, J. D. Joannopoulos, Iterative minimization techniques for ab initio total-energy calculations: molecular dynamics and conjugate gradients, Rev. Mod. Phys. 64 (1992) 1045­1097. doi:10.1103/RevModPhys.64.1045. URL https://link.aps.org/doi/10.1103/RevModPhys.64.1045
[13] J. P. Hugonin, P. Lalanne, Perfectly matched layers as nonlinear coordinate transforms: a generalized formalization, J. Opt. Soc. Am. A 22 (9) (2005) 1844­1849. doi:10.1364/ JOSAA.22.001844. URL http://josaa.osa.org/abstract.cfm?URI=josaa-22-9-1844
[14] K. M. Ho, C. T. Chan, C. M. Soukoulis, Existence of a photonic gap in periodic dielectric structures, Phys. Rev. Lett. 65 (1990) 3152­3155. doi:10.1103/PhysRevLett.65.3152. URL https://link.aps.org/doi/10.1103/PhysRevLett.65.3152
[15] M. Plihal, A. A. Maradudin, Photonic band structure of two-dimensional systems: The triangular lattice, Phys. Rev. B 44 (1991) 8565­8571. doi:10.1103/PhysRevB.44.8565. URL https://link.aps.org/doi/10.1103/PhysRevB.44.8565
[16] R. Meade, K. Brommer, A. Rappe, J. Joannopoulos, Existence of a photonic band gap in two dimensions, Applied Physics Letters 61 (1992) 495 ­ 497. doi:10.1063/1.107868.
[17] J. Joannopoulos, S. Johnson, J. Winn, R. Meade, Photonic Crystals: Molding the Flow of Light - Second Edition, Princeton University Press, 2011. URL https://books.google.com/books?id=QrTNslcjlZEC
30

[18] S. G. Johnson, J. D. Joannopoulos, Block-iterative frequency-domain methods for maxwell's equations in a planewave basis, Opt. Express 8 (3) (2001) 173­190. doi:10.1364/OE.8. 000173. URL http://www.opticsexpress.org/abstract.cfm?URI=oe-8-3-173
[19] M. G. Moharam, T. K. Gaylord, Rigorous coupled-wave analysis of planar-grating diffraction, J. Opt. Soc. Am. 71 (7) (1981) 811­818. doi:10.1364/JOSA.71.000811. URL http://www.osapublishing.org/abstract.cfm?URI=josa-71-7-811
[20] M. G. Moharam, E. B. Grann, D. A. Pommet, T. K. Gaylord, Formulation for stable and efficient implementation of the rigorous coupled-wave analysis of binary gratings, J. Opt. Soc. Am. A 12 (5) (1995) 1068­1076.
[21] L. Li, Fourier Modal Method, in: e. E. Popov (Ed.), Gratings: Theory and Numeric Applications, Second Revisited Edition, (Aix Marseille Universit´e, CNRS, Centrale Marseille, Institut Fresnel, 2014, pp. 13.1­13.40. URL https://hal.archives-ouvertes.fr/hal-00985928
[22] G. Bao, Z. Chen, H. Wu, Adaptive finite-element method for diffraction gratings, J. Opt. Soc. Am. A 22 (6) (2005) 1106­1114.
[23] D. Correia, J.-M. Jin, 3d-fdtd-pml analysis of left-handed metamaterials, Microwave and Optical Technology Letters 40 (3) (2004) 201­205.
[24] D. C. Dobson, J. A. Cox, Integral equation method for biperiodic diffraction structures, in: J. M. Lerner, W. R. McKinney (Eds.), International Conference on the Application and Theory of Periodic Structures, Vol. 1545, International Society for Optics and Photonics, SPIE, 1991, pp. 106 ­ 113. doi:10.1117/12.49406. URL https://doi.org/10.1117/12.49406
[25] O. P. Bruno, F. Reitich, Numerical solution of diffraction problems: a method of variation of boundaries. iii. doubly periodic gratings, J. Opt. Soc. Am. A 10 (12) (1993) 2551­2562.
[26] L. Li, C. W. Haggans, Convergence of the coupled-wave method for metallic lamellar diffraction gratings, J. Opt. Soc. Am. A 10 (6) (1993) 1184­1189. doi:10.1364/JOSAA.10.001184. URL http://josaa.osa.org/abstract.cfm?URI=josaa-10-6-1184
[27] P. Lalanne, G. M. Morris, Highly improved convergence of the coupled-wave method for tm polarization, J. Opt. Soc. Am. A 13 (4) (1996) 779­784. doi:10.1364/JOSAA.13.000779. URL http://josaa.osa.org/abstract.cfm?URI=josaa-13-4-779
[28] G. Granet, B. Guizal, Efficient implementation of the coupled-wave method for metallic lamellar gratings in tm polarization, J. Opt. Soc. Am. A 13 (5) (1996) 1019­1023. doi: 10.1364/JOSAA.13.001019. URL http://josaa.osa.org/abstract.cfm?URI=josaa-13-5-1019
[29] L. Li, Use of fourier series in the analysis of discontinuous periodic structures, J. Opt. Soc. Am. A 13 (9) (1996) 1870­1876. doi:10.1364/JOSAA.13.001870. URL http://josaa.osa.org/abstract.cfm?URI=josaa-13-9-1870
[30] L. Li, New formulation of the fourier modal method for crossed surface-relief gratings, J. Opt. Soc. Am. A 14 (10) (1997) 2758­2767. doi:10.1364/JOSAA.14.002758. URL http://josaa.osa.org/abstract.cfm?URI=josaa-14-10-2758
31

[31] E. Popov, M. Nevi`ere, Grating theory: new equations in fourier space leading to fast converging results for tm polarization, J. Opt. Soc. Am. A 17 (10) (2000) 1773­1784. doi:10.1364/JOSAA.17.001773. URL http://josaa.osa.org/abstract.cfm?URI=josaa-17-10-1773
[32] E. Popov, M. Nevi`ere, Maxwell equations in fourier space: fast-converging formulation for diffraction by arbitrary shaped, periodic, anisotropic media, J. Opt. Soc. Am. A 18 (11) (2001) 2886­2894. doi:10.1364/JOSAA.18.002886. URL http://josaa.osa.org/abstract.cfm?URI=josaa-18-11-2886
[33] L. Li, Fourier modal method for crossed anisotropic gratings with arbitrary permittivity and permeability tensors, Journal of Optics A: Pure and Applied Optics 5 (4) (2003) 345­355. doi:10.1088/1464-4258/5/4/307. URL https://doi.org/10.1088%2F1464-4258%2F5%2F4%2F307
[34] G. Granet, Reformulation of the lamellar grating problem through the concept of adaptive spatial resolution, J. Opt. Soc. Am. A 16 (10) (1999) 2510­2516. doi:10.1364/JOSAA.16. 002510. URL http://josaa.osa.org/abstract.cfm?URI=josaa-16-10-2510
[35] H. Kim, G.-W. Park, C.-S. Kim, Investigation of the convergence behavior with fluctuation features in the fourier modalanalysis of a metallic grating, J. Opt. Soc. Korea 16 (3) (2012) 196­202. URL http://www.osapublishing.org/josk/abstract.cfm?URI=josk-16-3-196
[36] E. Silvestre, T. Pinheiro-Ortega, P. Andr´es, J. J. Miret, A. Ortigosa-Blanch, Analytical evaluation of chromatic dispersion in photonic crystal fibers, Opt. Lett. 30 (5) (2005) 453­ 455. doi:10.1364/OL.30.000453. URL http://ol.osa.org/abstract.cfm?URI=ol-30-5-453
[37] J. M. Lopez-Dona, J. G. Wanguemert-Perez, I. Molina-Fernandez, Fast-fourier-based threedimensional full-vectorial beam propagation method, IEEE Photonics Technology Letters 17 (11) (2005) 2319­2321. doi:10.1109/LPT.2005.857618.
[38] A. Ortega-Monux, J. G. Wanguemert-Perez, I. Molina-Fernandez, E. Silvestre, P. Andres, Enhanced accuracy in fast-fourier-based methods for full-vector modal analysis of dielectric waveguides, IEEE Photonics Technology Letters 18 (10) (2006) 1128­1130. doi:10.1109/ LPT.2006.873960.
[39] A. Ortega-Monux, J. G. Wanguemert-Perez, I. Molina-Fernandez, Accurate analysis of photonic crystal fibers by means of the fast-fourier-based mode solver, IEEE Photonics Technology Letters 19 (6) (2007) 414­416. doi:10.1109/LPT.2007.891971.
[40] L. Li, Justification of matrix truncation in the modal methods of diffraction gratings, Journal of Optics A: Pure and Applied Optics 1 (4) (1999) 531­536. doi:10.1088/1464-4258/1/ 4/320. URL https://doi.org/10.1088%2F1464-4258%2F1%2F4%2F320
[41] M. Walz, T. Zebrowski, J. Ku¨chenmeister, K. Busch, B-spline modal method: A polynomial approach compared to the fourier modal method, Opt. Express 21 (12) (2013) 14683­14697. doi:10.1364/OE.21.014683. URL http://www.opticsexpress.org/abstract.cfm?URI=oe-21-12-14683
32

[42] R. H. Morf, Exponentially convergent and numerically efficient solution of maxwell's equations for lamellar gratings, J. Opt. Soc. Am. A 12 (5) (1995) 1043­1056. doi:10.1364/ JOSAA.12.001043. URL http://josaa.osa.org/abstract.cfm?URI=josaa-12-5-1043
[43] P. Bouchon, F. Pardo, R. Ha¨idar, J.-L. Pelouard, Fast modal method for subwavelength gratings based on b-spline formulation, J. Opt. Soc. Am. A 27 (4) (2010) 696­702. doi: 10.1364/JOSAA.27.000696. URL http://josaa.osa.org/abstract.cfm?URI=josaa-27-4-696
[44] G. Granet, Efficient implementation of b-spline modal method for lamellar gratings, J. Opt. Soc. Am. A 31 (2) (2014) 332­337. doi:10.1364/JOSAA.31.000332. URL http://josaa.osa.org/abstract.cfm?URI=josaa-31-2-332
[45] K. Edee, Modal method based on subsectional gegenbauer polynomial expansion for lamellar gratings, J. Opt. Soc. Am. A 28 (10) (2011) 2006­2013. doi:10.1364/JOSAA.28.002006. URL http://josaa.osa.org/abstract.cfm?URI=josaa-28-10-2006
[46] K. Edee, J. P. Plumey, Numerical scheme for the modal method based on subsectional gegenbauer polynomial expansion: application to biperiodic binary grating, J. Opt. Soc. Am. A 32 (3) (2015) 402­410. doi:10.1364/JOSAA.32.000402. URL http://josaa.osa.org/abstract.cfm?URI=josaa-32-3-402
[47] Y. Chiou, W. Yeh, N. Shih, Analysis of highly conducting lamellar gratings with multidomain pseudospectral method, Journal of Lightwave Technology 27 (22) (2009) 5151­5159. doi:10.1109/JLT.2009.2027343.
[48] D. Song, L. Yuan, Y. Y. Lu, Fourier-matching pseudospectral modal method for diffraction gratings, J. Opt. Soc. Am. A 28 (4) (2011) 613­620. doi:10.1364/JOSAA.28.000613. URL http://josaa.osa.org/abstract.cfm?URI=josaa-28-4-613
[49] T. Weiss, N. A. Gippius, S. G. Tikhodeev, G. Granet, H. Giessen, Efficient calculation of the optical properties of stacked metamaterials with a fourier modal method, Journal of Optics A: Pure and Applied Optics 11 (11) (2009) 114019. doi:10.1088/1464-4258/11/ 11/114019. URL https://doi.org/10.1088%2F1464-4258%2F11%2F11%2F114019
[50] A. Jerri, The Gibbs Phenomenon in Fourier Analysis, Splines and Wavelet Approximations, Mathematics and Its Applications, Springer US, 1998. URL https://books.google.com/books?id=y2c00LAMnFUC
[51] W. Cai, D. Gottlieb, C.-W. Shu, On one-sided filters for spectral fourier approximations of discontinuous functions, SIAM Journal on Numerical Analysis 29 (4) (1992) 905­916. doi:10.1137/0729055.
[52] H. Vandeven, Family of spectral filters for discontinuous problems, Journal of Scientific Computing 6 (1991) 159­192.
[53] D. Gottlieb, E. Tadmor, Recovering pointwise values of discontinuous data within spectral accuracy, 1985.
[54] E. Tadmor, J. Tanner, Adaptive mollifiers for high resolution recovery of piecewise smooth data from its spectral information, Found. Comput. Math. 2 (2) (2002) 155­189. doi: 10.1007/s102080010019. URL https://doi.org/10.1007/s102080010019
33

[55] J. Tanner, Optimal filter and mollifier for piecewise smooth spectral data, Math. Comput. 75 (2006) 767­790. doi:10.1090/S0025-5718-06-01822-9.
[56] K. Eckhoff, Accurate and efficient reconstruction of discontinuous functions from truncated series expansions, Mathematics of Computation - Math. Comput. 61 (1993) 745­763. doi: 10.1090/S0025-5718-1993-1195430-1.
[57] K. S. Eckhoff, Accurate reconstructions of functions of finite regularity from truncated fourier series expansions, Math. Comput. 64 (210) (1995) 671­690. doi:10.2307/2153445.
[58] K. S. Eckhoff, On a high order numerical method for functions with singularities, Math. Comput. 67 (1998) 1063­1087.
[59] B. Adcock, Convergence acceleration of modified fourier series in one or more dimensions, Math. Comput. 80 (2011) 225­261. doi:10.1090/S0025-5718-2010-02393-2.
[60] T. A. Driscoll, B. Fornberg, A pad´e-based algorithm for overcoming the gibbs phenomenon, Numerical Algorithms 26 (1) (2001) 77­92. doi:10.1023/a:1016648530648.
[61] D. Gottlieb, C.-W. Shu, A. Solomonoff, H. Vandeven, On the gibbs phenomenon i: recovering exponential accuracy from the fourier partial sum of a nonperiodic analytic function, Journal of Computational and Applied Mathematics 43 (1) (1992) 81 ­ 98. doi:https://doi.org/ 10.1016/0377-0427(92)90260-5. URL http://www.sciencedirect.com/science/article/pii/0377042792902605
[62] D. Gottlieb, C.-W. Shu, Resolution properties of the fourier method for discontinuous waves, Computer Methods in Applied Mechanics and Engineering 116 (1) (1994) 27 ­ 37. doi: https://doi.org/10.1016/S0045-7825(94)80005-7. URL http://www.sciencedirect.com/science/article/pii/S0045782594800057
[63] D. Gottlieb, C. wang Shu, On the gibbs phenomenon iv: Recovering exponential accuracy in a subinterval from a gegenbauer partial sum of a piecewise analytic function, Math. Computat (1995) 1081­1095.
[64] D. Gottlieb, C.-W. Shu, On the gibbs phenomenon and its resolution, SIAM Rev. 39 (4) (1997) 644­668. doi:10.1137/S0036144596301390. URL https://doi.org/10.1137/S0036144596301390
[65] A. Gelb, D. Gottlieb, The resolution of the gibbs phenomenon for "spliced" functions in one and two dimensions, Computers and Mathematics with Applications 33 (11) (1997) 35 ­ 58. doi:https://doi.org/10.1016/S0898-1221(97)00086-2. URL http://www.sciencedirect.com/science/article/pii/S0898122197000862
[66] A. Gelb, J. Tanner, Robust reprojection methods for the resolution of the gibbs phenomenon, Applied and Computational Harmonic Analysis 20 (1) (2006) 3 ­ 25, computational Harmonic Analysis - Part 2. doi:https://doi.org/10.1016/j.acha.2004.12.007. URL http://www.sciencedirect.com/science/article/pii/S1063520305000588
[67] B. D. Shizgal, J.-H. Jung, Towards the resolution of the gibbs phenomena, Journal of Computational and Applied Mathematics 161 (1) (2003) 41 ­ 65. doi:https://doi.org/10. 1016/S0377-0427(03)00500-4. URL http://www.sciencedirect.com/science/article/pii/S0377042703005004
34

[68] R. Pasquetti, On inverse methods for the resolution of the gibbs phenomenon, Journal of Computational and Applied Mathematics 170 (2) (2004) 303 ­ 315. doi:https://doi.org/ 10.1016/j.cam.2004.01.026. URL http://www.sciencedirect.com/science/article/pii/S037704270400072X
[69] J.-H. Jung, B. D. Shizgal, Generalization of the inverse polynomial reconstruction method in the resolution of the gibbs phenomenon, Journal of Computational and Applied Mathematics 172 (1) (2004) 131 ­ 151. doi:https://doi.org/10.1016/j.cam.2004.02.003. URL http://www.sciencedirect.com/science/article/pii/S0377042704001128
[70] T. Hrycak, K. Gr¨ochenig, Pseudospectral fourier reconstruction with the modified inverse polynomial reconstruction method, Journal of Computational Physics 229 (3) (2010) 933 ­ 946. doi:https://doi.org/10.1016/j.jcp.2009.10.026. URL http://www.sciencedirect.com/science/article/pii/S0021999109005786
[71] B. Adcock, A. C. Hansen, Stable reconstructions in hilbert spaces and the resolution of the gibbs phenomenon, Applied and Computational Harmonic Analysis 32 (3) (2012) 357 ­ 388. doi:https://doi.org/10.1016/j.acha.2011.07.004. URL http://www.sciencedirect.com/science/article/pii/S1063520311000820
[72] B. Adcock, A. Hansen, Generalized sampling and the stable and accurate reconstruction of piecewise analytic functions from their fourier coefficients, Mathematics of Computation 84. doi:10.1090/S0025-5718-2014-02860-3.
[73] D. Huybrechs, On the fourier extension of nonperiodic functions, SIAM Journal on Numerical Analysis 47 (6) (2010) 4326­4355. doi:10.1137/090752456.
[74] B. Adcock, D. Huybrechs, J. Martin-Vaquero, On the numerical stability of fourier extensions, Foundations of Computational Mathematics 14. doi:10.1007/s10208-013-9158-8.
[75] B. Adcock, D. Huybrechs, On the resolution power of fourier extensions for oscillatory functions, Journal of Computational and Applied Mathematics 260 (2014) 312 ­ 336. doi: https://doi.org/10.1016/j.cam.2013.09.069. URL http://www.sciencedirect.com/science/article/pii/S0377042713005244
[76] B. Adcock, J. Ruan, Parameter selection and numerical approximation properties of fourier extensions from fixed data, Journal of Computational Physics 273. doi:10.1016/j.jcp. 2014.05.036.
[77] M.-S. Min, T.-W. Lee, P. F. Fischer, S. K. Gray, Fourier spectral simulations and gegenbauer reconstructions for electromagnetic waves in the presence of a metal nanoparticle, Journal of Computational Physics 213 (2) (2006) 730 ­ 747. doi:https://doi.org/10.1016/j. jcp.2005.06.025. URL http://www.sciencedirect.com/science/article/pii/S0021999105004146
[78] J. G. Wangu¨emert-P´erez, R. Godoy-Rubio, A. O.-M. nux, I. Molina-Fern´andez, Removal of the gibbs phenomenon and its application to fast-fourier-transform-based mode solvers, J. Opt. Soc. Am. A 24 (12) (2007) 3772­3780. doi:10.1364/JOSAA.24.003772. URL http://josaa.osa.org/abstract.cfm?URI=josaa-24-12-3772
[79] J. Piotrowska, J. M. Miller, E. Schnetter, Spectral methods in the presence of discontinuities, Journal of Computational Physics 390 (2019) 527 ­ 547. doi:https://doi.org/10.1016/ j.jcp.2019.03.048. URL http://www.sciencedirect.com/science/article/pii/S0021999119302311
35

[80] L. Carleson, On convergence and growth of partial sums of Fourier series, Acta Mathematica 116 (none) (1966) 135 ­ 157. doi:10.1007/BF02392815. URL https://doi.org/10.1007/BF02392815
[81] L. Li, Mathematical Reflections on the Fourier Modal Method in Grating Theory, 2001, Ch. 4, pp. 111­139. arXiv:https://epubs.siam.org/doi/pdf/10.1137/1. 9780898717594.ch4, doi:10.1137/1.9780898717594.ch4. URL https://epubs.siam.org/doi/abs/10.1137/1.9780898717594.ch4
[82] R. M. Gray, Toeplitz and circulant matrices: A review, Foundations and Trends in Communications and Information Theory 2 (3) (2006) 155­239. doi:10.1561/0100000006. URL http://dx.doi.org/10.1561/0100000006
[83] A. Gelb, E. Tadmor, Detection of edges in spectral data, Applied and Computational Harmonic Analysis 7 (1) (1999) 101 ­ 135. doi:https://doi.org/10.1006/acha.1999.0262. URL http://www.sciencedirect.com/science/article/pii/S1063520399902622
[84] E. Tadmor, Filters, mollifiers and the computation of the gibbs phenomenon, Acta Numerica 16 (2007) 305­378. doi:10.1017/S0962492906320016.
[85] A. Gelb, Parameter optimization and reduction of round off error for the gegenbauer reconstruction method, J. Sci. Comput. 20 (3) (2004) 433­459. doi:10.1023/B:JOMP. 0000025933.39334.17. URL https://doi.org/10.1023/B:JOMP.0000025933.39334.17
[86] J. P. Boyd, Trouble with gegenbauer reconstruction for defeating gibbs' phenomenon: Runge phenomenon in the diagonal limit of gegenbauer polynomial approximations, Journal of Computational Physics 204 (1) (2005) 253­264. doi:https://doi.org/10.1016/j.jcp. 2004.10.008. URL https://www.sciencedirect.com/science/article/pii/S0021999104004152
[87] B. Adcock, A. C. Hansen, A. Shadrin, A stability barrier for reconstructions from fourier samples, SIAM Journal on Numerical Analysis 52 (1) (2014) 125­139. doi:10.1137/ 130908221.
[88] E. De Micheli, G. Viano, The expansion in gegenbauer polynomials: A simple method for the fast computation of the gegenbauer coefficients, Journal of Computational Physics 239 (2013) 112­122. doi:10.1016/j.jcp.2013.01.008.
[89] E. Faghihifar, M. Akbari, S. A. H. Nekuee, Fast estimation of propagation constants in crossed gratings, Journal of Optics 22 (2) (2020) 025001. doi:https://doi.org/10.1088/ 2040-8986/ab6042.
[90] L. Landau, Bessel functions: Monotonicity and bounds, Electronic Journal of Differential Equations 61. doi:10.1112/S0024610799008352.
[91] F. W. Olver, D. W. Lozier, R. F. Boisvert, C. W. Clark, NIST Handbook of Mathematical Functions, 1st Edition, Cambridge University Press, USA, 2010.
36

