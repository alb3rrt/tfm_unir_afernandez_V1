arXiv:2106.01853v1 [cs.CC] 3 Jun 2021

On the Computation of the Algebraic Closure of Finitely Generated Groups of Matrices
Klara Nosan1, Amaury Pouly2, Mahsa Shirmohammadi2, and James Worrell3
1Institut Polytechnique de Paris, France 2Universit´e de Paris, CNRS, IRIF, F-75013 Paris, France 3Department of Computer Science, University of Oxford, UK
Abstract We investigate the complexity of computing the Zariski closure of a finitely generated group of matrices. The Zariski closure was previously shown to be computable by Derksen, Jeandel and Koiran, but the termination argument for their algorithm appears not to yield any complexity bound. In this paper we follow a different approach and obtain a bound on the degree of the polynomials that define the closure. Our bound shows that the closure can be computed in elementary time. We describe several applications of this result, e.g., concerning quantum automata and quantum universal gates. We also obtain an upper bound on the length of a strictly increasing chain of linear algebraic groups, all of which are generated over a fixed number field.
1 Introduction
Groups of matrices are fundamental mathematical objects that appear in a wide variety of areas in computer science, including algebraic complexity theory, quantum computation, dynamical systems, graph theory, control theory, and program verification. For example, a quantum finite automaton is specified by a finite collection of unitary matrices of the same dimension, and computing the group generated by these matrices (more precisely the Zariski closure of this group) turns out to be key to solving a natural formulation of the language emptiness problem for quantum automata [BJKP05]. The latter problem asks to decide whether some word is accepted by the automaton with probability strictly greater than a given threshold. In general, however, matrix groups are challenging from the algorithmic point of view, with many natural problems being undecidable. For example, the non-strict version of the above language emptiness problem for quantum automata (is some word accepted with probability at least a given threshold) is undecidable. Similarly, all versions of the language emptiness problem are undecidable for probabilistic automata, i.e., finite automata in which for each input letter the transition matrix is stochastic [Paz71, BC01]. More fundamentally the problem of deciding whether a given matrix lies in a finitely generated matrix group is undecidable for the group SL(4, Z) of 4 × 4 integer matrices with determinant one [Mik66].
The decidability of the strict emptiness problem for quantum finite automata is underpinned by two nontrivial facts. First, the Euclidean closure of a group of unitary matrices is algebraic (therefore the Euclidean closure equals the Zariski closure). Second, there is an algorithm to compute the Zariski closure of a finitely generated group of matrices [DJK05]. As noted in [BJKP05], quantum automata are not the only application of the latter result. The question of whether a given finite set of quantum gates is universal can be reduced to computing the Zariski closure of the associated group of unitary matrices. This is then decidable by noting again that the (Euclidean) density of group generated by those matrices can be tested by computing its Zariski closure and standard manipulations of algebraic varieties.
1

In a recent paper, some of the authors extended the result of [DJK05] to compute the Zariski closure of finitely generated semigroups [HOPW18]. They then use the Zariski closure to compute the strongest algebraic invariant of affine programs. Invariants are a fundamental technique in program verification that allow one to compute an overapproximation of the set of reachable states (which is itself not-computable in general) and thereby verify whether a program meets a certain specification, such as loop termination. In the particular setting of semigroups, one observes that the Euclidean closure of a semigroup is generally strictly smaller than the Zariski closure, but the latter remains computable and useful.

Algebraic sets and groups. Recall that an algebraic set (or algebraic variety) is the locus

of

zeros

of

a

(finite)

collection

of

polynomials.

The

Zariski

topology

on

n
Q

is

defined

by

taking

all the algebraic sets as the closed sets, therefore the Zariski closure of a set is the smallest

algebraic set that contains it.

By

identifying

n

×

n

matrices

with

n2
Q

,

one

can

extend

the

Zariski topology to the set of all matrices. It is then not hard to see that the Zariski closure

of a group of matrices remains a group for matrix multiplication and hence is an algebraic

group. More generally, an algebraic group is a group that is an algebraic variety such that the

multiplication and inversion maps are regular functions, i.e., restrictions of polynomials maps.

The study of algebraic groups has deep connections with commutative algebra and Lie algebra,

making it a vast and rich topic. In this work, we leverage this extensive literature to obtain our

main technical result which is a quantitative structure theorem for algebraic groups that are

the closure of finitely many matrices.

Our results. In this paper, we show that the Zariski closure of a finitely generated group of matrices is computable in elementary time. More precisely, we obtain a septuply exponential bound in the dimension and the size of the coefficients of the generators. Our approach is to obtain a bound on the degree of the smallest Zariski-closed set containing the closure. We then use the fact that there is an algorithm [MS04] to compute the strongest invariant of an affine program up to a specified degree to conclude. We also obtain a quintuply exponential bound in the special case where the group consists of unitary (or more generally orthogonal) transformations, which is always the case in quantum computing. Our main technical result is a quantitative structure theorem for algebraic groups, which may be of independent interest.
Theorem 1 (Main result, see also Theorem 13). Let n  N and let S  GLn(Q) be a finite set of matrices whose entries have height at most h  N. Then there is an algorithm that computes the Zariski closure of the group generated by S in time h2(|S|,n) where (|S|, n) = |S|2222poly(n) . The closure is represented by a finite list of polynomials that form a basis of the ideal of S .
We also obtain an upper bound on the length of a strictly increasing chain of linear algebraic groups, all of which are generated over a fixed number field; see Theorem 15. This bound gives a quantitative version of the Noetherian property of subgroups of linear algebraic groups. In case when all group are generated by unitary matrices, the obtained length bound is singly exponential in the dimension of the matrices and degree of the number field over Q.

Related work on algebraic groups. The problem of computing the Zariski closure of a finitely generated group of matrices was shown to be decidable in 2003 [DJK05]. The algorithm works by identifying a normal subgroup N of the closure G that is irreducible and such that G/N is torsion. It then uses the fact that G/N can be seen as a linear group and therefore must be finite by a theorem of Schur for GLn(Q) and by Kaplansky [Kap72, Theorem G, p. 105] for GLn(k) where k is an arbitrary field. Unfortunately, it is not clear how to analyze the complexity of their algorithm, or even whether it has elementary complexity (see the discussion on the complexity, below). As noted in [DJK05], much of the work in computation in this

2

algorithm can be done at the level of the Lie algebra of G. This approach was later described by de Graaf [de 17], who showed how to obtain the defining polynomials of the identity component from the Lie algebra [de 09]. As far as we know, the complexity of this algorithm has not been studied. Our approach has more in common with Hrushovski [Hru02], who showed how to compute the Galois group of a linear differential equation. The approach used in [Hru02] essentially shows that a certain algebraic group, called the proto-Galois group, is computable from the description of the linear differential equation and can be used to recover the Galois group. Although Hrushovski's algorithm does not directly imply an algorithm to compute the Zariski closure of a finitely generated matrix group, our proof relies on a key insight about the structure of linear algebraic groups from [Hru02], namely the existence of a finite-index subgroup of computable degree that lies inside a given linear algebraic group.
Hrushovski's algorithm was later simplified by Feng, who analyzed its complexity and obtained a sextuply exponential bound in the order of the differential equation for the degree of the proto-Galois group [Fen15]. A much improved, triple exponential bound, was given by Sun [Sun19] following the same approach but using a triangular representation for algebraic sets. A different approach was recently pursued by Amzallag, Minchenko and Pogudin, who introduced the notion of toric envelope to obtain a single exponential bound for the first step of the Hrushovski's algorithm due to Feng which is qualitatively optimal [AMP19, Amz18].

Related work in verification. The problem of computing the Zariski closure of a semigroup

of matrices arises naturally when trying to compute the strongest polynomial invariant of so-

called affine programs [HOPW18]. In fact, any algorithm computing the strongest polynomial

invariant can be used to compute the Zariski closure of a finitely generated semigroup of ma-

trices. It was shown in 1976 that the strongest affine invariant (or smallest linear variety, in

the language of algebraic geometry) is computable [Kar76]. A more efficient reformulation was

given by Mu¨ller-Olm and Seidl [MS04]. A randomized algorithm for discovering affine relations

was proposed by Gulwani and Necula [GN03]. The problem of computing polynomial invariants

has been studied extensively and was finally answered positively in [HOPW18]. As noted by

Mu¨ller-Olm and Seidl, if we know an a priori bound d on the degree of the equations of the

strongest invariant, we can easily reduce the problem of computing the strongest polynomial

invariant in dimension n to that of computing the strongest affine invariant in dimension

n+d d

,

and apply Karr's algorithm. Therefore, it is sufficient to obtain a bound on the degree of the

equations to obtain an algorithm, which is the approach we pursue for the case of matrix groups.

A note on the complexity. Consider the closure G of a matrix group that is generated by a finite set of matrices with entries in a number field. We wish to obtain a bound d on the degree of the equations defining G as an algebraic set. It is clear that such a bound must depend on the degree of the number field, not just the dimension of the matrices and the number of generators. Indeed, if  is a primitive p-th root of unity, then the multiplicative subgroup of C generated by  is a finite group for which any defining equation must be divisible by the p-th cyclotomic polynomial and therefore have degree at least (p), where  is the Euler totient function (which is unbounded). In this paper, we focus on the case where k = Q which also captures any number field by the usual embedding of a number field into rational matrices. Having fixed the field k = Q, we now observe that any degree bound must also involve the height of the coefficients. Let p be a prime integer and consider the group generated by g = diag(2p, 1/2). It can be shown (Proposition 12) that in this case, the equations defining the closure are exactly the multiplicative relations between the eigenvalues. This particular matrix g has a single minimal relation, namely (2p)1(1/2)p = 1 and therefore its closure is defined by {diag(x, y) : xyp = 1} of total degree 1 + p which is the smallest possible. Since the value of p is arbitrary and the height of the coefficients in g is 2p, we see that the degree of the equation depends on the height of the coefficients of the generators.

3

G

GH

U

Lemma 10

H GLn(Q)

H

U GH G

[G : G  H] J (n)

(G  H)/U is commutative

Figure 1: Graphical representation of Lemma 10: given a group G  GLn(Q) that generated over Q, we identify a group H with good properties. Note that H is not a subgroup of G and U is the closure of the subgroup generated by the unipotent elements of G.
The dependence of the degree on the height of the generators is problematic because it introduces an arithmetic element that is difficult to control. For instance, consider the following situation, that arises repeatedly in the algorithms of [DJK05, de 17]. Assume G is the closure of a group generated by g1, . . . , gk and identify a normal subgroup N of G such that N is defined by polynomials of a given degree. Recall that the quotient map  is such that (G) = G/N , and (G) is naturally generated by g1 := (g1), . . . , gk := (gk). Unfortunately, the degree of the closure of the gi depends on the height of those elements, that is, it is a function of the height of the gi and the coefficients of . Determining the latter bound, in turn, requires a delicate analysis of the construction of , as well as a bound on the height of the coefficients of the equations defining N . In summary, the uncontrolled introduction of the arithmetic of the coefficients risks complicating the proof with arithmetic statements which have to be controlled in every part of the construction. For this reason it would seem difficult to directly bound the complexity of the algorithms of Derksen, Koiran and Jeandel [DJK05] and de Graaf [de 17]. In fact it is not clear to us that a direct analysis of these algorithms yields elementary upper complexity bounds. In contrast, our proof avoids this difficulty by identifying a finite-index subgroup by which the quotient is commutative. This allows us to work with the part that depends on the height of the coefficients before taking any quotient. The remainder of the proof is made coefficient-independent and hence purely geometric.
2 High-level overview
In this section, we give a high-level account of the proof of Theorem 1. Consider a group G = S  GLn(Q) that is generated by a finite set S of rational matrices. Our aim is to compute a degree bound for G in terms of the dimension n and the number and height of the generators. We can divide our approach into two parts. The first step, summarised in Figure 1, is to identify a subgroup H  GLn(Q) such that GH is a normal subgroup of G of finite index, depending only on n, and G  H is commutative modulo the closed group U  G generated by the unipotent elements of G. We first construct H under the assumption that G consists solely of semisimple elements and then show how to handle the general case. The second step is to construct from S a set of rational matrices that generate G  H as a closed group. A bound on the degree of G can then be computed, based on the height and number of generators of G  H and the degree of U . Crucially, the degree of U can be bounded solely in terms of the dimension n. Below we explain these steps in more detail.
We repeatedly use a standard result (see Theorem 4) that given a linear algebraic group G GLn(Q), and a normal subgroup H of G that is defined using equations of degree bounded by d  N, the quotient G/H can be embedded in GLp(Q), where the dimension p is bounded by a function of n and d. Below, we say that a variety has degree d  N if it arises as the zero
4

H

G

GH

G0

Lemma 8 H GLp(Q) G0 G  H G [G : G  H] J(p)
H is commutative H is 1-bounded

Figure 2: Graphical representation of Lemma 8: given a group G  GLp(Q) that is generated over Q and is comprised of semisimple elements, we identify a group H with good properties as the intersection of maximal tori containing G0. Note that H is not a subgroup of G.
set of a collection of polynomials of total degree at most d.
Overview of the semisimple case (Lemma 8): Let G = S GLp(Q) be an algebraic group generated by a finite set S of rational matrices. Assume that G consists exclusively of semisimple elements. Since the identity component G0 of G is connected and semisimple, it is a torus. Recall that G0 is a normal subgroup of G, and G/G0 is finite. However we do not know how to directly bound the degree of G0 nor the cardinality of G/G0 in terms of the set S of generators and dimension p. Instead, following [Hru02], we identify another group H GLp(Q) that has degree 1, and is such that G0 G  H G. Specifically, H is defined as the intersection of all maximal tori that contain G0. This construction is illustrated in Figure 2, where the maximal tori containing G0 are depicted as green ellipses. Since maximal tori are 1-bounded and commutative, H is also 1-bounded and commutative. Observe that the quotient G/(G  H) is finite because G  H includes G0. In fact, we can compute a bound on [G : G  H] in terms of p as follows. For this we use the fact that G/(G  H) can be embedded as a finite subgroup GLm(Q) for some m depending only on p, via a regular map that is defined over Q. Since the set of rational points is dense in G, this embedding takes G  H to a finite subgroup of GLm(Q). But it is known that such a group has order at most (2m)!, it follows that [G : G  H]  (2m)!.
Overview of the general case (Lemma 10): Let G = S GLn(Q) be an algebraic group generated by a finite set S of rational matrices. Let U  G be the subgroup generated by the unipotent elements, which can easily be seen to be normal in G. The crucial fact, again following [Hru02], is that one can write equations for U whose degree depends only on the dimension n (and is independent of G). This follows from the fact that U is an irreducible variety, and that the closure of a group generated by a single unipotent element is a 1-dimensional variety of a very specific form; see Lemma 9. Furthermore we have that G/U consists soley of semisimple elements and (using Theorem 4) can be embedded as a subgroup of GLp(Q), where p only depends on n. The embedding is a regular map U as shown in Figure 3. We show that U is defined over Q and hence the image of G/U in GLp(Q) is generated as a closed group by
5

GLn(Q)

GLp(Q)

semisimple

G

U

G/U

H

GLm(Q) finite
H (G/U )

Lemma 10 -U 1
H

H

Lemma 8 finite

index

property

Figure 3: Putting all elements together: in Lemma 10 and Lemma 8, we take two consecutive quotients to obtain a finite group. We then pull-back to obtain a group H with good properties. Note that the dimensions increases after each quotient and the lemmas relate p and m to n. Here H is the quotient map by H from Theorem 4. Note how the reduction proceeds from an arbitrary group, to a group comprised of semisimple elements and finally to a finite group. Here H is the "H" from Figure 2.

a finite set of rational matrices (namely U (S)). We now apply Lemma 9 to the group G/U to obtain a subgroup H of GLp(Q) with the properties described in the preceding paragraph. Finally, we define H  GLn(Q) to be the preimage of H under U ; see Figure 1. Then H has the desired properties for the first step of our proof, namely G  H is a normal subgroup of G of finite index depending only on n, and (G  H)/U is commutative.
Putting things together (Theorem 13): Let G = S GLn(Q) be an algebraic group generated by a finite set S of rational matrices. Let U  G be the normal subgroup generated by the unipotent elements of G. Applying Lemma 10, we obtain a group H GLn(Q) such that G  H has finite index J (n) in G. Moreover, as described above, U G  H and the quotient (G  H)/U is commutative. To put everything together, we exploit these two properties to obtain a degree bound of G as follows:
1. Finding a set of generators for G  H using the finite-index property: We use Schreier's Lemma to find a set of generators for G  H as a closed group (See Lemma 11). The obtained set S of generators consist of all products of elements of S (and their inverses) up to length 2J (n) + 1 that lie in H.
2. A degree bound for GH using the commutativity property: Since GH = S , and the quotient (G  H)/U is commutative, we have that
GH =U · g .
gS
In other words, we only need to compute the closure of individual elements g for g  S . The latter can be done by using Masser's bound (Theorem 6) on the group of multiplicative relations among the eigenvalues of a rational matrix. This bound depends on the height of the coefficients of g  S . The latter is bounded by a function of the height of the coefficients of matrices in S, because each g  S is the product of at most 2J (n) + 1 elements of S.
Finally, by writing G as the union of J (n) cosets of G  H, we can obtain a degree bound on G from the degree bound on G  H.

6

3 Preliminaries

Recall that a number is algebraic if it is the root of a non-zero polynomial in Q[x]. Denote

by Q the field of algebraic numbers. For   Q, the defining polynomial of  is the primitive

polynomial in Z[x] of minimal degree having  as a root. The height of  is the maximum

absolute value of the coefficients of its defining polynomial. Note that the height of a rational

number

a b

,

with

a, b

coprime

integers,

is

max(|a|, |b|).

3.1 Linear algebra
Let k be a perfect field with algebraic closure K. Recall that the general linear group GLn(k) over k is the group of all invertible n × n matrices with entries in k.
A matrix M  GLn(k) is called nilpotent if there exists some positive integer m such that M m = 0; and it is unipotent if the matrix M - I is nilpotent. A matrix M  GLn(k) is said to be semisimple if it is diagonalizable over K. Given a matrix M , the Jordan-Chevalley decomposition writes it as M = Ms + Mn, where Ms is semisimple, Mn is nilpotent, and Ms and Mn commute. It follows that M = MsMu, where Mu = I + Ms-1Mn is unipotent, and Ms and Mu commute. This decomposition is unique.

3.2 Algebraic Geometry
Throughout this section let K be an algebraically closed field. Denote by K[x1, . . . , xn] the ring of polynomials in variables x1, . . . , xn with coefficients in K. We sometimes write this ring as K[x], where x = (x1, . . . , xn) is a tuple of variables. Given n  1, denote by Kn the affine space of dimension n over K. Given a set of polynomials S  K[x1, . . . , xn], let
Z(S) = {(a1, . . . , an)  Kn | f  S (f (a1, . . . , an) = 0)}
denote the set of common zeros of the polynomials in S. An affine algebraic set X  Kn is a set of the form X = Z(S) for some S  K[x1, . . . , xn]. By Hilbert's basis theorem, every algebraic set Z(S) arises as the set of common zeros Z(S ) of some finite sub-collection S of S. The Zariski topology on Kn has the algebraic sets as closed sets. An algebraic set X  Kn is said to be irreducible if it cannot be written as the union X = X1  X2 of two proper subsets X1 and X2 that are both algebraic. Given an algebraic set X, a maximal irreducible subset of X is called an irreducible component. Every algebraic set can be written as the finite union of its irreducible components.
Given algebraic sets X  Kn and Y  Km, a regular map from X to Y is a function  : X  Y such that there exist polynomials f1, . . . , fm  K[x1, . . . , xn] with (a) = (f1(a), . . . , fm(a)) for all a  X. Regular maps are continuous when X and Y are considered as subspaces of Kn. The closure of the image of an irreducible set under a regular map is again irreducible.
Given X  Kn, I(X) denotes the ideal of polynomials in K[x1, . . . , xn] that vanish on X. For an algebraic set X  Kn, we say that X is d-bounded, for some d  N, if X = Z(S) for some collection of polynomials S  K[x1, . . . , xn] all having degree at most d. Recall that k is a subfield of K. Then we say that X is defined over k if X = Z(S) for some collection of polynomials S  k[x1, . . . , xn], that is, X is the zero set of a collection of polynomials with coefficients in k. Finally, we say that X is d-bounded over k if X = Z(S) for some collection of polynomials S  k[x1, . . . , xn] all having degree at most d. In fact, we have that if X is both d-bounded and defined over k then it is d-bounded over k.
Given a field extension K/k we denote by Aut(K/k) the group of automorphisms of K that fix k; if K is a Galois extension of k, we instead write Gal(K/k).
Lemma 2. Fix n  N. Let X  Kn be an algebraic set that is d-bounded and stable under Aut(K/k) for some subfield k of K. Then X is d-bounded over k.

7

Proof. We may assume without loss of generality X is the zero set of a finite collection of

polynomials S  K[x] of degree at most d. Let F  K be the normal closure of the field

extension of k generated by the coefficients of the polynomials in S. Then F is a finite Galois

extension of k.

Given   F , write Tr() := Gal(F/k) () for the trace of  relative to F/k. We extend Tr coefficient-wise to polynomials p  F [x]. Since F/k is a Galois extension of k,

we have Tr(p)  k[x] for p  F [x]. Let b1, . . . , bm be a basis of F over k and consider the

matrix M = (Tr(bibj))ij such that det(M )2 = 0 is the discriminant of the basis. Given  =

m i=1

ibi



F,

where

1,

.

.

.

,

m



k,

for

all

j



{1,

.

.

.

,

m}

we

have

Tr(bj )

=

m i=1

i

Tr(bi

bj

).

Writing M -1 =

conclude that 

m i,j=1

Tr(pbj

)cij

(cij), it follows that for all i  {1, . . . , m}

=

m i,j=1

Tr(bj

)cij

bi.

We then have that

we for

have i = j cij any polynomial p

Tr(abj ).  F [x],

We p=

bi, that is, p is a F -linear combination of the polynomials Tr(pb1), . . . , Tr(pbm)

in k[x].

Suppose now that p  F [x] is a polynomial that vanishes on X. Since each   Gal(F/k)

extends to a map in Aut(K/k), we have (X) = X for all   Gal(F/k). Thus each polynomial

Tr(pbi), for i = 1, . . . , m, also vanishes on X. We conclude that X is also the zero set of the

collection S := {Tr(bip) : i = 1, . . . , m, p  S}  k[x]. But the polynomials in S all have

degree at most d.

Let X be an algebraic set such that X  kn is dense in X. We claim that X is stable under
every automorphism   Aut(K/k). To see this, let the polynomial p  K[x] be a polynomial that vanishes on X. Then p  K[x], that is defined by applying  point-wise to the coefficient of p, will vanish on (X). But (X) contains (X  kn) = X  kn, which is a dense subset of X. Hence p vanishes on X, equivalently p vanishes on -1(X). We conclude that X is stable under -1. Since  was arbitrary, X is stable under Aut(K/k). It follows from Lemma 2 that an algebraic set X  Kn such that X  kn is dense in X is defined over k.

Proposition 3 (Corollary 8.3 in [Dub90]). Let I  K[x1, . . . , xn] be an ideal generated by polynomials with degree at most d, then for all i  {1, . . . , n} the elimination ideal I  K[x1, . . . , xi] is generated by polynomials with degree at most (d + 1)2n.

3.3 Linear Algebraic Groups
For an algebraically closed field K, we regard GLn(K) as an algebraic set in Kn2+1 by writing
GLn(K) = {(M, y)  Kn2+1 : det(M ) · y = 1}.
Under this identification, matrix multiplication is a regular map GLn(K)×GLn(K)  GLn(K), and, by Cramer's rule, matrix inverse is also a regular map GLn(K)  GLn(K). A linear algebraic group is a Zariski-closed subgroup of GLn(K). Let G be a linear algebraic group such that the set of points in G with coefficients in a subfield k  K is Zariski-dense, then G is defined over k as remarked after Lemma 2. We say that G is generated over k if it is the closure of a set of matrices with coefficients in k.
Given the fact that a linear algebraic group G is also an affine variety, we can write it as a finite union of irreducible components. We denote by G0 the irreducible component of G containing the identity. Then G0 is a normal subgroup of G and the irreducible components of G are the cosets of G0 in G. In particular, G0 has finite index in G. It also holds that G0 is a connected set in the Zariski topology on K.
Let g  GLn(K) where K is a perfect field. Recall that g can be uniquely decomposed as the product g = gsgu, where gs and gu is unipotent. Let G be a linear group, we denote by Gs = {gs : g  G} and Gu = {gu : g  G} the semisimple and unipotent parts of G, respectively. If G is a linear algebraic group, it is a standard fact that Gs and Gu are closed sets and they are contained in G, but note that they are not groups in general.

8

An algebraic torus (henceforth simply a torus) is a connected algebraic group G  GLn(K) such that G consists of semisimple elements, i.e., G = Gs. Equivalently G is a torus if it is a connected diagonalisable subgroup of GLn(K). In particular, G is a maximal torus in GLn(K) if and only if it is conjugate to the group of diagonal matrices in GLn(K). By virtue of this fact, maximal tori are 1-bounded.
We refer the reader to [Hum98][Chapter 15, 16.2 and 19] for more details on above-defined notions and facts.
Theorem 4 (Proposition B.6 in [Fen15]). Let k be a perfect field with algebraic closure K. Let n  N and let G  GLn(Q) be a closed group. Let H be a normal subgroup of G that is bounded over k by some d  N. Then there exists p (n2 +d)2d2, and a homomorphism  : G  GLp(Q) bounded by d(n2 + d)2d2+1 over k such that H = ker .

3.4 Subgroups of GLn(Q)
A finite subgroup of rational matrices is a conjugate to a finite subgroup of integer matrices [KP02]; and the order of any finite subgroup of integer matrices divides (2n)! [New72, GL05, BHK+20]. Combining these two results yield the bound in Theorem 5. Friedland [Fri97] showed that the better bound 2nn! holds for all n 72 but it relies on an incomplete manuscript by [Wei85].

Theorem 5. For all n  N, every finite subgroup of GLn(Q) has order at most (2n)!.
The following theorem concerns multiplicative relations of the form k11 . . . knn = 1 for the algebraic numbers 1, . . . n and integers k1, · · · , kn  N. Such relations form an additive subgroup of Zn; see [Mas88, CLZ00].

Theorem 6 (Masser). Fix any n  1. Let 1, . . . , n be non-zero algebraic numbers having height at most h over Q and let D = [Q(1, . . . , n) : Q]. Then the group of multiplicative relations

L = {(k1, . . . , kn)  Zn | k11 · · · knn = 1}

(1)

is generated (as subgroup of Zn) by a collection of vectors all of whose entries have absolute

value at most

(cn

log(h))n-1Dn-1

(log(D + 2))3n-3 (log log(D + 2))3n-4

,

for some absolute constant c.

Corollary 7. Let M  GLn(Q) have entries of height at most h. Writing 1, . . . , n for the eigenvalues of M , the lattice L of multiplicative relations in Equation (1) is generated by a collection of vectors all of whose entries have absolute value at most f (n, h) := (cn7n! log(h))n for some absolute constant c.
Proof. Let  hn2 be the least common multiple of the denominators of the entries of M . The eigenvalues of M are roots of the polynomial

n

P (x) := det(xI - M ) = sgn() (xI - M )i,(i) .

Sn

i=1

The coefficients of this polynomial are integers of absolute value at most H := 2nhn3n!. Hence
1, . . . , n have height at most H. Applying Theorem 6, since the field Q(1, . . . , n) has degree at most D := n! over Q, the
lattice L of multiplicative relations in Equation (1) is generated by vectors whose entries have absolute value at most (cn7n! log(h))n for some absolute constant c.

9

4 Zariski Closure of Finitely Generated Linear Groups

As explained in Section 2, the base of our structural theorem concerns algebraic groups that consist exclusively of semisimple elements.
Lemma 8. Let n  N. Let G GLn(Q) be generated over Q and consist exclusively of semisimple elements. Then there exists H GLn(Q) such that
1. H is commutative,
2. H is 1-bounded over Q,
3. G  H is a normal subgroup of G of index at most J(n) := (2(n2 + 1)3)!.
Proof. The identity component G0 of G is a connected algebraic group comprised of semisimple elements. Recall that such a group is a torus. Furthermore, since G is defined over Q, it is stable under the action Gal(Q/Q) on Kn2+1. It follows in turn that G0 is stable under the action of Gal(Q/Q), which permutes the irreducible components of G, fixing the component G0 that contains the identity matrix.
Now G0, being a torus, is contained in some maximal torus in GLn(Q). Define H to be the intersection of all maximal tori in GLn(Q) that contain G0.
Since H is an intersection of commutative groups, H is itself commutative. This establishes Item 1.
We now show that H is 1-bounded over Q. Indeed, a subgroup of GLn(Q) is a maximal torus if and only if it is conjugate to the group of all diagonal matrices in GLn(Q). Hence every maximal torus in GLn(Q) is 1-bounded. It follows that H is 1-bounded. We note that H is also stable under Gal(Q/Q) since every automorphism of Q induces a bijective self-map on the collection of maximal tori containing G0. Hence, by Lemma 2, H is 1-bounded over Q. This establishes Item 2.
Let N := {g  GLn(Q) : gH = Hg} be the normalizer of H in GLn(Q); we claim that G normalizes H and hence that G N . To prove the claim, fix g  G. Recall that G0 is a normal subgroup of G. For every maximal torus T containing G0, gT g-1 is also a maximal torus, which moreover contains G0 as gG0g-1 = G0. We thus see that conjugation by g induces a bijective self-map on the collection of maximal tori containing G0. It follows that gHg-1 = H for all g  G, i.e., G normalizes H and hence G  H is a normal subgroup of G.
Since H is defined over Q, by quantifier elimination, N is also defined over Q. By Theorem 4, since H is both 1-bounded over Q and a normal subgroup of N , there is a homomorphism  : N  GLp(Q), for some p  (n2 + 1)3, such that  has kernel H and is defined over Q. Now since G0 H and G/G0 is finite, it must be the case that (G) is finite. Furthermore, since G is generated over Q and  is defined over Q, it holds that (G) is finite and generated over Q.
Thus (G) is a finite subgroup of GLp(Q). By Theorem 5, (G) has order at most (2(n2 + 1)3)!. We now have

[G : G  H] = [HG : H] = [ker()G : ker()] = |(G)|  (2(n2 + 1)3)!

standard equality because ker() = H

which establishes Item 3.

A key ingredient of our proof is the fact, noticed by [Hru02] and analyzed more precisely by [Fen15], that the group generated by the unipotent elements is bounded solely in terms of the dimension. For completeness, we give a short proof of this fact, following that of [Fen15].
10

Lemma 9. Let n  N and G GLn(Q) be defined over Q. Let U = Gu be the closed subgroup generated by the unipotent elements of G. Then U is a normal subgroup of G which is (n3 + 1)2n3 -bounded over Q.
Proof. Observe that the set Gu is closed under conjugation by every g  G. Therefore also Gu is closed under conjugation. By Zariski continuity of conjugation, therefore also the generated group U = Gu is closed under conjugation by every g  G. Finally, since conjugation by a fixed g  G defines a Zariski-continuous map on G, we conclude that gU g-1 = U . Since g  G was arbitrary, U is a normal subgroup of G.
Recall that for any h  Gu, there is a unique nilpotent matrix log(h) such that h = exp(log(h)). We furthermore have that h is the image of the map h : Q  GLn(Q) given by h(z) = exp(z log(h)). Note that h is a polynomial in z of degree at most n by the nilpotency of log(h). It follows that h is irreducible.
Recall also that any strictly increasing chain of irreducible algebraic subsets of GLn(Q) has length at most dim(GLn(Q)) = n2. It follows that there exists  n2 and h1, . . . , h  Gu with
U = h1 · · · h = {h1(z1) · · · h (z ) : z1, . . . , z  Q} .
Thus U is the Zariski closure of the image of Q under a polynomial map of degree at most n3. By Proposition 3, it follows that U is bounded by (n3 + 1)2n3 . Finally, since both G and the collection of unipotent matrices in GLn(Q) are stable under Gal(Q/Q), is follows that U is also stable under Gal(Q/Q). It follows from Lemma 2 that U is bounded by (n3 + 1)2n3 over Q.
We now move on to the second part of the structural analysis described in Section 2, where we analyze an arbitrary algebraic group to identify a group H with good properties.
Lemma 10. Let n  N and G  GLn(Q) be generated over Q. Write U := Gu for the closure of the subgroup generated by the unipotent elements of G. Then there exists a group H such that U  H  GLn(Q) and
1. (G  H)/U is commutative,
2. G  H is a normal subgroup of G of index at most J (n) := (2[(n2 + D)4D2 + 1]3)!, where D = (n3 + 1)2n3 .
Proof. By Lemma 9, U is a normal subgroup of G that is bounded by D := (n3 + 1)2n3 over Q. Let N be the normalizer of U in GLn(Q); then U is a normal subgroup of N that is defined over Q. Since U is defined over Q, by quantifier elimination, N is also defined over Q. By Theorem 4, there is a homomorphism  : N  GLp(Q), where p  (n2 + D)2D2 and  is defined over Q.
Observe that G  N , since G normalizes U . Now we may apply Lemma 8 to (G), which is a closed subgroup of GLp(Q) that is comprised exclusively of semisimple elements. From the lemma we obtain a commutative group H  GLp(Q) such that (G)  H is a normal subgroup of (G) of index at most J(p). Now define H := -1(H )  GLn(Q). Since U = ker(), we have U  H and hence U is a normal subgroup of G  H.
Since  induces an an injective homomorphism between H/U and H , it follows that H/U is commutative. Thus (G  H)/U is commutative, establishing Item 1.
Consider the homomorphism
G --|G (G) - (G)/((G)  H )
obtained by composing the restriction of  to G with the natural quotient map. Since
-1((G)  H ) = -1((G))  -1(H ) = G  H,
11

the above map has kernel G  H. It follows that
[G : G  H] = [(G) : (G)  H ] = J(p)  (2[(n2 + D)4D2 + 1]3)!, where D = (n3 + 1)2n3 .
The following lemma, essentially folklore, establishes that if a group is generated by S and H is a finite-index subgroup, then we can describe a set of generators of H from S and the index of the subgroup. Below, for S  GLn(Q), we write Sk for the set products of lists of elements of S of length at most k.
Lemma 11. Let n  N and G = S for some S  GLn(Q). Let H be a normal subgroup of G with finite index d. Then H = S where S = H  (S  S-1)2d+1.
Proof. Define H := S  H. We claim that H = S . It follows from this that
S = H = S  H = S  H = H,
establishing the lemma. It remains to establish the claim. To this end, observe that for g, h  S we have gh-1  H if and only if gh-1  H, and hence
| S /H |  |G/H| = d .
Then, since H is a subgroup of S of finite index at most d, we can apply Schreier's Lemma [Ser02] to obtain that H is generated by the set
H  {t1 s t-2 1 | s  S and t1, t2  T } , for any set T  S that contains a representative of each right coset of H in S . But clearly we can take T to be Sd and this concludes the proof.
In the next Proposition, we give a degree bound for the Zariski-closure of the group generated with a single semisimple matrix.
Proposition 12. Let n  N and g  GLn(Q) have entries of height at most h. Then gs is bounded by nf (n, h) over Q, where f is as defined as in Corollary 7. Proof. Let gs be written in the form gs = h-1ah, where a = diag(1, . . . , n) is diagonal. Write
L := {(k1, . . . , kn)  Zn : k11 · · · knn = 1} for the group of multiplicative relations among 1, . . . , n. It is known (see, e.g., [DJK05]) that
a = {diag(x1, . . . , xn) : xk11 · · · xknn = 1 for all (k1, . . . , kn)  L} . But by Corollary 7, L is generated as an additive subgroup of Zn by vectors (k1, . . . , kn)  Zn where the ki have absolute value at most f (n, h). It follows that a is bounded over Q by nf (n, h). But then we have that gs = h-1 a h is also bounded by nf (n, h) over Q.
We can now put everything together to obtain a bound on a group that is finitely generated over Q. As remarked in the introduction, the bound depends on the dimension and the coefficients of the generators, which is unavoidable.
12

Theorem 13. Let n  N and let S  GLn(Q) be a finite set of matrices whose entries have height at most h  N. Then the algebraic group G := S is bounded over Q by log(h)2(|S|,n) where (|S|, n) = |S|2222poly(n) . Furthermore, if G contains only semisimple elements then G is
bounded over Q by log(h)2(|S|,n) where (|S|, n) = |S|2poly(n) .

Proof. Let U := Gu be the closed group generated by the collection of unipotent elements in G. As noted before, U is a normal subgroup of G. By Lemma 10, there exists a subgroup H  GLn(Q) that is defined over Q, such that
· (G  H)/U is commutative,

· G  H is a normal subgroup of G of index at most J (n), where J is as in the statement of Lemma 10.

By Lemma 11, G  H is the closure of the group generated by the finite set of matrices S := (S  S-1) 2J (n)+1  H. The matrices in S have height at most h := (hn3+n2n!n)2J (n)+1.
Write S = {g1, . . . , g }  GLn(Q) where  (2|S|)2J (n)+2. Then we have

GH = S U = g1 · · · g U = (g1)s) · · · (g )s U = (g1)s · · · (g )s U

S is dense in G  H (G  H)/U is commutative gU = gsU for all g  G

By Lemma 9, U is bounded over Q by (n3 + 1)2n3 , and by Proposition 12 each group (gi)s is bounded over Q by nf (n, h ) where f is as in the statement of Corollary 7. Let d := max nf (n, h ), (n3 + 1)2n3 . By Proposition 3, G  H is bounded over Q by (d + 1)2( . +1)n2
Finally, we have that G = S J (n) · (G  H) is the union of at most |S|J (n)+1 varieties, each of degree at most (d + 1)2( . +1)n2 Hence G is bounded over Q by (d + 1)2( +1)n2 |S|J . (n)+1 The final bound for G as stated in the statement of the Theorem can now be obtained from the bounds
for d, and J .

We note that, in Theorem 13, the quadruple exponential degree bound applies to groups generated by unitary transformations as appear, e.g., in quantum automata.

5 Chain of Algebraic Groups
In this section, we provide a quantitative version of the Noetherian property of subgroups of GLn(Q), i.e., a concrete bound on the length of a strictly increasing chain of algebraic subgroups. We start with Lemma 14, which is restricted to the case in which each group in the chain exclusively consists of semisimple elements.
Lemma 14. Let n  N and Gi  GLn(Q), 1  i  , be generated over Q and be such that G1 G2 · · · G . If each Gi only consists of semisimple elements, then  n2(2(n2 + 1)2)!.
Proof. For each group Gi, define Hi to be the intersection of all maximal tori that contain (Gi)0. Since the sequence (G1)0  (G2)0  · · ·  (G )0 is increasing, H1  H2  · · ·  H is an increasing sequence. By definition, each (Gi)0 is irreducible, thus there are at most n2 distinct values for the (Gi)0, and hence also for the Hi. Furthermore, each Hi is bounded by 1. It follows from Theorem 4 that each quotient Gi/(Gi  Hi) is isomorphic to a finite linear group in dimension m := (n2 + 1)2. Moreover, the set of rational points in each of the above-mentioned finite groups is Zariski-dense. Hence, each quotient Gi/(Gi  Hi) is isomorphic
13

to a finite subgroup of GLm(Q). By Theorem 5, the order of a finite subgroup of GLm(Q) is at most (2m)!. Taking the product of the number of distinct values for the Hi and the number of distinct finite quotients Gi/(Gi  Hi) we obtain the upper bound n2(2m)! for the length of the chain.
We note that Lemma 14 immediately applies to the case where the groups G1, · · · , G are generated by unitary matrices. For the general case, we provide the following bound.
Theorem 15. Let n  N and let Gi  GLn(Q), 1  i  , be generated over Q and be such that G1 G2 · · · G . Then we have  2 . 222poly(n)
Proof. For each group Gi, let Ui = (Gi)u be the subgroup generated by the unipotent elements in Gi. By Lemma 9, each Ui is d-bounded over Q for d := (n3 + 1)2n3 . Consequently, each quotient Gi/Ui is isomorphic to a linear algebraic group in dimension m := (n2 + d)2d2, which moreover consists exclusively of semisimple elements.
Observe that the sequence U0  U1  · · ·  U is increasing. We can decompose this sequence into a most n2 blocks where the dimension of the Ui is constant in each block. Since by Lemma 9 the Ui are irreducible, they are constant in each block. Consider a block U := Uk = Uk+1 = · · · = Ur, say from index k to r where 1  k  r  . The sequence (Gk/U )  · · ·  (Gr/U ) is strictly increasing and hence by Lemma 14 has length at most m2(2(m2 + 1)2)!. Taking the product of the number of blocks and the length of each block we obtain the upper bound n2m2(2(m2 + 1)2)! for the length of the chain .
Recall that a number field K is a finite extension of the field of rational numbers Q. The order of a finite subgroup of GLm(K) is at most (2m[K : Q])! where [K : Q] is the dimension of K as a vector space over Q. This will allow us to extend Lemma 14 and Theorem 15 to a chain of linear algebraic groups generated over a number field, with the appropriate changes to the upper bound on the length of chain.
Corollary 16. Let n  N and K be a number field. In GLn(Q), there is no infinite strictly increasing chain of groups that are all generated over K.
Acknowledgement
We thank Ehud Hrushovski for an explanation of [Hru02] and other useful suggestions.

References

[AMP19] E. Amzallag, A. Minchenko, and G. Pogudin. Degree bound for toric envelope of a linear algebraic group, 2019.

[Amz18] E. Amzallag. Galois Groups of Differential Equations and Representing Algebraic Sets. PhD thesis, CUNY Academic Works, 2018.

[BC01]

V. Blondel and V. Canterini. Undecidable problems for probabilistic automata of fixed dimension. Theory of Computing Systems, 36:231­245, 2001.

[BHK+20] G. Bumpus, C. Haase, S. Kiefer, P.-I. Stoienescu, and J. Tanner. On the size of finite rational matrix semigroups. In ICALP 2020, volume 168 of LIPIcs, pages 115:1­115:13, 2020.

[BJKP05] V. D. Blondel, E. Jeandel, P. Koiran, and N. Portier. Decidable and undecidable problems about quantum automata. SIAM J. Comput., 34(6):1464­1473, 2005.

14

[CLZ00] J. Cai, R. J. Lipton, and Y. Zalcstein. The complexity of the A B C problem. SIAM J. Comput., 29(6):1878­1888, 2000.

[de 09]

W. A. de Graaf. Constructing algebraic groups from their lie algebras. Journal of Symbolic Computation, 44(9):1223­1233, 2009. Effective Methods in Algebraic Geometry.

[de 17]

W. A. de Graaf. Computation with Linear Algebraic Groups. Chapman & Hall/CRC Monographs. CRC Press, Taylor & Francis Group, 2017.

[DJK05] H. Derksen, E. Jeandel, and P. Koiran. Quantum automata and algebraic groups. J. Symb. Comput., 39(3-4):357­371, 2005.

[Dub90] T. W. Dub´e. The structure of polynomial ideals and grobner bases. SIAM J. Comput., 19(4):750­773, June 1990.

[Fen15]

R. Feng. Hrushovski's algorithm for computing the galois group of a linear differential equation. Advances in Applied Mathematics, 65:1­37, 2015.

[Fri97]

S. Friedland. The maximal orders of finite subgroups in gln(q). Proceedings of the American Mathematical Society, 125(12):3519­3526, 1997.

[GL05] R. M. Guralnick and M. Lorenz. Orders of finite groups of matrices. 2005.

[GN03]

S. Gulwani and G. C. Necula. Discovering affine equalities using random interpretation. In Conference Record of POPL 2003: The 30th SIGPLAN-SIGACT Symposium on Principles of Programming Languages, New Orleans, Louisisana, USA, January 15-17, 2003, pages 74­84. ACM, 2003.

[HOPW18] E. Hrushovski, J. Ouaknine, A. Pouly, and J. Worrell. Polynomial invariants for affine programs. In Anuj Dawar and Erich Gr¨adel, editors, Proceedings of the 33rd Annual ACM/IEEE Symposium on Logic in Computer Science, LICS 2018, Oxford, UK, July 09-12, 2018, pages 530­539. ACM, 2018.

[Hru02]

E. Hrushovski. Computing the galois group of a linear differential equation. In Banach Center Publications, volume 58 of Differential Galois Theory. Institute of Mathematics, Polish Academy of Sciences, 2002.

[Hum98] J. E. Humphreys. Linear algebraic groups. Graduate texts in mathematics 021. Springer, 4 edition, 1998.

[Kap72] I. Kaplansky. Fields and Rings. Chicago Lectures in Mathematics. University of Chicago Press, 1972.

[Kar76]

M. Karr. Affine relationships among variables of a program. Acta Inf., 6:133­151, 1976.

[KP02]

J. Kuzmanovich and A. Pavlichenkov. Finite groups of matrices whose entries are integers. The American Mathematical Monthly, 109(2):173­186, 2002.

[Mas88] D. W. Masser. Linear relations on algebraic groups. In New Advances in Transcendence Theory. Cambridge University Press, 1988.

[Mik66]

K. A. Mikhailova. The occurrence problem for direct products of groups. Matematicheskii Sbornik Novaya Seriya, 70(112):241­251, 1966.

[MS04]

M. Mu¨ller-Olm and H. Seidl. Computing polynomial program invariants. Inf. Process. Lett., 91(5):233­244, 2004.

15

[New72] [Paz71]
[Ser02] [Sun19]
[Wei85]

M. Newman. Integral Matrices. Academic Press, 1972.
A. Paz. Introduction to Probabilistic Automata (Computer Science and Applied Mathematics). Academic Press, Inc., USA, 1971. A´ . Seress. Permutation Group Algorithms. Cambridge University Press, 2002.
M. Sun. A new bound on hrushovski's algorithm for computing the galois group of a linear differential equation. Communications in Algebra, 47(9):3553­3566, 2019.
B. Weisfeiler. Post-classification version of jordan's theorem on finite linear groups. Proc. Natl. Acad. Sci., (81):5278­5279, 1985.

16

