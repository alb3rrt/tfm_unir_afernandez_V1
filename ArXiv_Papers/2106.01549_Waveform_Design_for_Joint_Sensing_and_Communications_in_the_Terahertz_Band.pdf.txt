arXiv:2106.01549v1 [eess.SP] 3 Jun 2021

1
Waveform Design for Joint Sensing and
Communications in the Terahertz Band
Tianqi Mao, Jiaxuan Chen, Qi Wang, Chong Han, Member, IEEE, Zhaocheng Wang, Fellow, IEEE, and George K. Karagiannidis, Fellow, IEEE
Abstract
The convergence of radar sensing and communication applications in the terahertz (THz) band has been envisioned as a promising technology, since it incorporates terabit-per-second (Tbps) data transmission and mm-level radar sensing in a spectrum- and cost-efficient manner, by sharing both the frequency and hardware resources. However, the joint THz radar and communication (JRC) system faces considerable challenges, due to the peculiarities of the THz channel and front ends. To this end, the waveform design for THz-JRC systems with ultra-broad bandwidth is investigated in this paper. Firstly, by considering THz-JRC systems based on the co-existence concept, where both functions operate in a time-domain duplex (TDD) manner, a novel multi-subband quasi-perfect (MS-QP) sequence, composed of multiple Zadoff-Chu (ZC) perfect subsequences on different subbands, is proposed for target sensing, which achieves accurate target ranging and velocity estimation, whilst only requiring cost-efficient lowrate analog-to-digital converters (A/Ds) for sequence detection. Furthermore, the root index of each ZC subsequence of the MS-QP sequence is designed to eliminate the influence of doppler shift on the THz radar sensing. Finally, a data-embedded MS-QP (DE-MS-QP) waveform is constructed through timedomain extension of the MS-QP sequence, generating null frequency points on each subband for data
This work was supported in part by the National Key R&D Program of China under Grant 2018YFB1801501, in part by Shenzhen Special Projects for the Development of Strategic Emerging Industries (201806081439290640), and in part by Shenzhen Wireless over VLC Technology Engineering Lab Promotion. (Corresponding author: Zhaocheng Wang.)
T. Mao, J. Chen and Z. Wang are with Beijing National Research Center for Information Science and Technology, Department of Electronic Engineering, Tsinghua University, Beijing 100084, China, and Z. Wang is also with Shenzhen International Graduate School, Tsinghua University, Shenzhen 518055, China. (e-mail: maotq18@mails.tsinghua.edu.cn, chenjx16@mails.tsinghua.edu.cn, zcwang@tsinghua.edu.cn).
Q. Wang is with Huawei Device Co. Ltd., Shenzhen 518129, China (e-mail: steven wq@hotmail.com). Chong Han is with the UM-SJTU Joint Institute, Shanghai Jiao Tong University, Shanghai 200240, China (e-mail: chong.han@sjtu.edu.cn). G. K. Karagiannidis is with the Wireless Communications Systems Group (WCSG), Aristotle University of Thessaloniki, Thessaloniki 54 124, Greece (e-mail: geokarag@auth.gr).

2
transmission. Unlike the THz-JRC system in TDD manner, the proposed DE-MS-QP waveform enables simultaneous interference-free sensing and communication, whilst inheriting all the merits from MS-QP sequences. Numerical results validate the superiority of the proposed waveforms in terms of sensing performance, hardware cost and flexible resource allocation over their conventional counterparts.
Index Terms
Terahertz (THz), joint radar sensing and communications (JRC), waveform design, multi-subband quasi-perfect (MS-QP) sequence, data-embedded MS-QP (DE-MS-QP) waveform, 6G networks.
I. INTRODUCTION Terahertz (THz) communication (0.1-10 THz) has been envisioned a critical role in the future sixth-generation (6G) networks to alleviate the scarcity of frequency resources caused by the escalating mobile data traffic [1]­[4], which is capable of attaining terabit-per-second (Tbps) data transmission due to its ultra-broad communication bandwidth [5]. This enables a large number of bandwidth-consuming services, including augment/virtual reality, holographical video conferencing, multimedia kiosks, and wireless backhauling, etc. [2], [6]. Besides, secure data transmission can be realized by THz communication for military use thanks to its "pencil"-like extremely narrow beams [7]. In addition to its considerable merits in wireless communication, THz signals also enables accurate sensing applications with ultra-high-resolution target range and velocity estimation [1], [8], attributed to huge operation bandwidth and high carrier frequency over 100 GHz. Moreover, the extremely narrow beamwidth of THz radar signals could effectively mitigate the clutter effects caused by multi-path propagation, further enhancing the sensing performance.
A. State-of the-Art As the transceiver hardware architectures for wireless communication and radar systems
have become more and more similar, thanks to the advanced digital signal processing [9], it is viable to incorporate both systems together by sharing one single transceiver platform and the operating spectrum, leading to cost-efficient and compact hardware design, as well as improved spectral efficiency. This so-called joint radar and communication (JRC) concept has been extensively investigated for lower-frequency bands in the literature. Authors in [9]­ [11] provide comprehensive overviews of the existing JRC techniques, which classify their principles into co-existence and co-design philosophies. For co-existence methods, both the

3
radar and communication subsystems are treated as interferers to each other. A simple strategy which could fully mitigate the interference is to perform target sensing and data transmission in a time-division duplex (TDD) manner [12]. However, the dual functions are sometimes required to be steadily available, which necessitates simultaneous operation of radar sensing and communication, causing performance degradation of the JRC systems due to inevitable mutual interference [13]. Under such scenario, a joint precoder-decoder design was proposed to maximize the signal-to-interference-plus-noise ratio (SINR) for interference mitigation of the JRC systems [14]. Besides, the interference to the communication subsystem from radar sensing is reduced by solving a non-convex joint interference removal and data demodulation problem, where two optimization algorithms are invoked [15]. More details on the interference cancellation of co-existing JRC systems can be found in [16]. These strategies, however, induce additional computational complexity.
Alternatively, the co-design implementations of JRC systems were developed by employing integrated waveforms, that enable both radar sensing and communication. In [17]­[19], the orthogonal frequency division multiplexing (OFDM) waveform was applied to the JRC systems due to its capability of high-rate data transmission, as well as its ideal auto-correlation property for phase-shift keying (PSK) modulation [20]. However, OFDM signals inherently suffer from high peak-to-average power ratio (PAPR), causing undesirable clipping distortions originated from the nonlinearity of THz-band power amplifiers. Moreover, the performance of the sensing subsystem could still be affected by possible range sidelobes of the OFDM waveform [13], since its ideal auto-correlation property is lost for quadrature amplitude modulation (QAM) constellations. On the other hand, the single-carrier approach is capable of maintaining low PAPR values, which is more suitable for THz systems equipped with imperfect nonlinear devices [21]. In [22], a cyclic-prefixed single-carrier (CP-SC) JRC system was investigated, where a lowcomplexity estimator for target range and velocity was proposed based on cyclic correlations and fast fourier transform (FFT) operations. However, the simple communication waveform employing quadrature phase shift keying (QPSK) was directly applied for sensing, whose autocorrelation property is imperfect due to randomness of the transmitted symbols. Additionally, Kumari et al. utilized the preamble sequence of the IEEE 802.11ad frame, originally employed for synchronization and channel estimation, as the radar sensing sequence, which was composed of Golay complementary sequences with good auto-correlation properties [23]. Such strategy is vulnerable to extremely low signal-to-noise ratios (SNRs) at the radar receiver, since the

4
preamble length is limited. Moreover, [24] combined PSK modulation and the direct sequence spread spectrum (DSSS) technique to generate an integrated waveform for single-carrier JRC systems, which could achieve sufficiently high peak sidelobe level via optimization methods, but suffers from inherent data rate loss.
B. Motivation and contributions There are significant technical challenges for the implementation of THz JRC systems, which
cannot be fully overcome by the aforementioned schemes for lower-frequency bands. Firstly, THz signals are prone to severe path loss induced by the spreading loss and molecular absorption effects [2], [25], leading to extremely low SNR at the radar receiver. Secondly, the doppler shift becomes more dominant due to the ultra-high carrier frequency in THz-JRC systems, which has negative impacts on the target sensing performance, e.g., false alarms caused by the range sidelobes [9]. Besides, analog-to-digital converters (A/D) with sampling rate over hundreds of GHz may be required for THz-JRC systems with ultra-broad bandwidth, which significantly enlarges the hardware cost. Finally, mutual interference between the dual JRC functions can be detrimental for THz radar sensing, since the echo signals experiencing severe path loss could be easily submerged in the leaked communication signals to the radar receiver. At present, existing literature regarding THz-JRC systems is still limited [8], [26], and has not completely addressed the technical barriers listed above. To this end, this paper extensively investigates the waveform design issue for THz-JRC systems with ultra-broad bandwidth, where the main contributions can be summarized as follows: 1) To alleviate the harsh requirement on the A/D sampling rate in THz-JRC systems, a multisubband quasi-perfect (MS-QP) sequence is proposed for THz radar sensing, which is obtained from the superposition of multiple Zadoff-Chu (ZC) perfect sequences1 [27] on different subbands. By such arrangement, it is capable of maintaining ultra-broad bandwidth with good auto-correlation property, whilst only low-rate A/Ds are required for signal recovery at the radar receiver, leading to reduced hardware cost. 2) The parameters of the proposed MS-QP sequence are specially designed against strong doppler shift in the THz scale. More specifically, by considering each ZC subsequence on different subbands for radar sensing respectively, its root index is optimized to gather high sidelobes
1Perfect sequence is referred to as the sequence whose periodic auto-correlation value always equals zero for any non-zero shift [28].

5
induced by doppler shift closely around the mainlobe on the radar range profile2, which also leads to well concentration of dominant range sidelobes to the main peaks of the proposed MSQP sequence. Afterwards, a target detection criterion called Target Exclusion nearby the Main Peak (TEMP) is invoked assuming absence of other target nearby the main peaks, thus mitigating the false alarms caused by doppler shift. 3) An data-embedded MS-QP (DE-MS-QP) waveform is proposed for the THz-JRC system based on the MS-QP sequence, which enables simultaneous ultra-high-resolution sensing and communication without mutual interference. More specifically, the MS-QP sequence is repetitively transmitted to generate null frequency points on each subband available for data transmission. Then the data symbols are inserted into these frequency points through time-domain replication and phase rotation procedures, yielding the proposed DE-MS-QP waveform. 4) Simulation results are provided to validate the feasibility of the proposed parameter design, and that the proposed waveforms are capable of achieving ultra-high-resolution ranging and velocity estimation under extremely noisy environment, with cheaper front-end devices than classical wide-band ZC sequences and linear frequency modulated (LFM) signals. Moreover, the performance trade-off between the dual functions of the proposed DE-MS-QP waveform is investigated by flexibly adjusting the waveform parameter, which is optimized numerically to enable simultaneous mm-level radar sensing and data transmission with marginal degradation of the communication performance.
C. Structure and notations The remainder of the paper is organized as follows. Section II illustrates the system model
of THz-JRC system. Section III presents the proposed waveform design, which is followed by the corresponding receiving techniques of the THz-JRC systems in Section IV. Numerical performance evaluation is then provided in Section V, and Section VI draws the conclusion. Note that this paper places an emphasis on the aspect of radar sensing in THz-JRC systems, since the THz communication systems have been investigated into detail in our previous work [29], [30].
Notation: (·), · and |·| denote the conjugate operator, the 2-norm, and the modulus of a set, respectively. · N stands for the modulo-N operator.
2Range profile is defined as the cross-correlation results between the echo signals and the transmitted sensing sequence. Correspondingly, range sidelobes are referred to as the sidelobes besides the main peak on the range profile.

6

x[n]

Modulator

D/A

Mixer

HPA

TX ANT

Radar Detection

y[n] A/D

fc Mixer

LNA

RX ANT +

Demodulator

R w[n]

Fig. 1. Transceiver diagram of the THz-JRC system.
II. SYSTEM MODEL
The architecture of a typical THz-JRC system is illustrated in Fig. 1, where both of the radar sensing and communication subsystems share the same hardware platform with co-located transceiver front ends. For sensing/communication purposes, x = [x[0], x[1], · · · , x[N - 1]] are subsequently fed into a digital-to-analog converter (D/A), a mixer and a high power amplifier (HPA) to generate THz-band analog signals, and then emitted to the targets by the transmit (TX) antenna. Since high-gain directional antennas with extremely narrow beams are usually employed at the THz transceiver against severe path loss [1], [3], the multi-path effects could be limited, which makes it quite reasonable to assume a line-of-sight (LoS) flat-fading channel between the JRC platform and the targets [31] with non-dominant clutters on the path treated as additive noise [23]. After arriving at the targets, on one hand, the conveyed data can be extracted from the received waveform by the mobile devices. On the other hand, x is also bounced back to the JRC platform for receive (RX) signal processing including down-conversion and A/D operations. The resultant baseband echoes, denoted as y = [y[0], y[1], · · · , y[N - 1]], is then utilized for target sensing via time-domain correlation-based methods3. Aside from the roundtrip delay as well as the doppler shift effects, y inevitably suffers from hardware impairment including in-phase/quadrature (I/Q) imbalance, phase noise and HPA nonlinearity induced by the THz front ends [32], since the so-called "THz Gap" poses great difficulty to the fabrication of THz front-end devices [1]. For simplicity, we assume that the TX I/Q imbalance and nonlinearity of HPA have been removed with existing pre-compensation techniques [21]. Therefore, the echo

3Aside from the radar detection applications, the RX branch of the JRC platform is also capable of demodulating the uplink signals from the targets as shown in Fig. 1, where the radar sensing and uplink data transmission are assumed to follow TDD working mode.

7

signal y can be formulated as

I

y[n] =

µr hix[n - i]ej(2nvi+n-i ) + w[n] e-jn + r hi x[n - i]e-j(2nvi+n-i ) + w[n] ejn

i=1

I

=

hiµrx[n -  ]e i j(2nvi+n-i -n) + hi rx[n -  ]e i -j(2nvi+n-i -n) + w~[n],

i=1
(1)

where I is the number of available targets, and hi denotes the round-trip path gain of ith target, equal to the multiplication of antenna gains, free-space propagation loss, molecular absorption

loss as well as the reflection loss [32]. Besides, i = ti/Ts is defined as the integer delay with ti and Ts representing the round-trip delay of the ith target and the sampling period, respectively. Note that fractional time delay possibly exists due to the finite sampling rate, which is omitted

in (1) for brevity, and vi is defined as the normalized doppler shift

vi

=

2uifc c0

Ts,

(2)

where ui, fc and c0 are defined as the relative speed of the ith target, the center frequency of the THz-JRC system and the speed of light, respectively. Additionally, for hardware impairment

parameters in (1), we have [33]



µr = cos r + jr sin r;

(3)

vr = r cos r - j sin r,

where r and r denote the phase and amplitude imbalances of the RX I/Q branches, respectively. n for n = 0, 1, · · · , N - 1 is the phase noise term of the local oscillator (LO) shared by the co-located transceiver, following a random-walk model (Wiener process) illustrated as [34]

n = n-1 + n, n = 1, 2, · · · , N - 1,

(4)

where n  N (0, 2 ) denotes the Gaussian random variation of phase noise, and 0 is often set to be uniformly distributed in [0, 2). Finally, w[n] is a circularly symmetric complex Gaussian (CSCG) variable of CN (0, 2), defined as the aggregate noise component of thermal noise and clutters, whilst w~[n] denotes the equivalent noise term involving the impacts of hardware imperfections.

8

III. PROPOSED WAVEFORM DESIGN FOR THZ-JRC SYSTEMS
As is observed in (1), the received echoes are distorted by hardware imperfections. However, unlike the wireless communication subsystem, which is vulnerable to hardware impairment causing non-negligible performance loss [32], I/Q imbalance and the LO phase noise are considered to be less dominant in THz radar sensing. Explicitly, the echo signals are composed of the received sensing sequence as well as its image component induced by I/Q imbalance. The power of the former is usually much stronger than the image counterpart [35]­[37], whose impacts are marginal after the correlation operation. Besides, since a single LO is shared by the co-located radar transceiver, the TX and RX phase noise terms in (1) could cancel each other out approximately if the round-trip delay is sufficiently small. Such condition is readily satisfied for THz-JRC systems, which mainly serves short-range target/users due to the severe path loss. Therefore, hardware imperfections will not be an emphasis in our waveform design.

A. MS-QP Sequence for THz Radar Sensing

Since ultra-broad bandwidth is employed in the THz-JRC system to achieve both highresolution ranging and Tbps data transmission, A/Ds with sampling rate over tens of GHz are required in principle at the receiver, leading to undesirable hardware cost. To this end, a novel MS-QP sequence is constructed for THz radar sensing using multiple perfect sequences (e.g., ZC sequences [38], [39]) on different frequency subbands, which could support ultra-high-resolution ranging with the only requirement of low-rate A/Ds. Specifically, a set of M ZC sequences4, bm = [bm[0], bm[1], · · · , bm[Lm - 1]] for m = 0, 1, · · · , M -1, is generated for MS-QP sequence construction, each formulated as

bm[n] = exp

-j

pmn(n + Lm

1)

,

(5)

with ideal auto-correlation property shown as



rbmbm [n]

=

Lm -1
bm[k]bm[k

-



+

n]

=

Lm,

n = ;

(6)

k=0

 0, n = ,

where rbmbm[n] denotes the auto-correlation value, and  represents the round-trip delay. Besides, Lm and pm are defined as the length of bm (odd number) and the root index, respectively,

4For clarity, ZC sequences are employed for MS-QP sequence generation without loss of generality. The construction method is also applicable to the rest of the perfect sequence family, e.g., generalized Frank sequence, Milewski sequence, etc. [28].

B0[0] B0[1] B0[2]

B0[L0 -1] B1[0] B1[1] B1[2]

B1[L1 -1] BM -1[0] BM -1[1] BM -1[2]

9 BM -1[LM -1 -1]

0th subband

GI

1st subband

(M-1)th subband

frequency

Fig. 2. Frequency-domain representations of the proposed MS-QP sequence.

following gcd(pm, Lm) = 1. Afterwards, bm for m = 0, 1, · · · , M - 1 are converted to the frequency domain using Lm-point discrete Fourier transform (DFT), yielding Bm[k] for k = 0, 1, · · · , Lm - 1. The frequency components of bm are then moved to the m-th frequency subband for m = 0, 1, · · · , M - 1, respectively, where a guard interval (GI) of length LG is

inserted between any two neighboring subbands, as illustrated in Fig. 2. Finally, an inverse DFT

(IDFT) with size of N = (

M -1 m=0

Lm)

+

M LG

is

imposed

on

the

concatenated

spectrum

of

the

M subbands, yielding the equivalent baseband representation of the proposed MS-QP sequence,

derived as

x[n]

=

1 N

M -1
e j2fmn N
m=0

Lm -1

Bm[k]e

j2 N

kn

k=0

=

1 N

M -1
e j2fmn N
m=0

1 Lm

Lm -1 l=0

sin bm[l]

Lm(

n N

-

l Lm

)

sin

(

n N

-

l Lm

)

× e , j(Lm

-1)(

n N

-

l Lm

)

(7)

where the frequency shift fm can be calculated by



( fm =

m-1 i=0

Li)

+

mLG,

1  m  M - 1;

(8)



0,

m = 0.

It is evident that the proposed MS-QP sequence could achieve ultra-broad bandwidth by concatenating multiple subbands, leading to high-resolution ranging due to the extremely short symbol period [22]. Meanwhile, only relatively low-rate A/Ds are required at the radar receiver by sampling signals on each subband independently, which will be detailed in Section IV. On the other hand, to investigate the auto-correlation property of the proposed MS-QP sequence, a useful lemma already demonstrated in [20] is introduced as below:
Lemma 1: [20] An arbitrary sequence whose DFT coefficients are of constant magnitude, has ideal auto-correlation property, and vice versa.
It is readily proved that the magnitudes of DFT coefficients of any ZC sequence are constant.

10

Hence, the spectrum envelope of the proposed MS-QP sequence, constituted by Bm[k] for k = 0, 1, · · · , Lm - 1 and m = 0, 1, · · · , M - 1, is nearly constant if LG is sufficiently small. This intuitively implies that the proposed MS-QP sequence could achieve quasi-perfect autocorrelation property according to the lemma, making it suitable for radar sensing applications.
Despite the aforementioned merits of the proposed MS-QP sequence, the time-domain constantamplitude property is unfortunately not inherited from its ZC sequence components, which may cause high PAPR problem. This could be detrimental especially for ultra-high-rate THz systems with HPAs [40]. In order to address this issue, whilst retaining the quasi-perfect auto-correlation property, we recall that the auto-correlation property of a sequence is mainly dependent on its amplitude-frequency characteristic [22], which enlightens us to alter the phase-frequency characteristic of the proposed MS-QP sequence for PAPR reduction. More specifically, a phase rotation of ^m chosen from an L-element alphabet denoted as  = {0, 1, · · · , L-1}, is imposed on the mth frequency subband for m = 0, 1, · · · , M - 1. Hence, the proposed MS-QP sequence x[n] for n = 0, 1, · · · , N - 1, originally given in (7), can be finally modified as

x[n]

=

1 N

M

-1

ej(

2fm n N

+^m)

1

m=0

Lm

×

Lm -1

sin

bm[l]

Lm(

n N

-

l Lm

)

l=0

sin

(

n N

-

l Lm

)

e , j(Lm-1)(

n N

-

l Lm

)

(9)

where we have

^0, ^1, · · · , ^M-1

=

arg

min
^i

max( x[n] 2) E( x[n] 2)

.

(10)

Finally, for practical implementations to generate MS-QP sequences, one straightforward solution is shown in Fig. 3(a), where bm for m = 0, 1, · · · , M - 1 with sampling period Tm are moved to different subbands in the low-frequency scale, and then superposed together to generate the MS-QP sequence x with sampling period Ts through digital circuits. Here we have Tm = N Ts/Lm for m = 0, 1, · · · , M - 1. Such method however requires an ultra-high-rate D/A to generate analog radar sensing signals x(t). Alternatively, as illustrated in Fig. 3(b), bm can be directly converted into analog signals through low-rate D/As, and then moved to its corresponding subband with center frequency fT,m in the THz scale, respectively. Finally, different branches are superposed to generate x(t).
Remark 1: Aside from radar sensing, the transmitter architecture of the proposed MS-QP sequence is also capable of supporting 5th-generation (5G) and beyond wireless communications, e.g., the multi-service subband filtered multi-carrier (MS-SFMC) scheme [41]. In MS-SFMC

11

b0[n] Shaping Filter
b1[n] Shaping Filter

j 2p f1n
eN ×

x[n] +

D/A

e j 2p fct x(t)
×

bM -1[n] Shaping Filter

2p j

fM -1n

eN

×

(a) Sequence generator based on digital circuits.

b0[n] Shaping Filter
b1[n] Shaping Filter

D/A D/A

e j 2S fT,0t ×
e j 2S fT,1t ×

x(t) +

bM 1[n] Shaping Filter

D/A

e j 2S fT,M 1t ×

(b) Sequence generator based on analog circuits.

Fig. 3. Transmitter diagram for MS-QP sequence generation.
systems, the overall bandwidth is split into multiple subbands separated by GIs utilized for different data services, where the bandwidth allocation for different subbands can be flexible, and data on each subband is extracted for a particular service/user using band-pass filtering. This fits quite well with the MS-QP sequence transmitter in Fig. 3, making the proposed MSQP sequence readily available for JRC applications in a TDD manner.

B. Parameter Design for MS-QP Sequences against Strong Doppler Shift

The doppler shift effect tends to be stronger in the THz scale, which induces dominant sidelobes on the range profile of radar sensing, leading to additional false alarms at the radar receiver. Hence, the parameters of the proposed MS-QP sequence are required to be specially designed in order to enhance its robustness against doppler shift. It can be observed in (9) that the MS-QP sequence is the superposition of M subsequences b~m = ~bm[0], ~bm[1], · · · , ~bm[N - 1] for m = 0, 1, · · · , M - 1 on non-overlapped subbands, which are expressed by

~bm

[n]=

1 N Lm

ej(

2fm N

n

+^m

)

Lm-1 l=0

bm[l]

×

sin

Lm(

n N

-

l Lm

)

sin

(

n N

-

l Lm

)

e . j(Lm

-1)(

n N

-

l Lm

)

(11)

12
It is indicated that b~m for m = 0, 1, · · · , M - 1 are approximately orthogonal, i.e., having zero cyclic cross-correlations, since their used spectrums are non-overlapped. The orthogonality still holds even under doppler shift effects by setting guard interval of appropriate length between neighbouring subbands. This indicates that the range sidelobes of the MS-QP sequence induced by doppler shift is mainly determined by the cross-correlation results between b~m and its echo signal for m = 0, 1, · · · , M - 1. Furthermore, it is seen from (11) that b~m is actually an interpolated and frequency-shifted ZC sequence, which is expected to share similar properties with bm, including the distribution of sidelobes induced by doppler shift on the range profile. Therefore, against the doppler shift effects on THz radar sensing with the MS-QP sequence, a heuristic strategy is to mitigate its impacts on the range profile of each ZC subsequence bm (m = 0, 1, · · · , M - 1) separately by special design of the corresponding root index pm.

Assume that an arbitrary ZC sequence b = [b[0], b[1], · · · , b[Nzc - 1]] is invoked for THz radar sensing, which is formulated as

b[n] = exp

-j

pn(n + Nzc

1)

,

(12)

where Nzc and p denote the length (odd) and root index of the ZC sequence, respectively, satisfying 0 < p < Nzc and gcd(p, Nzc) = 1. It is indicated that, the ideal auto-correlation property of b can be impaired by the doppler shift effects. Such impact is more pronounced

in THz systems than the lower-frequency counterparts, due to high operating frequency over

hundreds of GHz. Explicitly, by considering the single-target scenario for brevity, the magnitude

of cross-correlation between the transmitted ZC sequence and the echoes with round-trip delay

 and normalized doppler shift v, can be derived as

Nzc -1

rbb[n] =

b[k -  ]ej2vkb[k - n] =

sin  p(n -  ) - vNzc Nzc

,

(13)

k=0

sin

 Nzc

p(n -  ) - vNzc Nzc

which can be seen as a function of p(n -  ) - vNzc Nzc for n = 0, 1, · · · , Nzc - 1, as illustrated in Fig. 4. When the doppler shift is marginal, i.e., v  0, it is observed that p(n -  ) - vNzc Nzc becomes integer for arbitrary value of n, and thus rbb[n] is equal to zero except for n = 
corresponding to the main peak on the range profile. On the other hand, under non-negligible

doppler shift, the values of p(n -  ) - vNzc Nzc for n = 0, 1, 2, · · · , Nzc - 1 deviate from the integer points, leading to non-zero range sidelobes. These sidelobes are higher at the time instant

13

||rbb[n]||

10000 8000 6000 4000 2000 0 -10

high range sidelobe due to doppler effects
zero range sidelobe at integer points

-5

0

5

10

p(n- )-vNzc N zc

Fig. 4. The graph of Rbb[n] as a function of pn - vNzc Nzc , where Nzc = 10007.

n corresponding to smaller p(n -  ) Nzc , by assuming that vNzc < 15. Since gcd(p, Nzc) =

1, R = - p , Nzc (1 -  )p Nzc , · · · , (Nzc - 1 -  )p Nzc constitutes a complete system of

residues with respect to Nzc, constrained to be within

- , Nzc-1 Nzc-1

2

2

without loss of generality.

In other words, R can be regarded as a permutation of all the Nzc integers in

- , Nzc-1 Nzc-1

2

2

,

where each element corresponds to a unique sidelobe on the range profile as shown in Fig. 4. By

changing the root index, the permutation can be modified. The position of sidelobes on the range

profile can then be altered accordingly. Following this philosophy, a novel index root design for

ZC sequences against doppler shift is proposed as follows, which aims at concentrating the

dominant sidelobes caused by doppler shift closely around the main peak on the range profile:

For

any

odd-length

ZC

sequence

b[n]

(n

=

0, 1, · · ·

, Nzc

-

1),

the

root

index

is

set

as

p

=

Nzc ±1 2

if satisfying gcd(p, Nzc) = 1.

5When vNzc  1, the strong doppler shift could even cause translation of the main peak on the range profile, aside from the generation of range sidelobes, leading to inevitable error floor for target ranging. In this paper, the doppler shift is partly mitigated by periodical transmission of shorter codes in each coherent processing interval (CPI) instead of directly using long codes [22], where vNzc < 1 is satisfied.

TABLE I THE DISTRIBUTION OF THE SIDELOBES CAUSED BY DOPPLER SHIFT IN THE RANGE PROFILE, WHERE A ZC SEQUENCE
WITH NZC = 10007 AND p = 5003 IS EMPLOYED FOR RADAR SENSING.

n -  Nzc

· · · -4 -3 -2 -1

0

1

2

3

4 ···

p(n -  ) Nzc · · · 2 5002 1 5003 0 5003 1 5002 2 · · ·

Sidelobe Level · · · High Low High Low Peak Low High Low High · · ·

14

10000

8000

||rbb[n]||

6000

4000

2000

0

0

2000

4000

6000

8000

n

(a) Range profile for the ZC sequence with p = 3.

10000

10000

8000

||rbb[n]||

6000

4000

2000

0

0

2000

4000

6000

8000

10000

n

(b) Range profile for the ZC sequence with p = 5003 (proposed design).

Fig. 5. Range profile of the ZC sequences with and without proposed root index design, where Nzc = 10007, and  = 1000.

To validate the feasibility of the proposed root index design, we firstly consider the case of

p

=

, Nzc -1 2

where

the

elements

of

R

can

be

evaluated

as



 -k,

n -  = 2k;

p(n

-

)

Nzc

=

 (Nzc+1) 2

-

k,

n -  = 2k - 1.

(14)

It is seen from (14) that the time instants of n corresponding to smaller p(n -  ) Nzc are distributed at both sides of n =  closely, making the dominant sidelobes well concentrated around the main peak on the range profile. This is exemplified in Table I with Nzc = 10007 and p = 5003, where the distances from the main peak to the highest and second-highest sidelobes are 2 and 4, respectively. Fig. 5 evaluates the effectiveness of our proposed root index design, given that Nzc = 10007, and  = 1000. In comparison with the case of p = 3 in Fig. 5(a), where non-negligible sidelobes are witnessed away from the main peak, dominant sidelobes are closely

distributed around the main peak employing the proposed parameter design, as shown in Fig.

5(b).

Similar

results

can

be

obtained

for

p

=

, Nzc +1 2

which

is

omitted

here

for

brevity.

15

As discussed above, when applying the MS-QP sequence for THz radar sensing, its sidelobe

distribution on the range profile is determined by those of its ZC subsequences bm for m = 0, 1, · · · , M -1. Hence, the range sidelobes caused by the doppler shift can be well concentrated

around the main peaks on the range profile of the proposed MS-QP sequence by setting pm =

Lm ±1 2

for

m

=

0, 1, · · ·

,M

- 1.

Correspondingly,

the

target

detection

scheme

can

be

specially

designed to eliminate the possible false alarms caused by the strong doppler shift, which will

be discussed into detail in Section IV.

C. Integrated DE-MS-QP Waveform for THz-JRC Systems

As stated in Remark 1, the proposed MS-QP sequence is also compatible with wireless

communication function under TDD working mode, which however cannot support simultaneous

radar sensing and data transmission. To address this issue, an integrated waveform enabling

simultaneous target sensing and data transfer without mutual interference, is developed based on

time-domain extension of the proposed MS-QP sequence, named as the DE-MS-QP waveform.

Before we proceed, the following property is provided for DE-MS-QP waveform construction:

Let si = [si[0], si[1], · · · , si[Ls - 1]] (i = 0, 1, · · · , M  - 1) be M  arbitrary sequences of

length Ls, and si = [si[0], si[1], · · · , si[Ls - 1]] with Ls = LsM  be the time-domain extension

of si, where

si = si,0, si,1, · · · , si,M-1 ,

(15)

and

si,g

=

e s , j

2gi M

i

g = 0, 1, · · · , M - 1.

(16)

Then the Ls-DFT of si, denoted as Si[k] for k = 0, 1, · · · , Ls - 1, can be calculated by

Si[k]

=

Ls -1 n=0

si[n]

exp(-j

2kn Ls

)

=

M -1 g=0

exp(-j 2

(k - M

i)

g

)

Ls-1 n=0

si[n]

exp(-j

2kn Ls

)

 M  =

Ls-1 n=0

si

[n]

exp

-j

2kn Ls

,

k M = i;

(17)



0,

else.

Note that when k = Mk + i with k = 0, 1, · · · , Ls - 1, Si[k] can be further simplified as

Ls-1
Si[k] = M  si[n] exp
n=0

-j

2(M

k Ls

+

i)n

=

M

Ls

-1

si

[n]e-j

2in Ls

exp

n=0

-j

2kn Ls

, (18)

M cth copy of ZC seq.
j 2(M c1)S
e Mc
M c th copy of 1st data seq.
j 4(M c1)S
e Mc
M c th copy of 2nd data seq.

3rd copy of ZC seq.

2nd copy of ZC seq.

1st copy of ZC seq.

j 4S
e Mc

j 2S
e Mc

3rd copy of 1st data seq. 2nd copy of 1st data seq. 1st copy of 1st data seq.

j 8S
e Mc

j 4S
e Mc

3rd copy of 2nd data seq. 2nd copy of 2nd data seq. 1st copy of 2nd data seq.

16
JRC sequence for a single subband
+

j 2(M c1)2 S
e Mc
M cth copy of M c 1th data seq.

j 4(M c1)S
e Mc

j 2(M c1)S
e Mc

3rd copy of M c 1th data seq. 2nd copy of M c 1th data seq. 1st copy of M c 1th data seq.

Fig. 6. Diagram of sequence generation for each subband of the proposed DE-MS-QP waveform.

which can be seen as the k-th scaled Ls-DFT coefficient of a phase-shifted version of si, denoted

by

¯si

=

[s¯i[0],

s¯i[1], ·

·

·

,

s¯i[Ls

-

1]]

with

s¯i[n]

=

si

[n]e-j

2in Ls

.

It is seen from above that time-domain extension of the transmitted sequences enables multiple

concurrent data streams on non-intersect frequency points without mutual interference. Following

this philosophy, the proposed DE-MS-QP waveform is constructed as Fig. 6. For the m-th subband (m = 0, 1, · · · , M - 1), the incoming ZC sequence bm is repeated for M times, yielding bm of length Lm = LmM  formulated as

bm = [bm, bm, · · · , bm] = [bm[0], bm[1], · · · , bm[Lm - 1]] ,

(19)

M  times

whose Lm-DFT coefficients are denoted as Bm [k] (k = 0, 1, · · · , LmM - 1). According to (15)-(17), the extended ZC sequence only occupies the Mn-th frequency points for n = 0, 1, · · · , Lm - 1, in other words, Bm [k] = 0 for k M = 0.

The resultant zero frequency points can be utilized for data transmission. As presented in Fig. 6, totally (M - 1) Lm-length data sequences modulated with the constellation alphabet M, expressed by si,m = [si,m[0], si,m[1], · · · , si,m[Lm - 1]] for i = 1, 2, · · · , M  - 1, are periodically transmitted for M times. Meanwhile, phase rotation is imposed on each copy of the data

sequence, yielding the extended data sequence written as

si,m = si,m,0, si,m,1, · · · , si,m,M-1 = si,m[0], si,m[1], · · · , si,m[Lm - 1] ,

(20)

17

where we have

si,m,g

=

e s . j

2gi M

i,m

(21)

Based on (15)-(17), si,m merely takes up the (M k+i)-th frequency points (k = 0, 1, · · · , Lm-1) by performing an Lm-DFT for i = 1, · · · , M - 1, respectively. Then the extended sensing and data sequences can be superposed together without mutual interference, written as

M -1

xm[n] = bm[n] +

si,m[n], n = 0, 1, · · · , Lm - 1,

(22)

i=1

which is then moved to the m-th subband utilizing the transmitter structure in Fig. 3 for m =

0, 1, · · · , M - 1, respectively. Finally, the proposed DE-MS-QP waveform is obtained by adding

up resultant signals on each subband, whose equivalent baseband expression is formulated as

x[n] = 1

e M -1

j

2fm N

n

+^m

N  m=0

1 Lm

Lm-1 l=0

xm

[l]

sin sin

Lm



(

n N

-

l Lm

(

n N

-

) l
Lm

)

e , j(Lm-1)(

n N

-

l Lm

)

(23)

where N  = (

M -1 m=0

Lm)

+

M LG

denotes

the

length

of

x[n],

and

LG

represents

the

length

of

GI in the frequency domain. Besides, fm is defined as



fm = (

m-1 i=0

Li)

+

mLG,

1  m  M - 1;

(24)



0,

m = 0.

The proposed DE-MS-QP waveform shares the same multi-subband structure as the proposed

MS-QP sequence, which could achieve ultra-high-resolution ranging with cost-efficient front-end

devices. Besides, its radar sensing component can be seen as periodical transmissions of the MSQP sequence for M times, which is uncorrelated with the data components since they occupy

non-intersect frequency points. Therefore, the DE-MS-QP waveform is capable of ensuring good

auto-correlation property of its radar sensing component as well as marginal interference on radar

detection from communication data, leading to superior sensing performance. On the other hand,

concurrent data transmission is also enabled without interference from radar sensing theoretically,

where the spectral efficiency can be formulated as

SE

=

N  - M LG N  + Lcp

×

M - M

1

log2

|M|

(bit/s/Hz),

(25)

which considers the insertion of cyclic prefix (CP) of length Lcp against the timing error or

18

e j 2S fT,0t

y(t)

×

Band-pass Filter

e j 2S fT,1t ×

Band-pass Filter

A/D A/D

e j 2S fT,M -1t ×

Band-pass Filter

A/D

y[n] DSP

Fig. 7. Receiver diagram for MS-QP sequence collection.
inter-symbol interference (ISI), etc. Remark 2: There is a trade-off in frequency resource allocation between radar sensing and
communication applications. More specifically, with the increase of M, more independent data symbol streams are transmitted in parallel, leading to enhanced throughput at the cost of reduced power supply for radar sensing, which causes degradation of the sensing performance. The detailed investigation will be provided in Section V.

IV. RECEIVER PROCESSING TECHNIQUES
A. Receiver Design for THz radar Sensing with the proposed MS-QP Sequence
For THz sensing applications using the proposed MS-QP sequence, which is generated by the transmitter architecture in Fig. 3, inverse operations can be performed at the receiver as shown in Fig. 7. Firstly, the received echo signal is down-converted and filtered to extract the signal components on each subband, which are then sampled by cost-efficient A/Ds with low sampling rate of 1/Tm for m = 0, 1, · · · , M -1, respectively, leading to reduced hardware cost. Afterwards, following the principle of MS-QP sequence construction introduced in Section III-A, the outputs of the M subbands are utilized to re-construct the digital form of the echoes for radar sensing, denoted as y[n] with sampling period Ts. In practical, the coherent processing interval (CPI) for radar sensing needs to be sufficiently long to enhance the SNR at the radar receiver against the severe path loss of THz channels, which is assumed to contain Q consecutive sequence transmissions. The corresponding q-th received subblock of length N for q = 0, 1, · · · , Q - 1,

19

... x[0] x[1]

x[N 1]

... y0[0] y0[1]

y0[N 1]

Corr.

Corr.

r0[0]

r1[0]

r0 [1]

r1[1]

... x[0] x[1]

x[N 1]

... yQ1[0] yQ1[1]

yQ1[N 1]

Corr.

rQ1[0] rQ1[1]

FFT FFT

Range-Doppler Matrix

Range

r0[N 1]

r1[N 1]

rQ1[N 1]

FFT

Doppler

N u Q0

Fig. 8. Receiver processing techniques for THz radar sensing, where "Corr." is referred to as the cyclic correlation operation.

denoted as yq = [yq[0], yq[1], · · · , yq[N - 1]], can be expressed by

I

yq[n]  hiµrx[n - i]ej(2(n+qN)vi) + w~q[n],

(26)

i=1

where hardware imperfections are omitted for brevity, and w~q[n] is the noise term. The received

subblocks are then employed for target detection via range-doppler-matrix-based (RDM-based)

algorithms [22]. To be more specific, as illustrated in Fig. 8, the cyclic cross-correlation between

each received subblock and the transmitted MS-QP sequence is firstly calculated as

N -1

rq[n] = yq[i]x[i - n], n = 0, 1, · · · , N - 1.

(27)

i=0

Then an FFT with size of Q0 = wQ (w is an arbitrary positive integer) is performed on the correlation values at time instant n, i.e., rq[n] for q = 0, 1, · · · , Q - 1, formulated as

Q-1

R(n, k) =

rq

[n]e-j

2qk Q0

,

q=0

(28)

which is defined as the (n, k)-th RDM element for n = 0, 1, · · · , N - 1 and k = 0, 1, · · · , Q0 - 1. Afterwards, R(n, k) is utilized for target detection via constant false alarm rate (CFAR)

20

approaches [42], written as

H1 :

R(n, k) ^(n, k)

2





H0

:

R(n, k) ^(n, k)

2

<

,

(29)

where H1 and H0 represent the hypothesis for the presence or absence of a target at the (n, k)-th cell, respectively. Besides, ^(n, k) and  denote the estimate of the average noise floor at the

(n, k)-th cell and the decision threshold. The readers are referred to [22] and the references

therein for more details.

For THz radar sensing applications, the MS-QP sequence suffers from strong doppler shift,

causing high sidelobes on the range profile, which could be wrongly detected as targets by the

classical CFAR approach if satisfying the hypothesis H1. To address this issue, the root indices

of

bm

(m

=

0, 1, · · · , M

- 1)

are

set

as

pm

=

Lm ±1 2

to

concentrate

the

dominant

sidelobes

closely around the main peaks on the range profile. Then a target detection criterion, named

as Target Exclusion nearby the Main Peak (TEMP), is proposed by assuming no other reflector nearby the detected target corresponding to the main peak at R(n^, k^), i.e., no target within the

interval [n^ - n¯, n^)  (n^, n^ + n¯]. Here n¯ is a positive integer parameter determined empirically.

By employing the proposed TEMP strategy, the procedure of target detection is modified as

Algorithm 1.

After target detection, the range and velocity estimates of the targets corresponding to I = {(n^0, kn^0), (n^1, kn^1), · · · , (n^I-1, kn^I-1)} obtained in Algorithm 1, denoted as d^i and u^i for i = 0, 1, · · · , I - 1, can be calculated by [22]

d^i

=

c0n^iTs 2

,

(30)

and



u^i

=

 c0k^n^i/(2Q0N fcTs), c0(k^n^i - Q0)/(2Q0N fcTs),

k^n^i

<

Q0 2

;

k^n^i



Q0 2

.

(31)

B. Receiver Design for THz-JRC Systems with the Proposed DE-MS-QP Waveform
Similar procedures can be employed to process the received DE-MS-QP signals for radar sensing, including low-rate A/D operations on each subbands and correlation-based RDM calculation, etc. In RDM calculation, one straightforward way is to directly perform the cyclic correlations of length N  = MN between the received signals and the extended MS-QP sequence. However, it suffers from large computational complexity for cyclic correlations, calculated as O((MN )2) in

21

Algorithm 1 Target Detection Algorithm based on the Proposed TEMP Strategy

Require: The RDM elements R(n, k), Estimates of the average noise floor at the (k, m)-th cell ^(k, m), the decision threshold , the positive integer parameter Q0, n¯ and N;
Ensure: The set I containing RDM coordinates of the detected targets determining their

corresponding round-trip delays and doppler shifts;

1: I = ;

2: for (n = 0; n  N - 1; n + +) do

3:

k^n

=

arg

max
0kn Q0 -1

R(n, kn)

;

4: end for

5: m = 0;

6: N (0) = {0, 1, · · · , N - 1};

7: repeat

8: n^(m) = arg max R(n, k^n) ;

nN (m)

9: 10:

if

 R(n^(m) ,k^n^(m) ) 2
^(n^(m),k^n^(m) )
I = I  {(n^(m),

 then k^n^(m) )};

11:

N - = n | n  [n^(m) - n¯, n^(m) + n¯] ;

12:

N (m+1) = N (m) \ N -;

13: else

14:

N (m+1) = N (m) \ {n^(m)};

15: end if
16: m + + 17: until (N (m) = ) 18: return I;

terms of complex multiplications, and cannot support flexible adjustment of M due to changes of the correlation length. To this end, each received DE-MS-QP frame is divided into M length-N subblocks, where cyclic correlation of length N between each subblock and the MS-QP sequence is directly applied. These correlation results are then utilized for radar sensing as described in Section IV-A, which is omitted for brevity. It is indicated that the proposed enhancement not only reduces the correlation complexity of the radar receiver to O(MN 2), but enables flexible parameter adjustment as well. Moreover, the cross-correlation between data components of the echoes and the MS-QP sequence is usually small when N is sufficiently large, as validated in Appendix A, thus posing marginal impact on radar sensing.
On the other hand, the embedded data symbols can be demodulated at the communication receiver without interference from sensing sequences, as presented in Fig. 9. Explicitly, the frequency-domain components on the m-th subband of the q-th received subblock can be obtained as Ym ,q = Ym ,q[0], Ym ,q[1], · · · , Ym ,q[Lm - 1] for q = 0, 1, · · · , Q-1 and m = 0, 1, · · · , M -1,

22

Y1c,m,q

Y2c,m,q

Ymc ,q

EQ

YcM c1,m,q Y0c,m,q
Channel Estimator

Lm -IFFT Lm -IFFT
Lm -IFFT

Phase Adjustment

ML Detector

Fig. 9. Demodulator diagram for each subband of the proposed DE-MS-QP waveform at the communication receiver. The frequency-domain equalizer is abbreviated as "EQ".
where both the radar sensing component is firstly extracted as

Y0 ,m,q = Ym ,q[0], Ym ,q[M ], · · · , Ym ,q[(Lm - 1)M ] ,

(32)

which could be employed for channel estimation to save additional overhead for pilot sym-

bols. With the knowledge of channel state information, the data components of the (M - 1)

data streams, denoted by Yi,m,q = Ym ,q[i], Ym ,q[M  + i], · · · , Ym ,q[(Lm - 1)M  + i] for i = 1, 2, · · · , M - 1, are equalized, and then transformed to time domain using Lm-IFFT operations,

yielding yi,m,q = yi,m,q[0], yi,m,q[1], · · · , yi,m,q[Lm - 1] , respectively. According to (18) and (23), phase adjustment is performed on each element of yi,m,q for i = 1, 2, · · · , M - 1, written

as

yi,m,q[n] = yi,m,q[n] × exp

j(

2in Lm

-

^m)

, n = 0, 1, · · · , Lm - 1,

(33)

which is finally demodulated with a maximum-likelihood (ML) detector.

V. NUMERICAL RESULTS
A THz-JRC system at 300 GHz carrier frequency is considered in this paper. Firstly, the feasibility of the proposed root index design for the MS-QP sequence together with TEMP strategy for THz radar sensing is evaluated via simulations. Afterwards, the accuracy of target ranging and velocity estimation is compared between the proposed waveforms and the classical counterparts, including ZC sequences [27] and LFM signals [43], where single-target scenario is assumed for simplicity. Moreover, the performance trade-off between radar sensing and communication of the proposed DE-MS-QP waveform is also explored numerically. In simulations, the symbol rate of different candidate sequences is assumed to be equal to the transmission bandwidth

23

false alarm rate

10 -3 10 -4 10 -5

Lm=10007, p m=3, SNR=-40 dB Lm=10007, p m=5003, SNR=-40 dB Lm=10007, p m=5004, SNR=-40 dB

10 -6

10 -7

20

40

60

80

100

120

140

Fig. 10. False alarm rate of THz radar sensing using MS-QP sequences with/without the proposed root index design, where the proposed TEMP strategy is applied for target detection in both cases.
according to the Nyquist theory. Furthermore, in order to simulate the fractional time delay and shaping filtering, 4-times upsampling is performed on the transmitted signals, where the roundtrip delay and low-pass filtering are imposed at the higher sampling rate. On the other hand, the echo signals at the receiver will be down-sampled to the original symbol rate for further radar detection [22]. The range and relative velocity of the targets are uniformly distributed in [0, 3] m and [-20, 20] m/s, respectively. Besides, for hardware imperfections, the random variation term for phase noise n follows Gaussian distribution written as N (0, (0.3)2), and the amplitude and phase imbalances are set as r = 0.2 and r = 10, respectively [21].
Figure 10 illustrates the false alarm rate of THz sensing with respect to  using the proposed MS-QP sequence and the TEMP detection strategy with n¯ = 40, with/without the proposed root index design against doppler shift, where the SNR at the radar receiver and the target velocity are set as -40 dB and 20 m/s, respectively. In simulations, the number of subbands for the proposed MS-QP sequence is set as M = 10, and lengths of the corresponding ZC subsequences are set as Lm = 10007 for m = 0, 1, · · · , 9. Besides, we assume that the MS-QP sequence is repetitively transmitted for Q = 100 times in each CPI. Then it is seen in Fig. 10 that, when pm = 3 for different ZC subsequences, there exists a severe floor of the false alarm rate as  increases, which is induced by the dominant range sidelobes from doppler shift effects. On the other hand, with the proposed root index design pm = 5003 or pm = 5004, the probability of false alarms declines rapidly with the increase of , both attaining significant performance gain of target detection over their counterpart. This shows superior robustness of the MS-QP sequence using

24

average absolute ranging errors (m)

10 2

proposed MS-NP, 10GHz

wide-band ZC (11077,5538), 10GHz

10 1

LFM, 10GHz

narrow-band ZC (1007,503), 1GHz

proposed DE-MS-QP, 10GHz 10 0

10 -1

10 -2

10 -3

10 -4

-70

-65

-60

-55

-50

-45

-40

SNR (dB)

Fig. 11. Performance comparison of target ranging between the proposed waveforms and their classical counterparts.

average absolute velocity error (m/s)

proposed MS-NP, 10GHz

10 2

wide-band ZC (11077,5538), 10GHz LFM, 10GHz

narrow-band ZC (1007,503), 1GHz

proposed DE-MS-QP, 10GHz

10 1

10 0

10 -1

10 -2

-70

-65

-60

-55

-50

-45

-40

SNR (dB)

Fig. 12. Performance comparison of target velocity estimation between the proposed waveforms and their classical counterparts.
the proposed root index design against doppler shift effects. Figures 11 and 12 present the accuracy comparison of the target ranging and velocity esti-
mation between the proposed MS-QP sequence and its classical counterparts, where each CPI contains Q = 1024 periodical sequence transmissions, and the duration per sequence transmission is fixed as 1.1077 µs. An MS-QP sequence of N = 11077 is considered, which is constituted by M = 10 identical ZC sequences with the length and root index equal to 1007 and 503, on different subbands divided by GIs of LG = 100, taking up 10-GHz bandwidth in total. On the other hand, ZC sequences and LFM signals are also considered for THz radar sensing: 1) a narrow-band ZC sequence of 1 GHz bandwidth, with the length and root index equalling 1007 and 503; 2) a wide-band ZC sequence of 10 GHz bandwidth, with the length and root index

25

average absolute ranging error (m)

102

SNR = -50 dB

101

SNR = -47 dB SNR = -44 dB

100

10-1

10-2

10-3

0.05

0.1

0.15

0.2

0.25

0.3

0.35

1/M'

Fig. 13. Ranging performance of the DE-MS-QP waveform with respect to 1/M  under different received SNRs.

equalling 11077 and 5538; 3) an LFM waveform of 10-GHz bandwidth, with pulse length of 1.1077 µs. It can be observed in Fig. 11 that, the MS-QP sequence is capable of significantly reducing the average ranging error by about 20 dB compared with the narrow-band ZC sequence, both using 1-GHz A/Ds at the SNRs over -55 dB. Besides, as is illustrated in Figs. 11 and 12, in comparison with the wide-band ZC sequences and LFM signals requiring expensive 10GHz A/Ds, the proposed MS-QP sequence is capable of achieving the same estimation error of target range and velocity, obtained as 0.004 m and 0.06 m/s over -55-dB SNRs, with the only need of cost-efficient 1-GHz A/Ds. Although the constant-amplitude property is lost compared with its classical counterparts, the proposed MS-QP sequence manages to attain an acceptable level of PAPR as 6.6 dB with the aid of phase rotation on different subbands, which achieves 7 dB PAPR reduction than that without phase rotation, calculated as 13.7 dB. Additionally, the sensing performance of the proposed DE-MS-QP waveform with M = 2 is also simulated, where QPSK is applied for modulation, and and Q = Q/M = 512 consecutive DE-MS-QP frames are contained in each CPI. Although the received SNR of the sensing sequences is degraded by 3 dB thanks to the embedded data consuming half of the transmit power, the proposed DEMS-QP waveform is still capable of attaining low estimation errors of target range and velocity, i.e., 0.004 m and 0.06 m/s at SNRs over -52 dB, which supports about ultra-high-rate data transmission of about 10 Gb/s simultaneously.
Figure 13 and 14 illustrate the sensing performance of the proposed DE-MS-QP waveform with respect to 1/M, which denotes the proportion of frequency resources distributed for radar

26

average absolute velocity error (m/s)

102 SNR = -50 dB
SNR = -47 dB
SNR = -44 dB 101

100

10-1

10-2

0.05

0.1

0.15

0.2

0.25

0.3

0.35

1/M'

Fig. 14. Velocity estimation performance of the DE-MS-QP waveform with respect to 1/M  under different received SNRs.
sensing. It is observed that, at the SNRs of -50 and -47 dB, the sensing performance is degraded with the decrease of 1/M when 1/M is smaller than 0.25 and 0.1, respectively, despite the enhanced communication spectral efficiency. This is due to the reduction of power supply for the sensing application. On the other hand, when 1/M is larger than 0.25 and 0.1 for SNR values of -50 and -47 dB, the estimation errors of target range and velocity will not deteriorate with the decrease of 1/M, remaining to be below 0.01 m and 0.1 m/s, respectively. Hence, it is concluded that there exists a unique threshold of M (or 1/M) for different received SNRs, i.e., 4 and 10 for -50 and -47 dB SNRs, where the performance of radar sensing will not be affected by the enlargement of M until exceeding the threshold. The threshold becomes larger with the increase of the received SNR, and even reaches over 20 at the SNR of -44 dB. Therefore, M could be optimized as this threshold value (determined numerically) in order to realize the best trade-off of frequency resource allocation, guaranteeing superior sensing performance and data throughput simultaneously. For instance, when the received SNR equals -47 dB, the proposed DE-MS-QP sequence is capable of achieving desirable estimation accuracy of target range and velocity with only 1/10 of the available frequency resources used for sensing, whilst the rest can be employed for high-rate data transmission which approaches 18 Gb/s with QPSK modulation.

VI. CONCLUSION To overcome the technical challenges of the convergence of THz radar sensing and communication, its waveform design is investigated in this paper. For sensing in TDD-based THzJRC systems, the MS-QP sequence with ultra-broad bandwidth is proposed by incorporating multiple ZC sequences on different subbands in the THz scale, whose transceiver architecture

27

is compatible with state-of-the-art subband filtered communication systems. The proposed MSQP sequence could achieve ultra-high-resolution sensing only with cost-efficient A/Ds with low sampling rate. Furthermore, to mitigate strong doppler shift effects on target detection, the root indices of ZC sequences on different subbands of the MS-QP sequence is designed to concentrate the dominant sidelobes closely around the main peak on the range profile. Then false alarms induced by doppler shifts can be eliminated by further invoking the TEMP strategy. Moreover, the DE-MS-QP waveform is developed based on the MS-QP sequence using time-domain extension operations, to support simultaneous radar sensing and data transmission, where both components are modulated on non-intersect frequency points, thus avoiding mutual interference.
Numerical results demonstrate the superiority of the proposed root index design for MSQP sequences in terms of false alarm rates, and that the proposed MS-QP and DE-MS-QP waveforms are capable of attaining ultra-high-resolution ranging and velocity estimation under extremely noisy environment. Meanwhile, more cost-efficient hardware is required compared with the classical counterparts with the same sensing performance. Moreover, a flexible resource allocation between the dual functions of the THz-JRC system is supported by the proposed DE-MS-QP waveform, where the optimal parameter design is obtained numerically enabling concurrent accurate target sensing and high-rate communication.

APPENDIX A CROSS-CORRELATION BETWEEN THE MS-QP SEQUENCE AND DATA SYMBOLS

The cross-correlation between the proposed MS-QP sequence and a length-N data sequence

modulated by PSK or QAM constellations, denoted as s = [s[0], s[1], · · · , s[N - 1]], can be

formulated as N -1

rsx[n] = s[k]x[k - n], n = 0, 1, · · · , N - 1.

(34)

k=0

By assuming that E( s[k] 2) = E( x[k - n] 2) = 1 without loss of generality and that N is

sufficiently large, the expectation of rsx[n] can be derived according to Jensen Inequality as

 N -1


N -1

E ( rsx[n] ) = E 

s[k1]x[k1 - n]

s[k2]x[k2 - n] 

k1=0

k2=0

(35)

E

N -1
s[k1]x[k1 - n]

N -1
s[k2]x[k2 - n]

 = N.

k1=0

k2=0

28
It is seen from the statistics of rsx[n] that, although range sidelobes are inevitably induced by the non-zero cross-correlation between the proposed MS-QP sequence and the data symbols, their magnitudes are negligible in comparison with the main peak when N is sufficiently large, which pose marginal impact on THz radar sensing.
REFERENCES
[1] H. Elayan, O. Amin, B. Shihada, R. M. Shubair, and M. Alouini, "Terahertz band: The last piece of RF spectrum puzzle for communication systems," IEEE Open J. Commun. Society, vol. 1, pp. 1­32, Jan. 2020.
[2] I. F. Akyildiz, J. M. Jornet, and C. Han, "Terahertz band: Next frontier for wireless communications," Phys. Commun., vol. 12, pp. 16­32, Jan. 2014.
[3] T. S. Rappaport et al., "Wireless communications and applications above 100 GHz: Opportunities and challenges for 6G and beyond," IEEE Access, vol. 7, pp. 78729­78757, 2019.
[4] W. Saad, M. Bennis, and M. Chen, "A vision of 6G wireless systems: Applications, trends, technologies, and open research problems," IEEE Netw., vol. 34, no. 3, pp. 134­142, May/Jun. 2020.
[5] K. Huang and Z. Wang, "Terahertz Terabit Wireless Communication," IEEE Microwave Mag., vol. 12, no. 4, pp. 108­116, Jun. 2011.
[6] K. Tekbiyik, A. R. Ekti, G. K. Kurt, and A. Gorcin, "Terahertz band communication systems: Challenges, novelties and standardization efforts," Phy. Commun., vol. 35, pp. 100700.
[7] Z. Chen et al., "A survey on terahertz communications," China Commun., vol. 16, no. 2, pp. 1­35, Feb. 2019. [8] F. Zhang, P. Zhou, S. Pan, and D. Zhang, "Terahertz generation by optically injected semiconductor laser for radar and
communication applications," J. Engineering, vol. 2019, no. 20, pp. 7193-7195, Nov. 2019. [9] C. Sturm and W. Wiesbeck, "Waveform design and signal processing aspects for fusion of wireless communications and
radar sensing," Proc. IEEE, vol. 99, no. 7, pp. 1236­1259, Jul. 2011. [10] A. R. Chiriyath, B. Paul, and D. W. Bliss, "Radar-communications convergence: Coexistence, cooperation, and co-design,"
IEEE Trans. Cognitive Commun. Netw., vol. 3, no. 1, pp. 1­12, Mar. 2017. [11] Z. Feng, Z. Fang, Z. Wei, X. Chen, Z. Quan, and D. Ji, "Joint radar and communication: A survey," China Commun., vol.
17, no. 1, pp. 1­27, Jan. 2020. [12] M. Scharrenbroich and M. Zatman, "Joint radar-communications resource management," in Proc. IEEE Radar Conf.,
Philadelphia, PA, May 2016, pp. 1­6. [13] S. Zhou, X. Liang, Y. Yu, and H. Liu, "Joint radar-communications co-use waveform design using optimized phase
perturbation," IEEE Trans. Aerospace Electron. Sys., vol. 55, no. 3, pp. 1227­1240, Jun. 2019. [14] Y. Cui, V. Koivunen, and X. Jing, "Interference alignment based precoder-decoder design for radar-communication co-
existence," in Proc. Asilomar Conference on Signals, Systems, and Computers, Pacific Grove, CA, Oct. 2017, pp. 1290­1295. [15] Y. Li, L. Zheng, M. Lops, and X. Wang, "Interference removal for radar/communication co-existence: The random scattering
case," IEEE Trans. Wirel. Commun., vol. 18, no. 10, pp. 4831­4845, Oct. 2019. [16] L. Zheng, M. Lops, Y. C. Eldar, and X. Wang, "Radar and communication coexistence: An overview: A review of recent
methods," IEEE Signal Process. Mag., vol. 36, no. 5, pp. 85­99, Sept. 2019. [17] C. Sturm, T. Zwick, and W. Wiesbeck, "An OFDM system concept for joint radar and communications operations," in
Proc. IEEE Veh. Technol. Conf. (VTC Spring 2009), Barcelona, Spain, Apr. 2009, pp. 1­5.

29
[18] M. Braun, C. Sturm and, F. K. Jondral, "Maximum likelihood speed and distance estimation for OFDM radar," in Proc. IEEE Radar Conf., Washington, DC, USA, May 2010, pp. 256­261.
[19] Y. Liu, G. Liao, J. Xu, Z. Yang and Y. Zhang, "Adaptive OFDM integrated radar and communications waveform design based on information theory," IEEE Commun. Lett., vol. 21, no. 10, pp. 2174­2177, Oct. 2017.
[20] B. M. Popovic, "Optimum sets of interference-free sequences With zero autocorrelation zones," IEEE Trans. Inf. Theory, vol. 64, no. 4, pp. 2876­2882, Apr. 2018.
[21] Y. R. Ramadan, H. Minn, and M. E. Abdelgelil, "Precompensation and system parameters estimation for low-cost nonlinear tera-hertz transmitters in the presence of I/Q imbalance," IEEE Access, vol. 6, pp. 51814­51833, Oct. 2018.
[22] Y. Zeng, Y. Ma, and S. Sun, "Joint radar-communication with cyclic prefixed single carrier waveforms," IEEE Trans. Veh. Technol., vol. 69, no. 4, pp. 4069-4079, Apr. 2020.
[23] P. Kumari, J. Choi, N. Gonzalez-Prelcic, and R. W. Heath, "IEEE 802.11ad-based radar: An approach to joint vehicular communication-radar system," IEEE Trans. Veh. Technol., vol. 67, no. 4, pp. 3012­3027, Apr. 2018.
[24] L. Tang, K. Zhang, H. Dai, P. Zhu, and Y. Liang, "Analysis and optimization of ambiguity function in radar-communication integrated systems using MPSK-DSSS," IEEE Wirel. Commun. Lett., vol. 8, no. 6, pp. 1546­1549, Dec. 2019.
[25] C. Lin and G. Y. Li, "Terahertz communications: An array-of-subarrays solution," IEEE Commun. Mag., vol. 54, no. 12, pp. 124­131, Dec. 2016.
[26] V. Petrov, et al., "On unified vehicular communications and radar sensing in millimeter-wave and low terahertz bands," IEEE Wirel. Commun., vol. 26, no. 3, pp. 146­153, Jun. 2019.
[27] M. H. AlSharif, et al., "Zadoff-Chu coded ultrasonic signal for accurate range estimation," in Proc. European Signal Processing Conference (EUSIPCO), Kos, Greece, Aug. 2017, pp. 1250-1254.
[28] D. Zhang, "Zero correlation zone sequences from a unified construction of perfect polyphase sequences," in Proc. IEEE International Symposium on Information Theory (ISIT), Paris, France, Jul. 2019, pp. 2269-2273.
[29] T. Mao, Q. Wang and Z. Wang, "Spatial Modulation for Terahertz Communication Systems With Hardware Impairments," IEEE Trans. Veh. Technol., vol. 69, no. 4, pp. 4553­4557, Apr. 2020.
[30] T. Mao, Q. Wang, and Z. Wang, "Receiver design for the low-cost Terahertz communication system with hardware impairment," in Proc. IEEE ICC 2020, Virtual Conference, Jun. 2020.
[31] C. Han, A. O. Bicen, and I. F. Akyildiz, "Multi-wideband waveform design for distance-adaptive wireless communications in the Terahertz band," IEEE Trans. Signal Process., vol. 64, no. 4, pp. 910­922, Feb. 2016.
[32] A. -A. A. Boulogeorgos, E. N. Papasotiriou, and A. Alexiou, "Analytical performance assessment of THz wireless systems," IEEE Access, vol. 7, pp. 11436­11453, Jan. 2019.
[33] W. Hou and M. Jiang, "Enhanced joint channel and IQ imbalance parameter estimation for mobile communications," IEEE Commun. Lett., vol. 17, no. 7, Jul. 2013.
[34] G. Colavolpe, A. Barbieri, and G. Caire, "Algorithms for iterative decoding in the presence of strong phase noise," IEEE J. Sel. Areas Commun., vol. 23, no. 9, pp. 1748­1757, Sep. 2005.
[35] I. Kallfass, et al., "64 Gbit/s transmission over 850 m fixed wireless link at 240 GHz carrier frequency," J. Infrared Millim. Terahertz Waves, vol. 36, no. 2, pp. 221­233, Jan. 2015.
[36] I. Kallfass, et al., "Towards MMIC-based 300GHz indoor wireless communication systems," IEICE Trans. Elect., vol. 98, no. 12, pp. 1081­1090, Dec. 2015.
[37] J. Grzyb, "A high-speed QPSK/16-QAM 1-m wireless link with a tunable 220 C260 GHz LO carrier in SiGe HBT technology," in Proc. International Conf. on Infrared, Millimeter, and Terahertz waves (IRMMW-THz), Sep. 2018.
[38] R. Frank, S. Zadoff, and R. Heimiller, "Phase shift pulse codes with good periodic correlation properties (corresp.)," IRE Trans. Inf. Theory, vol. 8, no. 6, pp. 381­382, 1962.

30
[39] D. Chu, "Polyphase codes with good periodic correlation properties (corresp.)," IEEE Trans. Inf. Theory, vol. 18, no. 4, pp. 531­532, 1972.
[40] E. Bjo¨rnson, M. Matthaiou, and M. Debbah, "A new look at dual-hop relaying: Performance limits with hardware impairments," IEEE Trans. Commun., vol. 61, no. 11, pp. 4512­4525, Nov. 2013.
[41] L. Zhang, A. Ijaz, P. Xiao, A. Quddus, and R. Tafazolli, "Subband filtered multi-carrier systems for multi-service wireless communications," IEEE Trans. Wirel. Commun., vol. 16, no. 3, pp. 1893­1907, Mar. 2017.
[42] M. Kronauge and H. Rohling, "Fast two-dimensional CFAR procedure," IEEE Trans. Aerospace Electron. Sys., vol. 49, no. 3, pp. 1817­1823, Jul. 2013.
[43] S. M. Patole, M. Torlak, D. Wang, and M. Ali, "Automotive radars: A review of signal processing techniques," IEEE Signal Process. Mag., vol. 34, no. 2, pp. 22­35, Mar. 2017.

