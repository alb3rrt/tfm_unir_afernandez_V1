Astronomy & Astrophysics manuscript no. Sabatini2021_HMSFRs June 3, 2021

©ESO 2021

arXiv:2106.00692v1 [astro-ph.GA] 1 Jun 2021

Establishing the evolutionary timescales of the massive star
formation process through chemistry
G. Sabatini1, 2, 3, , S. Bovino3, A. Giannetti2, T. Grassi4, J. Brand2, E. Schisano5, F. Wyrowski6, S. Leurini7, and K. M. Menten6
1 Dipartimento di Fisica e Astronomia "Augusto Righi", Universitá di Bologna, Via Gobetti 93/2, I-40129 Bologna, Italy e-mail: giovannisabatini4@unibo.it
2 INAF - Istituto di Radioastronomia - Italian node of the ALMA Regional Centre (It-ARC), Via Gobetti 101, I-40129 Bologna, Italy 3 Departamento de Astronomía, Facultad Ciencias Físicas y Matemáticas, Universidad de Concepción, Av. Esteban Iturra s/n Barrio
Universitario, Casilla 160, Concepción, Chile 4 Universitäts-Sternwarte München, Scheinerstr. 1, D-81679 München, Germany 5 INAF ­ Istituto di Astrofisica e Planetologia Spaziali (IAPS), via Fosso del Cavaliere 100, I-00133 Roma, Italy 6 Max-Planck-Institut für Radioastronomie, Auf dem Hügel, 69, D-53121, Bonn, Germany 7 INAF ­ Osservatorio Astronomico di Cagliari, Via della Scienza 5, I-09047 Selargius (CA), Italy
Received February 1, 2021; accepted May 31, 2021
ABSTRACT
Context. Understanding the details of the formation process of massive (i.e. M 8-10M ) stars is a long-standing problem in astrophysics. They form and evolve very quickly and almost their entire formation process takes place deeply embedded in their parental clumps. This, together with the fact that these objects are rare and at a relatively large distance, make their observations very challenging. Aims. We present a method to derive accurate timescales of the different evolutionary phases of the high-mass star formation process. Methods. We model a representative number of massive clumps of the ATLASGAL-TOP100 sample which cover all the evolutionary stages. The models describe an isothermal collapse and the subsequent warm-up phase, for which we follow their chemical evolution. The timescale of each phase is derived by comparing the results of the models with the properties of the sources of the ATLASGALTOP100 sample, taking into account the mass and luminosity of the clumps, and the column densities of methyl acetylene (CH3CCH), acetonitrile (CH3CN), formaldehyde (H2CO) and methanol (CH3OH). Results. We find that the chosen molecular tracers are affected by the thermal evolution of the clumps, showing steep ice evaporation gradients from 103 to 105 AU during the warm-up phase. We succeed in reproducing the observed column densities of CH3CCH and CH3CN, while H2CO and CH3OH show a poorer agreement with the observed values. The total (massive) star formation time is found to be 5.2×105 yr, which is defined by the timescales of the individual evolutionary phases of the ATLASGAL-TOP100 sample: 5 × 104 yr for 70-µm weak, 1.2 × 105 yr for mid-IR weak, 2.4 × 105 yr for mid-IR bright and 1.1 × 105 yr for HII-regions phases. Conclusions. Our models, with an appropriate selection of molecular tracers that can act as chemical clocks, allow to get robust estimates of the duration of the individual phases of the high-mass star formation process, with the advantage of being capable to include additional tracers aimed at increasing the accuracy of the estimated timescales.
Key words. Stars: formation ­ stars: massive ­ stars: evolution ­ astrochemistry ­ ISM: molecules ­ ISM: evolution

1. Introduction
Although high-mass stars (i.e. M 8-10M ) are much more rare than their less massive counterparts, they have a critical impact on the physico-chemical characteristics of the interstellar medium (ISM), playing an important role also on the evolution of the host galaxies (e.g. Kennicutt 2005). Massive stars are responsible for the production of large amounts of the -elements involved in the formation of complex molecules (Woosley & Weaver 1995; Kobayashi et al. 2020), created during the final stages of their life-cycle via core-collapse supernovae (e.g. Smartt 2009). They also dominate the energy budget in their immediate surroundings by stirring, heating and ionising the gas, and affect the chemical evolution of the ISM, as well as the starand planet-formation process (e.g. Elmegreen 1998; Bally et al. 2005; Adams 2010). However, observing massive stars is chal-
Marco Polo fellowship of the University of Bologna;

lenging as they evolve quickly, and the initial stages of their formation process take place when their progenitors are still embedded in the parental clump (Zinnecker & Yorke 2007; Motte et al. 2018, for reviews on this topic). In spite of the efforts made in recent years to understand the formation of massive stars, there are still some fundamental questions that remain unanswered. One of these is related to the timescales of the various (evolutionary) phases of their formation process, which would provide crucial information in distinguishing among competing star formation theories (e.g. McKee & Tan 2002; Mouschovias et al. 2006; Hartmann et al. 2012; Tigé et al. 2017; Padoan et al. 2020), and in reaching a comprehensive view of the chemical evolution of the gas that resides in the parental clumps of massive stars.
Timescales are usually derived by applying statistical approaches (e.g. Wood & Churchwell 1989; Davies et al. 2011; Mottram et al. 2011; Battersby et al. 2017; Tigé et al. 2017; see also Motte et al. 2018), with typical values for the total massive star formation timescale ranging between (1-5) × 105 yr.

Article number, page 1 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

The statistical lifetime of a phase is consequently obtained as the fraction of the total time equal to the number of objects in that phase with respect to the total number of objects. These methods, however, depend on the assumption of a total time for the star formation process, constrained by simulations (e.g. Davies et al. 2011) or derived with respect to the known age of OB-stars (e.g. Wood & Churchwell 1989; Motte et al. 2007; Russeil et al. 2010; Mottram et al. 2011; Tigé et al. 2017).
An alternative way to quantify the timescales of the various steps is to look at the effects that massive young stellar objects (YSOs) have on their immediate surroundings. The chemical evolution is affected by changes in density and temperature induced by the forming stars. During the so-called warm-up phase (e.g. Viti & Williams 1999; Viti et al. 2001; Garrod et al. 2008), molecules formed on the surface of the dust grains are rapidly released into the gas phase, increasing their observed abundance by several orders of magnitude (Viti et al. 2004; Garrod & Widicus Weaver 2013; Choudhury et al. 2015). Thus, the molecular composition of the material around YSOs contains information about the physical conditions of their past (van der Tak 2005). A well-known example are the rich molecular spectral features produced by hot molecular cores (HMCs), compact regions around YSOs ( 0.1 pc radius; Kurtz et al. 2000; Cesaroni 2005).
Chemical tracers that show a relation between their observed abundances and the different phases of the star formation process are commonly called chemical clocks (e.g. Fontani et al. 2007; Beuther et al. 2009; Hoq et al. 2013; Giannetti et al. 2019; Urquhart et al. 2019; Sabatini et al. 2020, as some recent examples; see also van Dishoeck & Blake 1998 for a review). Through the comparison of their observed abundances obtained from large samples of massive clumps at different evolutionary stages, and those predicted by accurate time-dependent chemical models, it is possible to quantify the timescales of each stage. An attempt to adopt this kind of analysis was carried out by Gerner et al. (2014), based on the chemical properties of a sample of 59 massive clumps in different evolutionary stages, and modelling the warm-up phase only. The temperature and density radial profiles were assumed to be static with time, and described as power laws with the average properties of each evolutionary class (see their Sect. 5.1.1 for more details). The chemistry was then evolved in time until they found the best match with the average observed abundances, and they interpreted that as the typical age of each class. Based on these results, Gieser et al. (2019) studied the chemical history of the HMC VLA 3 in the high-mass star-forming region AFGL 2591, to assess the effects of different initial chemical conditions on the model results and on the derived evolutionary timescales, showing that the latter are sensitive to the model assumptions. More recently, Gieser et al. (2021) used the same method to investigate 22 cores identified in 18 high-mass star-forming region with ALMA.
An alternative to the aforementioned approaches is to adopt a time-dependent analytical function of the temperature to simulate the gradual warming-up of the clumps in a range of typical observed values (i.e. 10-300 K; e.g. Viti & Williams 1999; Garrod & Herbst 2006). Awad et al. (2010) proposed an improved model of the warm-up phase applied to the low-mass regime, where the temperature evolution was based on the radiative transfer (RT) calculation of Nomura & Millar (2004). More recently, Bonfand et al. (2019) described the evolution of the physical parameters of the high-mass star-forming region Sgr B2 with 3D-RT simulations. They followed the trajectory of a parcel of gas under free-fall collapse and modelled its chemistry by updating the temperature and density of the gas. In this paper, we have developed a model similar to Bonfand et al. (2019), by

employing a time dependent description of the thermal evolution of massive clumps during the warm-up phase, with the aim to propose a new method to derive the evolutionary timescales of the massive star formation process.
This paper has the following structure: in Sect. 2 we present the reference sample of massive clumps, the evolutionary sequence and the chemical tracers employed to derive the duration of each phase. The model and the chemical network are described in Sect. 3. In Sect. 4, we present our results, the postprocessing procedure and the derivation of the durations of each evolutionary phase. In Sect. 5, we discuss our estimates and how the selected tracers are reproduced by the models, providing information on the reliability of the used chemical clocks. Finally, in Sect. 6 we summarise our conclusions.
2. Reference sample and selected tracers
The survey used to define the reference sample and the evolutionary stages of the massive star formation process is the APEX1 Telescope Large Area Survey of the Galaxy (ATLASGAL; Schuller et al. 2009). ATLASGAL offers a complete view of the high-mass star-forming regions in the inner Galaxy at 870 µm, and provides the ideal basis for detailed studies of a large number of massive clumps in different evolutionary stages, with the unprecedented angular resolution of 19 (Contreras et al. 2013; Csengeri et al. 2014; Urquhart et al. 2013). Estimates of luminosities, masses, kinematic distances and dust temperature (Urquhart et al. 2014, Wienen et al. 2015 and Urquhart et al. 2018) have been derived for more than 104 dust clumps.
Using the unbiased nature of ATLASGAL, the ATLASGALTOP100 sample (hereafter TOP100) has been defined, as a fluxlimited sample of high-column density clumps, selected with additional infrared (IR) criteria to include sources potentially covering the whole spectrum of ages (see Giannetti et al. 2014). The number of sources included in the TOP100 was slightly refined by König et al. 2017, and to date, it includes 111 clumps. Combining the IR properties of the massive clumps in the TOP100 sample with radio-continuum measurements at 5-9 GHz, the objects were divided into the following four evolutionary classes (Giannetti et al. 2014; König et al. 2017): (1) 70-µ weak, stage (70w; i.e. quiescent): constituted by sources undetected at 24 µm and showing no clear compact emission of 70 µm (or seen in absorption at this wavelength). This stage represents the earliest phase of massive-star formation, potentially including starless or prestellar cores; (2) Mid-IR weak stage (IRw; protostellar): composed by compact and visible sources at 70 µm, undetected at 24 µm or associated with a weak IR source (<2.6 Jy fluxes), and associated to young clumps likely dominated by cold gas; (3) MidIR bright stage (IRb; high-mass YSOs): sources showing strong mid-infrared emission at 8 and 24 µm, that was interpreted as the consequence of the progressive dust heating induced by the forming (proto-)star(s); (4) HII regions (HII): bright at 70 and 24 µm, and detected in radio continuum at 5-9 GHz (HII).
Through the sample, the clump masses range from 18 to 5×104 M . The bolometric luminosities are between 60 and 4×106 L , and correspond to a range of luminosity-to-mass ratio (L/M) of 0.2-350 L /M . All the TOP100-clumps have the potential of forming high-mass stars and show no bias in terms of distance or mass between the aforementioned evolutionary classes (Giannetti et al. 2014; König et al. 2017).
1 Atacama Pathfinder EXperiment 12 meter submillimeter telescope (Güsten et al. 2006)

Article number, page 2 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

Fig. 1: Sketch of the physical model employed in this work. Left panel: collapse phase (see Sect. 3.1.1) solved in a single-zone approximation. The chemical output of Phase-I is used as initial condition of the Phase-II. Central panel: warm-up phase solved in a 1D-approximation from 1 to 105 AU (see Sect. 3.1.2). Right panel: post-processing applied to compare the final chemical outputs of Phase-II with the column densities observed in the TOP100 (see Sections 4.1 and 4.2). The physical parameter assumed in Phase-I and II are summarised in Tab. 1. The time evolution of the model is indicated by the blue dotted arrows.

Four molecular tracers were carefully studied with the APEX telescope in the TOP100 sample, revealing their potential of chemical clocks: formaldehyde (H2CO; Tang et al. 2018), methyl acetylene, acetonitrile and methanol (CH3CCH, CH3CN and CH3OH, respectively; Giannetti et al. 2017). The detection rates, the abundances and the excitation temperatures derived from each molecular species increase with the L/M of the clumps, which is known to trace the evolution of the star formation process (Saraceno et al. 1996; Molinari et al. 2008; Urquhart et al. 2018). With respect to the line-of-sight (LOS) and beam-averaged column densities reported by Giannetti et al. (2017) and Tang et al. (2018) we calibrated our method to estimate the duration of the four evolutionary phases defined in the TOP100 sample, proposing a general pipeline of comparison between models and observations that can be expanded with additional tracers in future follow-ups.
3. Methods
In this section we present the model developed to describe the time evolution of the abundances of the selected molecular tracers in the TOP100 survey (see Sect. 2).

single-zone approximation, exploring different conditions as in e.g. Viti & Williams (1999) and Garrod & Herbst (2006). In the second phase, the warm-up (central panel of Fig. 1), the gas and dust temperatures (assumed to be in equilibrium) evolve as a function of time, driven by the luminosity of the central forming protostar. The temperature profiles are computed with the radiative transfer code Mocassin (see Ercolano et al. 2003, 2005), while the mass distribution of the clump is described by a static gas radial density profile (e.g. Tafalla et al. 2004).
In the following Sections we describe the details of each phase while the specific details of the RT calculations will be presented in a forthcoming paper (Grassi et al. in prep.).

3.1.1. Phase-I: isothermal collapse

The first phase of the model simulates a semi-analytical singlezone isothermal collapse (see Spitzer 1978; Brown et al. 1988; Viti & Williams 1999). The gas number density, nH, at the centre of the clump, evolves with time as

dnH(t) = b · dt

nH(t)4 nH,0

1/3 



C 

nH,0



nH(t) nH,0

1/3 1/2 - 1

,

(1)

3.1. Physical model
Our physical model comprises two distinct stages, sketched in Fig. 1. The first, namely the collapse (left panel of Fig. 1), describes the density evolution of an isothermal clump with a

where nH,0 is the initial central gas number density, b the timescale of the collapse with respect to the free-fall time (i.e. b = 1), C = 24GmH, G is the gravitational constant and mH the hydrogen mass. Eq. 1 is obtained assuming the conservation
of mass during an isothermal contraction of a spherical clump
(Spitzer 1978).

Article number, page 3 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

Table 1: Parameters space explored in our models; i.e. Phase-I (Sect. 3.1.1) and Phase-II (Sect. 3.1.2).

3.5

Parameter

Values

Unit

(1) b
(2) nH(r0) (3) Rc (4) M

1; 0.5; 0.1 105; 106; 107; 108
104; 104.5; 105 10-5; 10-3

- cm-3 AU M yr-1

We set the initial gas number density to the typical values of a clump, nH,0 = n(H) + 2n(H2) = 104 cm-3 (Bergin & Tafalla 2007; Gerner et al. 2014). The collapse assumes a constant tem-
perature of 15 K (both for gas and dust temperatures; e.g. König et al. 2017) and a visual extinction Av = 10 mag (e.g. Semenov et al. 2010; Reboussin et al. 2014). The cosmic ray ionisation rate of hydrogen molecules is set to 2 = 5 × 10-17 s-1, as observationally constrained by van der Tak & van Dishoeck (2000)
in high-mass star-forming regions, and in agreement with the re-
sults reported by Sabatini et al. (2020). The specific density of the dust grains is 0 = 3 g cm-3, typical of silicates (e.g. Draine & Lee 1984), the dust-to-gas ratio D = 10-2, and we use a constant grain size a = 0.1 µm. The gas mean molecular weight is µ = 2.4.
To simulate various physical conditions for the environment
where the seeds of massive protostars are formed, the collapse is stopped at different final densities nH(r0) (see Fig. 1), observationally constrained (Tab. 1; e.g. Mueller et al. 2002; Sabatini
et al. 2019) and then used as central densities during the warm-
up phase.

3.1.2. Phase-II: the warm-up phase

The second phase of the model, sketched in the central panel of Fig. 1, simulates the warm-up induced by a protostar at the centre of a spherical clump by using a 1D-approximation of 100 logarithmic radial steps from 1 to 105 AU (i.e. up to a typical clump size of 0.5 pc; e.g. Motte et al. 2018).
The mass distribution of the core is described by the gas radial density profile (e.g. Tafalla et al. 2002, 2004)

nH(r)

=

nH(r0)

Rc5/2 Rc5/2 + r5/2

,

(2)

where nH(r0) is the central number density at r0, at which the Phase-I is stopped (see second row in Tab. 1). This ensures the
continuity between the two physical phases of the model. In Eq. 2, Rc is the core radius, i.e. the radius at which nH(Rc) = 0.5 nH(r0). The slope 5/2 is in agreement with the observations in massive star-forming regions (e.g. Mueller et al. 2002; Schneider
et al. 2015), while similar profiles were successfully applied to
model the H2 distribution in both clumps and filamentary structures (e.g. Beuther et al. 2002a; Arzoumanian et al. 2011; André
et al. 2016; Sabatini et al. 2019). Alternatively, power laws pro-
files can be assumed to model the H2 distribution especially on the clumps scale (e.g. Gieser et al. 2021), providing minor differences in the final clump mass (a factor of 2 smaller for a slope of 5/2).
The physical parameters of Phase-II (i.e. 2, D, µ, and a ) are assumed the same as those of the collapse

log(Td/K)

3.0

2.5

2.0

1.5

t2 = 5 kyr; L(t2) = 103.4 L t2 = 10 kyr; L(t2) = 104.1 L

t2 = 50 kyr; L(t2) = 105.8 L

0

1

2log(R/AU)3

4

5

Fig. 2: Dust temperature radial profile at different times, for an arbitrary model with gas number density profile described by Eq. 2 and Rc = 104.5 AU and nH(r0) = 107 cm-3. With time, the Td increases driven by the protostar's luminosity. The flat inner part represents the sublimation of the dust grains. The minimum temperature is set to 15 K, to ensure continuity with the collapse phase.

phase, while the visual extinction at each radius r, is Av(r) = N(H, r)/(2 × 1021 cm-2), where N(H, r) is the column density of the hydrogen nuclei, obtained integrating Eq. 2 from the edge of the clump (e.g. Tielens 2010; Zhu et al. 2017). We take the final abundances of Phase-I as initial chemical conditions for each radial grid point of the Phase-II rescaled by the density profile. The chemistry was evolved in time, assuming that the individual cells are independent throughout the entire time evolution.
To model the thermal evolution of the clump during the warm-up phase we generate a set of models with different density distributions and protostar luminosities by employing the Monte Carlo radiative transfer code Mocassin. The models provide an interpolable look-up table Td(r, t2) = fb[Rc, nH(r0), L(t2), r], where L(t2) is the luminosity of the protostar and t2 the time spent since the start of the warm-up phase. The function that describes how L(t2) evolves in time is derived by Hosokawa & Omukai (2009) and depends on the assumed protostar's mass accretion rate, M . Based on the very few observational estimates (e.g. Beuther et al. 2002b; Herpin et al. 2012; Wang et al. 2013) we explore two typical cases, i.e. M = 10-5 M yr-1 and M = 10-3 M yr-1 (see Figures 4 and 12 in Hosokawa & Omukai 2009). These values are also in agreement with the results of Peters et al. (2011), that simulated the collapse of a magnetised rotating molecular cloud of 1000 M . During Phase-II, we assume that the gas radial density profile of the clump and its dust content remain constant over time so that the mass accretion rate of the protostar is completely balanced by the average infall rate observed in a massive clump (e.g. Schneider et al. 2010; Peretto et al. 2013; Wyrowski et al. 2016; Liu et al. 2018).
Analogously to Phase-I, we assume that the gas and dust temperatures are in equilibrium; this assumption is less accurate at small radii (i.e. 50 AU) where the temperatures are close to the dust sublimation limit, and at large radii (i.e. 105 AU), where the gas-dust collision term is subdominant with respect to the radiation coupling (Draine 2011). However, both these regions are not relevant in our analysis and do not affect our findings. An example of how the Td radial profile evolves is shown in Fig. 2, for three (typical) times, M = 10-3 M yr-1 and for the

Article number, page 4 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

Table 2: Summary of the total masses of each model. The models with masses smaller than the lowest mass associated with the TOP100 sources (König et al. 2017), and marked in boldface, are excluded.

Table 3: Summary of fiducial initial elemental abundances, ni, with respect to the abundance of H-nuclei, nH. The "A(-B)" notation assumed in the table, means "A×10-B".

nH(r0)
[cm-3]
105 106 107 108

104
0.4 M 3.5 M 34.7 M 346.6 M

Rc/AU 104.5
3.8 M 38.4 M 383.7 M 3836.7 M

105
18.5 M 184.6 M 1846.8 M 18468.2 M

species
H2 He O CO N N2 Mg

(ni/nH)t=0
5.00(-1) 1.00(-1) 1.36(-4) 1.20(-4) 1.05(-5) 5.25(-6) 2.55(-6)

species
Si S Fe P Na Cl H+3

(ni/nH)t=0
1.95(-6) 1.50(-6) 7.40(-7) 2.30(-8) 2.00(-8) 1.40(-8) 3.18(-9)

following parameters Rc = 104.5 AU and nH(r0) = 107 cm-3. For a qualitative comparison of the Td radial profiles shown in Fig. 2 we refer to the recent results of Gieser et al. (2021), where the temperature structure of 18 massive star-forming regions have been derived based on two of the four tracers considered in this work (i.e. H2CO and CH3CN; Sect. 2). In this case, the authors assumed a power-law (i.e. T (r)  r-q; see their eq. 1) to fit the radial temperature in each source, providing an average slope of |q| = 0.4 ± 0.1. Our profiles in Fig. 2 show a similar slope (|q|  0.5), at distances larger than the dust sublimation radius (i.e. the flat region in the same figure) and comparable temperatures at their fiducial radius (see Tab. 3 in Gieser et al. 2021). A more detailed description of the influence of L(t2) and nH(r) on Td(r, t2) will be discussed in a forthcoming paper (Grassi et al. in prep.).
To compare our results with the observed properties of the TOP100 clumps (Giannetti et al. 2014; König et al. 2017), we evolve one model for each mass in Tab. 2 - derived from nH(r0) and Rc in Tab. 1 - varying the values of b and M in Tab. 1. We consider only clumps with a total mass larger than 15 M , that is the smallest mass associated with a TOP100 source, for a total of 54 models.

3.2. Chemical model

The chemical evolution of a massive clump (i.e. the collpase
and the warm-up phases) is described by employing the publicly available time-dependent code Krome2 (Grassi et al. 2014).
Adsorption and desorption3 processes are included as in
Hasegawa et al. (1992) and Hasegawa & Herbst (1993). Surface
reactions between two species i and j follows Semenov et al. (2010), where the rate coefficient, in units of cm3 s-1, is

kisj

=

Pi j(kdi iff + kdjiff ) Nsitesnd

,

(3)

with kdi iff = 0i exp(-Tdiiff/Td) the diffusion via thermal hopping (Tdiiff = 0.77Tbi ; Semenov et al. 2010), Td is the dust temperature, 0i = (2nSEbi /2mi)1/2 the characteristic Debye vibration frequency for the adsorbed species, nS = 1.5 × 1015cm-2 the surface density of binding sites, mi is the mass of the species, and Ebi = kBTbi the binding energy of the ith species on the binding site. In Eq. 3, nd = DnHmHµ/Md is the dust number density,

2 https://bitbucket.org/tgrassi/krome/wiki/Home 3 We include thermal and cosmic-ray induced desorption.

where Md = 4/30 a 3 is the dust mass, while the total number of binding sites of a grain Nsites = 4 a 2 /a2pp assumes an average distance between two contiguous sites of app = 3 Å (Hocuk & Cazaux 2015).
The probability for a reaction to occur is Pi j = i j exp(-Ea/kBTd), where Ea is the activation energy of the reaction and i j a parameter that depends on the number and on the type of species in the reaction. In the case of exothermic reactions (i.e. Ea = 0): (I) if i j, Pi j = 1; (II) if i = j, Pi j = i j = 1/2. For endothermic reactions (i.e. Ea 0), i j is the inverse of the number of paths in the branching ratios.
The final chemical network is derived from Semenov et al. (2010)4, and contains 654 chemical species and 5869 gas-phase, gas-grain and grain surface reactions. The photochemical rate coefficients follow the Av formalism as in Draine (1978) (see KIDA5). In order to ensure that each depleted species is released into the gas phase, we modified the original network by adding 70 missing desorption processes, with the binding energy values updated to the most recent estimates in KIDA (see Tab. A.1 and Tab. A.2 for the reactions, and Appendix B for the network benchmark).
The abundances of chemical species evolve with time, starting from the assumed initial conditions following the recent large-scale simulations of molecular clouds (e.g. Hocuk et al. 2016; Clark et al. 2019), showing that CO is already formed at densities of few × 103 cm-3. Following these findings we assume H, C, and O to be in molecular form. In particular the abundances of H2, H+3 , He, N, O, CO, and N2 are taken from Bovino et al. (2019), while for the other elements we refer to Garrod & Herbst (2006), as reported in Table 3.
4. Results
An example of the chemical evolution of some observed species during the Phase-I is reported in Appendix C, while here we focus on the Phase-II and the comparison with observations. However, since the outcome of Phase-I represents the initial chemical conditions for Phase-II, a few considerations on the Phase-I should be made. The fractional abundances are considerably influenced by the dynamics of the collapse, showing a difference up to 3 orders of magnitudes between the fastest (b = 1) and
4 Ohio StateUniversity (OSU) chemical network, version March 2008 (http://www.mpia.de/homes/semenov/Chemistry_benchmark/ model.html) 5 http://kida.astrophy.u-bordeaux.fr/

Article number, page 5 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

log(R/AU)

log(R/AU)

log[n(X)/nH]

5.0

16
H2CO

15

14

13

12 11
(g)H2CO

10

9

8

4.5

25 K

4.0

50 K

25 K 50 K

3.5

200 K

200 K

35..00

100 K CH3OH

100 K (g)CH3OH

4.5

25 K

4.0

50 K

25 K 50 K

3.5

200 K

200 K

35..00

100 K CH3CN

100 K (g)CH3CN

4.5

25 K

4.0

50 K

25 K 50 K

3.5

200 K

200 K

35..00

100 K CH3CCH

100 K (g)CH3CCH

4.5

25 K

4.0

50 K

25 K 50 K

3.5

200 K

200 K

3.0 100 K
3.0 3.5 4.0 4.5 log(t2/yr)

100 K
3.0 3.5 4.0 4.5 log(t2/yr)

log(R/AU)

log(R/AU)

Fig. 3: Temporal and radial evolution of the abundances of the tracers observed in the TOP100 (Giannetti et al. 2017; Tang et al. 2018) during the warm-up phase, both in gas-phase (left panels) and on dust (right panels), for the same reference model as in Fig. 2. White contours indicate the temperature computed with Mocassin. Red curves corresponds to the evaporation front of the given tracer.
Article number, page 6 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

16 (a)

Rc4.0_nc7 Rc4.0_nc8

Rc4.5_nc6 Rc4.5_nc7

Rc4.5_nc8 Rc5.0_nc5

Rc5.0_nc6 Rc5.0_nc7
16 (b)

Rc5.0_nc8

log[N(CH3CCH)/cm 2] log[N(CH3CCH)/cm 2]

15

15

C

14

14

B

13

A

13

12

12

11

102.0

2.5

3.0 log(t32./5yr) 4.0

4.5

11

A B

C

100.0 0.1 0.2R/pc0.3 0.4 0.5

Fig. 4: Panel (a): Example of the line-of-sight gas-phase column density profiles obtained at the end of the post-processing described in Sect. 4.1 for models with b = 1 and M = 10-3 M yr-1 and for an arbitrarily chosen source at a distance of 3.5 kpc. For the U_W
items in the legend U and W are respectively Rc (colors) and nH(r0) (styles). Panel (b): Radial distribution of the gas-phase column densities extracted at the positions A, B and C in Panel (a), i.e. the same times of Fig. 2. Both the panels are shown in log-log scale.

the slowest (b = 0.1) collapse, even if the global trend remains generally unaltered (more details in Appendix C). Given the continuity between Phase-I and Phase-II, the final effect that b has on the models is to provide different inputs for the warm-up phase. For this reason, we run the Phase-II for each of the 54 models defined by the parameter space, taking into account the effect of the parameter b on the second phase of the model (see also Sect. 3.1.2).
Fig. 3 shows the abundances of H2CO, CH3CCH, CH3CN and CH3OH, as a function of time and distance both in the gas-phase (left panels) and on grains (right panels; labelled `(g)'), as a result of Phase-II. The white contours show the temperature, while the red curves the evaporation fronts, namely the distance from the protostar at which the desorption time scale of a given species (defined as the inverse of the desorption rate, involving both the thermal and the cosmic-ray induced desorption; Semenov et al. 2010) is smaller than the dynamical timescale of the model. As a consequence, at distances larger than the evaporation front, the abundances of the tracers on dust grains (Fig. 3) rapidly increase. At the same time, at these distances the temperatures are low enough to enhance two-body reactions on the surface of dust grains. Hydrogenation chains play a major role in the formation of CH3CCH, CH3CN, and H2CO on dust grains, while methanol is also formed through the reaction (g)CH3 + (g)OH  (g)CH3OH.
Each evaporation fronts grows as a function of time following the temperature evolution and ranges between 103 and 105 AU. Our findings are in agreement with Choudhury et al. (2015), where the efficiency of the evaporation as a function of the thermal evolution of the clump is responsible for evaporation scales similar to ours (see their Fig. B1).

4.1. Post-processing of the models' outputs
The chemical structure of each clump has been reconstructed assuming that each radial profile from Phase-II (i.e. each column in the relative abundance maps in Fig. 3) represents a radius of a spherically symmetric clump. For each profile we generated a data cube of 150×150×150 pixels at a resolution of 103 AU/pixel, which corresponds to one-half of the size of the smallest evaporation front radius in Fig. 3, in order to always sample the region at which the gas-phase abundances are enhanced by the desorption of the products of dust-phase chemistry. The column density maps of each tracer are then obtained by integrating the abundances along the LOS, applying for each tracers a convolution to the APEX resolution of the observed transitions6 (see Appendix D), and taking into account the different distances of the TOP100 objects. The final column density profile of a given tracer X, Nmod(X), is calculated along the LOS at the centre of the clump.
With respect to the aforementioned procedure, CH3OH and CH3CN required an additional constraint to reproduce the observed higher-K lines. In fact, in their spectral fit, Giannetti et al. (2017) distinguish the hot and cold components, assuming two domains separated at 100 K and providing the individual column densities. Following the same approach provides additional constraints to reduce the uncertainties and to test the reliability of the temperature of the background model, especially in the innermost part of the clump. After reconstructing the spherical distribution of CH3CN and CH3OH, we applied a 100 K
6 This step was done using the fft2 function of numpy.fft: https://numpy.org/doc/stable/reference/generated/ numpy.fft.fft2.html

Article number, page 7 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

log10[(PM PL)/ max]

temperature-mask, taking into account only the regions where T > 100 K, to generate the averaged column densities profiles
of the hot components only.
As an example, we report the final gas-phase CH3CCH profiles in Fig. 4a, obtained assuming a distance of 3.5 kpc (arbi-
trarily chosen) to apply the post-processing. We show the results for M = 10-3 M yr-1 and for the standard free-fall collapse model (i.e. b = 1), and we note that the nH(r0) is the parameter that mostly influences the evolution of Nmod(CH3CCH).
This behaviour is the consequence of two combined effects. First, the initial abundances of the warm up phase are scaled
by the density profile of each model, and thus, models with
larger values of nH(r0) have larger initial column densities (see Fig. B.2). Second, the different thermal structure of the clumps have a strong impact on the chemical evolution. At a given time,
the average temperature along the LOS is lower in clumps with
larger nH(r0), as the radiation of the protostar is more attenuated. Since the luminosity of the protostar increases with time and affects the temperature of the surrounding gas, the evaporation front grows and consequently the amount of chemical species
released into the gas. In Fig. 4b we show the radial profile of
gas-phase N(CH3CCH) at three times (A,B, and C in panel a). The column density of this species increases by about one order
of magnitude over time, caused by the expanding evaporation
front, and by the decrease of the CH3CCH adsorption rate in the outer parts of the model. The adsorption process is directly proportional to the density, which drops at r > Rc (Fig. 3). This also provides an explanation for the observed increasing trend in the
gas-phase CH3CCH abundance with the evolutionary stage of massive clumps (e.g. Molinari et al. 2016; Giannetti et al. 2017).

4.2. Comparison of the modelled column densities with sources from TOP100 sample

To infer the ages of the clumps and the relative duration of the
evolutionary phases in the TOP100 sample, we compare the
column densities derived from the observations (Appendix D
and Tab. D.1) with those from our post-processed models. For a given clump the dataset, D = {L, M, N(X)}, comprises eight (two+six) measurements, i.e. the luminosity L, the mass M, and the column densities of the 6 observed chemical tracers, N(X).
At each time-step of the warm-up phase, with the free parameters  = {b, M , Rc, nH(r0)} given the data D, the likelihood is

L (|D) = PC(|D) PM(|D) PL(|D) ,

(4)

where PC(|D), PM(|D) and PL(|D) are probability density distributions of the chemical abundances, the mass and the bolometric luminosity of each clump, respectively.
The first factor in Eq. 4 is

PC = PC,X ,

(5)

X

where, for the sake of simplicity, we omitted the arguments of PC, and where (Garrod et al. 2007; Gerner et al. 2014)

PC,X = erfc |log10[Nobs(X)]- log10[Nmod(X)]| ,

(6)

2

with `erfc' the complementary error function. In Eq. 6, Nobs(X)
and Nmod(X) are the observed and modelled column densities, respectively. As in Garrod et al. (2007), we set  = 1, which corresponds to a difference of one order of magnitude between the

log10[(PC PM PL)/ max]

G353.41-0.36 M = 10 3 [M yr 1]

bbbbbb000000bbb151551111_________RRRRRRRRRccccccccc445544454.........550055505_________nnnnnnnnn887777877.........000000000 (b)

0 1 2

bbbbbbbbbbbbbbbbbb000000000000000000bbbbbbbbb151551155115151515111111111___________________________RRRRRRRRRRRRRRRRRRRRRRRRRRRccccccccccccccccccccccccccc445544445544445555454454455...........................550055000055000000505005000___________________________nnnnnnnnnnnnnnnnnnnnnnnnnnn887777886666775588877866758...........................00000000000000000000000000010(3a)

log(t21/0y4r)

0 1 2 3 4 5

Fig. 5: Panel (a): Example of the L matrix calculated for G353.41-0.36, in all the models with M = 10-3 M yr-1. Models on the y-axis are sorted from the top to the bottom, by the difference between the mass of the models (see Tab. 2) and the value associated in the TOP100 (see Tab. D.1). For the sake of clarity, the colorbar is limited to five orders of magnitude, and normalised to maximum likelihood (Lmax). Panel(b): Zoom around the age limits identified by PL and PM showing how the likelihood would appear without taking into account PC in Eq. 4. Cyan vertical lines indicate the range of time that corresponds to the uncertainties on the observed luminosity in the TOP100, while the green horizontal line shows the same limit associated to the clump mass. Times and L are shown in log-scale.

observed and the modelled column densities. This assumption takes into account the uncertainties on the observed column densities, on the initial chemical conditions assumed for the Phase-I, and on the shape of the density profile assumed in Phase-II (see Sect. 3.1.2). For sources without a detection we assume a detection limit (see Appendix D) and set PC,X = 1 when Nmod(X) < Nobs(X), while we use Eq. 6 when Nmod(X) > Nobs(X).
For each clump, PL and PM are Gaussian functions with mean equal to the L and M values derived by König et al. (2017). The standard deviations are computed as follows: we add in quadrature a 50% of uncertainty associated with the models, due to the approximation of a single clump size of 0.5 pc and a constant accretion rate over time (Sect. 3.1.2), on top of the errors of 50% on L and 20% on M proposed by Urquhart et al. (2018). This gives a standard deviation for PL of about 60% of L, and for PM of about 50% of M. We note that an additional variation of 10% on these uncertainties does not produce significant variations in our final results.
Fig. 5a shows an example of how L varies as a function of time when considering models with the same mass accretion rate

Article number, page 8 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

fA
(tA, tA )/105 yr

(M = 10-3 M yr-1). The models are sorted in ascending order by the difference in mass between the values reported in König et al. (2017) and those of the models (i.e. Tab. 2), while t2 is the time spent in the warm-up phase defined in Sect. 3.1.2. In both
panels, PL defines the range of time spent by the proto-star in the warm-up phase (i.e. the range of time in between the verti-
cal cyan lines), that only depends on the uncertainties associated
to the bolometric luminosity of each source. Analogously, PM is constrained by the mass range found for a given source (e.g.
see discussions in König et al. 2017 and Urquhart et al. 2018),
and hence, it is possible to define a mass lower limit indicated by
the green horizontal line. The combined information given by PL and PM limits the age range of each source. In this area, the models with the same density profile defined by Eq. 2, but different values of b, are degenerate showing the same L as a function of t2 (see Fig. 5b). PC is fundamental to break this degeneracy (see Fig. 5a), providing a further information on the dynamics of
the collapse that led to the observed chemical properties of each
clump, and put additional constraints for determining the relative
duration of the evolutionary classes in the TOP100.
The absolute time is hence the sum of the collapse
timescales, t1, and the time spent during the warm-up phase, t2. The collapse time depends on the setup of Phase-I and it ranges between (0.4-5) × 106 yr depending on b and nH(r0), while the warm-up time depends on the mass accretion rate of Phase-II
(see Sect. 3.1.2).
The absolute age for the th source is the weighted mean





-1

tA,

=  i, j

log10[t1,i, + t2, j,
2
log10Li, j,

]  

i, j

1 log10Li, j,

2 

,

(7)

where i ranges over the 54 models, j over the 100 times used to sample Phase-II, and we use the log-likelihood as weight.
We performed the comparison described above only for the sources in the TOP100 sample that are in agreement, within the uncertainties, with the masses of the models in Tab. 2. This reduces the sample to 48 objects, i.e. 6 sources in the 70w stage, 16 IRw, 15 IRb and 11 HII regions. Nevertheless, this limitation does not affect our approach, since our model employs a subset of objects that are representative of the whole population, preserving their global features (e.g. Csengeri et al. 2016; Giannetti et al. 2017; König et al. 2017). We summarise the observed properties of the clumps in this sub sample in Tab. D.1. It is worth noting that while the TOP100 sample does not show bias in term of the source distances for each evolutionary phase (e.g. König et al. 2017), in Tab. D.1 only the IRw class extends beyond 10 kpc. To check if the distance has an impact on our results, we performed a test considering sources up to a maximum distance of 6 kpc, without finding significant changes in the final durations reported in Sect. 5.

5. Discussion
In this section, we estimate the relative duration of the evolutionary phases identified in the TOP100, differently from the estimate of the statistical lifetimes. Our findings are then compared with the relative number of objects observed in ATLASGAL (Urquhart et al. 2018), and we discuss how the synthetic column densities of the selected chemical tracers match those observed.

1.16 1.12

OMM:12:: 111120%%%

212193%%%

534296%%%

132601%%%

+2

1.08

+1

1.04

1.00

0

0.96

1

0.92

M1: all models

M2: M = 10 5 M yr 1

0.88

M2: M = 10 3 M yr 1

2

70w IRw IRb HII

Fig. 6: Summary of the final durations estimated in each evolutionary class defined for the TOP100. The relative number of massive clumps in each phase, and observed in ATLASGAL, are shown in black ("O"; Urquhart et al. 2018). Purple shadedareas indicate the 5th and 95th percentiles of the age factor, fA, and the corresponding value in yr, in our sample (model "M1"), while purple markers (`­') represent their medians. The numbers associated to the model "M2" (orange), indicate the same quantities, obtained separating the models with respect to M before calculating the average age of each source (see text). The different markers in M2 show the combination of M that best match the observed relative number of object in each phase (legend).

5.1. Estimates of the duration of evolutionary phases

To compare the ages of the evolutionary stages defined in the

TOP100 with the average absolute time estimated in a sample of

N objects, tA

= N -1

N n=1

tA,n,

we

define

the

"age-factor"

of

the th source as

fA,

= tA, tA

.

(8)

In this context, the models provide tA  106 yr starting from t1 = 0 (i.e. the beginning of Phase-I; see also Fig. 1). The average fA are estimated as the median of the age-factor distributions in each evolutionary class, computed via Eq. 8 and reported as
purple markers in Fig. 6. For the sake of clarity, Fig. 6 shows
the corresponding value of tA, - tA yr, associated with each fA. Given an evolutionary class we quantify the duration of that phase, tphase, as the time between the minimum and maximum value of tA, - tA (i.e. the lower and upper limits of the purple shaded-areas in Fig. 6). These values are computed as the 5th
and 95th percentiles of the fA distributions in each evolutionary phase. The sum of the four tphase is the total time of the highmass star formation process tMSF. The purple percent values in Fig. 6 (M1) indicates the contribution of each phase to the total time tMSF.
We find that, following the classification of Giannetti et al.
(2014) and König et al. (2017), 12% of the star formation time is

Article number, page 9 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

spent in the early phase (70w), while IRw stage is associated to
19% of tMSF. This suggests a fast evolution during the early stage of the massive star formation process, which in total correspond to the 30% of tMSF. Advanced stages (i.e. IRb sources) have the longest duration (39%), while the remaining 30% of tMSF is spent in the final stage (HII).
Assuming that the number of objects in an evolutionary stage
is also representative of its duration, we compare our findings
with the relative number of objects per evolutionary class in AT-
LASGAL, i.e. black percentages in Fig. 6 ("O"; from Urquhart
et al. 2018). The duration found for the early stages are in agree-
ment with the observed classification, while the later stages are probably biased by the different definition of IRb and HII in the TOP100 and ATLASGAL. In particular, when radio continuum
emission is found at either 4 or 8 GHz within 10 of the AT-
LASGAL peak, the source is classified as HII in the TOP100 (e.g. König et al. 2017). Different criteria have been applied in Urquhart et al. (2018) to classify the advanced stages that con-
tain radio bright HII regions, massive young stellar objects and
sources associated with methanol masers. These surveys have a different coverage than the complete ATLASGAL and different sensitivities (see Urquhart et al. 2014 for more details), so that
the final number of objects in the advanced stages might be underestimated. Since this limit affects the separation between IRb and HII, we note that if we consider a single phase to describe the more evolved sources (i.e. IRb + HII), the total duration associated with this phase would give a better agreement.
An additional source of uncertainty is a different value of M throughout the evolutionary sequence. Evidence of an increas-
ing mass accretion rate in the intermediate stages of the massive
star formation process are discussed in Beuther et al. (2002b),
while when the protostars are close to the main-sequence, their
radiation pressure might slow down or quench the mass accre-
tion rate (e.g. Nakano et al. 1995; Stahler & Palla 2005; Klassen et al. 2012). To quantify the effects of M , we repeated the calculation of the duration of each phase by separating the models by accretion rate, and mixing the results of the different phases in all their possible combinations. We find that different M produce different durations and tMSF. The most accurate solution to interpret the observations in ATLASGAL shows an accre-
tion rate that is initially slow and increases during the two in-
termediate classes, to decrease again in the more evolved phases
(see orange symbols and percentages in Fig. 6; M2). The latter result allows us to verify how reliable is the assumption of
a constant H2 radial density profile made for the clumps during Phase-II (see Sect. 3.1.2). In the most variable scenario where M = 10-3 M yr-1 over the t2 identified in our models (and assuming no mass replenishment), the majority of the clumps shows a mass loss of 20%. Only two clumps of 20 M would suffer a relevant mass loss (i.e. G353.07+0.45 and G316.64-0.09 in Tab. D.1). However, these two sources belong to the IRb and
IRw phases, which contain the majority of the clumps, and can
be considered outliers in those classes. Conversely, for sources in the 70w and HII evolutionary phases, where M = 10-5 M yr-1, the mass loss is negligible. These results, alongside the few observational estimates available for M and for the infall rate (e.g.
from the parent filament; see Sect. 3.1.2), make the assumption
of a constant density H2 profile reasonable on a clump scale. The individual durations estimated in M2 lead to 5 × 104
yr for younger objects (i.e. 70w), 1.2 × 105 yr for the IR-weak, 2.4 × 105 yr for IR-bright sources and 1.1 × 105 yr for HII re-
gions. Additionally, the average fA of each class increases with the evolution of the sources (circles and stars in Fig. 6), so that
the typical object of each class appears statistically older than

the average from the previous evolutionary phase. We therefore assume M2 to be the most representative model, with a total massive star formation time tMSF,M2  5.2 × 105 yr (tMSF,M1 1.1 tMSF,M2 ).
In this context the chemistry plays a crucial role in breaking the model degeneracy when the likelihood is defined only by PM and PL, and to match the results from ATLASGAL (see Fig. 6). In fact, if PC is not included in L (Eq. 4), the duration of the advanced stages show a difference up to a factor of 8 when compared to those predicted by M2. This corresponds to a total time, tMSF, 4.5 times shorter, and the final relative durations differ from the observed relative number of objects in each class by up to a factor of 5.
5.2. Selected tracers and chemical clocks
Four molecules were selected in this work: formaldehyde, methyl acetylene, acetonitrile and methanol (see Sect. 2), all of them manifesting an observed upward trend in their abundances with increasing evolutionary stage, indicated by the luminosityto-mass ratio of the clumps (Giannetti et al. 2017; Tang et al. 2018). Two thermal components were also required to reproduce the observed emission of the higher K-ladders of methanol and acetonitrile lines in Giannetti et al. (2017).
To evaluate to what extend the models are able to reproduce the observed column densities, the same procedure used to calculate tphase has been employed (Equations 7 and 8). Figure 7 summarises the comparison between the modelled and the observed column densities, grouped by tracer type (colours) and evolutionary class. Shaded areas represent the range of the observed beam-averaged column densities (Sect. 2 and Appendix D), with an order of magnitude uncertainty (Eq. 6), not shown in the figure. The median values of these observed column densities are shown as a solid-line. The median column densities predicted by our models are plotted as coloured circles and are shown with an uncertainty of one order of magnitude, the same as assumed for the observations.
5.2.1. Methyl acetylene and acetonitrile
The reliability of CH3CCH and CH3CN as thermometers has been widely discussed in the past (e.g. Zhang et al. 1998; Molinari et al. 2016; Giannetti et al. 2017). In particular, Giannetti et al. (2017) detected an increasing trend of the temperature and column density of CH3CCH from the less to the more evolved sources in the TOP100 (i.e. shaded area in panel a of Fig. 7). The same behaviour is found for CH3CN if the contribution of a hot and a cold component are taken into account.
In Fig. 7, the observed column densities of methyl acetylene (panel a) and acetonitrile (panels b, and c) derived from the observations increase by a factor of 10 between the 70w and the HII stages. The column densities provided by our models reflect the same trends, reproducing the observed values. The discrepancy between models and observations are within the uncertainties.
The robustness of CH3CCH and CH3CN as chemical clocks is finally tested by removing these two tracers from PC; this has the same effect as removing PC from L altogether (see Sect. 5.1), and we conclude that methyl acetylene and acetonitrile are effective chemical clocks to characterise the evolution

Article number, page 10 of 19

N(X) [cm 2] N(X) [cm 2] N(X) [cm 2]

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

1016 (a) CH3CCH
1015

1014

TOP100

1013

Models

1015 (b) CH3CN
1014
1013
1012
1011
1015 (c) (CH3CN)h
1014 1013 1012 1011
1010 70w IRw IRb HII

1018 (d) H2CO
1017 1016 1015 1014 1013
1016 (e) CH3OH
1015 1014 1013 1012
(f) (CH3OH)h
1016
1015
1014
1013 70w IRw IRb HII

Fig. 7: Comparison of the median column densities observed in the TOP100 (solid-lines) with those predicted by our models (circles), obtained applying the same procedure used to quantify tphase (see Sect. 4.2). Panels are separated by tracers (colors). The shape of the shaded-areas indicates the minimum and maximum column density observed, while the errorbars associated to each circle incorporate the uncertainty of one order of magnitude assumed in Eq. 6 for the comparison. The modelled column densities of the hot component of methanol (circles in panel f) are multiplied for a factor 1000. Triangles indicate the upperlimits. The column densities are shown in log-scale.

of massive star-forming clumps, and contribute to constrain our findings.
5.2.2. Formaldehyde and methanol
Unlike CH3CCH and CH3CN, the model column densities of methanol and formaldehyde (panels d, e, and f in Fig. 7) present a less accurate agreement with those observed. The slightly increasing trend in the observed column densities with evolution is reproduced by the models, but the modelled column densities under-/over-estimate by at least one order of magnitude those observed for the TOP100, similarly to Gerner et al. (2014). This might be related to the uncertainties in the chemical pathways that determine the formation of methanol and its precursors. For temperatures below 20 K, hydrogenation chains are usually invoked to convert CO in H2CO and CH3OH on grains, since hydrogenation is made very efficient by the large CO-depletion occurring at low temperatures (e.g. Caselli et al. 2008, Gian-

netti et al. 2014 and Sabatini et al. 2019). However, at the same temperatures, thermal desorption is inhibited and methanol is not efficiently released from the dust into the gas phase, suggesting that the surface chemistry alone is not capable of explaining the detection of gas-phase methanol also in the cold phases of massive star-forming regions (e.g. Cosentino et al. 2018). Alternative formation paths and mechanisms have been proposed to solve this issue (e.g. Viti & Williams 1999; Garrod et al. 2007; Vasyunin & Herbst 2013), but this was found to be relatively inefficient in reproducing the observed abundances of methanol (Geppert et al. 2006), and to no longer accurately predict the abundances of other chemical species (Garrod et al. 2007). The same issue also concerns H2CO, a molecular precursor of methanol. In the advanced evolutionary stages, the amount of methanol is underestimated (although closer to the observed values). This might happen because the thermal evaporation of methanol in the warmer environments is not well determined, or that further formation pathways are missing in the colder phases. We also note that the absence of the quantum tunneling diffusion in our models, might affect the final abundance of methanol, en-

Article number, page 11 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

hancing the efficiency of CO hydrogenation in the colder evolutionary phases, and thus influencing the final abundance of methanol in the warm phases (Vasyunin et al. 2017).
An additional uncertainty that we explored is the effect of different activation energies for reactions that drive the formation of molecules such as formaldehyde and methanol at low temperatures. Recently, a study of CO hydrogenation on water ice by Rimola et al. (2014), reviewed the activation energy of the hydrogenation reaction between H2CO and H producing CH3O, the precursor of methanol. The authors proposed a barrier of 1300 K, which would favour the formation of CH3OH compared to the value commonly employed (2500 K, as in this work and derived for the gas-phase; Woon 2002). Even a lower activation energy of 500 K has been predicted by Fuchs et al. (2009). However, we have tested both scenarios proposed above, without finding significant changes with respect to the modelled column densities of the tracers in Fig. 7. The most substantial change concerns CH3OH when assuming the extreme activation energy proposed by Fuchs et al. (2009). In this case, methanol column densities come closer to the values observed in the two most advanced evolutionary stages, while those of formaldehyde remains always largely overestimated. This suggests that the activation energy has secondary effects in reproducing the observed abundances of methanol and formaldehyde, and other processes or observational strategies, e.g. different or multiple transitions, should be taken into account.
We finally note that the discrepancies in the abundances of H2CO and CH3OH are not relevant for our results. If these two tracers are removed from PC and L , the duration of each phase and the final tMSF remain unaffected, showing a variation of 10% with respect to the numbers reported in Fig. 6.
6. Summary and conclusions
In this paper we have presented a new and generalised method to derive the evolutionary timescales of the massive star formation process. Our method, compared to typical statistical approaches (e.g. Russeil et al. 2010; Mottram et al. 2011; Tigé et al. 2017; Motte et al. 2018; Urquhart et al. 2018), follows a different procedure, in which the tMSF is the final result derived as the sum of the individual tphase (Sect. 5.1 and Fig. 6), and not an a priori assumption.
We have developed a set of 54 models, built to represent the entire population of massive clumps of the ATLASGALTOP100 sample (Sect. 1). The models consist of two physical phases: an initial isothermal collapse, followed by a warm-up phase induced by a massive protostar at the centre of a spherical clump (Sect. 3). In particular, we assumed a Plummerlike density profile with a slope of 5/2, while the temperature profiles have been derived from accurate three-dimensional RT simulations. Note that empirically estimates of the temperature profiles obtained from the tracers used in this work are in agreement with our computed profiles (Gieser et al. 2021; see Sect. 3.1.2). We then compared the column densities of formaldehyde (H2CO), methyl acetylene (CH3CCH), acetonitrile (CH3CN) and methanol (CH3OH) as observed in the ATLASGAL-TOP100 sources (Giannetti et al. 2017; Tang et al. 2018) with the modelled ones, by post-processing the outputs of the models at the same angular resolution of the observed data (see Appendix D).
The timescales of the evolutionary stages associated with the massive star formation process are derived by consider-

ing both the physical properties of the clumps, i.e. their mass
and luminosity, and the observed abundances of each selected
molecular tracer. Considering a mass accretion rate depending
on the evolutionary phases, we find a total star formation time, tMSF  5.2 × 105 yr, quite in agreement with that assumed by the statistical methods, providing a new and significant validation of the latter. The individual tphase that define tMSF are found to be 5 × 104 yr for the 70w, 1.2 × 105 yr for the IRw, 2.4 × 105 yr for IRb sources and 1.1 × 105 yr for HII evolutionary stages of the TOP100 sample (Sect. 2). Knowing tMSF and tphase, we derived the relative duration of each phase and we found an agree-
ment with the relative number of objects in each phase observed
in the ATLASGAL survey, providing a further confirmation of
the reliability of the method presented in this work. The chem-
ical constraint included in the likelihood to determine the duration of the different phases is necessary to achieve results in agreement with the observed relative number of objects in the
ATLASGAL survey. In fact, without this additional constraint the tphase become shorter by up to a factor of 8 with respect to those reported above, and the relative durations differ by up to a factor of 5 with the relative number of objects in each class.
Among the selected molecular tracers, CH3CCH and CH3CN are those that are best reproduced by our models, while H2CO and CH3OH show a discrepancy with respect to the observed values, although they do follow the observed trends. Therefore, the final tphase reported in this paper are mainly constrained by CH3CCH and CH3CN. Given the importance of the chemical constraint in identifying reliable timescales, we plan
to extend the number and the complexity of the selected molec-
ular tracers, with the several chemical clocks proposed in the
literature (e.g. HC3N by Taniguchi et al. 2018; CH3OCHO and CH3OCH3 by Coletta et al. 2020; see also Urquhart et al. 2019; Belloche et al. 2020). This might help to better assess the different phases of the massive star formation process, and increase the number of constrains on tphase reported in this work.
We have also found that the evaporation fronts of the discussed molecular tracers vary between 103 and 105 AU during
the warm-up phase (Sect. 4), marking in our models the regions
where each tracer becomes abundant in the gas-phase. This re-
sult suggests that we compare our findings with the observations
provided by the new astronomical facilities. In particular, the Atacama Large Millimeter/submillimeter Array (ALMA; Wootten & Thompson 2009) offers the perfect opportunity to achieve the high angular resolutions (e.g. Csengeri et al. 2018; Maud et al.
2019; Sanna et al. 2019; Johnston et al. 2020) needed to sample
scales of the order of the physical sizes of the modelled evapo-
ration fronts. Moreover, ALMA can also reach the sensitivities
needed to detect a large number of components in a JKa,Kc band. This would allow the removal of possible opacity effects, and to accurately define the thermal state of the clump that can be com-
pared with the results of this work. The increasing complexity
of chemical models, and the progress made in the observational
techniques, make this paramount goal increasingly achievable in
the near future.
To conclude, we have reported relevant and robust results on
the high-mass star formation process, together with reliable estimates of the duration of the different phases of this complex process. The present pipeline is based on one-dimensional models,
which cannot capture in full the impact of dynamical processes
like magnetic fields and turbulence on the density evolution of
the collapsing clumps and the subsequent (proto-)stellar accre-
tion process. On the other hand, low-dimensionality models allow to distinguish between the different chemical processes, and building a large number of models to infer statistical properties

Article number, page 12 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

that can be compared with observations. Despite some authors recently included the evolution of large chemical networks in 3D models (see e.g. Bovino et al. 2019), in the presence of a (proto-)stellar object, modelling the chemistry and the thermal evolution of the gas in 3D still represents a challenge.
Acknowledgements. The authors wish to thank the anonymous referee, for her/his suggestions to improve the manuscript, D. Semenov for fruitful discussions and feedbacks about the chemical model benchmark, and J. Ramsey how developed the Krome python-interface employed in this work (see also Gressel et al. 2020). This paper is based on data acquired with the Atacama Pathfinder EXperiment (APEX). APEX is a collaboration between the Max Planck Institute for Radioastronomy, the European Southern Observatory, and the Onsala Space Observatory. This research made use of Astropy, a community-developed core Python package for Astronomy (Astropy Collaboration et al. 2013, 2018; see also http://www.astropy.org), of NASA's Astrophysics Data System Bibliographic Services (ADS) and of Matplotlib (Hunter 2007). GS acknowledges R. Pascale for useful suggestions and comments, and the University of Bologna which partially provided the funds (Marco Polo fellowship) for this project. SB acknowledges for funds through BASAL Centro de Astrofisica y Tecnologias Afines (CATA) AFB-17002.
References
Adams, F. C. 2010, ARA&A, 48, 47 André, P., Revéret, V., Könyves, V., et al. 2016, A&A, 592, A54 Arzoumanian, D., André, P., Didelon, P., et al. 2011, A&A, 529, L6 Astropy Collaboration, Price-Whelan, A. M., Sipocz, B. M., et al. 2018, AJ, 156,
123 Astropy Collaboration, Robitaille, T. P., Tollerud, E. J., et al. 2013, A&A, 558,
A33 Awad, Z., Viti, S., Collings, M. P., & Williams, D. A. 2010, MNRAS, 407, 2511 Bally, J., Moeckel, N., & Throop, H. 2005, in Astronomical Society of the Pa-
cific Conference Series, Vol. 341, Chondrites and the Protoplanetary Disk, ed. A. N. Krot, E. R. D. Scott, & B. Reipurth, 81 Battersby, C., Bally, J., & Svoboda, B. 2017, ApJ, 835, 263 Belloche, A., Maury, A. J., Maret, S., et al. 2020, A&A, 635, A198 Bergin, E. A. & Tafalla, M. 2007, ARA&A, 45, 339 Beuther, H., Schilke, P., Menten, K. M., et al. 2002a, ApJ, 566, 945 Beuther, H., Schilke, P., Sridharan, T. K., et al. 2002b, A&A, 383, 892 Beuther, H., Zhang, Q., Bergin, E. A., & Sridharan, T. K. 2009, AJ, 137, 406 Bonfand, M., Belloche, A., Garrod, R. T., et al. 2019, A&A, 628, A27 Bovino, S., Ferrada-Chamorro, S., Lupi, A., et al. 2019, ApJ, 887, 224 Brown, P. D., Charnley, S. B., & Millar, T. J. 1988, MNRAS, 231, 409 Caselli, P., Vastel, C., Ceccarelli, C., et al. 2008, A&A, 492, 703 Cesaroni, R. 2005, in IAU Symposium, Vol. 227, Massive Star Birth: A Crossroads of Astrophysics, ed. R. Cesaroni, M. Felli, E. Churchwell, & M. Walmsley, 59­69 Choudhury, R., Schilke, P., Stéphan, G., et al. 2015, A&A, 575, A68 Clark, P. C., Glover, S. C. O., Ragan, S. E., & Duarte-Cabral, A. 2019, MNRAS, 486, 4622 Coletta, A., Fontani, F., Rivilla, V. M., et al. 2020, A&A, 641, A54 Contreras, Y., Schuller, F., Urquhart, J. S., et al. 2013, A&A, 549, A45 Cosentino, G., Jiménez-Serra, I., Henshaw, J. D., et al. 2018, MNRAS, 474, 3760 Csengeri, T., Bontemps, S., Wyrowski, F., et al. 2018, A&A, 617, A89 Csengeri, T., Leurini, S., Wyrowski, F., et al. 2016, A&A, 586, A149 Csengeri, T., Urquhart, J. S., Schuller, F., et al. 2014, A&A, 565, A75 Davies, B., Hoare, M. G., Lumsden, S. L., et al. 2011, MNRAS, 416, 972 Draine, B. T. 1978, ApJS, 36, 595 Draine, B. T. 2011, Physics of the Interstellar and Intergalactic Medium by Bruce T. Draine. Princeton University Press Draine, B. T. & Lee, H. M. 1984, ApJ, 285, 89 Elmegreen, B. G. 1998, in Astronomical Society of the Pacific Conference Series, Vol. 148, Origins, ed. C. E. Woodward, J. M. Shull, & J. Thronson, Harley A., 150 Ercolano, B., Barlow, M. J., & Storey, P. J. 2005, MNRAS, 362, 1038 Ercolano, B., Barlow, M. J., Storey, P. J., & Liu, X. W. 2003, MNRAS, 340, 1136 Fontani, F., Pascucci, I., Caselli, P., et al. 2007, A&A, 470, 639 Fuchs, G. W., Cuppen, H. M., Ioppolo, S., et al. 2009, A&A, 505, 629 Garrod, R. T. & Herbst, E. 2006, A&A, 457, 927 Garrod, R. T., Wakelam, V., & Herbst, E. 2007, A&A, 467, 1103 Garrod, R. T. & Widicus Weaver, S. L. 2013, Chemical Reviews, 113, 8939 Garrod, R. T., Widicus Weaver, S. L., & Herbst, E. 2008, ApJ, 682, 283

Geppert, W. D., Hamberg, M., Thomas, R. D., et al. 2006, Faraday Discuss., 133, 177
Gerner, T., Beuther, H., Semenov, D., et al. 2014, A&A, 563, A97 Giannetti, A., Bovino, S., Caselli, P., et al. 2019, A&A, 621, L7 Giannetti, A., Leurini, S., Wyrowski, F., et al. 2017, A&A, 603, A33 Giannetti, A., Wyrowski, F., Brand, J., et al. 2014, A&A, 570, A65 Gieser, C., Beuther, H., Semenov, D., et al. 2021, A&A, 648, A66 Gieser, C., Semenov, D., Beuther, H., et al. 2019, A&A, 631, A142 Glassgold, A. E. & Langer, W. D. 1974, ApJ, 193, 73 Grassi, T., Bovino, S., Giannetti, A., Ercolano, B., & Sabatini, G. in prep. Grassi, T., Bovino, S., Schleicher, D. R. G., et al. 2014, MNRAS, 439, 2386 Gressel, O., Ramsey, J. P., Brinch, C., et al. 2020, ApJ, 896, 126 Güsten, R., Nyman, L. Å., Schilke, P., et al. 2006, A&A, 454, L13 Hartmann, L., Ballesteros-Paredes, J., & Heitsch, F. 2012, MNRAS, 420, 1457 Hasegawa, T. I. & Herbst, E. 1993, MNRAS, 261, 83 Hasegawa, T. I., Herbst, E., & Leung, C. M. 1992, ApJS, 82, 167 Herpin, F., Chavarría, L., van der Tak, F., et al. 2012, A&A, 542, A76 Hickson, K. M., Wakelam, V., & Loison, J.-C. 2016, Molecular Astrophysics, 3,
1 Hocuk, S. & Cazaux, S. 2015, A&A, 576, A49 Hocuk, S., Cazaux, S., Spaans, M., & Caselli, P. 2016, MNRAS, 456, 2586 Hoq, S., Jackson, J. M., Foster, J. B., et al. 2013, ApJ, 777, 157 Hosokawa, T. & Omukai, K. 2009, ApJ, 691, 823 Hunter, J. D. 2007, Computing In Science & Engineering, 9, 90 Johnston, K. G., Hoare, M. G., Beuther, H., et al. 2020, A&A, 634, L11 Kennicutt, R. C. 2005, in Massive Star Birth: A Crossroads of Astrophysics, ed.
R. Cesaroni, M. Felli, E. Churchwell, & M. Walmsley, Vol. 227, 3­11 Klassen, M., Peters, T., & Pudritz, R. E. 2012, ApJ, 758, 137 Kobayashi, C., Karakas, A. I., & Lugaro, M. 2020, ApJ, 900, 179 König, C., Urquhart, J. S., Csengeri, T., et al. 2017, A&A, 599, A139 Kulterer, B. M., Drozdovskaya, M. N., Coutens, A., Manigand, S., & Stéphan,
G. 2020, MNRAS, 498, 276 Kurtz, S., Cesaroni, R., Churchwell, E., Hofner, P., & Walmsley, C. M. 2000,
in Protostars and Planets IV, ed. V. Mannings, A. P. Boss, & S. S. Russell, 299­326 Liu, X.-L., Xu, J.-L., Ning, C.-C., Zhang, C.-P., & Liu, X.-T. 2018, Research in Astronomy and Astrophysics, 18, 004 Loison, J.-C., Wakelam, V., & Hickson, K. M. 2014, Monthly Notices of the Royal Astronomical Society, 443, 398 Maret, S., Hily-Blant, P., Pety, J., Bardeau, S., & Reynier, E. 2011, A&A, 526, A47 Maud, L. T., Cesaroni, R., Kumar, M. S. N., et al. 2019, A&A, 627, L6 McKee, C. F. & Tan, J. C. 2002, Nature, 416, 59 Molinari, S., Merello, M., Elia, D., et al. 2016, ApJ, 826, L8 Molinari, S., Pezzuto, S., Cesaroni, R., et al. 2008, A&A, 481, 345 Motte, F., Bontemps, S., & Louvet, F. 2018, Annual Review of Astronomy and Astrophysics, 56, 41 Motte, F., Bontemps, S., Schilke, P., et al. 2007, A&A, 476, 1243 Mottram, J. C., Hoare, M. G., Davies, B., et al. 2011, ApJ, 730, L33 Mouschovias, T. C., Tassis, K., & Kunz, M. W. 2006, ApJ, 646, 1043 Mueller, K. E., Shirley, Y. L., Evans, Neal J., I., & Jacobson, H. R. 2002, ApJS, 143, 469 Müller, H. S. P., Thorwirth, S., Roth, D. A., & Winnewisser, G. 2001, A&A, 370, L49 Nakano, T., Hasegawa, T., & Norman, C. 1995, ApJ, 450, 183 Nomura, H. & Millar, T. J. 2004, A&A, 414, 409 Padoan, P., Pan, L., Juvela, M., Haugbølle, T., & Nordlund, Å. 2020, ApJ, 900, 82 Penteado, E. M., Walsh, C., & Cuppen, H. M. 2017, ApJ, 844, 71 Peretto, N., Fuller, G. A., Duarte-Cabral, A., et al. 2013, A&A, 555, A112 Peters, T., Banerjee, R., Klessen, R. S., & Mac Low, M.-M. 2011, ApJ, 729, 72 Reboussin, L., Wakelam, V., Guilloteau, S., & Hersant, F. 2014, MNRAS, 440, 3557 Rimola, A., Taquet, V., Ugliengo, P., Balucani, N., & Ceccarelli, C. 2014, A&A, 572, A70 Russeil, D., Zavagno, A., Motte, F., et al. 2010, A&A, 515, A55 Sabatini, G., Bovino, S., Giannetti, A., et al. 2020, A&A, 644, A34 Sabatini, G., Giannetti, A., Bovino, S., et al. 2019, MNRAS, 490, 4489 Sanna, A., Kölligan, A., Moscadelli, L., et al. 2019, A&A, 623, A77 Saraceno, P., Andre, P., Ceccarelli, C., Griffin, M., & Molinari, S. 1996, A&A, 309, 827 Schneider, N., Csengeri, T., Bontemps, S., et al. 2010, A&A, 520, A49 Schneider, N., Ossenkopf, V., Csengeri, T., et al. 2015, A&A, 575, A79 Schuller, F., Menten, K. M., Contreras, Y., et al. 2009, A&A, 504, 415 Semenov, D., Hersant, F., Wakelam, V., et al. 2010, A&A, 522, A42 Smartt, S. J. 2009, ARA&A, 47, 63 Spitzer, Lyman, J. & Tomasko, M. G. 1968, ApJ, 152, 971 Spitzer, L. 1978, Physical processes in the interstellar, New York WileyInterscience

Article number, page 13 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs
Stahler, S. W. & Palla, F. 2005, The Formation of Stars, John Wiley & Sons, Ltd, 865
Tafalla, M., Myers, P. C., Caselli, P., & Walmsley, C. M. 2004, Ap&SS, 292, 347 Tafalla, M., Myers, P. C., Caselli, P., Walmsley, C. M., & Comito, C. 2002, ApJ,
569, 815 Tang, X. D., Henkel, C., Wyrowski, F., et al. 2018, A&A, 611, A6 Taniguchi, K., Saito, M., Sridharan, T. K., & Minamidani, T. 2018, ApJ, 854,
133 Tielens, A. G. G. M. 2010, The Physics and Chemistry of the Interstellar
Medium, by A. G. G. M. Tielens, Cambridge, UK: Cambridge University Press, Tigé, J., Motte, F., Russeil, D., et al. 2017, A&A, 602, A77 Urquhart, J. S., Figura, C., Wyrowski, F., et al. 2019, MNRAS, 484, 4444 Urquhart, J. S., Figura, C. C., Moore, T. J. T., et al. 2013, MNRAS, 437, 1791 Urquhart, J. S., König, C., Giannetti, A., et al. 2018, MNRAS, 473, 1059 Urquhart, J. S., Moore, T. J. T., Csengeri, T., et al. 2014, MNRAS, 443, 1555 van der Tak, F. F. S. 2005, in Massive Star Birth: A Crossroads of Astrophysics, ed. R. Cesaroni, M. Felli, E. Churchwell, & M. Walmsley, Vol. 227, 70­79 van der Tak, F. F. S. & van Dishoeck, E. F. 2000, A&A, 358, L79 van Dishoeck, E. F. & Blake, G. A. 1998, ARA&A, 36, 317 Vasyunin, A. I., Caselli, P., Dulieu, F., & Jiménez-Serra, I. 2017, ApJ, 842, 33 Vasyunin, A. I. & Herbst, E. 2013, ApJ, 769, 34 Viti, S., Caselli, P., Hartquist, T. W., & Williams, D. A. 2001, A&A, 370, 1017 Viti, S., Collings, M. P., Dever, J. W., McCoustra, M. R. S., & Williams, D. A. 2004, MNRAS, 354, 1141 Viti, S. & Williams, D. A. 1999, MNRAS, 310, 517 Wakelam, V., Loison, J. C., Mereau, R., & Ruaud, M. 2017, Molecular Astrophysics, 6, 22 Wang, K. S., Bourke, T. L., Hogerheijde, M. R., et al. 2013, A&A, 558, A69 Wienen, M., Wyrowski, F., Menten, K. M., et al. 2015, A&A, 579, A91 Wood, D. O. S. & Churchwell, E. 1989, ApJ, 340, 265 Woon, D. E. 2002, ApJ, 569, 541 Woosley, S. E. & Weaver, T. A. 1995, ApJS, 101, 181 Wootten, A. & Thompson, A. R. 2009, IEEE Proceedings, 97, 1463 Wyrowski, F., Güsten, R., Menten, K. M., et al. 2016, A&A, 585, A149 Zhang, Q., Ho, P. T. P., & Ohashi, N. 1998, ApJ, 494, 636 Zhu, H., Tian, W., Li, A., & Zhang, M. 2017, MNRAS, 471, 3494 Zinnecker, H. & Yorke, H. W. 2007, ARA&A, 45, 481
Article number, page 14 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

Table A.1: Summary of the reactions in the chemical network employed in this work. In column (2): A and B are two generic reactants; column (3) shows the total number of reactions of each type, contained in the chemical network.

Reaction

Example

#included

Recomb. on grain CR ionisation CR photodissociation Gas-phase reactions Photo-ionisation Photo-dissociation

A++ grain-  A + grain AB + cr  AB+ + e- AB + cr  A + B (see the note below)7 AB + UV  AB + e- AB + UV  A + B

13



 

220

4016

  153 

Grain-surf. reactions

Adust + Bdust  ABdust

266

Thermal desorpion

ABdust + heat  AB

195

Desorp. induced by CR

ABdust + cr  AB

195

(CR photodiss.)dust

ABdust + cr  Adust + Bdust

185

(CR photoion.)dust

ABdust + cr  AB+dust + e-

56

(FUV photodiss.)dust ABdust + UV  Adust + Bdust 204

(FUV photoion.)dust

ABdust + UV  AB+dust + e-

171

(Freeze-out)dust

AB  ABdust + 

195

Appendix A: details on chemical network
Tab. A.1 shows the types of chemical reactions included in the network. Column (1) contains the names of each type of reaction; column (2) an example of chemical reaction between two generic reactants A and B, and, column (3) summarises the total number of reactions included in the network.
In Tab. A.2 we provide the complete list of binding energies assumed in this work, updated to the most recent estimates found in KIDA. Where it was not possible to find a recent estimate, we used Semenov et al. (2010) (species in bold). The 35 chemical species in the bottom part of the table are those added to the original network due to the missing desorption processes (see Sect. 3.2).

Appendix B: Benchmark of the chemical network
We benchmarked our network against Semenov et al. (2010). The initial conditions are summarised in Tab. B.1. All the elements are initially atomic, with the exception of hydrogen which is assumed completely in molecular form. Except for He, N and O, all the elements are also ionised, while grains are initially neutral.
TMC1-model: We benchmark the physical case named, "TMC1-model". The gas has a constant temperature of 10 K, a constant hydrogen nuclei density nH = 2 × 104 cm-3, and visual extinction Av = 10 mag. The sticking coefficient is S = 1, and the cosmic ray ionisation rate of hydrogen molecules is set to 2 = 1.3 × 10-17 s-1 (Spitzer & Tomasko 1968; Glassgold & Langer 1974). We have assumed an average grain size of a = 0.1 µm and bulk density 0 = 3 g cm-3 corresponding to silicate grains, as in Sect. 3.1. Figures B.1 shows the perfect agreement with the results reported by Semenov et al. (2010).
7 The gas-phase processes included are ion-molecule, neutral-neutral, charge exchange, radiative association, radiative recombination and dissociative recombination.

Table A.2: Complete list of binding energies used in this work. The values were taken from the KIDA-database, and updated to the latest available estimates (mainly from Wakelam et al. 2017). When this was not possible, the values from Semenov et al. (2010) were used. The latter case has been highlighted in boldface.

Chemical species - Tb/K

C 10000 C6H6 7590

CO 1300 HNC3 4580

C10 8000

C7 5600

CO2 2600 HNCO 4400

C2 10000

C7H 6140

CS 3200 HNO 3000

C2H 3000

C7H2 6590

Fe 4200

HS 2700

C2H2 2590

C7H3 7040

FeH 4650 HSS 2650

C2H3 2800 CH3C6H 7490

H 650

Mg 5300

C2H4 2500

C7N 6400

H2 440 MgH 5750

C2H5 3100

C8 6400 H2C3N 5030 MgH2 6200

CH3CH2OH 5400

C8H 6940 H2C3O 3650

N 720

C2H6 1600

C8H2 7390 H2C5N 6630

N2 1100

C2N 2400

C8H3 7840 H2C7N 8230 N2H2 4760

CCO 1950

C8H4 8290 H2C9N 9830

Na 11800

C2S 2700

C9 7200 H2CN 2400 NaH 12300

C3 2500

C9H 7740 H2CO 4500 NaOH 14700

C3H 4000

C9H2 8190

H2CS 4400

NH 2600

C3H2 3390

C9H3 8640

H2O 5600 NH2 3200

C3H3 3300

C9H4 9090

H2O2 6000 NH2CHO 6300

C3H3N 5480

C9N 8000

H2S 2700 NH2OH 6810

CH3CCH 3800

CH 925 HSSH 3100 NH3 5500

C3N 3200

CH2 1400 H3C5N 7080

NO 1600

C3O 2750 H2CCN 4230 H3C7N 8680

NS 1900

C3S 3500 H2CCO 2800 H3C9N 10300

O 1600

C4 3200 CH3N 5530 H4C3N 5930

O2 1200

C4H 3740 CH2NH2 5530 H5C3N 6380

O2H 5000

C4H2 4190 CH3O 4400 HCCNC 4580

O3 2100

C4H3 4640

CH3 1600 HC2O 2400 OCN 2400

C4H4 5090 CH3C3N 6480

HC3N 4580

OCS 2400

C4N 4000 CH3C4H 5890 HC3O 3200

OH 4600

C4S 4300 CH3C5N 7880

HC5N 6180

S 2600

C5 4000 CH3C6H 7490

HC7N 7780

S2 2200

C5H 4540 CH3C7N 9480

HC9N 9380

Si 11600

C5H2 4990 CH3CHO 5400 HCCN 3780

SiC 3500

C5H3 5440 CH3CN 4680

HCN 3700

SiH 13000

CH3C4H 5890 CH2NH2 5530 HNCCC 4580 SiH2 3600

C5N 4800 CH3OCH3 3150

HCO 2400 SiH3 4050

C6 4800 CH3OH 5000 HCOOCH3 6300 SiH4 4500

C6H 5340

CH4 9600 CH2O2 5570

SiO 3500

C6H2 5790 CH3NH2 6580

HCS 2900

SiS 3800

C6H3 6240 H2CN 2400

He 100

SO 2800

C6H4 6690

CN 2800

HNC 3800

SO2 3400

Added in this work

CH3COCH3 3500 C3P 5900 C4P 7500 CCl 1900 CCP 4300
CH2PH 2600 Cl 3000
ClO 1900 CP 1900

H2SiO 4050 HCCP 4750
HCL 5170 HCP 2350 HCSi 3630 HNSi 5080 HPO 2350 N2O 2400 NH2CN 5560

NO2 2400 P 1100
PH 1550 PH2 2000 PN 1900 PO 1900 SiC2 4300 SiC2H 4700 SiC2H2 5200

SiC3 5100 SiC3H 5550
SiC4 5900 SiCH2 3750 SiCH3 4200
SiN 3500 SiNC 4300 SiO2 4300

Article number, page 15 of 19

10 4 C
10 6 10 8

A&A proofs: manuscript no. Sabatini2021_HMSFRs
10 6 (g)C
10 8 10 10 10 12

n(X)/nH

n(X)/nH

n(X)/nH

10 7 H2O
10 9 10 11 10 13

10 5 (g)H2O
10 8 10 11 10 14

10 4 CO
10 6 10 8 10 10 10 12

10 5 (g)CO
10 8 10 11 10 14

10 13 CH3OH

10 8 10 12

(g)CH3OH

10 16

10 16

10 19

10 20

10 22

Krome
Semenov et al. (2010)

10 24

100 102 tim1e04[yr] 106 108 100 102 tim1e04[yr] 106 108

n(X)/nH

Fig. B.1: Comparison of the time-dependent variation in the abundances of four arbitrary species (i.e. C, H2O, CO and CH3OH), both in gas-phase (left panels) and on dust (right panels), in the "TMC1-model". The green line shows the results obtained with the
Krome-package, while the blue crosses are the results of Semenov et al. (2010) with Alchemic.

Article number, page 16 of 19

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry

H2CO
10 8

10 11 CH3CN
10 12

n(X)/nH

10 13 10 9
10 14

n(X)/nH

10 11 CH3CCH

10 11 CH3OH

10 12

10 12

10 13

10 13

10 14 10 15 10 16

b = 0.1 10 14 b = 0.5 10 15 b = 1 10 16

104 105 nH [1c0m6 3] 107 108 104 105 nH [1c0m6 3] 107 108

Fig. B.2: Fractional abundance evolution for H2CO, CH3CN, CH3CCH and CH3OH as a function of the central density of the clump during the collapse phase. Colors indicate the value of b assumed for the collapse described by Eq. 1. Solid-lines show the results employing the canonical binding energies from KIDA, while shaded-areas represent the solutions by varying Tb by ±10%.

Table B.1: Summary of initial abundances set for the "TMC1-
model". All the species, ni, are weighted on the initial density of hydrogen nuclei (nH  n[H + 2H2]). The notation A(-B) means A×10-B.

species
He H2 C+ N O S+

(ni/nH)t=0
9.00(-2) 5.00(-1) 1.20(-4) 7.60(-5) 2.56(-4) 8.00(-8)

species
Si+ Na+ Mg+ Fe+ P+ Cl+

(ni/nH)t=0
8.00(-9) 2.00(-9) 7.00(-9) 3.00(-9) 2.00(-10) 1.00(-9)

Appendix C: Chemical evolution and model uncertainties during Phase-I
Fig. B.2 shows the fractional abundances evolution of the relevant tracers (see Sect. 1) as a function of the central density of

the clump during the isothermal collapse. We first test the effect of the collapse velocity (parameter
b in Eq. 1) on the chemical evolution of some of the observed species, delaying the collapse by 50% and the 90%, i.e. b = 0.5 and b = 0.1, respectively. Different colors in Fig. B.2 represent different values of b.
Despite the effects induced by varying b, the relative impor-
tance of the chemical reactions involving some of the main trac-
ers remains unaltered. In particular, H2CO is mainly formed via CH3 + O  H2CO + H, and it is destroyed by ion-molecule reactions which involve H+, C+ and S+. For densities higher than 105 cm-3, ion-molecule reactions become predominant and the
abundance of H2CO decreases. At higher densities, some relative abundance profiles return to increase since the dominant reaction becomes H3CO+ + e-  H2CO + H.
Methyl acetylene is formed by the dissociative recombination (i) C3H+5 + e-  CH3CCH + H, the main gas-phase source of CH3CCH (see Hickson et al. 2016). For densities above 106 cm-3, the relative abundance is almost constant, since CH3CCH reacts with C with a rate coefficient similar to (i).
Conversely, the abundance of acetonitrile is more sensitive

Article number, page 17 of 19

A&A proofs: manuscript no. Sabatini2021_HMSFRs

to b. The main source of gas-phase CH3CN in our model is (ii)

HCN + CH+3 bination (iii)

 CH3CNH+, followed by the dissociative recomCH3CNH+ + e-  CH3CN + H. We found that at

beginning of the collapse CH3CN is rapidly formed, in agree-

ment with what estimated by Loison et al. (2014) and then slowdown by (iv) CH3CN + H+3  CH3CNH+ + H2. The combined effect of reactions (iii) and (iv) is also sensitive to b since for fast

collapse (b = 1) reactions (ii) and (iii) have a shorter amount

of time to form CH3CN before reaction (iv) becomes effective. For densities between 105 and 106 cm-3, CH3CN starts to react efficiently with H+3  CH3CNH+ + CO. The effect of this reaction in combination with (iv) produces a slow decrease in the

CH3CN profiles at high densities.

The abundance of methanol increases with density,

CdrHiv3eOnHb+2y+ree-actioCn HC3HO+3H

+ +

H2O H (see

 also

CH3OH+2 followed by Viti & Williams 1999).

To determine other sources of uncertainties, we analysed the variation of the chemical evolution by changing the binding energies reported in Tab. A.2 by ±10%, repeating the collapse with the same physical conditions. The effects on the fractional abundances are represented by the colour-shaded areas in Fig. B.2. The discrepancy is more than one order of magnitude at the highest densities. We note that even larger discrepancies are reported by Penteado et al. (2017), when the binding energies are randomly selected from a normal distribution (see results reported in their Fig. 2).
These tests show that the uncertainties due to binding energies variation are not negligible (see Fig. B.2), but they are not greater than variations caused by variations in b, suggesting that the dynamical state of the clump may play an important role in regulating its chemical evolution (see also the recent results by Kulterer et al. 2020).
Finally, we have tested our collapse-phase with a set-up similar to Garrod & Herbst (2006), but employing the chemical network and binding energies of Semenov et al. (2010), because both are publicly available and consequently easy to benchmark. The difference between the abundances found by Garrod & Herbst (2006) and ours is within an order of magnitude, caused by the details of the chemical networks adopted.

rived as N(o-H2CO)+N(p-H2CO). For sources not detected in o- and/or p-H2CO, we estimated the corresponding detection limit column density using Weeds (Maret et al. 2011), with a 3 detection with respect to the average noise level (Tang et al. 2018; 0.06 K main-beam temperature scale) and assuming the H2CO molecular line parameters provided by the CDMS8 database (Müller et al. 2001). For each evolutionary class we assume the average values of Tkin (i.e. 52, 73, 81 and 110 K for 70w, IRw, IRb and HII, respectively) and a FWHM of 5 km s-1 for the line reported by Tang et al. (2018), and that the source size is equal to the APEX beam at the corresponding frequency.
Appendix D.2: Methyl acetylene (CH3CCH), methanol (CH3OH) and acetonitrile (CH3CN)
Column densities of methyl acetylene, methanol and acetonitrile are taken from Giannetti et al. (2017), who observed with APEX the J = 20K - 19K, J = 7K - 6K, and J = 19K - 18K bands for CH3CCH, CH3OH, and CH3CN, respectively. Since these lines are very close to each other, we assume the same angular resolution for APEX, i.e. 18 . The final column densities in Giannetti et al. (2017) are corrected for the APEX-beam dilution,  = S2/(S2 + b2eam), where S and beam are the sourceand beam FWHM sizes. We have (re-)applied this correction to each source where the detections were not resolved in the APEX-beam FWHM angular size (i.e. when S < beam) to obtain the beam-averaged column densities, whereas for sources with S > beam,  = 1. Detection limits have been estimated assuming the mean noise of the source's spectra, the average line width and the median excitation temperatures reported in Tables 6 and 7 of Giannetti et al. (2017) for each evolutionary class. We treated the hot components observed for these tracers (see Sect. 4.1) in the same way as the colder ones, considering the appropriate temperatures reported by Giannetti et al. (2017), in the detection limits calculation.

Appendix D: Notes on the observed column densities
In Sect. 4.1 we discussed how we post-processed the outputs of the models to compare the synthetic column densities with a number of available observations of the TOP100 clumps (right panel of Fig. 1). In this Appendix we report some notes on how the observed column densities are treated before the comparison discussed in Sect. 4.2. The observed column densities used in the comparison are summarised in Tab. D.1.

Appendix D.1: Formaldehyde (H2CO)

Formaldehyde data are taken from Tang et al. (2018). For simplicity, we assume a single Full width at half maximum (FWHM) beam size of 29 to convolve the modelled column densities (i.e. the APEX-telescope resolution corresponding to the J = 3 - 2 transition of both the H2CO ortho and the para forms at 211 and 218 GHz, respectively.) For the sources where both isomers are observed, the total column density, Nobs(H2CO), is de-
Article number, page 18 of 19

8 https://cdms.astro.uni-koeln.de/cdms/portal/

G. Sabatini et al.: Establishing the evolutionary timescales of the massive star formation process through chemistry
Table D.1: Summary of the observed properties of the selected TOP100 sources (column 1): columns from (2) to (6) are related to the physical properties of each source (König et al. 2017). Columns from (7) to (12) report the final beam- and LOS-average column densities, obtained applying the procedure described in Sec. D to the values reported in Giannetti et al. (2017) and Tang et al. (2018). Upper limits are marked with '<'.

(1) Source-ID

(2) (3) Class d

kpc

G13.18+0.06 70w 2.40 G14.49-0.14 70w 3.87 G30.89+0.14 70w 4.90 G351.57+0.77 70w 1.34 G353.42-0.08 70w 6.06 G354.95-0.54 70w 1.91

(4) Lbol
102 L
83.18 7.50 4.96 4.33 45.08 4.84

(5) (6) (7) (8)

(9)

(10)

(11)

(12)

Mclump Td

log10[Nobs(X/cm-2)]

102 M K H2CO CH3CCH (CH3CN)cold (CH3CN)hot (CH3OH)cold (CH3OH)hot

3.68 24.24 13.66 14.62 19.16 12.39 <12.68 14.52 19.18 11.44 <12.68 14.16 1.64 17.04 <12.68 14.15 17.91 17.12 <12.68 <15.73 1.47 19.13 <12.68 <15.73

13.41 13.22 13.08 <14.53 12.74 12.71

<12.89 <12.89 <12.93 <12.72 <12.74 <12.70

16.02 15.85 15.29 <15.42 <15.42 <15.42

<14.22 <14.22 <14.17 <14.20 <14.20 <14.20

G08.68-0.37 IRw 4.78 G08.71-0.41 IRw 4.78 G10.45-0.02 IRw 8.55 G14.11-0.57 IRw 2.57 G14.63-0.58 IRw 1.83 G24.63+0.17 IRw 7.72 G28.56-0.24 IRw 5.45 G305.19-0.01 IRw 3.80 G317.87-0.15 IRw 2.95 G318.78-0.14 IRw 2.78 G326.99-0.03 IRw 3.95 G331.71+0.60 IRw 10.53 G336.96-0.23 IRw 10.91 G337.26-0.10 IRw 11.00 G342.48+0.18 IRw 12.55 G353.07+0.45 IRw 0.86

275.00 5.04 113.14 31.77 27.78 50.36 17.67 125.29 16.41 64.00 11.44 373.43 36.25 300.11 641.50 0.57

14.81 16.62 16.06 3.53 2.54 15.28 54.14 5.18 3.62 3.59 4.44 51.12 24.22 31.87 49.13 0.18

24.18 13.72 11.81 <12.80 20.70 <12.80 22.35 13.46 22.54 13.54 18.12 13.20 11.73 <12.80 26.07 13.52 19.26 13.76 24.92 13.26 17.95 13.84 21.00 13.86 15.77 13.36 21.73 13.35 23.61 13.47 17.79 <12.80

15.11 14.46 14.36 14.63 14.67 14.08 14.58 <15.30 14.82 14.22 14.88 14.74 14.71 14.40 14.44 14.55

13.58 12.99 13.34 13.14 13.22 13.21 12.96 13.33 13.51 13.28 13.57 13.48 13.21 13.27 13.18 <13.48

<12.85 <12.84 <12.91 <12.87 <12.83 <12.89 <12.84 <12.85 <12.84 <12.92 <12.89 <12.93 <12.89 <12.93 <12.81 <12.70

15.22 15.19 14.96 15.37 15.82 15.03 14.97 <14.86 15.88 15.26 15.65 16.00 15.54 15.34 15.15 15.11

<14.41 <14.36 <14.53 <14.40 <14.41 <14.35 <14.32 <14.40 <14.40 <14.39 <14.39 <14.42 <14.40 <14.43 <14.39 <14.46

G34.41+0.23 IRb 1.56 48.39 2.14 26.13 14.01 15.20 G35.20-0.74 IRb 2.19 235.80 4.63 29.54 14.03 14.94 G59.78+0.07 IRb 2.16 97.71 2.55 28.19 <12.88 14.36 G305.56+0.01 IRb 3.80 517.18 4.06 33.41 <13.72 <15.00 G310.01+0.39 IRb 3.61 496.33 4.15 32.20 13.46 14.43 G313.58+0.32 IRb 3.78 94.14 1.83 29.17 <12.88 <15.00 G316.64-0.09 IRb 1.19 9.94 0.18 30.63 <12.88 14.67 G333.31+0.11 IRb 3.60 107.33 4.27 25.85 13.73 14.73 G339.62-0.12 IRb 3.01 149.96 3.20 28.66 13.65 14.69 G340.75-1.00 IRb 2.76 76.82 2.13 27.07 13.64 14.35 G341.22-0.21 IRb 3.67 162.23 4.90 27.03 13.74 14.33 G345.51+0.35 IRb 2.25 432.67 4.24 32.70 14.04 14.85 G345.72+0.82 IRb 1.56 18.73 2.01 22.05 13.28 14.79 G351.77-0.54 IRb 1.00 164.69 2.64 31.79 14.82 15.92 G353.41-0.36 IRb 3.44 1272.01 34.83 28.26 13.98 15.03

14.78 14.26 13.26 13.02 13.23 <13.30 13.60 13.52 13.51 13.19 13.62 13.66 13.09 15.68 13.59

14.72 <14.14 <13.11 <12.96 <12.94 <12.78
13.57 <13.01 <12.94 <12.97 <12.91 <12.94 <12.89
15.63 <12.91

16.15 16.33 15.21 15.37 14.91 14.88 15.20 15.63 14.94 15.75 15.56 16.10 15.21 16.73 15.88

15.92 15.19 <14.59 <14.55 <14.53 <14.88 15.12 <14.58 <14.57 <14.49 <14.59 16.05 <14.53 16.68 <14.68

G10.62-0.38 HII G12.81-0.20 HII G31.41+0.31 HII G34.40+0.23 HII G301.14-0.23 HII G330.88-0.37 HII G330.95-0.18 HII G332.83-0.55 HII G333.28-0.39 HII G333.60-0.21 HII G351.42+0.65 HII

4.95 4227.57 37.87 34.45 14.68 2.40 2468.69 18.80 35.15 14.19 4.90 689.42 30.63 26.32 14.14 1.56 29.91 2.76 22.82 13.93 4.40 2137.40 19.41 34.56 <13.02 4.16 1545.88 15.87 33.44 14.26 9.32 13064.99 173.06 33.04 14.45 3.60 2419.56 19.36 35.67 14.25 3.60 1291.69 20.77 30.37 13.80 3.60 12416.71 34.61 41.12 14.23 1.34 398.57 4.63 33.38 <13.02

15.43 15.36 15.34 14.85 15.13 15.19 15.42 15.30 14.95 15.47 15.27

13.98 13.64 15.45 13.75 14.01 14.61 14.58 14.22 13.47 13.75 14.85

13.34 <13.23
15.43 <13.09
13.76 14.49 14.44 14.08 <13.28 <13.53 <14.72

15.95 15.32 16.41 16.04 15.91 16.11 16.21 16.03 15.76 14.80 16.88

15.21 <14.54
16.38 <14.54
15.78 16.01 16.07 15.90 <14.56 <14.59 16.85

Article number, page 19 of 19

