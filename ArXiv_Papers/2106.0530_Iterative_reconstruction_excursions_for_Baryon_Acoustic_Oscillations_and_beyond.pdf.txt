arXiv:2106.00530v1 [astro-ph.CO] 1 Jun 2021

Mon. Not. R. Astron. Soc. 000, 000­000 (0000) Printed 2 June 2021 (MN LATEX style file v2.2)

Iterative reconstruction excursions for Baryon Acoustic Oscillations and beyond

Hee-Jong Seo1 . Atsuhisa Ota1, Marcel Schmittfull2, Shun Saito3,4, Florian Beutler5
1Department of Physics and Astronomy Ohio University, Athens, OH, 45701, USA 2 Institute for Advanced Study, Einstein Drive, Princeton, NJ 08540, USA 3 Institute for Multi-messenger Astrophysics and Cosmology, Department of Physics, Missouri University of Science and Technology,
1315 N. Pine St., Rolla MO 65409, USA 4Kavli Institute for the Physics and Mathematics of the Universe (WPI), Todai Institutes for Advanced Study,
the University of Tokyo, Kashiwanoha, Kashiwa, Chiba 277-8583, Japan 5Institute for Astronomy, University of Edinburgh, Royal Observatory, Blackford Hill, Edinburgh EH9 3HJ, UK

2 June 2021

ABSTRACT The density field reconstruction technique has been widely used for recovering the Baryon Acoustic Oscillation (BAO) feature in galaxy surveys that has been degraded due to nonlinearities. In this paper, we investigate the performance of iterative reconstruction on the BAO and the broadband, focusing on the iterative implementation based on Seo et al. (2010) and Schmittfull et al. (2017). We include redshift-space distortions, halo bias, and shot noise and inspect the components of the reconstructed field in Fourier space and in configuration space using both density field-based reconstruction and displacement field-based reconstruction. We find that the displacement field reconstruction becomes quickly challenging in the presence of non-negligible shot noise and therefore present surrogate methods that can be practically applied to a much more sparse field such as galaxies. For a galaxy field, implementing a debiasing step to remove the Lagrangian bias appears crucial for the displacement field reconstruction. We show that the iterative reconstruction does not substantially improve the BAO feature beyond an optimized standard reconstruction; however, we find that such aggressive optimization of the standard reconstruction with a small smoothing kernel is achieved at the cost of degradation on large scales while taking iterative steps allows us to use a small smoothing kernel `stably', i.e., without causing a substantial deviation from the linear theory model on large scales.
Key words: cosmology: cosmological parameters, large-scale structure

1 INTRODUCTION
Baryon acoustic oscillations (hereafter BAO) from galaxy surveys have played a key role in today's cosmology inference on dark energy and the Hubble constant (e.g, Aubourg et al. 2015; Alam et al. 2021). The BAO feature was formed by primordial sound waves that propagated through tightly coupled photons and baryons in the very early Universe; they were subsequently frozen out at the epoch of recombination when the photons and baryons decoupled. The observed sizes of BAO from galaxy surveys, in comparison to its true physical size estimated from an independent probe such as from the Cosmic Microwave Background (CMB), construct a robust standard ruler test that provides cosmological distances (i.e., angular diameter distances and Hubble parameters) as a function of time (e.g., Seo & Eisenstein 2003). The signal of this primordial feature degrades with the structure growth of the Universe; nonlin-
seoh@ohio.edu
© 0000 RAS

earity associated with the structure growth decreases the precision and accuracy of the measurement (e.g, Meiksin et al. 1999; Crocce & Scoccimarro 2008; Seo et al. 2008; Matsubara 2008; Padmanabhan & White 2009; Seo et al. 2010).
The density field reconstruction technique (Eisenstein et al. 2007b) has been widely used to recover the BAO feature in galaxy surveys from the effect of this structure growth. The performance of this method is quite stable and robust, straightforwardly depending on the interplay between the smoothing kernel and the signal to noise of the input data (e.g., White 2010). A perturbation theory-based empirical model has provided a good description for the reconstructed BAO feature (e.g, Eisenstein et al. 2007a; Crocce & Scoccimarro 2008; Padmanabhan et al. 2009; Noh et al. 2009; Seo et al. 2016) and has been used for the BAO-only analysis; the resulting constraints have been critical for understanding dark energy (e.g., Alam et al. 2021).
In addition to the BAO feature, large-scale structure contains other cosmology probes. The overall (i.e., broad-band) shape of the clustering provides information about the horizon scale at the epoch

2 Hee-Jong Seo et al.
of the matter-radiation equality (e.g, Eisenstein & Hu 1998). The matter-radiation equality scale imprinted in the broad-band shape can, in principle, serve as another standard ruler to measure cosmological distance scales. Second, the underlying clustering of matter/galaxies should be isotropic. A deviation from the isotropy provides information on the geometry of the Universe, which is called the Alcock-Paczynski (AP) test (Alcock & Paczynski 1979), and on the peculiar velocity field, which is called redshift-space distortions (RSD) (Kaiser 1987). Features such as RSD and the broadband shape are more prone to nonlinear effects because they are less distinct/localized than the BAO feature.
The standard density field reconstruction alters this shape of the broadband and RSD. Although the linear BAO information is largely recovered, the resulting power spectrum does not agree with the linear power spectrum, because the nonlinearity is not fully reversed even at the second order in density perturbations (e.g, Padmanabhan et al. 2009; Schmittfull et al. 2015). Understanding the full shape after reconstruction will enable a full/combined clustering fit to the BAO and AP+RSD features using the postreconstructed field. Due to the reduced nonlinearity, the perturbation theory (PT) may be in a better agreement with the postreconstructed density field at a smaller scale and a lower redshift, compared to the raw density field. A promising progress has been made in this direction in the recent literature. Hikage et al. (2017); Hikage et al. (2020) used the standard perturbation (PT) to 1-loop and derived a model for the post-reconstruction real-space and redshift-space matter power spectrum, showing that the PT model can indeed explain the reduced mode-coupling effect after reconstruction and is in a better agreement with the post-reconstruction clustering. White (2015) and Chen et al. (2019) used the Zeldovich approximation to build both Fourier space and configuration space models for the post-reconstruction field, accounting for the redshift-space distortions as well as galaxy bias, demonstrating a good agreement between the model and the simulation. These studies show the PT models perform well in describing the galaxy clustering even upto k  0.2 - 0.4h Mpc-1 at a moderate redshift. But as one attempts to extract a smaller scale information, which can potentially boost the reconstructed BAO information, it becomes more difficult for these theories to predict the nonlinear component of the information that propagates through the reconstruction operation and the agreement becomes worse.
Recently, a variety of iterative extensions to the BAO reconstruction technique have been developed, aimed at maximally extracting linear BAO information from the observed nonlinear fields (e.g., Tassev & Zaldarriaga 2012; Schmittfull et al. 2017; Hada & Eisenstein 2018, 2019; Zhu et al. 2017; Yu et al. 2017; Wang et al. 2017; Zhu et al. 2018). The details of implementation are different from study to study, but all these methods attempt to iteratively reconstruct more accurate displacement field that mass tracers should have experienced and take the divergence of the estimated displacement field as the reconstructed density field. As Baldauf et al. (2016) showed, the dark matter displacement field at lower redshift is very highly correlated with the initial density field (e.g., correlation higher than 0.95 for k < 0.5h Mpc-1 at z = 0.6 from Ota et al. (2021)) as the shift term that is responsible for the BAO degradation is much smaller than in the nonlinear density field, implying almost a complete BAO information. In fact, this shift term contribution is not only small, but is positive in the case of the displacement field, while it is negative (i.e., BAO damping) in the nonlinear density field. These iterative reconstruction methods accordingly show substantially improved BAO feature compared to the standard reconstruction, at least in the presence of very little shot noise. Note

that, if the nonlinear displacement is faithfully recovered, its divergence will not return the linear field, but will contain most of the BAO information.
We can consider this iterative operation as solving the nonlinear equation for the nonlinear displacement field with a linear operation on the filtered nonlinear density field, while iteratively correcting the smaller scale displacement until the final field becomes uniform/Lagrangian (Schmittfull et al. 2017). The standard reconstruction on the other hand is known to perform suboptimally when this filtering kernel is reduced much smaller than  7h-1 Mpc (e.g., Seo et al. 2016). Although the iterative operation is more complex than the simple, standard reconstruction, its final product could be therefore more stable on small scales, i.e., be able to recover a much smaller scale information without suffering the performance degradation. Comparing the broadband shape of the iteratively reconstructed field with the corresponding perturbation theory model, if such model could be constructed, would be quite useful for optimizing both the post-reconstruction BAO and broadband analysis. To address this point, our companion paper, Ota et al. (2021) constructs a 1-loop perturbation theory model for the method in Schmittfull et al. (2017) for mass tracers in real space and compare with the simulations.
In this paper, we numerically investigate the properties of iterative reconstructions on the BAO and also the broadband, focusing on the iterative implementation presented in Schmittfull et al. (2017). We focus on two iterative reconstruction schemes in that study that closely follow the method of the standard reconstruction scheme. The first method, noted as `O(1)' in their paper, iteratively operates to estimate the nonlinear displacement field. The second method, `the iterative standard reconstruction', was originally tested in Seo et al. (2010), but modified by Schmittfull et al. (2017). While the latter paper focused on the real-space, almost shot-noiseless dark matter field, we extend the test to the redshift space and the tracers with halo bias and inspect the components of the reconstructed field in Fourier space and in configuration space. In the process of extension, we invent a practical surrogate method for Schmittfull et al. (2017) that can be easily applied to the galaxy field with high shot noise. We inspect and compare different reconstructions mainly using three indicators: propagators as an indicator of the shift term contribution (or the BAO damping), crosscorrelation coefficients as an indicator of the residual mode coupling contribution and a signal to noise, and the shape of the power spectrum and correlation function as the combination of all terms. We compare the iterative reconstruction with the standard reconstruction at the optimal case of each method. We will define the performance in terms of how well the reconstructed field is correlated with the initial density field. Also given the lack of theory model to compare with, we will define the performance based on how close the overall clustering of the final field is close to that of the initial field.
The structure of the paper is as follows. In § 2, we explain the implementation of the iterative reconstructions for redshift space and for the biased tracers. In § 3, we present the results. Finally, in § 4, we summarize our results.
2 METHODS
The four methods of iterative reconstructions we test/develop in this paper (StdIter, StdIterSS, DisIter, DisIterSS as summarized in Tab. 1) closely follow the standard reconstruction that we describe below.
© 0000 RAS, MNRAS 000, 000­000

2.1 Reconstruction Methods

2.1.1 The Standard reconstruction: StdRec

We describe the process of the standard reconstruction developed in
Eisenstein et al. (2007b), while adopting the convention `Rec-Sym' in White (2015) and Chen et al. (2019) 1for treating the redshift-
space distortions. This is also the first step of the iterative recon-
struction.
We first start with the observed nonlinear density field of matter or galaxies, ~sNL(x), in observed location in x, apply the continuity equation to estimate the displacement field. To ensure the
continuity equation to be valid against the effect of shot noise and
the nonlinearity on small scales, we use a smoothing Gaussian Kernel, S(k). While S(k) can be chosen to be anisotropic, we choose
the isotropic form as our default:

S(k) = exp - k22 .

(1)

4

 is the smoothing scale and we note the definition of the smoothing scale varies in the literature typically by 2. Later, we will decrease the smoothing scale gradually during iteration for iterative reconstruction
The resulting real-space displacement estimator can be written in Fourier space as:

sr(0)(k)

=

-

ik k2

~ sNL (k) b(1 + µ2)

S(0)(k)

,

(2)

where the superscript `(0)' stands for the quantities before recon-
struction. The displacement field in configuration space x is then derived
by Fourier-transforming sr(0)(k);

sr(0)(k) -F-o-ur-ie-r -Tr-an-s-fo-rm sr(0)(x).

(3)

The galaxies and the reference particles are displaced and their positions are updated.

Galaxies: x1 = x0 + s(0)(x0)

(4)

where s(0)(x0) = sr(0)(x0) + f (sr(0) · z^)z^, and

(5)

Reference:q1 = q0 + s(0)(q0),

(6)

where f is the growth rate to account for the additional line-of-

sight displacement due to redshift-space distortions, x0 means the observed nonlinear location for the galaxies and q0 means the ini-

tial uniform location of the reference particles.

The

two

density

fields

(1)
d

of

galaxies

and

(1)
s

of

reference

particles are derived, respectively, and the reconstructed density

field after the first reconstruction is then

(re1c)(x1)

=

(1)
d

-

(s1).

(7)

In this paper, we use StdRec to denote the standard reconstruction.

2.1.2 Standard iterative reconstruction: StdIter
The iterative methods we test here can be classified into two types. The first type is an extension of the standard reconstruction by adding iterative steps, as described in this section. This iterative

1 The same convention was called `Rec-Cohn' in Ding et al. (2018)

© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 3

reconstruction corresponds to `extended standard reconstruction' scheme defined in Schmittfull et al. (2017). It is based on the iterative reconstruction tested in Seo et al. (2010) with a few modifications, mainly decreasing the smoothing scale in consecutive iterations steps. Schmittfull et al. (2017) found this modification made a major difference in the performance.
We will expand the steps described in § 2.1.1 by iteratively reducing the smoothing scale. Since any remaining small scale information we want to extract must be present in (d1)(x1), we apply the continuity equation on (d1)(x1) and derive

sr(1)

(k)

=

-

ik k2

(d1)(k)S(1)

(k)

for matter. There are a few differences compared to the first step (i.e., the standard) reconstruction.

· Since we already have taken into account the most of the anisotropy in calculating (d1), we do not include the corresponding corrections after the first reconstruction. The bias correction after
the first reconstruction is discussed in § 2.1.7. · Since the residual field (d1)(k) is mainly confined in small
scales with reduced nonlinearity, sr(1)(k) would be incremental to sr(0)(k).
· S(1) is using a smaller damping scale 1 than 0 for S(0). By default, we decrease the smoothing scale continuously by 2 in
this paper to inspect the limit of reconstruction. In contrast, Schmit-
tfull et al. (2017) sets a minimum sm so that the smoothing scale does not decrease when it reaches this minimum scale even though
iteration continues. If we set the minimum smoothing scale, we find
that the reconstruction result converges once the smoothing scale
reaches that minimum scale as shown in Ota et al. (2021).

After the second step reconstruction, the particles will be displaced as follows:

galaxies : x2 = x1 + sr(1)(x1) = x0 + s(0)(x0) + sr(1)(x1) (8) references : q2 = q1 + sr(1)(q1) = q0 + s(0)(q0) + sr(1)(q1). (9)

The

density

field

of

galaxies

(2)
d

will

be

updated

based

on

Eq.

8

and sr(k) for the next iteration will be derived. After the n-th re-

construction,

sr(n)

(k)

=

-

ik k2

(dn)(k)S(n)

(k).

Note that sr(n)(x) is always estimated from the density field of the (displaced) galaxies. It does not care where the reference particles are located. After n-th reconstruction, the displaced particles will end up in the following position:

xn = x0 + s(0)(x0) + sr(1)(x1) + ... + sr(n-1)(xn-1)

(10)

= x0 + snet (x0),

(11)

where

snet (x0) = x0 + s(0)(x0) + sr(1)(x1) + ... + sr(n-1)(xn-1), (12)

and the displaced reference particles will be located in

qn = q0 + s(0)(q0) + sr(1)(q1) + ... + sr(n)(qn-1) (13) = q0 + snet (q0). (14)

We then evaluate

(n)
rec

=

(n)
d

-

(sn).

(15)

4 Hee-Jong Seo et al.

Table 1. Summary of the reconstruction methods investigated in this paper. The last column rec shows how the reconstructed clustering is defined in each case.

Name
StdRec StdIter StdIterSS DisIter DisIterSS

Description
Standard reconstruction (§ 2.1.1) Standard Iterative reconstruction (§ 2.1.2) Single-field Standard Iterative reconstruction (§ 2.1.3) Iterative displacement reconstruction (§ 2.1.4) Reference-field iterative displacement reconstruction (§ 2.1.6)

Iteration
No Yes Yes Yes Yes

Tracers
galaxies and reference field galaxies and reference field
reference field galaxies
reference field

rec
d - s d - s
s · ·

Pixel window function and shot noise Corrected Corrected Corrected Not corrected Not corrected

For simplicity, we will refer to this method as `StdIter' and

we note that this method involves two fields, i.e., the displaced

galaxy fields and the displaced reference fields. The final outcome

is the difference of the two density fields just like the standard re-

construction, and therefore we can consider this as a density field

reconstruction.

We

examine

the

power

spectra

of

(n)
d

and

(n)
s

separately

to

understand the information transfer between the two fields during

iteration, and they are referred to as the DD field and the SS field,

respectively.

In the following section, we will compare the performance of

such iterative reconstruction for dark matter and biased tracers as a

function of n in comparison to the standard reconstruction (i.e. n =

1). Again, we will define the performance in terms of how well the

reconstructed field is correlated with the initial density field. Also

given the lack theory model to compare with, particularly in the

redshift space and with galaxy bias, we will define the performance

based on how close the overall clustering of the final field is close

to that of the initial field.

2.1.3 A Single-field Standard Iterative Reconstruction: StdIterSS
The standard iterative reconstruction explained in 2.1.2 gradually transfers the information from the displaced galaxy fields to the displaced reference fields, as will be shown in § 3. Since we do not introduce the minimum smoothing scale, after a large number of iterations, StdIter starts to degrade, but we find that the density field of the displaced reference field alone, ns , continuously improves in terms of its correlation with the initial field, showing a more stable convergence behaviour than StdIter. That is, at this limit, the power spectrum of s,I alone is sufficiently reconstructed and one could choose to use only the reconstructed reference field for our cosmology analysis. We call this surrogate method `StdIterSS'.

2.1.4 Iterative Displacement Reconstruction: DisIter
The second type of iterative reconstruction in this paper is reconstructing the displacement field itself, following Schmittfull et al. (2017), while there are a few minor differences in the setup. This method therefore can be classified as a displacement field reconstruction. In particular, we extend the iterative method `O(1)' of Schmittfull et al. (2017) that has been tested with real-space dark matter particles, to redshift space and biased tracers. Unlike StdIter that evaluates the density fields of the displaced particles, this method evaluates the displacement field at the final position, i.e., at the estimated Lagrangian location of the observed galaxies.
The procedure of iteration is the same upto Eq. 12. The difference is that, after n-th reconstruction, we evaluate the divergence of snet(xn). It is crucial to evaluate snet at its final position xn not at its original, observed position x0 (i.e., Eulerian position). The latter approximately returns the observed nonlinear density field.

The same aspect also makes this process different from estimating a later time velocity divergence field, where one evaluates at the Eulerian position.
In order to estimate the reconstructed displacement field snet(xn), we use the mass-weighted scheme. I.e., we collect all particles that ended up in a given mesh after applying the Cloud-inCell (CIC) assignment, and derive the mass weighted sum of the displacement for each pixel centered at xp, ^ net(xp):

^ net(xp)

=

i WCIC(xp, xi)snet(xi) , i WCIC(xp, xi)

(16)

where snet(xi) is the reconstructed displacement vector of the i-th particle, and WCIC is the pixel window function indicating that we are using the Cloud-in-Cell assignment. For pixels with no particles found, we incorrectly set ^ net(xp) = 0.
The reconstructed field is then evaluated as the divergence of ^ net. In the Fourier space,

(n)
rec

(k)

=

ik

·

^ net(k).

(17)

As a difference from Schmittfull et al. (2017), we do not truncate the modes for k greater than some maximum k.
The procedure is the same for the real space and the redshift space, except that f =  = 0 in § 2.1.1 in real space.

2.1.5 Dealing with sparsity and the pixel window effect
This method can be extended to biased tracers as biased tracers would have experienced the same displacement field as the matter except for very small scales where the internal motion of halos begins to matter. In reality, the biased tracers are often in a much smaller number and as a result many locations of the field are empty without displacement tracers. To mitigate this effect, Schmittfull et al. (2017) pads empty pixels with randomly chosen nearly, nonempty pixels. However, this procedure becomes increasingly inefficient with a decreasing number density: for biased tracers, most of the pixels would be empty if we set up the size of each pixel to be e.g., 5h-1 Mpc for a very dense population with the number density of 0.001h-3 Mpc3. In this paper, we therefore do not pad the empty pixels.
The problem of missing displacement tracers appears more tricky to deal with than missing tracers in the density field. First, the overall amplitude is reduced by the fraction of the zero-ed pixels, just like the effect of the survey window function. We correct for this with a simple multiplicative rescaling of the amplitude by the ratio of the periodic box volume to the effective volume traced by non-empty pixels (e.g., eq. 21 of Peacock & Nicholson 1991). Also, the sparsity introduces a large spurious power at large k, as will be shown in § 3.1.4. We try to mitigate such effect using a surrogate model DisIterSS or/and applying debiasing (§ 2.1.7), as explained below, when the sparsity becomes an issue.
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 5

Table 2. N-body Simulations used for different analyses. We utilize multiple sets of simulations, instead of a single consistent set, to inspect different aspects of reconstructed clustering due to our limited computational resources. All used a flat CDM cosmology based on Planck Collaboration et al. (2016) with m = 0.3075, bh2 = 0.0223, h = 0.6774, and 8 = 0.8159. The last column, `Purpose' describes for which aspect each simulation was used. `Original mesh' is the grid size used for the force calculation and `FFT mesh' is the grid used for reconstruction and calculating the clustering statistics. For a halo field, we use two halo catalogs from the FastPM mock (Ding et al. 2018), mainly due to a simulation availability, and we note the number density and the corresponding bias `b' for the two catalogs.

L500

z Lbox(h-1 Mpc) Nsim Original mesh FFT mesh

0.6

500

5

15363

5123

1/n(h3 Mpc-3) 0.86

Purpose Matter, lowest shot noise case.

subL500

23.00

Matter, increased shot noise

L1500 0.6

1500

1

15363

10243

23.28

Matter, BAO feature

FastPM 1.0

1350

1

40963

5123

817.45 (b=1.88), 265.44 (b=1.48)

Halos, high shot noise

At the limit of one particle per mesh, i.e., with almost no empty pixels, we find that the mass-weighted displacement field from Eq. 16 has the ordinary CIC pixel window function effect largely cancelled out between the numerator and the denominator, but there is a residual effect at the level of 1% at k  0.2h Mpc-1 with our FFT mesh resolution (Ota et al. 2021). With more empty pixels, this pixel window function effect appears increasingly severe and more complex in a way correlated between the pixel resolution and the mean particle spacing, e.g., the interplay between damping of power due to low resolution and the aforementioned small scale spurious power. A volume-weighted measurement using the Delaunay tessellation may remedy this problem (e.g., Pueblas & Scoccimarro 2009), but implementing such method also requires a large number of particles per tessellation pixel, again limiting a pixel resolution. In a future paper, we plan to correct for this window function effect, but in this work, we do not correct for the pixel window function, nor do we subtract shot noise contribution in the case of DisIter and DisIterSS, and we proceed with a warning that our clustering measurement of the reconstructed displacement would be subject to an uncorrected pixel window function effect.

2.1.6 Iterative Displacement Reconstruction using the reference fields: DisIterSS
In order to mitigate the sparse sampling problem in § 2.1.4 without sacrificing the pixel resolution, we invent and test a surrogate method where we trace the displacement of the reference field snet (q0) in Eq. 14.
There are two options to evaluate such displacement field traced by reference fields. The first is to evaluate it at the initial, uniform positions of the reference particles. We found that this option ultimately reproduce the observed nonlinear field itself after many iterations. Instead, we have to evaluate such displacement field in the final, non-uniform positions of the reference particles:

^ net(qp)

=

i WCIC(qp, qi)snet(qi) , i WCIC(qp, qi)

(18)

That is, both for the galaxy particles and reference particles, the reconstructed displacement has to be evaluated in its estimated Lagrangian/original position, just like the true displacement field 2, and it is not important that the tracers of the displacement field are uniform or nonuniform. We call this method as `DisIterSS'.
In the limit of the near perfect reconstruction, ^ net(xn) or

2 The true displacement field also is highly correlated with the linear field if it is evaluated in the Lagrangian position, but returns poorly-correlated field if it is evaluated in the final Eulerian position.
© 0000 RAS, MNRAS 000, 000­000

^ net(qn) would be close to the true displacement field and the final positions of particles would be Lagrangian. Ota et al. (2021) shows that in reality, the reconstructed displacement field does not perfectly converge to the true displacement field. As we will show, the displaced particles at the last step are approximately uniform on large scales, but the uniformity decreases on small scales. .

2.1.7 Dealing with halo/galaxy bias

For the biased tracers, after the first reconstruction, the displaced galaxies have moved to their estimated Lagrangian positions. As they are still biased tracers in the Lagrangian positions, however, clustering of the displaced tracers is subject to the Lagrangian bias b - 1 on large scales:

d  (b - S(k))L + ...

(19)

s  S(k)L + ....

(20)

Therefore an iteration based on d will introduce a substantial, additional large scale displacement to the particles that are already near their Lagrangian positions. We adopt several options in dealing with bias in iterations.

(i) We first experiment the most straightforward extension of
StdIter. We rescale all steps of d with 1/b (except for the first step, as the first step already has the bias correction in d) and follow the exact same procedure as StdIter:

sr(n)(k)

=

ik - k2

1 b

(dn)(k)S(n)(k).

This reduces, but does not completely fix the problem of nonvanishing large scale displacement field after the first reconstruction. But we find that, despite the incorrect estimation of the large scale flow in the second and higher reconstruction steps, the combination of d and s still returns an improved propagator. The fiducial bias here was estimated from the real-space cross power spectrum between the biased and the matter fields in Ding et al. (2018). In real data, we may not be able to estimate a precise large-scale bias. But the effect of an incorrect bias within 10% has been shown small (Mehta et al. 2011; Sherwin & White 2019). Moreover, one can consider updating bias as well as other assumed fiducial cosmology parameters based on the reconstructed field in each step.
(ii) The non-vanishing d on large scale for the biased tracers (Eq. 20) is much more detrimental for DisIter as we are trying to iteratively recover the displacement field itself in this method. To mitigate this issue, we have to remove the Lagrangian bias. We therefore debias the observed field before starting the reconstruction; i.e., a debiased density field is assigned to each mesh based on the measured density of the galaxies in that mesh:

6 Hee-Jong Seo et al.

debiased

=

b ¯ b

-1 + 1,

(21)

¯ debiased

b

where

b ¯ b

is the measured density field of the galaxies. We then

displace the meshes of this new density field in the subsequent it-

erations. It is equivalent to assigning a particle in the middle of

each mesh with this debiased density as its weight and displace

them. In the sense that we trace the displacement of reference par-

ticles/meshes, but with a debiasing weight, this treatment can be

considered as a hybrid between DisIter and DisIterSS. Using de-

biasing also reduces the aforementioned effect of sparsity. For com-

parison, we also test debiasing with StdIter.

We summarize all these methods in Tab. 1.

2.2 Estimators for comparison
In the following section, we will compare the two main and their surrogate iterative reconstruction methods with the optimal case of the standard reconstruction. We use three estimators to evaluate the performance of reconstruction. First, we use the propagator, which is the cross-correlation between the initial density field and the final or reconstructed density field, normalized with the power spectrum of the initial density field:

C(k)



<

i(k)z (k)

> ,

(22)

Pi(k)

where z is either the observed late time density field or recon-

structed density field and i is the initial linear density field after it

is scaled with the growth factor. This estimator measures the damp-

ing of the BAO, i.e., approximately the shift term P13/Plin contribution.

The second estimator is the cross-correlation coefficient:

R(k)



<

i(k)z (k)

> ,

(23)

Pi(k)Pz(k)

where Pz is the observed power spectrum without shot noise subtraction. This cross-correlation coefficient can be considered as the signal-to-noise weighted propagator in a Gaussian limit. In addition, this estimator approximately measures the 1-loop modecoupling contribution P22, as pointed out by Ota et al. (2021):

R(k)  1 - 1 P22

(24)

2 Plin

Finally, we are also checking the power spectrum and correlation function of each case to inspect the net broadband shape of the resulting clustering as well as the BAO feature.
In Fourier space, we inspect the transverse modes by looking at the modes with 0.1 µ < 0.2 3 and the line of sight modes by 0.9 µ < 1, where µ = k^ ·z^. Inspecting the modes in separate µ bins increases the sample variance. Whenever we separate the modes, we therefore reduce the noise by applying Savitzky-Golay smoothing filtering (Savitzky & Golay 1964) for a better visualization. In some plots, we will estimate the characteristic BAO damping scale

3 We use µ = 0.1 - 0.2 instead of µ = 0 - 0.1 to reduce the mode discreteness at very low k.

nl,eff before and after reconstruction using C(k = 0.2h Mpc-1) in each of the two µ bins:

C(k0.2) = (1 + µ2) exp

- k02.22nl,eff 4

,

(25)

such that nl,eff from µ = 0.1 - 0.2 (µ = 0.9 - 1) approximately measures the transverse (the line-of-sight) BAO damping scale when defined at k = 0.2h Mpc-1. This should not be taken as an ac-
curate measure of the performance, especially when the measured
damping deviates from a Gaussian damping (e.g., Eq. 25) or when there is a noisy feature at k = 0.2h Mpc-1. Therefore, we also inspect C(k) and R(k) at k = 0.4h Mpc-1.
All spherically averaged multipoles (e.g., for the BAO feature
inspection) presented are not smoothed using this filtering. In the
configuration space, we present the Legendre multipoles.

2.3 Simulations
We use three sets of simulations in this paper, which are listed in Table 2. We utilize multiple sets of simulations, instead of a single consistent set, due to our limited computational resources, to inspect different aspects of the reconstructed clustering. They all assume a flat CDM cosmology based on Planck Collaboration et al. (2016) with m = 0.3075, bh2 = 0.0223, h = 0.6774, and 8 = 0.8159.
· Full N-body simulation using the MP-Gadget code (Feng et al. 2018) with the box volume of 500h-1 Mpc. We use the average of five simulations. The simulation evolves 15363 particles from z = 99 by computing forces in a grid of 15363 and, to reduce the data storage and the computational time/memory for the analysis, we subsample 4% of the output particles at z = 0.6 4. This set is called `L500' in this paper. We use a grid of 5123 to Fourier-transform and reconstruct this nonlinear field. With 4% subsampling, there is approximately one particle per grid of 5123. This set of simulations was used to reach the highest particle and mesh resolution and the lowest shot noise to compare with the result of Schmittfull et al. (2017). We also test 0.15% of the output particles to test the effect of sparsity on reconstruction and we call this sample `subL500'.
· Full N-body simulation using the MP-Gadget code with the box volume of 1500h-1 Mpc. We call this simulation `L1500'. This simulation is mainly used for the BAO feature inspection, as the volume of L500 is believed to be small for the robust BAO feature. This simulation also evolves 15363 particles from z = 99 by computing forces in a grid of 15363 and we subsample 4% of the output particles at z = 0.6. We use a grid of 10243 to reconstruct and therefore only 13.5% of all the grids/meshes contain a mass tracer on average. We use a pair of simulations that match in terms of phase and the broad-band shape, one with the BAO feature in the initial field and one without the BAO feature (Prada et al. 2016; Ding et al. 2018). The cosmic variance as well as any spurious effect on the broadband shape due to sparsity (e.g., for DisIter) will largely cancel out.
· FastPM simulation. We use two halo catalogs of the FastPM simulations (Feng et al. 2016) used in Ding et al. (2018) and Schmittfull et al. (2017). The simulation uses a box of 1380h-1 Mpc and evolves 20483 particles through 40 time steps linearly spaced between a = 0.1 and a = 1 by computing forces

4 C.f. Schmittfull et al. (2017) at z = 0

© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 7

Figure 1. Comparison of different iterative schemes for matter in real space. Shot noise is negligible. Top: cross-correlation coefficient. Bottom: power spec-
trum divided by the linear P(k). Note the different k ranges between the top and the bottom panels. The black lines show the pre-reconstruction measurements
and the colored lines show the post-reconstruction fields after different number of iterations. From the left to right, we are showing DisIter, StdIter, DisIterSS, and StdIterSS, as summarized in Table 1. The red line in the StdIter case corresponds to the standard, single step reconstruction with sm = 20h-1 Mpc. As reference lines to guide our eyes, the solid grey line marks the unity and the dotted grey lines in the top panels mark 0.8 at k = 0.2h Mpc-1. The iteration was conducted from the initial smoothing scale of 20h-1 Mpc while decreasing by 2 until it reaches the 9-th reconstruction and the final smoothing scale of 1.25h-1 Mpc. Here, we are showing only the 1st (red), 3rd (blue), 5th (magenta), 7th (green), and 9th (orange) steps.

on a 40963 particle-mesh grid. We use output halo catalogs with b = 1.48 and 1.88 at z = 1. The grid used for reconstruction is 5123.
In all cases of the iterative reconstruction, the iteration was conducted with the initial smoothing scale of 20h Mpc-1 and the smoothing scale decreased by 2 until it reaches the 9-th reconstruction and the final smoothing scale of 1.25h-1 Mpc. As a caveat, Schmittfull et al. (2017) used the initial smoothing scale of 14h-1 Mpc (equivalent to 10h-1 Mpc in their definition).

3 RESULTS
3.1 Iterative reconstruction of the matter field
3.1.1 Real space
We first apply the different iterative reconstruction schemes introduced in the previous section to the real-space matter field to check the optimal limit of each method. In Figure 1, we present the crosscorrelation coefficient R(k) (top) and the power spectrum (bottom) at z = 0.6 using L500 that has negligible shot noise (Table 2). While our performance evaluation will be mainly qualitative, we add the guiding lines that mark R(k) = 0.8 at k = 0.4h Mpc-1 and quantitatively compare the performance at this wavenumber whenever possible.
The left panel shows the iterative displacement reconstruction, DisIter, can recover R(k)  0.9 at k  0.5h Mpc-1 at the final smoothing scale, as observed by Schmittfull et al. (2017). The constraint wave number kC 5 suggested by McQuinn (2020) for this

5 The constraints wavenumber kC is defined such that the number

of modes smaller than kC equals the number of constraints: kC 

0.4

N 4

1/3

n¯ 10-3 Mpc-3

1/3
where N = 3 representing 3 positions for each

galaxy.

setup is 3.59h Mpc-1, in agreement with the efficient reconstruction we observe at high k. Note that DisIter is not efficient with large smoothing scales in the first few iterations, compared to the StdIter (second column), but then it quickly improves with increasing iterations, being as efficient as or perhaps better than the other cases at the final step, judging based on k 0.4h Mpc-1.
The second column shows the standard iterative reconstruction (§ 2.1.2). StdIter quickly reaches its best performance in a few iterations (we identify the magenta line for sm = 5h-1 Mpc, i.e., in the fifth reconstruction, as the best performance in this case), but then starts degrading on a large scale as the iteration continues. We could potentially remedy this degradation by setting a minimum smoothing scale. Note that the red line of StdIter, i.e., the first step of StdIter is the single step standard reconstruction with sm = 20h-1 Mpc, returning R(0.4) = 0.53, when the iterative reconstruction with n = 5 (magenta) shows R(0.4) = 0.95.
The third and fourth panels show the two surrogate methods, using only the displaced reference/random particles; i.e., DisIterSS (§ 2.1.6) tracing the displacement field of the reference particles and StdIterSS (§ 2.1.3) being the reconstructed density field of the reference/random particle of StdIter. These alternatives, in particular DisIterSS are slightly less efficient for k 0.4h Mpc-1 than their primary counterparts, but they still show R(0.4) > 0.8 at k < 0.4h Mpc-1. It is because, after many iterations, the information has been effectively transferred from the displaced mass field to the displaced random field. An advantage of DisIterSS compared to DisIter, is that it does not suffer the empty pixel problem in deriving the displacement field. As an advantage of StdIterSS, it is a byproduct of StdIter, it requires only one field in the final step, and has a more consistent convergence behavior with decreasing smoothing scale during iteration.
Fig. 2 shows the individual component of StdIter: the displaced reference/random component is equivalent to StdIterSS in the top panels and the displaced mass field, which we call `StdIterDD' or 'DD' for convenience, is in the bottom panels. One can

© 0000 RAS, MNRAS 000, 000­000

8 Hee-Jong Seo et al.

Figure 2. The components of StdIter from Fig. 1 to show how the mass and the reference field evolves for all cases of iterative reconstructions. The top panels show the properties of the displaced galaxy fluctuation in each step (i.e. StdIterSS) and the bottom panels show the displaced reference/random fields (i.e. the DD component). In each step of DisIter and StdIter the displacement of the next iteration is constructed based on the DD component shown in the bottom panels.

see that, in C(k) (middle column), the initial information in the displaced mass field decreases and shifts to a smaller scale with increasing iterations (and therefore, a decreasing smoothing scale). Interestingly, the cross-correlation R(k) of the displaced mass (bottom left) during the first few iterations remains near unity at small k, implying the decrease in the linear information is proportional to the decrease in power so that the signal to noise does not decrease under the Gaussian approximation. Moreover, R(k) of the DD component looks even better than R(k) of the SS component for the first three reconstructions. In Fig. 8, we will show that, indeed, most of the BAO feature seems to reside in the displaced mass field after the first reconstruction when a large enough smoothing scale, e.g., 20h-1 Mpc, is used.
Fig. 1 and 2 also show the power spectrum of all cases. We find that DisIter returns the most stable agreement with the linear P(k) for k < 0.3h Mpc-1, while StdIter shows the most complex behaviour. As a caveat, if DisIter recovered the true nonlinear displacement field, its power spectrum should deviate from the linear P(k) (Baldauf et al. 2016). The fact that DisIter converges close to the linear P(k) implies that we are not quite recovering the nonlinear displacement field, even though we are pulling out most of the linear information in the nonlinear displacement field. The very small, but nonzero power of the DD component at the 9-th reconstruction (i.e., the orange line in the bottom middle panel of Fig. 2) implies that we are not perfectly recovering the uniform Lagrangian distribution on small scales. For more discussion on this aspect, we refer the readers to Ota et al. (2021).
In summary, we find that all the iterative methods we are testing are performing comparably at the negligible shot noise limit when redshift-space distortions and galaxy/halo bias are not included. Among these options, DisIter shows the best behaviour in terms of the convergence in R(k) and P(k) to the lin-

ear field. The single-step standard reconstruction performs significantly worse than the later-stage iterative reconstruction when the starting smoothing scale of the iteration is the same as the singlestep smoothing scale, confirming the result in Schmittfull et al. (2017). This is expected as the effective smoothing scale used is very different between the two cases. The difference we find could be somewhat more severe than Schmittfull et al. (2017), as they used an initial smoothing scale of 14h Mpc-1 that is more optimal for the standard reconstruction. A more fair comparison, however, would be a comparison between the best performance iterative reconstruction and the best performance single step reconstruction at any smoothing scale. In the next section, we will make such a comparison after including redshift-space distortions and shot noise.
3.1.2 Redshift-space distortions
We then move to the redshift space. We select three iterative snap shots for each method that we subjectively consider representing the steps to its optimal performance in real space. We also focus on the two primary iterative methods, DisIter and StdIter. Fig. 3 shows the three estimators in the redshift space along the transverse direction µ = 0.1 - 0.2 (solid line) and µ = 0.9 - 1.0 (dashed line). Note that we change the y-axis scaling of C(k) and P(k) to a logarithmic scale hereafter, as the range of the scale to cover increased. As a result, these plots are less sensitive to a small offset when C(k) and R(k) reach near unity. To ease the comparison , we quote the values of nl,eff (E.q. 25) in the middle panels to approximately represent the performance of C(k) at k = 0.2h Mpc-1, but these estimates do not necessarily represent the performance on much smaller scales. When compared to Fig. 1, focusing on C(k) and R(k), even the nearly transverse Fourier modes are degraded in terms of its cross-correlation with the initial field when
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 9
,

Figure 3. Effect of including redshift-space distortions in the iterative reconstruction. We focus on StdIter and DisIter. The iterative steps were selected based
on Fig. 1 for each method: 5th, 7th, 9th for DisIter and 1st, 3rd, 5th for StdIter. The same color scheme for each iterative step as in Fig 1. The left panel shows
DisIter and the right panel shows StdIter. The solid lines are for the modes with µ = 0.1 - 0.2 and the dashed lines are for the modes with µ = 0.9 - 1.0. Note
that we have changed the y-axis scaling of C(k) and P(k) to a logarithmic scale. To ease the comparison in the logarithmic scaling, we quote the values of nl,eff (in h-1 Mpc) for each µ bin (E.q. 25) in the middle panels to approximately represent the performance of C(k) at k = 0.2h Mpc-1. For example, the two values of nl,eff, 3.19 and 8.13, in magenta in the top middle panel represent the damping scales in h-1 Mpc for µ = 0.1 - 0.2 and µ = 0.9 - 1, respectively, after the 5th reconstruction with sm = 5h-1 Mpc.

Figure 4. The SS and DD component of StdIter in redshift space at three snapshots of iteration to show how the mass and the reference field evolves for all case of iterative reconstructions. The solid lines are for the modes with µ = 0.1 -0.2 and the dashed lines are for the modes with µ = 0.9 -1.0.
the reconstruction is done based on the density field measured in the redshift space; for DisIter, R(k) = 0.8 at k = 0.65h Mpc-1 in real space, but at k = 0.5h Mpc-1 in redshift space. For the nearly line-of-sight modes (µ = 0.9 - 1.0), the performance is much more degraded: R(k = 0.37h Mpc-1) = 0.8.
In terms of power spectrum, we find that, for DisIter the iteration tends to bring up the damped power, while StdRec tends to damp small-scale power more for the first few iterations along the line of sight, as if it makes the finger-of-God effect more severe. With increasing iterations, both methods seem to converge with respect to each other in terms of P(k), which could be a mere coincidence as a further iteration with StdIter beyond the magenta line makes the convergence worse.
Fig. 4 shows that in terms of cross-correlation R(k), after the first reconstruction, again, the DD field alone contains most of the signal to noise for the recovered initial information given the
© 0000 RAS, MNRAS 000, 000­000

smoothing scale, which is similar to Fig. 2. Along the line of sight, we find that the trend persists even for the second and the third reconstructions. This trend of the DD component including most of the information in the beginning disappears when the smoothing scale decreases, either during iteration or by decreasing the initial smoothing scale.
We consistently observe that, given the convention we use for treating redshift-space distortions, the reconstruction efficiency along the line of sight is lagging behind the transverse direction such that the optimal reconstruction smoothing scale along the transverse direction tends to be larger than the optimal reconstruction smoothing scale for the line of sight. This could be simply due to the larger signal to noise along the line of sight. Using anisotropic smoothing scale, i.e., using a smaller smoothing scale or a larger smoothing scale along the line of sight does not seem to remedy this mismatch. A more dedicated treatment of redshiftspace distortions such as in Wang et al. (2020) could be adopted to improve the line of sight information beyond what we present in this paper.
3.1.3 Iterative reconstruction in comparison to the standard reconstruction
So far, we have observed the iterative reconstructions improving the reconstruction gradually in each step while the smoothing scale is being updated towards a smaller scale. In this section, we compare the iterative reconstruction and the single-step standard reconstruction. Fig. 5 shows a few examples of the standard reconstruction with different smoothing scales. sm = 20h-1 Mpc corresponds to the first step before iteration and performs much worse

10 Hee-Jong Seo et al.
than the iterative reconstruction. For a more fair comparison, we single out a few optimal cases of the standard reconstruction in terms of the maximum cross correlation over a broader k range; in our setup, we identify it to be 10 or 7h-1 Mpc 6, as shown in Fig. 3. When comparing Fig. 5 and Fig. 3, it appears that the optimal standard reconstruction performs nearly as well as the optimal iterative reconstruction in terms of C(k) and R(k), giving R(k) = 0.8 at k = 0.4h Mpc-1 for the transverse modes when using sm = 7h-1 Mpc. On a closer look, however, one can notice that for the standard reconstruction, using 7h-1 Mpc already starts degrading the correlation with the initial field over k < 0.3h Mpc-1. The degradation is more obvious in the P(k) plot due to the range of the plot; it begins to suffer a suppression even on large scales as we decrease the smoothing scale (right panel of Fig. 5). The degradation is about 3% off in R(k) an 7% off in C(k), and 10% off in P(k) from the linear theory at k = 0.2h Mpc-1 for the transverse modes. A deviation from unity in R(k) implies that a mode coupling starts to affect even very large scales. Such degradation has been observed previously (e.g., Seo et al. 2016) and Hikage et al. (2017) reproduced the trend using a PT theory 7. This offset from the linear P(k) and Gaussian C(k) on large scales could potentially affect the goodness of the BAO fitting, e.g., the goodness of the empirical, Gaussian BAO damping model for the BAO-only analysis and certainly the full post-reconstruction power spectrum modeling unless we can correctly account for it. The deviation becomes much more severe at smaller smoothing scale, while the iterative reconstruction shows a more stable convergence with decreasing smoothing scale.
To summarize, we find that when reconstruction is aggressively performed to exploit as much information as available, taking the iterative step allows us to do so more `stably', i.e., without causing a substantial deviation from the linear theory model on large scales. Such stability can be advantageous in terms of the goodness of fit for the BAO-only analysis as well as the broadbandRSD analysis using the post-reconstructed field.
3.1.4 Shot noise
We will show the effect of more realistic shot noise and galaxy bias in § 3.4, but here we introduce an incremental shot noise and observe how the performance of the iterative reconstruction changes due to this shot noise. Fig. 6, in comparison to Fig. 3, shows the effect of increasing the shot noise from n¯ = 1.18h3 Mpc-3 to 0.0442h3 Mpc-3 using subL500. With such a small additional shot noise, most of the pixels (i.e., 96%) of subL500 become empty if we want to reach a mesh resolution of  1h-1 Mpc. This can be treated properly for density field-based reconstructions such as StdIter and StdIterSS, but DisIter lacks the tracers of the displacement field in the majority of the pixels and this introduces an artifact in P(k) as the high k upturn shown in the top right panel of Fig. 6 (as discussed in § 2.1.5). DisIterSS (third row) does not show such a strong spurious feature, as the displacement field is traced by the reference particles that are prevalent. We therefore adopt a mesh-based hybrid between DisIter and DisIterSS for the biased tracers in § 3.4.
6 The optimal smoothing scale will depend on the shot noise and the redshift. 7 5h-1 Mpc of the smoothing scale in Hikage et al. (2017) corresponds to our 7h-1 Mpc.

3.2 The BAO feature
In the previous section, we identified the advantage of the iterative reconstructions at the small smoothing scale limit in terms of the agreement with the linear theory model on large scales. While the propagator comparison indirectly indicated a comparable reconstructed BAO feature between the iterative and standard reconstruction, we want to directly inspect the resulting BAO feature in each method for the consistency check.
We use a pair of wiggle and nowiggle L1500 simulations to single out the BAO feature in different reconstruction conventions. In Fig 7, we compare the BAO feature in various iterative methods, in comparison to the standard reconstruction. The top and bottom panels show the spherically averaged real space and redshift space, respectively. The left panels show all four iterative methods with its optimal final smoothing length we chose in comparison to the single-step standard reconstruction using the same initial smoothing scale (red, 20h-1 Mpc). Dotted line is the input power spectrum, the black solid line is the nonlinear power spectrum. All iterative methods start from sm = 20h-1 Mpc. Blue, orange, magenta, and green show the optimal iterative reconstruction steps we identified in the previous sections. The right panels again show StdIter with sm = 5h-1 Mpc, but this time in comparison to the optimal standard reconstruction with sm = 10h-1 Mpc. This figure shows that in terms of the BAO feature alone, the optimal standard reconstruction (blue line) indeed appears to contain as much of the BAO signal as the iterative methods. The actual signal to noise of the BAO measurement would also depend on the covariance structure of the post-reconstructed field, which we will investigate in a future paper.
Note that any effect on the broadband due to using a small smoothing scale has been canceled out in this figure. Given the near equally well-constructed BAO signal for different methods in its own optimal setup, choosing the iterative reconstruction versus the standard reconstruction would mainly depend on the consideration of the broadband modeling. We could aim at a method that produces a power spectrum that is in a better agreement with the linear theory model and/or could aim at a method that gives an easier PT model construction. The iterative step certainly makes the PT model construction more challenging (Ota et al. 2021), but the simulation result shows a better convergence to the linear theory model on large scales. On the other hand, the PT model performs promisingly well for the standard reconstruction, but becomes increasingly worse at the smoothing scale that can give the BAO feature comparable to the iterative reconstruction. For example, the SPT model in Hikage et al. (2017) works well for sm  10h-1 Mpc (our 14h-1 Mpc) at z = 1 and the Zeldovich approximation in Chen et al. (2019) performs well for sm = 15h-1 Mpc (our 21h-1 Mpc) at z = 0 for describing the full power spectrum over k < 0.2 - 0.4h Mpc-1, but in both cases, the agreement worsens with a smaller smoothing scale. Weighing up these pros and cons of the iterative steps will require further investigation.
3.3 Configuration space picture
Using L1500, we observe how these iterative reconstructions appear in the configuration space. We focus on StdIter, and compare its components with the standard reconstruction. From the previous sections (e.g., Fig. 1), StdIterSS (the SS component of StdIter) was found to be qualitatively similar to DisIterSS and DisIter, so showing StdIterSS is sufficient for understanding the configuration space picture of the other iterative methods.
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 11
Figure 5. The single step standard reconstruction. Here we focus on sm = 20, 10, and 7h-1 Mpc, which are the best cases of the standard reconstruction we identified for our setup. The solid lines are for the modes with µ = 0.1 - 0.2 and the dashed lines are for the modes with µ = 0.9 - 1.0. When compared to Fig. 3, the single step standard reconstruction with sm = 7h-1 Mpc appears nearly as good as the StdIter, while beginning to show a large scale deviation, which is more obvious in P(k).
Figure 6. The effect of an incremental shot noise. Using subL500 with n¯ = 0.0442h3 Mpc-3. Cross-correlation coefficient, propagators and power spectra of the three iterative schemes for matter in redshift space. The propagator and power spectrum of the DisIter shows that this method suffers an artifact on small scale even at this low level of shot noise. © 0000 RAS, MNRAS 000, 000­000

12 Hee-Jong Seo et al.

Figure 7. The BAO feature in the various iterative methods, in comparison to the standard, single step reconstruction. Top: spherically averaged real space.
Bottom: spherically averaged redshift space. The left panels show all four iterative methods with its optimal final smoothing length in comparison to the single step, standard reconstruction using the same initial smoothing scale (red, 20h-1 Mpc). The dotted line is the input power spectrum which is nearly invisible as overlaid by other lines, the black solid line is the nonlinear power spectrum at z = 1. All iterative methods started from sm = 20h-1 Mpc. Blue: StdIter that ended at sm = 5h-1 Mpc (5th step). Orange: StdIterSS with sm = 1.25h-1 Mpc (9th step). Magenta: DisIter (9th step) with sm = 1.25h-1 Mpc. Green: DisIterSS with sm = 2.5h-1 Mpc. The right panels show the comparison between StdIter with sm = 5h-1 Mpc and the optimal single step standard reconstruction with sm = 10h-1 Mpc.

Fig. 8 shows the multipoles of pre- and post-reconstructed cor-
relation functions in the redshift space. The top, middle, and bottom
rows show 0, 2, and 4 in the redshift space, respectively, before (black line) and after reconstruction (colored). The gray line is the
input linear correlation function with linear RSD prediction. The
red (1st column), blue (2nd), green (3rd), orange (4th) solid lines show the snapshots of StdIter. The long-dashed lines show the ss component (StdIterSS), and the short-dashed lines show the dd component. In the second column, the overlaid red lines show the standard reconstruction with sm = 10h-1 Mpc.
Note that in the case of the standard reconstruction with sm = 20h-1 Mpc (the red lines in the first column), the DD component
dd (and therefore ds) contains the small scale clustering information for r < 50h-1 Mpc as well as most of the BAO-like peak. On
the other hand, ss provides a smooth curve. With a smaller smoothing scale (red line for sm = 10h-1 Mpc in the second column), ss contains more of the BAO-like feature.
In the iterative reconstruction, as we noticed in the previous
sections, the BAO-like information in the DD component transfers
from dd to ss, so that both dd and ds vanish at its limit (see the very right column). Again, we can view the iterative reconstruction

as an operation to transfer and merge information from two density fields into one field.
3.4 Iterative reconstruction of the biased field
The biased field reconstruction will require an additional implementation for dealing with the biased tracers as well as more severe sparsity. We change our mock catalog to FastPM-based catalog at z = 1.0 with b = 1.88 and n¯ = 0.0012h3 Mpc-3 (Ding et al. 2018), i.e., going slightly higher in redshift, accounting for the future galaxy surveys shifting toward higher redshift tracers.
The top panel of Figure 9 shows C(k), P(k), and R(k) of StdIter that again started with sm = 20h-1 Mpc. The top panel of Figure 10 shows the SS and the DD component of this case. Note that the DD component converges to b - 1 at low k after the first reconstruction (red lines), which will incorrectly introduce a largescale displacement in the second reconstruction, while the particles are already near their original Lagrangian space. Figure 9 shows that, despite this inconsistency, the combination of the SS and the DD field, i.e., StdIter improves the cross-correlation with iterative steps. However, the same is not true for DisIter in which we trace the displacement.
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 13

Figure 8. The iterative reconstruction in the configuration space. The top, middle, and the bottom rows show 0, 2, and 4 in the redshift space, respectively,
before (black line) and after reconstruction (colored). The gray line is the input, linear correlation function with linear RSD prediction. The red line in the first column is the standard reconstruction using sm = 20h-1 Mpc while blue (2nd column), green (3rd), orange (4th) solid lines show the snapshots of the iterative reconstructions, StdIter, at sm = 10h-1 Mpc, 5h-1 Mpc, and 1.25h-1 Mpc, respectively when the reconstruction started from sm = 20h-1 Mpc.
The long-dashed lines show the ss component, and the short-dashed lines for the dd component and the dotted lines for -2ds. In the second column, the overlaid red lines show the single-step standard reconstruction with sm = 10h-1 Mpc.

We now apply debiasing described in § 2.1.7 to make sure that the standard reconstruction and StdIter work with the debiasing. The middle panels of Figure 9 shows the debiased StdIter. As the debiasing removes the constant bias factor from the power spectrum, we rescaled C(k) and P(k) with b and b2, respectively, for these plots so that they can be directly compared to the prereconstruction quantities.8 The resulting performance with and without debiasing appears consistent for StdIter in terms of R(k) and C(k). In P(k), debiasing seems to introduce a suppression in power on small scales after shot noise subtraction (magenta line), but this suppression below unity corresponds to an almost constant offset in power, as if we misestimated the shot noise contribution. The bottom panel of Figure 10 shows that the debiasing indeed removes the large-scale contribution of the DD component (d) as we intended. Here we include the last reconstruction step with sm = 1.25h-1 Mpc to show the behavior after the optimal step of StdIter with sm = 5h-1 Mpc. Even after debiasing, probably due to the higher level of noise in the observed density field, we find that, along the transverse direction, the propagator of the SS component alone hardly is better than the nonlinear field (black) and most of the gain is the contribution from the DD component. At sm = 1.25h-1 Mpc, the SS component reaches its maximum, but the DD component has diminished too quickly such that the net propagator performs worse than sm = 5h-1 Mpc.
We note that this debiasing could be particularly useful for
8 The nominal shot noise is subtracted from P(k) after scaling with b2.

finding the displacement field of the combined tracers with different halo/galaxy bias; we can estimate the underlying matter density field based on the prior knowledge of bias of the combined tracers in each spacial location and assign the debiasing weight to the reference particle.
Next we apply DisIter on the debiased field: the bottom panels of Figure 9 show the performance of DisIter. Compared to the other two cases (top and middle panels), this DisIter method seems slightly less efficient for the transverse direction, based on R(k). Due to the missing small-scale power after DisIter, the performance in C(k) along the transverse direction appears much worse than the other methods. We find that if we choose a different initial smoothing scale, we can improve the performance of DisIter. For simplicity of comparison, however, we keep the initial smoothing scale of sm = 20h-1 Mpc for all biased cases.
Figure 11 shows the iterative reconstruction in comparison to an aggressively conducted single step standard reconstruction for the biased cases using b = 1.88. This again shows a result consistent with the matter case. I.e., we can find an optimal single-step smoothing scale that returns comparable C(k) as the optimal iterative reconstruction, while such a single-step reconstruction with a small smoothing scale tends to show a substantial deviation from the linear power spectrum even on large scales.
Figure 12 shows the same for a lower bias and a smaller shot noise sample (b = 1.48 and n = 0.0038h3 Mpc-3). Overall, the efficiency of the reconstruction appears to improve, particularly for the DisIter case with this sample, while the qualitative trend we observed from Figure 12 still holds.

© 0000 RAS, MNRAS 000, 000­000

14 Hee-Jong Seo et al.
Figure 9. Cross-correlation coefficient, propagator, and power spectrum of the iterative reconstruction on the biased sample at z = 1 with b = 1.88. Top panel: StdIter. Middle: StdIter after debiasing. Bottom: DisIter after debiasing. In order to compare those cases with pre-reconstruction, we rescale the debiased cases with the bias factor (i.e., the colored C(k) and P(k) lines of the middle and the bottom panels). For the debiased-StdIterP(k), the shot noise is subtracted after scaling with b2. For the debiased-DisIter, we do not subtract any shot noise from the reconstructed P(k) in the bottom right panel. In the same plot, the pre-reconstruction P(k) is plotted without shot noise subtraction.
In summary, StdIter returns a good performance even for the biased tracers despite the increased shot noise. On the other hand, we find DisIter very challenging due to missing tracers. To mitigate the difficulty, we introduced debiasing. With debiasing, DisIter is applicable to the biased field with realistic shot noise. In our results, the DisIter option for the biased tracers appears less effective in terms of propagator along the transverse direction compared to StdIter but this is partly because we did not try to optimize DisIter for the biased field and partly because the suppression of power on small scales after DisIter. In terms of R(k), where the suppression is canceled, we see that DisIter is more comparable to StdIter.
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 15
Figure 10. The SS and DD component of StdIter (top panels) and debiased-StdIter (bottom) in Figure 9 to compare the progression of the components without and with debiasing. Iterative reconstruction on the biased sample at z = 1 with b = 1.88 at various iterative steps. The quantities in the bottom panel is rescaled with b to give an easy comparison to the top panels. One can see that, by debiasing, we are removing the large scale contribution from the DD component and also more effectively transferring the small scale information from DD to SS.
Figure 11. Comparison between the iterative reconstruction StdIter (top) and an example of an aggressive standard reconstruction with sm = 5h-1 Mpc (bottom). In terms of the propagator at k = 0.4h Mpc-1, the standard reconstruction does not appear to fair worse than the iterative method, however, a degradation at k  0.1h Mpc-1 in terms of P(k) and C(k) is observed.
© 0000 RAS, MNRAS 000, 000­000

16 Hee-Jong Seo et al.
Figure 12. Cross-correlation coefficient, propagator, and power spectrum of the iterative reconstruction on the biased sample at z = 1 with b = 1.48. Top panel: StdIter. Middle: StdIter after debiasing. Bottom: DisIter after debiasing. .
© 0000 RAS, MNRAS 000, 000­000

4 CONCLUSION
The density field reconstruction technique has been widely used for recovering the BAO feature in galaxy surveys from various nonlinearities. Recently, a variety of extensions to this technique have been suggested aimed at improving the BAO information and beyond, and one main direction is to adopt the iterative steps in reconstruction, called `iterative reconstruction'. In this paper, we investigated the performance of iterative reconstruction in terms of the BAO as well as the broadband shape, focusing on the implementation based on Schmittfull et al. (2017). We summarized the key results of this paper below.
· We extended the methods in Schmittfull et al. (2017) to the redshift space and tracers with halo bias and shot noise and inspected the components of the reconstructed field in Fourier space and in configuration space. In the process of extension, we invented surrogate methods to Schmittfull et al. (2017) that can be applied to the galaxy field with high sparsity.
· All the iterative methods we are testing yield comparable results at the low shot noise limit when redshift-space distortions and galaxy/halo bias are not included. Among these options, the displacement reconstruction method, DisIter shows the best performance in terms of the convergence in R(k), C(k), P(k) to the linear density field. The single-step standard reconstruction performs much worse than the final step of the iterative reconstruction, confirming previous results reported in the literature. This is expected as the effective smoothing scale is very different between the two cases.
· We find that we can decrease the smoothing scale of the standard reconstruction such that its propagator (i.e.. the strength of BAO) becomes comparable to the optimal case of the iterative reconstruction. However, this can be achieved at the cost of deviation from the empirical PT-based fitting model of the BAO (e.g., Seo et al. 2016) as well as from the PT-based broadband models (Hikage et al. 2017; Chen et al. 2019). Iterative reconstruction on the other hand allows us to use a small smoothing scale `stably', i.e., without causing a substantial deviation from the linear theory model on large scales. While we have not tested explicitly in this paper, we expect that the iterative reconstruction will therefore provide a better goodness of the fit in the post-reconstruction BAO analysis for a small smoothing scale, compared to the standard reconstruction. As a caveat, our result assumed a correct linear b and f in the process. But one can imagine that in the process of iterative operation, an fiducial, inaccurate assumption can be updated based on the reconstructed field at each step. Also, the iterative reconstruction is performed toward an almost uniform displaced galaxy density field, and this process can potentially allow a self or an internal calibration of relevant cosmological parameters (a similar point was made in Wang et al. (2020) regarding RSD parameters). We plan to investigate such aspect in a future paper. On the other hand, iterative reconstruction will require more computational time as well as a complexity in constructing a corresponding PT model for the broadband power (Ota et al. 2021).
· When redshift-space distortions are included, all iterative reconstruction methods perform worse compared to their real-space results, particularly along the line of sight. We expect that a more dedicated treatment of redshift-space distortions such as the iterative RSD correction (Wang et al. 2020) can potentially further improve the line of sight information.
· We find that the displacement-field-based reconstruction DisIter becomes quickly inefficient with increasing sparsity, as a sparse field lacks the tracers of the displacement field in the major-
© 0000 RAS, MNRAS 000, 000­000

Iterative reconstruction for BAO and beyond 17
ity of the pixels. We alleviate the missing tracer problem by making the reference particles to trace the reconstructed displacement (DisIterSS) and/or by debiasing. StdIter, which is density-based, does not directly suffer the sparsity problem.
· We note that the iterative reconstruction transfers the information from the galaxy field gradually to the reference fields during the iteration, returning an almost uniform galaxy field on large scales. On small scales, we observe a small, but nonzero power of the displaced galaxy density field at the last step of iteration, implying that we are not perfectly recovering the uniform Lagrangian distribution on small scales even with 9 reconstruction steps.
There are several aspects that we can improve upon the implementations made in this paper. First, we did not include a process that can enable the iterative operations to naturally converge to their optimal performance. Instead, we manually inspected and selected the optimal steps. We expect that introducing a minimum smoothing scale, based on the shot noise level of the raw observed field could help here. There are also ways to improve the displacement field estimation accounting for the environment (Achitouv & Blake 2015), weighting the halos of different mass and therefore reducing the effective shot noise (Liu et al. 2021), and/or by accounting for the nonlinear bias (Birkin et al. 2019) which we will leave for future work.
This paper mainly makes qualitative statements on the performance of the iterative reconstruction regarding signal-to-noise and large-scale clustering using various clustering estimators. We found the pros and cons of implementing the iterative steps and tracing the density field versus the displacement field in the presence of redshift-space distortions, halo bias, and shot noise. A more complete and quantitative comparison can be derived by investigating the properties of the covariance matrix after iterative reconstruction and an explicit BAO and broadband parameter fitting after constructing proper fitting models. Again, we leave such a rigorous and quantitative study for future work.
ACKNOWLEDGEMENT
We are very grateful for the helpful comments from Lado Samushia, Chris Blake, Martin White, and the FastPM halo catalog from Zhejie Ding. H.-J.S. and A.O. are supported by the U.S. Department of Energy, Office of Science, Office of High Energy Physics under DE-SC0019091. SS was supported in part by World Premier International Research Center Initiative (WPI Initiative), MEXT, Japan.
DATA AVAILABILITY
The data underlying this article will be shared on reasonable request to the corresponding author.
REFERENCES
Achitouv I., Blake C., 2015, Phys. Rev. D, 92, 083523 Alam S., et al., 2021, Phys. Rev. D, 103, 083533 Alcock C., Paczynski B., 1979, Nature, 281, 358 Aubourg E´ ., et al., 2015, Phys. Rev. D, 92, 123516 Baldauf T., Schaan E., Zaldarriaga M., 2016, JCAP, 03, 017 Birkin J., Li B., Cautun M., Shi Y., 2019, MNRAS, 483, 5267 Chen S.-F., Vlah Z., White M., 2019, JCAP, 2019, 017

18 Hee-Jong Seo et al.
Crocce M., Scoccimarro R., 2008, Phys. Rev. D, 77, 023533 Ding Z., Seo H.-J., Vlah Z., Feng Y., Schmittfull M., Beutler F.,
2018, MNRAS, 479, 1021 Eisenstein D. J., Hu W., 1998, ApJ, 496, 605 Eisenstein D. J., Seo H.-J., White M., 2007a, ApJ, 664, 660 Eisenstein D. J., Seo H.-J., Sirko E., Spergel D. N., 2007b, ApJ,
664, 675 Feng Y., Chu M.-Y., Seljak U., McDonald P., 2016, Monthly No-
tices of the Royal Astronomical Society, 463, 2273 Feng Y., Bird S., Anderson L., Font-Ribera A., Pedersen C.,
2018, Mp-Gadget/Mp-Gadget: A Tag For Getting A Doi, doi:10.5281/zenodo.1451799 Hada R., Eisenstein D. J., 2018, MNRAS, 478, 1866 Hada R., Eisenstein D. J., 2019, MNRAS, 482, 5685 Hikage C., Koyama K., Heavens A., 2017, Phys. Rev. D, 96, 043513 Hikage C., Koyama K., Takahashi R., 2020, Phys. Rev. D, 101, 043510 Kaiser N., 1987, MNRAS, 227, 1 Liu Y., Yu Y., Li B., 2021, ApJS, 254, 4 Matsubara T., 2008, Phys. Rev. D, 77, 063530 McQuinn M., 2020, arXiv e-prints, p. arXiv:2008.12312 Mehta K. T., Seo H.-J., Eckel J., Eisenstein D. J., Metchnik M., Pinto P., Xu X., 2011, ApJ, 734, 94 Meiksin A., White M., Peacock J. A., 1999, MNRAS, 304, 851 Noh Y., White M., Padmanabhan N., 2009, Phys. Rev. D, 80, 123501 Ota A., Seo H.-J., Saito S., Beutler F., 2021, submitted to Phys. Rev. D, XX, XXX Padmanabhan N., White M., 2009, Phys. Rev. D, 80, 063508

Padmanabhan N., White M., Cohn J. D., 2009, Phys. Rev. D, 79, 063523
Peacock J. A., Nicholson D., 1991, MNRAS, 253, 307 Planck Collaboration et al., 2016, A&A, 594, A13 Prada F., Sco´ccola C. G., Chuang C.-H., Yepes G., Klypin A. A.,
Kitaura F.-S., Gottlo¨ber S., Zhao C., 2016, MNRAS, 458, 613 Pueblas S., Scoccimarro R., 2009, Phys. Rev. D, 80, 043504 Savitzky A., Golay M. J. E., 1964, Analytical Chemistry, 36, 1627 Schmittfull M., Feng Y., Beutler F., Sherwin B., Chu M. Y., 2015,
Phys. Rev. D, 92, 123522 Schmittfull M., Baldauf T., Zaldarriaga M., 2017, Phys. Rev. D,
96, 023505 Seo H.-J., Eisenstein D. J., 2003, ApJ, 598, 720 Seo H.-J., Siegel E. R., Eisenstein D. J., White M., 2008, ApJ,
686, 13 Seo H.-J., et al., 2010, ApJ, 720, 1650 Seo H.-J., Beutler F., Ross A. J., Saito S., 2016, MNRAS, 460,
2453 Sherwin B. D., White M., 2019, JCAP, 2019, 027 Tassev S., Zaldarriaga M., 2012, JCAP, 2012, 006 Wang X., Yu H.-R., Zhu H.-M., Yu Y., Pan Q., Pen U.-L., 2017,
ApJ, 841, L29 Wang Y., Li B., Cautun M., 2020, MNRAS, 497, 3451 White M., 2010, arXiv e-prints, p. arXiv:1004.0250 White M., 2015, MNRAS, 450, 3822 Yu Y., Zhu H.-M., Pen U.-L., 2017, ApJ, 847, 110 Zhu H.-M., Yu Y., Pen U.-L., Chen X., Yu H.-R., 2017,
Phys. Rev. D, 96, 123502 Zhu H.-M., Yu Y., Pen U.-L., 2018, Phys. Rev. D, 97, 043502

© 0000 RAS, MNRAS 000, 000­000

