Astronomy & Astrophysics manuscript no. aanda June 3, 2021

©ESO 2021

arXiv:2106.00688v1 [astro-ph.EP] 1 Jun 2021

Quantifying the Similarity of Planetary System Architectures
D. Bashi1 and S. Zucker1
Porter School of the Environment and Earth Sciences, Raymond and Beverly Sackler Faculty of Exact Sciences, Tel Aviv University, Tel Aviv, 6997801, Israel. e-mail: dolevbas@mail.tau.ac.il ; shayz@tauex.tau.ac.il
Received ... ; accepted ...
ABSTRACT
The planetary systems detected so far already exhibit a wide diversity of architectures, and various methods are proposed to study quantitatively this diversity. Straightforward ways to quantify the difference between two systems and more generally, two sets of multiplanetary systems, are useful tools in the study of this diversity. In this work we present a novel approach, using a Weighted extension of the Energy Distance (WED) metric, to quantify the difference between planetary systems on the logarithmic periodradius plane. We demonstrate the use of this metric and its relation to previously introduced descriptive measures to characterise the arrangements of Kepler planetary systems. By applying exploratory machine learning tools, we attempt to find whether there is some order that can be ascribed to the set of Kepler multiplanet system architectures. Based on WED, the 'Sequencer', which is such an automatic tool, identifies a progression from small and compact planetary systems to systems with distant giant planets. It is reassuring to see that a WED-based tool indeed identifies this progression. Next, we extend WED to define the Inter-Catalogue Energy Distance (ICED) ­ a distance metric between sets of multiplanetary systems. We have made the specific implementation presented in the paper available to the community through a public repository. We suggest to use these metrics as complementary tools in attempting to compare between architectures of planetary system, and in general, catalogues of planetary systems.
Key words. Planets and satellites: general ­ Planets and satellites: fundamental parameters ­ Catalogs ­ Methods: statistical ­ Methods: data analysis

1. Introduction
One of the most prominent results by the Kepler mission (Borucki et al. 2010) was the detection of hundreds of multiplanet systems. The analysis of the architectures of these systems revealed the ubiquity of close-in sub-Neptune, super-Earth and Earth-like planets, and led to important insights about the statistical relations among planets within such systems (Lissauer et al. 2011; Fabrycky et al. 2014; Weiss et al. 2018). One example is the "peas in a pod" pattern, first noted by Millholland et al. (2017); Weiss et al. (2018), and further discussed in Kipping (2018); Weiss & Petigura (2020); Mulders et al. (2020); He et al. (2020). In systems that exhibit this pattern, planets orbiting the same host tend to be similar in size and have regular orbital spacing. At present, it is not completely clear yet whether this pattern is indeed of astrophysical origin or a selection effect due to observational biases (Zhu 2020; Murchikova & Tremaine 2020), nonetheless, the evidence seems to support the case that the pattern is of astrophysical origin (Weiss & Petigura 2020; Gilbert & Fabrycky 2020; He et al. 2020).
There are currently two main approaches that can be found in the literature to analyze quantitatively the architectures of planetary systems:
The first approach uses various attributes of the system architecture that are easy to identify and quantify. Some authors used information theory in order to identify such attributes. Thus, Kipping (2018) proposed a model to define the entropy of the planet size ordering within a planetary system. Using this model, he then argued that the observed Kepler multiplanet systems displayed a highly significant deficit in entropy compared to a randomly generated population. Gilbert & Fabrycky (2020, here-

after GF20), in an attempt to assess system-level trends, have recently suggested to use several descriptive measures in order to characterise the arrangements of planetary masses, periods, and mutual inclinations within exoplanetary systems.
In the second approach one quantifies the difference between system architectures using some distance metric. Alibert (2019) introduced such a metric, based on planet properties, and then used it to infer the similarity of the protoplanetary discs in which the planetary systems had formed. The metric introduced by Alibert involves representing the planets of the two systems as points on the logarithmic radius-period plane, spreading the points with a Gaussian kernel whose weights are determined by the planet masses, and integrating the squared difference between the two functions.
In this work we pursue the second approach and introduce a new metric to quantify the difference between planetary systems, based on the Energy Distance. Originally, the energy distance was introduced as a statistical distance between probability distributions defined on vector spaces (Székely 2002). We propose to consider the distribution of mass among the planets in the examined parameter space (e.g. mass and period) as a discrete probability density function and introduce a weighted extension of the energy distance we henceforth abbreviate as WED.
Extending on our newly introduced method to quantify the difference between two planetary system architectures, we also propose a method to compare between sets and catalogues of planetary systems, based on WED. We call this extension: ICED (Inter-Catalogue Energy Distance). Such a method can be useful in the context of forward models for population synthesis of planetary systems, such as SysSim (He et al. 2019), EPOS (Mulders et al. 2018) or NGPPS (Emsenhuber et al. 2020; Schlecker

Article number, page 1 of 8

A&A proofs: manuscript no. aanda

et al. 2020). Quantifying the similarity of catalogues or simulated sets of planetary systems is usually done (e.g. Mulders et al. 2018; He et al. 2019; Emsenhuber et al. 2020; He et al. 2020) by the Kolmogorov-Smirnov test statistic (KS; Kolmogorov 1933; Smirnov 1948) and Anderson-Darling test statistic (AD; Anderson & Darling 1952) to compare between the distributions of planet properties, and with a Pearson 2 test or Cressie-Read power divergence (CRPD; Cressie & Read 1984) to compare the distribution of planet multiplicity number (Mulders et al. 2018; He et al. 2019). We propose in this work to use ICED as a tool to quantify the similarity between two catalogues of planetary systems.
In Section 2 we introduce the detailed computation of the Weighted Energy Distance (WED) metric and present a few examples. In Section 3, we calculated a WED matrix for a sample of Kepler multiplanetary systems and examine it in the context of the descriptive quantities suggested by GF20. Next, we apply machine-learning exploratory tools on the Kepler dataset with the WED metric, looking for suggestive trends in the data. In section 4 we use the WED to ICED as a unique summary statistic in comparing between catalogues of multiplanet systems. Finally, in Section 5, we discuss our approach and its applicability.

2. Weighted energy distance
The concept of statistical distance is a central theme in statistics. Statistical distances quantify the difference between two statistical objects, which can be random variables, sample distributions, population distributions, etc. A statistical distance may or may not obey all the metric properties, i.e. positive definiteness, symmetry and the triangle inequality. Metrics induce certain topological properties on the space on which they are defined, and thus it is usually prefereed that statistical distances would be proper metrics. However, the well-known Kullback-Leibler divergence (Kullback & Leibler 1951), also known as relative entropy, is a counter example of a statistical distance which is not a metric, since it violates the requirement of symmetry.
In 2002 the statistician Gábor Székely introduced a novel statistical distance, which he dubbed "energy distance" (Székely 2002). Energy distance does obey the metric axioms, and it can be applied as a statistical distance between samples or populations defined on any metric space, e.g. high-dimensional Euclidean spaces. Since its introduction, the energy distance served as the basis for a new class of methods to quantify various statistical concepts ranging from goodness of fit to cluster analysis (Székely & Rizzo 2017).
Let f and g be the probability density functions of the two independent random variables X and Y, defined on the ddimensional Euclidean space (Rd). The squared energy distance between the distributions f and g is defined by:

D2( f, g) = 2E X - Y d - E X - X d - E Y - Y d

(1)

where E denotes expected value, and a primed random variable X denotes an independent and identically distributed (i.i.d.) copy of X, i.e. X and X are i.i.d., and similarly, Y and Y are i.i.d. (Székely & Rizzo 2017).
The description above is somewhat abstract, since it relates to the population properties of the random variables X and Y. Estimating the energy distance from sample data is straightforward. Let the data consist of two sets of samples in a certain Euclidean space: X = {xi}n1 and Y = {yi}m1 . The energy distance

between the two distributions from which the two sets are drawn is estimated by:

D2(X, Y) = 2 n m nm i=1 j=1

xi - y j

1n n -
n2 i=1 j=1

xi - x j -

1mm

m2 i=1 j=1 yi - y j

(2)

The first term in the expression above is actually proportional to the average of all pairwise distances between samples in X and samples in Y. Besides reflecting the distance between the two samples, this average is also undesirably inflated by the variances of the two sample, and the subtraction of the second and third terms removes this unwanted contribution. As Székely & Rizzo show, this definition amounts to a proper metric under very broad conditions.
Székely & Rizzo also show that for one-dimensional random variables, the energy distance between distributions is closely related to the Cramér-von Mises-Kolmogorv distance (e.g. Darling 1957) (in Astronomy another very similar distance is commonly applied, which is the Kolmogorov-Smirnov distance). However, the Cramér type distances (including Kolmogorov-Smirnov distance) all rely on using the cumulative probability function, which in general Euclidean spaces becomes difficult to define and requires various arbitrary assumptions. The energy distance, on the other hand is straightforward to calculate and is easily applicable to any kind of metric space.
Having established that the energy distance is an easily applicable distance between distributions, we can now, based on the above definition, quantify the distance between two planetary systems X and Y consisting of n and m planets respectively. As most multiplanetary systems currently known have been detected by the Kepler mission and the transit method, their two most robustly observable properties are the orbital period P and planet radius Rp. We therefore represent every planetary system as a set of points on the logarithmic period-radius plane, such that each point corresponds to a planet. We also assign to each point a weight corresponding to the planet mass Mp, using a mass-radius relation (e.g. Bashi et al. 2017). The need for a weight that would represent the planetary mass, as was suggested also by Alibert (2019), can be demonstrated by a hypothetical case of two systems of giant planets that are otherwise identical except for the existence of an additional very small planet in one of them. The weight function guarantees that the two systems would still be considered close by WED.
Based on the above we can now define the energy distance between two planetary architectures as follows:

D2ps(X, Y) = 2A - B - C ,

(3)

where in our case A, B, and C are weighted averages of pairwise distances:

A=

1

n i=1

wiX

m j=1

wYj

n i=1

m
wiX wYj
j=1

xi - y j

(4)

B= (

1

n i=1

wiX

)2

n i=1

n
wiX wXj
j=1

xi - x j

(5)

C= (

1

m i=1

wYi

)2

m i=1

m
wYi wYj
j=1

yi - y j

(6)

Article number, page 2 of 8

D. Bashi and S. Zucker: Quantifying the Similarity of Planetary System Architectures

Kepler-65 Kepler-107

102

101

100

101

102

Period [days]

Fig. 1: Planet properties of the systems Kepler-107 and Kepler65, which serve as the starting points of the tests presented in the text. Circle size represents the planet radius in logarithmic scale, while color represents planet mass. In all cases, mass estimates were based on an empirical mass-radius relation (Bashi et al. 2017), except for the planet Kepler-65e (yellow large point) were we used the mass estimates of Mills et al. (2019).

We calculate the WED (Dps) between planetary systems on the log P­log Rp plane where we use planetary masses (approximated by a simple M-R relation) as the weights wi in order to assign higher weight to more massive planets.
We show several tests we have performed in order to demonstrate the capability of WED to quantify the difference between planetary systems. We have selected the two four-planet systems Kepler-107 (Rowe et al. 2014) and Kepler-65 (Chaplin et al. 2013) as the starting points of our tests (Fig. 1). We chose Kepler-107 as an example of a tightly-packed system, with four planets of similar radii and masses (except for Kepler-107d which is smaller). Kepler-65 represents another type of multiplanetary system, which includes a distant giant planet, Kepler65e (Mills et al. 2019). In each test we calculated the WED between a certain planetary system and each one of a set of 10000 simulated systems that differed from the original system in a certain random but controlled way. The resulting sets of WED values are shown as histograms in Fig. 2, and can be used as a sanity check to show that the values behave as expected.
In the first test we compiled the 10000 random architectures by randomly varying the log P and log Rp of all four planets using a Gaussian distribution with a standard deviation  = 0.1. The WED values of this test are shown in the figure as the blue histogram. In the second test we followed the same procedure, but increased the standard deviation we used in the random simulation to  = 0.3. The results of this second test are presented as the orange histogram. As expected, in both Kepler-107 and Kepler-65 tests, the WED values are typically larger and also exhibit a wider spread than those in the first test.
In the third test we changed the architecture into a threeplanet architecture, by excluding one randomly-chosen planet and randomly varying the properties of the remaining three planets in the same way as in the first test. The result is shown as the green histogram. In the Kepler-107 system, interestingly, this histogram seems to be bimodal. This is expected when we recall that one of the planets (Kepler-107d) is significantly smaller than the other three, and excluding it leaves a system which is not very different from a similar four-planet system. This explains the left peak of the histogram, which somewhat overlaps the blue histogram. The right peak is caused by excluding one of the three more 'influential' planets. Similarly, in the Kepler-65 test, the clear bimodality is related to the inclusion or exclusion of the dominant giant planet Kepler-65e in the random generation of each simulated system.

Mp [M]

In the fourth test the difference from the original system was already drastic ­ we changed the system into a single-planet system by randomly drawing this planet out of the four original ones and varying its properties in the same way as in the first and third test. The set of resulting WED values is represented by the red histogram. The WED values are now typically much larger than those of the other tests, again, as expected.

3. Kepler multiplanet systems

Now that we have formalised WED as a method to quantify the difference between architectures of planetary systems, we can apply WED to the set of Kepler multiplanet systems. The sample we use here is the sample of all high-multiplicity (Np  3) Kepler systems (GF20), which is based on the California Kepler Survey
(CKS) catalogue (Johnson et al. 2017; Weiss et al. 2018), and comprises N = 129 systems. We therefore started by calculating the 129 × 129 matrix of WED distances of system pairs:

ai, j = Dps(Xi, X j)

(7)

3.1. Comparison with complexity measures

As mentioned above, GF20 introduced a set of descriptive measures, which they dubbed 'complexity measures', to describe the details of planetary system architectures. We set to test whether the information encapsulated by those measures is also contained in the WED distance matrix. We examined the following six measures suggested by GF201. We do not include in our analysis the flatness measure of GF20, since our current simple definition of WED does not include the inclination.:

1. Dynamical mass ­ µ ­ describes the overall mass scale of the
system; 2. Mass partitioning ­ Q ­ captures the variance in masses; 3. Monotonicity ­ M ­ quantifies the size ordering of the plan-
ets; 4. Characteristic spacing ­ S ­ the average separation between
planets in units of mutual Hill radii; 5. Gap complexity ­ C ­ summarises the relationships between
orbital periods of adjacent planets; 6. Multiplicity ­ Np ­ is the number of observed planets in a
system.

GF20 have already tested the dependence among the various complexity measures using the distance correlation dependence metric (dCor; Székely et al. 2007; Székely & Rizzo 2017). Unlike the Pearson correlation coefficient, which tests for linear relationships between two variables, dCor can be used to quantify nonlinear associations (dependence) between variables in arbitrary metric spaces. dCor vanishes if and only if the random variables are statistically independent, and it assumes the value 1 only for strict linear relation (either positive or negative). The usefulness of dCor has already been demonstrated in some recent astrophysical works (Martínez-Gómez et al. (2014); Zucker (2018); GF20).
In our case, the metric space we focus on is the space of planetary system architectures, endowed with the metric defined by WED. Estimating dCor requires first calculating a distance matrix for the two variables in question, which we have already calculated for the 129 high-multiplicity systems ai, j. The distance matrix for each of the six complexity measures is simply calculated using the simple absolute difference:

bi, j = |yi - y j|

(8)

1 See section 3 of GF20 for further details.

Article number, page 3 of 8

A&A proofs: manuscript no. aanda

1750 2000
1500 1750

1250

1500

Counts Counts

1000

1250

1000 750
750 500
500

250

250

0

0.2

0.4

0.6

0.8

1.0

1.2

1.4

WED

0

0.0

0.5

1.0

1.5

2.0

2.5

WED

Fig. 2: Histograms of WED values for the four tests described in the main text. Each histogram represents 10000 simulated architectures that deviate in some way from the original four-planet system of Kepler-107 (left panel) and Kepler-65 (right panel). Blue and orange: The properties of all four planets are drawn from a log-normal distribution around the original values, with a standard deviation of 0.1 and 0.3, respectively. Green: same as the blue histograms, but with only three of the four original planets, where the excluded planet is chosen randomly. Red: only one of the original planets is retained, chosen at random, with its properties again drawn from a log-normal distribution with a standard deviation of 0.1.

The next step in the dCor calculation is `double centring' of the matrices a and b:

Ai, j = ai, j - ai,. - a., j + a.,.; Bi, j = bi, j - bi,. - b., j + b.,.

(9)

where ai,. is the i-th row mean, a., j is the j-th column mean, and a.,. is the grand mean of the matrix a. Similar definitions apply for the matrix b.
We thus calculated six dCor values, as measures of dependence between the metric space of architectures with WED and each complexity measure using the expression:

dCor2 =

i, j Ai, j Bi, j ( i, j A2i, j)( i, j B2i, j)

(10)

In order to assess the significance of these six dCor values, we repeatedly calculated them with 10000 random shufflings of the corresponding complexity measures. We then counted how many
of the dCor values were higher than those of the original order-
ing. We present in Fig. 3 the distribution of the dCor values between the sample of 129 architectures and the random shuffles of GF20 complexity measures. The red line represents the value
obtained for the original ordering.
In all cases, except for the multiplicity, we found that all 10000 random shufflings resulted in very low dCor values as compared to the original ordering. We therefore can only estimate an upper limit on their p-values of 10-4 (putting aside the monotonicity p-value of 8×10-4). Table 1 shows the dCor values
for all six complexity measures. We therefore conclude that the WED metric effectively contains the combined information encoded by the complexity measures (except for the multiplicity),
and maybe even additional information.

3.2. Exploratory tools
We now set to further explore the WED matrix of the highmultiplicity Kepler systems using exploratory machine-learning tools.

Table 1: Distance correlation values and significance for the dependence between architectures with WED and the complexity measures introduced by GF20.

µ (Dynamical mass) Q (Mass partitioning) M (Monotonicity) S (Characteristic spacing) C (Gap complexity) Np (Multiplicity)

dCor 0.62 0.38 0.32 0.42 0.37 0.19

p-value < 1 × 10-4 < 1 × 10-4 8 × 10-4 < 1 × 10-4 < 1 × 10-4
0.49

We begin by applying the t-Distributed Stochastic Neighbor Embedding (t-SNE; Van der Maaten & Hinton 2008) method. t-SNE is a tool to visualise high-dimensional data. It converts similarities between data points to joint probabilities and then minimises the Kullback-Leibler divergence (Kullback & Leibler 1951) between the joint probabilities of the low-dimensional embedding and the high-dimensional data (actually, in our case, the data is not high-dimensional bat rather data in a metric space with no clearly defined dimensionality). Alibert (2019) applied a similar approach in order to relate the similarity between planetary systems with the similarity of protoplanetary discs in which they formed. In our case we use t-SNE to search for patterns in the set of Kepler high-multiplicity systems by trying to identify possible clusters or trends with other properties using colour coding. On the left panel of Fig. 4, we present the result of performing t-SNE using the default hyperparameters of the scikitlearn python library (Pedregosa et al. 2011) on our sample, colour coded based on the dynamical mass (µ)2. A clear trend is evident, as expected from our dependence tests. Furthermore, the plot may suggest the emergence of a pattern of two clus-
2 It is important to note that individual axes in t-SNE are not easily interpretable in terms of the original feature space or any physical quantities. Thus one should not try to interpret t-SNE quantitatively but take it mainly as a visualization tool.

Article number, page 4 of 8

D. Bashi and S. Zucker: Quantifying the Similarity of Planetary System Architectures

Counts

1000
500
0 0.2 0.3 0.4 0.5 0.6
dCor (a) Dynamical mass (µ)

Counts

1250 1000 750 500 250
0 0.20 0.25 0.30 0.35
dCor (b) Mass partitioning (Q)

1000

1000

Counts

500

500

Counts

Counts

1000

500

0 0.20

0.25

0.30

0.35

dCor

(c) Monotonicity (M)

1500

1000

500

Counts

0 0.2

0.3

0.4

dCor

0

0.20 0.25 0.30 0.35

dCor

0 0.15 0.20 0.25 0.30 0.35
dCor

(d) Characteristic spacing (S )

(e) Gap complexity (C)

(f) Multiplicity (Np )

Fig. 3: Distribution of distance correlation values (dCor) between Kepler high multiplicity systems with WED and 10000 random shuffles of the six GF20 measures. The vertical red line marks the dCor value of the original ordering.

ters. GF20 have already suggested the emergence of such two patterns in their attempt to apply path-based spectral clustering (R-PBSC; Chang & Yeung 2008).
Next, we employ an exploratory tool called the Sequencer, recently introduced by Baron & Ménard (2020). The Sequencer is an algorithm that searches for trends in a dataset. As a demonstration, Baron & Ménard showed how the Sequencer can identify the stellar main sequence in a set of stellar spectra based only on the pairwise differences among the spectra and without using any stellar parameter like the temperature. In order to perform its task, the algorithm uses the shape of graphs describing the multi-scale similarities (e.g. in our case using the WED matrix) in the data. In particular, it uses the fact that continuous trends (sequences) in a dataset lead to more elongated graphs. We applied the Sequencer on the same set of 129 high-multiplicity Kepler systems as before, with the WED metric as a measure of dissimilarity, to see whether any order emerges. We applied the algorithm using a Breadth-First Search (BFS) walk, i.e. along the longest branch of the graph and scanning each branch along the way. We present the result on the right panel of Fig. 4. Each circle represents a planet, and its radius is proportional to the planet radius. All planets in the same system share a row, which is also colour coded based on the dynamical mass (µ). It seems that the main obvious feature in the preferred sequence is a progression in terms of the dynamical mass, but also in terms of the typical period. This may also be related to the fact that the dynamical mass and the characteristic spacing are the quantities that show the strongest distance correlation in Table 1.

4. Distance between catalogues

WED, as a measure of similarity between planetary systems, can now be used as the basis for a method to compare catalogues or samples of planetary systems, which we henceforth denote InterCatalogue Energy Distance ­ ICED.
Suppose that X and Y are two independent sets consisting of N and M planetary systems respectively. In the same way we have defined WED based on weighted Euclidean distance, we can now define D2pc(X, Y), based on the WED between architec-
tures of planetary systems in X and Y:

D2pc(X, Y) = 2A - B - C

(11)

where A, B, and C are simply the pairwise WEDs:

A=

1 NM

N i=1

M
Dps(Xi, Y j)
j=1

(12)

B=

1 N2

N i=1

N
Dps(Xi, X j)
j=1

(13)

C=

1 M2

M i=1

M
Dps(Yi, Y j)
j=1

(14)

We demonstrate the ability of ICED to quantify the difference between sets of planetary systems by a test similar to the

Article number, page 5 of 8

A&A proofs: manuscript no. aanda

Dynamical mass Dynamical mass

15

-3.5

120

-3.5

10

100

-4.0

-4.0

5

80

Ordered index

-4.5

60

-4.5

0

40

-5.0

-5.0

-5

20

-5.0 -2.5 0.0 2.5 5.0 7.5

-5.5

0

-5.5

100

101

102

103

Period [days]

Fig. 4: The results of using WED in the context of machine-learning exploratory tools: t-SNE (left) and the Sequencer (right). In both cases, it seems there is a clear trend with the order of systems based on dynamical mas (µ). It is important to note that each point on the t-SNE plot represent a single planetary system, while on the Sequencer plot, each row of points represent a single planetary system.

one we used in Sec. 2 for WED. We use as a reference sample

the sample of 129 high-multiplicity (Np  3) Kepler systems of

Sec. 3. In each test we calculated the ICED between our refer-

350

ence sample and each one of a set of 1000 simulated catalogues,

which differed from the original one in a certain random but con-

300

trolled way. The results of these tests are shown as histograms in

Fig. 5.

250

Counts

In the first test, we compiled the 1000 random catalogues by randomly varying log P and log Rp of all planets in each system, using a Gaussian distribution with a standard deviation  = 0.1. The ICED values of this test are shown in the figure as the blue histogram. In the second test we followed the same procedure, but increased the standard deviation we used in the random simulation to  = 0.3. The results of this second test are presented as the orange histogram. As expected, the ICED values are typically larger and exhibit a wider spread than those in the first test. Both tests preserved the multiplicity of the systems included in the reference sample.
Next, we tested how the ICED values differed as we changed the systems multiplicities. In the third test (green histogram) we randomly changed the multiplicity by drawing the number of planets in each system from a uniform distribution between 0 planets (effectively excluding this system as it did not host planets anymore) and the actual number of planets detected in the system. We then randomly chose the remaining planets and varied their properties in the same way as in the first test. We can clearly see that in this case where we allowed the multiplicity to attain lower values (i.e. higher discrepancy from the original sample), the ICED values again tended to be higher compared to the first test. However, it seems that ICED in this case is generally lower than that obtained in the case in which we preserved the multiplicity but significantly varied ( = 0.3) the planet properties (second test). Thus we conclude that WED, as a tool to quantify similarity of two sets of multiplanetary systems, is affected more by the properties of the planets and less by the number of planets in each system (i.e. multiplicity).

200

150

100

50

0

0.05

0.10

0.15

0.20

0.25

0.30

0.35

ICED

Fig. 5: Histograms of ICED values for the three tests described in the main text. Each histogram represents 1000 simulated catalogues that deviate in some way from the original set of 129 high-multiplicity (Np  3) Kepler systems. Blue and orange: The properties of all planets are drawn from a log-normal distribution around the original values, with a standard deviation of 0.1 and 0.3, respectively. Green: same as the blue histograms but including possibility to change each systems planet multiplicity by drawing the number of planets per system from a uniform distribution between 0 planets to the actual number of planets detected around that system Npi .

5. Discussion
We have introduced the Weighted Energy Distance (WED) as a novel metric based on energy distance to quantify the difference between architectures of planetary systems 3. We showed that the information conveyed by WED includes the information
3 We provide a public Python package (PASSta: Planetary Architecture System Statistics) with implementation of the tools presented in this work at: https://github.com/dolevbas/PASSta.

Article number, page 6 of 8

D. Bashi and S. Zucker: Quantifying the Similarity of Planetary System Architectures

conveyed by previous descriptive measures used to characterise the arrangements of planetary systems (GF20). Nonetheless, it is important to note that while WED is an exploratory tool that can be applied to discover interesting and previously unknown trends between architectures of planetary systems, the complexity measures of GF20 are still very valuable as they provide a clear and explicit description of the system properties, which are conveniently and intuitively interpretable.
Our aim was to suggest a way to quantify dependencies between the architectures and other characteristics of the planetary system without restricting the analysis to any specific feature of the architecture. In that sense dCor with WED is an integrative way to find such relations, which is agnostic of any predisposition we might have regarding planetary system architectures. Once we detect such a relation, the next step would be to check whether any of the more intuitive quantities like the GF20 measures can explain this finding, or maybe we should dig deeper and come up with new insights.
In this context it is important to address our finding that the multiplicity did not exhibit any significant dependence with WED (as manifested in dCor). At first sight this seems a drawback of WED, but at a second look this may not be such a big surprise. As an example, WED will be small for two systems with similar two giant planets that differ only in the number of the other small planets. This can be justified since the physical formation processes that formed these two systems were probably similar, as both formed similar two dominant planets. Alternatively, two systems with an identical set of terrestrial planets except for the replacement of one of the terrestrial planets with a giant planet will rightfully be considered very different. WED will reflect those trends, showing its value in quantifying the difference between architectures in a physically meaningful way. The fact that small planets in wide orbits might easily evade detection affecting dramatically the value of the multiplicity, also casts doubt regarding the physical significance of the multiplicity measure.
We took the WED concept one step further and introduced ICED ­ the Inter-Catalogue Energy Distance ­ to quantify the difference between samples of planetary systems. We demonstrated how ICED may be used as a summary statistic to compare between catalogues or samples of planetary systems. An easy to estimate distance function between architectures of planetary systems can complement forward modeling as a tool to compare between observed and simulated samples of planetary systems. Previous works (He et al. 2019; Mulders et al. 2018) used some linear combinations of statistical distances between the separate distributions of the planetary parameters (KS test, AD statistics, Cressie­Read statistics or a simple Euclidean distance). Much like WED, ICED suggests an integrative approach that can be useful also in comparing observed catalogues with planetary population-synthesis models of planet formation and evolution (e.g. Chambers 2018; Mulders et al. 2019; Emsenhuber et al. 2020), comparing sub-populations from the same model as was recently used by Schlecker et al. (2020) and comparing populations produced by varying the details of a model (Ndugu et al. 2019).
Our choice to characterise planetary systems in a twodimensional space of period-radius (weighted according to planet mass) is not an exclusive choice. Depending on the scientific question at hand and the relevant properties of the architecture or of the catalogue, more dimensions and properties can be added to the definitions of WED and ICED, such as the orbital eccentricity, mutual inclination or the norm of the angular momentum (Laskar & Petit 2017). For example, if one is inter-

ested in exploring systems hosting habitable planets, a change in weights based on planet effective temperatures, may be better suited to quantify the similarity of such systems.
As mentioned above Alibert (2019) also presented a metric that used the period and radius quantities. It is therefore instructive to compare the metric of Alibert and the WED. Alibert also converted the locations of the planets on the logarithmic periodradius plane to an analogous probability distributions. However, he effectively used a Gaussian kernel estimation of the probability distribution and 'smeared' the delta functions into Gaussians, with widths that were determined somewhat arbitrarily. Next, he calculated the distance between the two distributions by integrating them on the plane. This involved numerical integration, and furthermore, the boundaries of integration had to be values that were considered effectively infinite. Thus, his metric was sensitive to arbitrary choice of the Gaussian widths, involved approximation of the integral, and was somewhat computationally demanding due to the numeric integration. WED, on the other hand, is quite simple to calculate, and it involves no arbitrary choice of parameters, as its definition (Eqs. 3­6) involves only the simplest algebraic operations.
The tools presented in this work are not limited to any specific detection method, and can be generalised to a population of planets detected by any other method. Actually, our method is not limited only to planets and is applicable also for comparison between binary and multiple star systems.
In this work we defined the WED between planetary systems by using a simple Euclidean distance to measure the distance between planets. This can also be generalised by using instead the Mahalanobis distance (Mahalanobis 1936) in order to account for uncertainties in planet properties, assigning different weights to each property and even account for correlated uncertainties.
As we have shown in Sec. 3.1, presenting the set of possible configurations as a metric space enables the use of the distance correlation. We used this in order to show, as a kind of sanity check, the dependence between the architectures and the complexity measures introduced by GF20. This opens the way to explore possible dependence of the planetary system architectures on various stellar properties, like metallicity, kinematics, age etc. Consequently, using dCor with WED (while accounting for selection effects and detection biases) will allow to explore whether the current properties of planetary systems correlate with their host properties or otherwise, whether the planetary system dynamical evolution erased the information about the primordial conditions in the protoplanetary disks where they formed (Kipping 2018; Zhu 2020). Thus, instead of testing for such a dependence separately for each of GF20 complexity measures, using dCor with WED we will potentially get initial hints about complex relations, which might not be easily detectable through the individual explicit complexity measures.
Acknowledgements. We thank the anonymous referee for the constructive report whose comments helped to improve this manuscript. We are grateful to Dalya Baron for helping us run the Sequencer and further commenting on an early version of the manuscript and to Gábor Sékely and Russell Lyons for very insightful discussions about the energy distance and the distance correlation. This research was supported by the ISRAEL SCIENCE FOUNDATION (grant No. 848/16). We also acknowledge partial support by the Ministry of Science, Technology and Space, Israel.
References
Alibert, Y. 2019, A&A, 624, A45 Anderson T. W., & Darling D. A. 1952, Ann. Math. Stat., 23, 193 Baron, D., & Ménard, B. 2020, ArXiv e-prints [arXiv:2006.13948] Bashi, D., Helled, R., Zucker, S., & Mordasini, C. 2017, A&A, 604, A83

Article number, page 7 of 8

A&A proofs: manuscript no. aanda
Borucki, W. J., Koch, D., Basri, G., et al. 2010, Science, 327, 977 Chambers, J. E. 2018, ApJ, 865, 30 Chang, H., & Yeung, D.-Y. 2008, Pattern Recogn., 41, 191 Chaplin, W. J., Sanchis-Ojeda, R., Campante, T. L., et al. 2013, ApJ, 766, 101 Cressie N., & Read T. R. C. 1984, J. R. Stat. Soc. B, 46, 440 Darling, D. A. 1957, Ann. Math. Stati., 28, 823 Emsenhuber, A., Mordasini, C., Burn, R., et al. 2020, A&A, submitted
[arXiv:2007.05561] Fabrycky, D. C., Lissauer, J. J., Ragozzine, D., et al. 2014, ApJ, 790, 146 Gilbert, G. J., & Fabrycky, D. C. 2020, AJ, 159, 281 He, M. Y., Ford, E. B., & Ragozzine, D. 2019, MNRAS, 490, 4575 He, M. Y., Ford, E. B., Ragozzine, D., & Carrera, D. 2020, AJ, 160, 276 Johnson, J. A., Petigura, E. A., Fulton, B. J., et al. 2017, AJ, 154, 108 Kipping, D. 2018, MNRAS, 473, 784 Kolmogorov A. N. 1933, G. Ist. Ital. Attuar., 4, 83 Kullback, S., & Leibler, R. A. 1951, Ann. Math. Stat., 22 , 79 Laskar, J., & Petit, A. C. 2017, A&A, 605, A72 Lissauer, J. J., Ragozzine, D., Fabrycky, D. C., et al. 2011, ApJS, 197, 8 Mahalanobis, P. C. 1936, Proc. Natl. Inst. Sci. India, 2, 49 Martínez-Gómez, E., Richards, M. T., & Richards, D. St. P. 2014, ApJ, 781, 39 Millholland, S., Wang, S., & Laughlin, G. 2017, ApJ, 849, L33 Mills, S. M., Howard, A. W., Weiss, L. M., et al. 2019, AJ, 157, 145 Murchikova, L, & Tremaine, S. 2020, AJ, 160, 4 Mulders, G. D., Pascucci, I., Apai, D., & Ciesla, F. J. 2018, AJ, 156, 24 Mulders, G. D., Mordasini, C., Pascucci, I., et al. 2019, ApJ, 887, 157 Mulders, G. D., O'Brien, D. P., Ciesla, F. J., et al. 2020, ApJ, 897, 72 Ndugu N., Bitsch B., Jurua E., 2019, MNRAS, 488, 3625 Pedregosa. F., Varoquaux. G., Gramfort. A., et al. 2011, J. Mach. Learn. Res.,
12, 2825 Rowe, J. F., Bryson, S. T., Marcy, G. W., et al. 2014, ApJ, 784, 45 Schlecker, M., Mordasini, C., Emsenhuber, A., et al. 2021, A&A, accepted
[arXiv:2007.05563] Smirnov N. 1948, Ann. Math. Stat., 19, 279 Székely, G. J. 2002, E-statistics: Energy of Statistical Samples, Bowling Green
State University, Department of Mathematics and Statistics Technical Report No. 03­05 Székely, G. J., & Rizzo, M. L. 2017, Ann. Rev. Stat. Appl., 4, 447 Székely, G. J., Rizzo, M. L., & Bakirov, N. K. 2007, Ann. Stat., 35, 2769 Van der Maaten, L., & Hinton, G. 2008, J. Mach. Learn. Res., 9, 2579 Weiss, L. M., Marcy, G. W., Petigura, E. A., et al. 2018, AJ, 155, 48 Weiss, L. M., & Petigura, E. A. 2020, ApJ, 893, L1 Zhu, W. 2020, AJ, 159, 188 Zucker, S. 2018, MNRAS, 474, L86
Article number, page 8 of 8

