arXiv:2106.01020v1 [math.NT] 2 Jun 2021

THE RATIONAL TORSION SUBGROUP OF J0(N )
HWAJONG YOO

A

. The main result of this paper is to determine the structure of the rational tor-

sion subgroup of the modular Jacobian variety J0(N ) for any positive integer N up to finitely many primes. More precisely, we prove that the prime-to-2n part of the rational

torsion subgroup of J0(N ) is equal to that of the rational cuspidal divisor class group of X0(N ), where n is the largest perfect square dividing 3N . As the rational cuspidal divisor class group of X0(N ) is already computed in [28], it determines the structure of the rational torsion subgroup of J0(N ) up to primes dividing 2n.

C

1. Introduction

1

2. A sketch of the proof

4

3. Rational cuspidal divisors

10

4. The index of an Eisenstein ideal

13

5. The kernel of an Eisenstein maximal ideal in characteristic p

17

References

19

1. I
Let N be a positive integer. We denote by J0(N) the Jacobian variety of the usual modular curve X0(N) over Q. In this paper, we would like to understand the rational torsion subgroup of J0(N ) for any positive integer N , which is denoted by J0(N )(Q)tors. When N is a prime, Ogg conjectured the following [15, Conj. 2], which was proved by Mazur [13, Th. 1].

Theorem 1.1 (Mazur). Let N  5 be a prime number, and let n = numerator

N -1 12

. The

rational torsion subgroup J0(N )(Q)tors is a cyclic group of order n, generated by the linear

equivalence class of the difference of the two cusps (0) - ().

As a natural generalization of Ogg's conjecture, one may propose the following: For any positive integer N , J0(N )(Q)tors is contained in a subgroup of J0(N ) generated by the linear equivalence classes of the differences of the cusps, which is called the cuspidal subgroup of J0(N ) and denoted by CN . By the theorem of Manin [12, Cor. 3.6] and Drinfeld [4], the linear equivalence class of the difference of two cusps is torsion, and hence

CN (Q)  J0(N )(Q)tors,
1

2

HWAJONG YOO

where CN (Q) is the group of the rational points on CN , called the rational cuspidal subgroup of J0(N). So the above conjecture can be written as follows.

Conjecture 1.2 (Generalized Ogg's conjecture). For any positive integer N, we have

J0(N )(Q)tors = CN (Q).
In contrast to the case of prime level, it is not easy to compute the rational cuspidal subgroup of J0(N) in general. On the other hand, it is possible to compute a subgroup of J0(N ) generated by the linear equivalence classes of the degree 0 rational cuspidal divisors1 on X0(N ), which is called the rational cuspidal divisor class group of X0(N ) and denote by C(N). By definition, we easily have

C(N )  CN (Q)  CN
and they are all equal if N = 2rM with M odd squarefree and 0  r  3 as all cusps of X0(N) for such an N are defined over Q. Motivated by Ribet's question, the author proposed the following [28].

Conjecture 1.3. For any positive integer N, we have

C(N ) = CN (Q).
Before proceeding, we recall several results on the conjectures above. For simplicity, let C(N )(n) and J0(N )(Q)t(onr)s
denote the prime-to-n parts of C(N ) and J0(N )(Q)tors, respectively. Also, let C(N )[p] and J0(N )(Q)tors[p]
denote the p-primary subgroups of C(N ) and J0(N )(Q)tors, respectively. (1) For a prime p  5 such that p  11 (mod 12) and r  2, we have C(pr)(2p) = J0(pr)(Q)t(o2rps) by Lorenzini (1995) [11, Th. 4.6]. (2) For any prime p and r  3, we have C(pr)(6p) = J0(pr)(Q)t(o6rps) and C(p2)(2p) = J0(p2)(Q)t(o2rps) by Ling (1997) [10, Th. 4]. (3) For a squarefree integer N, we have C(N )(2n) = J0(N )(Q)t(o2rms ), where n = gcd(3, N) by Ohta (2014) [16, Th.].

1By a rational cuspidal divisor, we mean a divisor supported only on the cusps and fixed under the action of Gal(Q/Q).

THE RATIONAL TORSION SUBGROUP OF J0(N )

3

(4) For a prime p such that either p  1 (mod 9) or 3(p-1)/3  1 (mod p), we have

C(3p)[3] = J0(3p)(Q)tors[3]

by the author (2016) [26, Th. 1.3]. (5) For any positive integer N, we have

C(N )[p] = J0(N )(Q)tors[p] = 0,

where p is any prime not dividing 6N |N (2 - 1) by Ren (2018) [19, Th. 1.2]. (6) For some explicit values of N , one can compute J0(N )(Q)tors by counting the num-
bers of Fp-points on J0(N )/Fp for some primes p not dividing N . So one may directly verify C(N ) = J0(N )(Q)tors as the group C(N ) is already computed (cf. [28]). For instance, the following are known.
· N = 11, 14, 15, 17, 19, 20, 21, 24, 27, 32, 36, 49 by Ligozat (1975) [9, Th. 5.2.5]. · N = 125 by Poulakis (1987) [18, Prop. 3.2]. · N = 34, 38, 44, 45, 51, 52, 54, 56, 64, 81 by Ozman and Siksek (2019) [17, Th.
1.2]. · N = 57, 65 by Box (2019) [1, Lem. 3.2]. (7) If N = n2M with n|24 and M squarefree, then Conjecture 1.3 is proved by Wang and Yang (2020) [23, Th. 3]. (8) If N is one of the following, then Conjecture 1.3 is proved [5]. · N = p2 or p3 for any primes p. · N = p2q for any two primes p and q. · N = p2M for squarefree M and a prime p such that p  M |M ( - 1).

The main result of this paper is the following.

Theorem 1.4. For any positive integer N, we have C(N )(2n) = J0(N )(Q)(to2rns),
where n is the largest perfect square dividing 3N, or equivalently, we have C(N )[p] = J0(N )(Q)tors[p],
where p is any odd prime whose square does not divide 3N.

Remark 1.5. (1) The results (1) and (2) are now improved as follows: For any prime p and r  2, we have C(pr)(2p) = J0(pr)(Q)t(o2rps).
(2) Our proof uses the theory of Eisenstein ideals, so it is completely different from those of (1) and (2).
(3) The result can be seen as a natural generalization of (3) to non-squarefree level. (4) Since the structure of C(N) for any positive integer N is completely determined in
[28], we now fully understand the group J0(N )(Q)(to2rns).

4

HWAJONG YOO

The paper will proceed as follows. In Section 2, we review the methods of Mazur and Ohta and prove
C(N )[p] = J0(N )(Q)tors[p]
when N is squarefree and p is an odd prime such that gcd(p, N) = 3. Also, we study a natural generalization of their methods to non-squarefree level, and prove Theorem 1.4. In Section 3, we construct a rational cuspidal divisor C0 annihilated by an Eisenstein ideal I0, and compute the order of its linear equivalence class in J0(N). In Section 4, by considering an Eisenstein series E0 we compute the p-part of the index of an Eisenstein ideal I0 when p2 does not divide N. In Section 5, we study the kernel of an Eisenstein maximal ideal in characteristic p when p2 does not divide 3N .

1.1. Acknowledgments. This work was supported by National Research Foundation of Korea(NRF) grant funded by the Korea government(MSIT) (No. 2019R1C1C1007169 and No. 2020R1A5A1016126).

1.2. Notation. Throughout the whole paper, let p be an odd prime and let  and i denote primes. Also, let

N = N1N2

be a positive integer, where N1 =

t i=1

i

is

the

largest

squarefree

divisor

of

N

such

that

gcd(N1, N2) = 1. So in our convention, t denotes the number of the prime divisors of N

which exactly divide N, and N is squarefree if and only if N2 = 1.

For any prime , let a() :=  + 1 if  does not divide N, and a() := 0 otherwise.

For a positive integer n, let Tn denote the nth Hecke operator. Also, let wi denote the Atkin­Lehner operator with respect to i. Furthermore, let

T(N ) := Z[T, wi :   N1 and 1  i  t]  End(J0(N )),

T(N ) := Z[T : for all primes ]  End(J0(N ))

be two Hecke algebras of level N. We simply write T (resp. T) for T(N) (resp. T(N)) if there is no confusion. Finally, let

IN := (T -  - 1 :   N ) = (T - a() :   N )

be an Eisenstein ideal of T (or T).

2. A
In this section, we review the results of Mazur and Ohta, and investigate a natural generalization. More precisely, we propose two conjectures as a generalization of their work, and prove that the p-primary subgroup of the rational torsion subgroup of J0(N) is equal to that of the rational cuspidal divisor class group of X0(N) under certain extra hypotheses. As a result, we will prove our main theorem using the results in Sections 4 and 5.
From now on, p always denotes an odd prime. By the Eichler­Shimura relation, we have the following.

THE RATIONAL TORSION SUBGROUP OF J0(N )

5

Lemma 2.1. For any positive integer N, we have

J0(N )(Q)tors[p] = J0(N )(Q)tors[p, IN ].

Proof. Let  be a prime not dividing N , and let J := J0(N )/F. By the Eichler­Shimura relation, T - 1 -  annihilates J(F) as the Frobenius morphism acts trivially on J(F). Thus, it suffices to show that the specialization map

J0(N )(Q)tors[p]  J(F)
is injective. If  = p, then this holds true by [20, Th. 1] as J0(N) has good reduction at . Also, if  = p, then this holds true as p is odd. (For instance, see [7, App.].)

Thus, our goal is to prove

J0(N )(Q)tors[p, IN ] = C(N )[p, IN ]. Note that both sides are modules over Tp/IN , where Tp := T Z Zp.

2.1. Work of Mazur. Suppose that N is a prime. In this case, the two Hecke rings T and T coincide as there is no old form. Let

I := (IN , wN + 1) = (IN , TN - 1)

denote Mazur's Eisenstein ideal. Since the operators T ( = N ) and wN are all congruent to integers modulo I, there is a surjection Z  T/I. By the Ramanujan­Petersson bound, we further have
T/I  Z/nZ

for some integer n  1, which is called the index of an Eisenstein ideal I. Mazur proved

that n = numerator

N -1 12

, which is the order of the linear equivalence class of the divisor

0 -  [13, Ch. II, Prop. 9.7]. Since the structure of the quotient ring Tp/I is "simple", its

modules are also easy to understand. So we first consider the modules

J0(N )(Q)tors[p, I] and C(N )[p, I].

The following is a variant of [13, Ch. II, Cor. 14.8].

Lemma 2.2. Suppose that m := (p, I) is a maximal ideal of T. Then we have
dimFpJp(Fp)[m] = 1,
where Jp is the special fiber of the Néron model of J0(N ) over Fp.
Since m = (p, I) is the unique maximal ideal of Tp containing I (if exists), by Nakayama's lemma, Jp(Fp)[p, I] is a cyclic module over Tp/I. Since p is odd, the specialization map
J0(N )(Q)tors[p]  Jp(Fp)[p] is injective (cf. [7, App.]), and so J0(N )(Q)tors[p, I] is also cyclic. Since the order of the linear equivalence class of 0 -  is n, we easily have
J0(N )(Q)tors[p, I] = C(N )[p, I]  Zp/nZp.

6

HWAJONG YOO

Finally, since IN contains TN - 1 = wN + 1 (cf. [2, Prop. 3.19]), we have I = IN . Therefore we have
J0(N )(Q)tors[p, IN ] = C(N )[p, IN ].

2.2. Work of Ohta. Let N = N1 =

t i=1

i

be

a

squarefree

integer

for

some

t



2.

As

above, we first consider the following Eisenstein ideal: For any  := (1, . . . , t)  {±1}t,

let

I := (IN , wi - i : 1  i  t)  T.

By the same argument as above, we have

T/I  Z/nZ

for some n  1. Ohta proved that the p-part of the index of I is equal to that of

n := numerator

1 24

t
(i + i)

i=1

if  = + := (+1, . . . , +1). (If  = +, then we have Tp = I.) As a generalization of Lemma 2.2, Ohta proved the following [16, Prop. 3.5.4 and 3.5.9].

Lemma 2.3. Suppose that gcd(p, N ) = 3 and m := (p, I) is a maximal ideal of T. Then we have
dimFp Jp(Fp)[m] = 1.
We believe that the above assumption on gcd is superfluous, so we propose the following.

Conjecture 2.4. Suppose that N = 3M is squarefree and p = 3. If m is a maximal ideal of T, then
dimFp Jp(Fp)[m] = 1.
Suppose that m is maximal. By the same argument as above, J0(N )(Q)tors[p, I] is a cyclic module over Tp/I if gcd(p, N ) = 3. As above, we can construct a cuspidal divisor C annihilated by I. Since the order of the linear equivalence class of C is n, we then have2
J0(N )(Q)tors[p, I] = C(N )[p, I]  Zp/nZp.
Since J0(N )(Q)tors[p, I] = C(N )[p, I] = 0 if m is not maximal, we obtain the following.

Proposition 2.5. For any   {±1}t, we have J0(N )(Q)tors[p, I] = C(N )[p, I].
2Ohta didn't use the divisor C. Instead, he used Takagi's result on the cuspidal class number [21].

THE RATIONAL TORSION SUBGROUP OF J0(N )

7

Finally, we proceed as follows. Since Tp is a semi-local ring, we have the following decomposition:

Tp 

Tm,

mTp maximal

where

Tm

:=

lim
k

Tp/mk

is

the

completion

of

Tp

at

m.

Let



=

i

for

some

1



i



t,

and

let m be a maximal ideal of Tp. Since w2 - 1 = 0 as an element of End(J0(N )), we have

w -   m for some   {±1}. Thus, any maximal ideal containing IN is of the form m

for some   {±1}t. Moreover, since p is odd, w +   m and so it is a unit in Tm. Hence

we have w -  = 0  Tm. Now, let m = m for some   {±1}t. Then by the discussion above, we have wi - i =
0  Tm for any 1  i  t, and so Tm/I = Tm/IN . Also, since mk  I for sufficiently large k,3 we have

Thus, we have

Tm/I

=

lim
k

Tp/(mk,

I)



Tp/I.

Tp/IN 

Tm/IN =

Tm/I 

Tp/I.

IN mTp maximal

{±1}t

{±1}t

Accordingly, we have natural decompositions:

J0(N )(Q)tors[p, IN ] 

J0(N )(Q)tors[p, I],

{±1}t

C(N )[p, IN ] 

C(N )[p, I].

{±1}t

By Proposition 2.5, we finally have

J0(N )(Q)tors[p, IN ] = C(N )[p, IN ]

under the assumption that gcd(p, N) = 3, as desired.

Remark 2.6. As noticed by Ohta [16, pg. 317], Conjecture 2.4 is the only remaining part to remove this extra assumption gcd(p, N) = 3.

2.3. Generalization. Now, let N be a non-squarefree integer, i.e., N2 > 1. As noticed by many mathematicians (for example, see [22, Sec. 1.4.3]), when  N, the Atkin­Lehner operator w is more convenient for studying Eisenstein ideals than the Hecke operator T. On the other hand, we believe that the Hecke operator T is still important when 2 divides N . In that case, since T acts as zero on the new subvariety of J0(N ), it seems natural to consider the following Eisenstein ideal
I0 := (IN , T :  | N2) = (T - a() :   N1)  T.
Also, for any  = (1, . . . , t)  {±1}t, let
I0 := (I0, wi - i : 1  i  t) = (T - a(), wi - i :   N1, 1  i  t)  T.
3We may take k as the p-adic valuation of the index of I.

8

HWAJONG YOO

By the same argument as above, we have T/I0  Z/nZ for some n  1. As a natural generalization of the previous results, we propose the following.

Conjecture 2.7. For any  = (1, . . . , t)  {±1}t, the p-part of the index of I0 is equal to

that of

n0 := numerator

1 24

t
(i + i) ×

u

jrj-2(2j - 1)

.

i=1

j=t+1

Conjecture 2.8. Suppose that m0 := (p, I0) is a maximal ideal of T. Then we have dimFp Jp(Fp)[m0] = 1,
where Jp is the special fiber of the Néron model of J0(N ) over Fp.

By the same argument as in Proposition 2.5, we easily have the following.

Theorem 2.9. If Conjectures 2.7 and 2.8 both hold true, then we have J0(N )(Q)tors[p, I0] = C(N )[p, I0]  Zp/n0Zp for any   {±1}t.

Proof. By Conjecture 2.7, m0 := (p, I0) is maximal if and only if p divides n0. Thus, the result follows if m0 is not maximal. Assume that m0 is maximal. Since we have Conjecture 2.8, J0(N )(Q)tors[p, I0] is a cyclic module over Tp/I0 as above. Since the rational cuspidal divisor C0 defined in Section 3 is annihilated by I0 (Lemma 3.2) and the order of its linear equivalence class is n0 (or 2n0) (Lemma 3.3), the result follows by Conjecture 2.7.

By the same argument as above, we have

Tp/I0 

Tm0 /I0 

Tp/I0,

{±1}t

{±1}t

and so we have natural decompositions:

J0(N )(Q)tors[p, I0] 

J0(N )(Q)tors[p, I0],

{±1}t

C(N )[p, I0] 

C(N )[p, I0].

{±1}t

Hence by Theorem 2.9, we have the following.

Theorem 2.10. If Conjectures 2.7 and 2.8 both hold true, then we have
J0(N )(Q)tors[p, I0] = C(N )[p, I0].
As described above, Theorem 2.10 can be seen as a natural generalization of the work of Mazur and Ohta to non-squarefree level. However, in order to achieve our goal, we need to handle the operators T for any prime divisors  of N2. In other words, it is necessary to have an implication:
J0(N )(Q)tors[p, I0] = C(N )[p, I0] = J0(N )(Q)tors[p, IN ] = C(N )[p, IN ].
Under a mild assumption, we have the following.

THE RATIONAL TORSION SUBGROUP OF J0(N )

9

Theorem 2.11. Suppose that p4 does not divide N and J0(N/)(Q)tors[p] = C(N/)[p] for any prime divisors  of N2. Then we have
J0(N )(Q)tors[p, I0] = C(N )[p, I0] = J0(N )(Q)tors[p] = C(N )[p].

Proof. Suppose that  is a prime divisor of N2, i.e., 2 divides N . For simplicity, let A = J0(N )(Q)tors[p] and B = C(N )[p].

Since T preserves A and B, we have the following commutative diagram, where the two rows are exact and the vertical arrows are induced by the natural inclusion C(N) 

J0(N )(Q)tors:

0

/ A[T]

/ A T / T(A)

/0

O

O

O

0

/ B[T]

/ B T / T(B)

/ 0.

Since all the vertical arrows are injective, by five lemma, A = B if A[T] = B[T] and T(A) = T(B).
Let M = N/, and let

 := (M ) and  := (M )
denote two degeneracy maps from X0(N ) to X0(M). (For its definition, see [14, Sec. 13].) By Lemma 3.4 (and the assumption that p4 does not divide N ), we have ,(B) = C(M)[p]. Since the degeneracy map , is defined over Q, we have
,(A)  J0(M )(Q)tors[p] = C(M )[p],
where the equality follows by our assumption. Note that since 2 divides N, we have T =   , as endomorphisms of J0(N ) (cf. [27, (2.7)]). Thus, we have
T(A) = (,(A))  (C(M )[p]) = (,(B)) = T(B).
Since B  A, we have T(A) = T(B), and so A = B if A[T] = B[T]. Let  be a prime divisor of N2 different from . Then by the same argument as above,
it suffices to show that A[T] = B[T]. Since the operators T and T commute with each other, T preserves A[T] and B[T], and moreover we have
T(A[T]) = T(A)[T] = T(B)[T] = T(B[T])
as T(A) = T(B). Thus, if we replace A and B by A[T] and B[T], respectively, then we have an implication:
A[T][T] = B[T][T] = A = B. By doing this successively, we have

A[T :  | N2] = B[T :  | N2] = A = B. By Lemma 2.1, the result follows.

10

HWAJONG YOO

Corollary 2.12. Suppose that Conjectures 2.7 and 2.8 both hold true. Suppose further that Conjecture 2.4 holds true. If p4 does not divide N, then we have

J0(N )(Q)tors[p] = C(N )[p].

Proof. By the work of Ohta and Conjecture 2.4, we have

(2.1)

J0(N )(Q)tors[p] = C(N )[p],

where N = rad(N). Thus, the result follows when N is squarefree.

For simplicity, let N2 =

u j=t+1

rjj

for

some

rj



2,

and

assume

that

N2

>

1.

By

our

convention, N =

u i=1

ri i

with

ri

=

1

for

all

1



i



t

and

rj



2

for

all

t

<

j



u.

Let d =

u i=1

fi i

be

a

divisor

of

N

such

that

1



fi



ri

for

all

i.

If

d

is

not

squarefree

(including d = N), then we have

J0(d)(Q)tors[p, T : 2 | d] = C(d)[p, T : 2 | d]
as we have assumed Conjectures 2.7 and 2.8 (and p4 does not divide N). Thus, the result easily follows by induction on n(d), where n(d) := uj=t+1(fj - 1). Indeed, if n(d) = 1, then all the assumptions in Theorem 2.11 are satisfied for N = d as we have (2.1), and so

J0(d)(Q)tors[p] = C(d)[p]. By doing this successively, we obtain the result.

Now, we prove our main theorem.

Proof of Theorem 1.4. Note that Conjecture 2.7 (resp. 2.8) holds if p2 does not divide N (resp. 3N) by Theorem 4.1 (resp. 5.1). Thus, the result follows by the same argument as in Corollary 2.12.

3. R

In this section, we construct a rational cuspidal divisor C0 on X0(N ) for any   {±1}t.

To begin with, we recall some results about the cusps of X0(N). (For more details, see [28, Sec. 2].)

A

cusp

of

X0(N

)

can

be

written

as

[

x d

]

for

some

(positive)

divisor

d

of

N

,

where

x

is

an

integer relatively prime to d and 1  x  d. Such a cusp is called of level d. Any cusp of

level d is defined over Q(µz), where z = gcd(d, N/d), and the action of Gal(Q(µz)/Q) on the set of all cusps of level d is simply transitive. Thus, the divisor

(Pd) :=

c

c{cusps of level d}

is defined over Q. Since the degree of (Pd) is (gcd(d, N/d)), where  is Euler's totient function, the divisor

Cd := (gcd(d, N/d)) · (P1) - (Pd)

THE RATIONAL TORSION SUBGROUP OF J0(N )

11

is of degree 0. Let Divcusp(X0(N ))Q (resp. Div0cusp(X0(N ))Q) be the group of the rational

cuspidal divisors (resp. of degree 0) on X0(N). Then we have









Divcusp(X0(N ))Q =  a(d) · (Pd) : a(d)  Z . d|N

Let S2(N )Q be the Q-vector space of dimension 0(N ) indexed by the divisors of N ,

and let S2(N) be its canonical integral lattice. In other words,









S2(N ) :=  a(d) · e(N )d : a(d)  Z , d|N

where e(N )d is the unit vector in S2(N ) whose dth entry is 1 and all other entries are zero. Then there is a tautological bijection:

N : Divcusp(X0(N ))Q  S2(N )
sending (Pd) to e(N )d. By the Chinese Remainder theorem, we have a canonical isomorphism
S2(N )Q  S2(val(N))Q,
|N
and we identify both sides by insisting e(N )d = |N e(val(N))val(d). For simplicity, we denote by (v0, . . . , vr) an element of S2(r) whose ith entry is vi, i.e.,
r
(v0, . . . , vr) := vi · e(r)i.
i=0

Now, we are ready to define a rational cuspidal divisor C0 on X0(N ). As above, let

N2 =

u j=t+1

rjj

for

some

rj



2.

(If

N2

=

1,

then

we

set

u

=

t.)

From

now

on,

let

 = (1, . . . , t)  {±1}t.

Definition 3.1. For each 1  i  t, let

wi := (1, i)  S2(i).

Also, for each t < j  u, let

wj := (j - 1, -1, 0, . . . , 0)  S2(rjj ).

Finally, let

u

u

C0 := wi  S2(rii ) = S2(N ) and C0 := -N1(C0)  Divcusp(X0(N ))Q.

i=1

i=1

In other words, if we write C0 = d|N a(d) · (Pd), then we have



a(d)

=

 

0

t i=1

fi i

×

uj=t+1(j - 1)(1 - j )-fj

if d =

u i=1

fi i

is

squarefree,

otherwise.

12

HWAJONG YOO

From now on, let C0 denote the linear equivalence class of C0 in J0(N ). Note that the degree of C0 is 0 unless N is squarefree and  = +, in which case it is 2t. So we exclude the case  = + when N is squarefree.

By [28, Lem. 2.23], we have the following.

Lemma 3.2. For any 1  i  t and any prime  not dividing N1, we have wi (C0) = i · C0 and T(C0) = a() · C0.
Also, we have the following.

Lemma 3.3. Assume  = + if N is squarefree. Then the order of C0 is

numerator

h 24

t
(i + i) ×

u

jrj-2(2j - 1)

,

i=1

j=t+1

where h = 2 if N is either a prime or a power of 2, and h = 1 otherwise.

Proof. We use the method in [28, Sec. 3]. Also, we use the same notation as in op. cit. By Theorem 3.13 of op. cit., the order of the linear equivalence class of C0 is equal to

numerator

(N ) × h(C0) 24 × Gcd(C0)

.

By Theorem 3.15 of op. cit., it suffices to compute the following: For each   {±1}, we have

()

×

(

1 

)

=

 -1 -1 

×

(

1 

)

=

(

-

)

(

1 

)

.

Also, for each r  2, we have

-1

 - ...

-1



(r) ×

-1 0

=

-1 2+1 ... 0 - ...

×

-1 0

=

--1 1

,

O

O O ...

O

O

where O denotes the zero vector of size r - 2. Thus, we have

(N ) Gcd(C0)

=

t
(i
i=1

+

i)

×

u
rjj -2(2j
j=t+1

-

1).

Since the sum of the entries of (1, )t (or of (, - - 1, 1, 0, . . . , 0)t) is even, we easily have h(C0) = h. This completes the proof.

We finish this section by the following.

Lemma 3.4. Let N = M , and let  := (M ) : Div0cusp(X0(N ))Q  Div0cusp(X0(M ))Q be the map induced by the degeneracy map (M) : X0(N )  X0(M). Then we have
Div0cusp(X0(M ))Q/(Div0cusp(X0(N ))Q)  (Z/Z)k
for some k  0. Moreover, if 4 does not divide N , then k = 0.

THE RATIONAL TORSION SUBGROUP OF J0(N )

13

Proof. During the proof, we identify Divcusp(X0(N ))Q and Divcusp(X0(M ))Q with S2(N ) and S2(M) (by the maps N and M ), respectively. And we regard  as a map from S2(N ) to S2(M ). Let S2(N )0 (resp. S2(M )0) denote the images of Div0cusp(X0(N ))Q (resp. Div0cusp(X0(M ))Q) by N (resp. M ). Since (S2(N )0) = (S2(N ))  S2(M )0, it suffices to show that
S2(M )/(S2(N ))  (Z/Z)k
for some k  0, and k = 0 if 4 does not divide N . For simplicity, let M = Lr with gcd(L, ) = 1. Also, let d be a divisor of L. Then by
[28, Lem. 2.21], we have

(e(N )df+1) = b(f ) · e(M )df for any 1  f  r, where b(f ) =  if 1  f < r/2 and b(f ) = 1 otherwise. Moreover, we have

(3.1)

(e(N )d) = ( - 1) · e(M )d and (e(N )d) = e(M )d.

Since e(M )df are the generators of S2(M ), we have (S2(N )) = S2(M ) if b(f ) = 1 for any 1  f  r. Also, we have (S2(N ))   · S2(M), and so

S2(M )/ · S2(M )  (Z/Z)0(M)  S2(M )/(S2(N )).

This completes the proof.

Remark 3.5. As already mentioned, T =   , if 2 divides N . So by (3.1), it is easy to see that for any t < j  u, we have Tj (C0) = 0.

4. T

E

From now on, let  = (1, . . . , t)  {±1}t. In this section, we prove the following.

Theorem 4.1. Suppose that N is not squarefree, i.e., N2 > 1. If p2 does not divide N , or equivalently, p does not divide N2, then the p-part of the index of I0 is equal to that of n0, i.e., we have
Tp/I0  Zp/n0Zp.

4.1. Generalities. In this subsection, we recall some results about modular forms over R, where R = Z(p)4 or R = Z/pmZ for some m  1. Our reference is the paper of Ohta [16], and all the Sections, Lemmas, Equations and Propositions below are from there.
First, we assume that p does not divide N . As in Section 1.2, let M2A(0(N ); R) (resp. S2A(0(N ); R)) be the spaces of modular forms (resp. cusp forms) of weight 2 over R for 0(N) in the sense of Deligne and Rapoport [3] and Katz [6]. Also, as in Section 1.3, let M2(0(N )) (resp. S2(0(N ))) be the complex vector space of modular forms (resp. cusp forms) of weight 2 for 0(N ) in the usual sense. For any f  M2(0(N )), let f (q) denote

4We denote by Z(p) the localization of Z at the prime ideal (p).

14

HWAJONG YOO

its q-expansion at the cusp , and for any f  M2A(0(N ); R), let f (q) denote the image of f in R[[q]] as in (1.2.9). Also, let a(n; f ) be the nth coefficient of f (q), i.e.,

f (q) = a(n; f ) · qn.
n0
Let M2B(0(N ); Z) := {f  M2(0(N )) : f (q)  Z[[q]]}, S2B(0(N ); Z) := {f  S2(0(N )) : f (q)  Z[[q]]}
and M2B(0(N ); R) := M2B(0(N ); Z) Z R, S2B(0(N ); R) := S2B(0(N ); Z) Z R.
By (1.3.4), we have M2A(0(N ); Z(p)) = M2B(0(N ); Z(p)).
Also, by Lemma (1.3.5), we have

M2B(0(N ); Z/pmZ)  M2A(0(N ); Z/pmZ)
preserving q-expansions as p does not divide N. Next, we assume that p2 does not divide N. As in Section 1.4, let
M2reg(0(N ); R) := H0(X0(N )/R, (cusps)), S2reg(0(N ); R) := H0(X0(N )/R, ),
where  is the sheaf of regular differentials on X0(N )/R and cusps is the scheme of cusps of X0(N )/R. By Proposition (1.4.8), if p N , there there exist q-expansion preserving maps:
M2reg(0(N ); R)  M2B(0(N ); R), S2reg(0(N ); R)  S2B(0(N ); R),
which are injections when R = Z(p). If p does not divide N , then R is a Z[1/N ]-algebra, and so the above maps are in fact isomorphisms (cf. Corollary (1.4.10)). We henceforth follow Convention (1.4.16), and write f (q) for the q-expansion of f  M2reg(0(N ); R).
By the discussions in Section 1.5, there are actions of the Hecke operators T (for any primes  = p) and the Atkin­Lehner operators w (for any primes  | N1) on M2reg(0(N ); R) (resp. S2reg(0(N ); R)). As usual, we identify Tp with a subring of End(S2reg(0(N ); Zp)) generated by the same-named operators (cf. [14, Sec. 1.1] or [16, pg. 275]). Let
M2reg(0(N ); R) := M2reg(0(N ); R)[wi - i : 1  i  t], S2reg(0(N ); R) := S2reg(0(N ); R)[wi - i : 1  i  t].
The following is crucial in our proof.

THE RATIONAL TORSION SUBGROUP OF J0(N )

15

Proposition 4.2. Let R = Z/pmZ for some m  1. Let

g(q) = a(n; g) · qn  M2reg(0(N ); R)
n0

such that a(n; g) = 0 unless gcd(n, N1) > 1. Suppose further that a(0; g) = 0. Then g = 0.

Proof. Suppose first that p does not divide N. By the discussion above, we have
M2reg(0(N ); R) = M2B(0(N ); R)  M2A(0(N ); R)
preserving q-expansions. Thus, g can be regarded as an element of M2A(0(N ); R) such that wi(g) = i · g for all 1  i  t and a(n; g) = 0 unless gcd(n, N1) > 1. So g is a constant by Proposition (2.1.2). Since a(0; g) = 0, we have g = 0, as claimed.
Suppose next that p N. Suppose that g = 0, i.e., there is an integer k such that a(k; g)  0 (mod pm). Let  : Z(p)  R be the natural map induced by the reduction modulo pm. Since the map
M2reg(0(N ); Z(p))  M2reg(0(N ); R)
induced by  is surjective, there is a lift
g(q) = a(n; g) · qn  M2reg(0(N ); Z(p))
n0
such that (a(n; g)) = a(n; g) for all n  0. Since a(k; g)  0 (mod pm), the greatest common divisor of the coefficients a(n; g) is pa for some 0  a < m. By definition, we have p-a · a(n; g)  Z(p) for all n  0, and so
f := p-a · g  M2B(0(N ); Z(p)).
Let wp(g)(q) = n0 an · qn. Since wp(g) = g for some   {±1}, we have an  a(n; g) (mod pm), and so an is divisible by pa for all n  0. Thus, f  M2reg(0(N ); Z(p)) by Proposition (1.4.9). Let f be the image of f in M2reg(0(N ); Fp), which is non-zero by its construction. Since a < m, we have wi(f ) = i · f for all 1  i  t and a(n; f ) = 0 unless gcd(n, N1) > 1. Thus, by the same argument as in Proposition (2.2.7)5, we have f = 0, which is a contradiction. Therefore g = 0, as claimed.

Since we have Proposition 4.2, we can mimic the arguments in Theorem (2.4.6) and Corollary (2.4.7). As a result, we have the following.

Proposition 4.3. There is a perfect pairing: S2reg(0(N ); Zp) × Tp -( , ) Zp,
where Tp := Tp/ wi - i : 1  i  t .

5Indeed, Ohta assumed that N is squarefree in the proposition, but it is not used in the proof. What is used there is that i N for 1  i  s, which are guaranteed here.

16

HWAJONG YOO

4.2. Eisenstein series. In this subsection, we construct an Eisenstein series E0 using various "level-raising" maps between the spaces of modular forms (cf. [16, Sec. 2.3], [25,
Def. 2.5], [27, Sec. 5]). For convenience, we assume that N is not squarefree, i.e., N2 > 1.

Definition 4.4. Let  be a prime not dividing M. For any f  M2(0(M)), let []+(f )( ) := f ( ) + f ( ) and []-(f )( ) := f ( ) - f ( ),

respectively. For any r  2, we define a map [r]0 from M2(0(M )) to M2(0(M r)) by6

[r]0(f )( ) := f ( ) - ( + 1)f ( ) + f (2 ).

Note that for any f  M2(0(M)) and r  2, we have

a(1; [r]0(f )) = a(1; []+(f )) = a(1; []-(f )) = a(1; f ).

Definition 4.5. Let N2 =

u j=t+1

rjj

>

1

for

some

rj



2.

Then

we

define

E0 := [1]1  · · ·  [t]t  [rt+t+11]0  · · ·  [ruu]0  (K)  M2(0(N )),

where K--see [16, Sec. 2.3] for its definition--is a non-holomorphic Eisenstein series of level 1.7

By its construction, we easily have the following.

Lemma 4.6. For any 1  i  t and any prime  not dividing N1, we have
wi(E0) = i · E0 and T(E0) = a() · E0. Also, we have a(1; E0) = 1. Proof. By the same argument as in [27, Prop. 5.4], the first assertion follows. Since a(1; K) = 1, the second assertion follows by the property of the "level-raising" maps.

Lemma 4.7. The residue of E0 at any cusp of level d is 0 if d is not squarefree, and

1 24

t

fi i(i + i)

u

rjj-3(1 - 2j )(1 - j )1-fj

i=1

j=t+1

if d =

u i=1

fi i

is

squarefree.

In

particular,

the

residue

of

E0

at

any

cusp

of

level

rad(N )

is

±

n0 rad(N2

)

.

Proof. By the same argument as in [27, Lem. 5.8], the result follows.

6In fact, [r]0(f ) is a modular form for 0(M 2). 7Since K is not a genuine modular form, the definition seems invalid. However, [ruu]0(K) is a genuine modular form for 0(ruu) as the non-holomorphic term of [ruu]0(K) vanishes. Thus, the definition makes sense.

THE RATIONAL TORSION SUBGROUP OF J0(N )

17

4.3. Proof of Theorem 4.1. Now, we are ready to prove Theorem 4.1. Suppose that
Tp/I0  Z/pmZ for some m  0. Let C0 denote the linear equivalence class of C0 in J0(N ). Note that we have

Tp/I0  End( C0 [p])  Zp/n0Zp,

where the first surjection follows by Lemma 3.2 and the second isomorphism follows by Lemma 3.3. Thus, we have m  valp(n0), and it suffices to show that m  valp(n0). If m = 0, then there is nothing to prove, so we assume that m  1.
We first claim that E0  M2reg(0(N ); Z(p)). For simplicity, let
M2reg := M2reg(0(N ); Z(p)) and M2B := M2B(0(N ); Z(p)).
By Lemma 4.6, it suffices to show that E0  M2reg. Since all the coefficients of the qexpansion of E0 are integral, we have E0  M2B. If p does not divide N , then the claim follows as M2reg = M2B. If p N , then the claim follows by Proposition (1.4.9) of [16] as wp(E0) = ±E0.
Next, we note that Tp/I0 = Tp/I0. So by Proposition 4.3, there is
f (q) = n1 a(n; f ) · qn  S2reg(0(N ); Z/pmZ)

such that a(n; f ) = Tn (mod I0)  Tp/I0  Z/pmZ whenever gcd(n, N1) = 1. In
particular, a(1; f ) = 1 and a(; f ) = a() for any primes  not dividing N1. Finally, we consider the image of E0 in M2reg(0(N ); Z/pmZ), denoted by E. Note that
a(0; E) = 0 by direct computation.8 Thus, if we take

g = E - f  M2reg(0(N ); Z/pmZ),

then it satisfies all the assumptions in Proposition 4.2. Thus, we have E = f . Since f  S2reg(0(N ); Z/pmZ), the residue of E0 at any cusp must be divisible by pm. By
Lemma 4.7, we then have

m  valp

n0 rad(N2)

= valp(n0)

as p does not divide N2. This completes the proof.

5. T

E

p

As in the previous section, let  = (1, . . . , t)  {±1}t.

Theorem 5.1. Suppose that N is not squarefree, i.e., N2 > 1. Also, suppose that m0 := (p, I0) is maximal. If p2 does not divide 3N , then we have
dimFp Jp(Fp)[m0] = 1,
where Jp is the special fiber of the Néron model of J0(N ) over Fp.
8Note that the residue of E at the cusp , which is of level N , is zero by Lemma 4.7.

18

HWAJONG YOO

Proof of Theorem 5.1. By Theorem 4.1, m0 is maximal if and only if p divides n0. Since C0 [p]  Z/pZ maps injectively into Jp(Fp)[m0], it suffices to show that
dimFpJp(Fp)[m0]  1.
Suppose first that p does not divide N , and so Jp = J0(N )/Fp as J0(N ) has good reduction at p. Then the result follows by Mazur's argument [13, Ch. II, Cor. 14.8]. (For instance, see Ohta's argument in [16, Prop. 3.5.4], which is a direct generalization of Mazur's. It works verbatim for non-squarefree N.)
Suppose next that N = Mp with gcd(M, p) = 1 and p  5. As is well-known, Jp is an extension of the component group p by the identity component Jp0. Moreover, Jp0 is an extension of an abelian variety J0(M )/Fp × J0(M )/Fp by a torus Tp. We proceed as follows:
(1) Tp[m0] = 0 as Tp(Fp) does not have non-trivial p-torsion. (2) Let  be a prime divisor of N2. Then p[m0]  p[p, T] = 0 as T acts on p by 
[8, Th. 1.1]. (3) For simplicity, let p = 1. For avoidance of confusion, for a prime , let  be the th
Hecke operator acting on J0(M), and for any 2  i  t, let i be the Atkin­Lehner operator with respect to i acting on J0(M). Let
T := Z[, i : for any primes   N1 and 2  i  t]  End(J0(M )).
As a variant of Ribet's lemma [24, pg. 491], we have T = T(M).9 Let

I = (i - i,  - a() : for any primes   N1 and 2  i  t)  T.

Then we can construct a rational cuspidal divisor C on X0(M) annihilated by

I. Indeed, if we let  := (2, . . . , t)  {±1}t-1, then we set C := C0 

Div0cusp(X0(M ))Q, which is of degree 0 as M is not squarefree. By Lemma 3.3,

the

order

of

the

linear

equivalence

class

of

C

in

J0(M )

is

either

n0 (p+1)

or

. 2n0
(p+1)

Thus, its p-part is equal to that of n0, and so the ideal m := (p, I0)  T(M ) is

also maximal. Since p does not divide M, by the result above we have

dimFpJ0(M )/Fp (Fp)[m]  1.

Note that T(N ) acts on J0(M )/Fp × J0(M )/Fp as follows: For any primes  not dividing N1 and 2  i  t, we have

wp

=

(

0 1

1 0

)

,

T =

 0 0 

and

wi =

. i 0
0 i

(For instance, see the proof of [16, Prop. 3.5.9].) Thus, there is an isomorphism

J0(M )/Fp (Fp)[m]  (J0(M )/Fp × J0(M )/Fp )(Fp)[m0]
sending x to (x, 1x), and so the dimension of (J0(M )/Fp × J0(M )/Fp)(Fp)[m0] is at most 1 .
9Note that T(M ) contains the pth Hecke operator p, but T does not. Nonetheless, the claim follows as p is odd.

THE RATIONAL TORSION SUBGROUP OF J0(N )

19

This completes the proof.

Remark 5.2. The proof of Theorem 5.1 is almost the same as that of [16, Prop. 3.5.9]. More specifically, the only difference is the component group part (2). In our case, (2) is much simpler thanks to the existence of the prime divisor  of N2. (For instance, it is not necessary to distinguish the case  = + with others.)

R
[1] J. Box, Quadratic points on modular curves with infinite Mordell­Weil group, preprint, arXiv:1906.05206v3 [math.NT].
[2] F. Calegari and M. Emerton, On the ramification of the Hecke algebras at Eisenstein primes, Invent. Math. 160 (2005), 97­144.
[3] P. Deligne and M.l Rapoport, Les schémas de modules de courbes elliptiques, Modular functions of one variable II, Lecture Notes in Math., Vol. 349 (1973), 143­316.
[4] V. Drinfeld, Two theorems on modular curves, Functional Anal. Appl., 7 (1973), 155­156. [5] J. Guo, Y. Yang, H. Yoo and M. Yu, work in progress. [6] N. Katz, p-adic properties of modular schemes and modular forms, Modular functions of one variable III,
Lecture Notes in Math., Vol. 350 (1973), 69­190. [7] N. Katz, Galois properties of torsion points on abelian varieties, Invent. Math. 62 (1981), 481­502. [8] T. Kim and H. Yoo, The action of the Hecke operators on the component groups of modular Jacobian
varieties, Pacific. J. Math., Vol. 296, No.2 (2018), 341­355. [9] G. Ligozat, Courbes modulaires de genre 1, Bull. Soc. Math. France, Mémoire, tome 43 (1975), 5­80. [10] S. Ling, On the Q-rational cuspidal subgroup and the component group of J0(pr), Israel J. Math. 99 (1997),
29­54. [11] D. Lorenzini, Torsion points on the modular Jacobian J0(N ), Compos. Math., tome 96, no. 2 (1995),
149­172. [12] Y. Manin, Parabolic points and zeta functions of modular curves (in Russian), Izv. Akad. Nauk SSSR Ser.
Mat., 36 (1972), 19­66. Translation in Math USSR-Izv, 6 (1972), 19­64. [13] B. Mazur, Modular curves and the Eisenstein ideal, Publ. Math. Inst. Hautes Études Sci., tome 47 (1977),
33­186. [14] B. Mazur and K. Ribet, Two-dimensional representations in the arithmetic of modular curves, Courbes
modulaires et courbes de Shimura (Orsay, 1987/1988), Astérisque, No. 196-197 (1991), 215­255. [15] A. Ogg, Diophantine equations and modular forms, Bull. Amer. Math. Soc., Vol. 81 (1975), 14­27. [16] M. Ohta, Eisenstein ideals and the rational torsion subgroups of modular Jacobian varieties II, Tokyo J.
Math., Vol. 37, No. 2 (2014), 273­318. [17] E. Ozman and S. Siksek, Quadratic points on modular curves, Math. Comp., Vol. 88, No. 319 (2019),
2461­2484. [18] D. Poulakis, La courbe modulaire X0(125) et sa jacobienne, J. Number theory, Vol. 25 (1987), 112­131. [19] Y. Ren, Rational torsion subgroups of modular Jacobian varieties, J. Number Theory, Vol. 190 (2018),
169­186. [20] J.-P. Serre and J. Tate, Good reduction of abelian varieties, Ann. of Math., 88 (1968), 492­517. [21] T. Takagi, The cuspidal class number formula for the modular curves X0(M ) with M square-free, J. Al-
gebra, 193 (1997), 180­213. [22] P. Wake and C. Wang-Erickson, The Eisenstein ideal with squarefree level, Advances in Math., 380 (2021)
107543.

20

HWAJONG YOO

[23] L. Wang and Y. Yang, Modular units and cuspidal divisor classes on X0(n2M ) with n|24 and M squarefree, J. Algebra 562 (2020), 410­432.
[24] A. Wiles, Modular elliptic curves and Fermat's Last Theorem, Ann. of Math., 142 (1995), 443­551. [25] H. Yoo, The index of an Eisenstein ideal and multiplicity one, Math. Z., Vol. 282(3) (2016), 1097­1116. [26] H. Yoo, Rational torsion points on Jacobians of modular curves, Acta Arith. 3472 (2016), 299­304. [27] H. Yoo, On rational Eisenstein primes and the rational cuspidal groups of modular Jacobian varieties,
Trans. Amer. Math. Soc., Vol. 372(4) (2019) 2429­2466. [28] H. Yoo, The rational cuspidal divisor class group of X0(N ), preprint, arXiv:1908.06411v2 [math.NT].

C

L

S

R

I

S 08826, S K

Email address: hwajong@snu.ac.kr

M

,S N

U

,

