arXiv:2106.01701v1 [math.AP] 3 Jun 2021

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS
M. PASCHALIS
Abstract. We introduce a geometric approach of integral curves for functional inequalities involving directional derivatives in the general context of differentiable manifolds that are equipped with a volume form. We focus on Hardy-type inequalities and the explicit optimal Hardy potentials that are induced by this method. We then apply the method to retrieve some known inequalities and establish some new ones.

1. Introduction

We begin by providing some background on Hardy inequalities. The classic Lp Hardy inequality in RN reads

|(x)|pdx 
RN

p-N p p

|(x)|p RN |x|p dx,

  Cc1(RN \ {0}),

and has important applications in the theory of PDEs involving singular potentials. Without surprise, the Euclidean case of this type of inequality and its spin-offs has been studied extensively for several decades. For an extensive reference on Hardy inequalities, see [1].
A type of Hardy inequality that has attracted a lot of interest lately is one that involves the distance from the boundary of a domain U  RN . In particular, such a result should read

|(x)|pdx  c
U

|(x)|p U d(x)p dx,

  Cc1(U ),

where d(x) = dist(x, U ) and c is the optimal positive constant (if any) for which the inequality is valid. Such results are known to exist if U is convex or when U is bounded and has Lipschitz boundary, for example. In particular, the one dimensional case for the interval (a, b) reads

()

b
| (x)|pdx 
a

p-1 p b

|(x)|p

p

a min{x - a, b - x}p dx,

  Cc1((a, b)).

In the present article, we propose a method of integration along integral curves to obtain a "lifting" of this inequality for differentiable manifolds of arbitrary dimension that are subject to a simple geometric condition that is satisfied in a large number of cases. In particular, if M is an oriented differentiable manifold with

2000 Mathematics Subject Classification. Primary 35J75, 58J05; Secondary 58J05, 35R01, 35J62.
Key words and phrases. Hardy Inequality; Directional derivative; Vector field; Flow; Manifold.
1

2

M. PASCHALIS

positive volume form  and X is a non-vanishing vector field on M , we prove the optimal inequality

|X|p 
M

p - 1 p ||p

p

M pp ,

  Cc1(M ),

where p is a suitable "boundary distance" that depends on the geometry of the configuration. It is worth noting that in our method p is calculated explicitly and is usually highly non-trivial, except for the simplest of cases.
Although our results apply more generally, of special interest is the case of a Riemannian manifold (M, g), where we can apply the method to retrieve inequalities involving the Riemannian gradient g and the associated volume form g. Our method can easily provide optimal, non-trivial Hardy potentials in a multitude of such cases, as we demonstrate through specific examples.

2. Preliminaries
We begin by setting the context and introducing the necessary notions that will be used throughout the rest of this work.
Definition 2.1. Let M be a smooth manifold of dimension N .
(1) A non-vanishing vector field X  (T M ) is called a direction field on M . The pair (M, X) is then called a directed space.
(2) A non-vanishing N -form   N (T M ) is called a volume form on M . (3) A triple (M, X, ) that consists of a smooth manifold, a direction field and
a volume form is called a directed volume space.
In what follows and unless otherwise stated, M will stand for a non-compact, oriented smooth manifold of dimension N , X will be a direction field and  will be a volume form on M . Hereafter, we will also make the implicit assumption that  is positive in the chosen orientation.
As usual, an integral curve on the directed space (M, X) will be a curve  : I  M such that  = X  . By the existence and uniqueness theorem for ODEs, for each point z  M , there exists a unique maximal integral curve z : Iz  M such that z(0) = z. The flow of X is then defined to be the smooth map
 : Iz  M, (z, t) = z(t).
zM
The directed space (M, X) is said to be complete if Iz = R for all z  M . The type of spaces that will occupy our attention are essentially the opposite of complete spaces in the following sense.
Definition 2.2. A directed space is said to be traceable if Iz R for all z  M .
To get an intuitive understanding of this definition, consider the one-point compactification of M with  being the point at infinity. Traceable spaces are exactly the ones in which starting at any point and following the flow of the field will take one to  at finite time in at least one direction (positive or negative time).
Traceable spaces are important for our purposes because one can naturally define a temporal distance function from infinity: if z  M is a point, define
 (z) = dist(0, Iz).

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

3

Then  : M  R is obviously well-defined and positive everywhere in the manifold, and its value at any point is equal to the time required to reach infinity if one follows the flow of the field starting from that point.
Each directed space (M, X) comes naturally equipped with an equivalence relation  that takes two points to be equivalent if they belong to the same integral curve. The resulting quotient space, which we denote by M/X, is called the orbit space of (M, X), and in general fails to be a manifold. We will be interested in subsets of M that are saturated with respect to this relation.
Definition 2.3. Let (M, X) be a directed space.
(1) A subset S  M is said to be saturated if Im(z)  S for all z  S. (2) If S  M is any subset, we define the saturation of S to be the set
(S) = Im(z).
zS
In other words, if a saturated subset S contains a point then it contains the entire integral curve that point belongs to. Obviously, S is saturated if and only if S = (S). Moreover, since the flow is an open map, if S is open, so is (S).
In each directed space, one can introduce, at least locally, a set of normal coordinates  = (t, s) = (t, s1, . . . , sN-1) with the property /t = X. In terms of the corresponding parametrisation  = -1, this can be expressed equivalently as
t(t, s) = X  (t, s).
Actually, this means that  forms a family of integral curves parametrised by s. While it is incorrect to assume that every directed space can be covered by a single normal coordinate chart, it is obvious that one always has an open cover of the manifold consisting of saturated normal chart domains (to see this, for each point z  M , pick a normal coordinate ball B centered at z and consider (B)).
In normal coordinates,  admits a local expression
 = (t, s)dt  ds,
with  being the local volume density in these coordinates. In general,  depends both on s and t. Directed volume spaces in which 's don't depend on t form a special class which is much easier to deal with for our purposes, so we give them a name.
Definition 2.4. A directed volume space (M, X, ) is called simple if the local volume density of  in normal coordinates is independent of t.
We will develop a method of obtaining Hardy inequalities for directed volume spaces regardless of whether they are simple or not. In fact, the most interesting cases are usually non-simple. However, simple spaces, as we will see shortly, are much easier to deal with and are the natural starting point for our line of work.

3. The simple case
First we deal with simple spaces. The derivation of a Hardy inequality is much simpler in that case, and sets the background for the more advanced techniques that are required to treat the general case.
Intuitively, the method we develop can be described as follows:

4

M. PASCHALIS

(1) Cover the space with saturated normal coordinate charts. This way we can "write down" the space as a parametrised family of integral curves.
(2) Apply the one-dimensional Hardy inequality ( ) along each curve separately.
(3) Integrate over all integral curves using the normal coordinates.
At this point, we are ready to state and prove the main theorem of this section.

Theorem 3.1. Let (M, X, ) be a simple and traceable directed volume space. Then

the inequality

(3.1)

|X|p 
M

p - 1 p ||p

p

M p ,

  Cc1(M )

holds for all p > 1.

Proof. Let (U, ) be a saturated normal coordinate chart on M with  : U  U~
for some open U~  RN-1 and let  = -1 be the corresponding parametrisation. Since U is saturated, U~ must be of the form sS Is for some open S  RN-1 and
some intervals Is R, so we have coordinates (t, s) where s  S and t  Is. Let

 = (s)dt  ds

in these coordinates. Moreover, we clearly have that

(t, s) = (0,s)(t), t  Is = I(0,s)

and that
  (t, s) = dist(t, Is). Now, it is clear that   (·, s)  Cc1(Is) for all s  S. Applying the onedimensional Hardy inequality ( ) on   (·, s) for fixed s we get

|t(  )(t, s))|pdt 
Is

p - 1 p |  (t, s)|p

p

Is dist(t, Is)p dt,

which by the properties of normal coordinates is equivalent to

|X  (t, s)|pdt 
Is

p - 1 p |  (t, s)|p

p

Is  p  (t, s) dt.

Multiplying both sides by (s) (which is positive by assumption), integrating over

S and applying Fubini's theorem yields

|X  (t, s)|p(s)dtds 
S Is

p-1 p

|  (t, s)|p

p

S Is  p  (t, s) (s)dtds,

which, in terms of differential forms, is the same as

|X  |p det 
U~

p - 1 p |  |p

p

U~  p    det .

The diffeomorphic invariance formula for integration on forms (see the Appendix)

then yields

|X|p 
U

p - 1 p ||p

p

U p .

To complete the proof, let {(Uj, j)}jJ be an atlas of M that consists of sat-

urated normal charts as above. The collection {Uj}jJ is then an open cover of M , and therefore an open cover of supp(). Furthermore, supp(), being compact,

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

5

must have a finite subcover {U1, . . . , Un}. For the final step, consider the saturated open sets W1, . . . , Wn, defined as
k-1
W1 = U1, Wk = Uk \ U¯l.
l=1
The collection {(Wk, k)} and its corresponding parametrisations then satisfy the conditions of Lemma A.2 and the proof is finished.

In some cases, the last argument can be replaced by a partition of unity argument. This would require that we project an open cover onto M/X, and then assume a partition of unity for the projected cover. However, this assumption is not always valid, as M/X need not be Hausdorff.
Another, more important point is to note that the constant that appears in the theorem is optimal. Seeing that this is so is rather straightforward: simply pick a sequence  such that supp( ) converges to a single integral curve. If the inequality where to hold true for a larger constant, that would mean that the onedimensional Hardy inequality from which it was derived would also hold for that constant, which is known to be false.

Example 3.2. The prototype of simple traceable spaces spaces is the Euclidean half-space RN+ = {x  RN : xN > 0} equipped with the parallel vector field /xN . The normal coordinates in this case are given by t = xN and s = (x1, . . . , xN-1), so we have that  = dx1  · · ·  dxN = dt  ds (if necessary, take one of the s coordinates to have an opposite sign in order to mitigate the extra sign that might

occur from changing the order in the exterior product). Moreover, we clearly have

 = xN , so it follows from Theorem 3.1. that the inequality

 p dx 
RN + xN

p-1 p

||p

p

RN + xpN dx,

  Cc1(RN+ )

holds for all p > 1.

Example 3.3. A less trivial example that still falls within the class of simple cases is that of a two-dimensional angle A = {x  R2 : 0 < (x) < } (for some given   (0, 2]) equipped with the vector field

X = r /p  

for some p > 1 and some  R. In polar coordinates, we have  = rd  dr. To

find a set of normal coordinates (t, s) for this configuration, choose s = r and notice

that we must wave

 = r /p  ,

t



and

therefore

we

may

choose

t

=

r


/p

.

Moreover,

it

follows

that

d = s /pdt +

-p
ts p ds,

p

hence  = s /p+1dt  ds, so (A, X, ) is simple. Since the integral curves here follow

co-centric circles each with angular velocity r /p, it follows that  = r- /p min{, -

}. Direct application of Theorem 3.1 yields the inequality

 p

r

dx 

A 

p-1 p

||p

p

r
A

min{,  - }p dx,

  Cc1(A).

6

M. PASCHALIS

It is worth noting that in the special case = -p, we get an inequality involving

the angular component of the gradient, thus we have

||pdx 
A

p-1 p

||p

p

A rp min{,  - }p dx,

  Cc1(A).

4. p-normal coordinates

The proof of (3.1) was based on the fact that we can multiply the integral over

dt with (s) and then pass (s) inside the integral (since it is independent of t). If

we look at the more general case of a non-simple space where (t, s) depends also

on t, it is clear that one cannot repeat this argument.

We can bypass this difficulty by introducing new coordinates that are related to

the initial set of normal coordinates (t, s). These new coordinates, denoted (t , s ),

will have the property

X =  =  (t , s )-1/p  ,

t

t

where  (t , s ) = (t , s ) is the local volume density in these new coordinates.

This way, we can get an integral over dt which contains both the correct vector

field and the correct volume element from the beginning.

This motivates the following definition.

Definition 4.1. Let (M, X, ) be a directed volume space, and let p > 1. A set of coordinates (, ) = (, 1, . . . , N-1) (defined on some open set) will be called a set of p-normal coordinates along X with respect to  if
X = (, )-1/p  . 
We dedicate the remainder of this section to prove the existence and some useful properties of these coordinates. We also explore their connection to regular normal coordinates as defined previously, and relate to them a well-defined (independent of coordinates) temporal/volumetric "distance" like  in the previous sections. These facts will form the necessary background to generalise (3.1) to include non-simple spaces.

Proposition 4.2 (Existence). Let (t, s) be a set of normal coordinates on some

open U  M in the directed volume space (M, X, ). The coordinates (t , s ) defined

by

t

t=

(

,

s)-

1 p-1

d

,

s =s

is a set of p-normal coordinates along X with respect to  on U .

Proof. It is clear that and we calculate

t

=

(t,

s)-

1 p-1

,

t

t

t

(t, s) = (t, s) =

t (t , s ) =

 (t , s ). t

It follows that

t =  (t , s )-1/p, t

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

7

thus

 (t , s )-1/p 

 =

= X,

t t

so the set of coordinates (t , s ) is indeed p-normal along X with respect to .

Since  is non-vanishing, it follows that (t, s) > 0, so in particular t is well-

defined everywhere in U .

This not only proves existence, but also provides a practical way to compute such coordinates, provided we already have a set of normal coordinates, which are often straightforward to acquire.
Another fact is that these coordinates cooperate well with the flow of the field X. If we choose a saturated normal chart, which we already know how to produce, it is straightforward to turn it into a p-normal saturated coordinate chart using the above transformation. This is evident from the fact that the vector field (, )-1/pX has the same integral curves as X, only reparametrised.
Recall that for a directed volume space, we defined the associated temporal distance  : M  R, which essentially measures the amount of time required to reach the "boundary" of M moving along the flow of X. Equivalently, if (t, s) is a set of normal coordinates in a saturated domain such that t  Is = (as, bs), then
 = dist(t, Is) = min(t - as, bs - t).
We now introduce the following notation.

Definition 4.3. Let f : I  R be a measurable function on the interval I = (a, b) (here it is possible that a = - or b = +). Define

t
f ()d = min
I

t

b

f ()d, f ()d .

a

t

In this notation, it is clear that

t
 = d.
Is
Moreover, the condition that (M, X) is traceable can be rewritten as

t
 = d <  everywhere in M.
Is
It turns out that what we need in the case of non-simple spaces, is a suitable modification of this with respect to p-normal coordinates.

Definition 4.4. Let (M, X, ) be a directed volume space and let (t, s), t  Is be normal coordinates for a saturated chart domain U  M , let (t, s) be the local volume density in these coordinates and let p > 1.

(1) We say that U is p-traceable if

t

(,

s)-

1 p-1

d

<



everywhere

in

U.

Is

(2) If U is p-traceable, we define the associated temporal/volumetric distance p : U  R to be the function

t

1
p = (t, s) p-1

(

,

s)-

1 p-1

d

.

Is

8

M. PASCHALIS

Proposition 4.5. Everything in the above definition is well-defined, i.e. independent of the choice of normal coordinates in U .

Proof. Suppose that we have two sets of normal coordinates (t, s) = (t, s1, . . . , sN-1)

and (t , s ) = (t , (s )1, . . . , (s )N-1) of the same orientation in U. By the chain rule,

we have that

 t  N-1 (s )j 

=

+

t t t

t (s )j ,

j=1

 t  N-1 (s )j 

si = si t +

si (s )j ,

j=1

where i = 1, . . . , N - 1. Since these are both sets of normal coordinates, we must have t = t = X. This implies that

t

(s )j

= 1 and

= 0 for all j = 1, . . . , N - 1.

t

t

In particular, the s coordinates are independent of t and s = (s) for some diffeomorphism  between open sets in RN-1.
By linearity and skew-symmetry of , we have that





(t, s) = 

, t

s1

,

.

.

.

,

 sN -1

=

N -1

(s )j1

(s )jN-1







s1 · · · sN-1  t , (s )j1 , . . . , (s )jN-1 =

j1 ,...,jN -1 =1

(s )(1) s1

·

·

·

(s )(N-1)  sN -1

(-1) 

(t

,

s

),

SN -1

where the last sum is over all permutations  in (N - 1) elements and (-1) is the

sign of . It follows that

(t, s) =  (t , s ),
det D(s)

where D is the Jacobian matrix of s = (s). Since  is an orientation-preserving diffeomorphism, this matrix is non-singular and the determinant is positive.
It is straightforward to show that neither the convergence of the integral in (1) of the definition nor the formula of p in (2) are affected if we switch between normal coordinates. Indeed, we have that

t

t



(

,

s

)-

1 p-1

d

=

(, s)

-

1 p-1

d

d =

Is

Is det D(s)

d

t
1
(det D(s)) p-1 (, s)d,

Is
so

t

t

(, s)d <  



(

,

s

)-

1 p-1

d

< ,

Is

Is

and it is clear that p = p.

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

9

Since every directed space (M, X) admits an open cover of saturated normal

coordinate charts, and since the above notions are independent of the choice of

such a chart, we can unambiguously extend these notions over the whole manifold.

This way we may define the global function p : M  R given locally by

t

1
p = (t, s) p-1

(

,

s)-

1 p-1

d

.

Is

At this point, it is clear that (M, X, ) is p-traceable if and only if the function p is defined everywhere in M .

As a final remark, we would like to point out that in the case where (M, X, )

is simple, p-traceability coincides with traceability and p =  , so this is indeed a meaningful extension of the previous concepts.

5. The general case

We are now ready to state and prove our main result.

Theorem 5.1. Let (M, X, ) be a directed volume space and let p > 1. Then the

inequality

|X|p 
M

p - 1 p ||p

p

M pp ,

  Cc1(M )

is valid whenever the space is p-traceable.

Proof. Let U be a saturated coordinate domain with normal coordinates  = -1 =

(t, s) and corresponding p-normal coordinates  = ( )-1 = (t , s ) constructed as

demonstrated in the previous section. Let   Cc1(M ). As with the simple case, apply the one-dimensional Hardy inequality to    (·, s)  Cc1(Is ) to get

|t (   )(t , s )|pdt 
Is

p - 1 p |   (t , s )|p

p

Is distp(t , Is ) dt ,

which by the properties of the p-normal coordinates becomes

|X   (t , s )|p (t , s )dt 
Is

p - 1 p |   (t , s )|p

p

Is distp(t , Is ) dt .

Integrating both sides over the s -coordinates then yields

|X   (t , s )|p (t , s )dt ds 

S Is

p-1 p

|   (t , s )|p

p

S Is  (t , s )distp(t , Is )  (t , s )dt ds .

To show that this is the same as

|X|p 
U

p - 1 p ||p

p

U pp ,

it remains to be shown that pp =  (t , s )distp(t , Is ). This is straightforward, as

we have

t

dist(t , Is ) =

-

1 p-1

(

,

s)d

Is

from the definition, and by elementary calculations we also have that  (t , s ) =
p
 p-1 (t, s).

The proof is again completed by a similar argument as in Theorem 3.1.

10

M. PASCHALIS

Let us make a few remarks about the result. The first is its generality. The only condition that we have imposed for the inequality to hold true is p-traceability of (M, X, ). The number of cases this applies to is vast, including many important cases that are already of interest. We will provide specific examples in the remainder of our work. For the time being, let us note that the only thing we need - in principle - in order to check whether the condition is satisfied is to find a set of normal coordinates (t, s), compute the local volume density (t, s) in these coordinates and then check if the integral

t

-

1 p-1

(

,

s)d

Is

converges. In a large number of cases, including many of the cases that are of

immediate interest, this poses no real hardship.

What we gain from this process, however, is often highly non-trivial results.

If the space in question indeed turns out to be p-traceable, the result provides

an explicit, optimal Hardy potential in terms of the induced temporal/volumetric

distance

t

1
 p-1 (t, s)

-

1 p-1

(

,

s)d

.

Is

Example 5.2. As an elementary application to showcase how the method works in practice, we provide an alternative proof of the standard Euclidean Hardy inequality in RN featuring the distance from a single point. Here, choose M = RN \ {0}, X = /r and  = det (the Euclidean volume form).
Finding normal coordinates for this configuration is trivial: since we must have

 =,
t r simply choose t = r. For the rest of the coordinates there is a lot of freedom of choice, but we can simply choose s = , where  are the angles in the spherical coordinate system (therefore the spherical coordinates as a whole forms a set of normal coordinates in our case).
The expression of the Euclidean volume form in spherical coordinates is of the form  = rN-1f ()dr  d for some f () that involves powers of sines of the angles, therefore in our chosen normal coordinates we have the same representation

 = tN-1f (s)dt  ds,

so it is clear that the local volume density is (t, s) = tN-1f (s). Now let 1 < p = N . The temporal/volumetric distance is

t

t

1
p =  p-1 (t, s)

-

1 p-1

(

,

s)d

=

N -1
t p-1



-

N -1 p-1

d.

Is

{0,}

To compute this, we must consider the two different cases p < N and p > N , but

in either case the result is

p-1

p

=

|p

-

r. N|

By Theorem 5.1, it follows that the inequality

 p

p-N p

||p

dx 

dx

RN r

p

RN rp

holds for all   Cc1(RN \ {0}), as expected.

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

11

However, notice the unorthodox manner in which we obtain the best constant. In our method, this constant is not merely the result of algebraic operations, but has a geometric significance as well: it is a direct consequence of the p-dependence of the distance p.

Example 5.3. In the same manner as in the previous example, by choosing X = r- /p/r we can prove the weighted inequality

1  p

p-N +

dx 

RN r r

p

p

||p

RN rp+ dx,

  Cc1(RN \ {0})

for = N - p. The calculations are a bit more involved than before but still

elementary.

Example 5.4. As a final example, we turn our attention to the hyperbolic space

HN , where a peculiar phenomenon occurs: the Hardy inequality becomes a Poincar´e

inequality. We employ the Poincar´e half space model, where Hn = {x  RN :

xN

> 0} with gHN

=

1 x2N

gRN

.

The Riemannian volume form in this case reads

HN

=

x-NN

det.

Let

X

=

xN

 xN

.

It

is

clear

that

|X |

=

1.

To

find

a

set

of

normal

coordinates for (HN , X) we must find a t such that





t = xN xN ,

so we choose t = log xN and s = (x1, . . . , xN-1). It follows that  = e-(N-1)tdsdt. Finally, we calculate

p

=

e-

N -1 p-1

t

t

e

N -1 p-1



d

=

p-1 ,

-

N -1

from which we obtain the inequality

|HN |pHN 
HN

 p HN xN xN HN 

N -1 p

p

||pHN .
HN

This is the classic Poincar´e inequality for the hyperbolic space, and it is already

known to be a consequence of the Hardy inequality (it can actually be obtained via

the weighted inequality of the previous example, with minor modifications).

At this point it becomes clear that, when referring to the temporal/volumetric distance, the word "distance" should not be taken too literally, since it does not always conform to the way we know a distance should behave (e.g. in the last example it was a constant).

6. Application I: The exterior of a ball

We will now use the method to obtain some new results. We would like to point out that there are new things that can be said even in the Euclidean case. In this section we focus on the case where M = E is the exterior of a Euclidean ball of dimension N .

Theorem 6.1 (Hardy Inequality for the exterior of a ball). Let E = {x  RN :

|x| > R} be the exterior of the N -dimensional Euclidean ball of radius R. Then the

inequalities

 p dx 
E r

p-N p

p

||p

E

r (r N-1 p-1

p

p-N p-1

p-N dx, - R p-1 )p

p > N,

12

M. PASCHALIS

 p dx 
E r

 N

N -1 N

||N

dx 

E r

N

E rN log(r/R)N dx,

N -p p

||p

p

E

r min{r , R N-1 p-1

p

p-N p-1

p-N p-1

p-N dx, - r p-1 }p

1<p<N

hold for all   Cc1(E).

Proof. Similar to the case of RN with the distance from a single point, the spherical coordinate system is a set of normal coordinates. The only difference now is that t = r ranges from R to . Thus, we have

N -1
p = t p-1

t

-

N -1 p-1

d

,

{R,}

so in each individual case


 

r (r - R ), p-1

N -1 p-1

p-N

p-N p-1

p-N p-1

p = r log(r/R),

 

r p-1

N -1 p-1

N -p

p-N

p-N

min{r p-1 , R p-1

p-N
- r p-1 },

p>N p = N. p<N

and the result follows.

This is a non-trivial result, although its derivation has been trivialised by the

use of our method. Let us make a few remarks on it. Note that in the cases where

p = N , for small r - R we have p  r - R, whereas for large r - R we have

p 

p-1 |p-N

|

(r

-

R).

This fits our intuition:

when close to the ball the inequality

must behave like the one involving the distance from a hyperplane, while for very

large distances it must resemble the one involving the distance from a point. In

essence, the induced distance p forms a continuous transition between these two

limit cases.

It is also of practical importance to compare p with the Euclidean distance from the boundary d = r - R. This will yield inequalities for the classic Hardy potential

V = d-p. To our knowledge, the only known result in this direction is given by

Avkhadiev and Makarov in [3]. The result states that for every compact U  RN ,

the best constant in the Hardy inequality

is c =

||pdx  c
RN \U

||p RN \U dp dx,

  Cc1(RN \ U ),

p-N p

p in the case where p > N , which implies the optimal inequality

||p 
E

p - N p ||p

p

E dp ,

  Cc1(E)

in the case of the exterior of a ball. In that case our method gives

p - 1 N-1 p-N

p-N

p =

r (r p-1

p-1

p-N

- R p-1 ).

To specify the best constant  such that

1 ,
p d

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

13

we make a few observations. As we already noted, we have p(r)  d(r) for r close

to R and p(r) 

p-1 p-N

d(r)

for

large

r.

More generally, the derivative of p(r) is

given by

p-N

p - 1 N - 1 R p-1

p(r) = p - N - p - 1 r

,

which is a strictly increasing function of r. It follows that

p-1

p

-

N

d(r)

=

sup (p (y)d(r)
y>R

>

p(r)

so

1 p-N 1 >
p p - 1 d

and we retrieve the same best constant c =

p-N p

p.

It follows that our method

improves the result of [3] in the case where U is a ball, in the sense that it provides

a better distance for the same constant.

For the case p < N , we have the following comparison.

Corollary 6.2. Let E = {x  RN : |x| > R}. Then the inequality

||pdx 
E

N -p p

p

1

-

2-

p-1 N -p

p

||p E dp dx,

  Cc1(E)

holds for all p < N .

Proof. In this case, it is

p - 1 N-1

p-N

p-N

p-N

p =

r p-1 N -p

min{r p-1 , R p-1

- r p-1 }.

p-1
We put a = 2 N-p R, which is the real number such that

p-N

p-N

p-N

a p-1 = R p-1 - a p-1 ,

i.e. the point in which the branch transition occurs. It follows that

p =

p-1 N -p

r,

r (R - r ), p-1

N -1 p-1

N -p

p-N p-1

p-N p-1

ra .
r<a

An elementary calculation reveals that the derivative of p(r) for r < a is

N -1

N-p p - 1

p(r) =

N

(r/R) p-1 -p

-

, N -p

which is strictly increasing, so in particular p(r) is convex for r < a. By virtue of Jensen's inequality it follows that

p(r)  A(r - R), R < r < a,

where

A = p(a) - p(R) = p - 1

a

p-1 =

1

-

2-

p-1 N -p

-1.

a-R

N -pa-R N -p

As for the region r  a, we certainly have that p(r)  A(r - R), since both

functions

are

affine,

share

the

same

value

at

a

and

p-1 N -p

<

A.

So in any case we have

1

N

-

p

1

-

2-

p-1 N -p



p

p

d

14

M. PASCHALIS

and the result follows.

For the sake of clarity, we give some plots of the function p for specific values

of

N

and

p,

plotted

against

the

function

p-1 p-N

(r

-

R)

that

we

use

when

making

the

Euclidean comparison. Other choices of N and p give qualitatively similar results.

What really matters is whether p < N or p > N .

Figure 1. Left: R = 1, N = 3, p = 2. Right: R = 1, N = 3, p = 4

7. Application II: Spherical symmetry

Moving beyond the classic Euclidean setting, the most important class of examples is arguably the class of spherically symmetric manifolds. We say that a Riemannian manifold (M, g) is (locally) spherically symmetric around a central point o  M if the metric can be expressed as
g = d  d + 2()gSN-1
in a punctured neighbourhood of o, where  = dist(·, o) is the Riemannian distance from o,  is a positive function depending only on  and gSN-1 is the round metric of the unit sphere of codimension 1. We are interested in the case where we have global spherical symmetry.
If M is non-compact, the above polar representation extends to the whole punctured space M = M \ {o}. If M is compact, we must exclude an additional "antipodal" point o  M (the most characteristic example is the sphere, where one must exclude both poles).
In either case,  : M  R has range of the form (0, R) (we may have R = +), and we may apply Theorem 5.1 with X = / and  = g = N-1()d  SN-1 . In the following, we also take into account the case where we choose to exclude not only the "pole(s)" o (and o ), but perhaps a larger object (for example, a geodesic ball around o or o ).

Theorem 7.1. Suppose that (M , g) is a Riemannian manifold whose metric can be expressed as
g = d  d + 2()gSN-1
for some  : M  (a, b) and some smooth  : (a, b)  (0, ). If for each value of   (a, b), either one (or both) of the integrals



-

N -1 p-1

(

)d

,

a

b



-

N -1 p-1

(

)d



GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

15

converge, the inequality

||pg 
M

p-1 p

||p

p

p g,
Mp

  Cc1(M )

is valid with

N -1
p =  p-1 () min



b

-

N -1 p-1

(

)d

,



-

N -1 p-1

(

)d

.

a



Proof. This is just a restatement of Theorem 5.1 for the special case (M, X, ) = (M , , g).

M can be thought of as a suitable open submanifold of a spherically symmet-

ric manifold M . A key feature of our technique is that it effectively manages to

take into account the volumetric/temporal distance from both the "inner" and the

"outer" edge of the manifold. By "inner" edge we mean the edge that is closer to

the central point o. The volumetric/temporal distance from the inner edge is given

by



in p

=

N -1
 p-1 ()

-

N -1 p-1

(

)d,

a

while the corresponding distance from the outer edge is

b

out p

=

N -1
 p-1 ()



-

N -1 p-1

(

)d

.



While it is true that

p = min( pin,

out p

),

and

consequently

1 11


p

in ,
p

out ,
p

it is sometimes convenient to consider Hardy potentials that take into account only the inner or outer edge. One may choose to do this in order to extend the class of admissible functions (in the case of a compact manifold where we have an antipodal point o , one may still prefer to take into account functions that do not vanish at o ).
To this end, this is a good point to demonstrate the flexibility of our method: all that Theorem 5.1 does is to essentially "lift" the one-dimensional Hardy inequality ( ) in higher dimensions. As a matter of fact, any one-dimensional functional inequality could be used in its place. Without straying from our subject of Hardy inequalities, we simply point out that one gets nearly identical results if we choose instead to lift the inequality

()

b
| (x)|pdx 
a

p - 1 p b |(x)|p

p

a (x - a)p dx,

  Cc1((a, b]),

which takes into account only the first endpoint and admissible functions need not vanish close to b. This gets us exactly what we need.

Theorem 7.2. Let (M, g) be a compact, spherically symmetric manifold with empty boundary, with central point o  M of injectivity radius inj(o) = R,  = dist(·, o) and let
g = d  d + 2()gSN-1

16

M. PASCHALIS

for some smooth  : (0, R)  (0, ). Then the inequality

||pg 
M

p-1 p

||p

p

M(

in p

)p

g

,

  Cc1(M \ {o})

is valid whenever



-

N -1 p-1

()d

<

.

0

Proof. It is well known that in this case we have -1(R) = {o } where o is a single point antipodal to o. It follows that M \ {o, o } can be covered with polar coordinates in which the metric is expressed exactly as in the statement of the theorem. The rest of the proof is a repetition of the steps in the proof of Theorem 5.1, the only difference being applying ( ) instead of ( ).

Of special interest are the cases of the N -Sphere SN , where () = sin(),   (0, ), and the Hyperbolic Space HN , where () = sinh(),   (0, ).

Remark. It recently came to our attention that this is not the first time that results such as these make their appearance. Other authors have employed analytic methods to obtain such results in a number of cases. For example, in [6], the authors present some results for spheres and spherically symmetric domains that are very similar to our own. In [5], the authors use a general result from [8] to derive an Lp Hardy potential for the hyperbolic space that also has the same form as the one that occurs from our method. More generally, in the spherically symmertic case, the Hardy potentials that we are looking at are all of the form ||p/p for some p-harmonic   W 1,p(M ), and can therefore be considered a special case of the main result in [8].
Regardless, our method is inherently geometric instead of analytic and applies more generally, for example X and  need not be related by a Riemannian metric. Moreover, the potentials provided by our method are explicit in any case, symmetric or not.

8. Application III: The exterior of a black hole

As a final application, we would like to discuss the case of the Schwarzschild metric, which describes static black holes in the context of General Relativity. The full Schwarzschild metric in (3+1)-dimensional spacetime reads

1 - 1-
r

dt  dt +

1 1-
r

-1
dr  dr + r2gS2

and is actually a pseudo-Riemannian metric. To get a Riemannian metric, we

will simply restrict our attention on "temporal slices" of constant time, where the

restricted metric reads

1 1-
r

-1
dr  dr + r2gS2 .

Theorem 8.1 (Hardy Inequality for the Schwarzschild Black Hole). Let B = {x  R3 : |x| > 1 } be equipped with the metric

gB

=

r

r -

dr 1



dr

+

r2gS2

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

17

as above, let B and B stand for the Riemannian gradient and volume form, respectively, and let



 2r2 

r-1 r

=

 2r2 1 - 

r-1 r

1 < r < (4/3)
. r  (4/3)

Then the inequality
|B|2B 
B
is valid for all   Cc1(B).

r - 1  2

1

B r r B  4

||2 B 2 B

Proof. Let X =

r-1 r

 r

.

In

polar

coordinates

we

have

B =

r r2 sin()dr  d  d. r-1

We are looking for a new coordinate t to replace r such that /t = X. Let

f : (1, )  (0, ) be the function given by the formula





f (x) = x x - 1 + log( x + x - 1).

It is easy to verify that t = f (r) satisfies the imposed condition, therefore (t, , ) is a set of normal coordinates for (B, X). As f is a bijection, let g denote its inverse. Substituting r = g(t) into the formula for B, we get

B = g(t)2 sin()dt  d  d,

therefore (t, , ) = g(t)2 sin(). The temporal/volumetric distance in this case is

t

2 = g(t)2

g(w)-2dw = r2 min

{0,}

t



g(w)-2dw, g(w)-2dw .

0

t

Substituting w = f (), it is elementary to show that

2 = r2

r

d

{1,} 3/2( - 1)1/2 = 

and the proof is complete.

A more complete treatment of this matter will be given elsewhere.

9. Higher-order inequalities

Likewise, one can recursively obtain inequalities for higher order differential op-

erators. For example, consider the second-order operator Y X obtained by the com-

position of two directional derivatives (vector fields) X, Y  (T M ). If (M, Y, )

is p-traceable, we obtain

|Y X|p 
M

p - 1 p |X|p

Xp

p

M (pY )p  = M pY  ,

where pY is the temporal/volumetric distance of (M, Y, ). In the same manner, if (M, X/pY , ) is p-traceable, we may repeat the process and obtain

|Y X|p 
M

p - 1 2p

||p

p

M (pY /pX )p ,

18

M. PASCHALIS

where

Y
p

/pX

is

the

temporal/volumetric

distance

for

(M, X/pY , ).

By

induction,

this process can produce inequalities for operators of the form X1 · · · Xk for any

k  N, provided that p-traceability holds for each step.

We give some examples of higher-order inequalities obtained in this way.

Example 9.1. Recursive application of the weighted inequality of Example 5.3 yields the k-th order Rellich inequality

k p

k lp - N p

||p

RN rk

dx 
l=1

p

RN rkp dx,

  Cc1(RN \ {0}).

Note that, in essence, if one has weighted inequalities for the vector fields of interest, computing the distance at each step becomes unnecessary.
Likewise, for the one-dimensional case we have

k
|Dk|pdx 

R+

l=1

lp - 1 p ||p

p

R+ xkp dx,

  Cc1(R+),

which can be further integrated to give the same inequality for the half-space.

Example 9.2. Consider the second order differential operator

1  H= r .
r r r Applying the weighted inequality of Example 5.3 twice yields the inequality

|H|pdx 
RN

2p - N 2p p

||p RN r2p dx,

  Cc1(RN \ {0}).

As a final interesting application, we will use the above to obtain Rellich inequalities involving the wave operator in the 2-dimensional half-space, which, in contrast to most operators that are being discussed in literature, is not an elliptic operator. We are not aware of other results of this type so far. We prove the following.

Theorem 9.3 (Higher-order Rellich Inequality for the Wave Operator). Let = x2 - y2 denote the 2-dimensional wave operator, and let u  Cc(R2+). Then the inequality

2k

| ku|pdxdy 

R2+

l=1

lp - 1 p

|u|p

p

R2+ y2kp dxdy

holds for all k  N. The constant is sharp.

This is an easy corollary of the following lemma.

Lemma 9.4. Let u  Cc(R2+). Then the inequality

R2+

|(x

± y y

)u|p

dxdy



+p-1 p

|u|p

p

R2+ y+p dxdy

holds for all  > 1 - p.

Proof. Consider the case of X := (x - y). The coordinates

1

1

t = (x + y), s = (-x + y)

2

2

GEOMETRIC HARDY INEQUALITIES VIA INTEGRATION ON FLOWS

19

are a set of normal coordinates for (R2+, X) (it can be easily verified that X = /t). Moreover, we have that x = t - s and y = t + s, thus

dx = dt - ds, dy = dt + ds.

It follows that dx  dy = 2dt  ds. It follows that

1

2

 = y dx  dy = (t + s) dt  ds,

and the corresponding temporal/volumetric distance is

t

p

=

(t

+

s)-

 p-1


( + s) p-1 d,

Is

where Is = (-s, ). By elementary calculations, this is equal to

p-1

p-1

p

=



+p

(t -1

+ s)

=



+

y p-1

and the result follows. The case of (x + y) is entirely analogous.

The inequality in the theorem follows from the fact that = (x + y)(x - y) and inductive application of the lemma. Sharpness is proved by a standard argument, substituting the sequence

u

(x, y)

=

y 2kp-1 p

+



(x, y),

 0,

where  is a suitable cutoff function that is equal to  = 1 in (- , ) × ( , 1/ ) and supp( )  (-2 , 2 ) × ( /2, 2/ ).

Appendix A. Auxiliary Material
We give some auxiliary results from the theory of differentiable manifolds that are used throughout our work. All of them can be found in [10].
Let F : M  N be a smooth map between manifolds. As usual, the differential of F is defined to be the map F : T M  T N such that FX[g] = X[gF ] for all g  C(N ). Likewise, we define the pull-back of F as the map F  : (T N )  (T M ) by F (X1, . . . , Xk) = (FX1, . . . , FXk) for all vectors X1, . . . , Xk  TzM for all z  M .

Lemma A.1 (Diffeomorphic invariance of the integral). Let F : N  M be an orientation-preserving diffeomorphism and   top(T M ). Then

 = F .

M

N

Lemma A.2 (Integration over parametrisations). Let M be an oriented manifold of dimension N and let   N (T M ) be a compactly supported top-form on M . Suppose D1, . . . , Dk are open domains of integration in RN , and for i = 1, . . . , k we are given smooth maps i : D¯i  M satisfying
(1) i restricts to an orientation-preserving diffeomorphism from D¯i onto an open set Wi  M .
(2) Wi  Wj =  for i = j. (3) supp()  W¯ 1  · · ·  W¯ k.

20

M. PASCHALIS

Then

k

=

i.

M

i=1 Di

Acknowledgement. Special thanks are owed to my PhD supervisor, Professor G. Barbatis, for the time he spent reviewing the article and offering useful suggestions. This research was supported by the Hellenic Foundation for Research and Innovation (HFRI) under the HFRI PhD Fellowship grant (Fellowship Number 1250).

References
1. Balinsky, Alexander A, Evans, W Desmond, Lewis, Roger T, The Analysis and Geometry of Hardy's Inequality (2015), Springer International Publishing.
2. Barbatis, Gerassimos & Filippas, Stathis & Tertikas, Achilles. (2003). Tertikas A unified approach to improved L p Hardy inequalities with best constants. Transactions of the American Mathematical Society.
3. Avkhadiev, F.G., Makarov, R.V. Hardy Type Inequalities on Domains with Convex Complement and Uncertainty Principle of Heisenberg. Lobachevskii J Math 40, 1250­1259 (2019).
4. Sun, X., Pan, F. Hardy type inequalities on the sphere. J Inequal Appl 2017, 148 (2017). 5. Elvise Berchio, Lorenzo D'Ambrosio, Debdip Ganguly, Gabriele Grillo, Improved Lp-Poincar´e
inequalities on the hyperbolic space, Nonlinear Analysis, Volume 157, 2017, Pages 146-166. 6. F. Chiacchio and T. Ricciardi, Some sharp Hardy inequalities on spherically symmetric do-
mains. Pac. J. Math. 242 No. 1 (2009), 173-187. 7. Alexandru Krist´aly, Sharp uncertainty principles on Riemannian manifolds: the influence of
curvature, Journal de Math´ematiques Pures et Appliqu´ees, Volume 119, 2018, Pages 326-346. 8. Lorenzo D'Ambrosio, Serena Dipierro, Hardy inequalities on Riemannian manifolds and ap-
plications, Annales de l'Institut Henri Poincare (C) Non Linear Analysis, Volume 31, Issue 3, 2014, Pages 449-475. 9. Kombe, Ismail, and Murad O¨ zaydin. "Improved Hardy and Rellich inequalities on Riemannian manifolds." Transactions of the American Mathematical Society, vol. 361, no. 12, 2009, pp. 6191­6203. JSTOR, www.jstor.org/stable/40590795. Accessed 19 Apr. 2021. 10. Lee, John M., Introduction to Smooth Manifolds, Second Edition, Springer Science+Business Media New York, 2003.
Department of Mathematics, University of Athens Email address: mpaschal@math.uoa.gr

