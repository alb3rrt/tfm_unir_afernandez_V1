Astronomy & Astrophysics manuscript no. hara_delisle_unger_dumusque_2021 June 3, 2021

©ESO 2021

arXiv:2106.01365v1 [astro-ph.EP] 2 Jun 2021

Testing whether a signal is strictly periodic
Application to disentangling planets and stellar activity in radial velocities
Nathan C. Hara1 Jean-Baptiste Delisle1, Nicolas Unger1, Xavier Dumusque1

Observatoire Astronomique de l'Université de Genève, 51 Chemin de Pegasi, 1290 Versoix, Switzerland e-mail: nathan.hara@unige.ch
June 3, 2021

ABSTRACT

Searches for periodicity in time series are often done with models of periodic signals, whose statistical significance is assessed via false alarm probabilities or Bayes factors. However, a statistically significant periodic model might not originate from a strictly periodic source. In astronomy in particular, one expects transient signals that show periodicity for a certain amount of time before vanishing. This situation is encountered for instance in the search for planets in radial velocity data. While planetary signals are expected to have a stable phase, amplitude and frequency -- except when strong planet-planet interactions are present -- signals induced by stellar activity will typically not exhibit the same stability. In the present article, we explore the use of periodic functions multiplied by time windows to diagnose whether an apparently periodic signal is truly so. We suggest diagnostics to check whether a signal is consistently present in the time series, and has a stable phase, amplitude and period. The tests are expressed both in a periodogram and Bayesian framework. Our methods are applied to the Solar HARPS-N data as well as HD 215152, HD 69830 and HD 13808. We find that (i) the HARPS-N Solar data exhibits signals at the Solar rotation period and its first harmonic ( 13.4 days). The frequency and phase of the 13.4 days signal appear constant within the estimation uncertainties, but its amplitude presents significant variations which can be mapped to activity levels. (ii) as previously reported, we find four, three and two planets orbiting HD 215152, HD 69830 and HD 13808.

1. Introduction
In many astronomical fields, one searches for periodicity in a time series of measurements. Due to observational constraints, the samples often are unevenly spaced, possibly with large gaps in the sampling. The search for periodicity is then typically done with periodograms, which can be defined in several ways. The different definitions can be viewed as a metric (most often the 2 difference) comparing two models: a base model, and a model that includes this base model plus a periodic signal at a given frequency, for a grid of frequencies. Typically, periodic components are sinusoids, and the base model includes white, Gaussian noise (Lomb 1976; Scargle 1982). It can also include a constant (Ferraz-Mello 1981; Cumming et al. 1999; Reegen 2007; Zechmeister & Kürster 2009), general linear models Baluev (2008), non-sinusoidal functions Baluev (2013b, 2015), several periodic components Baluev (2013,a) or correlated noise (Delisle et al. 2020a). Once the periodogram is computed, detections are claimed if the false alarm probability (FAP) of the highest peak is below a certain threshold.
The search for periodic signals can also be performed in a Bayesian framework. Periodograms can be defined as comparisons of marginal likelihoods of the two competing models, with or without a given frequency (Mortier et al. 2015; Feng et al. 2017). The analysis can also be done directly from the posterior distributions of orbital elements. In that case, to determine how many periodic components can be confidently detected, one computes the ratio of Bayesian evidences ­ or Bayes factors (Kass & Raftery 1995) ­ of models with n and n + 1 components. If the Bayes factor is above a certain threshold (usually 150), the addition of a periodic component is validated (e. g.
CHEOPS fellow

Gregory 2007b,a; Tuomi 2012; Faria et al. 2016). Alternatively, one can use a detection criterion based on Bayesian model averaging (Hara et al. 2021).
A low FAP or high Bayes factor give a measure of the confidence in a detection of a periodic component within a certain model of the data. If the model is inappropriate, there might be significant signals that do not correspond to strictly periodic signals. Certain noises are particularly likely to yield significant peaks: the ones that present a periodicity that is localised in time, similarly to wavelets. This situation is encountered in particular in the search for planets in radial velocity (RV) data. This type of data consists of a time series of velocity projected along the line of sight (the radial velocity) of a given star, measured thanks to the Doppler effect. If a planet orbits the star, then one expects periodic variation of the velocity. However, the surface of a star is not uniform: spots and faculae break the flux balance between the approaching and receding limb of the star, furthermore, they inhibit convective blue shift. As a consequence, during their lifetime, stellar features introduce radial velocity signals that might mimic planetary ones, in particular at the stellar rotation period or its harmonics (e.g. Saar & Donahue 1997; Boisse et al. 2011; Meunier et al. 2010; Dumusque et al. 2014), but also possibly at periods apparently unrelated to the stellar rotation (Nava et al. 2020).
One approach to this problem consists in trying to improve the data model and the detection metrics so that a significant detection has a meaning as close as possible to the detection of the signal of interest (here, a planet). In RV data analysis, stellar activity is typically modelled with a Gaussian process. This approach is taken in Haywood et al. (2014); Rajpaul et al. (2015); Jones et al. (2017); Gilbertson et al. (2020) and Hara et al. (2021). The stellar activity models are however imperfect,

Article number, page 1 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021

and another approach consists in being more agnostic to the form

of stellar activity. For instance, Gregory (2016) suggests to com-

pute the Bayesian evidence of a an apodized model, that is a

periodic planetary signal model multiplied by a function of the

form

e-

(t-t0 2

)2

,

where



and

t0

are

free

parameters.

Denoting

by

Tobs the total timespan of observation, a signal is claimed to be

of planetary origin if it is significant, and if the posterior proba-

bility of the event  Tobs is greater than a given threshold. The

rationale is that a planetary signal is a purely periodic signal,

and should therefore be identical from the beginning to the end

of the dataset. In a periodogram setting, Schuster (1898); Mortier

& Collier Cameron (2017) adopt a similar approach. They sug-

gest to compute the periodogram adding one point at a time and

determine whether the significance of a peak at a certain period

grows steadily with the number of points.

One can envision other diagnostics to determine if an appar-

ently periodic signal presents signs of variability. In the present

work, we present tests to assess the time-scale of a signal, and

to determine if its period, phase and amplitude are constant.

We suggest tests based on the periodogram and Bayesian for-

malisms.

The article is organised as follows. In section 2, we define the

diagnostics mentioned above. In section 3, we show examples

of applications to the Solar HARPS-N data (Dumusque et al.

2021), HD 215152 (Delisle et al. 2018), HD 69830 (Lovis et al.

2006) and HD 13808 (Ahrer et al. 2021). We finally present our

conclusions in section 4.

2. Methods
2.1. Signal time-scales
2.1.1. Apodized sinusoids periodograms
Let us consider a time series y = (y(tk))k=1..N. Following the method of Baluev (2008) to define periodograms, we consider two alternative models of the time series y: a linear base model µH of p parameters, and a model µK that includes H plus an apodized sinusoidal component. The base model, as a vector with N components, is defined as

where 1X(x) is a function that is zero everywhere except when
x  X. but other choices are possible. One can envision fur-
ther generalisations. Indeed, the periodic signal need not be si-
nusoidal. It can be for instance a Keplerian one (Baluev 2015).
Also, the base model H can be generalised to non linear models. Considering a model µi, i = H or K with parameters i,
and column vector residuals r = y - µi(i), the 2 is defined as rT V-1 r where the suffix T denotes the matrix transpose. We denote by 2H the 2 of the residuals after fitting the parameters H of model (1) and, for a set of fixed , t0, , by 2K (, t0, ) the 2 of the residuals after fitting the parameters H , A and B of the
model (2), on which the model depends linearly. We now define
a periodogram type counterpart to Gregory (2016).

z(, t0, ) = 2H - 2K (, t0, ),

(6)

which represents the improvement of the fit by adding the µ component compared to the base model H. In the following sections, we will use the following representation. For a given  we represent the quantity

z (, ) = max z(, t0, ).

(7)

t0

The values of z (, ) are overplotted for different values of . In Fig. 1), we represent the values of z for four values of  for the
Solar HARPS-N data (see Section 3.1 for more details). We call
such a figure an ASP for apodized sinusoids periodogram.
Our definition of Eq. (3) and (4) is similar to a continuous
wavelet transform (Grossmann & Morlet 1984) applied to irreg-
ularly sampled time-series (Foster 1996). Our choice of Eq. (4)
is inspired by the Gabor wavelet, which minimizes the product of
time and Fourier domain variance (Daugman 1998). However, in the wavelet transform context, the time-scale  and frequency  are dependent on each other. Indeed, a family of wavelet (a,b)a,b is defined as the translation and dilation of a mother wavelet , a,b(x) = ((x - b)/a)/ a. In our case, the lifetime  of a quasiperiodic feature is not unequivocally linked to its frequency .
As a consequence, even though having three free parameters instead of two introduces extra computational load, we leave , 
and t0 as independent parameters.

µH (H ) = H H

(1)

where H is a N × p matrix and H is the vector of p parameters to be fitted. For instance, the matrix H can be simply taken as a
column vector with all N entries equal to one, thus modelling an offset. If one assumes that sinusoidal signal of frequency  is in the data by default, H can be defined as a N × 3 matrix with line i equal to [1, cos ti, sin ti]. The alternative model is defined as

µK (H , ) = H H + µ(t, )

(2)

where µ(t, ) is an apodized periodic function. We compare the hypotheses H: y = µH (H ) + for some H and K: y = µK (K ) + for some K , where is a Gaussian noise model
(or random variable) of covariance matrix V. In the present work, µ is specified to

2.1.2. Grid
Regular periodograms usually are computed on a grid of equispaced frequencies k = k. The choice of  depends on the typical width of the periodogram peaks, which is approximately equal to 2/Tobs, where Tobs is the total timespan of the observations. Then  is chosen as 2/Tobs  1/N, where N is called the oversampling factor.
For the ASPs, we need to construct a grid in three dimensions: , t0 and T . The naive approach, consisting in having a fixed grid for each parameter and trying all the possible combinations, is unnecessarily computationally expensive. Indeed, for a given time-scale T such that T < Tobs, the typical width of the peaks in  is  2/T > 2/Tobs. To set the grid, the approach adopted here is to define the following quantities

µ(t, , , t0, A, B) = w(, t0)(A cos t + B sin t).

(3)

where w(, t0) is the apodization function. We will here use Gaussian and box-shaped functions, that is

wG (,

t0)

:=

e-

(t-t0 )2 22

(4)

wB(,

t0)

:=

1[t0-

 2

,t0

+

 2

](,

t0)

(5)

­ A maximum frequency max ­ Two oversampling factors, N and Nt. ­ A fixed number  < 1 and a number of time-scales N such
that the grid of  is defined as k = k-1Tobs, k = 1..N.
We define two reference grids for  and t0 as, ref = (k)k=1..n and t0ref = (t0k)k=1..n, where k = k, with  = 2/Tmax/N and t0k = kt0 with t0 = min/Nt.

Article number, page 2 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

Table 1: Symbols.

Symbol t
y

Data
Definition Epochs of measurements, the N data points are taken at times t = (ti)i=1..N Colummn vector of the data, y = (y(ti))i=1..N

Parameter V µH
µK
µ
w  t0

Model parameters
Definition
Assumed covariance matrix of the noise.
Model of the null hypothesis, column vector with N components, µH = H H where H is a N × p matrix and H are free parameters. Signal models. As defined in Eq. (2), µK = H H + µ(t, , , t0, A, B). The parameters H, A, B are fitted onto the data for a grid of parameters , , t0. Function of time t and parameters , , t0, A, B defined in Eq. (3) as µ(t, , , t0, A, B) = w(, t0)(A cos t + B sin t). Apodisation window (for instance e-(t-t0 )2 /(22 ) )
Time-scale of the apodisation window
Center of the apodisation window

z(, t ,,  ) with the hypothesis that model K(, t,, , A , B ) is correct, where the fitted cosine and sine amplitude A , B are obtained by fitting model K to the data. Dz can easily be expressed as a generalised 2 distribution, its mean and variance is given by an analytical expression, given in Appendix A.1, eq. (A.9) and eq. (A.10). This method does not take into account that  is chosen as a maximum of the periodogram and could be refined in future work.
Secondly, one can define a false alarm probability associated to (6), like a regular periodogram. In the remainder of the article, we will not use the false alarm probability (FAP) for ASPs, however we will use a FAP for regular periodograms (Baluev 2008; Delisle et al. 2020a). For the sake of conciseness, the method is described in Appendix B.
In general, assuming that the signal is in the form of the model K (eq. (2)) will be an incorrect assumption. In particular, if aliasing cannot be neglected and the data contain several signal sources, not accounting for them might result in an inaccurate uncertainty on the time-scale  of the signal of interest. We suggest to include in the base model all the periodic signals found to be significant (we give an example of this procedure in Section 3). Alternatively, at the price of a higher computational cost, one can search for several signals simultaneously, as shown in the next section.
2.1.4. Bayesian approach

Parameter
N Nt 
N

Grid parameters
Definition Oversampling in frequency Oversampling in time Downscaling of the time-scale Number of time-scales

Default value 8 5 1/3 5

For each k, the waveletogram is computed on a sub-grid of ref and t0ref, denoted by  and t0. These are defined as k = rkesf and t0k = t0ref kst , where s = max/ and st = /min . The rationale behind these numbers is that, for a given , the grid spacing in  is approximately 2//N and the grid spacing in t0 is /Nt. Secondly, since the omega grid is not recomputed for every time-scale , one has to compute only once the cos t and sin t terms. Once this method is specified, one has to choose specific values for N, Nt, max,  and nT . The list of symbols and, when relevant, the default values we choose are reported in
table 1.

2.1.3. Statistics

In Gregory (2016), one computes the Bayesian evidence (or

marginal likelihoods) of models containing k periodic compo-

nents

multiplied

by

an

apodization

factor

e-

(t-t0 )2 22

.

A

planet

de-

tection is claimed if a signal is statistically significant (the ratio

of evidence of the model including to the evidence without it is

greater than a certain threshold), and the posterior distribution of  favours values greater than the total time-span of the observa-

tions.

We here propose an alternative way to estimate the timescale

on which the signal remains coherent, that can be computed

very quickly from the periodogram. Denoting by t, the value
of t0 maximising the value of the periodogram (6) for a given  and , we compute the the distribution of Dz = z(, t,, ) -

In Gregory (2016), a detection is claimed if the posterior probability of the event  > Tobs is greater than a certain threshold. However, such a criterion can be misleading. For instance, there might be datasets such that there are a few isolated measurements with a large time gap to the bulk of the measurements. In that case, most of the samples could correspond to  < Tobs while there is a possibility that the signal is consistent with a fully periodic signal. Additionally to the posterior distribution of , we suggest to consider a quantity f that quantifies the fraction of information captured by a certain window. We compute the posterior distribution of

f

=

w(, t0)T V-1w(, t0) 1T V-11

(8)

conditioned on the frequency of the planet being within ± of a given frequency of interest. In Eq. (8) w = (w(ti))i=1..N is the apodization window (see Eq. (3)), V is the covariance matrix and
1 is a vector of size N. The values of the vector w are between

0 and 1. If f is close to 1, then the apodized signal is close to

a strictly periodic signal. On the contrary, a value of f close to 0 implies that the w has concentrated information in time. Note

that f can be computed for any apodised signal, in particular the

planet model can be circular or Keplerian, and for all the signals

in the data. In Gregory (2016), the number of planets is determined by
checking that the Bayes factor comparing the n + 1 and n planets

model is greater than a certain threshold. The significance of the

planet can also be established with the false inclusion probabil-

ity (FIP) (Hara et al. 2021), defined as follows. Considering a

certain parameter space S (for instance a period and eccentricity

interval), the true inclusion probability (TIP) is the probability to have planet with orbital elements in S marginalised over the

number of planets in the system. The FIP is defined as 1-TIP.

Instead of claiming a detection if the Bayes factor is above a cer-

tain threshold, we use the fact that the FIP of having a signal with period in [ - ,  + ] -- marginalised on all parameters including t0 and  -- is below a certain threshold.

Article number, page 3 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021

2.2. Amplitude and phase consistency

The second diagnostic we present in this work relies on comput-

ing the phase and amplitude of a signal at a given period with a

moving time window. Let us consider, as in section 2.1.1, the lin-

ear models H eq. (1) and K eq. (2). For the function µ, we adopt

the definition of (3) where the window function w is box shaped.

For each value of , t0 and , one has estimates of parameters A and B ((3)). The uncertainties on A and B are obtained from the

diagonal elements of the covariance matrix of the fit. From the

estimates of A and B, we compute the local semi-amplitude K and phase 



K(, t0, ) = A2 + B2

(9)

(, t0, ) = atan2(-B, A),

(10)

as well as the uncertainties on K and  propagated from those on
A and B with simple Monte Carlo simulation. Alternatively, one can estimate the uncertainties on A, B, K and  with their pos-
terior distributions, computed with a Monte-Carlo Markov chain
algorithm, which is more computationally expensive but propa-
gates the uncertainties on the orbital elements more accurately. For a given frequency  and time-scale , the quantities A,B,
 and K and their uncertainties (computed from the least square
fit or posterior distributions) can be used to check the consistency
of phase and amplitude of a signal at a given period. Assuming that the signal contains a pure sine at , the values of A and B or K and  as a function of t0 should be consistent with the hypothesis that A and B or K and  are constant.
Besides a visual inspection of A and B or K and  as a func-
tion of t0, the hypothesis that the signal has a constant phase or amplitude can be checked with statistical tests. In particular, one can isolate values of A and B estimated in different windows. Let us denote by (Ai)i=1..M and (Bi)i=1..M estimates of A and B in disjoint windows. If one neglects correlations that might hap-
pen between those estimates due to correlated noise, under the
hypothesis that phase and amplitude are constant, then the statis-
tics

2A

=

M i=1

(Ai - µA)2 2Ai

(11)

2B

=

M i=1

(Bi - µB)2 2Bi

(12)

where

µX =

Xi 2i

1 2i

(13)

with X = A or X = B, should follow a 2 distribution with M - 1 degrees of freedom. We can measure the quantiles of 2A and 2B: if they are below a certain threshold, then the hypothesis that they are constant through time can be rejected. A 2 distribution
with M - 1 degrees of freedom has mean M - 1 and standard deviation 2(M - 1). For a quick diagnostic, we will use the
quantity

N 2i

=

2i - (M - 1) 2(M - 1)

,

i = A, B

(14)

which is the difference of the 2i and its expected value divided by the standard deviation.
In the test suggested in this section, the time window w in eq. (3) is assumed to be a box-shaped one. One could envision a

more general one. However, for a consistent analysis, since the noise is also multiplied by the window, the covariance matrix of the noise would have to be modified according to the chosen window. If this one is non-zero everywhere, then this comes down to doing the analysis of the data without any window, unless some numerical errors lead the covariance to be non invertible. In that case, using a window comes down to a rectangular window. As a consequence, we here only consider box-shaped time windows (see eq. (5)).
We stress that to evaluate the phase and amplitude consistency of a signal, one must have an accurate estimate of the period of the signal to analyse. If this one is poorly estimated, then the phase will spuriously appear as a linear phase drift. As a consequence, we advise to select the value of  to be studied in depth from the regular periodogram containing all the data.
As mentioned in Section 2.1.3, in general, assuming that the signal is in the form of the model K (eq. (2)) will be an incorrect assumption, and aliasing can be a problem. For instance, if the signal contains several sources that are strictly periodic, due to aliasing, the phase and amplitude of the signal under consideration might appear to vary significantly even though the signal is periodic. As a consequence, the fact that the quantities defined in eq. (12) deviate from the mean is not always interpretable as testing the hypothesis that the signal at frequency  is constant in phase and amplitude. One of the assumptions in K is the noise model, however this one might not be known and needs to be adjusted to the data. We suggest to include in the base model all the periodic signals found to be significant, this is precised in Section 3.
Besides testing for the consistency of the phase and amplitude of a signal, it might be interesting to study its relative phase and amplitude with another signal. For instance, one might want to see the evolution of the phase difference between the RV and log RHK as a function of time to study the stellar activity. An example of such an analysis is given in Section 3.1.

2.3. Period consistency

Assuming a sinusoidal shape of the signal, the last parameter
of an apparently periodic signal whose consistency in time can
be evaluated is the period. A convenient representation is, for a given time-scale , to represent as a colormap z(, t0, ) as defined in eq. (6). For a given quasi-periodic signal, a local change of the 2 value might be due to a clustering or spacing of the
observation time. A convenient representation to evaluate jointly
period and amplitude consistency is to represent the fitted semiamplitude K := A2 + B2 (see Eq. (3) as a function of  and t0. To give meaningful diagnostics, it might be suitable to mask the
values of K with an uncertainty above a certain threshold.
We suggest another test. We consider a frequency range [l, r] containing the frequency of a candidate periodic signal 0. For a given time-scale  we plot



(t0)

:=

arg

max
[l ,r ]

z(,

t0,

)

(15)

as a function of t0, where wB is defined by eq. (3) and (5). Like in section 2.2, one can test the hypothesis that approx-
imately independent measurements of  stem from the same distribution. One can envision further generalisation where one looks for shape variations of periodic signals. However, in the cases considered here, the signal to noise ratio would not allow to conclude on this aspect. As a consequence, we do not consider it here.

Article number, page 4 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic
(a)
(b)
(c)
(d)
Fig. 1: Each row correspond to Apodised sine periodograms (ASPs) computed iteratively on the Solar data. Left column: ASPs corresponding to equation (7) for different values of . Middle column: zoom on the maximum peak of the ASP. Right: statistical test on the time-scale described in Section 2.1.3. On the x axis, we represent the ratio of  to the total observation time assumed to be true. For each i, i = 1..4 in abscissa, the position of the markers corresponding to  j, j = 1..4 is represented as the value of the periodogram peak for i minus the expectancy of Dz = z(, t,, i) - z(, tj,,  j) and the error bar is the square root of the variance of Dz. Informally, the markers represent what the periodogram values at  j should be if i in abscissa was the true timescale.
Article number, page 5 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021

We note that estimating the local phase, amplitude and fre-

quency of a signal is a problem also encountered in signal demodulation in the context of telecommunications (e. g. Madhow

(a)

2008). Phase consistency tests have been suggested in the con-

6

text of discrete events, more specifically  ray pulsars, to detect

4

phase shifts relative to an expected position (de Jager 1994).

2

RV data and max. likelihood model
Model Data

RV (m/s)

3. Applications
3.1. Solar data
3.1.1. Data analysis
In this section, we apply our methods to the HARPS-N Solar data (Dumusque et al. 2021). This dataset contains the radial velocity of the Sun measured with the HARPS-N solar telescope (Dumusque et al. 2015). This dataset spans three years, from BJD 2457222.1788 to 2458315.9982 and contains 34550 measurements with a median interval between two samples of 5 min 38 s and a median nominal error of 0.22 m/s. The data is publicly available in the DACE platform1. We bin the data by half day, which means that data acquired between midnight and noon, and noon and midnight (local time at La Palma observatory) are averaged, weighted by their nominal uncertainties. We consider a Gaussian, uncorrelated noise model, with a 1 m/s jitter added in quadrature to the nominal uncertainties.
We first perform an iterative search of signals using the ASPs defined in Section 2.1.1. We consider four time-scales, denoting by Tobs the total timespan of the observations, we compute Eq. (6) for /Tobs = 10, 1/3, 1/9 and 1/27. The grid in t0 and  is defined as in Section 2.1.2. We compute the ASP and then add to the base model the model corresponding to the maximum peak.
Fig 1 (a), left panel shows the first ASP, which presents a maximum at period (0) = 9000 days for (0) = Tobs/9 and t0(0). We then add to the base model w((0), t0(0)) cos (0)t and w((0), t0(0)) sin (0)t and compute the ASP, obtaining Fig. 1 (b). The same operation is repeated, yielding Fig. 1 (c) and (d). In Fig. 2 (a,b,c,d), we represent the models that correspond to the highest peaks of Fig. 1 (a,b,c,d, respectively).
The middle panel of Fig. 1 presents a zoom on the maximum peak of the successive ASP. Horizontal dashed lines correspond to the values of z at the frequency where the maximum is attained. For instance in (b), the maximum value is attained at period = 13.39 days. The blue, orange, red and green horizontal lines represent the level of the periodogram peaks with /Tobs = 10, 1/3, 1/9 and 1/27 at P(1) =13.39 days. We found empirically that a downsizing factor of 1/3 for  allows a reasonable compromise between resolution and grid size. Finally, the right panel represents the statistical test presented in Section 2.1.3.The four time-scale corresponds to a value of , reported in abscissa. Let us consider Fig. 1 (b). For each time-scale , we assume that the data contains a signal at frequency P(1) and time-scale . The points with error bars correspond to the expected value of the periodogram peak and its standard deviation assuming  is the correct time-scale. For instance in Fig. 1 (b), assuming  = Tobs/3 = 365 days would lead to expect a z value with  = Tobs over four sigmas away than the observed one. It then appears that the 13.39 days signal is consistently detected on the whole dataset. In comparison, signals at 9000 days, 158 days and 26.9 days (Fig. 1 (a), (c) and (d)) seem to be localized in time. The peaks at 26.9 and 13.39 days are compatible with the first and second harmonic of the Solar rotation period. Low fre-
1 Data can be downloaded from https://dace.unige.ch/sun/?

RV (m/s)

0 2 4
(b) 6
4 2 0 2 4
(c) 6
4 2 0 2 4
(d) 6
4 2 0 2 4

57400 57600Time57(8B0J0D) 58000 58200 RV data and max. likelihood model
Model Data
57400 57600Time57(8B0J0D) 58000 58200 RV data and max. likelihood model
Model Data
57400 57600Time57(8B0J0D) 58000 58200 RV data and max. likelihood model
Model Data
57400 57600Time57(8B0J0D) 58000 58200

RV (m/s)

RV (m/s)

Fig. 2: Models corresponding of the maximum of the ASPs of Fig. 1

quency structures are expected to come from correlated patterns stemming either from the star or the instrument.

Article number, page 6 of 17

Period (days) 2 difference

Frequency (cycle/day)

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

(a)

Timescale: =364.29 days

1.0

9.92

0.9

11.03

175

0.8

12.40

150

0.7

14.17

125

0.6

16.53

0.5

19.83

100

0.4

24.77

75

0.3

32.99

50

0.2

49.40

0.1

98.24

25

0.057217 57435t0 (B5J7D65-42,4507087,02005)8090 583088742.99 (c)

Period (days) 2 difference Frequency (cycle/day)

(b)

Timescale: =121.43 days

0.9

10.40

140

0.9

11.55

0.8

12.99

120

0.7

14.84

100

0.6 0.5

17.31 20.77

80

0.4

25.94

60

0.3

34.56

40

0.2

51.73

0.1

102.86

20

0.507217 57435t0 (B57JD65-4 2,4507087,0200)58090 583088742.99

0

(d)

Semi amplitude (m/s)

Semi amplitude (m/s)

Period (days)

Frequency (cycle/day)

(e)

(f)

2.199

4.49

2.199

4.49

1.885

5.24

1.885

5.24

Period (days) Frequency (cycle/day)

1.571

6.28

1.571

6.28

1.257

7.85

1.257

7.85

0.942

10.47

0.942

10.47

0.628

15.71

0.628

15.71

0.314

31.42

0.314

31.42

57400 t507(6B00JD - 257,480000,00508)000 58200

57400 t507(6B00JD - 257,480000,00508)000 58200

Fig. 3: (a) and (b): value of the 2 defined in Eq. (6) for the Solar HARPS-N RV data as a function of t0 for  = 365 (=Tobs/3) days (a)) and  = 121 (=Tobs/9) days (b)). (c) and (d) value of the semi amplitude as a function of t0 for  = 365 (=Tobs/3) days (c) and  = 121 (=Tobs/9) days (b). Grey areas correspond to 1  uncertainties greater than 30 cm/s. (e) and (f) Blue points represent the
position of the mode of the ASP between frequencies represented in grey as a function of t0, as defined in Section 2.3. Computed for  = 365 (=Tobs/3) days (c) and  = 121 (=Tobs/9) days (d).

The 13.39 days signal seems the most coherent of the four signals found. To further estimate if it is purely periodic we apply the methods of Section 2.2 and 2.3. As suggested in Section 2.3, we study the consistency of the signal frequency by representing the values of z(, t0, ) (see Eq. (6)) and the amplitude K(, t0, )

for a given  as a colormap. In Fig. 3 we represent z ((a) and (b)) and K ((c) and (d)) for  = Tobs/3 = 365 days ((a) and (c)) and  = Tobs/9 = 121 days ((b) and (d)). The base model is identical to the one used to compute Fig. 1 (b). It appears that the 13 days
signal is present throughout the dataset. Notice that its apparent

Article number, page 7 of 17

Phase - mean phase (rad)

K (m/s)

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021

(a) Solar data amplitude and phase timescale = 364.29 days

1.0

K

0.9

K indep.

0.8

mean K

phi phi indep.

0.6

mean phi 0.4

0.7

0.2

0.6

0.0

0.5

0.2

0.4

0.4

0.3

0.6

0.2

57400Time5c7e6n00ter (B5JD78-020,4005,0800000) 58200

(c) Solar data AB, timescale = 364.29 days N 2 A: 0.973, B = 2.802

1.0

Mean A, mean B

Mean A, mean B indep.

0.9

(A,B) (A,B) indep.

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.4

0.3

0.2

A0.1 (m0/.0s) 0.1

0.2

0.3

Phase - mean phase (rad) K (m/s)

B (m/s)

(b)

Solar data amplitude and phase

timescale = 121.43 days

2.00

K

1.75

K indep.

1.50

mean K

1.25

phi

3

phi indep. mean phi

2

1

1.00

0

0.75

1

0.50

0.25

2

0.00

3

57400Time57c6e0n0ter (B5J7D80-02,4005,8000000) 58200

(d) Solar data AB, timescale = 121.43 days N 2 A: 3.035, B = 7.376

Mean A, mean B

Mean A, mean B indep.

1.5

(A,B) (A,B) indep.

1.0

0.5

0.0

0.5

1.0

0.5

A 0(.m0 /s)

0.5

1.0

B (m/s)

Fig. 4: Phase and amplitude of the 13.39 days signal as a function of the time center of the window t0 for the Solar HARPS-N data, as described in Section 2.2 (solid lines, red and green respectively). Markers correspond to statistically independent estimates. Red and green dashed lines represent the average phase and amplitudes. The figures are all computed for a time-scale  = 539 days corresponding to /Tobs = 1/9. Plots (a), (b), (c), (d) are computed by adding iteratively the signals corresponding to the highest peaks to the base model.

Frequency (cycle/day) Period (days) 2 difference

Timescale: =121.43 days

0.9 0.9

10.40 11.55

250

0.8

12.99

200

0.7

14.84

0.6

17.31

150

0.5

20.77

0.4

25.94

100

0.3

34.56

0.2

51.73

50

0.1

102.86

0.057219 57421t0 5(B76JD23- 25,7480205,005080)27 58230 8742.99

Fig. 5: value of the 2 defined in Eq. (6) for the Solar HARPS-N log RHK as a function of t0 for 121 (=Tobs/9) days

waning towards the edge of the data set is due to the fact that when the t0 reaches the beginning or end of the time series, the window includes twice as less points as in the middle of the time series. Signals at  160 and  25 days also seem to be present but with more variability, which is consistent with the analysis of Fig. 1. In Fig. 3 , we represent the quantity defined in Eq. (15), that is the local maximum of z between certain frequencies as a function of t0 for fixed  ( = Tobs/3 = 365 days for (c) and  = Tobs/9 = 121 days for (d). We choose a collection of frequencies k = k which are represented in gray in Fig. 3 (c) and (d). The maxima of z between 10 and 20 days consistently occurs at 13.39 days.
The 13 days signal seems to be consistently present in the data and to have a steady period. We further examine whether its phase  and semi amplitude K as defined in Eq. (10) and Eq. (9) are constants of time. To avoid being polluted by other signals, we include in the base model a 26.9 days signal as well as a 9th order polynomial, filtering out low frequency signals. In Fig. 4 (a) and (b) we represent the evolution of  and K in red and green

Article number, page 8 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

RV phase - logR HK phase (rad)

RV timescale

a=nd36lo4g.2R9HdK apyhsase

difference

phase differnce

2

indep. estimates mean indep.

1

0

1

57400Time5c7e6n00ter (B5JD78-020,4005,0800000) 58200
Fig. 6: Difference between the RV phase and log RHK phase as a function of time for  = Tobs/3

respectively as a function of t0 for fixed  ( = Tobs/3 = 365 days for (a) and  = Tobs/9 = 121 days for (b), the uncertainties are represented with color shaded areas. Red and green dashed lines represent the mean values of  and K. Dots corresponds to
measurements done on disjoint box-shaped windows, which are
thus approximately statistically independent, as shown in Ap-
pendix A.2. In Fig. 4 (c) and (d) we represent the values of
A and B as defined in Eq. (3) with their uncertainties in blue ( = Tobs/3 = 365 days for (c) and  = Tobs/9 = 121 days for (d). Points in orange correspond to the measurement times
marked with dots in Fig. 4 (a) and (b), that yield approximately
independent estimates of A and B. At the shortest time-scale, it appears that N2 as defined in Eq. (14) is greater than 5 (see Fig. 4 (d)). In Fig. 4 (b), the variation of amplitude does seem to
significantly vary over time with two peaks around BJD 2457400
and BJD 2458000, which is consistent with the behaviour seen
in Fig. 3 (b). The statistical tests depend on the assumed of the
noise. To obtain more robust statistics, we perform the same
analysis but by adjusting an extra jitter term at each trial t0, and propagate the uncertainty on K, , A and B. The results are very
similar, and qualitatively unchanged. As a conclusion, it appears
that the 13.39 day signal has a long time scale, a consistent pe-
riod and phase, but its amplitude significantly varies with time.

3.1.2. Discussion
From a phenomenological point of view, the presence of the 13.39-day signal, as well as the one at 25 days, can be fully understood by the presence of active regions rotating with the solar surface, as those two periods corresponds to the second and Prot term. By modifying locally the flux intensity of the solar surface (e.g. Saar & Donahue 1997) and changing convection (e.g. Meunier & Lagrange 2013), spot and faculae on the surface of a solar-like star will impact RV data, with a semi-periodic signal that can be decomposed as a Fourier series, thus as a sum of periodic signals at the rotation period of the Sun and its first harmonics (Boisse et al. 2011).
It is often observed on solar-like stars that activity inject more power at Prot/2 than its rotation period Prot (e.g. Boisse et al. 2011). This can be explained by the fact that not only one but several active regions perturbs the RV measurement at the same time, but also because the Sun is seen equator on, thus ac-

tive regions are seen only during half the rotation. On a star like the Sun, the main contribution of the RV stellar activity signal comes from faculae (e.g. Meunier et al. 2010; Dumusque et al. 2014; Collier Cameron et al. 2019; Milbourne et al. 2019) which induce a strictly positive RV offset whatever their position on the solar disc, and the effect of an active region, in first approximation, can be viewed as a sinusoid truncated at zero (e.g. Meunier et al. 2010; Dumusque et al. 2014). This truncation alone cannot explain the predominance of the Prot/2 term, as the Fourier expansion of such a truncated sinusoid has a stronger Prot term than Prot/2, where Prot denotes the stellar rotation period. If spots are at different longitudes, the RV signal would resemble a sum of truncated sine signals with different phases, and random phase differences do not affect preferentially a given harmonic. However, a phase difference of two signals of 180 cancels out the first harmonic. As noted in Borgniet et al. (2015), there are generally two persistent active longitudes per hemisphere, shifted by 180 (Berdyugina & Usoskin 2003), and this might explain the second harmonic. We add that even if there are several such configurations of two diametrically opposed active longitudes at different phases, the sum of their contributions has a vanishing component at Prot. The presence of active regions on thxe surface, not in opposite phase but randomly distributed, may introduce signal at Prot. We finally note that the RV effect of active regions is not only due to convective blueshift inhibition, but also to their difference in brightness relative to the surroundings, introducing an asymmetry in approaching and receding limbs. This signal of photometric origin resembles a sine function with period Prot/2 on [kProt/2, (k + 1)Prot/2] for k even and equal to 0 for k odd (e.g. Dumusque et al. 2014). This truncated signal has a dominant power at Prot/2, which might partly explain the strong Prot/2 signal in Fig. 1 (b).
Regarding the change in amplitude and stability in phase, it can be explained by the presence of a few very large active regions, that last for several months on the solar surface. The induced RV effect will be large, and the signal consistent over a long-period of time. The fact that the amplitude is large around BJD 2457400 can be explained by the Sun being active in 2015, with a lot of large active regions on its surface. The lower 2 closer to the beginning of the time-series around BJD 2457217 is due to an edge effect. Regarding the sudden increase in amplitude around BJD 2458000, it can be explained by the last large active region that appeared on the solar surface before the Sun reached the minimum of magnetic cycle 24 (clearly seen in the Log(R'HK) time series in Figure 6 of Dumusque et al. 2021).
Overall, our tentative explanation of the strength of the 13.39 days signal, its phase stability and amplitude variation, is that stable magnetic regions diametrically opposed might have caused it. This speculative explanation requires further work to be properly accepted or rejected. We note that thankfully, the amplitude of the solar 13.39-day harmonic is more variable than its phase, making it less likely that such a signal in stellar data could be mistaken for a planet.
3.1.3. Radial velocity and log RHK
We now compare the RV and log RHK time series. We note that there is no apparent signal at 13-14 days in the log RHK timeseries. In Fig. 5 we show the 2 map of the solar log RHK, binned with the same pattern as the RV. The base model is a second order polynomial, and we add a jitter to the noise model equal to the standard deviation of the log RHK time series divided by 2. In Fig. 5, there are low frequency signals at 200 - 400 days as well

Article number, page 9 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021

Velocity (m/s)
Velocity - offset (m/s)

HD 215152 HARPS radial velocities

HARPS03

13670

HARPS15

Points removed

13675

10

13680

5

13685

0

13690

-5

53000 540T0im0 e (5B5J0D00- 240506000000) 57000

-10

Fig. 7: HD 215152 HARPS radial velocities. Data taken before and after the fiber update are represented in blue and red respectively.

as signals close to the stellar rotation period, but none close to its first harmonic. As for the RV, we then performed an iterative search for signals (6 iterations), and did not find signals at 13 days.
Furthermore, as suggested in Section 2.2, we study the phase difference of RV and log RHK. In both time series, there is a signal at the Solar rotation period. We fix P = 26.25 days, and compute the difference  RV phase - log RHK as a function of t0 for  = 364 (=Tobs/3) days, where the phases are defined in Eq. (10). The uncertainty on  is defined as the quadratic addition of the uncertainties on the RV and log RHK phases. These are computed by fitting a free jitter error term for each choice of t0. In Fig. 6, we represent in purple the phase difference as a function of t0, the shaded areas represent ± 1 uncertainties, and the dots represent statistically independent phase measurements. The average difference of phase is 20 ±6, and this difference seems approximately constant throughout the observations. The RV 26 days signal is consistently in advance on the log RHK by 1.5 ± 0.5 days.
3.2. HD 215152
The star HD 215152 has been observed with the HARPS spectrograph during a 13 years period from BJD 2452808 to 2457659. The data consists of 373 data points with mean error 0.73 m/s. The data are shown in Fig. 7. HARPS has experienced an update of optical fibers in May 2015, which introduces a velocity offset. Data taken before and after the fiber update, labelled HARPS03 and HARPS15, are represented in blue and red respectively. This system has been studied in Delisle et al. (2018), who claims the discovery of four super-Earth with orbital periods 5.76, 7.28, 10.86 and 25.20 days. The analysis of Delisle et al. (2018) proceeds as follows. The data is modelled as a sum of Keplerian signals and two offsets: one corresponding to HARPS03 data and one to HARPS15 data. The log RHK (Noyes 1984) is smoothed with a low-pass filter, the resulting time series as well as the residuals (high-passed filter log RHK) are used as linear predictors. The data is analysed with a Gaussian noise model whose kernel is defined as the sum in quadrature of the nominal uncertainties, a free jitter and a correlated component

with a Gaussian autocovariance (or kernel). Denoting by t the time difference between measurements, the autocovariance is 2R e-t2/(22R), where 2R and R are free parameters. The significance of the signals is established by computing periodograms where J, R and R are fitted at all trial frequencies. The periodogram is computed as the difference of Bayesian information criterion (Schwarz 1978) of models H and K. The rotation period of the star is estimated to be 43 days.
In this section, we present a re-analysis of the same data to assess the stability in amplitude, phase and period of the detected signals. We exclude from the datasets the two points represented in black in Fig. 7, on the ground that they deviate from the median of the HARPS15 data (blue points) by over 4 median absolute deviation.
To simplify the discussion, we assume the same model as Delisle et al. (2018) and fix the values of the noise parameters to their posterior medians J = 0.6 m/s, G = 1.2 m/s and the timescale of the noise is R = 2 days (note that this is different from the apodisation time-scale ). In the base model (1), we also include the low-pass filtered log RHK as well as the two offsets. We then compute the ASP (eq. (6)) in four cases. In each one, we add to the base model six linear predictors cos 1t, sin 1t, cos 2t, sin 2t, cos 3t, sin 3t where 1, 2 and 3 are the frequencies of three planets out of four. This comes down to assuming that three planets are securely detected and the consistency of the fourth one is tested. The frequency grid goes from 0 to 0.8 cycles per day to avoid showing the aliases of the peaks.
When leaving out the 5.76, 7.28, 10.86 days planets from the base model, we obtain respectively Fig. 7 (a,b,c). It appears clearly for planets at 5.76 days and 10.86 days that the maximum occurs for the longest coherence time (in blue). In the case of the 7.28 days signal, the maximum occurs at /Tobs = 1/3. However, as shown on the right panel, the /Tobs = 10 hypothesis is not excluded. Note that the sampling of the HARPS data is very irregular, with a few samples between BJD 2453000 and 2454500 (see Fig. 7). When leaving out the 25 days planet, we obtain Fig. 7 (d). In that case, the highest peak corresponds to 46 days. If the  = 10Tobs were true, the periodogram peak corresponding to  = Tobs/3 would be  2  away from the highest peak (see right panel Fig. 7 (d). This is not surprising, as 46 days is close to the estimated rotation period of the star. When subtracting the 46 day signal with  = Tobs/3, we obtain Fig. 7 (e). The maximum peak is attained at 25 days and appears to be consistent with  = 10Tobs, and thus a planet. We note however that the the false alarm probability obtained with a regular periodogram of the 25 days planet is 1%, so that it might be suitable to acquire more points for a more significant detection.
We perform the test described in Section 2.2 for each of the four cases. Fig. 8 shows the resulting plot. It appears that the phase and amplitude of the signals are compatible with the hypothesis that they are constant in all cases.
3.3. HD 69830
In this section, we illustrate the Bayesian method proposed in Section 2.1.4 with the HARPS03 data of HD 69830. This dataset contains 254 data points and spans on 11.5 years. The HD 69830 system is known to harbour three planets with minimum masses close to Neptune's (Lovis et al. 2006) and periods of 8.667, 31.56 and 197 days.
As suggested in Section 2.1.4, we compute the joint posterior distribution of the orbital elements and the number of planets. The signal is represented as a sum of k keplerian functions

Article number, page 10 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic
(a)
(b)
(c)
(d)
Fig. 8: Each row correspond to ASPs computed on the HD 215152 HARPS data. All are computed with a base model including linear activity model and offsets as described in Section 3.2. They also include three of the four planets. Figures (a), (b), (c), (d) correspond respectively to leaving out planets at 5.75, 7.28, 10.86 and 25.20 days. Left column: ASPs corresponding to equation (7) for different values of  (blue, orange, green and red correspond to /Tobs = 10, 1/3, 1/9 and 1/27). Middle column: zoom on the maximum peak of the ASP. Right: statistical test on the time-scale. When subtracting the 46 day signal with  = Tobs/3 (period at which the maximum of the ASP is attained in (d)), we obtain (e) (on the following page), where a coherent 25.2 d signal appears.
Article number, page 11 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021
(e)

Phase - mean phase (rad)

Phase - mean phase (rad)

K (m/s)

(a) HD 215152 amplitude and phase

timescale = 538.97 days

5

K

phi

3

4

K indep. mean K

phi indep. mean phi

2

3

1

0 2
1 1
2

0

3

53000 5T40im00e cent5e5r0(0B0JD - 2,5460000,0000) 57000

(c) HD 215152 amplitude and phase timescale = 538.97 days

16

K

14

K indep.

12

mean K

10

phi

3

phi indep. mean phi

2

1

8

0

6 4

1

2

2

0

3

53000 5T40im00e cent5e5r0(0B0JD - 2,5460000,0000) 57000

Phase - mean phase (rad) K (m/s)

Phase - mean phase (rad) K (m/s)

(b)

HD 215152 amplitude and phase

timescale = 538.97 days

6

K

5

K indep. mean K

4

phi

3

phi indep. mean phi

2

1

3

0

2

1

1

0

2

153000 5T40im00e cent5e5r0(0B0JD - 2,5460000,0000) 57000

3

(d)

HD 215152 amplitude and phase

timescale = 538.97 days

7

K

6

K indep. mean K

5

4

phi

3

phi indep. mean phi

2

1

3

0

2

1

1

0

2

53000 5T40im00e cent5e5r0(0B0JD - 2,5460000,0000) 57000

K (m/s)

Fig. 8: Phase and amplitude as a function of the time center of the window t0, as described in Section 2.2 (solid lines, red and green respectively). Markers correspond to statistically independent estimates. Red and green dashed lines represent the average phase and amplitudes. The figures are all computed for a time-scale  = 539 days corresponding to /Tobs = 1/9. Plots (a), (b), (c), (d) correspond to base models including offsets, linear activity indicators and all the claimed planets except 5, 7, 10 and 25 day
respectively.

multiplied by an apodization factor and a noise model (a random variable)

y=

k

e-

(

t-t0 )2 22

Kepi(P, e, K, , M0) +

i=1

(16)

Article number, page 12 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

Fig. 9: Left and right: posterior distribution of  (defined in Eq. (16)) and f (defined in Eq. (8)) conditioned on the period P being
such that |1/P - 1/Pi| < 1/Tobs for i = 1, 2, 3 and P1 = 8.66 days, P2 = 31.56 days and P3 = 197 days. i = 1, 2, 3 correspond respectively to the blue, orange and green histograms. The black dotted line corresponds to  = Tobs

Parameter
P
K
e 
M0 R k W R T

Units days m/s
rad rad days m/s m/s days

Prior
log-Uniform: [0.7, 1000] log-Uniform: [0.1, 20] Beta: [0.867, 3.03] Uniform: [0, 2] Uniform: [0, 2] Uniform: [0, 10 Tobs] Uniform: [0, k]
Uniform: [0, 20] Uniform: [0, 20] log-Uniform: [0.1, 30]

Table 2: Priors used for the computation of the FIP periodogram of HD 69830 and HD 13808.  Kipping (2014)

where Kep(P, e, K, , M0) is a Keplerian function (e.g. Perryman 2011) of period P, eccentricity e, semi-amplitude K, argument of periastron  and initial mean anomaly M0. We use a Gaussian noise model for with a jitter term and an exponential decay,
implemented with the spleaf software (Delisle et al. 2020b).
The covariance matrix V has the form

Vi j

=

i j(2i

+

2W )

+

2R

e-

(ti -t 2T

j )2 2

(17)

where i j is the Kronecker symbol, i is the nominal uncertainty on measurement i. The priors on the parameters are presented in
Table 2. As in Hara et al. (2021), the posterior distributions are
computed with polychord (Handley et al. 2015b,a). In Fig. 9 we represent the posterior distribution of  (defined
in Eq. (16)) and f (defined in Eq. (8)) conditioned on the period P being such that |1/P - 1/Pi| < 1/Tobs for i = 1, 2, 3 and P1 = 8.66 days, P2 = 31.56 days and P3 = 197 days. Tobs is the total timespan of the observations. The  distribution for the P3 = 197 days planets peaks below Tobs. In the f distribution (right) it clearly appears that all distributions peak at 1. In conclusion, all
the three known planets are indeed consistently detected.

3.4. HD 13808
The HD 13808 system has been observed with HARPS (Mayor et al. 2003) over a 10 year timespan. The dataset contains 246 ra-

dial velocity measurements, and presents three candidate signals
at 14.1, 19 and 53.7 days. In Ahrer et al. (2021), the HARPS is analysed with many different noise models based on the bisector span (Queloz et al. 2001), and the log RHK (Noyes 1984). The stellar activity models are built upon the framework of
Gaussian processes (Rajpaul et al. 2015) and the FF method (Aigrain et al. 2012). The models with different numbers of planets and different stellar activity models are compared through their Bayesian evidence. The authors conclude that the 14.1 and
53.7 days planets are securely detected and the 19 days planet
cannot be confidently claimed.
We here perform the same analysis as Section 3.3. Follow-
ing the method of Section 2.1.4, we compute the joint posterior distribution of , t0, , and the number of planets. We use the same noise model (see Eq. (17)), same priors (see Table 2) as for
HD 69830 and the same numerical method, polychord (Handley et al. 2015b,a).
First, to check that the signals are significant, as in Hara
et al. (2021), we compute the FIP periodogram. This one is
defined as follows. We consider a grid of frequency intervals
with a fixed length. The element k of the grid, Ik, is defined as [k - /2, k + /2] where  = 2/Tobs, Tobs is the total observation timespan and k = k/Noversampling. We take Noversampling = 5. We then compute the probability to have at least one planet in Ik (the TIP), and the FIP = 1 - FIP. We then represent - log10 FIP as a function of k.
As suggested in Hara et al. (2021), we compute the FIP periodogram for different maximum number of planets. We find that the FIP periodograms obtained for three and four planets
are almost identical, and choose the three planets models. To
assess the computational uncertainties, we compute the FIP periodogram with three dfferent runs of polychord. The resulting FIP periodogram is shown in Figure 10, each run corresponds to a FIP periodogram of a different color. It appears that the probability of not having a planet at 14.1 and 53.7 days is below 10-10 and 10-2 respectively. The significance of the 18.9 days signal is
much lower, with a FIP  70%. We also did the same calculation
with a white noise model, for which the 18.9 days signal is much
more significant (FIP of 1%).
We then compute the posterior distribution of the apodisation timescale  and the fraction of information captured by a window

Article number, page 13 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021
Fig. 10: FIP periodogram of HD 13808. - log10 FIP (in blue) and log10 TIP (in yellow) of the presence of a planet in a centered frequency interval [ - ,  + ] as a function of .  = 2/Tobs where Tobs is the total observation time-span. Different colors correspond to independent computations with POLYCHORD. The plot inside black box represents a zoom on the region close to 18.9 days.

Fig. 11: HD 13808 data set: left and right: posterior distribution of  (defined in Eq. (16)) and f (defined in Eq. (8)) conditioned on
the period P being such that |1/P - 1/Pi| < 1/Tobs for i = 1, 2, 3 and P1 = 14.18 days, P2 = 19 days and P3 = 53.8 days. i = 1, 2, 3 correspond respectively to the blue, orange and green histograms. The black dotted line corresponds to  = Tobs

of given width f , as in Section 3.3. In Fig. 11 we represent the posterior distribution of  (defined in Eq. (16)) and f (defined in Eq. (8)) conditioned on the period P being such that |1/P - 1/Pi| < 1/Tobs for i = 1, 2, 3 and P1 = 14.18 days, P2 = 19 days and P3 = 53.8 days. We find that all signals have an f distribution peaking at 1.
As a conclusion, in accordance with Ahrer et al. (2021) we find that the 14.1 and 53.7 days signal are statistically significant. The significance of the 19 days signal is too low to claim a detection. However, it appears that the signal is consistent in time, so that a planetary origin cannot be excluded. However, this is not likely, since as shown in Ahrer et al. (2021), a 19 days signal is present in the ancillary indicators. We have seen in the case of the Sun (see 3.1) that the first harmonic of the rotation period exhibits a constant period and phase, but not a constant amplitude. Since the stellar rotation period is  38 days, the 19 days signal could be another case of first, stable harmonic of the rotation period.

4. Discussion and conclusions
In the present work, our goal is to assess whether an apparently periodic signal is strictly so, with a focus on the detection of planets in radial velocity data. This can be done with models intended to capture all variations due to the planets and stellar activity (Haywood et al. 2014; Rajpaul et al. 2015; Jones et al. 2017; Hara et al. 2021). However, these models are not guaranteed to be trustworthy, which motivates the approach of the present work, whose methods offer a complementary outlook on the data.
Following (Gregory 2016), we considered wavelet-like functions: periodic functions multiplied by an apodization term. We suggested different representations and statistical tests to explore whether a signal is truly periodic, by constraining its time-scale (see Section 2.1), its variation of phase and amplitude (see Section 2.2) and its frequency variation (see Section 2.3). We considered tests based on periodograms (see Section 2.1.1, 2.1.2, 2.1.3) and on the Bayesian formalism (see Section 2.1.4). Periodograms provide interpretable figures, and

Article number, page 14 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

scan robustly and quickly all the periods, while their exploration might be difficult with random searches used for Bayesian inference. On the contrary, this one has the advantage of providing easily interpretable quantities. Depending on the objective and the size of the dataset, one of the two approaches might be more adapted.
The variability of the signal of interest can be assessed at different time-scale with a typical Heisenberg uncertainty principle: the shorter is the time-scale of variation probed, the higher is the uncertainty on the local estimates of phase, amplitude and period. We recommend to study this variability on a grid of timescales, chosen with an exponential decrease, as in wavelet decomposition (Mallat 1989).
Our tests are defined to assess the consistency with a certain data model. If other signals are present (trends, other periodic or quasi periodic signals), or the shape of the signal examined is not sinusoidal ­ for instance it corresponds to an eccentric planet ­ our indicators might present significant variations, while the signals is truly periodic. As a consequence, for the results to be reliable, it is crucial to model simultaneously the signal of interest and other signals present. The approach we suggest is either to model the data as a sum of apodized periodic components, as in (Gregory 2016), or to assume that all periodic signals are truly periodic, except the one under consideration.
When assessing the phase and amplitude variability of a signal at frequency 0 it is crucial to use all the data to estimate 0, since the longest baseline gives the most precise estimate of 0. An inaccurate estimate of 0 might result in an apparent, spurious, linear phase shift with time.
We analysed the Solar radial velocity as measured by HARPS-N (Dumusque et al. 2021) as well as the HARPS data of HD 215152 (Delisle et al. 2018), HD 69830 (Lovis et al. 2006) and HD 13808 (Ahrer et al. 2021). The Solar radial velocity contains quasi-periodic signals at the first and second harmonic of the rotation period, the latter having the largest amplitude of the two. The 25 - 27 days region shows a varying period, phase and amplitude. The second harmonic, appearing at 13.39 days, shows a period and phase constant within the uncertainties of statistical tests, showing that stellar activity signals can exhibit traits of purely periodic signals. Fortunately, the amplitude of the solar 13.39-day harmonic shows significant variations at the time-scale of 121 days (total observation time-span divided by nine). Such variability makes it less likely that such a stellar signal could be mistaken for a planet. These amplitude variations can be mapped to variations of the level of activity. This case shows that variations of amplitude, phase and frequencies due to stellar activity can be very subtle, and require a high signal to noise ratio to be statistically significant. These observations can speculatively be explained by the persistence of large active regions diametrically opposed, as suggested by (Borgniet et al. 2015). Testing more rigorously this hypothesis is left for future work.
In HD 13808, there is a potential low amplitude, signal at 19 days, which also presents consistency in time. We therefore agree with the conclusion of Ahrer et al. (2021) that two planets can be confidently claimed. A planetary origin of the signal can although not be excluded, which might motivate further observations.
The detection of four and three planets in HD 215152 and HD 69830 were claimed in (Delisle et al. 2018) and Lovis et al. (2011) respectively. We find in both cases that all the planets exhibit constant phases and amplitudes, which strengthens these detection claims.

In the present work, we have suggested several methods to assess whether a signal is strictly periodic or not, but many other can be considered. The techniques for simultaneous modelling of quasi periodic, periodic signals and noise, and the periodicity criteria could both be explored in further detail. We leave this exploration and the comparison of the different criteria for future work.
Acknowledgements. The authors thank the anonymous referee for their very insightful comments, which helped to improve the paper. N. C. H thanks Michaël Cretigner for his input. N. C. H. and J.-B. D. acknowledge the financial support of the National Centre for Competence in Research PlanetS of the Swiss National Science Foundation (SNSF).
References
Agol, E. & Fabrycky, D. C. 2018, Transit-Timing and Duration Variations for the Discovery and Characterization of Exoplanets, ed. H. J. Deeg & J. A. Belmonte, 7
Ahrer, E., Queloz, D., Rajpaul, V. M., et al. 2021, MNRAS, 503, 1248 Aigrain, S., Pont, F., & Zucker, S. 2012, MNRAS, 419, 3147 Baluev, R. V. 2008, MNRAS, 385, 1279 Baluev, R. V. 2013, Monthly Notices of the Royal Astronomical Society, 436,
807 Baluev, R. V. 2013a, Astronomy and Computing, 3, 50 Baluev, R. V. 2013b, MNRAS, 431, 1167 Baluev, R. V. 2015, MNRAS, 446, 1478 Berdyugina, S. V. & Usoskin, I. G. 2003, A&A, 405, 1121 Boisse, I., Bouchy, F., Hébrard, G., et al. 2011, A&A, 528, A4 Borgniet, S., Meunier, N., & Lagrange, A. M. 2015, A&A, 581, A133 Bourrier, V., Dumusque, X., Dorn, C., et al. 2018, A&A, 619, A1 Collier Cameron, A., Mortier, A., Phillips, D., et al. 2019, MNRAS, 487, 1082 Cumming, A., Marcy, G. W., & Butler, R. P. 1999, ApJ, 526, 890 Daugman, J. G. 1998 de Jager, O. C. 1994, ApJ, 436, 239 Delisle, J. B., Hara, N., & Ségransan, D. 2020a, A&A, 635, A83 Delisle, J. B., Hara, N., & Ségransan, D. 2020b, A&A, 638, A95 Delisle, J.-B., Ségransan, D., Dumusque, X., et al. 2018, A&A, 614, A133 Demory, B.-O., Gillon, M., Madhusudhan, N., & Queloz, D. 2016, MNRAS,
455, 2018 Dumusque, X., Boisse, I., & Santos, N. C. 2014, ApJ, 796, 132 Dumusque, X., Cretignier, M., Sosnowska, D., et al. 2021, A&A, 648, A103 Dumusque, X., Pepe, F., Lovis, C., & Latham, D. W. 2015, ApJ, 808, 171 Faria, J. P., Haywood, R. D., Brewer, B. J., et al. 2016, A&A, 588, A31 Feng, F., Tuomi, M., & Jones, H. R. A. 2017, MNRAS, 470, 4794 Ferraz-Mello, S. 1981, AJ, 86, 619 Foster, G. 1996, AJ, 112, 1709 Gilbertson, C., Ford, E. B., Jones, D. E., & Stenning, D. C. 2020, ApJ, 905, 155 Gregory, P. C. 2007a, MNRAS, 374, 1321 Gregory, P. C. 2007b, MNRAS, 381, 1607 Gregory, P. C. 2016, ArXiv e-prints [arXiv:1601.08105] Grossmann, A. & Morlet, J. 1984, SIAM Journal on Mathematical Analysis, 15,
723 Handley, W. J., Hobson, M. P., & Lasenby, A. N. 2015a, MNRAS, 450, L61 Handley, W. J., Hobson, M. P., & Lasenby, A. N. 2015b, MNRAS, 453, 4384 Hara, N. C., Unger, N., Delisle, J.-B., Díaz, R., & Ségransan, D. 2021, arXiv
e-prints, arXiv:2105.06995 Haywood, R. D., Collier Cameron, A., Queloz, D., et al. 2014, MNRAS, 443,
2517 Jones, D. E., Stenning, D. C., Ford, E. B., et al. 2017, ArXiv e-prints
[arXiv:1711.01318] Kass, R. E. & Raftery, A. E. 1995, Journal of the American Statistical Associa-
tion, 90, 773 Kipping, D. M. 2014, MNRAS, 444, 2263 Lomb, N. R. 1976, Ap&SS, 39, 447 Lovis, C., Mayor, M., Pepe, F., et al. 2006, Nature, 441, 305 Lovis, C., Ségransan, D., Mayor, M., et al. 2011, A&A, 528, A112 Madhow, U. 2008, Demodulation (Cambridge University Press), 74­152 Mallat, S. G. 1989, IEEE Transactions on Pattern Analysis and Machine Intelli-
gence, 11, 674 Mayor, M., Pepe, F., Queloz, D., et al. 2003, The Messenger, 114, 20 Meunier, N., Desort, M., & Lagrange, A.-M. 2010, A&A, 512, A39 Meunier, N. & Lagrange, A. M. 2013, A&A, 551, A101 Milbourne, T. W., Haywood, R. D., Phillips, D. F., et al. 2019, ApJ, 874, 107 Mortier, A. & Collier Cameron, A. 2017, A&A, 601, A110 Mortier, A., Faria, J. P., Correia, C. M., Santerne, A., & Santos, N. C. 2015,
A&A, 573, A101

Article number, page 15 of 17

A&A proofs: manuscript no. hara_delisle_unger_dumusque_2021 Nava, C., López-Morales, M., Haywood, R. D., & Giles, H. A. C. 2020, AJ, 159,
23 Noyes, R. W. 1984, in Space Research in Stellar Activity and Variability, ed.
A. Mangeney & F. Praderie, 113 Pepe, F., Lovis, C., Ségransan, D., et al. 2011, A&A, 534, A58 Perryman, M. 2011, The Exoplanet Handbook (Cambridge University Press) Queloz, D., Henry, G. W., Sivan, J. P., et al. 2001, A&A, 379, 279 Rajpaul, V., Aigrain, S., Osborne, M. A., Reece, S., & Roberts, S. J. 2015, ArXiv
e-prints [arXiv:1506.07304] Reegen, P. 2007, A&A, 467, 1353 Saar, S. H. & Donahue, R. A. 1997, ApJ, 485, 319 Scargle, J. D. 1982, ApJ, 263, 835 Schuster, A. 1898, Terrestrial Magnetism, 3, 13 Schwarz, G. 1978, Ann. Statist., 6, 461 Sulis, S., Dragomir, D., Lendl, M., et al. 2019, A&A, 631, A129 Süveges, M. 2014, MNRAS, 440, 2099 Tuomi, M. 2012, A&A, 543, A52 Zechmeister, M. & Kürster, M. 2009, A&A, 496, 577
Article number, page 16 of 17

Nathan C. Hara Jean-Baptiste Delisle, Nicolas Unger, Xavier Dumusque: Testing whether a signal is strictly periodic

Appendix A: Computations

Appendix A.1: Distribution of the difference of two 2 variables

Let us consider two models K(, t0, ) and K( , t0,  ), which we denote by

K(, t0, ) : y = Ax + ,  G(0, V)

(A.1)

K( , t0,  ) : y = Bx + ,  G(0, V)

(A.2)

where G(0, V) is a multivariate Gaussian distribution of mean

0 and covariance V. We want to compute the distribution of
z(, t,, ) - z(, t ,,  ) under the hypothesis that K(, t0, ) is correct. We suppose the data is vA + where vA = Axt.
We further denote by PM = M(MT V-1 M)-1 MT V-1 and HM = V-1PMfor a given matrix M. The residuals of the fit of models MA and MB are

rA =(I - PA) rB =(I - PB)( + vA)

(A.3) (A.4)

We denote by uA := (I - PB)vA and V = LLT where L is the Cholesky decomposition.of V, and  := L-1 . 2 a

2A = T LT (V-1 - HA)L

(A.5)

2B = T LT (V-1 - HB)L + 2uAV-1(I - PB)L + uTAV-1uA (A.6)

Then the difference of periodogram values is

Dz = z(, t,, ) - z(, t ,,  ) = 2A - 2B = -(T D + T  + )

(A.7) (A.8)

where D = HA - HB,  = 2uAV-1(I - PB)L,  = uTAV-1uA. Then the expectancy ad variance of Dz are

E{Dz} = - Dii - 

i

V{Dz} = D2i j + 2i

i, j

i

(A.9) (A.10)

Appendix A.2: Independence of semi-amplitude and phase estimate

Let us suppose the data is

y = y0 +

(A.11)

where y0 is the model and is a random variable following a Gaussian distribution with null mean and covariance V.

We consider two alternative linear models: y = Mx + and

y = M x + . Then their corresponding least square estimates are xM := (MT W M)-1 MT Wy and xM := (M T W M )-1 M T Wy where W := V-1. Then the covariance of xM and xM is

Cov(xM, xM ) = (MT W M)-1 MT W M (M T W M )-1

(A.12)

We now consider the case where M = [m, M0] and M = [m , M0] where the brackets designate the concatenation of two matrices, and m = [w(t - t0) cos t, w(t - t0) sin t], m = [w(t - t0) cos t, w(t -t0) sin t] where w is a box-shaped time-window, zero everywhere except between t0 - /2 and t0 + /2, and |t0 - t0| > . That is, fitting M and M correspond to two model K (see eq. (2)).
If the noise is uncorrelated, V is diagonal and so is W. Since
w(t - t0)w(t - t0) = 0 The coefficients of columns m and m , from eq. (A.12) are independent. If the noise is correlated W is non diagonal and w(t - t0)T Ww(t - t0) where w(t) is the column vector (w(ti))i=1..N

PDF

10 2

10 4

10 6

GEV fitted on 200 simulations Empirical PDF (12,000 simulations)

Uncertainty

5 10 m1a5x Z 20 25

Fig. B.1: Empirical distribution of the maximum of periodograms generated

Appendix B: FAP calculation
Here, we denote by the generic symbol Z(Y, ) a function of the data Y which is either z, as defined in eq. (6), or for a fixed T , , t0  z(, t0, T ). Denoting by Zmax the observed maximum of the periodogram on the data to be analysed, the false alarm probability (FAP) is defined as

FAP = Pr{max Z(Y, )


Zmax|Y  H }

(B.1)

where H is defined in eq. (1). The FAP can be computed by simulations generating data following model  H and computing the empirical distribution of max Z(Y, ), or generating Y with random permutations of the input data. The value of H can be fixed to zero without loss of generality. This procedure can be very computationally heavy to reach low FAPs. The ASP is special case of non linear "Von Mises" periodograms defined in Baluev (2013b), for which analytical approximations of the FAP can be derived. In that case, the specific form of the apodization function must be specified. We here adopt the approach of Süveges (2014), which consists in generating data like in the simulation approach, but then fitting a generalised extreme distribution (GEV) to the generated samples. The analytical form of a GEV distribution is

p(z; µ, , )

=

1 

t(z)+1

e-t(z)

(B.2)

where

 t(z) = 


1

+



z-µ 

-

1 

if 

e-

z-µ 

if  = 0

0

(B.3)

The parameters µ, ,  can be estimated with a maximum likelihood estimate, and the uncertainties obtained from the inverse of the Fisher information matrix can be propagated to p(z; µ, , ) for a certain value of z, to ensure that the FAP computed is accurate enough.
This approach allows to drastically reduce the number of simulations needed to estimate the low FAP levels. To illustrate this, we show in Fig. B.1 the histogram of 12,000 maxima of periodograms, and the distribution (blue) and the fit of the 200 first simulations made with a Nelder-Mead algorithm (in orange). The simulation is made with the 70 first measurements of HD 85512 (Pepe et al. 2011).

Article number, page 17 of 17

