Correlated insulators, semimetals, and superconductivity in twisted trilayer graphene
Maine Christos,1 Subir Sachdev,1 and Mathias S. Scheurer2 1Department of Physics, Harvard University, Cambridge MA 02138, USA 2Institute for Theoretical Physics, University of Innsbruck, Innsbruck A-6020, Austria
Motivated by recent experiments indicating strong superconductivity and intricate correlated insulating and flavor-polarized physics in mirror-symmetric twisted trilayer graphene, we study the effects of interactions in this system close to the magic angle, using a combination of analytical and numerical methods. We identify asymptotically exact correlated many-body ground states at all integer filling fractions  of the flat bands. To determine their fate when moving away from these fine-tuned points, we apply self-consistent Hartree-Fock numerics and analytic perturbation theory, with good agreement between the two approaches. This allows us to construct a phase diagram for the system as a function of  and the displacement field, the crucial experimental tuning parameter of the system, and study the spectra of the different phases. The phase diagram is dominated by a correlated semimetallic intervalley coherent state and an insulating sublattice-polarized phase around charge neutrality,  = 0, with additional spin-polarization being present at quarter ( = -2) or three quarter ( = +2) fillings of the quasi-flat bands. We further study the superconducting instabilities emerging from these correlated states, both in the absence and in the additional presence of electron-phonon coupling, also taking into account possible Wess-Zumino-Witten terms. In the experimentally relevant regime, we find triplet pairing to dominate, possibly explaining the observed violation of the Pauli limit. Our results have several consequences for experiments as well as future theoretical work and illustrate the rich physics resulting from the interplay of almost flat bands and dispersive Dirac cones in twisted trilayer graphene.

arXiv:2106.02063v1 [cond-mat.str-el] 3 Jun 2021

CONTENTS
I. Introduction A. Connection to experiment and phase diagram B. Organization of the paper
II. Model and symmetries A. Continuum model and symmetries B. Adding a Displacement Field C. Projected low-energy model D. Interactions and form factors
III. Exact groundstates at D0 = 0 A. Hamiltonian and construction of eigenstates B. Discussion of ground states C. Resultant candidate states
IV. Hartree-Fock numerics A. Hartree-Fock Method B. Band Structures 1. Self-Consistent Band Structures at D0 = 0 2. Self-Consistent Band Structures for D0 > 0 C. Energies and phase diagram
V. Analytical perturbation theory A. Ordering in the graphene-like bands B. Mixing between the bands C. Deforming the form factors

D. Finite TBG bandwidth

19

E. Comparison of energetics

19

2

F. Breaking SU(2)+× SU(2)-

19

3

VI. Numerics for  = ±2

20

4

A. Procedure and results

20

B. Connection to experiment

20

4

4 VII. Superconductivity

21

6

A. Pairing in the presence of polarization

21

6

B. Pairing without polarization

21

7

C. Relevance of Dirac cones and topology 22

9 VIII. Conclusion and discussion

23

Acknowledgments

25

9

10

References

25

10

A. Hamiltonian for the system

28

12

1. Continuum model and low-energy degrees of

12

freedom

28

12

2. Single-particle symmetries

29

3. Interaction and form factors

31

13

B. Exact statements about the interacting

14

groundstates

34

14

1. Turning on the coupling between the

subsystems

34

14

2. Behavior of Goldstone modes

36

16

17

C. Hartree-Fock functional

37

18

1. General form

37

2

2. Numerical procedure

38

a. How we fix the phases in numerics

38

b. Iterative procedure

39

c. Ground State dependence on grid size 39

3. Varying Parameters

40

D. Numerics at  = 2

41

1. Stable Phases at  = 2

41

2. Connection to Experimental Phase

Diagram

42

E. Band Structure and solution for D0  w1

42

F. Different contributions to the energy

44

1. Deformation of the form factors

45

2. Finite bandwidth of the TBG-like bands 46

a. First order perturbation theory

46

b. Second order perturbation theory:

superexchange

46

3. Ordering in the graphene-like bands

47

4. Mixing between the TBG-like and

graphene-like bands

51

5. Hund's Coupling

58

G. Superconducting instabilities

59

1. Fluctuation-induced superconductivity 59

2. Order parameter in the polarized phase 61

H. WZW terms in MSTG

62

I. INTRODUCTION
Graphene-based moiré superlattice systems have attracted considerable interest in the last few years, motivated by the strongly correlated physics they display [1­ 6]. While originally driven by the experimental realization of near-magic-angle twisted bilayer graphene (TBG) [7, 8], related strongly-correlated moiré superlattices have emerged, such as twisted double-bilayer graphene [9­12] and ABC-trilayer graphene on hexagonal boron nitride [13­15]. All of these systems exhibit low-energy bands which are energetically separated from the rest of the spectrum and can be tuned to be flat [16­18], enhancing the impact of correlations. The resulting correlated phenomena include interaction-induced insulating states [7, 9­11, 13], superconductivity [8­10, 14], and nematic order [5, 19­22], which are also integral parts of the phase diagrams of paradigmatic strongly correlated materials such as the cuprates. Furthermore, TBG has demonstrated that graphene moiré systems can also exhibit additional cascades of transitions that "reset" the band structure in an entire range of electron filling fractions [23, 24]. This is likely related to the polarization of certain combinations of the internal "flavor" quantum num-

bers of the electrons in the quasi-flat bands [25, 26], with interesting consequences for superconductivity [25, 27].
In addition to the twist angle between the layers as a tuning knob in TBG, the spectrum of twisted doublebilayer graphene can be efficiently tuned by applying a perpendicular electric displacement field D0. Notwithstanding the interesting consequences for the correlated physics in the system [9­12, 21, 28, 29], including the possibility of electrical control of the nematic director [22], its superconducting properties [9, 10] have been found to be more fragile than in TBG. Fortunately, mirror symmetric twisted trilayer graphene (MSTG), which consists of three layers of graphene with alternating relative twist angles, see Fig. 2(a), has very recently been realized experimentally [30­32] and combines the best of both worlds: it can be tuned significantly by applying a perpendicular displacement field D0 while exhibiting strong and reproducible superconductivity. These experiments indicate that MSTG also exhibits both interactioninduced resistive states around integer filling fractions  as well as the aforementioned spontaneous band resetting in an extended region of  with 2 || 3, akin to the cascades in TBG [23, 24]. As a function of D0 and , the largest superconducting region is found to emerge out of this reconstructed normal state. Remarkably, Ref. 32 finds that the superconductor can sustain an in-plane magnetic field much larger than simple estimates of the Pauli limit. One additional crucial difference between MSTG and all of the other graphene moiré systems mentioned above is that MSTG not only exhibits quasi-flat bands but, at the same time, dispersive Dirac cones [30, 31, 33­38]. The interplay between these different types of bands and interactions likely gives rise to rich physics but also provides theoretical challenges.
So far, only very few theoretical studies of interactions in MSTG exist [39­44] and a systematic understanding of the nature and origin of possible particle-hole and superconducting instabilities as a function of  and D0 is still missing. The goal of this work is to help fill this gap by providing a detailed theoretical study of electron-electron interactions in the normal state of MSTG, allowing for a large class of possible instabilities, which is then used to analyze the order parameter and origin of the different superconducting phases of the system. In order to tackle the challenges associated with the simultaneous presence of flat and dispersive bands, we use a combination of analytical and numerical approaches.
More specifically, we start from the limit without displacement field, D0 = 0, where the non-interacting band structure of the system is just that of TBG and singlelayer graphene [33­38]; these two "subsystems" are, however, coupled by the Coulomb interaction. In the limit where the TBG bands are perfectly flat, we construct exact eigenstates of the interacting Hamiltonian of MSTG at all integer , which are also shown to be groundstates

for a finite range of the strength of the interaction between the two subsystems. This analysis shows that, in certain limits, also the interacting groundstates of MSTG are given by those of TBG and single-layer graphene. This is consistent with experiment [30, 31], observing a graphene Dirac cone at small D0.
To be able to address D0 = 0 and more realistic system parameters, we use Hartree-Fock (HF) numerics and analytic perturbation theory. Our HF approach is motivated by the success of this approach in TBG [45­50] and the fact that the exact groundstates at D0 = 0 are Slater-determinant states (in the TBG sector). In the analytic perturbation theory, we start from the exact groundstates and study the D0-induced deformations of the interaction matrix elements and band structure, the possible ordering in the graphene bands, the mixing between the graphene and TBG sectors for D0 = 0, as well as the finite bandwidth of the TBG bands as perturbations. This complements our HF numerics, as it allows us to pinpoint the novel energetic contributions in MSTG as compared to TBG and serves as an important validation of our numerics--in particular, concerning the fate of the graphene Dirac cones, which provides a challenge to any numerical study as they are energetically degenerate with the TBG bands only in a small fraction of the moiré Brillouin zone (MBZ). In our analytics, we take advantage of this fraction being small and use it as an expansion parameter. Overall, we find good agreement between the HF numerics and the perturbation theory, both confirming the form of the exact eigenstates at D0 = 0 (but with realistic system parameters); discrepancies between the approaches are traced back to the impact on the energetics coming from additional remote bands only taken into account in the numerics.
Having established the correlated nature and possible particle-hole instabilities in the normal state of MSTG as a function of D0 and , we analyze the consequences for superconductivity. We study superconductivity both in the additional presence and absence of flavor polarization. Motivated by experiments [51­53] on TBG, which indicate that electron-phonon coupling is important for pairing, we follow Ref. 54 and assume that electronphonon coupling stabilizes superconductivity but leaves singlet and triplet almost degenerate; informed by results for particle-hole instabilities in MSTG, we can then investigate which of the two will be favored due to additional particle-hole fluctuations. We also discuss purely electronic pairing and comment on the relevance of Dirac cones and associated Wess-Zumino-Witten (WZW) terms, as studied previously in TBG [25, 55].

3

SLP

D0

insulator

SC II
triplet

SLP+SP

IVC semi-metal
0
SLP insulator

SC III
1 singlet
[triplet]

IVC + SP
2

SC I
3 non-unit.
triplet
[singlet + triplet]

SC II
triplet

SP

SC II 4
triplet [singlet + triplet]

FIG. 1: Schematic phase diagram for MSTG based on our analysis, as a function of displacement field D0 and filling fraction . Due to particle-hole symmetry of our model, the phase diagram only depends on ||. We show the form of the dominant particle-hole instabilities, the intervalley coherent (IVC) semimetallic phase and a sublattice polarized (SLP) insulator at  = 0 (charge neutrality); the IVC and SLP state coexist with spin-polarization (SP) around || = 2. We discuss three different types of superconducting regimes, labelled SC I­III. We indicate in black their respective spin structure for the expected sign of the intervalley Hund's coupling JH resulting from Coulomb interactions alone [with opposite sign in gray].

A. Connection to experiment and phase diagram
To concisely summarize our main findings, we here briefly discuss their consequences for the phase diagram of MSTG, see Fig. 1, and their relation to experiment [30­32]. Based on our exact groundstates, perturbation theory, and HF numerics, the (for  = 0 slightly doped) semimetallic nature of the graphene sector is expected to be stable against interactions for D0 = 0. At charge neutrality,  = 0, the leading instability is found to be an intervalley coherent state (IVC) in the TBG sector. While the two sectors start to mix when D0 = 0, the semimetallic character of the bands is retained; the Landau fan sequence of this state, ±2, ±6, ±10, . . . , is consistent with that observed in Ref. 31. Once D0 increases beyond a certain critical value D0c [which depends on the relaxation parameter w0/w1 in Eq. (2.3)], the IVC state transitions into a sublattice-polarized (SLP) phase, where all Dirac cones are gapped out, leading to an insulator. For realistic parameters, we expect D0c to be of the order of or potentially slightly larger than the range of the experimentally applied fields [30­32].
At || = 2, we find self-consistent HF solutions with spin polarization, which co-exists with additional particle-hole instabilities. At small D0, the leading additional symmetry-breaking state is again an IVC phase. Here, the TBG bands are completely spin polarized while the graphene cones' polarization is only partial and approaches zero as D0  0. The spin polarization is

4

our proposed mechanism for the experimentally observed band reset and reduced flavor number [30, 31]. At larger D0, the IVC transitions into an SLP state. In Sec. VI B, we discuss how the bandstructures we find can give rise to the experimentally observed [30] additional sign change of the Hall density at sufficiently large D0. Our obtained behavior at || = 0, 2 also agrees with another experimental feature: the conductance is suppressed [30, 31] at  = 0 for both D0 = 0 and D0 > 0 while the suppression at || = 2 only sets in above a finite critical value of D0, which is consistent with the IVC (SLP) being semimetallic (insulating) at  = 0 and metallic (semimetallitc) at || = 2.
As discussed in detail in Sec. V F, the relative spinorientation of these orders in the two valleys depends on the sign of the intervalley Hund's coupling JH (see Eq. (3.16)), which is not part of the Hamiltonian for our Hartree-Fock computations; the value or sign of JH is not determined in our computations. For JH < 0, which is expected for Coulomb interactions, both the SLP and SP have the same spin polarization in the two valleys, while the IVC order parameter does not carry any spin.
As indicated in blue in Fig. 1, we investigate three different regimes of superconducting phases. For superconductivity (SC I) in the presence of spin polarization with or without additional IVC order, the order parameter will be a non-unitary triplet for JH < 0 and an admixed singlet-triplet phase [27] for JH > 0. For superconducting phases (SC II) close to or in the range 2 || 3 but not coexisting with additional particle-hole instabilities, we expect triplet (a singlet-triplet admixed phase) to dominate for JH < 0 (JH > 0). All of these superconducting states are consistent [27] with the observed [32] behavior in low to intermediate magnetic fields. Finally, our analysis indicates that a superconducting phase (if present) close charge neutrality (SC III) should be in a singlet state for JH < 0.
B. Organization of the paper
The remainder of the paper is organized as follows. In Sec. II, we introduce the model for MSTG we study, its symmetries, and establish the basic notation used in this work. We begin our discussion of correlated physics in the limit of vanishing displacement field in Sec. III, where we construct exact groundstates. These build the starting point for our HF numerics, see Sec. IV for  = 0 and Sec. VI for || = 2, and our analytical perturbation theory, presented in Sec. V. Furthermore, superconducting instabilities will be analyzed in Sec. VII. Finally, Sec. VIII contains a short summary and discussion of results. Details of our analysis are provided in a set of appendices, labelled Appendix A through H.

II. MODEL AND SYMMETRIES
In this section, we introduce the interacting model we consider in this work, which consists of a continuum model to describe the moiré bands supplemented by Coulomb repulsion. We further discuss its symmetries and define the notation used in the remainder of the paper.

A. Continuum model and symmetries

MSTG is constructed from three parallel sheets of graphene where the top (l = 1) and bottom (l = 3) graphene layers are aligned with one another and the middle (l = 2) layer of graphene is twisted at a relative angle  with respect to the top and bottom layers, as shown in Fig. 2(a). To compute the non-interacting band structure, we employ a continuum-model description, which is just a three-layer extension of the frequently applied continuum model for TBG [16­18]. Denoting the electronic creation operator for an electron at
position r  R2, in sublattice  = 1, 2, layer l = 1, 2, 3,
valley  = ±, and of spin s =,  by cr;,l,,s the Hamiltonian reads in the absence of a displacement field as [33­36]

H0F,u1ll = cr;,l,,s -ivF (l ), ·  cr; ,l,,s
r

+

cr;,l,,s(T,r), cr; ,l+1,,s + H.c. ,

r

(2.1)

where summation over repeated indices is implied, l = (-1)l/2, (=+)j = eiz/2j e-iz/2, with j representing Pauli matrices in sublattice space (throughout we will use the same symbol for Pauli matrices and their indices, i.e., sj, j are Pauli matrices in spin and valley space), and =- = -(=+). While the first term in Eq. (2.1) describes the Dirac cones of the two valleys,  = ±, of each individual graphene layer in the continuum expansion around their respective Kg and Kg points, the second line captures the tunneling between adjacent graphene layers parameterized by T,r (the direct hopping process between the outer two layers is neglected). As a consequence of the moiré superlattice, these tunneling matrix elements are modulated spatially. As is common, we focus on the lowest moiré-lattice harmonics for which symmetry allows for only two independent parameters, w0 and w1, in T,r. It can be written as [17]

T+,r = e-iq1r T1 + T2e-iGM 1 r + T3e-i(GM 1 +GM 2 )r (2.2)

and T-,r = (T+,r). Here q1 = k(0, -1), k =

2|Kg| sin(/2), lattice, GM 1 =

connects the K - 3k(1, 3)T

and K /2 and

points GM 2 =

of the moiré 3k(1, 0)T

5

are the basis vectors of the reciprocal lattice (RL) of the
moiré lattice, RL := { j=1,2 njGM j , nj  Z}. The ma-
trices Tj in sublattice space in Eq. (2.2) are given by

Tj = w00 + w1

0

j-1

-(j-1) 0

,



=

e-i

2 3

.

(2.3)

While rigidly rotated graphene layers correspond to w0 = w1, lattice relaxation [56, 57] leads to w0 = w1. We will here consider w0 as a free parameter and study the physics as a function of it.

As a result of the moiré modulations in Eq. (2.2),

the tunneling matrix elements between the layers cou-

ple momenta related by RL vectors, which reconstructs

the graphene cones of the first line in Eq. (2.1), leading

to a (technically infinite) set of bands; the band energies
will be denoted by n,(k), n  Z, where k is in the first
MBZ and we already used that Eq. (2.1) is diagonal in

the valley, , and trivial in the spin index, s; this makes

the band energies independent of spin and allows to label

them by their valley index.

MSTG is distinguished from other moiré systems, such

as TBG or twisted double-bilayer graphene, by a reflec-

tion symmetry h under exchange of the top and bottom layers of MSTG, with action h : cr;,l,,s  cr;,h(l),,s where h(2) = 2, h(1) = 3, and h(3) = 1. Since it acts trivially in all internal indices (, , s) and r, the

Hamiltonian (2.1) can be decomposed into sectors with

different mirror eigenvalues, h = ±1, by performing a unitary transformation, V  U(3), in layer space only,

cr;,l,,s = Vl, r;, ,,s. As was pointed out before [33] and detailed in Appendix A 1, the Hamiltonian in the

mirror-even sector (h = +1, = 1, 2) turns out to be that of TBG with an interlayer hopping renormalized by a factor of 2. In the mirror-odd sector (h = -1, = 3) the Hamiltonian is that of single-layer graphene (without

any moiré modulation). This can be clearly seen in the

spectrum shown in Fig. 2(b), which exhibits two almost-

flat TBG-bands (shown in red) per spin and valley and

unreconstructed Dirac cones at K (K ) associated with

the graphene sector of valley  = + ( = -). As such,

there are three Dirac cones at K (and three at K ), one be-

longing to the graphene sector of MSTG in a single valley

only and two Dirac crossings belonging to the TBG sec-

tor of both valleys. As can be seen, there are additional

remote bands of both subspaces due to back-folding into

the MBZ.

In addition to reflection symmetry, the Hamiltonian in

Eq. (2.1) has more point symmetries, forming the group

C6h: the model is invariant under three-fold rotational

symmetry C3z,

with

action,

C3z

:

cr



e c , i

2 3

z

z

C3z r

which is also an exact symmetry of the moiré lattice in

Fig. 2(a). While not an exact lattice symmetry, two-

fold rotation perpendicular to the plane, C2z, is a good approximate symmetry for small twist angles; in fact,

it is an exact symmetry of the continuum in Eq. (2.1)

which can be verified by applying its action, C2z : cr  x x c-r .
Besides these point symmetries, the model also ex-
hibits the following exact internal symmetries: since
there is no coupling between the valleys, it is invariant under a valley U(1) transformation, U(1)v : cr  eizcr. In combination with the absence of spin-orbit coupling,
it is further invariant under the separate spin-rotation
in each valley, forming the group SU(2)+ × SU(2)- with SU(2)± acting as cr  ei·s(0±z)/2cr. Furthermore, there is time-reversal symmetry, which is associated with the anti-unitary operator  with cr = xcr; unless stated otherwise, we will always refer to this form of
(spinless) time-reversal symmetry throughout the text,
although combinations with spin-rotations (spinful time-
reversal), s, and with U(1)v rotations, , will play a role further below. Since the mirror symmetry protects any
mixing between the graphene and TBG subspaces and
U(1)v any mixing between the two valleys, the aforementioned Dirac crossings at K and K are protected by the
combination C2z, exactly as in graphene and TBG.
Focusing on specific limits, there are also additional
internal symmetries, similar to TBG [46, 58, 59]: when w0 = 0, H0F,u1ll in Eq. (2.1) changes its sign, H0F,u1ll  -H0F,u1ll, if we apply the chiral symmetry operator C : cr  zLC cr where LC is a matrix in layer space given by LC = V diag(1, 1, -1)V . Therefore, w0 = 0 will be referred to as the chiral limit [58]. Among other con-
sequences for the interaction terms to be discussed be-
low, the band structure has to be symmetric about zero
energy at every given momentum k when w0 = 0, i.e., speck, = -speck,, with speck, = { n,(k), n  Z}.
Finally, when the additional rotation of the sublat-
tice matrices in the first line of Eq. (2.1) is neglected, l  =0, the "unitary particle-hole symmetry", previously discussed in TBG [46, 59], can be extended
to MSTG: defining the unitary operator P which acts as P r;l=1P  = z-r;l=2, P r;l=2P  = -z-r;l=1, and P r;l=3P  = iyy-r;l=3, one finds P H0F,u1llP  = -H0F,u1ll, showing that the spectrum must obey speck = -spec-k where speck = speck,. Since we will be focusing on small twist angles  below, we will always assume that l has been replaced by =0 in Eq. (2.1) when analyzing symmetries. We will also later set  = 0
in our numerics.
For the detailed form of the model and the action of
the symmetries in momentum space we refer the reader
to Appendix A 1 and A 2, respectively. A brief list of the
symmetries of H0 and when they apply can be found in Table I.
The primary interaction term we shall consider, in
Eq. (2.8), will preserve the symmetries of the contin-
uum model. However, we will also consider the conse-
quences of a Hund's coupling in Eq. (3.16), which will
break the SU(2)+ × SU(2)- symmetry down to a more

6

realistic SU(2)s (the group of simultaneous spin rotations in the two valleys).

B. Adding a Displacement Field

Motivated by recent experimental discoveries of electric-field-tunable correlated physics in MSTG [30­ 32], we now extend the model for MSTG in Eq. (2.1) and include a perpendicular displacement field D0. Finite D0 results in a potential difference between the top and bottom layers of graphene. Suppressing all indices except layer l, a displacement field is represented in the continuum model as

H0F,u2ll = D0

cr;l=1cr;l=1 - cr;l=3cr;l=3

r

(2.4)

and the full Hamiltonian becomes H0Full = H0F,u1ll + H0F,u2ll. The displacement field D0 breaks the mirror symmetry h, resulting in hybridization between bands in the TBG and graphene sectors; this hybridization can only take place between graphene and TBG bands of the same valley and spin flavor, as Uv(1) and spin-rotation symmetry [in fact the full SU(2)+ × SU(2)-] are preserved by H0F,u2ll.
Furthermore, when D0 is finite, the system retains C2z, C3z, leading to the point group C6. Time-reversal symmetry, , and, in the limit w0 = 0, chiral symmetry, C, also persist. However, the unitary particle hole symmetry P is no longer an exact symmetry for finite D0.
At the K (K ) point of the MBZ, the Dirac crossings which belong to the valley  = + ( = -) will hybridize as D0 increases with the graphene bands of the same valley which also exhibit a Dirac cone at the Fermi level; this results in the Dirac points, which were pinned at the Fermi level at D0 = 0, being pushed away from the Fermi level. As C2z symmetry is preserved for D0 = 0, these Dirac crossings cannot be gapped out. As a consequence of the absence of a graphene cone to hybrize with, the Dirac point of TBG in the other valley,  = - ( = +), remains pinned at the Fermi level as D0 increases. These features can be clearly observed in the band structure of MSTG with finite displacement field shown in Fig. 2(b).

C. Projected low-energy model
In order to make the analytical and numerical study of interactions feasible in the system, we restrict our Hamiltonian to a finite set of bands in the vicinity of the Fermi level. Going forward, we will denote the two bands closest to the Fermi level per spin and valley as TBG-like bands and the next two closest bands per spin and valley as graphene-like bands. All other bands at energies further away from the Fermi level will be referred to as remote bands. When D0 = 0, the TBG-like bands are

labeled by mirror symmetry eigenvalue h = +1 and can be identified exactly with the two flat bands of TBG. The graphene-like bands at D0 = 0 are identified exactly with the bands of the continuum model of graphene in the vicinity of the K and K points. For finite D0, the bands with different eigenvalues hybridize but we will retain our naming convention for the four bands closest to the Fermi level, i.e., the bands indicated in red in Fig. 2 are TBG-like bands.
Note that away from the K points, the graphene-like bands are technically identified with the first remote bands of TBG with h = +1 for D0 = 0 within this convention. In our analytical calculations below, however, we will restrict the analysis to the TBG-like bands in the full MBZ and to the graphene-like bands only in the vicinity of the K and K points where they retain their graphene-like identity. Denoting the associated creation operators in these two sets of bands by bk;p,,s and gk;p,,s, where k  MBZ is the momentum, p = + (p = -) labels the upper (lower) band in each sector,  is the valley, and s the spin quantum number of the electrons, the non-interacting Hamiltonian projected to these bands becomes

H0 =

WTBG (b,p),(k)bk;p,,sbk;p,,s

kMBZ

+

(g,p),(k)gk ;p,,sgk;p,,s.

kMBZ

(2.5)

Here the extra prime in MBZ in the second line indicates that we restrict the graphene-like degrees of freedom to the vicinity of the K and K points in our analytical calculations. Note that we further introduced the dimensionless parameter WTBG  [0, 1] that will allow us to organize the perturbation theory of Sec. V D in the TBGlike bandwidth. While the physical system corresponds to WTBG = 1, we define the flat limit as WTBG = 0, which will play an important role below. Note that the Hamiltonian in Eq. (2.1) realizes the flat limit exactly, (b,p),(k) = 0, only when w0 = 0,  is at the magic angle, and when D0 = 0.
In our numerics, we will keep all momenta of both sets of (in total 16) bands in Eq. (2.5) and continue to use gk;p,,s as creation operators for the second lowest set of bands throughout the MBZ. To check convergence, we will also study the impact of adding additional remote bands, as described in Appendix C 3.
In order to fix the phases of the wavefunctions of the TBG-like and graphene-like bands, we specify how they transform under the action of the various discrete symmetries discussed above or, equivalently how they act on the electronic operators bk;p,,s and gk;p,,s. While a thorough discussion can be found in Appendix A 2, these representations are summarized in Table I.
Based on these symmetry representations, one finds

7

300

w0/w1=0.70, D0/w1=0.00
valley +

200

valley -

w0/w1=0.70, D0/w1=0.50

Energy (meV)

100

0

100

200

300 K K'

K K'

(c)

(b)

(a)

FIG. 2: (a) Schematic of the geometry of MSTG. The top and bottom layers shown in red and green respectively are aligned, while the middle layer (blue) is twisted at relative angle  to the top and bottom layers. (b) Band structure of MSTG at D0 = 0 (left) and D0 > 0 (right) for w1 = 124 meV and twist angle  = 1.53 along the one-dimensional cut through the MBZ shown in (c). We represent the spin-degenerate bands in the two different valleys  = ± with solid ( = +) and dotted ( = -) lines. At D0 = 0, the band structure is given by that of TBG and single-layer graphene and we have colored the (two per spin and valley) quasi-flat TBG bands red. For D0 > 0, the bands of these two subsystems mix but we continue to label the two bands per spin and valley closest to the Fermi as "TBG-like" bands, indicated in red.

TABLE I: Summary of discrete single-particle symmetries (denoted S) of our model and when they apply (last column). For convenience of the reader and future reference, we show a redundant set of symmetries. We also indicate whether they are unitary or anti-unitary symmetries (second column) and whether they commute + or anti-commute - (third column) with the non-interacting Hamiltonian H0Full. Finally, we specify their action on the low-energy field operators in order to fix the phase of the Bloch states, using j to denote Pauli matrices acting on the upper/lower bands subspace.

S unitary [·, ·]± SbkS

SgkS

condition

C2z



+ 10b-k 10g-k

--

C3z



h



+ 00bC3zk 00gC3zk

+

00bk -00gk

-- D0 = 0





+ 10b-k 10g-k

--

s



+ s210b-k s210g-k

--





+ 20b-k 20g-k

--

C



-

32bk

32gk

w0 = 0

P



- -i32b-k i12g-k D0 = 0, 0

C2z 

+

00bk

00gk

--

C2zP 

-

22bk

i2gk D0 = 0, 0

and

(g,p),(k) = p E¯0g(k; ) + E¯1g(k; ) w0D0.

(2.7)

To illustrate the changes of the form of the band struc-
tures when symmetries are broken by w0 = 0 and D0 = 0, we introduced E¯jb(k) and E¯jg(k; ) which are functions of w0 and D0 that stay finite when w0, D0  0.
As can be seen, the two terms in the first row of
Eq. (2.6) just correspond to the TBG band structure
(with, w0 = 0, or without, w0 = 0, chiral symmetry). The second line shows that the hybridization with
the graphene bands for D0 = 0 distorts the TBG band structure in a way not present in TBG, which is related
to the D0-induced breaking of C2zP symmetry. One of these additional terms leads to superexchange pro-
cesses in the TBG-like bands that are not present in
TBG and will be discussed in Sec. V D. In Eq. (2.7), the first term, E¯0g(k; ), simply becomes the graphene Dirac dispersion for D0  0. We further see that the property (g,+),(k) = - (g,-),(k) is only violated if w0 and D0 are simultaneously non-zero. This is expected, as the graphene-like bands can only "feel" the broken chi-
ral symmetry if they hybridize with the TBG-like bands.
For the parameters in Fig. 2(b), this is a rather weak
effect around the Dirac cones.

that the dispersions are constrained to have the form

D. Interactions and form factors

(b,p),(k) = p E¯0b(k) +  E¯1b(k) w0 + p  E¯2b(k) D0 + E¯3b(k) w0D0

(2.6)

As our goal is to study the interacting behavior of MSTG, we next add interaction terms to the Hamiltonian. We assume that these interactions in the full con-

8

tinuum model are of the density-density form. Our full

interaction Hamiltonian thus reads as

H1Full

=

1 2N

V (q) : FqullF-uqll :

q

(2.8)

where : . . . : denotes normal ordering, N is the number of moiré sites, and Fqull is the density operator of momentum q of the continuum electron operators cr in
Eq. (2.1). Note q  R in the sum in Eq. (2.8) which is
not restricted to the MBZ. For our analytical discussions
below, we will not have to specify the explicit form of
V (q) but only use V (q) > 0 and V (q) = V (-q); con-
sequently, our analytical results will be valid regardless
of the details of the screening processes at high energies
and of nearby gates and/or substrates, that affect the
detailed form V (q). For our numerics, we will use the
single-gate-screened Coulomb potential:

1 - e-2|q|ds

V (q) =

,

2Amoiré 0 |q|

(2.9)

where we have normalized by the real space area of the

moiré unit cell Amoiré. We vary the screening length ds in our numerical calculations from ds = 10 to 80 nm and find relatively little dependence of the relative energies

between phases and no qualitative change in the ground states. We will therefore take ds = 40 nm as our default value. We also vary the dielectric constant from = 4

to = 15. We find the phase boundaries depend on , though no new phases emerge as is varied [the effect of varying interaction parameters is further discussed in Appendix C 3, especially Fig. 9]. Unless otherwise speci-

fied, we will take = 7. We note that the above interaction term has all the
symmetries of the continuum model introduced in Sec. II,

including the SU(2)+×SU(2)- symmetry. In the realistic system, there is a Hund's coupling, JH = 0, which breaks SU(2)+ × SU(2)- down to SU(2)s. We discuss the form of the Hund's coupling in Appendix F 5 and Eq. (3.16),

and will note its consequences in Sec. III C. Neglecting normal ordering and replacing Fqull 
~Fqull = Fqull-const.×q,0 in Eq. (2.8) leads to a new form of the interaction, H1Full, which, however, can be rewritten as H1Full by a redefinition of the chemical potential (and energy reference point). This is not the case any-
more after projecting Fqull and ~Fqull in H1Full and H1Full, respectively, to a finite set of bands of H0. As described in more detail in Appendix A 3, we follow [46, 59] and
rewrite the interaction before projection such that it ex-
hibits particle-hole symmetry with respect to the charge

neutrality point before and after projection. Denoting
the electronic creation operators for band n, of valley , spin s, and with momentum k  MBZ by fk;n,,s, the projected interaction becomes

1 H1 = 2N V (q)q-q,
q

(2.10a)

with the symmetrized density operators

q =
kMBZ

fM BZ(k+q)Fk,q fk

-

1 2

q,Gtr(Fk,G) .

GRL

(2.10b)

Here MBZ(k) := k-Gk  MBZ for the unique reciprocal lattice vector Gk  RL. We suppressed all indices of fk and fk, which should be viewed as column and row vectors in band, valley, and spin space and introduced the matrix-valued form factors Fk,q, which contain all the microscopic details of the wavefunctions of the bands of H0 [see Eq. (A25) for a formal definition]. Note that Eq. (2.10) holds for any subset of bands that we want to keep. As already discussed in Sec. II C above, we will only keep the TBG-like bands and graphene-like bands (around the K/K' points) in the analytics, while we will allow for more bands in the HF numerics.
We refer the interested reader to Appendix A 3, where a detailed discussion of constraints on Fk,q resulting from symmetries, Hermiticity, and the structure of H0 can be found, and here only state a few properties of the form factors that we will explicitly refer back to in the main text. First, as a consequence of U(1)v and spin rotation symmetry, the form factors can only have non-diagonal matrix structure in band space,

(Fk,q)(n,,s),(n ,,s) = s,s ,

Fk,q

.
n,n

(2.11)

In accordance with our notation in Eq. (2.5), we will use the multi-index notation n = (t, p) where the "type" t distinguishes between the graphene-like, t = g, and TBGlike, t = b, bands and p = + (p = -) labels the upper (lower) band; for instance, for the electronic operators, it holds fk;(b,p),,s = bk;p,,s and fk;(g,p),,s = gk;p,,s. As a consequence of the h symmetry for D0 = 0, the form factors become block-diagonal in the sectors with different h eigenvalue. As such, Fktt,q defined via

Fktt,q

= s,s ,

(p,,s),(p , ,s )

Fk,q (t,p)(t ,p ) (2.12)

obeys

Fktt,q  t,t , for D0 = 0.

(2.13)

Consequently, the entire interacting Hamiltonian H0+H1 preserves the charge in the graphene and TBG system separately. This leads to simplifications, which will be exploited in Sec. III below. For D0 = 0, this is not the case anymore, as the form factors in Eq. (2.12) and, hence, the density operators in the interaction will not be diagonal in the t index and scatter electrons between the two different types of bands.
In the limit D0 = 0, one can also compute the form factors in the graphene sector analytically [see Eq. (A39) for

9

the full expression]. Most importantly for our purposes here, one finds that
Fkg,gG = G,000s0, G  RL, for D0 = 0, (2.14)
where 0 are Pauli matrices in the "band space" (with indices p = ±). Here only the G = 0 component is finite, which is related to the fact that the graphene bands do not "feel" the moiré superlattice for D0 = 0.

III. EXACT GROUNDSTATES AT D0 = 0
We begin our discussion of the interacting physics in the decoupled limit, defined as D0 = 0, where all bands can be labeled by their mirror eigenvalue h = ±1, and the low-energy bands are those of TBG and single-layer graphene. While one might intuitively expect that the presence of the additional graphene Dirac cones, which have a much lower density of states than the (almost) flat bands close to the magic angle of TBG, is not strong enough to change the symmetry of the correlated insulating phase of TBG, it is a priori not clear whether the density-density coupling between the two subsystems can also induce the same symmetry-breaking order (and potentially gap out) the graphene Dirac cones. It is further not clear whether exact interacting ground states of MSTG can be identified in certain limits, similar to TBG [46, 60, 61]. These aspects will be addressed in this section.

A. Hamiltonian and construction of eigenstates

To this end, let us focus on the flat limit, WTBG = 0, and postpone the perturbative treatment of the finite TBG bandwidth to Sec. V D. From our discussion in Sec. II, we can read off that the low-energy Hamiltonian of MSTG in the flat-decoupled limit is given by

HFD = Hg + Hb + Hgb,

(3.1)

consisting of three terms: Hg is the Hamiltonian of (both valleys of) single-layer graphene with Coulomb repulsion [see Eq. (B4)], Hb the interacting Hamiltonian of TBG in the flat limit, given by

Hb = 1 2N

V (q)bqb-q

q

(3.2)

where we defined the projected subsystem density operators

tq =
kMBZ

tMBZ(k+q)

Fktt,q

1 tk - 2

q,Gtr(Fktt,G)

GRL

(3.3)

where t = g, b. Finally, the last term in Eq. (3.1) describes the coupling between the two subsystems via a density-density interaction,

Hgb =  N

V (q)g-qbq,

q

(3.4)

where the additional prefactor   [0, 1] has been intro-

duced to adiabatically turn on the Hgb interaction (the

physical system corresponds to  = 1).

For  = 0, the Hamiltonian is just the sum Hg + Hb

of the two commuting subsystem Hamiltonians. So its

eigenstates are just given by (all combinations) of the in-

dividual eigenstates of graphene and TBG with the cor-

rect particle number: let us fix a certain integer filling

b = 0, ±1, ±2, ±3, ±4 of the TBG system. Then the

graphene system will be at a corresponding filling, which

we write formally as g = g(b) and its ground state will be a semimetal with (g = 0) or without (g = 0) dop-

ing, that exhibits correlations but does not spontaneously

break any symmetries; these properties are well estab-

lished (theoretically and experimentally) for graphene

[62]. Let us denote the ground-state of the graphene

system at filling g = g(b) by |g0(b) and its (gap-

less) excited states with the same particle number by

|gj (b) , relations

j > 0. in the

In the hypothetical graphene subspace,

absence |g0(b)

of any cor(|gj (b) )

would just be Slater-determinant state(s) with the Dirac

cones filled up to to the chemical potential (and some

additional particle-hole excitations).

Exact ground states of the flat-band TBG Hamiltonian

in Eq. (3.2) have been discussed previously [60], which

we will very briefly review here using our notation, in

order to set the stage for the extension to MSTG. Upon

defining new operators according to [referred to as "chiral

basis" in [59]; in this basis the chiral form factors, see

Eq. (B7), are diagonal]

~bk;c,,s = Uc,pbk;p,,s,

1 U=
2

1 -i , 1i

(3.5)

consider the set of states

|b0 (b)

c

=

~b
k;c,jcc ,scjc

|0b

kMBZ c=± jc=1

(3.6)

with arbitrary combinations of occupied flavors {j±, s±j } such that + + - = 4 + b. It was shown in [60] that

bq |b0 (b) =

q,GRG |b0 (b) ,

GRL

(3.7)

with RG = b k tr[F bb(k, G)]/8 when w0 = 0, i.e., in the chiral limit. As such, all of these states are exact eigenstates of Hb in Eq. (3.2). Ref. 60 further showed that these states will always be ground states of Hb for

10

b = 0; the same holds for all other integer b as long as the flat-metric condition,

Fkb,bG = 1f (G),  k, G,

(3.8)

is not violated by a significantly large amount. Further-
more, when turning on w0 = 0, the subset of states in Eq. (3.6) with j+ = j- and s+j = s-j , which are necessarily at even integer b, still obey Eq. (3.7) and remain ground states of Hb [unless b = ±2 and Eq. (3.8) is sufficiently violated].
Having established the spectrum of HFD in Eq. (3.1) for  = 0, let us next discuss what happens once  is
turned on. Using the fact that the graphene form factors obey Eq. (2.14), we show in Appendix B 1 that Hgb can
be rewritten in the low-energy spectrum of MSTG as

Hgb = 1 N

V (q)g-q bq -

q,GRG +E0(b),

q

GRL

(3.9)

where E0(b) is just a constant energy. So we immedi-

ately see that the property (3.7) of all of the exact TBG

states |b0(b) defined above, implies

Hgb |gj (b) |b0 (b) = E0(b) |gj (b) |b0 (b) . (3.10)
Consequently, all of the states |gj (b) |b0(b) remain exact eigenstates of the full MSTG Hamiltonian HFD in
the flat-decoupled limit, at arbitrary . Whether the states |g0(b) |b0(b) will also remain
the exact ground states is a more subtle question: since
the states |b0(b) break symmetries, HFD|=0 will have a gapless Goldstone spectrum. In principle, an arbitrar-
ily small  could lower the energy of some of those states below that of |g0(b) |b0(b) . However, we show in Appendix B 2 that is not the case if b = 0 or w0 = 0 or
Eq. (3.8) holds. Therefore, a finite  > 0 is required before |g0(b) |b0(b) cease to be the exact ground states.

B. Discussion of ground states
Taken together, we have shown that the states |gj (b) |b0(b) where |gj (b) is just the spectrum of single-layer graphene at filling g = g(b) and |b0(b) is any of the states in Eq. (3.6) are exact eigenstates of the MSTG Hamiltonian in the chiral-flat-decoupled limit (w0 = WTBG = D0 = 0), HFD|w0=0, for any integer b. Furthermore, there is a finite region of  for which |g0(b) |b0(b) will remain a groundstate of MSTG if |b0(b) is a groundstate of TBG (recall that |b0(b) is guaranteed to be a groundstate of TBG for b = 0 without further assumptions while it requires that the flatmetric condition is not too strongly violated for b = 0). Finally, away from the chiral limit w0 = 0, the subset of states in Eq. (3.6) with j+ = j- and s+j = s-j are known

to be ground states of TBG in the flat limit for integer b and if the flat metric condition holds [60]. Our analysis shows that these states remain exact eigenstates for  = 0 and also ground states for || < c > 0 in the nonchiral-flat-decoupled limit (WTBG = D0 = 0, w0 = 0).
In all of these limits, we see that the graphene subsystem retains its (correlated but symmetry-unbroken and, depending on b, doped) semimetallic properties for all integer filling fractions b. This is consistent with experiment, where quantum oscillations indicate a dispersive Dirac cone at D0 = 0 [30, 31]. Furthermore, the exact eigenstates established above will be used as our starting point for further analytical considerations in Sec. V and their product-state nature motivates our HF numerical study of the problem in Sec. IV. Both numerics and analytics will complement the discussion presented above by (i) validating the stability of the Dirac cones at D0 = 0 in schemes that do not rely on  being small and (ii) by tuning away from the exactly solvable limits (WTBG = D0 = 0) and (iii), for the numerics, including additional remote bands.

C. Resultant candidate states

To build the foundation for these additional analytical and numerical computations, we will use the exact (and highly degenerate) ground states established above in the chiral-flat-decoupled limit to construct a finite set of candidate phases and their respective order parameters.
We first define the correlation matrix Pk with elements

(Pk)(t,p,,s),(t ,p , ,s ) := 0|fk;(t,p),,sfk;(t ,p ), ,s |0 (3.11)

to characterize a given ground state |0 of MSTG. Her-

miticity implies Pk = Pk. As is common, we further write

Pk

=

1 2

(1

+

Qk)

and

will

use

Qk

as

our

"order

param-

eter" to characterize the (potentially symmetry-broken)

structure of |0 . It must obey

Qk = Qk,

1 N

tr [Qk] = b + g  .

k

(3.12)

As we have seen above, the ground states of MSTG in the flat-decoupled limit (WTBG = D0 = 0) obey

(Qk)(t,p,,s),(t ,p , ,s ) = t,t Qtk (p,,s),(p , ,s ) , (3.13)

i.e., do not exhibit any "coherence" between the graphene and TBG sectors. This is expected as the presence of h requires any order parameter to be either even (diagonal in t space) or odd (off-diagonal) under h; due to the large density of states in the TBG sector, we expect the former to dominate. Once D0 = 0, mixing is allowed, as we will see in our numerics below and discuss in detail analytically in Sec. V B.

11

TABLE II: We list the different candidate phases in the TBG-like subspace, constructed as the discrete set of states that are part of the large manifold of exact ground states in the chiral-flat-decoupled limit, see Sec. III, but transform under the irreducible representations of the symmetries of the real system. Here 1 (3) is the singlet (triplet) representation of SU(2)s and 0 (1) the one(two)-dimensional representation of U(1)v. For future reference in Sec. VII, we list the behavior (± denoting even/odd, and  indicating absence) under both spinful (s), and valley () time-reversal symmetry, see Table I. The last two columns indicate which states are Hund's partners [27], i.e., transform into each other when reversing the sign of the Hund's coupling JH while being exactly degenerate in the SU(2)+ × SU(2)--symmetric limit, and which sign of JH favors the respective state.

Type

Short form Qb

Qb

SU(2)s U(1)v C2z s/ Hund's part. JH

spin polarized

SP

00s

00s

3

0  -/

SVP

<0

valley polarized

VP

0zs0 0zs0

1

0  -/-

--

0

-even IVC

IVC+

0x,y s0 0x,y s0

1

1

 +/-

SIVC+

>0

-odd IVC

IVC-

y x,y s0 z x,y s0

1

1

 -/+

SIVC-

>0

-odd, sublattice pol./Hall

SLP-

y0s0 z0s0

1

0  -/-

--

0

-even, sublattice pol./valley Hall

SLP+

yzs0 zzs0

1

0  +/+

--

0

-odd, spin-sublattice-pol./spin Hall

SSLP-

y0s z0s

3

0

 +/

SSLP+ < 0

spin-valley polarized

SVP

0zs 0zs

3

0  +/

SP

>0

-even, spin-pol. IVC

SIVC+

0x,ys 0x,ys

3

1  -/

IVC+

<0

-odd, spin-pol. IVC

SIVC-

yx,ys z x,ys

3

1  +/

IVC-

<0

-even, spin-subl. pol./spin-valley Hall SSLP+ yzs zzs

3

0

 -/

SSLP- > 0

Furthermore, the analysis above reveals that the
ground state in the TBG sector will be of the form of Eq. (3.6). For instance, for b = 0 with j+ = j- = (-1)j and s+j = s-j = , j = 1, 2, it holds Qbk = 00sz where Qbk = U QbkU T is the order parameter Qbk in Eq. (3.13) in the TBG subspace transformed to the chiral basis of Eq. (3.5); in the basis of Eq. (3.11), it holds Qbk = 00sz, which we will refer to as spin polarized (SP) state. Here
and in the following we will use j (j) to denote Pauli matrices in the band-space with index p (in the chiral
basis with index c). Besides the SP state, Eq. (3.6) de-
scribes many other possible ground states, that are ex-
actly degenerate in the chiral-flat-decoupled limit. A sys-
tematic way of seeing this proceeds by noting that the
U(4) × U(4) identified [46, 59, 61] for TBG also persists
as a symmetry of MSTG in chiral-flat-decoupled limit
[36]; this immediately follows from the structure of HFD in Eq. (3.1). We will here refer to this symmetry group
as (U(4) × U(4))b,cf and its action is particularly simple in the chiral basis [59],

bk  U bk,

U = ei

j=0,3

. 3
µ,µ

=0

j,µ,µ

j µsµ

(3.14)

The form of these transformations is readily inferred from
Eq. (B8) which indicates that all U with [U , 3] = 0 will leave HFD invariant. Under Eq. (3.14), the order parameter defined above transforms as Qbk  U QbkU T , which allows us to generate the entire (continuous) set of
exactly degenerate ground states from one "seed" state, such as the SP state, Qbk = 00sz. Since this seed state and U commute with 3, we know that [Qbk, 3] = 0 for

all ground states. Further noting that (Qbk)2 = 1 (phys-
ically related to the Slater-determinant nature), we can,
thus, summarize the properties in the original basis as

Qbk = Qb, [Qb, 2] = 0, at charge neutrality.

(Qb)2 = 1,

tr Qb = 0, (3.15)

The actual Hamiltonian of MSTG is not in the chiralflat-decoupled limit and does not exhibit an exact (U(4)× U(4))b,cf symmetry. Intuitively, this can be thought of as generating an easy axis in this multi-dimensional space of degenerate states, favoring a specific (subspace of) state(s) in Eq. (3.15). While energetics is required to decide which phase is ultimately preferred by the system-- the aim of the subsequent sections--we can use symmetries to derive the discrete and finite set of possible "candidate states": to this end, we impose only U(1)v and global spin rotations, SU(2)s, as exact continuous symmetries. We then know that the candidate order parameters must transform under the irreducible representations of these symmetry groups (and be even or odd under the exact discrete symmetries C2z and ), leading to the 11 options listed in Table II. In order to connect smoothly to the limit D0  0, we take here Qgk = -z in the graphene subspace but emphasize that these order parameters are only used to define the different states and characterize their symmetries; for our numerical and analytical discussion below, they are only taken to be the starting point and we will allow for (and also find) mixing between the TBG-like and graphene-like sectors when D0 = 0 as well as momentum dependence in Qk.

12

Finally, we point out that the model introduced in Sec. II, and which we study energetics in below, has an exact SU(2)+ × SU(2)- symmetry. Therefore, certain pairs of states, which we call Hund's partners following [27], have to be exactly degenerate, see Table II. As we noted earlier, in the realistic system, there is a non-zero intervalley Hund's coupling, JH = 0, which will break SU(2)+ × SU(2)- down to SU(2)s, albeit weakly, and favor one member of each of the pairs over the other. For most of the following study we will focus on the SU(2)+ × SU(2)- limit and, hence, can, without loss of generality, restrict the discussion to the first 7 states above the line in Table II. However, one has to keep in mind that the real system will realize only one state of each Hund's pair, which will depend on the (unknown) sign of JH and precise form of the Hund's coupling [see Appendix F 5 for more details]. Taking, for concreteness, the intervalley Hund's coupling to be of the form

H2

=

JH N

S

+ q

·

S-q

,

S±q

=

1 2

ck+q

(1

±

z

)ck

,

(3.16)

q

we can, in the chiral-flat-decoupled limit, uniquely associate a single state of each Hund's pair with a given sign of JH ; this is indicated in the last column in Table II.

IV. HARTREE-FOCK NUMERICS
As it facilitates the presentation of the results, we will begin the discussion of correlated phases away from the chiral-flat-decoupled limit with the HF numerics and postpone the complementary analytics to Sec. V. Furthermore, we will first focus on the charge-neutrality point,  = 0.

A. Hartree-Fock Method
In the HF approximation, one focuses on Slaterdeterminant states |[Pk] characterized by the correlation matrix Pk as defined in Eq. (3.11). Consequently,
it holds Pk2 = Pk or, equivalently, Q2k = 1; this is also
true for the exact candidate ground states constructed in Sec. III C for the chiral-flat-decoupled limit and, hence, the HF approximation is expected to provide reliable results.
The goal of our HF numerics will be to determine the optimal Qk that yields the lowest energy expectation value with respect to the interacting Hamiltonian for MSTG introduced in Sec. II. To be more specific, we start from the full Hamiltonian, H = H0F,u1ll + H0F,u2ll + H1, consisting of the continuum model in Eq. (2.1), the displacement-field term in Eq. (2.4), supplemented by the density-density interaction in Eq. (2.8), and perform a mean-field decoupling. Using the same notation as

in Eq. (2.10b), the resulting HF mean-field Hamiltonian reads as

HMF =

n, (k)fk;n,,s fk;n,,s

kMBZ

+

fk [hH[P ](k) + hF[P ](k)] fk

kMBZ

1 -
2

Tr hH[P ](k)PkT + hF[P ](k)PkT ,

kMBZ

(4.1)

where the Hartree and Fock contributions to the meanfield Hamiltonian can be written in terms of the projector Pk as

1 hH[P ](k) = N

V (G)Fk,G

Tr Fk ,GPk

GRL

k MBZ

(4.2)

and

1 hF[P ](k) = - N

V (q)Fk,qPkT+qFk,q,

q

(4.3)

respectively. This form of the HF mean-field Hamiltonian is valid for an arbitrary number of bands kept. In the numerics presented here, we will focus on the four bands for each spin and valley flavor that are closest to the Fermi level, which contains the graphene-like and TBGlike bands we focus on in the analytics. We verify for representative values of D0 and w0 that the solutions we obtain are stable against doubling the number of remote bands in our self-consistent calculation in Appendix C 3.
As pointed out in several HF works on TBG [45­48], it is important to note that the continuum model H0F,u1ll already references electron-electron interactions in the experimentally determined values for microscopic model parameters and therefore we must define a reference subtraction projector P0 such that interactions will not be double counted in our numerics. We here choose P0 such that the projected low-energy Hamiltonian exhibits the manifestly particle-hole symmetric interaction in Eq. (2.10). As shown in [59] for TBG, this ansatz has the natural interpretation of effectively taking into account the HF contributions from all remote bands that have been projected out.
To determine the optimal Pk, we start with an initial guess for it with the symmetries of a given candidate order in Table II. We then use the HF Hamiltonian in Eq. (4.1) to compute a new projector Pk and iterate until Pk converges. More details on our iterative HF procedure and subtraction point are given in Appendix C 2.

B. Band Structures
In this section, we will discuss the band structures of the self-consistent solutions we find at D0 = 0 for each

Energy (meV)

Energy (meV)

Energy (meV)

Energy (meV)

Energy (meV)

100 wSy0m/wm1=et0ry.7U3n,broDke0/nw1=0.00

wSy0m/wm1=et0ry.7U3n,broDke0/nw1=0.50

50

0

50

100

100 IVC -

IVC -

50

0

50

100

100 SP

SP

50

0

50

100

100 VP

VP

50

0

50

100

100 SLP -

SLP -

50

0

50

100

K K'

K K K'

K

FIG. 3: HF band structures in the limit D0 = 0 (left) and nonzero D0 (right) as obtained from Eq. (4.1) for the optimal Pk in the respective symmetry-breaking channel defined in Table II. We show only the states which are either ground states or subleading energy states for some region of our phase diagram, with a full set of band structures available in Appendix C 3. Each band of the HF Hamiltonian is colored according to the expectation value of the mirror symmetry operator within each band as a function of k, with the expectation value ranging from -1 (red) to +1 (blue).

of the states in Table II and how these band structures evolve as D0 increases.

13

0.09

SLP (IVC-)

0.18

0.27

IVC-

0.36

(SLP)

w0 (units of w1)

0.45

0.55

IVC-

0.64

(SPVP)

0.73

0.82

0.0

0.1

0.2

0.3

0.4

0.5

D0 (units of w1)

FIG. 4: Phases obtained by self-consistent HF method as a function of w0 and D0. Both the leading instability (red) and the subleading ones (black, in paraenthesis) are shown. The phases are identified by the symmetries they break, see Table II, and representative band structures can be found in Fig. 3. We show only one state as a representative of each pair of Hund's partners which are degenerate in our Hartree-Fock procedure. We label the nearly degenerate SLP+, SLP-, SSLP+, and SSLP- phases with "SLP", though note the preference in our numerics is for the SLPstate, from a Hartree contribution.

1. Self-Consistent Band Structures at D0 = 0
At D0 = 0, we can separately describe the behavior of the graphene-like and TBG-like bands for each type of state, since, for all states we consider, the graphene-like bands near the Fermi-level at D0 = 0 do not mix with any other bands near the K and K points. They have a bandwidth larger than the scale of Coulomb interactions. For this reason, the Dirac cones of the graphene-like bands prefer a Qgk which equally fills the lower bands of the continuum model and preserves all point group symmetries for every class of solution we study. The Dirac cones thus remain semimetallic and are, in this sense, "spectators" at D0 = 0, in agreement with Sec. III. On the other hand, the TBG-like bands have a bandwidth (5-10 meV) smaller than the scale of the Coulomb energy at D0 = 0 and therefore become insulating as they are polarized for a given symmetry-breaking Pk.
We find converged solutions for each ansatz in Table II and show representative band structures for those states which have the lowest energy in the leftmost panels of Fig. 3. Additional band structures for solutions not shown in Fig. 3 can be found in Appendix C 3. We note the similarity of the IVC- band structure in the TBGlike bands to the band structure of the ground state in Ref. 46.

14

2. Self-Consistent Band Structures for D0 > 0
All the solutions described for D0 = 0 are insulating in the TBG-like bands and semimetallic in the graphene-like bands. However, as D0 increases and the TBG-like and graphene-like bands begin to hybridize, the graphene-like bands begin to play a more important role.
For the spin and valley polarized states (SP and VP) which preserve C2z and U(1)v, the hybridized Dirac crossings are protected (and pinned to the K/K points due to C3z), meaning if the TBG-like bands acquire a spin or valley polarization, the Dirac crossings of the graphene-like bands must connect to these polarized bands as they are pushed away from the Fermi level. Away from the K points of the MBZ, the graphene-like bands will likely still prefer to fill the lowest bands of the non-interacting model. Therefore, the VP and SP are generically expected to be metallic for D0 > 0. This is indeed what we find, as shown in the right panels for the SP and VP states in Fig. 3.
The band structures of the IVC± states also retain Dirac crossings at the K/K points for nonzero D0, as they exhibit C3z and a k-local anti-unitary symmetry that commutes with C3z (for the IVC+ and IVC- these are C2z and C2z, respectively). However, unlike the SP and VP states, the IVC± states also preserve SU(2)s and C2z, which pin the Dirac crossings at the Fermi level at  = 0. We therefore expect the intervalley coherent states will remain semimetallic as D0 increases. We observe this to be true for the self consistent solutions, as can be seen in the right IVC- panel in Fig. 3.
The last class of states are the sublattice-polarized, C2z-symmetry-breaking states (SLP±, SSLP-) which preserve U(1)v. We expect these states will generally be insulating for nonzero D0 as there are no protected Dirac crossings and both the TBG-like and graphene-like bands can be gapped out. This is indeed seen in our numerics, with insulating band structures for the SLP+, SLP-, and SSLP- states. The band structure of the SLP- state is shown in Fig. 3.
C. Energies and phase diagram
Having established the band structures of the different possible phases, we next turn to their relative energetics and discuss which states are expected to be favored energetically.
The evolution of the energies of each of our selfconsistent solutions as a function of w0 and D0 is shown in Figs. 5 and 6. As mentioned before, at D0 = 0, the Hamiltonian of the system is given by the sum of the Hamiltonian of TBG and that of graphene, both with Coulomb interactions, which are further coupled to each other by a density-density interaction. While we only

constructed exact eigenstates in Sec. III for the chiralflat-decoupled limit, we expect a similar picture when w0, WTBG = 0: given the bandwidth of the graphenelike bands is large compared to the scale of the Coulomb interactions, we expect the graphene bands will prefer to fill the lower bands of the continuum model. As the graphene density of states is small compared to that of the flat bands of TBG, it should not crucially alter the ground state in the TBG sector--at least close to the magic angle. Based on previous work [46, 48], we thus expect that the IVC- state has the lowest energy for D0 = 0 (though with a smaller energy difference than in previous works between our IVC- and spin polarized phase due to our choice of subtraction point). Both expectations for the graphene-like and TBG-like bands are confirmed by our numerics which finds the IVC- state has the lowest energy of all our candidates for all values of w0 studied in the decoupled limit, D0 = 0. We will also recover these observations analytically in Sec. V.
The lowest energy state for D0 = 0 cannot be directly inferred from knowledge of the physics of TBG as a finite D0 induces hybridization between the TBG-like and graphene-like bands near the K/K points of the MBZ; it further breaks symmetries in the TBG sector and, hence, changes the basic form of its dispersion and interaction matrix elements (form factors). Consequently, it is not clear whether the ground state in the TBG-like and/or graphene-like sector changes with increasing D0. As can be seen in Figs. 5 and 6 as well as in the corresponding phase diagram in Fig. 4, we find within HF that the IVC- remains the ground state for an extended range of D0, which increases with w0. For reference, the range of D0 in Figs. 4, 5, and 6 when combined with additional studies at larger D0 in Appendix E corresponds roughly to the range of displacement fields studied experimentally in Ref. 30.
Beyond the critical value of D0 for the IVC-, the sublattice-polarized (SLP) group of states (SLP±, SSLP-) dominates. While these latter three states are almost degenerate for all parameters D0, w0 studied, there is a slight preference towards the time-reversal-odd SLP- (quantum Hall), predominantly associated with the Hartree energy. While a SP or VP phase does not appear as a ground state in Fig. 4, we find the energetically close SP or VP states are either the second or third lowest energy state to the IVC- and SLP group across the phase diagram. In the next subsection, we will recover many of these features analytically by investigating the aforementioned energetic contributions perturbatively.
V. ANALYTICAL PERTURBATION THEORY
Finally, we complement the HF numerics with an analytical study of the behavior of the energies and the order

w0 (units of w1)

15

0.09 0.18 0.27 0.36 0.45 0.55 0.64 0.73 0.82 0.09 0.18 0.27 0.36 0.45 0.55 0.64 0.73 0.82
0.0

IVCSLP+ 0.1D0 (0u.n2its 0o.f3w10).4

0.5 0.0

IVC+ SLP0.1D0 (0u.n2its 0o.f3w10).4

0.5 0.0

Filled Lower Bands E p.m. (1m0.e0V) Energy scale ×10
7.5

5.0

2.5

Valley Polarized

0.0

2.5

5.0

7.5

0.1D0 (0u.n2its 0o.f3w10).4 0.5

10.0

w0 (units of w1)

FIG. 5: Energies obtained from self-consistent HF calculations for selected candidate states of Table II. All energies shown are relative to the energy of the self-consistent SP solution and measured in meV per moiré unit cell. We take = 7, ds = 40 nm, and w1 = 124 meV and 4 bands per spin and valley. We find the IVC- is lower in energy than the SP state for all values of w0 and D0. The IVC+ state is always higher in energy than the SP in agreement with Table III. The VP state is nearly exactly degenerate with the SP state, even as D0 increases. Both the SLP+ and SLP- states have a region of energy lower than both the SP and IVC- states at small w0 and large D0. While they appear nearly degenerate, a small Hartree contribution favors the time-reversal odd SLP- over the SLP+ state. However, this difference between the two sublattice polarized states (< 1 meV) is not visible in the energies we show.

(a)
8

w0/w1=0.27

w0/w1=0.55

(b) IVC - at wp0o/iwn1t=0I.V73C + at point SIVLPC +- aatt ppooinintt ISVLCP+- aatt ppooiinntt SLSPP

Energy p.m. (meV)

6

4

2

0

IVC - at K point IVC + at K point SIVLPC +- aattKKppooinintt ISVLCP+- aatt KK ppooiinntt SLSPP

2 IVC-

4

IVC+

Valley Polarized

6

Spin Polarized

Sublattice Polarized

8 0.0 0.1 0.2 0.3 0.4 0.5 0.0 0.1 0.2 0.3 0.4 0.5 0.0 0.1 0.2 0.3 0.4 0.5

D/w1

D/w1

D/w1

FIG. 6: (a) Linecuts for fixed w0 showing the energy of our self consistent solutions relative to a SP state as a function of D0. We use the same parameters as in Fig. 5. Note that the SLP± and SSLP- are not exactly degenerate, as discussed in the main text, but are plotted as a single line here since the splitting is too small to be visible on the scale of the plot. (b) Matrix form of our converged IVC- and SLP- orders Pk for k near the  point and near the K point. The matrix structure of Pk is organized such that the largest block outlined in blue denotes spin flavor, the next largest block outlined in red denotes valley flavor, the green block denotes upper and lower bands in the continuum model and the final two boxes denote the graphene-like and TBG-like band in the upper-band box and the TBG-like then graphene-like bands in the lower-band box.

parameters of the degenerate ground states of the chiralflat-decoupled limit (w0 = WTBG = D0 = 0) of Sec. III and Table II when turning on WTBG, D0, and w0. We first investigate the ordering tendencies of the graphenelike bands (Sec. V A) and their mixing with the TBG-like

bands (Sec. V B), before addressing the energetic contributions coming from the D0,w0-induced distortion of the TBG-like form factors (Sec. V C) and band structure (Sec. V D).

16

A. Ordering in the graphene-like bands

Since the graphene and graphene-like bands in

Fig. 2(b) are highly dispersive, starting from a flat-band

limit, as is natural for the TBG-like sector, is not possi-

ble for the graphene(-like) bands. Since their bands are

coupled, without any band gap, to the TBG-like bands

with a high density of states, treating the interactions

between the two subsystems as a perturbation is also not

necessarily controlled for realistic parameters. Instead,

we here use a different control parameter: based on the

band structure, we expect the effect of the TBG(-like)

bands on the graphene(-like) bands to be the strongest

around the K/K points and very weak away from it.

To formalize this, let us assume that the graphene-like

bands remain in their filled-lower-bands state away from

the K/K points, but allow them to be "deformed" in the

region A = A+  A- of the MBZ, where A+ (A-) are

simply connected and centered around the K (K ) point.

As explained in detail in Appendix F 3, we study the

energy of symmetry-allowed ordering tendencies of the

graphene-like bands for the different candidate phases in

Table II in the limit where the area of A is small (com-

pared to that of the MBZ).

To illustrate this procedure, let us consider the SP

state. Since the TBG-like bands break spin-rotation sym-

metry, it is natural to assume that the same happens to

the graphene-like bands in A; postponing the discussion

of mixing between the bands to Sec. V B, this means that

(Qgk), in Sec.

= , 0s, III C, while

k  A (Qgk),

,

in =

the notation introduced -, 3 for all other k.

Here we already anticipated (as is also readily checked

within this formalism) that it is energetically more fa-

vorable if only the graphene valley  = + ( = -) that is

at low energies in the region A+ (A-) exhibits spin polarization. Denoting the linear size of A± by k > 0, the

structure of the energetic change associated with the de-

formation of the graphene order is asymptotically given

by

E  d1|D0|(k)2 + d2(k)3 + Igg(k)3 - IgbD02(k)2

(5.1)

for small k and D0; here, d1,2 > 0 are positive constants (independent of k and D0, but dependent on w0) associated with the graphene-like dispersion, while Igg depends on the graphene-graphene form factors F gg and Igb > 0 on F gb and F gg. The explicit form and derivation can be found in Appendix F 3.
From Eq. (5.1), we can read off the behavior of the
graphene-like bands of the SP state. For D0 = 0, we see that E > 0 (deformation is energetically disfavored) as
long as d2 > Igg. While this is what our numerics shows, we point out that d2 < Igg would imply that single-layer graphene spontaneously magnetizes, which is known to
be not the case. This agrees with our result in Sec. III

based on adibatically turning on the coupling between the TBG and graphene system and our numerics which displays unpolarized graphene Dirac cones in Fig. 3 at D0 = 0. When D0 = 0, we see that the energetic cost coming from the dispersion in the first line of Eq. (5.1) will always overcompensate the energetic gain coming from the scattering between the graphene- and TBG-like bands (at least in a finite range of D0 = 0). This is also consistent with our HF numerics: as can be seen in the band structure in Fig. 3, the graphene-like bands are not spin-polarized for non-zero D0 [see also Fig. 17 where Qk as obtained in HF are shown].
The ordering tendencies in the graphene-like bands for all other states in Table II can be analyzed in a similar way, see Appendix F 3. For instance, for the VP we find that the graphene-like bands are found to not develop valley polarization either--both for D0 = 0 and D0 = 0 and again consistent with the HF numerics. The same holds for the IVC± states, where breaking of U(1)v in the graphene-like bands is strongly suppressed due to the fact that, at the K (K ) point, the  = - ( = +) graphenelike band energies are large (already at D0 = 0), see Fig. 2.
The situation is different for the SLP group of states (SLP± and SSLP±). To begin with the SLP± states, we have (Qgk), = , (-3 cos k +2 sin k), k  A, and we need to determine k, with k = -k for SLP± due to  and C2z, by minimizing the energy. The change of the energy as a consequence of this "deformation" is of the form

Egg[k] =

[Ak,(1 - cos k) + Bk, sin k]

 kA

(5.2)

for both SLP+ and SLP-. The explicit expressions for

Ak, and Bk,, which are functions of w0 and D0, are

given in Appendix F 3. From these expressions, it follows

that Bk, = 0 and Ak, > 0 for D0 = 0 such that E[k] is minimized when sin k = 0 (with E = 0) and there

is no order in the graphene bands--again in agreement

with Sec. III and the HF numerics. Once D0 = 0, we

get Bk, = 0 and E < 0 by choosing a profile with

sin k = 0. In other words, the graphene-like bands will

develop SLP± order for any non-zero D0, as is visible in

the Qk for the SLP- state close to the K point shown in

Fig. 6(b). This gaps out the graphene cone, as can also

be seen in our HF band structure in Fig. 3. The energetic

gain scales as g±(k)2|D0|3, g± > 0, for small D0 and k for the SLP± state; the prefactors differ, g+ = g-,

due to the symmetry-imposed constraint k = -k. For

small w0, we can show that Bk, > 0 such that g- > g+,

i.e., the SLP- state can gain more energy than the SLP+.

For the SSLP- state and its Hund's partner SSLP+,
which we discuss here explicitly for reasons that will become clear shortly, we have (Qgk), = , (-3 cos k + 2s sin k), k  A. Symmetry imposes k = -k for

17

SSLP±. The deformation-related energy change E is found to be again of the form of Eq. (5.2); however, we here obtain Bk, = 0 for any D0 or w0. This is consistent with SU(2)+ × SU(2)- which requires that SSLP± have the same energy. We, hence, have shown that the graphene-like bands do not develop any direct SSLP± order and gain energy in the process. They will, however, hybridize with the TBG-like bands, as we discuss in the next subsection, which also gaps out the Dirac cones.
In Table III, we summarize our findings that only the SLP± states can benefit from ordering the graphene-like bands and how the respective energy gain scales.
B. Mixing between the bands
As anticipated above, we next look into the mixing between the TBG-like and graphene-like bands. While it is clear by symmetry that the mixing has to vanish for D0 = 0 and be generically present for D0 = 0, we here investigate the associated energetic gain and precise from of the band mixing for our candidate states in Table II. As before, we here outline the basic strategy and discuss the major results of this calculation and defer the details to Appendix F 4.
Our starting point are product states characterized by a correlator with Qk as given in Eq. (3.13), i.e., without any coherence between the TBG-like and graphene-like bands. In accordance with our analysis of Sec. III, we will take Qgk = -z and let Qbk be any of the candidate orders. To introduce momentum-dependent coherence between these sets of bands, we "deform" Qk by a unitary transformation, Uk, and take
Qk = UkQkUk, Uk = eik , k = k  C16×16, (5.3)
as ansatz for the correlator. Our goal will be to find the optimal momentum-dependent k to minimize the energy. Since we are interested in band mixing, we will restrict k to act as a superposition of 1 and 2, k = j=1,2 Mk,j j , Mk,j  C8×8, with j denoting Pauli matrices acting in the space of TBG-like and graphene-like bands (with index t = b, g). Furthermore, k will be constrained by the symmetries of the state under consideration.
To illustrate the procedure, let us focus on the IVC- since this state was found to be dominant in the HF numerics. Choosing Qbk = yy for concreteness, this state preserves the C2z symmetry of Table I, which forces k to obey (k) = -k. Furthermore noting that the IVC- state does not break the SU(2)s symmetry (while postponing the consequences of C2z which will relate k and -k), it follows that k has to be a momentumdependent superposition of the 16 generators
xy0,x,z, x0,x,zy, y0,x,z0,x,z, yyy. (5.4)

To simplify further, we can focus on those 8 linear combinations [see Eq. (F46) for their explicit form] of the terms in Eq. (5.4) that anti-commute rather than commute with Qk of the IVC- state.
The first energetic constraint we will take into account is related to the fact that the graphene-like bands of valley  = - ( = +) are far away from the Fermi level at the K (K ) point, see Fig. 2. This means that all mixing processes in k that induce a finite occupation of the upper or unoccupied states in the lower graphenelike band of valley  = - ( = +) at the K (K ) point are suppressed. In Appendix F 4, we show that this is equivalent to demanding that (Mk)(p , ,s ),(p,,s) = 0 for k  A±. This reduces the number of generators further from 8 to only 4 [given in Eq. (F52)]. For each of these 4 generators, j, j = 1, 2, 3, 4, we compute the change of energy associated with the deformation in Eq. (5.3) where Uk = eikj . It is found to be of the form

Egb[k] =

k sin2 k + k sin k cos k, (5.5)

kA+

where k and k are expressions involving the form factors, the interaction V (q), and the band structure [see Appendix F 4 for explicit form], and thus depend on D0 and w0. In Eq. (5.5), we have already taken into account the C2z constraint that allowed us to write it as a sum over k  A+ only.
First, we find k = 0 for D0 = 0 and, hence, no mixing between the bands as expected by symmetry. However, even when D0 = 0, we still obtain k = 0 for two of the four generators, while k = 0 for the other two (say 1,2) in the chiral limit (w0 = 0). Consequently, at least when w0 is not too large, the generators 1,2 have to dominate. Which of those remaining two is dominant, cannot be determined purely analytically as it will depend on nonuniversal values of the form factors, so let us compare with numerics. The mixing matrix, defined as

MkQ (p,,s),(p , ,s ) := (Qk)(b,p,,s),(g,p , ,s )

(5.6)

and can be computed straightforwardly for the two can-

didate generators 1,2. We find

MkQ

=

 2 2i

xP± ± 0

k,

k  A±,

(5.7a)

and

MkQ

=

 2 2i

zP± ± iy

k,

k  A±,

(5.7b)

for 1 and 2, respectively. Here, we defined P± = (0 ± z)/2 and ± = (x ± iy)/2. Intuitively, the first mixing matrix means that the lower (upper) graphenelike bands of the valley that is at low energies at K or K mixes with the upper (lower) and lower (upper) TBG-like bands of the same and opposite valley, respectively. The second option in Eq. (5.7b) describes the "twisted" situation where the lower (upper) graphene-like band mixes

18

TABLE III: Summary of the different energetic contributions, as discussed in Sec. V, for the candidate orders in Table II
when tuning away from the chiral-flat-decoupled limit (w0 = WTBG = D0 = 0). By construction, the energies are identical for the respective Hund's partners and are, hence, omitted. Here Ebb(WTBG = 0) is the change of energy, relative to SP phase, coming from the modifications of the form factors in the TBG-like bands when turning on w0 and D0 in the flat limit (WTBG = 0). As indicated in the column labelled Egg, only the SLP± states gain energy by ordering in the graphene-like bands immediately when D0 = 0. In all cases, D0 = 0 leads to mixing between the bands, with energetic gain as listed in the chiral limit, w0 = 0, in the column Egb; here k is the linear size of the fraction A± of the MBS where ordering in the graphene-like bands and mixing take place. The four columns with E¯jb indicate which of the four contributions to the TBG dispersion in Eq. (2.6) can lower the energies to second order in WTBG. Finally, in the last columns, we list the energy change associated with a finite value of the Hund's coupling in Eq. (3.16) for the respective state (EJ ) and its Hund's partner (EJH ), if it exists, in the chiral-flat-decoupled limit. All coefficients obey cj, g±, gj, j > 0 and explicit expressions can be found in Appendix F.

Type Qb

Qb

Ebb(WTBG = 0)

Egg

Egb

E¯0b E¯1bw0 E¯2bD0 E¯3bw0D0 EJ

EJH

SP 00s 00s 0 (by definition)

0

-g1(k)2D02  





2JH 1 -2JH 1

VP 0zs0 0zs0

0

0

-g1(k)2D02  





0

--

IVC+ 0x,y 0x,y

c1D04 + c3w02

0

-g2(k)2D02  



 -3JH 2 JH 2

IVC- yx,y z x,y

c1D04 + c4w02D04

0

-g2(k)2D02  



 -3JH 2 JH 2

SLP- y

z

c3w02 + c4w02D04

-g-(k)2|D0|3 -g1(k)2D02  





0

--

SLP+ yz zz c2D04 + c3w02 + c4w02D04 -g+(k)2|D0|3 -g3(k)2D02  





0

--

SSLP- ysz zsz

c3w02 + c4w02D04

0

-g1(k)2D02  





2JH 3 -2JH 3

with the lower (upper) TBG-like bands of the same valley and the upper (lower) band in the opposite valley. The HF result for Qk close to the K point, shown in Fig. 6(b), is consistent with Eq. (5.7a).
Minimizing Eq. (5.5) and noting that k scales linearly with D0 for small D0 while k > 0 at D0 = 0, we find the scaling of the energetic gain to be Egb  -g3(k)2D02, where g3 > 0; this is indicated in Table III.
In the same way, all other candidate states can be studied, see Appendix F 4. In accordance with our expectation based on symmetry, we find no mixing and vanishing energetic gain, Egb = 0, when D0 = 0, while mixing immediately sets in and Egb < 0 once D0 = 0. In all cases, Egb scales as Egb  -gj(k)2D02, gj > 0, as D0  0. While gj = gj(w0) depend on w0, we list Egb in the chiral limit, w0 = 0, in Table III as it reveals some structure: we see that the energetic gain coming from hybridization is identical for the two IVCs and it is the same for the four states SP, VP, SLP-, and SSLP- in the chiral limit.
The mixing matrices M Q in Eq. (5.6) for these states provide some additional consistency checks between analytics and numerics. For instance, the IVC+'s analysis closely parallels the one outlined above for the IVC-: out of 16 symmetry-allowed generators, only two candidate combinations remain. Interestingly, their associated k and k in Eq. (5.5) are the same (to leading order in D0) as those of the two IVC- candidates. Having identified MkQ in Eq. (5.7a) as being dominant by comparison with numerics, we can read off which of the two analytical candidates for the IVC+ must be realized; indeed, we

find the same one in numerics [compare Eq. (F59) and Fig. 17]. To provide a second example, we find a mixing matrix for the SLP- given by

MkQ = 2i(y + z)P±k, k  A±.

(5.8)

This means that there is only mixing in the valley for which the graphene-like bands are at low energies and that both upper and lower graphene-like bands mix with both TBG-like bands. This is consistent with the Qk in Fig. 6(b) we found for the SLP- in HF close to the K point.

C. Deforming the form factors
Apart from the mixing with and the "proximityinduced" order in the graphene-like bands, there are also important energetic contributions directly within the TBG-like bands, when tuning away from the chiral-flatdecoupled limit. While some of these contributions are analogous to TBG [46, 60], some others are not: non-zero D0 strongly breaks P (see Table I) and, hence, induces terms in the TBG-like band structure, see second line in Eq. (2.6), without any analogue in TBG; it also leads to terms in the form factors [see Eq. (A33a) for details] that cannot be present in TBG and have not been studied in the literature.
We here begin with the impact of the form factors and restrict ourselves, for now, to the flat limit, WTBG = 0. In the column labeled Ebb in Table III we show the energy of the candidate states for non-zero w0 and D0

19

relative to the SP [see Appendix F 1 for explicit expressions for the prefactors cj > 0]. First, for D0 = 0, we recover the previous result [46] that the IVC- and VP are the only states besides the SP that are not penalized when turning on w0. Second, we see that this changes once D0 = 0: if w0 = 0, it is the SLP group of states that is not suppressed by breaking P with D0 [63], while both IVCs have increasing energy. When both w0 and D0 are simultaneously non-zero, also the SLP group is suppressed (by the exact same amount as the IVC-) compared to the SP and VP. Algebraically, this is related to the fact that the SP and VP order parameters are the only ones that commute with all form factors once w0, D0 = 0 [cf. Eq. (A33a)].
D. Finite TBG bandwidth
Finally, we take into account the finite bandwidth of the TBG-like bands by doing perturbation theory in WTBG in Eq. (2.5), starting from the product states associated with the candidate orders of Table II. We will only outline the results here and refer the interested reader to Appendix F 2.
Since the correction to the relative energies of the different candidate orders vanishes to first order in WTBG, we focus on second order perturbation theory, which, if non-zero, will always lower the energy of the states and can be thought of as "superexchange". We consider the superexchange processes associated with all four terms, Ejb, j = 0, 1, 2, 3, in Eq. (2.6) of the TBG-like dispersion; the corresponding energetic gain will scale as WT2BG/U for j = 0, WT2BGw02/U for j = 1, WT2BGD02/U for j = 2, and WT2BGw02D02/U for j = 3 to leading order in D0 and w0, where U is the energy scale associated with occupying a k-state of an unoccupied flavor in a given ground state. Which of these four superexchange processes are "active" for the candidate states is listed in Table III. We find that, by virtue of being proportional to the identity in Eq. (2.6), E3b does not affect the energy of the states. Furthermore, we see that the displacement-induced superexchange process favors the IVC+ and the SLP group of states.
E. Comparison of energetics
Taken together, the energetics obtained analytically as summarized in Table III agrees well with the numerics in several aspects: we can see that the energies of the SLP+, SLP-, and SSLP- are expected to be very close, exactly as seen in HF, see Fig. 6. There is a very small splitting between the three associated with the fact that the SSLP- cannot benefit from ordering in the graphene-like bands, that that effect is weaker for the SLP+ than for

the SLP- (recall g- > g+, for small w0), and that the SLP+ is slightly suppressed by the Hartree term. We have seen that there is a small energetic preference towards the SLP- in the numeris as well. In addition, we can also read off from Table III that the SLP group of states should be preferred for small w0 and large D0, which is consistently seen in our HF phase diagram in Fig. 4.
Notwithstanding the good agreement between the HF and the analytics, concerning the graphene-ordering, mixing between the bands, and the energetics, there are also differences. These can be traced back to the additional presence of remote bands, in particular, the bands with h eigenvalues +1 just above (below) the almost flat TBG-like band p = + (p = -) away from the K/K points. While these are included in our HF numerics, they are not taken into account in the analytics. Most notably, we have seen that mixing between these bands and the almost flat TBG-like bands further lowers the energy of IVC- state relative to the SP and VP states.
F. Breaking SU(2)+× SU(2)-
Finally, we come back to the fact that certain Hund's partners of states are degenerate in the model we have focused on so far and defined in Sec. II; this can be traced back to the presence of the SU(2)+× SU(2)- spin symmetry. Turning on a finite Hund's coupling, JH = 0, will lift this degeneracy and also slightly affect the relative energetics of the candidate states. For the form of the Hund's coupling defined in Eq. (3.16), we have computed the respective change of energy. With more general and explicit expressions available in Appendix F 5, we present their impact on the energies of the states in the last two columns of Table III in the chiral-flat-decoupled limit. Here j are positive constants obeying 2 > 1, 3. While estimates based on the Coulomb interaction yield an energy change (per unit cell) of 2JH 1 -0.2 meV for the SP state in TBG [64], its actual effective value might be smaller due to screening processes and additional electron-phonon coupling, which can also change the sign of JH .
However, irrespective of the sign of JH and its precise magnitude, we see that it will favor the SSLP± states in the otherwise almost degenerate SLP group of states, since the SLP± cannot lower their energy with JH = 0. This is due to the fact that SLP± are their own Hund's partners. Similarly, the SP and SVP states will be favored over the VP phase. Finally, we note that the energetic gain coming from JH is of the same order of magnitude (even larger) for the SIVC- (IVC-) compared to the SP (SVP) state. Consequently, we do not expect that JH will change the fact that the IVC- dominates over the SP in the phase diagram in Fig. 4.

20

VI. NUMERICS FOR  = ±2
In this section, we will discuss the numerical results for correlated states at half-filling of the lower or upper TBG-like bands,  = ±2.

A. Procedure and results

We find self-consistent HF solutions with energies

lower than the symmetry-unbroken normal state where,

at D0 = 0 (D0 = 0), the TBG (TBG-like and graphenelike) bands are spin polarized and, on top of this, exhibit

any of the candidate orders defined for  = 0 in Ta-

ble II. The obtained spin polarization is our explanation

for the observed [30, 31] reduced flavor degeneracy set-

ting in around || = 2.

To be more explicit, our self-consistent solutions are

found by starting, say for  = -2, from a correlator

Pb=-2

=

1 2

(1

+

sz

)

1 2

(1

+

Qb)

in

the

TBG-like

subspace,

where Qb is any of the candidate orders in Table II; the

initial correlator for the graphene-like sector is taken to

be filled lower bands of the continuum model at charge

neutrality,

Pg

=

1 2

(1

-

z

).

The

corresponding

correlator

at  = +2 in the TBG-like sector is simply given by

Pb=+2 = 18×8 - Pb=-2. We apply the same iterative

procedure as for  = 0 to obtain self-consistent solutions.

We show the band structures resulting from our self-

consistent calculation for the spin-polarized IVC- and spin-polarized SLP states in Fig. 7. The energies we ob-

tain up to D0/w1 = 0.5 are shown in Appendix D, but are qualitatively similar to the numerical energies we com-

puted at  = 0; we note though the spin-valley-polarized

and spin-polarized IVC- are closer in energy at  = 2 than the SVP and IVC- state at  = 0. As can be seen in Fig. 7, the graphene bands at D0 = 0 remain unpolarized, in agreement with the analytics in Sec. III. Once a

finite displacement field is applied, also the graphene-like

bands develop some small polarization. However, exactly

as for  = 0, the Dirac cones of the IVC- state are not gapped out. We note the IVC-, which was semimetallic at  = 0, is metallic at  = ±2 (albeit with small Fermi

surfaces). This follows from the additional spin polar-

ization at || = 2, breaking SU(2)s which guaranteed its semimetallic character at  = 0. In Fig. 7(a,b), we see

that the SLP state, which was insulating at  = 0, be-

comes semimetallic at || = 2, since the spin-polarization

of the TBG-like bands only allows for SLP order in one

of the spin species of the graphene-like bands.

B. Connection to experiment
An important feature in the experimental data on MSTG [30, 31], which may be related to our numerics, is

a) b) w0/w1=0.73, D0/w1=0.00

w0/w1=0.73, D0/w1=0.36

100 SLP -

SLP -

Energy (meV)

50

0

50

100
c)
100 IVC -

d) IVC -

Energy (meV)

50

0

50

100

K

K'

KK

K'

K

FIG. 7: HF band structures at  = 2 for the spin polarized SLP- state (a) at D0 = 0 and (b) D0 > 0 and spin polarized IVC- state (c) at D0 = 0 and (d) D0 > 0.

the observation of enhanced resistivity at  = 0 for both D0 = 0 and D0 > 0 and a state with high resistivity observed only at a finite value of D0 at  = 2. Taking our results for band structures at  = 0 and || = 2 together, we note that at  = 0, the leading phase in our numerics is either a semimetallic IVC- state or an insulating SLP state, both of which may be compatible with the observed high resistivity state at  = 0. At  = 2, we find our leading solution is a metallic IVC- state for small values of D0 and a semimetallic SLP state for large enough D0--a possible explanation for why high resistivity at || = 2 only sets in above a finite value of D0 in experiment.
Another notable experimental observation is that the reset of the band structure at || = 2 splits into a Diraclike feature at || = 2 and a van-Hove singulartiy, associated with a rapid increase and sign change in the Hall density, at || = 2 - (D0), (D0) 1 [30]. If we assume that the spin polarization we found persists for a finite range of || below 2, the bandstructures in Fig. 7 provide a natural explanation: lowering the chemical potential, e.g., in Fig. 7(d), until it hits the lower, almost flat set of bands will lead to a Lifshitz transition where the hole pockets around the K and K points merge. This could explain the observed behavior of the Hall density. We note that the tendency, visible in Fig. 7, that increasing D0 pushes these almost flat bands away from the Fermi level at || = 2, is consistent with this feature only being visible at non-zero D0 and the associated (D0) increasing with |D0| in experiment [30]. Numerical results for larger values of D0 are discussed in Appendix E.

21

VII. SUPERCONDUCTIVITY
Having established the nature of the correlated phases in MSTG at various filling fractions, we next study the consequences for the superconducting states.

this explicitly in Appendix G 2. Based on the estimate JH 0.2 meV [64], we obtain 3 T as the characteristic magnetic field strength of the transition.
B. Pairing without polarization

A. Pairing in the presence of polarization
Let us begin with the range of electron filling, 2 < || < 3, where superconductivity is most prominently observed in experiment [30­32]. We have seen in Sec. VI that spin polarization supplemented with IVC- order is favored for realistic parameters at || = 2. Because the associated reduction of the number of flavors in the normal state is seen in experiment over the entire or most of the superconducting range of , we assume that spin polarization and superconductivity co-exist at least in part of the phase diagram. As follows from the analysis in Ref. 27, where a classification of pairing in almost SU(2)+× SU(2)--symmetric graphene moiré systems in the presence and absence of flavor polarization can be found, the superconducting state has to be in a nonunitary triplet phase--irrespective of the precise pairing mechanism. We emphasize that this also holds if the additional IVC- ordering found in the HF at || = 2 coexists with superconductivity in a finite range of : the bands above the Fermi level in the IVC- band structure in Fig. 7 still exhibit Kramers partners at momenta k and -k with the same spin, due to the preserved spinless  symmetry; these degenerate states can form Cooper pairs with non-unitary triplet vector. Note that this would not be the case, e.g., for the VP state [shown in Fig. 13], which does not exhibit exactly degenerate energy levels at k and -k above the Fermi level. Given the strong tendency of MSTG towards superconductivity, this VP phase is, thus, a less natural candidate order. Indeed, we find it to be subleading in our HF numerics, see Sec. VI.
It is important to note, however, that the spin polarization (and additional IVC- state) is only realized for JH < 0. While this is expected to be the case if JH stems entirely from the Coulomb interaction, its sign is unknown. For JH > 0, we would, instead, obtain the SVP phase with additional SIVC- order (cf. Table II). In that case, the associated superconductor would also be the corresponding Hund's partner, which is an admixture between a singlet and unitary triplet [27]. In the presence of a magnetic field there is a crucial difference between the two scenarios: while, for JH < 0, the SP will just align with the Zeemann field and the superconductor will remain a non-unitary triplet, the two antiparallel spin polarizations in the two valleys of the SVP state will be canted gradually; a coexisting singlet-unitary-triplet superconductor will continuously transition into a nonunitary triplet [27]. For completeness, we demonstrate

In experiment [30­32], there are also regions of  and D0 with superconductivity but without any signs of flavor polarization in the corresponding normal state (SC II in Fig. 1). We here discuss the nature and origin of these superconducting phases.
In light of recent experiments in TBG [51­53], which indicate that electron-phonon coupling plays an important role for pairing in graphene moiré systems, the picture proposed in Ref. 54 provides a very promising microscopic scenario: while electron-phonon coupling is likely important to stabilize superconductivity and crucially determines the critical temperature, it might predominantly mediate an SU(2)+× SU(2)- symmetric pairing interaction. This leads to the near degeneracy of singlet and triplet pairing. In the additional presence of flavor polarization, its structure determines whether singlet or triplet is realized, as discussed above. In the absence of polarization, electron-phonon coupling by itself can never favor triplet over singlet and at most make the two degenerate [65, 66]; however, additional Cooper-channel interactions coming from the fluctuation of particle-hole orders can determine whether the superconductor will be in a singlet or triplet state [54]. To analyze this, we will consider the action

S = S0 + S + Sf + Sphonon,

(7.1)

which consists of the bare non-interacting action S0 associated with H0 in Eq. (2.5) and S, given by

1 S = 2

jq -1(in, q) j,j j-q,
q

(7.2)

where jq is the set of real bosonic fields (labelled by j) describing the fluctuations of a given candidate particle-
hole order in Table II. We use q = (in, q) labeling bosonic Matsubara frequencies n and momentum q, introduce the short-cut q . . .  T n q . . ., and denote the (fully renormalized, low-energy) susceptibility in the
particle-hole channel under consideration by (in, q). The bosons jq are coupled to the low-energy electron fields fk;n,,s, with k = (in, k), via

Sf =

fk+qj (k + q, k)fk jq.

qk

(7.3)

Note that the coupling vertex j(k + q, k) is in general
a matrix in valley, spin, and band space. For instance,
a minimal description of fluctuations of the IVC- state is given by the two-component boson jq, j = x, y, with

22

[(in, q)]j,j  j,j /(2n + c2q2 + -2), where the coherence length  parametrizes the proximity to the critical point. Furthermore, j(k, k ) = s0jfk,k , where fk,k is a matrix in band space (p = ±, t = b, g) only, which obeys fk,k = fk ,k = -fkT ,k due to Hermiticity and C2z symmetry. Finally, the last part Sphonon in Eq. (7.1) stands for the action of the phonons and their coupling to the electrons.
We integrate out the bosonic modes jq in the action of Eq. (7.1), leading to an interaction between the fermions f . In the saddle-point equations of the Cooper channel, this interaction can be viewed as a SU(2)+× SU(2)--symmetry breaking correction to the SU(2)+× SU(2)--symmetric interaction coming from the phonons in Sphonon.
As shown in Ref. 54, whether this tips the balance towards singlet or triplet is determined by the behavior of the fluctuating modes jq under spinful time-reversal s: if the bosonic mode is even (odd) under s, as indicated by + (-) in the column s in Table II, it will generically favor singlet (triplet) over triplet (singlet) pairing--in the presence of fine-tuning or additional symmetries, the two might remain degenerate. We emphasize that this conclusion does not depend on microscopic details such the precise form of  in Eq. (7.2) or of j in Eq. (7.3). Due to U(1)v symmetry, the system also exhibits the spin-
less time-reversal symmetry , see Table I. We have generalized the analysis of Ref. 54 in Appendix G to also include this form of time-reversal symmetry and proved that any jq that is even (odd) under  will generically favor triplet (singlet). This also implies that any jq which
has the same behavior under s and  will keep singlet and triplet degenerate. As expected, this is precisely the case for all order parameters in Table II that are their own Hund's partner.
First, we focus on the superconducting domes (indicated by SC II in Fig. 1) that emerge in the vicinity of but outside the region with flavor polarization and reconstructed band structure [30]. As mentioned above, with Coulomb interactions only, the IVC- order with additional spin polarization is favored over the Hund's partner, the SIVC- with additional SVP order. We can read off from Table II that triplet will then be favored over singlet pairing. As shown in Ref. 27, the resulting triplet will be unitary within mean-field theory, but can become non-unitary when spin fluctuations corrections become significant. These two scenarios can be distinguished experimentally since the unitary triplet will exhibit a BKT transition (of a charge-4e, spin-rotation-invariant order parameter combination), while the non-unitary state will not. For the other sign of JH , singlet pairing (if meanfield theory applies) or a mixed singlet-triplet phase (if the SVP fluctuations dominate) will be realized [27].
Second, we also comment on possible pairing phases close to charge neutrality, although these have not been

seen experimentally. For the same sign, JH < 0, that favors SP at  = 2, we obtain the SIVC- at  = 0 as the dominant, semimetallic instability at small D0 and large w0, see Fig. 4. As can be seen from Table II, it is even under s and will, hence, favor singlet pairing. Among the SLP group of states, realized for larger D0, only fluctuations of the SSLP± states will break the SU(2)+× SU(2)--symmetry; the SSLP-, realized for JH < 0, will also favor singlet.
Finally, if electron-phonon coupling does not play any role for pairing in MSTG, i.e., the term Sphonon in Eq. (7.1) can be neglected, we still obtain the same results (see Appendix G 1 for a derivation): if jq are even/odd
(odd/even) under s (), singlet/triplet pairing will be favored. Consequently, the above statements about the singlet-triplet competition still apply in this scenario as well.

C. Relevance of Dirac cones and topology

Motivated by recent theoretical works [25, 55, 67] discussing the potential importance of WZW terms for superconductivity and insulating behavior in TBG, we here analyze under which conditions this can also be relevant for MSTG. We note that the WZW term is a purely kinematic term associating a Berry phase with spatiotemporal textures of the orders defined on the TBG-like bands, and is independent of the interactions between the electrons in these bands. The presence of such a topological term has crucial consequences for direct transitions between superconductivity and correlated insulators, without closing a single-particle gap at integer fillings. We explain in Appendix H how the following results can be formally derived from the exhaustive classification of WZW physics in TBG in Ref. 25 and focus here on the main picture and implications.
Although the main superconducting phase is found between || = 2 and || = 3 in experiment [30­32], we begin our analysis at the charge neutrality point,  = 0, with associated superconducting phase labelled SC III in Fig. 1. Since we expect superconductivity to survive finite displacement fields, we focus on Dirac cones that remain close to the Fermi level for D0 = 0. Inspection of the band structure in Fig. 2(b) reveals that the effect of D0 is to push the two Dirac cones of the graphene and TBG bands of valley  = + ( = -) at K (K ) away from the Fermi level, leaving only a single TBG-like Dirac cone of valley  = - ( = +) at low energies. Denoting the fermionic fields by q of these two Dirac cones (per spin), their Hamiltonian reads as

H0D = q [xµzs0qx + ys0qy] q,
q

(7.4)

where q is momentum measured relative to the K (K ) point for the Dirac cone at "mini-valley" µz = + (µz =

23

TABLE IV: Possible particle-hole, mj, and superconducting order parameters, , that can exhibit mutual WZW terms at the indicated filling fractions  = 0 and || = 2. We here use the Dirac notation of Eqs. (7.4) and (7.5). As in Ref. 25, moiré density wave (MDW) indicates that the state breaks moiré translational symmetry; A and B are refer to the irreducible representations of the point group C6 of the superconductor (SC). The MDW with singlet pairing row below corresponds to the first row of Table IV in Ref. 25, while the MDW with triplet SC corresponds to the first row of Table VII (or more explicitly, in lines 5 and 9 of Table XV).

||

mj

0, 2

µz z s

0, 2 x(µx, µy); z

type



SSLP-

1

MDW; SLP+ 1

SC type A singlet A singlet

2 z(sx, sy); zµzsz SSLP+/SSLP- µzsz B unit. triplet

2 xsz(µx, µy); z MDW/SLP+ µzsz B unit. triplet

-). Furthermore, j are Pauli matrices acting in the Dirac space, which are related to the band-space matrices j used above. In this notation, C2z and (anti-unitary) spinfull time-reversal act as C2z : q  xµx-q and s : q  T -q, T = syµx, respectively.
Similar to Ref. 25, we ask what different types of particle-hole orders, mj, and superconducting order parameters, , coupling to q as

H1D = q mj q +

q T - q + H.c. , (7.5)

q,j

q

can form WZW terms. The Hamiltonian H0D + H1D is equivalent to the low-energy Dirac Hamiltonian for TBG projected into a valley-minivalley locked subspace, meaning that all pairings and insulating orders with WZW derived in [25] which survive projection to the same subspace will also be viable in MSTG. This is also the reason why the number of possible WZW terms we find here is significantly reduced as compared to Ref. 25.
Based on our analysis of particle-hole instabilities, the Dirac cones in Eq. (7.4) can either be those of the noninteracting bands or those of our leading instability at small D0--the semimetallic IVC- state with band structure shown in Fig. 3--which could persist for an extended range of || > 0; the resulting WZW terms we discuss next are identical in both scenarios.
Due to spin-rotation invariance, triplet pairing is not consistent with a WZW term [25]. We find that singlet pairing,  = 0µ0s0, which transforms under the irreducible representation A of the point group, is the only possible superconducting state with WZW term at  = 0. This is consistent with the singlet we established in Sec. VII B near  = 0 due to electron-phonon coupling and particle-hole fluctuations. Considering all possible

compatible insulating orders mj, we find there are two types: a spin Hall order of the form µzzsx,y,z, which aligns with our SSLP- order in Table II, and a moiré density wave (MDW) state, xµx,y, which breaks translations on the moiré lattice scale together with an SLP+ state (z), see Table IV. We note that since this order is defined in the minivalley-valley locked space and, in the full space of MSTG, thus also breaks U(1)v symmetry in the same way as our IVC states. Interestingly, the SSLP- is precisely our leading instability for larger D0 and, hence, constitutes indeed a natural candidate mj. The MDW state goes beyond our analysis in this work, as we have not considered states which break moiré translational symmetry. We will leave this for future work.
At || = 2, the situation is more complicated, because the entire band structure is reconstructed as a consequence of interaction-induced flavor polarization. Nonetheless, we expect the low-energy Dirac theory to be still of the form of Eq. (7.4). While there are other possible microscopic realizations, this is true for our leading instability of the SP (or SVP) with additional IVC- (or SIVC-) order with band structure in Fig. 7(c,d). Neglecting the small D0-induced SP (or SVP) in the graphene-like bands, Eq. (7.4) still applies.
As summarized in Table IV, all options for insulators with singlet pairing then carry over to || = 2. A difference between the two cases is the broken SU(2)s spin symmetry, which also allows for triplet pairing. In this case, there are two additional options compatible with the unitary triplet  = µzsz: one set with insulating orders zsx,y and zµzsz and another set with xszµx,y and z. The first two orders correspond to our SSLP+ and SSLP-, respectively. The second two states are a spin polarized MDW state and the SLP+ state. We find no non-unitary state to be consistent with WZW terms. Since only either singlet or unitary triplet are possible, the underlying flavor polarization of the TBG-like bands in Fig. 3(c,d) must be SVP rather than SP. Consequently, WZW terms at || = 2 are more likely relevant if JH > 0.
VIII. CONCLUSION AND DISCUSSION
To summarize, we have studied particle-hole instabilities and superconductivity in MSTG, for different filling fractions  and displacement field values D0, using a combination of analytical arguments and HF numerics. We started, in Sec. III, in the limit D0 = 0, where the noninteracting band structure is just given by the spectrum of TBG and single-layer graphene. In the interacting Hamiltonian (3.1), these two subsystems are coupled by the density-density interaction in Eq. (3.4). We showed that states of the form |gj (b) |b0(b) , where |gj (b) are the correlated semimetallic eigenstates of single-layer graphene and |b0(b) are the eigenstates [60] in Eq. (3.6)

24

of the TBG Hamiltonian in the flat limit, are also exact eigenstates of the MSTG in Eq. (3.1). Furthermore, if |b0(b) are groundstates of the TBG Hamiltonian, |gj (b) |b0(b) are shown to be exact groundstates of MSTG for a finite range of the coupling strength, quantified by  in Eq. (3.4), between the two sectors. In this sense, not only the bare band structure but also the interacting physics of MSTG can be separated into that of single-layer graphene and TBG in the flat-decoupled limit.
We used these results to construct the set of candidate particle-hole orders summarized in Table II, which are exactly degenerate in the chiral-flat-decoupled limit [defined by further setting w0 = 0 in Eq. (2.3)]. We took these states as our starting point of the HF numerics and analytical perturbation theory, which are not based on  being small and allow to tune away from the chiralflat-decoupled limit. The resulting band structures for  = 0 of the most important candidate orders are shown in Fig. 3 for zero and non-zero D0, with w0 close to what is believed to describe the real system [56, 57] and finite TBG bandwidth. We see three distinct types of behavior, with different experimental signatures, when turning on D0: the IVC± and their Hund's partners SIVC± retain their semimetallic behavior for D0 = 0, while the graphene Dirac cones of the SLP± and SSLP- (and its Hund's partner SSLP+) are gapped out when turning on D0. Interestingly, for the VP and SP (and its Hund's partner SVP), a finite D0 induces small Fermi surfaces. In combination with further transport and, in particular, scanning tunneling microscopy experiments, which are sensitive to the local spectrum of the system, the computed spectra could help shed light on the correlated physics of MSTG.
Also the relative energetics between these candidate states as a function of D0, w0, and the TBG bandwidth is very rich: as summarized in Table III, there are many contributions without any analogue in TBG--the mixing between the TBG and graphene bands, additional ordering in the graphene bands, and the D0-induced breaking of symmetries in the TBG sector, which changes interaction matrix elements and induces new superexchange processes. The resultant phase diagram in the D0-w0 plane with leading and subleading phases is presented in Fig. 4: at small D0, a semimetallic intervalley coherent phase is favored, which transitions into a sublattice polarized phase at larger D0; among the latter set of states, we expect the SSLP± to dominate as they are the only states in this otherwise almost degenerate manifold that can benefit from the intervalley Hund's coupling JH in Eq. (3.16).
At || = 2, we found self-consistent HF solutions for all of the candidate states in Table II, which coexists with additional spin polarization (either of the SP or SVP type, depending on the sign of JH ). This can explain

the experimentally observed [30, 31] band resetting for 2 || 3. For instance, the spectrum for the intervalley coherent state is shown in Fig. 7(c) and (d) for  = 2: increasing the filling fraction  slightly will lead to Fermi surfaces of completely spin-polarized TBG-like bands, i.e., with half the number of flavors. In magnetic fields, the SP band resetting (JH < 0) will not change its form, while the SVP-related resetting (JH > 0) will continuously develop a finite canting and transform into a SP configuration; we estimate the associated magneticfield scale to be of order of 3 T . Since JH < 0 follows for pure Coulomb interactions [64], we expect the SP to be a more natural candidate; however, also JH > 0 is possible, both theoretically and experimentally, and so we have studied both signs of JH in our analysis.
Building on our results for the correlated normal states of MSTG, we analyzed the superconducting order parameters in Sec. VII in the different regimes indicated by SC I­III in Fig. 1: when superconductivity co-exists with flavor polarization (SC I), the nature of the pairing state depends crucially on the form of the flavor reduction; for the SP (JH < 0) and SVP (JH > 0) polarization, that we find around || = 2, we obtain, respectively, a non-unitary triplet and its Hund's partner--a singlet-unitary-triplet admixed phase [27]. For the superconducting phases (SC II) close to but not in the flavor-polarized region, we find triplet pairing to dominate for JH < 0, while the state will either be a singlet or admixed singlet-triplet phases for JH > 0.
The behavior of these superconducting phases in inplane magnetic fields, B , follows from Ref. 27 where their respective phase diagrams in the temperature-B plane have been worked out: in the presence of SP polarization (JH < 0), the critical temperature, Tc, of the non-unitary triplet is not affected by the Zeemann coupling and suppressed in quadratic order in the in-plane orbital coupling. This naturally explains the strong violation of the Pauli limit [32]. In the other case of SVP polarization (JH > 0), the behavior of Tc of the associated singlet-triplet phase is the same, with the only difference that also the singlet-triplet admixture will gradually transform into a non-unitary triplet with increasing magnetic field. Understanding the reentrant superconducting behavior seen at even larger magnetic fields [32] will require understanding the fate of the correlated parent states, e.g., in Fig. 7, in large magnetic fields, which we leave for future work. Irrespective of whether the order parameter of SC II is a triplet or a singlet-triplet admixed phase, it will continuously transform into a nonunitary triplet [27] upon applying B , while being eventually suppressed by the orbital coupling. We emphasize that all of the superconducting states we find, including the triplets, are protected [54] against non-magnetic impurities on the moiré scale, i.e., exhibit an analogue of the "Anderson theorem", which is typically only expected

25

for singlet superconductors [68].
For completeness, we also investigated superconductivity close to the charge neutrality point (SC III), although not prominently seen in current experiments. Here we predict singlet pairing to dominate for the same sign of the Hund's coupling, JH > 0, we found triplet pairing near  = 2.
Because the band structure of MSTG also exhibits Dirac cones, a subset of which persist in most of our dominant particle-hole instabilities [see, e.g., IVC- in Fig. 3 and Fig. 7(c,d); related to the preserved C2z symmetry], we have also studied the possible WZW terms between superconducting and insulating orders; as discussed in [25, 55] for TBG, these topological terms are associated with and sensitive to the chirality of the Dirac cones in the normal-state band structure. We have shown here that the set of possibilities in MSTG is greatly reduced as compared to TBG [25], resulting from the reduced flavor degeneracy at || 2 and the impact of the displacement field at  = 0. As compiled in Table IV, only s-wave singlet pairing is consistent with WZW terms close to  = 0 (SC I), while both singlet and triplet pairing can have WZW terms in the flavor-polarized region (SC III). The corresponding particle-hole order parameters that form a mutual WZW term with these superconductors feature the sublattice-polarized states that we find to dominate at finite D0 (in particular, the SSLP- state) and intervalley-coherent moiré density wave (MDW) phases.

Unlike all the states studied in the HF analyses of this paper, the MDW phases break translational symmetry at the scale of the moiré period. The MDW states were previously studied [25] in the context of WZW terms in TBG, break the moiré translational symmetry and the valley U(1)v symmetry. A closely related `incommensurate Kekulé spiral' (IKS) appeared in a recent HF numerics study [69] of TBG. (We also note that Kekulé states have been observed in single layer graphene on a Cu substrate [70], and in the zeroth Landau level [71].) Motivated by these results, and our study of WZW terms here, we believe that these types of states are very promising possible additional instabilities in MSTG as well, in models which include the breaking of the SU(2)+ × SU(2)- symmetry to the physical SU(2)s spin rotation symmetry. We leave a detailed energetic study of these states for future work.
ACKNOWLEDGMENTS
M.S.S. thanks R. Samajdar for discussions and previous collaborations [27, 54] on unconventional superconductivity in moiré systems, and acknowledges discussions with T. Lang, A. Läuchli, and R. Fernandes. This research was supported by the National Science Foundation under Grant No. DMR-2002850. This work was also supported by the Simons Collaboration on Ultra-Quantum Matter, which is a grant from the Simons Foundation (651440, S.S.).

[1] A. H. MacDonald, "Bilayer Graphene's Wicked, Twisted Road," Physics 12, 12 (2019).
[2] E. Y. Andrei and A. H. MacDonald, "Graphene bilayers with a twist," Nat. Mater. 19, 1265 (2020).
[3] D. M. Kennes, M. Claassen, L. Xian, A. Georges, A. J. Millis, J. Hone, C. R. Dean, D. N. Basov, A. N. Pasupathy, and A. Rubio, "Moiré heterostructures as a condensed-matter quantum simulator," Nat. Phys. 17, 155 (2021).
[4] L. Balents, C. R. Dean, D. K. Efetov, and A. F. Young, "Superconductivity and strong correlations in moiré flat bands," Nat. Phys. 16, 725 (2020).
[5] M. S. Scheurer, "Spectroscopy of graphene with a magic twist," Nature 572, 40 (2019).
[6] T. Zaletel, "Stronger-correlated superconductivity in magic-angle twisted trilayer graphene," Journal Club in Condensed Matter Physics (2021).
[7] Y. Cao, V. Fatemi, A. Demir, S. Fang, S. L. Tomarken, J. Y. Luo, J. D. Sanchez-Yamagishi, K. Watanabe, T. Taniguchi, E. Kaxiras, R. C. Ashoori, and P. JarilloHerrero, "Correlated insulator behaviour at half-filling in magic-angle graphene superlattices," Nature 556, 80 (2018).
[8] Y. Cao, V. Fatemi, S. Fang, K. Watanabe, T. Taniguchi,

E. Kaxiras, and P. Jarillo-Herrero, "Unconventional superconductivity in magic-angle graphene superlattices," Nature 556, 43 (2018). [9] C. Shen, N. Li, S. Wang, Y. Zhao, J. Tang, J. Liu, J. Tian, Y. Chu, K. Watanabe, T. Taniguchi, R. Yang, Z. Y. Meng, D. Shi, and G. Zhang, "Correlated states in twisted double bilayer graphene," Nat. Phys. 16, 520 (2020). [10] X. Liu, Z. Hao, E. Khalaf, J. Y. Lee, Y. Ronen, H. Yoo, D. H. Najafabadi, K. Watanabe, T. Taniguchi, A. Vishwanath, and P. Kim, "Tunable spin-polarized correlated states in twisted double bilayer graphene," Nature 583, 221 (2020). [11] Y. Cao, D. Rodan-Legrain, O. Rubies-Bigorda, J. M. Park, K. Watanabe, T. Taniguchi, and P. JarilloHerrero, "Tunable correlated states and spin-polarized phases in twisted bilayer­bilayer graphene," Nature 583, 215 (2020). [12] G. W. Burg, J. Zhu, T. Taniguchi, K. Watanabe, A. H. MacDonald, and E. Tutuc, "Correlated Insulating States in Twisted Double Bilayer Graphene," Phys. Rev. Lett. 123, 197702 (2019). [13] G. Chen, L. Jiang, S. Wu, B. Lyu, H. Li, B. L. Chittari, K. Watanabe, T. Taniguchi, Z. Shi, J. Jung, Y. Zhang,

26

and F. Wang, "Evidence of a gate-tunable Mott insulator in a trilayer graphene moiré superlattice," Nat. Phys. 15, 237 (2019), arXiv:1803.01985 [cond-mat.mes-hall]. [14] G. Chen, A. L. Sharpe, P. Gallagher, I. T. Rosen, E. J. Fox, L. Jiang, B. Lyu, H. Li, K. Watanabe, T. Taniguchi, J. Jung, Z. Shi, D. Goldhaber-Gordon, Y. Zhang, and F. Wang, "Signatures of tunable superconductivity in a trilayer graphene moiré superlattice," Nature 572, 215 (2019). [15] G. Chen, A. L. Sharpe, E. J. Fox, Y.-H. Zhang, S. Wang, L. Jiang, B. Lyu, H. Li, K. Watanabe, T. Taniguchi, Z. Shi, T. Senthil, D. Goldhaber-Gordon, Y. Zhang, and F. Wang, "Tunable correlated Chern insulator and ferromagnetism in a moiré superlattice," Nature 579, 56 (2020). [16] J. M. B. L. Dos Santos, N. M. R. Peres, and A. H. C. Neto, "Graphene bilayer with a twist: electronic structure," Phys. Rev. Lett. 99, 256802 (2007). [17] R. Bistritzer and A. H. MacDonald, "Moiré bands in twisted double-layer graphene," Proc. Natl. Acad. Sci. U.S.A. 108, 12233 (2011). [18] J. M. B. L. Dos Santos, N. M. R. Peres, and A. H. C. Neto, "Continuum model of the twisted graphene bilayer," Phys. Rev. B 86, 155449 (2012). [19] A. Kerelsky, L. J. McGilly, D. M. Kennes, L. Xian, M. Yankowitz, S. Chen, K. Watanabe, T. Taniguchi, J. Hone, C. Dean, A. Rubio, and A. N. Pasupathy, "Maximized electron interactions at the magic angle in twisted bilayer graphene," Nature 572, 95 (2019). [20] Y. Cao, D. Rodan-Legrain, J. M. Park, F. Noah Yuan, K. Watanabe, T. Taniguchi, R. M. Fernandes, L. Fu, and P. Jarillo-Herrero, "Nematicity and Competing Orders in Superconducting Magic-Angle Graphene," arXiv e-prints (2020), arXiv:2004.04148 [cond-mat.mes-hall]. [21] C. Rubio-Verdú, S. Turkel, L. Song, L. Klebl, R. Samajdar, M. S. Scheurer, J. W. F. Venderbos, K. Watanabe, T. Taniguchi, H. Ochoa, L. Xian, D. Kennes, R. M. Fernandes, Ángel Rubio, and A. N. Pasupathy, "Universal moiré nematic phase in twisted graphitic systems," (2020), arXiv:2009.11645 [cond-mat.str-el]. [22] R. Samajdar, M. Scheurer, S. Turkel, C. Rubio-Verdú, A. Pasupathy, J. Venderbos, and R. M. Fernandes, "Electric-field-tunable electronic nematic order in twisted double-bilayer graphene," 2D Materials 8 (2021). [23] U. Zondiner, A. Rozen, D. Rodan-Legrain, Y. Cao, R. Queiroz, T. Taniguchi, K. Watanabe, Y. Oreg, F. von Oppen, A. Stern, E. Berg, P. Jarillo-Herrero, and S. Ilani, "Cascade of phase transitions and dirac revivals in magic-angle graphene," Nature 582, 203 (2020). [24] D. Wong, K. P. Nuckolls, M. Oh, B. Lian, Y. Xie, S. Jeon, K. Watanabe, T. Taniguchi, B. A. Bernevig, and A. Yazdani, "Cascade of electronic transitions in magic-angle twisted bilayer graphene," Nature 582, 198 (2020). [25] M. Christos, S. Sachdev, and M. S. Scheurer, "Superconductivity, correlated insulators, and wess­zumino­witten terms in twisted bilayer graphene," Proceedings of the National Academy of Sciences 117, 29543­29554 (2020). [26] J. Kang, B. A. Bernevig, and O. Vafek, "Cascades between light and heavy fermions in the normal state of magic angle twisted bilayer graphene," arXiv e-prints , arXiv:2104.01145 (2021), arXiv:2104.01145

[cond-mat.str-el]. [27] M. S. Scheurer and R. Samajdar, "Pairing in graphene-
based moiré superlattices," Phys. Rev. Research 2, 033062 (2020). [28] C. Zhang, T. Zhu, S. Kahn, S. Li, B. Yang, C. Herbig, X. Wu, H. Li, K. Watanabe, T. Taniguchi, S. Cabrini, A. Zettl, M. P. Zaletel, F. Wang, and M. F. Crommie, "Visualizing delocalized correlated electronic states in twisted double bilayer graphene," Nature Communications 12, 2516 (2021). [29] X. Liu, C.-L. Chiu, J. Y. Lee, G. Farahi, K. Watanabe, T. Taniguchi, A. Vishwanath, and A. Yazdani, "Spectroscopy of a tunable moirésystem with a correlated and topological flat band," Nature Communications 12, 2732 (2021). [30] J. M. Park, Y. Cao, K. Watanabe, T. Taniguchi, and P. Jarillo-Herrero, "Tunable strongly coupled superconductivity in magic-angle twisted trilayer graphene," Nature 590, 249­255 (2021). [31] Z. Hao, A. M. Zimmerman, P. Ledwith, E. Khalaf, D. H. Najafabadi, K. Watanabe, T. Taniguchi, A. Vishwanath, and P. Kim, "Electric field­tunable superconductivity in alternating-twist magic-angle trilayer graphene," Science 371, 1133­1138 (2021). [32] Y. Cao, J. M. Park, K. Watanabe, T. Taniguchi, and P. Jarillo-Herrero, "Large Pauli Limit Violation and Reentrant Superconductivity in Magic-Angle Twisted Trilayer Graphene," arXiv e-prints , arXiv:2103.12083 (2021), arXiv:2103.12083 [cond-mat.mes-hall]. [33] E. Khalaf, A. J. Kruchkov, G. Tarnopolsky, and A. Vishwanath, "Magic angle hierarchy in twisted graphene multilayers," Physical Review B 100 (2019), 10.1103/physrevb.100.085109. [34] S. Carr, C. Li, Z. Zhu, E. Kaxiras, S. Sachdev, and A. Kruchkov, "Ultraheavy and ultrarelativistic dirac quasiparticles in sandwiched graphenes," Nano Letters 20, 3030­3038 (2020). [35] C. Mora, N. Regnault, and B. A. Bernevig, "Flatbands and perfect metal in trilayer moiré graphene," Phys. Rev. Lett. 123, 026402 (2019). [36] D. Calugaru, F. Xie, Z.-D. Song, B. Lian, N. Regnault, and B. A. Bernevig, "Twisted symmetric trilayer graphene: Single-particle and many-body Hamiltonians and hidden nonlocal symmetries of trilayer moiré systems with and without displacement field," Phys. Rev. B 103, 195411 (2021), arXiv:2102.06201 [cond-mat.str-el]. [37] J. Shin, B. L. Chittari, and J. Jung, "Stacking and gate tunable topological flat bands, gaps and anisotropic strip patterns in twisted trilayer graphene," (2021), arXiv:2104.01570 [cond-mat.mes-hall]. [38] C. Lei, L. Linhart, W. Qin, F. Libisch, and A. H. MacDonald, "Mirror symmetry breaking and lateral stacking shifts in twisted trilayer graphene," (2021), arXiv:2010.05787 [cond-mat.mes-hall]. [39] A. Ramires and J. L. Lado, "Emulating heavy fermions in twisted trilayer graphene," arXiv e-prints , arXiv:2102.03312 (2021), arXiv:2102.03312 [condmat.mes-hall]. [40] Y. W. Choi and H. J. Choi, "Dichotomy of ElectronPhonon Coupling in Graphene Moire Flat Bands," arXiv e-prints , arXiv:2103.16132 (2021), arXiv:2103.16132

27

[cond-mat.mes-hall]. [41] E. Lake and T. Senthil, "Re-entrant Superconductiv-
ity Through a Quantum Lifshitz Transition in Twisted Trilayer Graphene," arXiv e-prints , arXiv:2104.13920 (2021), arXiv:2104.13920 [cond-mat.supr-con]. [42] W. Qin and A. H. MacDonald, "In-plane critical magnetic fields in magic-angle twisted trilayer graphene," arXiv e-prints , arXiv:2104.14026 (2021), arXiv:2104.14026 [cond-mat.mes-hall]. [43] A. Fischer, Z. A. H. Goodwin, A. A. Mostofi, J. Lischner, D. M. Kennes, and L. Klebl, "Unconventional Superconductivity in Magic-Angle Twisted Trilayer Graphene," arXiv e-prints , arXiv:2104.10176 (2021), arXiv:2104.10176 [cond-mat.supr-con]. [44] Y.-Z. Chou, F. Wu, J. D. Sau, and S. D. Sarma, "Correlation-induced triplet pairing superconductivity in graphene-based moiré systems," (2021), arXiv:2105.00561 [cond-mat.supr-con]. [45] M. Xie and A. MacDonald, "Nature of the correlated insulator states in twisted bilayer graphene," Physical Review Letters 124 (2020), 10.1103/physrevlett.124.097601. [46] N. Bultinck, E. Khalaf, S. Liu, S. Chatterjee, A. Vishwanath, and M. P. Zaletel, "Ground state and hidden symmetry of magic angle graphene at even integer filling," (2019), arXiv:1911.02045 [cond-mat.str-el]. [47] S. Liu, E. Khalaf, J. Y. Lee, and A. Vishwanath, "Nematic topological semimetal and insulator in magic-angle bilayer graphene at charge neutrality," Physical Review Research 3 (2021), 10.1103/physrevresearch.3.013033. [48] Y.-D. Liao, X.-Y. Xu, Z.-Y. Meng, and J. Kang, "Correlated insulating phases in the twisted bilayer graphene*," Chinese Physics B 30, 017305 (2021). [49] N. Bultinck, S. Chatterjee, and M. P. Zaletel, "Mechanism for anomalous hall ferromagnetism in twisted bilayer graphene," Physical Review Letters 124 (2020), 10.1103/physrevlett.124.166601. [50] Y. Zhang, K. Jiang, Z. Wang, and F. Zhang, "Correlated insulating phases of twisted bilayer graphene at commensurate filling fractions: A hartree-fock study," Physical Review B 102 (2020), 10.1103/physrevb.102.035136. [51] P. Stepanov, I. Das, X. Lu, A. Fahimniya, K. Watanabe, T. Taniguchi, F. H. L. Koppens, J. Lischner, L. Levitov, and D. K. Efetov, "Untying the insulating and superconducting orders in magic-angle graphene," Nature 583, 375 (2020). [52] X. Liu, Z. Wang, K. Watanabe, T. Taniguchi, O. Vafek, and J. I. A. Li, "Tuning electron correlation in magicangle twisted bilayer graphene using coulomb screening," Science 371, 1261 (2021). [53] Y. Saito, J. Ge, K. Watanabe, T. Taniguchi, and A. F. Young, "Independent superconductors and correlated insulators in twisted bilayer graphene," Nature Physics 16, 926 (2020). [54] R. Samajdar and M. S. Scheurer, "Microscopic pairing mechanism, order parameter, and disorder sensitivity in moiré superlattices: Applications to twisted doublebilayer graphene," Phys. Rev. B 102, 064501 (2020). [55] E. Khalaf, S. Chatterjee, N. Bultinck, M. P. Zaletel, and A. Vishwanath, "Charged skyrmions and topological origin of superconductivity in magic-angle graphene," Sci-

ence Advances 7 (2021), 10.1126/sciadv.abf5299. [56] N. N. T. Nam and M. Koshino, "Lattice relaxation and
energy band modulation in twisted bilayer graphene," Phys. Rev. B 96, 075311 (2017). [57] S. Carr, S. Fang, Z. Zhu, and E. Kaxiras, "Exact continuum model for low-energy electronic states of twisted bilayer graphene," Physical Review Research 1, 013001 (2019), arXiv:1901.03420 [cond-mat.mes-hall]. [58] G. Tarnopolsky, A. J. Kruchkov, and A. Vishwanath, "Origin of magic angles in twisted bilayer graphene," Physical Review Letters 122 (2019), 10.1103/physrevlett.122.106405. [59] B. A. Bernevig, Z.-D. Song, N. Regnault, and B. Lian, "Tbg iii: Interacting hamiltonian and exact symmetries of twisted bilayer graphene," (2020), arXiv:2009.12376 [cond-mat.str-el]. [60] B. Lian, Z.-D. Song, N. Regnault, D. K. Efetov, A. Yazdani, and B. A. Bernevig, "TBG IV: Exact Insulator Ground States and Phase Diagram of Twisted Bilayer Graphene," arXiv e-prints , arXiv:2009.13530 (2020), arXiv:2009.13530 [cond-mat.str-el]. [61] J. Kang and O. Vafek, "Strong coupling phases of partially filled twisted bilayer graphene narrow bands," Phys. Rev. Lett. 122, 246401 (2019). [62] A. H. Castro Neto, F. Guinea, N. M. R. Peres, K. S. Novoselov, and A. K. Geim, "The electronic properties of graphene," Rev. Mod. Phys. 81, 109 (2009). [63] Note that the term c2, which comes from the Hartree term, turns out to be numerically very small. [64] S. Chatterjee, N. Bultinck, and M. P. Zaletel, "Symmetry breaking and skyrmionic transport in twisted bilayer graphene," Phys. Rev. B 101, 165141 (2020). [65] P. M. R. Brydon, S. Das Sarma, H.-Y. Hui, and J. D. Sau, "Odd-parity superconductivity from phononmediated pairing: Application to cuxbi2se3," Phys. Rev. B 90, 184512 (2014). [66] M. S. Scheurer, "Mechanism, time-reversal symmetry, and topology of superconductivity in noncentrosymmetric systems," Phys. Rev. B 93, 174509 (2016). [67] S. Chatterjee, M. Ippoliti, and M. P. Zaletel, "Skyrmion Superconductivity: DMRG evidence for a topological route to superconductivity," arXiv e-prints , arXiv:2010.01144 (2020), arXiv:2010.01144 [condmat.str-el]. [68] A. P. Mackenzie and Y. Maeno, "The superconductivity of sr2ruo4 and the physics of spin-triplet pairing," Rev. Mod. Phys. 75, 657 (2003). [69] Y. H. Kwan, G. Wagner, T. Soejima, M. P. Zaletel, S. H. Simon, S. A. Parameswaran, and N. Bultinck, "Kekulé spiral order at all nonzero integer fillings in twisted bilayer graphene," arXiv e-prints , arXiv:2105.05857 (2021), arXiv:2105.05857 [cond-mat.str-el]. [70] C. Gutiérrez, C.-J. Kim, L. Brown, T. Schiros, D. Nordlund, E. B. Lochocki, K. M. Shen, J. Park, and A. N. Pasupathy, "Imaging chiral symmetry breaking from Kekulé bond order in graphene," Nature Physics 12, 950 (2016). [71] S.-Y. Li, Y. Zhang, L.-J. Yin, and L. He, "Scanning tunneling microscope study of quantum Hall isospin ferromagnetic states in the zero Landau level in a graphene monolayer," Phys. Rev. B 100, 085437 (2019), arXiv:1904.06902 [cond-mat.mes-hall].

28

[72] B. A. Bernevig, B. Lian, A. Cowsik, F. Xie, N. Regnault, and Z.-D. Song, "TBG V: Exact Analytic Many-Body Excitations In Twisted Bilayer Graphene Coulomb Hamiltonians: Charge Gap, Goldstone Modes and Absence of Cooper Pairing," arXiv e-prints , arXiv:2009.14200 (2020), arXiv:2009.14200 [cond-mat.str-el].

[73] This means that its adjacency graph is strongly connected. In our case, it corresponds to the situation that one can scatter between any pair of momenta via some number of virtual states; at least for D0 = 0, this is generically expected to be the case.

Appendix A: Hamiltonian for the system
Here we will state the detailed form of the interacting Hamiltonian of MSTG used in our work, discuss the relevant symmetries and their representation in the basis employed in this paper, and their consequences for the form factors.

1. Continuum model and low-energy degrees of freedom

To describe the non-interacting bands, we use a continuum model, which is just the three-layer version of the

continuum model of TBG [16­18]. Let ck;,l,,s,G denote the operator annihilating an electron at crystalline momentum k in the moiré Brillouin zone (MBZ), in sublattice  = A, B and valley  = ± of the microscopic graphene sheets,

of G

spin =

s =, , j nj GM j ,

and nj 

wZi,twh itrhecGiprM 1oc=al-lat3tikce(1(,RL3))Tve/c2toarndGGoM 2f

themoiré lattice, thus, forming a triangular lattice; = 3k(1, 0)T , where k represents the magnitude of

the vector connecting the K and K points in the MBZ.

Before writing down the Hamiltonian, we follow [33] and perform a unitary transformation in layer space,

ck;,l,,s,G = Vl, k;, ,,s,G,





1 1 0 -1

V =  0 2 0 

2



10 1

(A1)

that decomposes the system into mirror-even ( = 1, 2) and mirror-odd ( = 3) subspaces (for D0 = 0), as will become apparent below. The full continuum model reads as

H0Full =

k ;, ,,s,G (hk, ), ,G; , ,G k; , ,,s,G ,

kMBZ , =A,B , =1,2,3 =± s=, G,G RL

(A2)

where hk, = h(kg,) + h(kt,) + h(kD) with the decoupled-layer graphene Hamiltonian

h(kg,+) , ,G; , ,G =  , G,G vF ( ), k + G - (-1) q1/2 ,

h(kg,-) , ,G; , ,G =

h(-gk) ,+

 , ,-G; ,

,-G

,

(A3) (A4)

 = ei3/2e-i3/2, q1 connecting the K and K' points in the MBZ. Throughout the appendix, k  MBZ is measured relative to the M point of the moiré Brillouin zone. The contribution



h(kt,)+

, ,G; ,

,G



0

= 2 (TG -G) ,

(TG-G ), 0

0

0

 0
0 , 
0

h(kt,)- , ,G; , ,G =

h(-t)k,+

 , ,-G; ,

,-G

(A5)

to the Hamiltonian describes the tunnelling that is modulated on the moiré lattice. We use the usual BM form [17],

0 j

TG =

G+Aj,0 w00 + w1 -j 0

,

j=0,1,2



=

e-i

2 3

,

A0 = 0,

A1 = G1,

A2 = G1 + G2.

(A6) (A7)

29

Note that it holds TG = TG and xTGx = TG. So we see very clearly in this basis that the Hamiltonian is given by the sum of the TBG continuum model (with rescaled interlayer couplings) and a single graphene cone. This is
different once a displacement field is applied, D0 = 0; its contribution to the Hamiltonian reads as

 001

h(kD)

, ,G; ,

,G

= -D0, G,G

0 

0

0 

,

100

,

(A8)

which is seen to couple the different mirror-eigenvalue sectors, as it breaks the mirror symmetry.
Here and in the following we use the same symbol with subscript j = 0, 1, 2, 3 for Pauli matrices and the associated quantum numbers: j are Pauli matrices in sublattice, sj in spin, and j in valley space.
The Hamiltonian H0Full can be diagonalized by solving the eigenvalue problem

hk,un,(k) = n(k)un,(k)

(A9)

at every k  MBZ and defining new fermionic operators fk;n,,s = , ,G[un,(k)], ,Gk;, ,,s,G. In this work, we will mostly focus on the four bands (for each spin and valley flavor) that are closest to the charge-
neutrality point. Let us label them by the multi-index n = (t, p) with p = ±, t = g, b indicating whether these bands
are graphene-like or TBG-like. To make the association unique, we use the conventions

p (t,p),(k)  0,

| (b,p),(k)|  | (g,p),(k)|.

(A10)

In this way, the graphene-like (TBG-like) bands transition to the single-layer graphene (TBG) band structure for D0  0. But Eq. (A10) allows us to generalize this notion to non-zero D0. We will further introduce the notation

bk;p,,s := fk;(b,p),,s,

gk;p,,s := fk;(g,p),,s

(A11)

on the level of electronic field operators. Our non-interacting, low-energy Hamiltonian then reads as

H0 =

WTBG (b,p),(k)bk;p,,sbk;p,,s + (g,p),(k)gk ;p,,sgk;p,,s

kMBZ =± s=, p=±

(A12)

and in total contains 24 = 16 bands, associated with valley, spin, Dirac, and even-odd mirror space. In Eq. (A12), we introduced the dimensionless parameter WTBG  [0, 1]. In the real system, we have WTBG = 1 and we define WTBG = 0 as the flat-band limit. In Appendix F 2 below, we will compute the effect of the dispersion to second order in WTBG.

2. Single-particle symmetries
As it will play an important role for our analysis of the correlated phases in the system, we will here list the relevant symmetries of the continuum-model Hamiltonian (A2) and their representation on our low-energy degrees of freedom bk;p,,s and gk;p,,s in Eq. (A12).
We distinguish four different classes of symmetries:
1. moiré translations, which we will assume to be preserved throughout and, hence, will not have to be considered explicitly here.
2. spin and charge conservation symmetries: since we do not take into account spin-orbit coupling nor the for small twist angles suppressed intervalley tunneling processes, the Hamiltonian is invariant under spin and U(1) phase rotations in each valley  = ± separately.
3. point symmetries, forming the point group C6 (for D0 = 0) or C6h (when D0 = 0).
4. additional internal symmetries: the anti-unitary time-reversal symmetry , the chiral symmetry C, and the unitary particle-hole symmetry P .

30

While all other symmetries leave H0 invariant, the "anti-commuting symmetries" C and P send H0  -H0. Note that C is only an anti-commuting symmetry if w0 = 0 in Eq. (A6) (but persists for D0 = 0), while P is only present if D0 = 0 (but persists for w0 = 0). So the removal of the unitary particle hole symmetry in the TBG-like subspace upon turning on D0 is a novel aspect of the trilayer system as it is always a symmetry in TBG (at least within the analogous continuum-model description). Among the point symmetries, the mirror symmetry h is only present if D0 = 0, similar to C2x in TBG.
In Table V, we list the action of point and internal symmetries on the microscopic operators k in Eq. (A2) and
on the low-energy operators bk;p,,s and gk;p,,s. The latter representations have to be understood as a gauge-fixing condition; the gauge-fixing conventions we use here, closely follow [59]. For instance, we choose the phase of the wavefunctions (modulo remaining ± sign) in Eq. (A9) such that C2zun,(k) = 1[un,(k)] = un,(k).
To illustrate the gauge fixing and for later reference, we discuss it explicitly for D0 = 0 in the mirror-odd sector bands ( = 3). As detailed in Appendix A 1, the Hamiltonian in this sector is simply that of single-layer graphene
and, in our notation of Eq. (A3), given by

h(ke,)+ , ,G; , ,G =  ,3 ,3G,G vF ( ), (k + G + q1/2)

(A13)

in valley  = + (the wavefunctions in the other valley will simply follow from C2z and ). Since Eq. (A13) is already diagonal in the G indices, the wavefunctions simply follow from diagonalization of the structure in sublattice space. Focusing, as above, on the lowest bands, we have

i(1-p)/2

u(g,p),+(k) , ,G =   G,-Gk+q1/2 ,3

 2

pe-i(k-)/2 ,
ei(k -)/2

p = ±1,

eik = kx + iky , |k|

k = MBZ(k + q1/2),

(A14)

where we defined the notation Gk to indicate the reciprocal lattice vector that folds k back to the MBZ, i.e., k - Gk  MBZ. Furthermore, we write MBZ(k) := k - Gk for the momentum folded back into the MBZ.
Modulo a (in general k and p dependent) minus sign to be discussed shortly, the phase of the wavefunctions has

been chosen such that ("real gauge")

C2zu(g,p),+(k)  1[u(g,p),+(k)] = un,+(k).

(A15)

The relative minus sign between p = + and p = - has been fixed in Eq. (A14) to ensure the behavior,

Cu(g,p),+(k)  -3Cu(g,p),+(k) = -p i u(g,-p),+(k),

(A16)

under C given in Table V. Note that the relative minus sign at different k is simply determined by continuity of u(g,p),+(k) as a function of k (away from K/K ).
Finally, we furthermore fixed the relative signs between wavefunctions at k and k + G1, G1  RL, to be +1 ("periodic gauge"),

u(g,p),+(k + G1) , ,G = u(g,p),+(k) , ,G+G1 ,

(A17)

which follows readily from Eq. (A14) by noting that Gk+G1 = Gk + G1, for all G1  RL. With these symmetry representations at hand, it is very simple to see that the band structure of the TBG-like band
in Eq. (A12) has the form,

(b,p),(k) = p E0b(k) +  E1b(k) + p  E2b(k) + E3b(k),

(A18)

where E1b (E2b) can only be non-zero if the same holds for w0 (D0) such that C (P ) is broken; E3b = 0 requires w0, D0 = 0 simultaneously. Furthermore, it holds Ejb(k) = Ejb(-k), for j = 0, 3, and Ejb(k) = -Ejb(-k), for j = 1, 2,
due to . Clearly, the band structure for finite D0 shown in Fig. 2(b) can only be consistent with Eq. (A18) if E2b(k) = 0, which is consistent with our observation that P must be broken when D0 = 0.
For later reference we introduce the following notation: for any quantity q({xk}) (such as Ejb here) that depends
on a set of parameters xk (here D0 or w0), we introduce q¯ via

q({xk}) = q¯({xk}) (xk)nk , with maximal nk such that we still have lim |q¯({xk})| < .
xk 0 k

(A19)

31

TABLE V: Action of the symmetries of the continuum theory on the microscopic field operators (k) and in the band basis (bk and gk). Although redundant, we have added the relevant k-local combinations C2z and C2zP of the symmetries for convenience of the reader. Note that our choice of action of P in the graphene-like subspace is not independent from the other symmetries (it is related to C, C2z, combined with a valley rotation symmetry). As indicated, P (and, hence, C2zP ) only anti-commutes with the Hamiltonian if we neglect the rotation of the Pauli matrices  in Eq. (A3), which becomes asymptotically valid for small twist angles. As in the main text, j act in valley, j in band, sj in spin, and j in sublattice space.

Symmetry S C2z C3z h  C
P
C2z 
C2z P

unitary     




H0  ±H0 + + + + -
-
+
-

Sk; ,GS

11-k; ,-G

e  i

2 3

3

3

C3z k; ,C3z G

(1, 1, -1) k; ,G

1-k; ,-G

(1, 1, -1) 3k; ,G





0 3 0

-3 0

0

 

-k; ,-G

0 0 i22 ,

 0

1k; ,G
 -i21 0

i21 0

0

 

k; ,G

0

0 -i33 ,

SbkS 10b-k 00bC3z k 00bk 10b-k 32bk
-i32b-k
00bk
22bk

SgkS 10g-k 00gC3z k -00gk 10g-k 32gk
i12g-k
00gk
i2gk

condition -- --
D0 = 0 --
w0 = 0
D0 = 0,   0
--
D0 = 0,   0

This allows us to organize our perturbation theory. For instance, Eq. (A18) can then be written in the more informative way

(b,p),(k) = p E¯0b(k) +  E¯1b(k) w0 + p  E¯2b(k) D0 + E¯3b(k) w0D0.

(A20)

Similarly, we can analyze the properties of the graphene-like bands. As anticipated above, P , when present, does not lead to additional constraints and one readily concludes that

(g,p),(k) = p E¯0g(k; ) + E¯1g(k; ) w0D0,

(A21)

where we noticed that the graphene-like bands still have a chiral symmetry for D0 = 0 even if w0 = 0.  dictates that E¯jg(k; ) = E¯jg(-k; -). Note that, throughout this work (cf. Fig. 2), we will label the valleys such that | (g,p),+(k)| < | (g,p),-(k)| for k near the K point.

3. Interaction and form factors

We follow a variety of previous works on moiré graphene systems [45­50, 60] and study a density-density interaction

H1Full

=

1 2N

V (q) : FqullF-uqll :,

q

(A22)

with : ... : indicating normal ordering and

Fqull =

M BZ(k+q);, ,,s,G+Gk+q k;, ,,s,G

kMBZ , ,,s,G

(A23)

denoting the Fourier transform of the electron density, where, as above, q = MBZ(q) + Gq with MBZ(q)  MBZ. Furthermore, V (q) in Eq. (A22) is the momentum-space interaction potential. For our analytical analysis, we will not have to specify the precise form of V (q) and will only use that V (q) = V (-q) > 0. For our numerical computations we use V (q) as given in Eq. (2.9).

32

Similar to our discussion of the non-interacting theory, we transform to the eigenbasis of H0 and only keep the lowest four bands per spin and valley; the resulting projected interaction then reads as

1 H1 = 2N V (q) : q-q :,
q

q =

fM BZ(k+q);(t,p),,s

kMBZ =± s=, t,t =b,g p,p =±

where all the microscopic details are encoded in the form factors

Fk,q

(t,p),(t ,p ) fk;(t ,p ),,s, (A24)

Fk,q n,n :=

[un,(MBZ(k + q))], ,G+Gk+q [un ,(k)], ,G .

, ,G

(A25)

In order to make sure that the projected interaction respects (many-body) particle-hole symmetry, we follow [59] and first rewrite the unprojected interaction (A22) as

H1Full

=

1 2N

V (q)FqullF-uqll + . . . ,

q

Fqull =

M BZ(k+q);,

,,s,G+Gk+q k;,

,,s,G

-

1 2 q,0

,

kMBZ , ,,s,G

(A26)

where . . . just represent irrelevant constants and chemical potential terms. The wavefunctions in Eq. (A9) obey the

completeness relation

[un,(k)]1, 1,G1 [un,(k)]2, 2,G2 = 1,2  1, 2 G1,G2 .
n

(A27)

Setting 1 = 2 = , 1 = 2 = , G1 = G, and G2 = G + G and summing both sides of Eq. (A27) over , , and G, we get

Fk,G

=
n,n

G ,0,

n

, ,G

(A28)

where the sum over n is over all bands. Using this property we rewrite the full density in Eq. (A26) as

Fqull =

fM BZ(k+q);n,,s

Fk,q

1 n,n fk;n ,,s - 2 n,n

Fk,G

q,G
n,n

.

kMBZ n,n ,,s

GRL

(A29)

So far, this is still an exact rewriting of the full interaction. However, in this form, the projection of the interaction to the low-energy bands (graphene-like and TBG-like) in a way that respects particle-hole symmetry is particularly natural: one simply has to restrict the sum over n, n in Eq. (A29) to those bands. Defining for notational convenience

(Fk,q )((t,p),,s),((t ,p ), ,s ) = s,s , we then arrive at the final form of the projected interaction

Fk,q

,
(t,p),(t ,p )

(A30)

1 H1 = 2N V (q)q-q,
q

q =

fM BZ(k+q)Fk,q fk

-

1 2

q,Gtr(Fk,G) .

kMBZ

GRL

(A31)

Let us next discuss properties of these form factors. While we have computed these form factors numerically

using the continuum model, we can make analytical progress by exploiting constraints on them. First, Hermiticity, q = -q, implies

Fk,q


=
n ,n

FM BZ(k+q),-q n,n

and, specifically,

Fk,G


=
n ,n

Fk,-G

.
n,n

(A32)

Furthermore, since the density operator Fqull and, by design, its projection q transforms as a scalar function of the vector q under all regular and anti-commuting symmetries of H0 in Table V, we obtain further constraints on the
form factors. Using all k-local operators listed in Table V one finds after straightforward algebra:

Fk,q (b,p),(b,p ) = F¯1bb(k, q)(0)p,p + iF¯2bb(k, q)(2)p,p + F¯3bb(k, q)(0)p,p + iF¯4bb(k, q)(2)p,p D02 + F¯5bb(k, q)(1)p,p + F¯6bb(k, q)(3)p,p w0 + F¯7bb(k, q)(1)p,p + F¯8bb(k, q)(3)p,p w0D02,

(A33a)

33

Fk,q (g,p),(g,p ) = F¯1gg(k, q)(0)p,p + iF¯2gg(k, q)(2)p,p + F¯3gg(k, q)(0)p,p + iF¯4gg(k, q)(2)p,p

(A33b)

+ F¯5gg(k, q)(1)p,p + F¯6gg(k, q)(3)p,p + F¯7gg(k, q)(1)p,p + F¯8gg(k, q)(3)p,p w0D02,

Fk,q

=
(g,p),(b,p )

F¯1gb(k, q)(0)p,p + iF¯2gb(k, q)(2)p,p + F¯3gb(k, q)(0)p,p + iF¯4gb(k, q)(2)p,p

+ F¯5gb(k, q)(1)p,p + F¯6gb(k, q)(3)p,p + F¯7gb(k, q)(1)p,p + F¯8gb(k, q)(3)p,p

D0 w0D0,

(A33c)

while (Fk,q)(b,p),(g,p ) follows from Eq. (A32), i.e.,

F¯jg,b(k, q) = F¯jb,g(MBS(k + q), -q).

(A34)

In Eq. (A33), all expansion co-efficients are real, Fjtt (k, q)  R, and we again employed the convenient notation defined in Eq. (A19) to make their leading parameter dependence visible. While, by construction, all of the terms in F(g,p),(g,p ) and F(g,p),(b,p ) are absent in the previously studied TBG system, also half of the terms (Fjbb, j = 3, 4, 7, 8) entering F(g,p),(g,p ) in Eq. (A33a) are unique to MSTG, as they can only be non-zero if D0 = 0.
Note that Fjbb, j = 3, 4, 7, 8, have to be even functions of D0 at generic momenta and, hence, start at order D02, which can be seen by noting that h transforms the continuum model Hamiltonian hk,(D0) to hk,(-D0); the eigenstates,
un,(k; D0), in Eq. (A9) thus obey hun,(k; D0) = ±un,(k; -D0). Alternatively, it is also clear from the structure
of (non-degenerate) perturbation theory in D0: corrections to matrix elements of states that have the same eigenvalue under h can only appear in even orders of perturbation theory. The same line of reasoning shows that all Fjgb have to be odd functions of D0, as indicated in Eq. (A33c).
In addition, C2z implies that

Fjtt (k, q) = Fjtt (-k, -q), Fjtt (k, q) = -Fjtt (-k, -q),

j = 1, 2, 7, 8, j = 3, 4, 5, 6.

(A35)

The Hermiticity constraint in Eq. (A32) further implies for the form factors with t = t that

Fjtt(k, G) = Fjtt(k, -G), j = 1, 3, 5, 6, 7, 8, Fjtt(k, G) = -Fjtt(k, -G), j = 2, 4.

(A36)

For later reference, we combine this with Eq. (A35) above to obtain

Fjtt(k, G) = Fjtt(-k, G), j = 1, 4, 7, 8 Fjtt(k, G) = -Fjtt(-k, G), j = 2, 3, 5, 6.

(A37)

Although we will not use C3z constraints on the form factors explicitly in our analytical considerations, we note that it further forces the momentum dependence of all pre-factors to obey Fjtt (k, q) = Fjtt (C3zk, C3zq).
Finally, we point out that Fk,q=0 = 1, for all k  MBZ, as readily follows from the definition (A25). As such, we
have

Fjtt (k, q = 0) = j,1t,t .

(A38)

The form factors of the mirror-odd (graphene) subsystem for D0 = 0 can be readily computed from the wavefunctions defined in Eq. (A14). One finds

F =  +
k,q (g,p),(g,p )

Gk+q+

q1 2

,Gk+

q1 2

p,p cos

(k+q) - k 2

+ i(y)p,p sin

(k+q) - k 2

.

(A39)

Note that this agrees with the symmetry-based structure given in Eq. (A33b). On top of this, we observe that the matrix elements obey

Fk,G

= G,0p,p .
(g,p),(g,p )

(A40)

We will use both the explicit form in Eq. (A39) as well as the special property (A40) of the graphene matrix elements below.

34

Appendix B: Exact statements about the interacting groundstates

In this appendix, we will discuss limits where exact many-body groundstates of MSTG can be derived. To this
end, we will focus on D0 = 0, where the non-interacting part of the Hamiltonian, H0, is just given by the sum of the TBG continuum model, H0b, and that of single-layer graphene, H0g. Importantly, the presence of mirror symmetry h also leads to Fjgb(k, q) = Fjbg(k, q) = 0, see Eq. (A33c). Consequently, the density operator q in Eq. (A24) and its symmetrized cousin q in Eq. (A31) are just given by the sum of the contributions from the graphene (g) and TBG (b) subsystem. Focusing on , we have q = gq + bq
with



gq =



gM BZ(k+q);µ

kMBZ µ,µ

Fkg,gq



1

µ,µ

gk;µ

- 2

q,Gtr(Fkg,gG) ,

GRL

(B1)





bq =



bMBZ(k+q);µ

Fkb,bq

µ,µ bk;µ

1 -
2

q,Gtr(Fkb,bG) ,

kMBZ µ,µ

GRL

(B2)

where we introduced the multi-indices comprising band, valley, and spin, µ = (p, , s), and the submatrix form factors in the respective subsystem, (Fktt,q)(p,,s),(p , ,s ) := s,s , (Fk,q)(t,p),(t,p ). Notwithstanding this simplification, the interaction in Eq. (A31) still couples the graphene and TBG subsystem and it is not clear how this will affect the
groundstates. In particular, it is unclear whether one can still write down exact eigenstates (or even groundstates) of
the combined system, as has been done in TBG [60], and whether the system will also exhibit order in the graphene
subspace.

1. Turning on the coupling between the subsystems

To address these questions, we split the projected Hamiltonian of the system into three parts,

H0 + H1 = Hg + Hb + Hgb,

(B3)

where

Hg =

pE0g(k; )gk ;p,,sgk;p,,s

+

1 2N

V (q)gqg-q

kMBZ ,p=± s=,

q

(B4)

is just the usual Hamiltonian of graphene with Coulomb interaction, while

Hb = WTBG

(p E¯0b(k)

+



E¯1b(k) w0)bk;p,,sbk;p,,s

+

1 2N

V (q)bqb-q

kMBZ ,p=± s=,

q

(B5)

is the TBG Hamiltonian, consisting of the quasi-flat bands interacting via a projected density-density interaction. We further introduced the dimensionless parameter  that allows us to adiabatically turn on the density-density interaction,

Hgb =  N

V (q)g-qbq

q

(B6)

between the two subsystems, with  = 1 corresponding to the physical system. Let us start with  = 0, where the Hamiltonian is given by Hg+Hb. Being the sum of the two commuting subsystem
Hamiltonians, its eigenstates are just given by all combinations of the individual eigenstates of graphene and TBG.
As discussed in more detail in the main text, the ground state of the graphene subspace is a symmetry-unbroken correlated semimetal. We denote its ground state by |g0(b) and its (gapless) excited states by |gj (b) , j > 0, where b indicates that the filling fraction of the graphene sector is a function of the filling b in the TBG sector. We will here focus on b = 0, ±1, ±2, ±3, ±4.
The exact ground states of certain limits of Hb in Eq. (B5) at integer filling fractions b have been discussed in detail in [60] and we next use these insights, within our notation, and transfer them to MSTG. First, one can see from
Eq. (A33a) that the TBG form factors become

F¯kb,bq = F¯1bb(k, q)0 + iF¯2bb(k, q)2

(B7)

35

in the chiral-decoupled limit (w0 = D0 = 0). We can, hence, bring the form factors and density operators to a diagonal form by introducing another set of field-operators,

bq =

F¯cbb(k, q)

~bMBZ(k+q);c,,s~bk;c,,s

-

1 2

q,G , ~bk;c,,s = Uc,pbk;p,,s,

kMBZ ,c=±,s

GRL

where F¯±bb(k, q) = F¯1bb(k, q) ± iF¯2bb(k, q). As is readily verified, the following set of states [60]

U = 1 2

1 -i , 1i
(B8)

|b0 (b)

c

=

~b
k;c,jcc ,scjc

|0b

kMBZ c=± jc=1

(B9)

with + + - = b obey

bq |b0 (b) =

q,GRG |b0 (b) ,

GRL

RG = b F1bb(k, G),
k

(B10)

in the chiral limit, w0 = 0, for arbitrary combinations of occupied spin/valley-flavors {j±, s±j }. Consequently, all of these states are eigenstates of Hb in the flat-limit, i.e., when WTBG = 0 (or right at the magic angle for w0 = 0 where the bands become perfectly flat). It can further be shown [60] that all |b0(b) in Eq. (B9) are groundstates of Hb
for b = 0 and that the same holds for all integer b = 0, if the flat-metric condition,

Fkb,bG = 1f (G),

 k, G

(B11)

applies. As argued in Ref. 60, Eq. (B11) holds approximately for realistic parameters of TBG and the |b0(b) in Eq. (B9) will remain exact ground states if it is only weakly violated. The fact that there are several exact
ground states is associated with an emergent enhanced continuous symmetry [(U(4) × U(4))b,cf] in the chiral-flat limit [46, 59, 61].
Once w0 = 0, i.e., in the nonchiral-flat limit, this symmetry group is reduced [to U(4)] and only the subset of states in Eq. (B9) where j+ = j- and s+j = s-j , which can only be defined for even b, are exact eigenstates of bq and obey Eq. (B10). They are always the exact ground states at b = 0, while this only holds if Eq. (B11) is not sufficiently violated for b = ±2. We refer to Ref. 60 for the derivations of these statements.
Having established the properties of the spectrum of the graphene subsystem and the exact groundstates of the TBG Hamiltonian, Hb, we can next address what happens when the coupling Hgb is turned on. As a first step, we
rewrite the coupling Hamiltonian in Eq. (B6) as

Hgb = 1 N

V (q) g-q bq -

q,GRG +

q,GRGg-G .

q

GRL

GRL

(B12)

Recall from Eq. (A40) that Fkg,gG = G,01, i.e., the graphene form factors obey the flat-metric condition (B11) exactly
(with f (G) = G,0) in the limit D0 = 0, we have

gG = N G,0^g,

1 ^g = N
kµ

gk ;µgk;µ

-

1 2

(B13)

and

Hgb = Hgb,0 + V (0)^g,

Hgb,0 = 1 N

V (q)g-q bq -

q,GRG .

q

GRL

(B14)

Note that the last term proportional to the filling fraction ^g of the graphene subspace is only a constant in the low-energy subspace of the system since the TBG ground states in Eq. (B9) are known to be insulators and, hence, exhibit a charge gap (in fact, also the two-particle spectrum was shown to be gapped [72]; more generally, this is also expected based on the experimental absence of superconductivity at integer filling in TBG in the vicinity of the magic angle, which implies that potential additional two-particle bound states cannot occur below the gapped particle-hole continuum).

36

Using the form of the coupling in Eq. (B14) and recalling that the exact groundstates of the TBG sector obey Eq. (B10), we immediately see that

Hgb,0 |gj |b0 (b) = 0

(B15)

for both the graphene ground state, j = 0, and its excited states, j > 0, and all exact TBG groundstates discussed above. As such, all of these states remain exact eigenstates for arbitrary .
Next, we address the question whether they remain the ground states for a finite range of  > 0. First, as we have already discussed, the TBG sector has a finite charge gap and, hence, states which involve wavefunctions where one (or more) electrons of the TBG sector are transferred to the graphene sector can only become ground states at sufficiently large . Second, since the TBG ground states break symmetries, there are gapless Goldstone modes which require a more careful analysis. This is presented in the next subsection.

2. Behavior of Goldstone modes

As follows from C3z rotational symmetry (and has been demonstrated in Ref. 72), the Goldstone spectrum of TBG

must

be

of

the

form

EG(p)

=

1 2



p2

+ O(p4),

with

(isotropic)

stiffness



>

0.

Due

to

the

arbitrarily

small

energies

of

the TBG Goldstone modes for p  0 at  = 0, we have to make sure that non-zero  will not immediately lower the

energy of these states below that of |g0 |b0(b) in MSTG. For that reason, we have to compute the evolution of the

p  0 Goldstone modes of the TBG sector upon turning on . Using momentum p to label those states, we have to

compute the behavior of their energy E(, p) (relative to |g0 |b0(b) ). Assuming that E(, p) is analytic in p,

C3z again implies that

E(, p) = 1  p2 + m() + ()p2 + O(p4) 2

(B16)

and our goal will be to determine m() and ().
To get started, let us investigate the wavefunctions of the Goldstone modes of TBG for  = 0. Fortunately, these
can be computed exactly in the chiral-flat limit [72], as the property in Eq. (B10) reduces their computation to a one-particle problem. The mathematical reason for this is that [Hb, ~bk+p;c2,2,s2~bk;c1,1,s1 ] |b0 (b) is a superposition of states of the form ~bk +p;ca,a,sa~bk ;cb,b,sb |b0 (b) . Further noting that the density operator in Eq. (B8) does not scatter states between different quantum numbers c, , s and is independent of , s, we see that the Goldstone modes
with momentum p must be of the form

|bp(b; c1, 1, s1; c2, 2, s2) =

p,c1,c2 (k)~bk+p;c2,2,s2~bk;c1,1,s1 |b0 (b) ,

k

(B17)

where the (c1, 1, s1) flavor is occupied and (c2, 2, s2) is unoccupied in the specific groundstate |b0(b) we start from. In the limit p  0, Ref. 72 has shown that one Goldstone zero mode has c1 = c2 and p=0,c,c(k) = , i.e.,

|bp0(b; c, 1, s1; c, 2, s2)

= 1 N

~bk;c,2,s2~bk;c,1,s1 |b0 (b) .
k

(B18)

All other zero-energy Goldstone modes follow from (U(4) × U(4))b,cf rotations. It is a matter of straightforward algebra to show that

bq |bp0(b; c, 1, s1; c, 2, s2) =

q,GRG |bp0(b; c, 1, s1; c, 2, s2) , RG = b F1bb(k, G)  R. (B19)

GRL

k

Since bq is invariant under (U(4) × U(4))b,cf rotations, this also holds for all other zero-energy Goldstone modes. In fact, this behavior can be understood more generally and intuitively by rewriting the Hb in Eq. (B5) (recall we always
focus on the flat-band limit, WTBG = 0) as

Hb = 1 2N

V (q) bq -

q,GRG

q

GRL

b-q -

-q,GRG

GRL

1 +
N

V

(G)RGbG

-

1 2N

V (G)RGR-G.

GRL

GRL

(B20)

37

While the last term in Eq. (B20) is just a constant, it holds

bG = N f (G)^b,

1 ^b = N
kµ

bk;µbk;µ

-

1 2

,

(B21)

if the flat-metric condition (B11) applies. Since RG = R-G, following from Eq. (A36), and as b is constant in the low-energy subspace of TBG, we can write in this subspace [61]

Hb = 1 2N

Oq Oq + const.,

q

Oq := V (q) bq -

q,GRG .

GRL

(B22)

Since all exact TBG groundstates discussed above obey Eq. (B10), or Oq |b0(b) = 0, all Goldstone modes with vanishing momentum, p  0, must be annihilated by all Oq as their energy must approach that of the groundstates. This is why Eq. (B19) must hold. Note that, for b = 0, we did not have to assume the flat-metric condition since RG = 0.
Having established Eq. (B19), we also immediately see that

Hgb,0 |gj |bp0(b; c1, 1, s1; c2, 2, s2) = 0.

(B23)

This shows that also |gj |bp0(b; c1, 1, s1; c2, 2, s2) remain exact eigenstates of the Hamiltonian for any  = 0 and that m() = 0 in Eq. (B16). Making the natural assumption that () is analytic in , we can expand

()  cnn.
n0

(B24)

Therefore, it will require a finite value of  before E(, p) can lose its positive semi-definite nature and the groundstates discussed above have to remain the groundstates in a finite region of  > 0.
As we discuss in Sec. VIII of the main text, one possibility is that at sufficiently large  a state with finite momentum p resulting from a mixing between the graphene and TBG degrees of freedom becomes the ground state. We leave a quantitative analysis of such a MDW state [25] for future work.

Appendix C: Hartree-Fock functional

1. General form

Let us assume that the ground state is the Slater determinant |[Pk] characterized by the correlator

(Pk), = [Pk]|fk;fk; |[Pk] ,

Pk = Pk = (Pk)2,

(C1)

where we use the multi-index  = ((t, p), , s) to keep the expressions more compact. The HF mean-field Hamiltonian HMF associated with H0 + H1, defined in Eqs. (A12) and (A24) contains four terms,

HMF[Pk] = HkMF + HHMF[Pk] + HFMF[Pk] + E0[Pk].

(C2)

Postponing the definition of the energetic off-set, E0, which is proportional to the identity operator, these terms are the kinetic term

HkMF = H0 =

fk;hk, (k)fk; 

fk hk (k)fk ,

kMBZ

kMBZ

(C3)

where hk is the diagonal matrix

hk((t,p),,s),((t ,p ), ,s )(k) = t,t p,p , s,s (t,p),(k)

(C4)

with (t,p), given in Eqs. (A20) and (A21), the Hartree term,

HHMF[Pk]

=

1 N

V (G)G

fk Fk,G fk ,

GRL

kMBZ

G =

tr PkFk,G ,

kMBZ

(C5)

38

and the Fock contribution

HFMF[Pk]

=

-

1 N

V (q)

fkFk,qPMT BZ(k+q)Fk,qfk.

q

kMBZ

(C6)

The associated ground state energy can be decomposed into three contributions,

EHF[Pk] = [Pk]|(H0 + H1)|[Pk] = Ek[Pk] + EH[Pk] + EF[Pk],

(C7a)

which read as

Ek[Pk] =

tr PkT hk(k) ,

kMBZ

2

1 EH[Pk] = 2N

V (G)

tr PkFkT,G ,

GRL

kMBZ

1 EF[Pk] = - 2N

V (q)

tr PkFkT,qPMBZ(k+q)Fk,q .

q

kMBZ

(C7b) (C7c) (C7d)

Having established this notation, the energetic off-set E0 in Eq. (C2) can now be conveniently stated as E0 = -EH-EF. As has been discussed in previous works on TBG [45­48], it is important to note that the continuum model defined
in Sec. A 1 already takes into account some correlation effects of the system. So using the continuum model dispersion in hk(k) in the HF mean-field Hamiltonian as defined in Eq. (C2) would constitute a double counting of these effects. To avoid this, we replace (ignoring the irrelevant constant E0[Pk0])

HkMF[Pk] - HkMF[Pk] - HHMF[Pk0] + HFMF[Pk0]

(C8)

in Eq. (C2), where Pk0 is a reference density matrix for which the continuum model dispersion is expected to be valid. The redefinition in Eq. (C8) is equivalent to replacing

hk(k) - hk(k) = hk(k) - hHF[Pk0](k),

(C9)

in Eq. (C3), where we defined hHF[Pk] such that HHMF[Pk] + HFMF[Pk] = k fkhHF[Pk](k)fk. To connect to our analytical discussion and with other work on TBG [59, 60, 72], we will use a subtraction point
such that the starting Hamiltonian of our HF analysis is equal to (modulo a constant) the non-normal ordered
but manifestly particle-hole symmetric Hamiltonian H = H0 + H1 with H1 given in Eq. (A31). It is a matter of
straightforward algebra to show that this corresponds to using Pk0 = 1/2 in Eq. (C9).

2. Numerical procedure

a. How we fix the phases in numerics

In this appendix, we describe how we fix the phases of the wavefunctions in the TBG sector in our numerics, using symmetries. As above, we denote the wavefunction in valley  = ±, at momentum k, and of band n = ± by un,,k; these are vectors in layer, sublattice, and G space.
To fix the phase of the wavefunctions (modulo ±) at every k point, , and n, we use that the Hamiltonian commutes with C2z and enforce that

C2zun,,k = un,,k.

(C10)

All that is left to do is remove the relevant parts of the remaining k, , and n dependent sign ambiguity. As a first step, we fix the relative sign of un,,k and un,-,-k by choosing

un,,k = un,-,-k.

(C11)

Because of Eq. (C10), this is equivalent to C2zun,,k = un,-,-k.

39

Next we fix the relative sign of the wavefunctions in the two bands n = + and n = - at each k and . If we are in the chiral limit and the system has the chiral symmetry C (which anti-commutes with the Hamiltonian at each k), we can just enforce

Cu±,,k = ±i u,,k.

(C12)

Note it is easy to see that the prefactor has to have the form ±i since C2 = 1, {C2z, C} = 0, and [, C] = 0. In
our numerics, we can readily implement Eq. (C12) by

u+,,k  u+,,k,

u-,,k  -i  u-,,k|C|u+,,k u-,,k

(C13)

at every k point. When w0 = 0 but not extremely large, we can expect Cu±,,k
generalized condition

const. × u,,k. So we replace Eq. (C13) by the

u+,,k  u+,,k,

u-,,k   sign [Im u-,,k|C|u+,,k ] u-,,k.

(C14)

Note that Eq. (C10) actually implies u-,,k|C|u+,,k  iR even away from the chiral limit.
Finally, the only remaining relevant relative sign is that of un,,k and un,-,k. We fix this one by making sure that

C2zP un,,k = n  u-n,-,k.

(C15)

In practice, we make sure that Eq. (C15) holds by adjusting the sign of the wavefunctions of both bands in the  = - valley according to

u+,+,k  u+,+,k u++,k| C2zP |u--,k

u+,-,k  - u-,+,k|C2zP |u+,-,k u+,-,k,

n = ±.

(C16)

b. Iterative procedure
We will here give the details of how we numerically solve the HF equations in MSTG and find self-consistent solutions Pk in Eq. (C1). Our iterative procedure has the following steps:
1. Guess an initial form of the projector Pk. We choose the initial ansatz for Pk for a given symmetry breaking state to be those given in the band basis in Table III.
2. Pk is then substituted into the HF functional expression (4.1). The HF functional is then diagonalized at each point via a unitary transformation Uk.
3. Pk is then recomputed from the HF functional as Pk = UkDUkT where D is the density matrix in the diagonal basis at zero temperature, with 1's on the diagonal elements corresponding to filled bands of the HF Hamiltonian and zeros elsewhere.
4. We then check if Pk has converged from the previous iteration. If it has, the procedure is finished and we have found a self-consistent solution characterized by Pk. If Pk has not converged, we return to step 2.
Unless otherwise specified, we include 3 shells of moiré Brillouin zones in our construction of the trilayer model (37 unit moiré unit cells total) of which we include out to 2 shells of moiré Brillouin zones in our numerical calculations and a 10×10 grid of k-points per moiré Brillouin zone (243 k-points total per moiré Brillouin zone). Unless otherwise specified, we take = 7 and screening length ds = 40 nm.

c. Ground State dependence on grid size
Here, we make note of an effect we observe for smaller grid size for a 6×6 k grid (75 k-points per moiré unit cell). We find for the smaller grid, a region of spin or valley polarized ground state emerges for intermediate, nonzero D0 and intermediate to large w0 which became disfavored relative to the IVC- state as we increased the grid size to better resolve the Dirac cones of the graphene-like bands. We attribute this difference to momentum dependent mixing between remote bands in the Fock term.

Energy (meV)

Energy (meV)

40

Symmetry Unbroken 100

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.00

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK

Symmetry Unbroken

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.14

100

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK

Symmetry Unbroken

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.32

100

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK

Symmetry Unbroken

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.50

100

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK

Valley Polarized
K' Valley Polarized
K' Valley Polarized
K' Valley Polarized
K'

Sublattice Polarized -

Sublattice Polarized +

KK K'

KK K'

K

Sublattice Polarized - Sublattice Polarized +

KK K'

KK K'

K

Sublattice Polarized - Sublattice Polarized +

KK K'

KK K'

K

Sublattice Polarized - Sublattice Polarized +

KK K'

KK K'

K

FIG. 8: We show band structures of converged solutions at  = 0 corresponding to the ansätze in Table III, including those which we do not appear in the phase diagram for dielectric constant = 7 at zero and nonzero D0.

Energy (meV)

Energy (meV)

3. Varying Parameters
In Fig. 8, we show the band structures obtained from our self-consistent calculation for all ansätze we attempt, exlcluding the spin Hall state which is quantitatively and qualitatively similar to our SLP- state which is shown. The contour taken through the moiré Brillouin zone to produce the band structures is shown in Fig. 2.
We verify our results are relatively independent of parameters may vary in experiment. We first consider additional values of the dielectric constant , which controls the relative contributions to the Hartree-Fock energy of the kinetic and interaction terms. We find the phase boundary between the IVC- state and sublattice polarized states shifts slightly but the overall features do not depend on the values of we test in Fig. 9. We also vary the screening length ds from 10 nm to 80 nm and find while the relative energies shift, the phase diagram does not change when ds is varied. We also verify our results are stable to increasing the number of bands we keep in our self-consistent calculation, by repeating the same calculation with the closest 8 bands per valley and spin to the Fermi level at charge neutrality. The resulting band structures as D0 is varied are shown in Fig. 11. We note the IVC+ which we found a converged solution for in the calculation keeping only 4 bands per spin and valley no longer converges when more bands are added and is not shown in Fig. 11. Given the large energy difference separating the IVC+ from the other lower energy symmetry breaking states, the absence of the IVC+ on doubling the number of bands is not relevant to our main results. We also increase our k-grid size up to a 14×14 grid to verify convergence.

0.73 0.82
0.0

0.1

0.2

0.3

0.4

D0 (units of w1)

0.5
41

w0 (units of w1)

0.09

SLP

0.18

IVC- (IVC-)

0.27

(SLP)

0.36

0.45

0.55

IVC(SPVP)

0.64

0.73

0.82

0.0

0.1

0.2

0.3

0.4

0.5

D0 (units of w1)

w0 (units of w1)

0.09

SLP (IVC-)

0.18

0.27

IVC-

0.36

(SLP)

0.45

0.55

IVC-

0.64

(SPVP)

0.73

0.82

0.0

0.1

0.2

0.3

0.4

0.5

D0 (units of w1)

w0 (units of w1)

0.09 0.18 0.27 0.36 0.45 0.55 0.64 0.73 0.82
0.0

SLP (IVC-)

IVC(SPVP)

IVC(SLP)

0.1

0.2

0.3

0.4

0.5

D0 (units of w1)

FIG. 9: Phases as we vary the dielectric constant in the Coulomb potential in Eq. (2.9) from = 4 (left), = 7 (center), and

= 150.0(9right). As the is sublat0.t1i8ce polarized phase

vaarerierdob, uths(teSIVLapCPgh-a)aisnestbcohuanndgaersieisnsthhifet

but the presences of a time-reversal-odd potential. As increases, the bandwidth

IVC phase and of the TBG-like

bands

w0 (units of w1)

relativ0.e27 to the Coulomb potential V (q) increases; as predicted in Table III, the D0-dependent increases in bandwidth favors a

sublat0.t3i6ce
0.45

polarized

state

over the IVC-

IVC-.

0.55

IVC-

0.64Symmetry(USnPbrokVePn )

(SLP) Intervalley Coherent -

Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.00

100 0.73

Valley Polarized

Sublattice Polarized -

Sublattice Polarized +

50 0.82

0

0.0

0.1

0.2

0.3

0.4

D0 (units of w1)

0.5

50

100

K K'

KK K'

KK K'

KK K'

KK

Symmetry Unbroken

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.27

100

K' Valley Polarized

KK K'

KK K'

K

Sublattice Polarized - Sublattice Polarized +

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK

Symmetry Unbroken

Intervalley Coherent - Intervalley Coherent +w0/w1=0.7S3p,in PDo0la/wriz1e=d0.50

100

K' Valley Polarized

KK K'

KK K'

K

Sublattice Polarized - Sublattice Polarized +

50

0

50

100

K K'

KK K'

KK K'

KK K'

KK K'

KK K'

KK K'

K

FIG. 10: We show band structures for a HF calculation with a 14×14 grid for extreme value = 15, ds = 40 nm.

Energy (meV)

Energy (meV)

Energy (meV)

Appendix D: Numerics at  = 2

1. Stable Phases at  = 2

In this appendix we will briefly discuss our numerical results at  = 2. We readjust our numerical procedure such

that the chemical potential is recomputed at each iteration to fix the filling at  = +2 electrons per moiré unit cell. In

the

projected

space

of

the

TBG-like

and

graphene-like

bands,

this

means

the

trace

of

Qk

satisfies

1 N

k Tr[Qk] = 10.

We also adjust the projectors P corresponding to our starting ansätze to be compatible with half-filling by setting

Pb,=2

=

1 2

(1

+

sz )Pb, =0

in

the

TBG-bands

at



=

2.

The

structure

of

Pg,=2

=

1 2

(1

-

z

)

is

the

same

as

at

charge

neutrality. The energies resulting from our HF calculations are shown in Fig. 12. We observe no qualitative change

from the phases at charge neutrality, but note the spin-polarized IVC- and spin-valley polarized state are closer in

energy at  = 2. We show the band structures obtained for the full set of ansätze we check in Fig. 13. We note

that where the IVC- at charge neutrality was a semimetal, at  = 2 the spin polarized IVC- is a metal with a small

42

Energy (meV)

Energy (meV)

200 Symmetry Unbroken

Intervalley Coherent -

150

100

50

0

50

100

150

200K K'

K K K'

KK

200 Symmetry Unbroken

Intervalley Coherent -

150

100

50

0

50

100

150

200K K'

K K K'

KK

200 Symmetry Unbroken

Intervalley Coherent -

150

100

50

0

50

100

150

200K K'

K K K'

KK

SpinwPo0l/awri1z=ed0.73, D0/w1=0V.a0l5ley Polarized

K'

K K K'

SpinwPo0l/awri1z=ed0.73, D0/w1=0V.a3l2ley Polarized

K'

K K K'

SpinwPo0l/awri1z=ed0.73, D0/w1=0V.a5l0ley Polarized

K'

K K K'

Sublattice Polarized -

Sublattice Polarized +

K K K'

K K K'

K

Sublattice Polarized -

Sublattice Polarized +

K K K'

K K K'

K

Sublattice Polarized -

Sublattice Polarized +

K K K'

K K K'

K

Energy (meV)

FIG. 11: We show band structures for a self-consistent calculation keeping 8 rather than 4 bands per spin-valley flavor, for = 7, ds = 40 nm.

Fermi surface. We also note that the spin polarized versions of the sublattice polarized states now are either a metal or semimetal. The change of the SLP states to semimetals at || = 2 can be understood as state with an insulating SLP order in the TBG-like bands of one spin flavor and an order which fills both TBG-like bands in the other spin flavor, resulting in a Dirac crossing where the TBG-like and graphene-like bands connect at the Fermi level.

2. Connection to Experimental Phase Diagram
We can connect the band structures at  = 0 and  = 2 to the experimental phase diagram; at  = 0, the leading instability is either a semimetallic IVC- state or an insulating sublattice polarized state. Either of these states can be related to the region of high resisitivity at  = 0 which persists both at D0 = 0 and |D0| > 0. At  = 2, the spin polarized IVC- is still the leading phase at D0 = 0 and for a finite range of D0. However, unlike at  = 0, the IVC- is metallic at  = 2. We note the lack of a strong high-resistivity state at  = 2 when D0 = 0 in the experimental phase diagram. For large enough D0, the IVC- state transitions to a semimetallic spin-polarized SLP state. This transition may be related to the appearance of a state with higher resisitivity at  = 2 for a finite value of D0 in the experimental phase diagram.

Appendix E: Band Structure and solution for D0  w1
In Sec. IV, we studied phases varying D0 up to half the value of w1. We will here discuss the behavior of the phases we find varying D0 up to and past w1. We find our numerics begin not to converge for D0/w1 > 1 for some values of w0 we study. We will focus here on the behavior of the valley polarized state at  = 0 and the spin polarized version of this state at  = 2 but note the similarities between the behavior of this state and the sublattice polarized states and IVC states where they converge in the HF numerics.
At  = 0, as stated in the main text, the valley polarized solution becomes metallic as D0 increases and the bands

43

Energy p.m. (meV)

8

w0/w1=0.27

w0/w1=0.55

w0/w1=0.73

6

4

2

0

2

4

Spin Pol. IVCSpin Pol. IVC+

6

Spin-Valley Polarized Spin Pol. Sublattice Polarized

8 0.0 0.1 0.D2 0/w01.3 0.4 0.5 0.0 0.1 0.D2 0/w01.3 0.4 0.5 0.0 0.1 0.D2 0/w01.3 0.4 0.5

FIG. 12: We show the energies resulting from our HF calculations at  = 2. As at  = 0, the spin-polarized IVC- is dominant relative to a spin-valley polarized state, except for a region of smaller w0 and large D0 where a spin-polarized sublattice polarized state dominates. We note that the spin-valley polarized state is closer in energy to the spin-polarized IVC- state as we vary D0 in our  = 2 calculation than at  = 0.

Symmetry Unbroken
100

Intervalley Coherent -

Intervallwey0C/woh1e=re0n.t5+5, D0/w1=0V.0al0ley Polarized

50

0

50

100

K K'

KK K'

KK K'

KK K'

Symmetry Unbroken

Intervalley Coherent -

Intervallwey0C/woh1e=re0n.t7+3, D0/w1=0V.5al0ley Polarized

100

50

0

50

100 K K'

KK K'

KK K'

KK K'

Sublattice Polarized -

Sublattice Polarized +

KK K'

KK K'

K

Sublattice Polarized -

Sublattice Polarized +

KK K'

KK K'

K

FIG. 13: Band structures obtained at  = 2 with = 7, ds = 40 nm for the full set of spin-polarized versions of ansätze in Table III.

Energy (meV)

Energy (meV)

in either minivalley are pushed away from the Fermi level. For D0/w1 relatively small, the bands in each valley flavor cross the Fermi level only near the K and K' points. However as D0/w1  1, the bandwidth of the valley-polarized TBG-like bands increases, resulting in additional Fermi surfaces near the  point. For large D0, the lower TBG-like band which begins above the Fermi level at small D0 is pushed completely below the Fermi level and, for large enough D0, the band structure reverts to a filled lower bands solution.
At  = 2, the band structure of the solutions we obtain via HF for the spin-valley polarized ansatz also begin with
separated Fermi-surfaces around the K and K' points and no Fermi surfaces near . Similar to the  = 0 case, as
D0 increases, the bandwidth of the polarized TBG-like bands increases, leading to changes in the Fermi surface, with additional hole-like Fermi surfaces appearing near the  point at intermediate values of D0 until the lower polarized band which begins above the Fermi level is pushed below the Fermi level for large D0. Unlike at  = 0, the solution at large D0 retains a finite valley polarization. Experimental Hall densities measured in MSTG show a change in sign of the Hall density at half filling for large D0 at || = 2. In the main text we argued this effect could be accounted for by the merging of Fermi surfaces of the IVC- bands (or a similar transition of the SLP- phase) near the K and

100 VP

D0/w1=0.14

D0/w1=0.27

D0/w1=0.68

44 D0/w1=1.23

Energy (meV)

50

0

50

100

K K'

K K K'

K K K'

K K K'

K

FIG. 14: We show the band structure of the VP state at  = 0 as we vary D0 for w0/w1 = 0.55. At charge neutrality, the VP state at D0 comparable to w1 acquires additional hole-like Fermi surfaces. We hi-light a single valley-spin flavor band in yellow to show the evolution of a single flavor at large D0.

100 VP

D0/w1=0.14

D0/w1=0.27

D0/w1=0.68

D0/w1=1.23

50

Energy (meV)

0

50

100

K K'

K K K'

K K K'

K K K'

K

FIG. 15: We show the band structure of the spin-VP phase at  = 2 as we vary D0 for w0/w1 = 0.33. We note at half-filling both the spin-valley polarized and intervalley coherent states at D0 comparable to w1 acquire additional hole-like Fermi surfaces. We hi-light a single valley-spin flavor band in yellow to show where the additional Fermi surfaces appear as a function of D0.

K' point doping slightly away from  = 2 when D0 > 0. Should the experimental value of the displacement field at which the sign change appears exceed the values of the displacement field discussed in the main text, it is possible that instead the sign change could be related to the dramatic changes in Fermi surfaces we observe and discuss here. We show how the band structure of the valley polarized state evolves at large D0 in Fig. 14 for  = 0 and in Fig. 15 for || = 2. The IVC- and sublattice polarized states display similar behavior at charge-neutrality and  = 2.
Another general feature we note is a tendency after a critical value of D0/w1 > 1 for all of our orders to converge to solutions which are nearly degenerate in energy. While some retain the symmetry breaking in their initial ansatz, the solutions generally have a preference to fill the lower bands up to the chemical potential at  = 0 and  = 2 and exhibit additional Fermi surfaces at large D0. Our numerics do not always converge in this region, so we do not include it in our phase diagrams or energies which are limited to D0/w1 < 0.5.

Appendix F: Different contributions to the energy

In this appendix, we detail how the different energetic contributions for particle-hole instabilities, discussed briefly
in Sec. V of the main text, are derived and what their analytical form is. We use these expressions to compute their
respective scaling with system parameters, summarized in Table III.
Our starting point are Slater-determinant states with correlation matrix Pk0 = (1 + Q0k)/2, see Eq. (3.11) for its
definition, where Q0k is block diagonal in the graphene-like-TBG-like space and of the form

Q0k =

Qgk,0 0 0 Qbk,0

,

Qgk,0 = -z,

(F1)

45

i.e., further assume that the graphene-like bands do not develop any order while we take several different candidate orders, Qbk,0, in the TBG-like band to be discussed shortly. Equation (F1) is motivated by the following observations: first, at D0 = 0, all order parameters can be classified as mirror-even (diagonal in graphene-TBG space) and mirrorodd (off-diagonal in graphene-TBG space). Based on the band structure, it is natural to expect that the former are
energetically favored. In fact, we will see in Appendix F 4 explicitly and in our HF numerics [see second row in Fig. 17]
as well as in our analysis of exact eigenstates in Appendix B that off-diagonal components are not favored at D0 = 0. Second, Qgk,0 = -z is motivated by the observations of Appendix B that the manifold of exact ground states of the MSTG Hamiltonian has this form for D0 = 0 in a finite range of coupling parameters [ in Eq. (3.4)] between the graphene cones and the TBG bands. Again, this will be confirmed by our HF numerics, where the lowest-energy
solutions are of the form of Eq. (F1) in the flat-decoupled limit (D0 = WTBG = 0), and our discussion of order in the graphene-like bands in Appendix F 3 below.
In Sec. III C of the main text, we have constructed the different possible ansätze, Qbk,0, using the (U(4) × U(4))b,cf symmetry. We will complement this here by deriving the exact same set of states purely within HF. As a first step,
let us focus on minimizing the Fock energy in Eq. (C7d) at D0 = w0 = 0:

EF[Pk0]

=

EF,g

-

1 2N

V (q)

tr Pkb(Fkb,bq)T PMb BZ(k+q)(Fkb,bq) ,

Pkb

=

1 (1 +
2

Qbk,0),

q

kMBZ

(F2)

where EF,g is the Fock energy of the graphene subsystem being in a semimetallic state and F bb the form factors in TBG subspace, which obey [cf. Eq. (A33a)]

F¯bb(k, q) = F¯1bb(k, q)00s0 + iF¯2bb(k, q)02s0 + O(w0, D02).

(F3)

Since A, B = tr[AB] defines an inner product on Hermitian matrices, the Cauchy-Schwarz inequality holds, A, B  A, A B, B with maximum reached when A = cB with c > 0. Applying this to the second term in Eq. (F2),
we see that this term reaches its minimum when [47]

Pkb = Ck,q(Fkb,bq)T PMb BZ(k+q)(Fkb,bq), Ck,q > 0,

k, q.

(F4)

In general, solving Eq. (F4) can be difficult (or impossible) and the minimum of EF[Pk0] requires a momentum-
dependent correlator. However, for D0 = w0 = 0, it holds (Fkb,bq)T (Fkb,bq) = k,q1 with k,q = j=1,2(F¯jbb(k, q))2 > 0.
Then, Eq. (F4) is obeyed as long as

Qbk,0, 02s0 = 0.

(F5)

This is the same commutator relation as in Eq. (3.15). All momentum independent states that obey this property, as
well as their symmetries are summarized in Table II. Furthermore, we have also checked all of the states in Table II are
also exactly degenerate in the Hartree term (C7c) and in the additional subtraction point contribution in Eq. (C9),
as long as w0 = D0 = 0. In the following subsections, we will discuss the various energetic corrections to Q0k in Eq. (F1) once we turn on
D0, w0, and WTBG, and allow the graphene-like bands to develop order and mix with the TBG-like bands in the vicinity of the Dirac cones. To simplify the discussion, we will first focus on the SU(2)+× SU(2)--symmetric model defined in Sec. II. In that case, certain pairs of states, referred to Hund's partners in [27], are guaranteed to be
degenerate. Therefore, we will focus, without loss of generality, on only one member of each pair of Hund's partners;
for concreteness, we choose those above the vertical line in Table II. In Sec. F 5, we will study how these degeneracies
are lifted for JH = 0 in Eq. (3.16).

1. Deformation of the form factors

Let us first analyze the energetic impact for these different phases due to the deformation of the form factors, see Eq. (A33), as a consequence of D0 and w0. To this end, we compute the change of the HF energy EHF in Eq. (C7) for Q0k in Eq. (F1) for the different Qbk in Table II, setting WTBG = 0. Using the structure of the form factors in Eq. (A33) along with the important constraints in Eqs. (A35) and (A37), we obtain after straightforward algebra the
resultant change of energy Ebb(WTBG = 0) listed in Table III. The prefactors are given by

2 c1 = N

V (q) [F¯3bb(k, q)]2 + [F¯4bb(k, q)]2 ,

q,k

(F6)

46

Energy p.m. (meV)

8

w0/w1=0.27

w0/w1=0.55

w0/w1=0.73

6

4

2

0

2

IVC-

4

IVC+ Valley Polarized

6

Spin Polarized Sublattice Polarized

8 0.0 0.1 0.D2 0/w01.3 0.4 0.5 0.0 0.1 0.D2 0/w01.3 0.4 0.5 0.0 0.1 0.D2 0/w01.3 0.4 0.5

FIG. 16: HF energies relative to the SP state obtained by plugging in the ansätze in Table II in the HF energy expression. The behavior agrees with the analytical prediction in the column Ebb(WTBG = 0) in Table III.

8 c2 = N V (G)
G

2
F¯4bb(k, G) ,
k

2 c3 = N

V (q) [F¯5bb(k, q)]2 + [F¯6bb(k, q)]2 ,

q,k

2 c4 = N

V (q) [F¯7bb(k, q)]2 + [F¯8bb(k, q)]2 .

q,k

(F7) (F8) (F9)

Due to Eq. (A38), we expect the Hartree contribution, c2, to be numerically smaller than c1. We have verified the form of these energy contributions wihtin our HF numerics, see Fig. 16.

2. Finite bandwidth of the TBG-like bands Next, we allow for WTBG = 0 in Eq. (A12) by treating it as a perturbation to the different states in Table II.

a. First order perturbation theory

The first-order contribution is readily found by evaluating the expectation value of H0 := H0 - H0|WTBG=0 with H0 given in Eq. (A12) with respect to the states |[Pk] . Within the matrix notation introduced in Appendix C, the correction to the energy can also be written as

E(1)[Pk] =

tr PkT (hk(k) - hk(k)|WTBG=0) .

kMBZ

(F10)

Using the form of the kinetic energy of the TBG-like bands given in Eq. (A20) and that E¯1b(k) = -E¯1b(-k), one finds

E(1) = 1 2

E¯3b(k) w0D0

kMBZ

(F11)

for all states of Table II. Consequently, we have to go to second order in WTBG to find a contribution that favors one of the orders over the others. This is what we will discuss next.

b. Second order perturbation theory: superexchange
For the discussion of second order perturbation theory, it will most convenient to switch back to the second quantization description. The unperturbed Hamiltonian is the full Hamiltonian in the flat-band limit, HI = H0|WTBG=0 +H1,

47

with H1 given in Eq. (A31), and the perturbation is the dispersion in the TBG-like bands, i.e.,

3

HII = WTBG

(b,p),(k)bk;p,,sbk;p,,s = WTBG

HI(Ij),

kMBZ =± s=, p=±

j=0

HI(Ij) =

Ejb(k) bkMj bk.

kMBZ

(F12)

Here we used the parameterization in Eq. (A20) and introduced the matrices

M0 = 30s0, M1 = 03s0, M2 = 33s0, M3 = 00s0

(F13)

acting in the TBG-like subspace. As will become useful shortly, this decomposition of the kinetic energy has the
property that all Mj defined in Eq. (F13) either commute or anticommute with all of the Qb in Table II separately. Let us assume that (one of) the groundstate(s) of HI with energy EQ0 b is the product state |[Qb] , characterized by
the correlation matrix Pk = (1 + diag(-z, Qb))/2 in Eq. (C1). Here, Qb can be any of the states listed in Table II.
The energy correction to second order in WTBG has the form

E(2) = -
|n =|[Qb]

|

n|HII|[Qb] En0 - EQ0 b

|2 ,

(F14)

where the sum involves all eigenstates |n of HI (excluding |[Qb] ) with energy En0. Assuming that the system is in an insulating phase in the TBG-like sector, we will have a finite gap, En0 > EQ0 b , such that perturbation theory is controlled in bandwidth over gap and E(2)  0, i.e., the "superexchange"-like processes discussed here, if finite, will
lower the energy. We will next show that for a given Qb, all terms j in Eq. (F12) with [Mj, Qb] = 0 will not contribute to Eq. (F14)
and, hence, only those that obey {Mj, Qb} = 0 can lower the energy to order WT2BG. To see this, first note that [Mj0 , Qb] = 0 implies that there exists a unitary matrix V such that both V QbV and V Mj0 V are diagonal. Since tr Qb = 0, we can take V QbV = diag(1, 1, 1, 1, -1, -1, -1, -1) without loss of generality at  = 0. Consequently, the
associated many-body state assumes the form

4

|[Qb] =

¯bk;v |0,g ,

kMBZ v=1

¯bk;v := bk;V,v,


(F15)

where |0,g is the state of empty TBG-like bands and lower-filled graphene-like bands. Upon noting that MjT = Mj and Mj2 = Mj, we also see

8

HI(Ij0) =

Ejb0 (k)

rv ¯bk;v ¯bk;v ,

kMBZ

v=1

rv = ±1.

(F16)

Consequently, we get

4

n|HI(Ij0)|[Qb] =

Ejb0 (k) rv n|[Qb] = 0

kMBZ

v=1

(F17)

since |[Qb] and |n are orthogonal for all terms in the sum of Eq. (F14). From this algebraic criterion, we can immediately read off that the SP and VP states have E(2) = 0, i.e., cannot
gain energy from this "superexchange" mechanism. The SLP± and SSLP± order parameters, however, anticommute with M0 and M2. As such, they can benefit both from the superexchange processes associated with E0b = E¯0b (already present when w0 = D0 = 0, but  tuned away from the magic angle) and E2b = E¯2bD0 (unique to the trilayer system and only non-zero for D0 = 0). Furthermore, while both IVCs can benefit from E1b = E¯1bw0, the IVC- (IVC+) also benefits from E0b (E2b = E¯2bD0). This leads to the results shown in Table III.

3. Ordering in the graphene-like bands
Let us next also take into account that the coupling between the graphene-like and TBG-like bands can modify the ansatz in Eq. (F1). Note that a perturbative treatment of bandwidth of the graphene-like bands, similar to our

48

analysis in Sec. F 2, is not controlled as these bands are highly dispersive and their bandwidth and energy, (g,p),(k), at generic momentum points are larger than the interaction energy scale. At the same time, (g,p),(k) is small around the K/K' points such that taking the interaction as a small parameter--as employed in the full quantum mechanical
analysis in Appendix B--is not necessarily valid either for realistic system parameters. Therefore, we here use a different approach that takes advantage of these observations: while the diagonal structure of Eq. (F1) and Qgk = -z are likely to be a good approximation far from the K/K' points, it is expected to be modified in the vicinity of these
points.
To formalize this, we define A = A+  A- where A+ (A-) is a region of momentum points around the K (K') point. The precise form does not matter, we only need that its area, VA, is small compared to the overall size of the MBZ. We now take

Qk =

Q0k, Q1k,

k  A¯, k  A,

A¯ := MBZ \ A

(F18)

with Q0k given in Eq. (F1), and accordingly for Pk. Expanding the change of the HF energy, EHF = EHF[Pk] - EHF[Pk0], to leading order in VA, one finds after straightforward algebra







EHF

=

1 2

tr[QTk hk(k)]
kA

+

1 N

V
GRL

 (G) Re 
k

tr[Pk0
A¯

FkT ,G]

 tr[QkFkT,G]

kA



1 -
N

V (k - k + G)tr[QkFkT,k -k+GPk0 Fk,k -k+G]

GRL kA k A¯

1 -
2N

V (G)0G

tr[QkFkT,G]

+

1 2N

V (q)

tr[QTk Fk,qFk,q] + O(VA2),

GRL

kA

q

kA

(F19)

where we defined the shorthand Qk = Q1k - Q0k and 0G = 8 k F1bb(k, G) + F1gg(k, G) . Here, the first, second, and third terms come from the dispersion, Hartree, and Fock term, while the last line is due to the subtraction point.
To simplify further, note that we can extend the sums over k in Eq. (F19) to the entire MBZ without changing the result at linear order in VA. Focusing on the relevant case of Pk0 = P 0, we can write

EHF = 1 2

tr[QTk hk(k)]

kA

1

+

V (G) Re

2N

GRL

tr[Q0FkT ,G] tr[QkFkT,G]

k

kA

1 -
N

V (q)

tr[ Qk FkT,q Pk0

Fk,q ]

-

1 2

tr[Qk

FkT,q

Fk,q

]

q kA

+ O(VA2).

(F20)

Postponing the discussion of Qk with non-zero off-diagonal components that mix the graphene-like and TBG-like bands to the next subsection, we here focus on block diagonal

Q1k =

Qgk 0 0 Qbk

,

(F21)

where Qgk will be chosen to describe the same order as in the TBG-like bands, i.e., to break/keep exactly the same symmetries as the considered order parameter in the TBG-like bands.
Let us begin our discussion with the spin-polarized state, i.e., take

(Qgk), = ,

0s3, -3s0,

k  A otherwise

(F22)

in Eq. (F18). Using Eq. (F20), it is a matter of straightforward algebra to show that the associated change of the

49

energy is given by

ESHpFinPol  2

E¯0g(k; )

 kA

2 -
N

V (q) (F¯2g,g(k, q))2 - (F¯1g,g(k, q))2

q  kA

2 -
N

V (q) (F¯1b,g(k, q))2 + (F¯2b,g(k, q))2 D02

q  kA

2 -
N

V (q) (F¯7b,g(k, q))2 + (F¯8b,g(k, q))2 w02D02

q  kA

2 -
N

V (q) (F¯7g,g(k, q))2 - (F¯8g,g(k, q))2 + 2 V (G) F¯8g,g (k , G)

F¯8g,g(k, G) w02D04

q  kA

G

 ,k

,kA

(F23)

where E¯0g(k; ) is (the part of) the dispersion of the graphene-like bands defined in Eq. (A21). To keep the notation more compact, we further defined the -dependent form-factor components as

Fjt,t(k, q) = Fjtt (k, q) +  Fjt+t 2(k, q), Fjt,t(k, q) = Fjtt (k, q) +  Fjt-t 2(k, q),

j = 1, 2, j = 7, 8.

(F24) (F25)

To understand the scaling behavior of the first contribution associated with the kinetic term, let us take E¯0g(k; ) = |D0| + vD|k| where k is the distance from the K (K') point in valley  = + ( = -) and  > 0. As such we
expect the scaling behavior

E¯0g(k; )  c1|D0|(k)2 + c2vD(k)3,
 kA

cj > 0,

(F26)

as a function of D0 and the linear size, k, of A. While we have already indicated the scaling behavior of all remaining terms in Eq. (F23) with D0 and w0, we further note that they scale with the area of A and, thus, quadratically with k.
To discuss the consequences, let us first focus on D0 = 0. We see that the energetic penalty due to the kinetic term scales as k3 while the energetic gain from the second line of Eq. (F23) scales as k2. One could naively conclude that this implies that the system should lower its energy by polarizing the graphene bands in some vicinity of its Dirac cones. Closer inspection, however, shows the involved energetics is equivalent to that of single-layer graphene: note that, for D0 = 0, the first two lines of Eq. (F23) involve the dispersion and interaction matrix elements only in the graphene subspace. Since we know that graphene is not a spin-polarized insulator, this spin polarization cannot be preferred by the system. In fact, one can show that the two terms in the second line of Eq. (F23) cancel each other to leading order in k: To see this, let us focus on the contribution of one valley, say  = +, and consider k  -q1/2 (more precisely k = k(cos 0, sin 0) - q1/2 and k  0+) where we get

V (q) (F¯2g,g+(k, q))2 - (F¯1g,g+(k, q))2 

V (q) sin2 MBZ(q) - 0 - cos2 MBZ(q) - 0

2

2

q

q

=

V (q) sin2 q - 0 - cos2 q - 0 .

2

2

qMBZ

Gq,0, (F27) (F28)

Here we inserted the explicit form of the form factors given in Eq. (A39). This expression has to vanish since
V (q) = V (-q), q = -q + , and q  MBZ implies -q  MBZ. The same analysis can be performed for the other valley  = -. For this reason, also the interaction correction in Eq. (F23) scales (at least) as (k)3 for D0 = 0 and, hence, does not generically dominate the kinetic contribution of the first line.
Turning on D0, we see that while there can be some additional gain starting at order D02, this gain is always overcompensated for sufficiently small D0 by the additional cost from the kinetic energy which scales as D0.
These results are completely consistent with our HF numerics: as can be seen in Fig. 3, at D0 = 0, the graphene Dirac cones are not split. Furthermore, while there are spin-split Dirac cones around the Fermi level at K/K' for

50

D0 = 0, these are not related to the spin-ordering in the graphene-like bands defined in Eq. (F22). This becomes obvious by noting that both spin flavors of the upper (lower) graphene-like band are unoccopied (occupied), as is clearly visible based on the band connectivity. Furthermore, we can see it in the correlator of the SP around the K/K' points shown in Fig. 17.
All other states in Table II can be analyzed in a similar way. To begin with the valley polarized state, the analogue of Eq. (F22) reads as

Qgk =

03s0, -30s0,

k  A, otherwise,

(F29)

which leads to a kinetic energy contribution [from the first line of Eq. (F20)]

Ekin = 1 2

tr[QTk hk(k)] = 2

E¯0g(k, ) + E¯1g(k, )w0D0 = 2

E¯0g(k, ),

kA

kA 

kA 

(F30)

where (although not crucial for the following conclusion), we made the natural assumption k  A  -k  A in the last equality. Most importantly, we see that the kinetic energy contribution now scales as ( + D0)(k)2 to leading order in k, where  is the large energy of the graphene-like remote band, i.e., in the valley that does not have a
Dirac cone at the respective K point k is close to. As such, it is energetically not favorable to have valley polarization
of the graphene-like bands around the K/K' points.
As is intuitively clear and can be derived in the same way, this suppression due to the kinetic energy also applies to the IVC states in Table II. One also finds exactly the same expression, Ekin = 2 kA  E¯0g(k, )  (+D0)(k)2. Consequently, ordering of the graphene-like bands in the vicinity of the K/K' points can also be excluded for the IVC
states.

For the sublattice polarized states, SLP±, the situation is slightly more complicated since the structure in the graphene-like bands is in general of the form

(Qgk), = ,

(-3 cos k + 2 sin k)s0, -3s0,

k  A otherwise,

(F31)

and it is left to determine the optimal k  R subject to the constraint k = -k for the SLP± state resulting from
C2z and . Note that (Qgk)2 = 1 and tr Qgk = 0, hold for any k and, hence, does not further constrain it.
Making the natural assumption that sin k is significantly non-zero only in the small region A around the K/K
points, we can still use Eq. (F20) which yields

ESHLFP± [k] =

[Ak,(1 - cos k) + Bk, sin k] ,

 kA

(F32)

where

Ak,

=

2E¯0g (k,

)

+

2 N

V (q) (F¯1g,g(k, q))2 - (F¯2g,g(k, q))2 + O(D04),

q

2

Bk,

=

- N

V (q)

(F¯1g,b(k, q))2 + (F¯2g,b(k, q))2

D02

+

2 N

V (q) (F¯7g,b(k, q))2 + (F¯8g,b(k, q))2

q

q

w02D02.

(F33a) (F33b)

First, note that Bk, = 0 for D0 = 0. Furthermore, the second term in Eq. (F33a) is suppressed to leading order in k, as already discussed above, such that Ak, > 0 and, thus, k = 0 for D0 = 0. This agrees with our result of Appendix B and with the HF band structure in Fig. 3 which exhibits a gapless graphene Dirac cone at D0 = 0 for the SLP- (the same applies for SLP+, not shown). More explicitly, this can also be seen in the upper panel of Fig. 17, where the correlators of the SLP± states close to the K point at D0 = 0 are shown: the graphene bands are just in the lower-filled-band configuration.
The system behaves differently when D0 = 0. We then have Bk, = 0 and it will become energetically favorable to develop finite SLP± order in the graphene-like bands according to tan k = Bk±/Ak, k  A+, where we defined

Ak = Ak,+ + A-k,-,

Bk± = Bk,+  B-k,-,

(F34)

51

with + (-) for the SLP+ (SLP-) case. The associated minimized energy change is given by

min
k

ESHLFP± [k]

=

kA+

Ak -

A2k + (Bk±)2 .

(F35)

Taken together, both SLP± states will develop order in the graphene-like bands around the K and K' points as long as D0 is non-zero. As A  D0 and B±  D02, the associated energy gain will scale as -g±VA|D0|3 for small D0. As follows from Eq. (F33b), Bk, has a definite sign for sufficiently small w0, such that |Bk-| > |Bk+| and, thus, g- > g+, i.e., the SLP- state can gain more energy than the SLP+ phase from this process for small w0. Since sin k = 0 in Eq. (F31) corresponds to a mixing of the upper and lower bands of the graphene-like bands, this will gap out the
Dirac cones of the SLP± states at D0 = 0 and we obtain an insulator rather than a semimetal; this is also seen in our HF numerics (cf. Fig. 3). Furthermore, it is directly visible in the correlators of the SLP± states shown in the lower panel of Fig. 17; the additional mixing of the TBG-like and graphene-like band that can also be seen in the HF data
will be analyzed in Appendix F 4.

In analogy to these two states, we choose for the quantum spin Hall state (SSLP-)

(Qgk), = ,

-3s0 cos k + 2s3 sin k, -3s0,

k  A otherwise.

(F36)

The corresponding change of the energy has again the form of Eq. (F32), this time with

Ak,

=

2E¯0g (k,

)

+

2 N

V (q) (F¯1g,g(k, q))2 - (F¯2g,g(k, q))2 + O(w02D04),

q

Bk, = 0.

(F37)

Note that the vanishing of Bk, is consistent with the fact that the energy should not depend on whether k = -k (SSLP-) or k = --k (SSLP+), since these two states are related by a SU(2)+× SU(2)- transformation. We clearly see that the energy is minimized by cos k = 1, i.e., no order in the graphene-like bands and no associated energetic gain. We emphasize that the presence of SSLP- order in the TBG-like bands and, at D0 = 0, interactions that couple the two subsystems, also induces a gap in the original graphene Dirac cone; we will see this in Appendix F 4 below
where we will find a non-zero mixing of the TBG-like and graphene-like bands for the SSLP states.

4. Mixing between the TBG-like and graphene-like bands

We have not yet taken into account the possibility that the TBG-like and graphene-like bands can mix or, in other words, develop some coherence in the vicinity of the K/K points; this corresponds to allowing for off-diagonal components in Qk. It is clear by symmetry that such a mixing is only possible for D0 = 0.
To describe the mixing between the bands, we write

Qk = UkQ0kUk,

Q0k =

-z0s0 0 0 Qb

UkUk = 1,

(F38)

where Qb is any of the order parameters in the TBG-like bands listed in Table II and the unitary matrix Uk, which mixes the TBG-like and graphene-like bands, is constrained by the symmetries of the state Qb. Note that unitarity
of Uk guarantees Q2k = 1, Qk = Qk, and tr Qk = 0.
Since are interested in mixing of the bands, we will focus on Uk of the form

U = e = e , k

ik

i j=1,2 j n^(kj,j )M (j,j )j


M (j,j ) = M (j,j ),

n^(kj,j )  R

(F39)

where j are Pauli matrices acting between the TBG-like and graphene-like bands and M (j,j ) are matrices in spin, band, and valley space. It, thus, holds [M (j1,j2), j] = 0. Before discussing the different candidate states separately, where the different symmetries will constrain the available generators in Eq. (F39), let us expand Eq. (F38) up to
second order in the rotational angle . To this end, define Mj,k = j n^(kj,j )M (j,j ) and Mk = M1,k + iM2,k.

IVC - at point IVC + at point SLP + at point SLP - at point SP at point

VP at point

IVC - at K point IVC + at K point SLP + at K point SLP - at K point SP at K point VP at K point

52
1.0 0.8 0.6 0.4 0.2 0.0

IVC - at point IVC + at point SLP + at point SLP - at point SP at point

VP at point

1.0

0.8

0.6
IVC - at K point IVC + at K point SLP + at K point SLP - at K point SP at K point VP at K point
0.4

0.2

0.0
FIG. 17: We show the projector P which characterizes each of our symmetry breaking solution for a point near the  point of the Brillouin zone and K point of the Brillouin zone for w0/w1 = 0.73 and D0/w1 = 0 (top) and D0/w1 = 0.5 (bottom). We plot the matrix form of P such that the largest block shown outlined in blue in the first panel of the top row denotes spin flavor, the next smallest blocks outlined in red denote valley flavor, and the next smallest block outlined in green denotes upper and lower bands in the continuum model and final two boxes denoting TBG-like or graphene-like band index in the continuum model, where the final two boxes denote the graphene-like and TBG-like band in the upper-band box and the TBG-like then graphene-like bands in the lower-band box.

Equation (F38) then becomes

Qk 

-z 0 0 Qb

+

0

iMkQb + izMk

-iQbMk - iMkz

0



+

MkQbMk

0

0

-Mk z Mk

1 +
2

{MkMk, z}

0

0

{MkMk, Qb}

2 + O(3).

(F40)

Below, we will use this expression to interpret the mixing matrices we obtain analytically and to constrain the possible generators M (j,j ).
Since the IVC- is favored energetically in most of parameter space, let us start with the intervalley coherent phases, which can be discussed simultaneously. Due to the valley U(1)v symmetry, we can choose their "undeformed" correlator in the TBG-like subspace, without loss of generality, to be Qb = x and Qb = yy for the IVC+ and IVC-, respectively. As such, the phases still preserve the C2z symmetry in Table V (for other choices, it has to be combined with a valley U(1)v rotation). Consequently, M (j,j ) in Eq. (F39) must obey

(M (1,j )) = -M (1,j ), (M (2,j )) = M (2,j ),  M = -M.

(F41)

Furthermore, the preserved spin-rotation symmetry forces Mj to be trivial in spin-space. This leaves the following

53

3 + 3 = 6 options for M1 and 3 × 3 + 1 = 10 possibilities for M2,

M (1,j )  {y0,x,z, 0,x,zy},

M (2,j )  {0,x,z0,x,z, yy}.

(F42)

However, not all (linear combinations) of the 16 generators are important for the IVC states. First, we can neglect
all parts of k in Eq. (F39) that commute with Q0k. This can be done formally by setting k  (k - Q0kkQ0k)/2 or, equivalently, by replacing

Mk



1 2 (Mk

+ QbMkz).

(F43)

For future reference, this means that it holds

Mkz = QbMk.

(F44)

This reduces the number of independent generators to 8. To begin with the IVC+, a complete set of associated generators is given by

1

1

2 y (00 + zx) , 2 y (z0 + 0x) ,

1

1

2 (yx0 + xyx) , 2 (y0z + xzy) ,

1

1

2 y (yy - xz) , 2 x (yz + xy) ,

1

1

2 (yxx + xy0) , 2 (yzz + x0y) .

(F45)

For the IVC-, they read as

1

1

2 y (z0 + yy) , 2 y (0x + xz) ,

1

1

2 (xyx - yzz) , 2 (xyz + yzx) ,

1

1

2 y (xx - 0z) , 2 x (y0 + zy) ,

1

1

2 (x0y + yx0) , 2 (xxy - y00) .

(F46)

To further constrain the remaining 8 generators, we note that the graphene-like bands in valley  = - (valley  = +) are at energies far away from the Fermi surface (of scale ) for k  A+ (k  A-). In the following, we will neglect all mixing processes that are suppressed in the limit of large . Inspection of the first term in Eq. (F20) shows that this is equivalent to demanding that Uk obey

() =

trg[(UkQ0kUk - Q0k)^ ] = 0,

kA

^ ± = z(0  3)/2,

(F47)

where the trace is only over the graphene-like subspace. Using Eq. (F40), we can express this quantity as

() =

trg[MkQbMk^ ]

+

1 2

trg

[{MkMk

,

z}^ ]

2 + O(3).

kA

(F48)

To simplify further, we use Eq. (F44) and obtain

() = 2

trg,-[MkMk]2 + O(3),

kA

(F49)

where the trace is only over the graphene-like subspace in valley -. As such, () = 0 requires

trg,[MkMk] =

(Mk)(p , ,s ),(p,,s) 2 = 0 k  A±  (Mk)(p , ,s ),(p,,s) = 0 k  A±. (F50)

s,s ,p,p ,

It is straightforward to see that there are 4 linear combinations of the 8 generators in Eq. (F45) (in Eq. (F46)) for the IVC+ (IVC-) that satisfy this requirement. For k  A±, these are

1

 22

[y

(0(0

±

z )

+

z x )

±

x z y ]

,

1  [y(z(0 ± z) + 0x) ± x0y] , 22

1

 22

[x (y (0

±

z

)

±

x y )

+

y

xx]

,

1  [y(x(0 ± z)  yy) + xyx] , 22

(F51a) (F51b)

54

for the IVC+ and

1  [x(y(0 ± z) + zy) ± yzx] , 22

1

 22

[y

(z (0

±

z

)

+

y y

)



xy

x]

,

1  [y(0(0 ± z)  xx) - xxy] , 22

1

 22

[y (x (0

±

z )



0x)

+

x 0 y ]

,

(F52a) (F52b)

for the IVC-.
Taken together, we use Uk = eik± for k  A± and Uk = 1 otherwise, where ± is any of the four generators in
Eq. (F51) for the IVC+ and any of those in Eq. (F52) for the IVC-. From Eq. (F20), we can compute the associated
change of energy that is found to be of the form

EHF =

k sin2 k + k sin k cos k;

kA+

(F53)

to reduce the summation to momenta in A+ only, we have used k = -k. For the IVC+ with Qb = x, this follows
from the fact that C2z as given in Table V acts as x and that x±x =  for all generators in Eq. (F51). For the IVC- with Qb = yy, C2z has to be combined with the U(1)v valley rotation iz to be a symmetry (with action on
the spinors given by y0). However, as follows from Eq. (F52), it holds y±y =  in this case, leading to the
same result, k = -k. For ease of presentation, let us discuss the behavior of EHF separately for the two IVCs and begin with the IVC+
state. Focusing on the limit w0 = 0 for now, we obtain k = 0 (and k > 0 at least in a finite range of D0 around D0 = 0) for the generators in Eq. (F51b) such that EHF reaches its minimum EHF = 0 when sin k = 0 (no
mixing). For the first and the second generator in Eq. (F51a), we find

k = 4

2 (g,+),+(k) -

(b,+), (k)

=±

8 +
N





2

4

V (q) 

F¯jbb(k, q) 2 -

(-1)j

F¯jgg(k, q)

2


+

O(D02),

q

j=1

j=1

(F54a)

 82 k = N





4

2

V (q)  F¯jgg(k, q)F¯jgb(k, q) - F¯jbb(k, q)F¯jbg(k, q) D0 + O(D03),

q

j=1

j=1

(F54b)

and

k = 4

2 (g,+),+(k) +

(b,+), (k)

=±

8 +
N





2

4

V (q) 

F¯jbb(k, q) 2 -

(-1)j

F¯jgg(k, q)

2


+

O(D02),

q

j=1

j=1



82 k = N

V (q) F¯1bb(k, q)F¯2bg(k, q) - F¯2bb(k, q)F¯1bg(k, q) + F¯2gg(k, q)F¯1gb(k, q)

q

- F¯1gg(k, q)F¯2gb(k, q) + F¯4gg(k, q)F¯3gb(k, q) - F¯3gg(k, q)F¯4gb(k, q) D0 + O(D03),

(F55a) (F55b)

respectively. To arrive at these expressions, we have used the C2z constraint in Eq. (A35). We first observe that, in both cases, k = 0 for D0 = 0 and, hence, the energy (F53) is simply minimized when
sin k = 0, i.e., no mixing between the graphene and TBG bands occurs. This is expected since the presence of h implies that the order parameters have to be either even (intra-system) or odd (inter-system) under h, prohibiting mixing between the bands.
When D0 = 0, the system can immediately gain energy by allowing for non-zero k: EHF in Eq. (F53) is minimized by k = 0k obeying tan 20k = -k/k with minimal energy given by

E0HF

=

mink EHF[k]

=

1 2

k -

kA+

k2 + k2

 0.

(F56)

As long as k = 0, this lowers the energy, which shows that the system will exhibit hybridization between the bands for D0 = 0 as described by the two generators in Eq. (F51a), while those in Eq. (F51b) are disfavored energetically

55

by the interactions. While this only holds for w0 = 0, we still expect the generators in Eq. (F51a) to be dominant in an extended region of finite w0. As we will see shortly, this is confirmed by our numerics.
To obtain the scaling of the energy gain with (small) D0, we expand Eq. (F56) in k  D0, which yields

E0HF

-
kA+

k2 4k

 -g3VAD02,

(F57)

where we indicated that the result will be proportional to the area VA  (k)2 (our small parameter) and the displacement field squared; the constant g1 > 0 contains all the non-universal properties and itself depends on D0 and w0.
Which of these two remaining generators in Eq. (F51a) (or which linear combination) is preferred by the system is

the only aspect that depends on the microscopic details of the form factors; it is not possible to say which of the k in Eqs. (F61b) and (F55b) is dominant at a given k without computing the form factors in the microscopic model.

The associated mixing of the bands for these two cases are readily evaluated from Eq. (F40). We get





QbMk + Mkz = 2Mkz = 2iz(0 ± z) + 20(ix ± y), k  A±

(F58)

for the first term in Eq. (F51a). This means that the graphene-like band with positive (negative) energy in the valley

that is closer to the Fermi level mixes with the TBG-like band of both valleys that are also at positive (negative)

energies.

For the second generator in Eq. (F51a), we find a mixing matrix of the form





QbMk + Mkz = 2iy(0 ± z) - 2ix(ix ± y), k  A±.

(F59)

Instead, we here get that the graphene-like band with positive (negative) energy in the valley that is closer to the Fermi level mixes with the TBG-like bands of both valleys that are at negative (positive) energies. In our numerical HF computations, we find very good agreement with the mixing matrix in Eq. (F59), see Fig. 17, even at the moderately large value of w0/w1 = 0.73.
The energetic discussion can be done in a similar way for the IVC- state and we find quite similar structures: first, we get k = 0 for w0 = 0 for the two generators in Eq. (F52b) and, thus, no energetic gain via mixing. Second, this is different for those in Eq. (F52a): the first one leads to

k = 4

2 (g,+),+(k) +

 (b,+),(k)

=±

8 +
N





2

4

V (q) 

F¯jbb(k, q) 2 - (-1)j F¯jgg(k, q) 2 + O(D02),

q

j=1

j=1



82 k = N

V (q) F¯1bb(k, q)F¯2bg(k, q) - F¯2bb(k, q)F¯1bg(k, q) + F¯2gg(k, q)F¯1gb(k, q)

q

- F¯1gg(k, q)F¯2gb(k, q) + F¯4gg(k, q)F¯3gb(k, q) - F¯3gg(k, q)F¯4gb(k, q) D0 + O(D03),

(F60a) (F60b)

while the second one is associated with the coefficients

k = 4

2 (g,+),+(k) -

 (b,+),(k)

=±

8 +
N





2

4

V (q) 

F¯jbb(k, q) 2 - (-1)j F¯jgg(k, q) 2 + O(D02),

q

j=1

j=1

(F61a)

 82 k = N





4

2

V (q)  F¯jgg(k, q)F¯jgb(k, q) - F¯jbb(k, q)F¯jbg(k, q) D0 + O(D03)

q

j=1

j=1

(F61b)

in Eq. (F53). As before, while D0 = 0 does not lead to mixing, the bands start to mix at non-zero D0; this mixing is described by the two generators in Eq. (F52a) and which of the two dominates depends on microscopic details. The

nature of the mixing depends on the generator. For the first one in Eq. (F52a), the mixing matrix reads as





2Mkz = 2ix(0 ± z) + 20(y ± ix), k  A±.

(F62)

56

This means that the lower/upper graphene-like band in the valley that is at low energies hybridizes with the up-

per/lower (lower/upper) TBG-like band of the same (opposite) valley. For the second generator in Eq. (F52a), we get

instead





2Mkz = 2iz(0 ± z) + 2iy(y ± ix), k  A±,

(F63)

i.e., the lower/upper graphene-like band in the valley that is at low energies hybridizes with the upper/lower
(lower/upper) TBG-like band of the opposite (same) valley.
Comparison of Eqs. (F55) and (F60) [the same holds for Eqs. (F54) and (F61)] shows that the corresponding
prefactors and, hence, the energies are identical to leading order in D0 (note the subleading corrections due to the kinetic term). Since our numerics has identified the mixing matrix in Eq. (F59) to be realized in the system for the
IVC+ and the parameters in Fig. 17, we thus expect Eq. (F62) to dominate for the IVC-; this is indeed confirmed by Fig. 17. Another consequence of this observation is that the leading (in D0 and w0) correction to the energy of the IVC- is identical to that of the IVC+, given by -g1VAD02. As we have seen above, further corrections to higher orders in D0 (e.g., due to the kinetic terms) are different for these two IVC states. These are not included in Table III.

We next continue with the spin polarized state, Qb = 00s3. Since the valley U(1)v symmetry is preserved, Uk has to be diagonal in valley space. We can write

(Uk), = s00, ei

. 3
j=1

k(j,)

j

(F64)

While this form of Uk automatically preserves all unitary symmetries in Table V (except for P , which, however, is broken anyway for D0 = 0), it only preserves C2z if (1) = (3) = 0 and we are left with

(Uk), = s00, eik,2

(F65)

with the additional constraint k, = -k,-, which comes from  (or, equivalently, C2z). Our task now it to determine the real-valued function k, such that the energy is minimized. We expect the mixing to be the strongest (if at all present) around the K and K points for valley  = + and  = -, respectively, and, thus, assume that
k, = 0 only in the region A and expand in its area leading to Eq. (F20). The energy change due to Uk = ±1 in
Eq. (F65) for the spin polarized state is found to be

E[k,] =

ak, sin2 k, + bk, sin k, cos k,

 kA

=

ak sin2 k,+ + bk sin k,+ cos k,+ ,

kA+

ak :=

ak, ,


bk := bk,,


(F66) (F67)

where we used the constraint k, = -k,- in the second line. Here and in all of the following computations of this
appendix, we focus on terms that do not vanish for w0 = 0. This is motivated by the fact that the final energy gain will already be of order D02 and so further corrections of order w0 of its prefactor will be subleading. We find

ak = 2 p (g,p),+(k) - (b,p),+(k)

p=±

4 +
N

V (q) (F¯1b,b+(k, q))2 + (F¯2b,b+(k, q))2 + (F¯1g,g+(k, q))2 - (F¯2g,g+(k, q))2 ,

q

4 -
N

V (q) (F¯1b,g+(k, q))2 + (F¯1g,b+(k, q))2 + (F¯2b,g+(k, q))2 - (F¯2g,b+(k, q))2 D02

q

8

bk

=

- N

V (q)

F¯jb,b+(k, q)F¯jb,g+(k, q) - F¯jg,g+(k, q)F¯jg,b+(k, q) D0.

q

j=1,2

(F68a) (F68b)

We see that bk, = 0 if D0 = 0 while ak, > 0. So sin k, = 0 minimizes the energy and, hence, there is no mixing
between the bands for D0 = 0, as expected by symmetry. However, any arbitrarily small non-zero D0 leads to bk, = 0 and the energy is lowered when the bands hybridize: Eq. (F66) is minimized by 0k, obeying tan 20k, = -bk,/ak, and with energy change

1

mink,+ E[k,+] = 2

ak -

kA+

a2k + b2k

 0.

(F69)

57
Since bk  D0, the energy correction scales as -g1VAD02, as indicated schematically in Table III.
Valley polarized. This state also preserves the C2z and valley U(1)v symmetries, such that Uk is again of the form of Eq. (F65); this time, however, without the constraint k, = -k,- as C2z and  are both broken individually. The energy change is of the form of Eq. (F66) with coefficients given by (again, only keeping terms to zeroth order in w0)

ak, = 2 (g,+),(k) - (b,+),(k)

2 +
N

V (q) (F¯1b,b(k, q))2 + (F¯2b,b(k, q))2 + (F¯1g,g(k, q))2 - (F¯2g,g(k, q))2 ,

q

2 -
N

V (q) (F¯1b,g(k, q))2 + (F¯1g,b(k, q))2 + (F¯2b,g(k, q))2 - (F¯2g,b(k, q))2 D02

q

4

bk,

=

- N

V (q)

F¯jb,b(k, q)F¯jb,g(k, q) - F¯jg,g(k, q)F¯jg,b(k, q) D0.

q

j=1,2

(F70a) (F70b)

Minimization yields

1 mink, E[k,] = 2

a2k, -

 kA

a2k, + b2k,  0.

(F71)

It is easy to see that ak, = a-k,- and bk, = b-k,-, following from C2z symmetry of the form factors and dispersion, and that ak and bk in Eq. (F68) are given by ak = 2ak,+ and bk = 2bk,+. As such the energy gain is the same for the spin and for the valley polarized states at w0 = 0.
Next, we discuss the quantum Hall state SLP-. While this state also preserves valley U(1)v symmetry and spin rotations, it breaks the k-space-local C2z symmetry. As such, the transformation has to be of the more general form in Eq. (F64), involving three generators, x,y,y. Due to the preserved C2z symmetry, we have (kj,)+ = (-jk) ,-. Exactly as before, general energetic reasoning leads to (kj,) = 0 if k / A. Instead of optimizing all three associated angles (kj,)+ simultaneously, let us first investigate them one at a time: first of all, j = 3 leads to EHF = 0 (for w0 = 0) in Eq. (F20). The generator x does lead to non-zero EHF, which is found to be of the form of Eq. (F66); this time with bk, = 0 and ak, as given in Eq. (F70a). Since ak, > 0, at least for sufficiently small D0, the system does not gain any energy as a consequence of hybridization described by (Uk), = , eik,x . The only generator left is j = 2, i.e., (Uk), = , eik,y ; in fact, this one allows for a reduction of energy and we obtain, to order w00, exactly the same of ak, and bk, as defined in Eq. (F70). In order to take into account the C2z constraint, k, = -k,-, we again simplify from Eq. (F66) to Eq. (F67). Upon noting, as above, that ak, = a-k,- and bk, = b-k,-, we have ak = 2ak,+ and bk = 2bk,+ and the energy reduction due to hybridization of the SLP- is the same as that of the VP state (at w0 = 0).
Upon noting that Mk = i0s0(0 ± z), k  A±, in Eq. (F40) for our Uk studied here, it is easy to compute the mixing matrix:

QbMk + Mkz = i(y + z)(0 ± z), k  A±,

(F72)

i.e., both graphene-like bands in the valley that is at low energies mixes with both TBG-like bands in the same valley. This agrees well with the correlator near the K point of the SLP- state obtained in HF, see Fig. 17.
To continue with the valley Hall state SLP+, we note that C2z is also broken in this state, leading again to the general form of Uk given in Eq. (F64) with three generators. This time  (rather than C2z) is preserved and we have (kj,)+ = (-1)j(-jk) ,-. As above, we study first each generator, j = 1, 2, 3, separately and note that j = 1 and j = 3 do not allow to lower the energy (again, for w0 = 0 and not too large values of D0). However, j = 2 does allow to lower the energy via hybridization for any non-zero D0. Writing k,+ = (k2,)+, the energy gain is of the form (F67) with

58 prefactors

ak = 2 p (g,p),+(k) - (b,p),+(k)

p=±

4 +
N

V (q) (F¯1b,b+(k, q))2 + (F¯2b,b+(k, q))2 + (F¯1g,g+(k, q))2 - (F¯2g,g+(k, q))2 ,

q

4 -
N

V (q) (F¯1b,g+(k, q))2 + (F¯1g,b+(k, q))2 + (F¯2b,g+(k, q))2 - (F¯2g,b+(k, q))2 D02

q

32

+

V (G)

N

G

F¯4bb(k , G)
k

F¯2b,b+(k, G) - F¯2g,g+(k, G) D02

8

bk

=

- N

V (q)

F¯jb,b+(k, q)F¯jb,g+(k, q) - F¯jg,g+(k, q)F¯jg,b+(k, q) D0.

q

j=1,2

(F73a) (F73b)

Comparison with the expressions for the VP and SLP- shows that the energy reduction due to hybridization is almost the same for the SLP+. The only difference is the additional Hartree term in ak, which is expected to be only a very small correction due to Eq. (A38) and since it is higher order in D0. As such, we have g3 g1 in Table III.
The corresponding Mk = i0s0(0 ± z), k  A±, in Eq. (F40) leads to the mixing contribution in Qk

QbMk + Mkz = i(yz + z)(0 ± z), k  A±.

(F74)

This means that both the upper and the lower graphene-like bands in the valley that is at low energies mixes with both TBG-like bands in the same valley, in perfect agreement with Fig. 17.
Finally, the situation is slightly more complex for the SSLP- state, as it also breaks SU(2) spin-rotation symmetry down to residual rotation along one spin axis (say sz). Consequently, we will have to allow for six generators,

(U ) =   e , k ,

i 0 ,

3 j=1

((kj,,0)

j

s0

+(kj,,3)

j

s3

)

(kj,,a) = (-jk,a,)-,

(F75)

where the constraint comes from C2z symmetry. Let us investigate every generator separately. First, one finds no change in energy for 3s0 and 3s3. In all other cases, the energy change is again of the form (F66). For 1,2s3 and 1s0 we get bk, = 0 and ak, > 0 (for sufficiently small D0) and, hence, no associated energetic gain. Hence, we are, again, only left with a single generator and (Uk), = , eik,2s0 with k, = -k,. The prefactors are given by Eq. (F70) and we obtain the same energetic gain as for the SLP- (or VP and SP) state. As anticipated in Appendix F 3, this mixing induces a gap for the SSLP- state as well, as also seen in our HF numerics, despite not explicitly ordering in the graphene-like bands (for small D0).

5. Hund's Coupling
In the real system, SU(2)+× SU(2)- is broken down to SU(2)s. Keeping U(1)v as an exact symmetry, any spinrotation invariant non-interacting Hamiltonian will automatically be invariant under SU(2)+× SU(2)- and, hence, the explicit breaking of this enhanced spin symmetry can only be captured by interaction terms. We refer to all such interaction terms collectively as "intervalley Hund's interactions".
In order to associate a sign of the Hund's coupling with a member of a given Hund's pair of states, we use the simple explicit form of the Hund's interaction given in Eq. (3.16) of the main text. By evaluation their respective Hartree and Fock energies, we can express the contribution of this interaction to each state in Table II:

59



ESP

=

-ESVP

=

2JH N



G

2
F¯1bb(k, G) - 4
k

2 F¯3bb(k, G) D04
k

EIVC-

=

-3ESIVC-

=

- 3JH 2N

(F¯1bb(k, q))2 + (F¯2bb(k, q))2 - 4(F¯3bb(k, q))2D04 - 4(F¯4bb(k, q))2D04

k,q

+4(F¯5bb(k, q))2w02 + 4(F¯6bb(k, q))2w02 - (F¯7bb(k, q))2w02D04 - (F¯8bb(k, q))2w02D04

EIVC+

=

-3ESIVC+

=

- 3JH 2N

(F¯1bb(k, q))2 + (F¯2bb(k, q))2 - 4(F¯3bb(k, q))2D04 - 4(F¯4bb(k, q))2D04

k,q

-4(F¯5bb(k, q))2w02 - 4(F¯6bb(k, q))2w02 + (F¯7bb(k, q))2w02D04 + (F¯8bb(k, q))2w02D04



ESSLP±

=

 2JH N



G

2
F¯2bb(k, G) - 4
k

2 F¯4bb(k, G) D04
k

ESLP± = 0 EVP = 0

(F76)

The form of the energies in the chiral-decoupled limit, w0 = D0 = 0, is indicated in the last two columns in Table III. Their signs can be found in the last column of Table II.
By construction of the order parameters in Table II, we see that a state and its Hund's partner have an energy contributions from JH of opposite sign. Furthermore, all states that are their own Hund's partners, are not affected energetically to linear order in JH .

Appendix G: Superconducting instabilities

1. Fluctuation-induced superconductivity

Finally, in this appendix we provide more details on how we determine the leading superconducting instabilities
in Sec. VII B that result from fluctuations of the candidate particle-hole orders of MSTG identified in this work.
Since the applied formalism is closely connected to Ref. 54, we will be brief and focus on the novel aspects relevant
here--the spinless valley time-reversal symmetry  of some of the states in Table II and what happens in the absence
of electron-phonon coupling--and illustrate the formalism explicitly with a minimal model for the IVC-. Integrating out the bosonic fields jq in the action S in Eq. (7.1) leads to an effective electron-electron interaction.
Projecting this interaction to the electronic degrees of freedom, fk;,s, with band energies (k), that are closest to the chemical potential for each momentum k, we perform a decoupling in the Cooper channel (focusing on intervalley pairing which is expected to be dominant), with Hubbard-Stratonovich fields s,s , and obtain the saddle-point equations [54]

s,s (k) = -


k

Vs¯s,,s¯s n2

(k, +

;
2 

k , (k )

) s¯

,s¯(k

).

(G1)

Here

the

interaction

matrix

elements

have

the

form

V s1,s2
s3 ,s4

(k,

;

k

,



)

=

W s1,s2
s3 ,s4

(k,

;

k

,



) + Vss31,,ss42 (k,

;

k

,



),

where

the first part is the SU(2)+× SU(2)- symmetric contribution of the phonons from Sphonon and the second is a result

of the particle-hole fluctuations,

Vss31,,ss42 (k, ; k

,

)

=

-

1 2

j-,s2

;-

,s3 (-k, -k

)[(k

-

k

)]j,j

j ,s1 ;

,s4 (k, k

),

(G2)

where j,s; ,s (k, k ) := u,s(k)|j(k, k )|u ,s (k ) are the matrix elements of the coupling vertices j in Eq. (7.3) with the respect to the wavefunctions u,s(k) of the low-energy fermions fk;,s.
Since the system has SU(2)s symmetry, we can always decompose pairing into singlet and triplet, which correspond to s,s (k) = (isy)s,s k, k = --k, and s,s (k) = (isyd · s)s,s k, k = ---k, respectively. Their respective

60

saddle-point equations immediately follow from Eq. (G1) and read as

k+ =

k

n2

Mks,k

+

2 +

(k

) k+ ,

Mks,k

1 =-
4

ss V-s,s-,ss (k, ;  k ,  ),

s,s ,,

(G3a)

and

+k =

k

n2

Mkt,k + 2+(k

) +k ,

Mkt,k

1 =-
4

 V-s,s-,ss (k, ;  k ,  ),

s,s ,,

(G3b)

respectively. To make progress, we need to take into account time-reversal symmetry. To begin with , we have  |u,s(k) =
 |u-,-s(-k) (technically, we are here using  = sxyK but this can equally well be used as a definition of  in Table II). For any set of bosonic modes, jq that are all even (t~ = +) or odd (t~ = -) under , we further have j(k, k ) = t~ j(-k, -k ) and, hence,

j,s; ,s (k, k ) =   t~

j-,-s;- ,-s (-k, -k )


.

(G4)

Similarly, we have j,s; ,s (k, k ) =   t j-,-s;- ,-s (-k, -k )  for bosonic modes even (t = +) or odd (t = -) under s [54, 66]. This allows us to rewrite the relevant SU(2)+× SU(2)--symmetry breaking part, M s,t, in M s,t = M0s,t + M s,t (with M0s,t related to W and phonons) as

(M s)k,k

=

1 8

t~

ss  Fk,,s;k , ,s ,

s,s ,,

M t

k,k

=

1 8

t~

Fk,,s;k , ,s ,

s,s ,,

(G5)

when applying . We here introduced

Fk,,s;k , ,s =

j,s;

,s

(k, 

k

)


[(k - 

k

)]j,j

j,s;

,s

(k, 

k

)



0,

(G6)

which is non-negative, since  has to be positive definite due to stability [54, 66]. For conventional time-reversal symmetry, s, singlet and triplet switch their role [54]

(M s)k,k

1 = 8 t

Fk,,s;k , ,s ,

s,s ,,

M t

k,k

1 = 8 t

ss  Fk,,s;k , ,s .

s,s ,,

(G7)

Upon writing s(k) = k+/

n2 +

2 +

(k)

and

t(k)

=

+k /

n2 + 2+(k), we can recast solving the saddle-

point equations in Eq. (G3) as solving for the largest eigenvalue t,s(T ) of the symmetric matrix (M s,t)k,k :=

Mkt,,sk /

(n2 +

2+(k))(n2

+

2 +

(k

))

as

a

function

of

temperature

T.

The critical temperature, Tcs,t, in the two chan-

nels corresponds to t,s(Tcs,t) = 1. Defining (M s,t)k,k := Mkt,,sk /

(n2 +

2 +

(k))(n2

+

2 +

(k

)),

we

immediately

see from Eqs. (G5) and (G7), that (M s)k,k  (M t)k,k if t = + or t~ = - and (M t)k,k  (M t)k,k if t = - or t~ = +.
Let us first discuss the situation without electron-phonon coupling and, hence, M s,t = M s,t. As follows from the

Perron-Frobenius theorem, given two square matrices A and B of equal size with Aij  |Bij| and A being irreducible
[73], the largest eigenvalue of A (the "Perron root") is larger than the magnitude of the largest eigenvalue of B. We then have s(T )  t(T ) and, hence, Tcs  Tct if t = +; this means that singlet will generically dominate over triplet. Similarly, if t~ = +, we get t(T )  s(T ) leading to Tct  Tcs, which means that triplet will dominate. Note that if the fluctuations have a well-defined behavior under both s and  and we further have t = t~, Eqs. (G5) and (G7) imply that M s = M t, i.e., singlet and triplet remain degenerate.

In the scenario proposed in Ref. 54, where electron-phonon coupling yields an important contribution in stabi-

lizing superconductivity but predominantly in the SU(2)+× SU(2)--symmetric channel, we treat the symmetrybreaking M s,t as a small perturbation to the SU(2)+× SU(2)--symmetric M0s,t := M s,t - M s,t associated with the phonons. As follows from the analysis of Ref. 66, we must have 0t,s(k) > 0 for the unperturbed

61

saddle-point solutions, i.e., leading eigenstates of M0s,t. As such, it is clear that the leading (first-order) correction s,t = k,k 0t,s(k)(M s,t)k,k 0t,s(k ) is larger for singlet (triplet), which then dominates, if t = + (t = -) or t~ = - (t~ = +).
We illustrate these statements more explicitly for the IVC- state, which is odd under s and even under , i.e., characterized by t = - and t~ = +. As already mentioned in Sec. VII B, a minimal description is given by [(in, q)]j,j = 0j,j /(2n + c2q2 + -2), j = 1, 2, and j(k, k ) = s0jfk,k , where fk,k is a matrix in band space with fk,k = fk ,k = -fkT ,k. This leads to

Fk,,s;k , ,s

=

20s,s ,- 2n + c2q2 + -2

u,s(k)|fk,k |u,s(k ) 2  0.

(G8)

So only matrix elements with ss  = -1 are non-zero such that M s,t are identical in Eqs. (G5) and (G7) for t = - and t~ = +. We, thus, consistently see that IVC- fluctuations will favor the triplet state.
Finally, consider the SLP- state, which is odd under both s and  and, thus, has t = t~ = -. To be consistent with the analysis above, fluctuations of this state must affect singlet and triplet in exactly the same way. This can
also be easily seen explicitly by noting that its coupling vertex  in Eq. (7.3) cannot couple different valleys or spin species and, hence, Fk,,s;k , ,s  s,s , . Consequently, we get M s = M t in Eqs. (G5) and (G7).

2. Order parameter in the polarized phase

Finally, we also illustrate the spin-structure of the superconducting order parameter in the presence of flavor polarization, relevant for  with 2 || 3. For both SP-based and SVP-based band resetting, the superconducting order parameter in the TBG-like bands has the form

HSbC,p =

k k;+- k;- + H.c.,

k

(G9)

where k;± are the electronic operators of valley  = ± in the polarized TBG-like bands which are closest to the Fermi level for each k. In principle, there are also finite band-off-diagonal matrix elements. However, since we are only interested in the predominant spin-structure of the superconductor, we do not need to take them into account. Note that, if the band resetting also involves intervalley coherent order, such as in Fig. 7(c,d), the labels ± of k,± have to be understood as combinations of the two valleys; the spin structure we discuss here will not be affected by it.
To transform back to the physical spin (s =, ) basis, we write k; = s(uk;)sfk;,s, where the two-component spinor, uk;, encodes the nature of the flavor polarization. The singlet, sk, and triplet, dk, component of the order parameter, coupling as HSbC,p = k kfk;+,s ((s0sk + s · dk)isy))s,s f- k;-,s + H.c., then follow from

((s0sk + s · dk)isy))s,s = (uk;+)s(u-k;-)s .

(G10)

For the case of SP, where the spin polarization is in the same direction in the two valleys, say along the sz direction, we have

(uk;±)s = s,,  sk = 0, dk = -k(1, i, 0)T /2,

(G11)

corresponding to non-unitary triplet pairing. A Zeemann field, BZ, will not affect the polarization nor the superconductor (except for pinning the direction of their magnetizations).
For the SVP-type of polarization, we have instead (choosing the polarization along the sx axis)

1 uk;± = 
2

±1 1

 sk = k/2, dk = k(1, 0, 0)T /2,

(G12)

leading to an equal admixture of singlet and triplet pairing [27]. Applying BZ, will pin the orientation of the spin to be orthogonal to it and induce a canting of angle  that increases with |BZ|. For BZ along the sz direction, we thus get

uk;± =

1

±(1 + sin )

2(1 + sin )

cos 

 sk = cos k/2, dk = k(1, i sin , 0)T /2.

(G13)

62

TABLE VI: We explicitly list the notation we use to denote the Pauli matrices which act on the sublattice, minivalley, valley, and spin degrees of freedom used throughout the text in the second column, and the notation used in [25] in the third column.

Sublattice Minivalley
Valley Spin

Notation in this work  µ  s

Notation in [25]  µ  

So we see that this state continuously transforms into the non-unitary triplet when applying a magnetic field. We note the behavior in magnetic field of these pairing states--the non-unitary triplet and singlet-triplet admixed phases--is the same in the absence of polarization, as shown in Ref. 27.

Appendix H: WZW terms in MSTG

In this appendix we will give more details on how we reached the conclusions in Sec. VII C. We will begin as in the main text with || = 0. In this case, as in the main text, the low-energy physics is captured by

H0D = q [1qx + 2qy] q,
q

1 = xµzs0, 2 = yµ0s0,

(H1)

where we are using the notation for Pauli matrices defined in Table VI. We will assume a pairing  with 2 real components and an insulating order parameter mj with three real components, incorporated as a Dirac masses,

H1D = q mj q +

q T - q + H.c.

q,j

q

(H2)

with T = µxsy. We want to consider all possible pairings  and insulating states mj such that when the Dirac fermions are integrated out of the action corresponding to H0D + H1D, a WZW term will be produced. One way to do this would be to consider which of the options classified in [25] survive projection to a minivalley-valley locked subspace.
Alternatively, we can consider which orders are compatible with the conditions derived in [25] for the projected form
of the Dirac action. We will choose the second way in this appendix. We will first consider the compatible pairings
 at  = 0. At  = 0, triplet pairing is excluded as we require SU(2)s spin symmetry to be intact before the bands acquire any ordering. A requirement for a pairing to be compatible with the existence of a WZW term is that it must
satisfy the following conditions with the kinetic term's  matrices

iT = -T iT = 0 i = 1, 2.

(H3)

We will additionally assume pairings which do not break moiré translational symmetry and intervalley pairing terms
which preserve U (1)v. We have also chosen a momentum independent . The only pairing compatible with all the
above requirements is  = 1, transforming under the A representation of the point group. As mentioned in the main
text, this is the same pairing considered for TBG in [25] projected to the minivalley-valley locked subspace. For this
pairing, we can then ask what are the compatible 3-component order parameters mj, j = 1, 2, 3. The conditions the insulating states must satisfy with the pairing and  matrices are:

Tr[i1 i2 mj1 mj2 mj3 ]  i1i2i3j1j2j3

(H4)

mjT = T mTj = 0 j = 1, 2, 3

(H5)

We find the only two options are a 3-component spin-Hall state zµz(sx, sy, sz) and a 2-component moiré density wave state x(µx, µy) combined with a third component sublattice polarized state z.
We can then consider the case at || = 2. As argued in the main text, the low-energy Dirac theory takes the same form as at  = 0, see Eq. (H1).
However, unlike the case at  = 0, we no longer assume SU(2)s spin symmetry. It is simple to see the options which were compatible at  = 0 for singlet pairing are still compatible at  = 2. On the other hand, the breaking of

63
spin rotation symmetry allows for additional options at || = 2 which were not previously possible at || = 0. It is easily verified that the triplet pairing  = µzsz satisfies Eq. (H3). We find two options which are compatible with this pairing. The first is the set of orders z(sx, sy) and zµzsz, corresponding to our SSLP+ and SSLP- respectively. The second is x(µx, µy) and z, corresponding to a moiré density wave state and SLP+ state respectively.

