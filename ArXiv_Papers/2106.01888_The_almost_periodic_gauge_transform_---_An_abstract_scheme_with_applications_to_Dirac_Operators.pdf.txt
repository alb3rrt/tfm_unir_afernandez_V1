arXiv:2106.01888v1 [math-ph] 3 Jun 2021

THE ALMOST PERIODIC GAUGE TRANSFORM -- AN ABSTRACT SCHEME WITH APPLICATIONS TO DIRAC OPERATORS
JEAN LAGACÉ, SERGEY MOROZOV, LEONID PARNOVSKI, BERNHARD PFIRSCH, AND ROMAN SHTERENBERG
ABSTRACT. One of the main tools used to understand both qualitative and quantitative spectral behaviour of periodic and almost periodic Schrödinger operators is the method of gauge transform. In this paper, we extend this method to an abstract setting, thus allowing for greater flexibility in its applications that include, among others, matrix-valued operators. In particular, we obtain asymptotic expansions for the density of states of certain almost periodic systems of elliptic operators, including systems of Dirac type. We also prove that a range of periodic systems including the two-dimensional Dirac operators satisfy the Bethe­Sommerfeld property, that the spectrum contains a semi-axis -- or indeed two semi-axes in the case of operators that are not semi-bounded.

CONTENTS

1. Introduction

2

1.1. A Gauge transform.

2

1.2. Description of the results for elliptic systems and the Dirac operator

5

1.3. Description of the main results and plan of the paper

7

Acknowledgements

9

PART I : AN ABSTRACT GAUGE TRANSFORM SCHEME

9

2. Generalised almost-periodic operators

9

2.1. Generalised Sobolev spaces

9

2.2. An algebra of operators

10

3. Elliptic and diagonal operators

16

4. The Density of States Measure and von Neumann Algebras

20

4.1. Representations of the operator algebra

20

4.2. The density of states measure

23

5. Gauge Transform

28

5.1. The commutator equation

30

5.2. Weak gauge transform

32

Date: June 4, 2021. 1

2

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

5.3. Parallel weak gauge transform

34

5.4. Strong gauge transform

36

6. Systems of Almost Periodic Operators

38

6.1. Symbol formalism for systems of almost periodic operators

38

6.2. Gauge transform in S m : the reduction to uncoupled operators

40

PART II : APPLICATIONS TO ASYMPTOTIC PROPERTIES OF SYSTEMS

44

7. Besicovitch space and systems of operators

46

7.1. Concrete systems of operators

47

7.2. Conditions on the perturbation and its frequency set

48

8. Asymptotic expansions for the IDS

50

8.1. IDS for uncoupled operators

51

8.2. Reduction to a finite interval

52

8.3. Reduction to a quasiperiodic operator

54

8.4. Reduction to uncoupled operators

56

9. The structure of periodic operators

58

9.1. Description of periodic operators

58

9.2. The overlap function

60

10. Systems of periodic operators ­ The Bethe-Sommerfeld property

63

10.1. The Bethe-Sommerfeld property

63

11. Bethe­Sommerfeld for uncoupled operators

65

11.1. A description of the spectrum

67

11.2. Description of the resonant sets

69

11.3. Volumes of intersections

71

11.4. Estimates on the overlap function

72

12. The Dirac Operator

77

12.1. Clifford algebras

78

12.2. Dirac operators

79

References

84

1. INTRODUCTION
1.1. A Gauge transform. During the last fifteen years, substantial progress has been made in the spectral theory of periodic and almost periodic scalar operators. An important tool that was developed during this period and was used to obtain asymptotic spectral results was the method of gauge transform (see, e.g., [Sob05, Sob06, PS10, PS12, MPS14, PS16, Ivr19, PS19]). This

GAUGE TRANSFORM AND APPLICATIONS

3

method, which heavily uses commutator estimates, was originally created for classical pseudodifferential operators (see e.g. [Wei77, Roz78]) but was then modified to the periodic case by Sobolev [Sob05, Sob06] and to the almost periodic setting by Parnovski and Shterenberg [PS12]. The aim of this paper is to describe the method of gauge transform on an abstract level and then apply this abstract scheme to a concrete example -- elliptic systems of operators (including Dirac operators).
Here is the basic setting: suppose that we are given an operator

A = A0 +B,

where A0 is a diagonal operator in a given basis and B is a perturbation, which is assumed to be small in some sense. The standard example which the reader may want to keep in mind is

A0 = diag(a1(-)/2, . . . , am(-)/2),

where  > 0, 0 = a j  R, and B is a pseudo-differential perturbation of order smaller than  with periodic or almost periodic coefficients. For instance, a Dirac operator with an almost periodic

potential can be brought to such a form by a unitary transformation. In many applications we

will furthermore require A to be self-adjoint, even though our general scheme may not always

require it.

We want to find an operator A that is unitarily equivalent to A and is simpler ­ either diagonal

or, failing this, has a form

A

=

U

AU

-1

=

A

 0

+

B

,

(1.1)

where A0 is diagonal, U is unitary, and B  is a perturbation that is smaller than B . The notion of `smallness' assumes that we have a small parameter, and B  has this small parameter entering

in a higher power than B . The most common example of application to PDEs assumes that the

order of B  is smaller than the order of B (so the role of the small parameter is played by the

inverse of the energy), but in some cases the small parameter can be chosen to be a coupling

constant, see [PS19]. The operators A and A have the same spectrum and the hope is that it is

easier to describe the spectrum of A, both quantitatively and qualitatively. As an example of the

spectral properties we want to study, we list the following two types of problems:

(1) Obtaining asymptotic expansions for the so-called integrated density of states N (A; ) as the spectral parameter  tends to ±;
(2) If B has periodic coefficients, to prove that whenever A is unbounded above (resp. below), its spectrum contains a semi-axis [0, ) (resp. (-, 0]). Such an operator A is said to satisfy the Bethe­Sommerfeld property.

4

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

If we seek the unitary operator U in (1.1) in the form U = exp(i ), then we have

A

=

A0

+

B

+

i

[

A0,

]

+

i

[B

,

]

-

1 2

[[

A

0

,

],

]

-

1 2

[[B

,

],

]

+

R

,

(1.2)

where R consists of further terms given by formally expanding the series for the exponentials

exp(i ). Our hope is to solve the equation

B + i [A0, ] = 0

(1.3)

for , so that the second and third terms of (1.2) cancel each other. Ideally, the rest of the terms (starting from the fourth one) would indeed be smaller than B . In most cases, however, these two wishes turn out to be infeasible.
The main obstacle is that solutions  to equation (1.3) involve a denominator that could be small for some B (for example, to have any hope of solving (1.3), the diagonal part of B has to be absent). Therefore, we usually have to modify our procedure and divide the perturbation B into two parts ­ good (or non-resonant) part B N R for which the equation

B N R + i [A0, ] = 0

(1.4)

has a nice solution N R and bad (or resonant) part B R = B - B N R which we will be unable to destroy using our procedure. Thus, at the end we will have

A = A0 + B R + B ,

(1.5)

where B  is smaller (in order, say) than B . Of course, we also hope that the resonant part B R is better in some sense than the initial perturbation B ; in many applications, the operator B R acts in subspaces of our Hilbert space generated by `specially designated and geometrically defined' areas of the phase space.
After we have reduced our operator to the improved form (1.5), in principle we can repeat the same procedure -- finitely, or even infinitely many times. The latter process is much more difficult to realise, and we will not give examples of it in this paper. However, in many settings we indeed have to run this procedure several times (more than once) in order to achieve the desired `smallness' of the remainder. In other words, we construct the `improved' operator in the form

An = exp(i n)... exp(i 2) exp(i 1)A exp(-i 1) exp(-i 2)... exp(-i n).
We call this method the consecutive gauge transform. Sometimes, it is more convenient to look for the improved operator in the form
A(n) = exp(i (n + . . . + 2 + 1))A exp(-i (1 + 2 + . . . + n)),

GAUGE TRANSFORM AND APPLICATIONS

5

which we call the parallel gauge transform. In both situations, the operators j are solutions of equations similar in form to (1.4).
Another important distinction between different variations of the gauge transform is as follows. In order to prove that the order of the remainder B  is smaller than the order of B , we have to estimate the orders of various commutators. Sometimes, it is enough to have the basic estimate: the order of the commutator is not greater than the sum of the orders of its entries. This estimate holds without any restrictions, but for it to be effective we need to have some a priori inequalities between the orders of the principal term A0 and the perturbation B ; we call this approach the weak gauge transform. On the other hand, quite often we can improve our estimate on commutators: for example, in the classical scalar pseudo-differential calculus, the order of the commutator can be estimated by the sum of the orders of the entries minus one. If we have such an estimate, we can guarantee that the order of B  is indeed smaller than the order of B , assuming nothing other than that the order of A0 is larger than the order of B . This approach is called the strong gauge transform. In this paper, we will define the weak and strong gauge transforms rigorously and give a general abstract setting in which they can be applied. We discuss the advantages and drawbacks of both types of gauge transforms and finish with a couple of concrete applications.
The first application is to obtain asymptotic expansions for the density of states of elliptic almost periodic operator systems. Under some technical conditions described later, we may either obtain complete or limited expansions as the spectral parameter goes to ±. The other application is to prove that some elliptic periodic systems have the Bethe­Sommerfeld property. This will be done under the same conditions that allow us to obtain a complete asymptotic expansion for the density of states. In either of these cases, some Dirac operators are examples of those to which we can apply our results.

1.2. Description of the results for elliptic systems and the Dirac operator. While describing the precise class of operators A for which we obtain spectral asymptotics requires definitions that are made later, we can make these results explicit for Dirac operators in dimension 2 and 3 perturbed by classical pseudo-differential almost periodic operators right away. The twodimensional Dirac operator with mass M acts in L2(R2; C2) and is given by

A2,M := -i (1x1 + 2x2 ) + 3M ,

where 1, 2, 3 are the Pauli matrices

0 1 = 1

1 0

,

0 2 = i

-i 0

,

and

1 3 = 0

0 -1

.

6

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

The three-dimensional Dirac operator with mass M acts in L2(R3; C4) and is given by

A3,M := -i 1x1 + 2x2 + 3x3 + M , where the matrices j ,  are the Dirac matrices (see [Upm02])1

0 j = j

j , 0

and

 = Id2 0

0. - Id2

We obtain asymptotic expansions for the density of states of operators of the type A = Ad,M + B under the assumption that B is a `generic' almost periodic pseudo-differential perturbation. The precise meaning of generic is given in Section 7. The density of states for elliptic differential

operators A that are not semi-bounded can be defined by the formula

N

(;

A)

:=

lim
L

N

(; AD(L)) (2L)d

.

Here, A(DL) is the restriction of A to the cube [-L, L]d with Dirichlet boundary condition, and N (; A(DL)) is the counting function for the discrete eigenvalues of A(DL) in the interval [0, ) when  > 0 and (, 0] when  < 0. Later, we will give several equivalent definitions of N () which are
more convenient to work with and allow pseudo-differential perturbations.

Theorem 1.1. Let A = A2,M + B, where B is a generic symmetric pseudo-differential operator with almost periodic coefficients of order  < 1 acting in L2(R2; C2). Then, there is a complete asymptotic
expansion for the density of states of A in the sense that for every K > -2, there is a finite set L  (0, 2 + K ) and constants C ±j , C ±j,log, j  L  {0} such that

N (±; A) = C0±2 +

C ±j 2- j + C ±j ,logj log  + O -K

j L

as   .

Theorem 8.2 is a more general version of Theorem 1.1. It is applicable to elliptic systems of pseudodifferential operators whose principal symbol has only simple eigenvalues.
We obtain a restricted expansion for the three-dimensional case.

Theorem 1.2. Let A = A3,M + B, where B is a generic operator of the form
B = B11 + B22 + B33 + B + BId Id4,
where each B j , j  {1, 2, 3, , Id} is a scalar symmetric pseudo-differential operator with almost periodic coefficients of order , 0    1/2. Then, writing  = max  - 1, 2 - 1 there is a finite
1Many authors would write j for j and  for , see e.g. [Tha92]. We keep our convention in line with higherdimensional generalisations and to avoid some notational conflicts later on.

GAUGE TRANSFORM AND APPLICATIONS

7

set

L



(0, 1 -

 )

and

constants

C

± j

,

C ±j ,log,

j



L

 {0}

such

that

N (±; A) = C0±3 +

C ±j 3- j + C ±j ,log3- j log  + O 2+

j L

as   .

This time, it is Theorem 8.1 which is a more general version of Theorem 1.2. It is applicable to elliptic systems of pseudodifferential operators whose principal symbol has multiple eigenvalues under some more restrictive conditions on the perturbation.
We also obtain that two-dimensional Dirac operators satisfy the Bethe­Sommerfeld property.

Theorem 1.3. Let A = A2,M +B, where B is a symmetric pseudo-differential operator of order  < 1 with periodic coefficients. Then, there exists 0 > 0 such that the spectrum of A contains intervals (-, -0] and [0, ).
This theorem also has a more general version in Theorem 10.1. It is applicable to systems whose principal symbol has only simple eigenvalues.
In Section 12, we also describe generalisations of these results to higher dimensional Dirac operators, and give some technical conditions under which we can get complete asymptotic expansions or the Bethe­Sommerfeld property for the three-dimensional Dirac operator.

1.3. Description of the main results and plan of the paper. In the first half of our paper, we discuss the gauge transform in an abstract setting. The setting is developed while keeping in mind particular applications to almost periodic operators. As such, the space on which the operators act looks like an abstract version of a Besicovitch space. In the second half, we will discuss the specific applications of the results obtained in the first half to elliptic systems of pseudodifferential almost periodic operators; in particular, in the last section we will show that Dirac operators are a specific example of them. An interesting part of the application of our methods to systems is that we need to intertwine and alternate the use of the weak and strong gauge transforms, whereas in the past only one type was used at a time. In order to help the reader familiar with previous literature on the method of gauge transform, we have kept the notation as close as possible to the one used in [MPS14, PS10].

Plan and results of Part I. In Section 2 we define an algebra of operators S acting on a non separable Hilbert space which should be thought of as an abstract version of a Besicovitch space. For some set  this algebra will be concretely realised on 2() through a group action on its basis elements. This algebra is filtered as an algebra of pseudo-differential operators on 2(), and it has similar properties to those of classical pseudo-differential operators in the PDE sense. Their natural domains are generalisations of Sobolev spaces. This section contains many technical but

8

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

very useful lemmas describing boundedness properties, adjoints, compositions and commutators of operators in S. One of the main differences with classical pseudo-differential operators is illustrated in Proposition 2.16, which plays the role of the Calderon­Vaillancourt theorem in our setting. It essentially says that we can directly correlate symbol norms of operators with the norms of individual summands in Paley-Wiener type decompositions.
In Section 3, we turn our attention to some natural subspaces of S ­ operators that are either elliptic or diagonal. Just as in the classical setting, our definition of elliptic operators allows us to characterise natural domains of self-adjointness for operators in the algebra S. The three main results of this section illustrate the three most important properties of elliptic operators. In Proposition 3.5, they are shown to admit a parametrix, and are therefore invertible up to a controllable error. Lemma 3.6 is used repeatedly throughout the paper and shows that lower order perturbations of elliptic operators are relatively bounded, with explicit bounds. Finally, in Proposition 3.7, we show that elliptic operators are closed and self-adjoint if symmetric.
In Section 4, we consider the situation where operators in S are affiliated to a I or II factor. This is common in the study of almost-periodic operators and their generalisation. We define a general notion of density of states measures (DSM) in S as traces in the affiliated I or II factor. We give a variational description of the DSM of an interval J even in situations where the operator is not bounded below. This is used to show the principal results of this section: small perturbations of elliptic self-adjoint operators do not change their density of states much. The definition of 'smallness' of the perturbation is made clear in that section. In Lemma 4.11, we control to what extent perturbations of smaller order can affect the DSM, whereas in Lemma 4.12 it is perturbations that are spectrally supported away from the interval J that are shown to have a small effect.
In Section 5, we describe the abstract gauge transform scheme, which is split into two cases: the weak and strong gauge transforms. In both cases, we describe the resonant regions geometrically as subsets of the index set . The consecutive scheme for the weak gauge transform is described in Lemmas 5.5 and 5.6 and Corollary 5.7, whereas the parallel scheme is described in Proposition 5.9. In both cases, only trivial estimates on the commutator are used. In Lemma 5.10, we describe conditions under which a stronger scheme can be used. Since conditions for the strong transform to be applicable are varying in nature, we do not attempt at completely classifying them.
Finally, in Section 6, we describe the case where the symbols are functions into Matm×m(C) rather than C. We describe how this can be reduced to the abstract scalar case and introduce a new class of operator systems: uncoupled operators. Our goal is to show that under some specific conditions, elliptic systems are unitarily equivalent to uncoupled operators up to a remainder which we can control. In that light, the main results of this section are Theorems 6.4

GAUGE TRANSFORM AND APPLICATIONS

9

and 6.6 which give explicit conditions under which one can use the weak gauge transform to conjugate elliptic symmetric operators into almost uncoupled ones. The remainders are small (in the sense of Section 4) perturbations.

Plan and results of Part II. In the second part, we apply the results of Part I to concrete systems of elliptic pseudo-differential operators with periodic and almost periodic perturbations. More specifically, we study operator systems of the form A = A0 + B, defined on a dense domain in L2(Rd ; Cm) where A0 is defined as in (1.1), and B is a pseudo-differential perturbation of order  < . In Section 7, we give a description of these operators in term of Besicovitch space, and we make the relevant definitions concerning periodic operators. In Sections 7.2 and 8, we obtain asymptotic expansions for the IDS. In Sections 10 and 11 we prove that some elliptic systems of operators have the Bethe­Sommerfeld property using some combinatorial geometric arguments. Finally in Section 12 we expose how Dirac operators may fit in our setting.
Since the precise description of the results requires some notations and language defined in Part I, we postpone their description to the beginning of Part II.

Acknowledgements. The research of JL and LP was supported by EPSRC grant EP/P024793/1. The research of JL was also partially supported by NSERC's postdoctoral fellowship. The research of SM was supported by RSF grant 18-11-00032. The research of RS was supported by NSF grant DMS-1814664.

PART I : AN ABSTRACT GAUGE TRANSFORM SCHEME
2. GENERALISED ALMOST-PERIODIC OPERATORS
In this section, we define an algebra of generalised almost-periodic operators. We start by defining the space on which those operators are defined. We also define generalised Sobolev spaces which are their natural domains. We then describe the algebraic properties of the generalised almost-periodic operators, and obtain version of the Calderon­Vaillancourt theorem in our context in Proposition 2.16.

2.1. Generalised Sobolev spaces. Let  be an infinite, possibly uncountable set equipped with a weight function · :   [1, ). We will often call  the index set. For   R we define the spaces

H() :=

x:C: x :   x

2 x 2 < 


and G() := H().
R

10

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

In particular, every x  H() vanishes at all but countably many   . Every H() is a Hilbert

space with inner product

x, y H() := 2x y.


(2.1)

It is easy to see that H0() = 2() with the standard orthonormal basis indexed bijectively from

 as



1 if  = ,

E := e :    ,

e :     0

, if  = 

and that H1()  H2() for all 1 > 2  R. When there is no risk of confusion, we will write H := H().

2.2. An algebra of operators. Let G be a group that acts from the left on , so that the action is free, i.e. only the identity of G has fixed points. We denote by g   the action of g  G on   . Starting from the weight function · on  we define one on G by

g  := 1 + sup g   -  .


(2.2)

We assume that G has a bounded range of action, which means that g  is finite for all g  G.

It will be useful for future convenience to observe the following properties of the weight func-

tion:

Lemma 2.1. For all f , g  G,    and t  R the following relations hold:

(1) (2) Peetre-type inequalities:

g  = g -1; g -1  g    g 

and  f g t  min  f t g |t|,  f |t|g t .

(2.3) (2.4) (2.5)

Proof. For all g  G,    the definition (2.2) implies (2.3) and the estimates

max 1, 1 +  - g   g     + g  - 1.

Note the relations

a + 1 - b = (b - 1)(a - b) + a /b  a/b, a + b - 1  a + b - 1 + (a - 1)(b - 1) = ab,

for all a  b  1. for all a, b  1,

(2.6)

GAUGE TRANSFORM AND APPLICATIONS

11

The first estimate in (2.4) follows from (2.6) and (2.7), the second from (2.6) and (2.8). Now by (2.2) and (2.7) for all f , g  G we obtain

 f g   1 + sup  f g   - g   + sup g   - 





=  f  + g  - 1   f g ,

(2.9)

which implies (2.5) for t > 0. Now (2.9) and (2.3) imply

g  =  f -1 f g    f  f g  and  f  =  f g g -1   f g g ,

which delivers (2.5) for t < 0. The case t = 0 is trivial.

Definition 2.2. We call a function b : G ×   C, (g , )  bg () an almost periodic symbol if there exists a countable set   G, closed under inversion and containing the identity idG , such that for all g  G \ , bg ()  0. Whenever there is no risk of confusion, we will write id := idG . We call  a frequency set for b and the functions {b( · )} the Fourier coefficients of b. For every symbol b and every   R, l  0, we define the family of norms

b

() l

:=

l


sup


- |b()|

.

The class of symbols of order  is defined as

(2.10)

S := S(G, ) :=

b :G×C:

b

() l

<



for

all

l



0

.

(2.11)

The space of symbols is naturally a linear space. It is clear that if  is a frequency set for a

symbol, then any    is also one. It is obvious from the definition that

·

() l

is a decreasing

function of  and an increasing function of l , thus

S1  S2 , for all 1  2.

We introduce

S := S and S- := S.

R

R

Lemma 2.3. For every   R, the space S equipped with the family of norms space.

·

() l

l0 is a Fréchet

Proof. Consider a sequence

(bn)n1  S

that is Cauchy with respect to

·

() l

for every l

 0, and denote by (n) a frequency set for each

bn. Then, for all   G, we observe that b() := nlim(bn)() exists and vanishes outside the

countable set  =

n (n). It is a simple computation to see that b  S with

bn -b

() l



0,

as

n  , for all l  0. Hence, the claim follows.

12

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Definition 2.4. Let b : G ×   C be a symbol with frequency set   G and b()   2(), for all   .
Then the almost periodic linear operator associated to b is B := Op(b) : span(E )  2()

defined by

B e := b()e, for all   .


(2.12)

Remark 2.5. If b  S, then, in view of (2.10) and (2.11), b()   1()  2() holds for all   . This means that we can associate an almost periodic operator to every symbol in S. On
the other hand, since the group action of G on  is free, b can be recovered from B via the identity

bg () = (eg , B e)2(), for all g  G,   .

(2.13)

Thus, there is a one-to-one correspondence between almost periodic symbols and almost peri-

odic operators. This correspondance is in contrast to the case of classical pseudo-differential

operators where this correspondence is only modulo smoothing operators. Hence, we allow

ourselves to overload the notation and write B = Op(b)  S if b  S,   R  {±}, and let

B

() l

:=

b

() l

for

all

l

 0,   R.

Note that this correspondence gets lost if one does not re-

quire the group action of G on  to be free. Our construction can be generalised to such non-free

group actions, but for simplicity of the exposition we do not do it in this paper.

We call B quasi-periodic if b admits a finite frequency set. A simple example of a quasi-

periodic operator of class S,   R, is Op(h) with



h

g

()

:=

h 0

()

if g = id, otherwise.

Here, h is a function on  satisfying |h()|   for all   .

Remark 2.6. Our terminology is justified by the following example. Suppose that G is a locally compact abelian (LCA) group and GB is its Bohr compactification, see [Shu78, §1]. Index by  the set of characters E := {e :   } of G or, equivalently, GB . On CAP(G), the continuous almost periodic functions on G, we can define an inner product ( f , g ) = M ( f g ), where M ( f ) is the mean of f with respect to the normalised Haar measure on GB . The Besicovitch space B2(G) is defined as the closure of CAP(G) with respect to the norm induced by this inner product. By [Shu78, Proposition 1.5], the map
E  E e  e,

GAUGE TRANSFORM AND APPLICATIONS

13

extends to an isometric isomorphism 2()  B2(G). In particular, for G = (Rd , +), one has E = {x  exp(i x · ),   Rd } and the operators in S(Rd , Rd ) correspond to almost periodic pseudo-differential operators in B2(Rd ) or L2(Rd ), see [Shu78, §3­4] and [PS12, Equation (8.8)]. The present work can be applied to more general settings, for example, when the underlying group G is non-abelian. Note that the Bohr compactification construction is inadequate in that situation, e.g., for G = SL(2; R) we have GB = {id}, see [Shu78, p. 4].

From Lemma 2.3 we obtain the following corollary.

Corollary 2.7. Let (Bn)n1  S be such that

n1

Bn

() l

<



for all l  0. Then the sum converges in S with

B := Bn
n1

B

() l



n1

Bn

() l

.

Up until now, operators from S were only defined on span(E ). We now show that they can be extended in a natural way.

Lemma 2.8. For every ,   R the operator B  S can be uniquely extended to a bounded linear operator B : H  H-. Moreover, we have the bound

B

HH- 

B

()
|-|

.

Proof. Let x, y  span(E ), i.e. x = y = 0 for all but finitely many . Then, the Cauchy­Schwarz and Peetre inequalities (2.4) imply

(x, B y )H- =

  2(-)b()x y

 

 |-| sup - |b()| ×





1/2

1/2

×

  2(-) x 2

2 y 2







B

()
|-|

x

H-

y

H .

The claim follows by density of spanE in H for all   R.

We obtain the following immediate corollary.

14

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Corollary 2.9. Every B  S0 extends to a bounded operator on 2 = H0 such that

B

22 

B

(0) 0

.

Definition 2.10. For b  S, we define



b

 

()

:=

b 0

-1

(



)

if   , if   G \ 

for all   , where  is a frequency set for b.

(2.14)

Lemma 2.11. If b  S, then b  S. Moreover, for all x, y  H, one has (x, B y )2() = (B x, y )2(), i.e. B   B .
In particular, B is symmetric on H if and only if B = B .

(2.15)

Proof. Every frequency set  for b  S is also one for b. Moreover, since  = -1 holds by convention, (2.3) and (2.4) imply that for all l  0,

b

()
=

l sup

l

B



-|b-1 (  )|

=

l sup -1  -|b-1 ()|

B





l+|| sup -|b-1 ()|

B



=

l+|| sup -|b()|

B



=

b

() l +||

,

thus b  S holds. Moreover, (2.13) and (2.14) yield

(e, B e) = (B e, e), for all ,   .

(2.16)

In view of Lemma 2.8 and the density of spanE in H, (2.16) extends to (2.15). This finishes the proof of the lemma.

Definition 2.12. Let a, b  S be symbols with frequency sets a and b. The composed symbol a  b with frequency set
ab := a b := {a b : a  a , b  b}

is defined as

(a  b)() :=

aa (b  )bb () for all   ab,   .

a b =

GAUGE TRANSFORM AND APPLICATIONS

15

Lemma 2.13. For ,   R let A = Op(a)  S and B = Op(b)  S. Then AB  S+ and AB = Op(a  b). Moreover, for all l  0 we have the bound

AB

(+) l



A

() l

B

() l +||

.

Proof. The frequency set ab is, clearly, a countable set. For any l  0, we have

ab

(+) l

=

l sup -- aa (b  ) bb ()

ab a b =





b l+|| sup - bb () ×

b b



×

a l sup b  - aa (b  )

a a





a

() l

b

() l +||

.

(2.17)

Thus a  b  S+ and (2.12) implies AB = Op(a  b).

It is natural to consider operators from S on the common domain H. Then Lemmata 2.8, 2.11, and 2.13 yield the following corollary.

Corollary 2.14. S = S is a -algebra of operators on H, filtered by R, with involution .
R
The subalgebra of regularising operators S- forms a two-sided ideal of S.

We also consider the adjoint actions ad(A, B ) := i(AB - B A) with the frequency set ad(a,b) = ab  ba . The Fourier coefficients of ad(A, B ) are

ad(a, b)() = i

aa (b  )bb () -

bb (a  )aa () ,

a b =

b a =

for all   ad(a,b). If G is commutative, (2.18) simplifies to

ad(a, b)() = i

aa (b  )bb () - bb (a  )aa () .

a b =

For k = 1, 2, 3, . . . and A, B, B1, . . . Bk  S, we define recursively

ad(A; B1, . . . , Bk ) := ad (ad(A; B1, . . . , Bk-1), Bk ) , ad0(A, B ) := A,

adk (A; B ) := ad(adk-1(A; B ); B ).

The following lemma is a direct consequence of Lemma 2.13.

Lemma 2.15. Let k  N and assume that A j  Sj for 0  j  k. Put

k
 = j,
j =0

k
^ = |j |.
j =0

(2.18) (2.19)

16

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Then

ad( A 0 ;

A1, . . . ,

Ak)



S.

Furthermore,

if

for

all

0



j



k

we

have

Aj

=

A

 j

,

then

ad( A 0 ;

A1, . . . ,

Ak)

=

ad(A0; A1, . . . , Ak ). Moreover, for all l  0 we have

ad(A0; A1, . . . , Ak )

() l



2k

k j =0

Aj

(j ) l +^-|

j

|

.

(2.20)

In particular, for any A  S, B  S0 and k  N we obtain the estimate

adk (A; B ) ()  2k
l

A

() l

B

(0) l +||

k.

(2.21)

For some  and G it may be possible to improve this lemma and show that ad(A, B )  S holds with  <  +  for all A  S, B  S. This will be discussed in Section 5.4.
The following proposition provides bounds on norms of operators restricted to `annuli' in .

Proposition 2.16. For 1  m  M  , let   {   : m    M } and denote by P the orthogonal projection in 2() onto the closure of span e :    . Then, for any A  S with   0, the

norm inequality

AP 22  M 

A

() 0

(2.22)

holds. For any A  S with   0, we get the inequality

AP 22  m

A

() 0

.

Proof. Observe that P is a quasi-periodic operator with a frequency set  = {id} and the symbol

(p)id = 1 (the indicator function of ). Thus, for all   R and l  0,



P

(-) l

=

sup




m M 

if   0, if   0.

(2.23)

If M <  or   0, then Corollary 2.9 and Lemma 2.13 imply the bound

AP 22 

A

() 0

P

(-)
||

,

and the statement of the lemma follows from (2.23). On the other hand, the inequality (2.22) is trivial for M =  and  > 0.

3. ELLIPTIC AND DIAGONAL OPERATORS
In this section, we introduce particular classes of operators from S and study their properties. Some of these classes do depend on the specific choice of orthonormal basis E for 2(). However, the class of operators on which our main theorems depend, that of elliptic operators, is invariant under change of basis.

GAUGE TRANSFORM AND APPLICATIONS

17

Definition 3.1. The subalgebra DS  S of diagonal operators is defined as
DS := A = Op(a)  S : {id} is a frequency set for a .
For symbols of operators from DS we can suppress the subscript id, i.e. we let a() := aid() for all A = Op(a)  DS,   . For   R  {-} we define DS := DS  S. Introduce the map D : S  DS, A  AD, that projects A = Op(a) onto its diagonal part AD := Op(aD) where
aD () := aid(),
i.e. AD e = e, Aee
holds for all   . We also define the off-diagonal part as AOD := Op(aOD) with aOD := a - aD.

Note that for any A  S with   R and all l  0,

AD

()
+
l

AOD

()
=
l

A

() l

(3.1)

and

AD

()
=

AD () .

(3.2)

l

0

Definition 3.2. The set DES of diagonal elliptic operators of order   R is defined as the set of operators A = Op(a)  DS for which there exist ellipticity parameters  > 0 and r  1 such that

|a()|   for all    such that   r .

(3.3)

Let the set of ellipticity parameters (, r ) of A be denoted by EP(A). Note that (, r )  EP(A) implies (, r )  EP(A) for all 0 <   , and r r .

Definition 3.3. The set SES of strongly elliptic operators of order   R consists of operators A  S such that AD  DES and AOD  S for some  < . For (, r )  EP(AD ) we define Pr as the diagonal operator with symbol 1{:r }. We also define Prc as Id -Pr , and

A,r := AD Prc + r Pr .

(3.4)

Definition 3.4. The set ES of elliptic operators of order   R consists of operators A  S for which there exists a unitary U  S0 with U AU   SES.

As we did with diagonal operators, we set

T := T, T- := T, for T  {DES, SES, ES}.

R

R

Clearly, both SES and ES are closed under addition of operators in S,  < .

18

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Proposition 3.5. Let A  S and  > 0 such that AD  DES. For any (, r )  EP(AD) the operator

A,r

is

invertible with

A

-1 ,r

 DS-

and

for all

l

0

we

have



A-,1r

() l

=

A-,1r

() 0



-1

r r

- --

for   0, for -    < 0.

(3.5)

Moreover, the following estimates hold for all   R, l  0:

A A-,1r - Id

(-) l



r

-

+

1 

r -

AD

()
+
0

AOD

() l

and

A-,1r A - Id

(-) l



r

-

+

1 

r -

AD

()
+
0

AOD

() l +

.

(3.6) (3.7)

Proof. We have that A,r - AD = (r  - AD )Pr , and since Pr  S-, which is an ideal of S, we observe that A,r  AD mod S-. By (3.3) and (3.4), A,r  DS and its symbol satisfies

a,r () = |aid()| 1>r + r 1r  1>r + r 1r

for all   . Hence A-,1r = Op a-,1r  DS- and (3.5) holds. The estimates (3.6) and (3.7) follow by applying (2.17) term-wise to the right hand sides of the

identities

A

A

-1 ,r

- Id

=

-Pr

+

-1r

- AD Pr

+

AOD

A

-1 ,r

,

A-,1r A - Id = -Pr + -1r - AD Pr + A-,1r AO D

and taking (3.2) into account.

Lemma 3.6. Let   R,  > max(, 0), 0 <  < , and assume that A  SES with AOD  S and B  S. Then for   0 the operator B is bounded, and, in the case of  >  > 0, for every x  H

and (, r )  EP(AD )  r  AOD (0)/ 1/(-) ,

we have

Bx



r -  - r -

B

() 0

AOD

() 0

Ax

+ r  1 + -1

AD

() 0

x.

In particular, B is infinitesimally A-bounded in 2().

(3.8)

Proof. The only non-trivial case is  >  > 0. For every x  H we have

Bx



B

A

-1 ,r

AD x + B (A-,1r AD - Id) x ,

GAUGE TRANSFORM AND APPLICATIONS

19

with A,r defined as in (3.4). Corollary 2.9 and displays (2.17), (3.5) and (3.7) imply the estimates

B (A-,1r AD - Id)



B

() 0

A

-1 ,r

AD

-

Id

(-) ||

r

B

() 0

1 + -1

AD

() 0

and and we obtain

B A-,1r



B

() 0

A

-1 ,r

(-) 0

 -1 B 0()r -,

Bx

 -1r - B

() 0

AD x

+ r  1 + -1

AD

() 0

x

,

(3.9)

which is (3.8) with AD  DES replacing A. Applying (3.9) with B = AOD, we arrive at

AO D x

 -1r -

AOD

() 0

AD x

+r

AOD

() 0

1 + -1

AD

() 0

x.

Hence we have

Ax  ADx - AODx



1 - -1r -

AOD

() 0

AD x

-r

AOD

() 0

1 + -1

AD

() 0

x,

which implies

AD x

 1--1r -

AOD

() -1 0

Ax

+r

AOD

() 0

1 + -1

AD

() 0

x

.

(3.10)

Substituting (3.10) into (3.9) we obtain (3.8).

We conclude the section with the following proposition.

Proposition 3.7. For   R, every operator from ES is closed on Hmax{,0} in the Hilbert space 2(). Every symmetric operator from ES defined on Hmax{,0} is self-adjoint.

Proof. For   0 we have ES  S0, and the statements follow from Corollary 2.9. Now assume

A  SES with  > 0. By (2.1), Definition 3.3 and Lemma 2.8, for any (, r )  EP(AD ) we have the

estimates

2

x

2 H



A,r x 2 

A,r

() 2 

x

2 H

for all x  H. Hence the graph norm of A,r is equivalent to the norm of H, and A,r is closed
on H. If A,r is symmetric, then for every x  dom(A,r ) there exists Cx  0 such that for all y  H

|(x, A,r y )|  Cx y 2().

20

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

In particular, with (yn) := a,r,id()1n x for n  r ,   , we obtain by (3.3) and (3.4) that

2|x|2  -1(x, A,r yn)  -1Cx yn 2()
 n

 -1Cx

A,r

() 0

2|x|2

1/2
.



n

Passing to the limit n  , it follows from (2.1) that x H  -1Cx A,r (0), i.e.

dom(A,r )  H = dom(A,r ),

hence A,r is self-adjoint. By Lemma 3.6 A - A,r is infinitesimally A,r -bounded, so that A is
also self-adjoint (see, e.g., Theorems 3.4.2 and 4.1.9 in [BS87]). For A  ES, by Definition 3.4 there exist a unitary U  S0 and H  SES such that A = U HU .
Moreover, it follows from Lemma 2.8 that U H = U H = H. Now, let (xn)nN  H with xn  x and U HU xn  z in 2, as n  . Since U is bounded, U xn  U x and HU xn  U z, thus the closedness of H implies that U x  H and HU x = U z, i.e. x  H and U HU x = z. Hence, A is
closed on H and self-adjoint if symmetric.

4. THE DENSITY OF STATES MEASURE AND VON NEUMANN ALGEBRAS
In this section, following [Shu79a], we consider a representation of S into another operator algebra, affiliated with an infinite factor (accounting for the almost periodicity), and define the density of states measure (DSM) for self-adjoint operators in ES with respect to this representation. For a suitable representation, this DSM will coincide with the classically defined DSM on elliptic differential operators with almost periodic coefficients. We follow the construction and terminology of [Shu79a, §1], generalising Shubin's symbol classes to the ones defined in Section 2.
4.1. Representations of the operator algebra. Let H be a Hilbert space and A a factor of either type I or II in B(H), the algebra of bounded linear operators in H. Let H be a dense subspace of H and
S = S
R
a -algebra of unbounded linear operators in H defined on H, filtered by R. We assume that SH  H, and that S is invariant under the involution A  A := A|H, where A is the adjoint to A  S. We also suppose that S is affiliated with the factor A, denoted SA. Finally, we consider a representation  : S  S having the following properties:
(i)  is a homomorphism of filtered -algebras with (S)  S, for all   R.

GAUGE TRANSFORM AND APPLICATIONS

21

(ii) For every A  S0, (A) extends to a bounded linear operator on H with

(A) HH = A 2()2() .

(4.1)

(iii) For all A  S, (A) is closable in H with the closure A := (A). For every  > 0 there exists a dense subspace H  H such that (a) H  H if 0 <   , (b) A  DES implies dom(A) = H, (c) for all B  S0, B H  H.
(iv) If A  DES,  > 0, is self-adjoint on H, then A is self-adjoint.

Remark 4.1. When A is a I factor some of the statements in this section become rather trivial. However, we include this case for applications in Section 10.

Remark 4.2. In [Shu79a], Shubin considers G = Rd acting on itself by translation, with almost periodic operators acting both in Besicovitch space B2(Rd ) = 2(Rd ) and in L2(Rd ) through the

Fourier integral representation of pseudo-differential operators. The appropriate Hilbert space

is then

H = B2(Rd )  L2(Rd ),

and the II factor A is generated by the two families of operators

e  e :   Rd and I  T :   Rd ,

where e is multiplication by the character e(x) = ei·x and T is the translation operator T f (x) = f (x-). The representation  is given on A = Op(a)  S by the linear operator (A) = a(x+y; Dy) acting on
H := B2(Rd )  H^ (Rd ).
Here, x is the variable of functions in B2(Rd ), y is the variable of functions in L2(Rd ), Dy = -iy, and H^ (Rd ) := f  C(Rd ) :  f  L2(Rd ) for all   Nd0 .

Properties (i) and (ii) of the representation  imply the following lemma.

Lemma 4.3. If A  S0, then A is defined on H and satisfies A  = A  = A  and A HH = A 2()2(). In particular, the map S0  B(H), A  A is an injective homomorphism of -
algebras. If U  S0 is unitary, then so is U .

We will now carry over Lemma 3.6 to images under . This provides us with some information on the domains of operators from (S).

Lemma 4.4. Let   R, B  S and A  SES for some  > 0. Then (1) >max{,0} H  dom(B ),

22

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

(2) dom(A) = H. (3) Suppose  <  and 0 <  <  with AOD  S. Then for   0 the operator B  is bounded,
and, otherwise, for every   H and

(, r )  EP(AD )  r  AOD (0)/ 1/(-) ,

we have

B 

r - H
 - r -

B

() 0

AOD

() 0

A

H + r  1 + -1

AD

() 0

In particular, B  is infinitesimally A-bounded in H.

H.

(4.2)

Proof. For   0 the statements (1) and (3) follow from (4.1). Let now  > 0 and assume that 0 <  <  with AOD  S. Following the proof of Lemma 3.6 and applying properties (i) and (ii) of the representation  where necessary, we derive (4.2) for   H. Consequently, the graph norm of (B ) is dominated by the graph norm of (A), thus dom(B )  dom(A). Applying (4.2) for AOD instead of B and AD instead of A, we conclude that the graph norms of (A) and (AD) are equivalent, thus (iiib) implies dom(A) = dom AD  = H, which is (2). Now (1) follows by varying A  SES with  > . Finally, we can extend (4.2) from H to H by density with respect to the graph norm of A.

Properties (iiib) and (iv) of the map  can also be extended to operators from the classes ES,  > 0.

Lemma 4.5. Let  > 0 and A  ES. Then dom(A) = H and for all unitary U  S0 U  A U   = U AU   holds on H.
Moreover, if A is self-adjoint on H, then A is self-adjoint.

(4.3)

Proof. Assume first that A  SES, so that AD  DES and AOD  S for some 0 <  < . According to Lemma 4.4(1, 2) we have that dom(A) = H  dom AOD  . Moreover, if A is self-adjoint, then AD  is self-adjoint on H and (AOD) is symmetric on H, as follows from properties (iv) and (i) of , respectively. Since dom AOD   H is the closure of H with respect to the graph norm of AOD , the operator AOD  is also symmetric on H. Moreover, by Lemma 4.4(3) it is infinitesimally A-bounded. Thus, [BS87, Theorem 4.1.9] implies that A = AD + AOD  is
self-adjoint on H. Let now A  ES. By definition, there exist H  SES and V  S0 unitary such that A = V HV
on H. Since  is a -homomorphism,

(A) = (V )(H )(V )

(4.4)

GAUGE TRANSFORM AND APPLICATIONS

23

holds on H. By Lemma 4.3 the operator V  is unitary, and property (iiic) implies that

V H = V  H = H.

(4.5)

We have already proved in Lemma 4.4(2) that dom H  = H, thus the argument at the end of the proof of Proposition 3.7 implies that V )H V  is closed on H. As by (4.4) and Lemma 4.3 this operator is an extension of (A), it follows that dom(A)  H. Similarly, we have on H that

(H ) = (V )(A)(V )

and V  A V   is a closed operator on V  dom(A)  H. Thus,

H = dom(H )  V  dom(A),

and (4.5) yields H  dom(A). Hence dom(A) = H. Finally, let U  S0 be unitary. Then

(U )(A)(U ) = (U AU )  (U AU ),

and U  A U   is a closed extension of (U )(A)(U ) on the domain H = dom (U AU ) , i.e. (4.3) holds. If A is self-adjoint on H, then so is H , thus H  by the first part of the proof. Hence, the self-adjointness of A follows from (4.3) with U = V and H instead of A.

4.2. The density of states measure. Since A is a factor of type I or II, there exists, by definition, a semi-finite faithful normal trace T on A, see [Dix81, I.6 and I.8.4]. Moreover, due to [Dix81, I.6.4, Corollary], this trace is unique up to multiplication by a positive number. Following the notation of [Nai72], we write LA to denote that L  H is a closed linear subspace adjoint to A, i.e. PL  A, where PL is the projection onto L. If LA, the relative dimension of L is defined by
D(L) := T(PL)  [0, ].
If A is a I-factor, the range of the relative dimension is cN0  {}, for some c > 0. It is [0, ] if A is a II-factor.
Definition 4.6. Let A  S0  ES be symmetric and J  R be a Borel measurable set. Denote by E J (A) the spectral projection of A for J . We define the density of states measure (DSM) of A on J , relative to the representation , by
N (J ; A) := T E J (A) = D E J (A)H .
Remark 4.7. Usually, the dependence on the representation  and the factor A is unambiguous and is thus not reflected in the notation.

The following corollary generalises [PS12, Lemma 4.4]. It follows directly from Lemma 4.5 (or Lemma 4.3 for A  S0) and the invariance of T under unitary transformations in A. We remark at

24

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

this point that, since SA, one has U   A for every unitary U  S0, see Lemma 4.3 and [Nai72, §35.1].

Corollary 4.8. Let U  S0 be unitary and let A  S0  ES be symmetric. Then one has N (J ; A) = N (J ;U AU ) for any Borel measurable set J  R.

In the remainder of this section, we investigate the behaviour of the DSM for elliptic operators

of positive order under perturbations. In [PS12, MPS14, PS16] such an analysis was conducted

for operators that are bounded from below and the particular case J = (-, ),   R.

Before continuing, let us introduce the following notation. For any interval J = [s, t ]  R, s < t

and   R, we define

  J := [s - , t + ]

for



<

s

- 2

t

,

otherwise.

The following lemma gives us a variational characterisation of the DSM (cf. [PS12, Lemma 4.1]).

Lemma 4.9. Let A  S0 ES be symmetric. Then, for any interval J = [q -r, q +r ] with q  R and

r > 0, we have

N (J ; A) = sup D(L) : L  dom(A), LA, and (A - q) H  r  H   L .

(4.6)

The analogous statement holds for the open interval J = (q -r, q +r ) with strict inequality in (4.6).

Remark 4.10. Usually, variational characterisations such as (4.6) are given in terms of quadratic forms rather than norms. The reason why we cannot do so is because we do not assume the operator A to be semi-bounded, J a semi-infinite interval. One can interpret Lemma 4.9 in terms of quadratic forms as usual for the nonnegative operator (A - q)2.

Proof. Choosing L := E J (A)H, we observe that N (J ; A) is at most the right hand side of (4.6).

Suppose that there exists a subspace L that satisfies the assumptions on the righthand side of

(4.6) and D(L) > D(E J (A)H). Then [Nai72, §37.1, Lemma] implies that L contains an element 

orthogonal to E J (A)H, implying that

(A - q)

2 H

>

r

2

 2H, which is a contradiction.

The following lemma generalises [PS12, Corollary 4.3] to operators that are not necessarily bounded below and unbounded perturbations.

Lemma 4.11. Let A  SES,  > 0, and B  S,  < , symmetric operators. Let J := [q -r, q +r ]  R be the interval of length 2r > 0 centred at q  R. Then there exists a constant C  0 depending only

GAUGE TRANSFORM AND APPLICATIONS

on A and  such that, for





B



:=

 J , A ,B

:=

 2

B

() 0

+

B

() 0

r+ q

+C

1+

B

() 0

 -

the inequality

N (J-; A)  N (J ; A + B )  N (J; A)

holds.

if   0, if  > 0,

25
(4.7) (4.8)

Proof. In view of Lemma 4.4(1,3) and property (i) of the representation , one has that (A +B ) = A + B  on dom(A)  dom(B ). Fix   L := E J (A + B ))H  dom (A + B ) = dom(A), so that

(A + B  - q)  r
H

 H.

We will show that

(A - q)

 (r + )
H



H

holds, which in view of (4.6) implies the second inequality in (4.8). Since

(4.9) (4.10)

(A - q)  (A + B  - q) + B 

H

H

H

r

 H+

B ,
H

it is sufficient to estimate B  H. For   0, Lemma 4.3 and Corollary 2.9 imply

(4.11)

B  B
H

 H= B

 H=  H,

and (4.10) follows from (4.9) and (4.11).

From now on, we consider  > 0. By assumption we can choose   (, ) such that AOD  S.

Let (, r )  EP(AD) with

r  max

4 1+

B

() 0



1/(-)
;

2

AOD

() 0

1/(-)

.



As   dom(A), Lemma 4.4(3) yields

B 

2
H

B

() 0

r --1

A + r  1 + -1
H

AD

() 0

H



B

() 0

2

(A - q) 1+

H + |q|

B

() 0



H
+C

1+

B

() 0

 -

H ,

(4.12)

26

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

where C is a constant only depending on A and . Combining (4.11) and (4.12), we get

2+

B

() 0

2 1+

B

() 0

(A - q)

H

r

+

2

B 1+

()

0

B

() 0

|q| +C

1+

B

() 0

 -

 H.

Hence, we arrive at (4.10) with  as in (4.7).

For the first inequality in (4.8) the only non-trivial case is   r . For all   E J- (A)H  dom(A) we have

This implies

(A - q)

 (r - )
H



H.

(A + B  - q)

 (r - )
H



H+

B

,
H

where in view of (4.12) and (4.7)

B


H

B 2+2

()

0

B

() 0

r+

q

+C

1+

B

() 0

 -

 H  H.

Thus, the first inequality in (4.8) follows and the lemma is proved.

The next lemma deals with perturbations that are `spectrally far' from a given interval. It is a generalisation of [MPS14, Lemma 11.1] for operators that are not necessarily bounded below.

Lemma 4.12. For  > 0,  <  let H0  DES, B  S, and A  S0 be symmetric operators and set H := H0 + B  SES. Suppose that there exists a family of orthogonal projections {Pl }Ll=0 with Pl  S-, 0  l  L - 1, and PL  S0 that all commute with H0 and satisfy

L
Pl = I , and A = AP0, Bn,l := PnB Pl = 0, for |n - l | > 1.
l =0

(4.13)

Moreover, let J = (q - r, q + r ) be an interval such that

Dl := dist J ,  (Pl H Pl ) > 0, for all 0  l < L.

(4.14)

Finally, assume that

3L r

 dL

:=

min
1l <L

D

l

and

max (
0l <L

B l ,l -1

+

B l ,l +1

)/Dl  1/4,

where we use the convention B0,-1 := 0.

Then for we have that



:=

32-

L 2

r

1/2
A

dL

N (J-; H )  N (J ; H + A)  N (J; H ).

(4.15) (4.16)
(4.17)

GAUGE TRANSFORM AND APPLICATIONS

27

Proof. We only prove the first inequality; the second inequality follows analogously. It suffices to show that for any   E J- (H )H  dom(H ) = H, one has

(H  + A - q)  r
H

 H.

For any K  N, we split the interval J- into 2K +1 subintervals of equal width: for -K  k  K -1,

set

Ik :=

q

+

(2k

-

1)

(r - ) 2K + 1

,

q

+

(2k

+

1)

(r - ) 2K + 1

and

IK :=

q

+

(2K

-

1)

(r - ) 2K + 1

,

q

+

r

-



.

For   E J- (H )H and -K  k  K define k := EIk (H )  H and

k := H k -

q

+

2k

(r - ) 2K + 1

k ,

(4.18)

so that holds. We also introduce

k

r H  (2K + 1)

k

H

(4.19)

kl := Plk and kl := Plk , for - K  k  K and 0  l  L.

For 0  l < L, we clearly have PlH  = (Pl H ) on H and, since Pl H  S0, this identity extends to H. Moreover, Pl commutes with H0 so that (4.13) implies that on H

Pl H  = (Pl H ) = (Pl H Pl ) + Bl,l-1 + Bl,l+1 = (Pl H Pl )Pl + Bl,l-1Pl-1 + Bl,l+1Pl+1,

where we use the convention P-1 := 0. Thus, applying Pl to (4.18), we arrive at

kl

=

B

 l ,l

-1

kl -1

+

(Pl H Pl ) -

q

+

2k

(r - ) 2K + 1

kl + Bl,l+1kl+1,

for 0  l < L, and Lemma 4.3 together with (4.14) and (4.19) gives for 0  l < L,

kl

H



D

-1 l

kl

+
H

B l ,l -1

kl -1

+
H

B l ,l +1

r  (2K + 1)dL

k +
H

kl -1

H+ 4

kl +1

H.

Recursively for 0  l < L we deduce that

kl+1 H

kl

2r H  (2K + 1)dL

k

1 H+3

kl +1

.
H

28

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Hence, employing the trivial bound kL H  k H, we get that

k0


H

(2K

3r + 1)dL

+ 3-L

k .
H

In view of Lemma 4.3, it follows that for all -K  k  K ,

Ak

=
H

( A P 0 ) k

H

= Ak0 H



(2K

3r + 1)dL

+

3-L

A

k ,
H

whence the Cauchy­Schwarz inequality and the Pythagorean theorem yield

A 

Ak

H -K kK

H



(2K

3r + 1)dL

+ 3-L

2K + 1 A  H .

We choose

K=

3L+1r 1 2dL - 2

+ 1,

so that

3L +1 r dL

 2K

+1

3L +2 r dL

.

Then, by (4.15), we have

(2K

3r + 1)dL

+ 3-L

2K

+

1



32-

L 2

r

1/2
.

dL

Consequently, we arrive at

(H  + A - q)  (H  - q) + A

H

H

H



(r

-

)

+

32-

L 2

r

1/2
A

dL

=r  H,

H

where we used that   E J- (H ) and the value of  given in (4.17).

5. GAUGE TRANSFORM

Let   R and A = Op(a)  SES be symmetric, thus extends to a self-adjoint linear operator on H by Proposition 3.7.

Definition 5.1. For every symmetric   S0, the unitary transformation of A into

is called a gauge transform.

[A] := [A] := exp(-i)A exp(i)

GAUGE TRANSFORM AND APPLICATIONS

29

We remark here that, due to Lemma 2.13 and Corollary 2.9, the series


exp(i) =
k =0

i k k!

(5.1)

converges both in S0 and in the operator norm. In particular, Lemma 2.3 implies that exp(i) 

S0, whence exp(i) is unitary and [A]  ES is symmetric. The following lemma provides an

expansion of [A] into a series of multiple commutators of A with , see (2.19) for the definition of adk .

Lemma 5.2. We have

[

A

]

=

 k =0

1 k!

adk

(

A

;

),

where the series converges absolutely in S.

Proof. Lemma 2.13 yields the bounds

j Am

()


l

Thus, the double series



(0) l

j

A

() l



(0) l +||

m,

for all l  0.

[A] =

 (-i)j j =0 j !

 (i)m

A
m=0

m!

=

 (-i)j j ,m=0 j !

(i)m A m!

converges absolutely in S. Recursively, we obtain

adk (A; )

=

k!

j +m=k

(-i) j j!

(i)m A m!

,

for all k  0.

(5.2)

In the remainder of this section, we look at gauge transforms that result in an operator [A] that is closer to a diagonal operator (i.e. an operator in DES) than A. More precisely, we construct  in such a way that the gauge transform removes as much of the off-diagonal part AOD from A as possible. Let  <  such that AOD  S. Then we aim at

[A] = AD + AR + R,

(5.3)

where AR  S is an off-diagonal resonant part (which our transformation cannot eliminate) and R  S for some  < . The exact form of the operators AR and R depends on the choice of .
As a first step towards (5.3), let us rewrite the series (5.2) as

[A] = AD + AOD + ad(AD ; ) + R,

(5.4)

30

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

with

R

:=

ad(AOD ; ) +

 k =2

1 k!

adk (A; ).

(5.5)

Suppose that   S with   R and let   R. In order to achieve that R  S for some  < , we

can use the following estimates:

(1) If  < 0, then by Lemma 2.15 we get ad(X ; )  S+ for all X  S. We call a gauge transform that only uses these trivial bounds on the commutator norms weak.
(2) Sometimes the structure of the commutators allows us to prove ad(X ; )  S+- for some  > 0 and appropriate X  S. A gauge transform exploiting this improvement shall be called strong.

As we will see, the main issue with the strong gauge transform is that some conditions under which it can be used may not be formally invariant under the use of the gauge transform, which is in general an iterative scheme. Furthermore, due to combinatorial issues it may be harder to verify that those conditions are still satisfied as the number of steps increase. However, as we will see, in many situations it is sufficient to make one step of the strong gauge transform, and proceed from there with the weak one.

5.1. The commutator equation. We recall that after the gauge transform we would like to arrive at the operator [A] as in (5.3), in the best possible case with AR = 0. Comparing (5.3) with (5.4) we obtain that AR = 0 is equivalent to the commutator equation

ad(AD ; ) + AOD = 0

(5.6)

for  = Op(). Let A = Op(a) and  be a frequency set for a. By (2.18), equation (5.6) is solved if  is a
frequency set for  and aD (  )() - ()aD () = iaOD ()
holds for all    :=  \ {id} and   . This leads to

 ()

=

iaOD () aD(  ) - aD ()

,

(5.7)

for    and   . However, the problem of small denominators aD(  ) - aD() for some pairs (, ) generally prevents such choice of . This motivates the following definition.

Definition 5.3. For   R, s > 0, and   G, we call a set ,s   a -resonant region generated by  for AD if it satisfies

,s     : aD (  ) - aD ()  s .

(5.8)

GAUGE TRANSFORM AND APPLICATIONS

31

A corresponding resonance cut-off is a function  := ,s : G ×   R, mapping (, )  ,s (), such that for all   G, we have

0    1,

,s () = 0, for all   ,s , -1 (  ) = (), for all   .

(5.9)

For a fixed resonance cut-off, we define the resonant part B R := Op(bR) and the non-resonant part B N R := Op(bN R) of any operator B = Op(b)  S via their symbols

bR := bOD(1 - ,s ), bN R := bOD,s .

(5.10)

Remark 5.4.

(i) For any   R and s > 0, the only -resonant region generated by id is id,s = . Hence, every

resonance cut-off  satisfies id  0.

(ii) If ,s satisfies

,-s1 =   ,s , for all   G,

then the resonance cut-off  can be chosen as

() := 1\,s (), for all (, )  G × .
(iii) If B OD  S,   R, then BOD = BNR +BR,

and

BNR

()


BOD

() ,

l

l

BR

()


BOD

()

l

l

hold for all l  0. If B is symmetric, then so are B D, B N R, and B R.

(5.11)

With the help of Definition 5.3, the problem of small denominators in (5.7) can be circum-

vented. Let   R, s > 0, and fix a resonance cut-off  corresponding to -resonant regions

,s ,   G, for AD. Using (5.10), we define

 

i aN R ()

,s

()

:=

aD 0

(



)

-

a

D

()

if   , otherwise.

(5.12)

Recall that AOD  S so that, in view of Remark 5.4(iii), AN R  S for some   .

32

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Lemma 5.5. Let    with AN R  S. Then (5.12) defines a symbol ,s  S-. The operator  := Op(,s ) is symmetric with



(-) l



1 s

AN R () , for all l  0.
l

(5.13)

It satisfies

ad(AD ; ) + AN R = 0.

(5.14)

Proof. The bounds (5.13) follow directly from (5.12) and (5.8)­(5.10). The equation (5.14) follows as in (5.6)­(5.7) with N R replacing O D.

In view of (5.14), (5.4) takes the form

[A] = AD + AR + R,

(5.15)

with R defined in (5.5).

5.2. Weak gauge transform. Let    such that AN R  S, AOD  S. We choose  > , so that  -  < 0 in Lemma 5.5. Note that  determines the size of the resonant regions and thus the efficiency of the gauge transform.

Lemma 5.6. Let  = Op(,s ) be the operator defined in (5.12) and R be as in (5.5). Then ad(AOD ; ), R  S+- are symmetric and, for all l  0,

ad(AOD ; )

(+-) 2 

AOD

()

AN R () ,

l

s

l +|-|

l +||

(5.16)

and

R

(+-) l



3 s

AO D () l +|-|

AN R ()

exp 2

l +||+|-|

s

AN R ()

.

l +||+|-|

(5.17)

Proof. The estimates (2.20) and (2.21) together with  >  and Lemma 5.5 imply that, for all k  N,

adk (AOD ; )

(+-)
2
l

adk-1(AOD ; )

()
l +|-|



(-)
l +||

2k 
s



(0)
l +||+|-|

k -1

AOD

()
l +|-|

AN R

() . l +||

Thus, (5.16) follows by choosing k = 1. Moreover, (5.13) implies that for all k  N,

adk (AOD ; )

(+-)


2

AN R ()

k AO D ()

.

l

s

l +||+|-|

l +|-|

Similarly, we get from (5.14) that for all k  2,

adk (AD ; )

(+-)
=

l



adk-1(AN R ; ) (+-)
l

2 AN R ()

k -1

s

l +||+|-|

AN R

()

.

l +|-|

(5.18) (5.19)

GAUGE TRANSFORM AND APPLICATIONS

33

Hence, the bounds (5.17) follow from (5.5), (5.18), (5.19), and (5.11).

Lemmata 5.5 and 5.6 have the following immediate corollary, which follows by choosing  =  and applying (5.11).

Corollary 5.7. Let  = Op(,s ) be the operator defined in (5.12) and R be as in (5.5). Assume that  > . Then   S- is symmetric with



(-) l



1 s

AOD

() , for all l  0.
l

Moreover, ad(AOD ; ), R  S2- are symmetric and for all l  0,

ad(AOD ; )

(2-) 2 

AO D ()

2,

l

s

l +||+|-|

and

R

(2-) l



3 s

AO D ()

2 exp 2 AO D ()

.

l +||+|-|

s

l +||+|-|

As a consequence of Lemma 5.6 we have arrived at (5.3) with R  S+- and  +  -  <  as desired. One may now iterate the gauge transform to further reduce the order of the error term, starting from [A] in the next step. We call such an iterative scheme consecutive gauge transform. A few remarks on this iterative scheme are in order.

Remark 5.8. (i) At each step of the consecutive gauge transform, the resonant regions can be chosen differently.
(ii) Let us consider a consecutive gauge transform consisting of k steps, starting with the operator A0 := A, and transforming into the operator

A j := exp(-ij )A j -1 exp(ij ) = . . . [A]1 2 . . . j

at step j = 1, 2, . . . , k. Moreover, suppose for simplicity that  >  and that ,s ,   G, are

-resonant

regions

for

all

A

D j

,

j

=

0, 1, . . . k - 1,

simultaneously

(so

that

the

resonant

cut-

off  = ,s can be chosen Corollary 5.7 imply that

at

all steps

as

() = 1\,s (),

(, )  G × ).

Then

(5.15)

and

A1 := [A]1 = AD0 + AR0 + R1 with R1  S2-. Repeating the procedure, we obtain

with R j  S+ j (-).

Aj

=

A

D j -1

+

A

R j -1

+

Rj

,

j = 1, 2, . . . , k,

34

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

(iii) A disadvantage of the consecutive gauge transform lies in the fact that already the operator

A1 = [A]1 may have a frequency set as large as

where

Z () := n,
nN
n :=  · . . . ·  .

(5.20)

product taken n times
This set Z () is usually infinite, even when  is finite. Thus, the same holds for AR1 , which arises after the second step of gauge transform. This might be inconvenient since one gen-

erally likes to keep the structure of the resonant operators as simple as possible. However,

one

can

resolve

this

issue

by

excluding

the

terms

belonging

to

S+ j (-)

from

A

N j

R

at

the

j th step (by moving them to the remainder). Then j +1 will be the frequency set for ARj .

In the next sub-section, we describe a different iterative gauge transform scheme that we call the parallel gauge transform. This is often more convenient to work with than the consecutive gauge transform.

5.3. Parallel weak gauge transform. Here, we perform several steps of the gauge transform at

the same time, i.e.

A(k) = [A](k) ,

where

k
(k) = j
j =1

for some k  N. Fix again   R, s > 0 and a resonant cut-off ,s satisfying (5.9) corresponding
to -resonant regions ,s ,   G, for AD, see Definition 5.3. Following [PS12, Section 9], the operators l , Bl , and Tl are recursively defined by

B1 := AOD ,

Bl

:

=

l -1 j =1

1 j!

ad(AOD ; k1 , k2 , . . . , k j
k1+k2+···+k j =l -1

),

l



2,

and the relations

Tl

:

=

l j =2

1 j!

k1+k2+···+k j =l

ad(AD ; k1 , k2 , . . . , k j

),

l



2,

ad(AD , 1) +

B

N 1

R

=

0,

ad(AD , l ) + BlN R + TlN R = 0, l  2.

(5.21)

GAUGE TRANSFORM AND APPLICATIONS

35

More precisely, let  be a frequency set for A and for all l  1, let bl and tl be the symbols of Bl

and Tl , respectively. Analogously to (5.12), we solve (5.21) by choosing l := Op(l ) with

 

i (b1N R )()

(1)

()

:=

aD 0

(



)

-

a

D

()

if   , otherwise

and

 

i(blN

R

)

()

+

i(tlN

R

)

()

(l )() := 0 aD(  ) - aD ()

if   (l ), otherwise

for l  2. Note that for all l  1, l is a frequency set for Bl , Tl , and l . Finally, put

and with

k

k

Yk : = Bl + Tl ,

l =1

l =2

Rk+1 := Bk+1 + Rk(1+)1 + Rk(2+)1,

Rk(1+)1

:

=

j k+1

1 j!

adj (A; (k)),

Rk(2+)1

:

=

k j =1

1 j!

ad(A; k1 , k2 , . . . , kj
k1+k2+···+k j k+1

).

Then we arrive at

A (k )

=

AD

+

YD
k

+

YR
k

+

Rk+1,

(5.22)

see

Lemma

5.2,

where

YR
k

is

an

operator

with

frequency

set

k .

The

following

Proposition

pro-

vides norm estimates for the operators after the parallel gauge transform. In particular, it shows

that if  > , then we can assure that the error term Rk belongs to classes of arbitrarily small order by choosing k sufficiently large.

Proposition 5.9. Let AOD  S with  > . Then we have for all l  0,

k

(k l

(-))



Bk

(k l

(-)+)

+

Tk

(k (-)+) l



AO D () k , k  1
l +nk
AOD () k , k  2,
l +nk

(5.23)

where nk is an increasing function of k, depending on k,  and , and the implied constants depend only on k, , , and s in (5.8). Moreover, the operators (k)  S-, Yk  S, Rk+1  Sk(-)+

36

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

are symmetric and satisfy the bounds

(k )

(-) l

+

Yk

() l



1+

AOD

() l +nk

k,

Rk+1

(k l

(-)+)



C

A,k,,,l

,

for all l  0, where the implied constants only depend on k, , , and s; and C A,k,,,l is a bounded

function of the symbol norms

AOD

() l

, k, , , and l .
l 0

Proof. The bounds (5.23) are easily deduced from Corollary 5.7 by induction in k, estimating all

involved commutators using (2.20). The estimates on the symbol norms of (k) and Yk follow

readily.

Let us prove the estimates on the norms of Rk+1. Starting with Rk(1+)1 we note that, for m  k +1

and  := (k)

adm (A; )

(k (-)+) l



adm(AD ; )

(k (-)+)
+

adm (AO D ; ) (k(-)+)

l

l

=

adm-1(Y N R ; )

(k (-)+)
+

adm (AO D ; ) (k(-)+)

k

l

l

 2m-k-1 adk (Y N R ; ) (k(-)+)

k

l



(0) l +|k(-)+|

m-k-1

+ 2m-k adk (AO D ; ) (k(-)+)
l



(0) l +|k(-)+|

m-k ,

where we apply (2.21) in the second inequality. Dividing by m! and summing over m  k + 1 we

obtain a convergent sum, for which we use the estimates on the norms of Yk and (k). Estimating

Rk(2+)1

(k(-)+) is somewhat easier since there are no convergence issues.
l

This finishes the

proof of the proposition.

5.4. Strong gauge transform. The aim of any (iterative) gauge transform scheme is to force the error term R after the gauge transform, see e.g. (5.3) or (5.22), into a class of (relatively) small order. For instance, in (5.4) and (5.5), we aim at R  S for some  < . If  belongs to a class of negative order, as is the case if one can choose  >  in Definition 5.3, for example, it can be trivially satisfied for some  < , as was seen to be the case with the weak gauge transform. In some cases, however, one can not guarantee more than   S0, whether it be by choosing  = , or by introducing additional cut-offs in the definition of . This is notably the case for Schrödinger-type operators, whenever the perturbation is not in S for  <  - 1. In such a case, one can no longer rely on the trivial product estimates for ad(AOD, ) to get that ad(AOD, )  S

GAUGE TRANSFORM AND APPLICATIONS

37

for some  < . In the next lemma, we give a sufficient condition that, nevertheless, yields the required improvement through commuting with .

Lemma 5.10. Suppose that A  ES and that   S0 is defined as in (5.12). If both ad(AOD; )  S and ad(AN R; )  S, then, with

[A] = exp(-i )A exp(i ),

we have that

R := [A] - AD - AR  S.

Remark 5.11. If, in addition to the assumptions of this lemma, we have AOD  S, this would mean that commuting with  has improved order and we can therefore call this gauge transform strong. Note that we do not require improvements in order to happen at every iteration of the commutator, but only at the first step.

Proof. It follows from Lemma 5.2 and equation (5.14) that

R

=

k

1

1 k!

adk

(

AO

D

;

)

+

k

2

1 k!

adk

(

AD

,

)

=

k

1

1 k!

adk -1 (ad(

AO

D

;

);

)

+

k

2

1 k!

adk

-1(ad(

A

N

R

;

),

).

As in the proof of Lemma 5.2, both series converge absolutely in S.

Remark 5.12. The hypotheses of the previous lemma can be achieved in many ways. The most common one does not depend on the operator A, but only on the algebraic structure of S: it is when commutators naturally improve order. The principal example is pseudo-differential operators in L2(Rd ) that are almost periodic with respect to the translation group Rd . To obtain the commutator estimates in this case one requires some limited smoothness in . We refer to [Sob05, Lemma 3.4] for a proof, and [Sob06, PS10, PS12, MPS14, PS16] for examples of further applications. In all of these cases, the smooth structure of functions on Rd was used, and the resonance cut-off functions were taken to be smooth approximations to indicator functions of the non-resonant regions rather the indicators themselves.
It is also possible that one cannot reach   S0 through only non-resonant cut-offs. In such a case, in order to achieve convergence of the series for exp(i ) and [A] achieved in (5.1) and Lemma 5.2 we will need energy cut-offs, i.e. cutting off large . See [PS10, MPS14] where this idea is being used.

38

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

6. SYSTEMS OF ALMOST PERIODIC OPERATORS
In this section, we provide a construction suitable to describe almost periodic operators with matrix-valued symbols within the framework of Sections 2 ­ 5.

6.1. Symbol formalism for systems of almost periodic operators. Let the index set  and the
group G be as in Section 2. Let m  N and b : G ×   L (Cm) be a function such that there exists a countable frequency set  = -1  G with b() = 0 for all   G \  and   . Furthermore, assume that
b() 2 < , for all   ,

where · is the operator norm on L (Cm). For every   , let v j () : j  Z/mZ be an orthonormal basis for Cm so that ev j () ,j Z/mZ is an orthonormal basis for 2(; Cm ) = 2()Cm . In analogy to (2.12), an almost periodic operator B in 2(; Cm) with symbol b is defined by

B e  v j () := e  b()v j () .

We introduce the index set m :=  × Z/mZ equipped with the weight function
(, j )m := 
and define the group Gm := G × Z/mZ, and its (free) action on m by
(g , k)  (, j ) := (g  , k + j ).

(6.1) (6.2) (6.3)

Applying the unitary map Tm : 2(m )  2(; Cm ) defined by Tm e(,j ) := e  v j (), (, j )  m ,
we can relate the operator B to the operator

(6.4)

B := Tm BTm

(6.5)

in 2(m). For every g  G and   , let bg () be the matrix representation of bg () : Cm 
Cm with respect to the pair of bases v j () j and v j (g  ) j on the domain and codomain, respectively, i.e.

bg ()v j () =

bg () k j vk (g  ),

k Z/m Z

Define the scalar symbol b : Gm × m  C by

for all j  Z/mZ.

b(g ,k)(, j ) := bg () k+j j

(6.6) (6.7)

GAUGE TRANSFORM AND APPLICATIONS

39

for (g , k)  Gm and (, j )  m, and note that  × Z/mZ is a frequency set for b. In view of (2.12), (6.3), and (6.7), we have

Op(b)e(,j ) =

[b()]k j e(,k), for (, j )  m .

(,k )×Z/m Z

(6.8)

Hence, (6.1), (6.4), (6.5), (6.6), and (6.8) yield Tm BTm = B = Op(b). This justifies calling the operators from S(Gm, m) systems of almost periodic operators, also known as matrix-valued oper-
ators. We shall use the notation

Tm := T(Gm, m ), T  {S, DS, DES, SES, ES},   R  {±} ,

(6.9)

and Hm := H(m ),   R  {±} .

Since the map of symbols b  b is one-to-one, for those b which are mapped to b  S m we write Op(b) := Op(b). We use this identification to apply the results of Sections 2­5 without

always making explicit the conjugation by the operators Tm. Note that (g , k)m = g , for all (g , k)  Gm, see (2.2) and (6.2). Hence, for b  Sm, we have the equivalence of norms,

c-m1

b

() l



l sup-

b ()

 cm

b

() l

,





(6.10)

where the constant cm > 0 only depends on m. Two sub-algebras of S m will be of particular interest in the sequel: uncoupled operators and diagonal operators.

Definition 6.1. The uncoupled operators in Sm,   R  {±}, are defined by

USm := B  Sm : the matrix bg () , see (6.6),is diagonal for all g  G,   

= B  Sm : the frequency set for b can bechosen as a subset of G × {0} .

For any operator A = Op(a)  Sm,   R  {±}, we define the symbol



aUg ()

kj

:=

 ag 0

()

kj

if k = j , if k = j

for all g  G,   , k, j  Z/mZ.

We write AU := Op(aU ) for the projection of A onto USm which we call the uncoupled part. We also denote AC := A - AU its coupled part. It can easily be seen that if A  Sm,   R then for all

l 0

AU

()

l

A

() l

,

AC

()

l

A

() l

(6.11)

and that if A is symmetric so are AU and AC .

40

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

The second sub-algebra is DS m , see (6.9) and Definition 3.1. Noting that idGm = (idG , 0), we infer from (6.7) that

DS m = B  US m : bg () = 0 for all g  G \ {idG } ,
so that DS m  US m  S m . As in the scalar case, for any operator A = Op(a)  Sm ,   R{±}, we denote by

AD := Op(aD )



aUg ()

kj

:=

 ag 0

()

kj

if k = j and g = id otherwise.

and AOD = A - AD. This definition makes it so that AD = Tm AD Tm . Similarly, if resonant and non-resonant regions are defined in terms of m , we set AR = Tm ARTm and AN R = Tm AN RTm . We can also combine notions of coupling and resonance; we set for instance AR,U = (AR)U , and
proceed similarly for other combinations of the indices.
The following lemma is useful when changing the reference orthonormal basis of Cm. Nevertheless, for the rest of this section the reference basis of 2(; Cm) will remain fixed as {e  v j ()}(, j )m .

Lemma 6.2. Assume that, for every   , the set u j () : j  Z/mZ is an orthonormal basis for Cm. Then the unitary operator

U : 2(; Cm )  2(; Cm ), satisfies Tm UTm  S0m .

e  v j ()  e  u j ()

(6.12)

Proof. It is clear from (6.12) that Tm UTm = Op(u) where ug ()  U(m) is unitary for all g  G,  
, and {idG } is a frequency set for u. Thus the equivalence of norms (6.10) implies that Tm UTm  S0m .

The previous lemma has the following corollary, justifying our terminology of uncoupled operators.

Corollary 6.3. Let v j : j  Z/mZ be a fixed basis for Cm. Then any operator A  US m is unitarily

equivalent to an orthogonal sum

A j where for every j  Z/mZ, A j acts in 2()span v j .

j Z/mZ

6.2. Gauge transform in S m : the reduction to uncoupled operators. We would like to apply a weak gauge transform to an operator in the class SES m -- cf. (6.9) -- in order to obtain an operator of the same ordrer with an uncoupled principal symbol. In this section, we give two sufficient
conditions that allow us to do this. The first one is more restrictive on the off-diagonal part and

GAUGE TRANSFORM AND APPLICATIONS

41

gives a non-trivial remainder, but allows for a principal symbol with multiple eigenvalue. The second one requires the principal symbol to have only simple eigenvalues, in which case the procedure is more efficient and the restrictions on the off-diagonal symbol are much milder.

Theorem 6.4. Let A = Op(a)  SESm be symmetric and let  <  be such that AC := Op(aC )  Sm. Assume that
aid () =  diag(a1(), . . . , am())

and that  is a frequency set for aOD. Here, for j  Z/mZ, a j :   R are bounded functions such

that for all   Z () =

 k =1

k

,

lim


a

j (  ) a j ()

=

1.

(6.13)

Suppose finally that there exists C , c > 0 such that for every j  Z/mZ and k  Z/mZ \ {0}, either

inf a j () - a j +k ()  c > 0,
>C
or aO D ] j , j +k  S2-.
Then, for all  > 0 and N  N there exists a symmetric operator   Sm- such that

(6.14) (6.15)

[A] = exp(-i )A exp(i ) = AD + Y + R1 + R2

(6.16)

where Y  USm, R1  S2-, R2 HmH0m <  and Y, R1, R2 are symmetric. If A is quasi-periodic, one can choose R2 = 0.

Remark 6.5. The conditions (6.14) and (6.13) are satisfied in the simple case of constant func-

tions a j () = a j  R \ {0}.

Proof. Fix  > 0. We first eliminate the long-range coupling. Since

AO D

() 0

<

,

there

exists

a

finite subset   , closed under inversion and containing the identity, such that

Let B := Op(b) with the symbol

sup- aO D () < .
\ 



b

()

:=

aO 0

D

()

if   , otherwise.

(6.17)

For R := AOD - B, (6.10) implies

R

() 0

<

cm

,

(6.18)

and we write A := AD + B so that A = A + R and AD = AD. For every j  Z/mZ, define the set

I j := {k  Z/mZ : (6.14) holds} .

42

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Finiteness of  and bounded range of action imply that

lim sup    - 1 = 0.   

Combining this with (6.13) and (6.14), as well as boundedness of the functions a j implies the existence of s depending on  and the constants c,C in (6.14) such that

inf inf
j Z/mZ kI j

inf inf
 >s

a j +k(  )   - a j ()

>

c 2

.

Thus, for (g , k)  Gm, the sets



(g,c,k/)2

:=

 (, j m ,

)



m

:

min

, g  

 s

,

if g   and k  I j , otherwise

are -resonant regions for the operator A = Tm ATm, cf. (5.8), and we choose the corresponding (scalar) resonance cut-off function

(g ,k)(, j ) := 1m \(g,c,k/)2(, j ),
see Remark 5.4(ii). Thus, taking  as in Lemma 5.5, we have that  = TmTm  Sm-. In view of (5.15), we deduce that
[A] = exp(-i )A exp(i ) = AD + AR + R, where Corollary 5.7 and conjugation by Tm give R  S2m-. We turn our attention to AR. We decompose it as AR = AR,U + AR,C . By definition of the resonant region (g,c,k/)2, we have that
[aR,C ] j , j +k = [aO D,C ] j , j +k if k  I j

and supp([aR,C ]j,j +k)     : min    s if k  I j .

By (6.15), for every k  I j we have [aR,C ]j,j +k  S2-. Finiteness of  and bounded range of action imply that the support of [aR,C ]j,j +k is bounded for k  I j . Together, along with Proposition 2.16, this gives AR,C  S2m-.
All of this implies

[A] = AD + AR,U + AR,C + R + exp(-i )R exp(i ).

(6.19)

We claim that this has the desired form (6.16) with

Y = AR,U , R1 = AR,C + R, and R2 = exp(-i )R exp(i ).

(6.20)

GAUGE TRANSFORM AND APPLICATIONS

43

Indeed, it follows from (5.11) and (6.11) that AR,U  USm. We have that AR,C , R  S2m- so that
their sum R1 also is. Finally, recall that exp(i )  S0m by Corollary 2.7. In particular, we have

exp(i )

(0) ||





k =0



(0) ||

k!

k
,

where by Corollary 5.7 and conjugation with Tm we have



(0) ||





(-) ||



4 c

B

() ||



4 c

AO D

() ,
||

with c the constant in (6.14). Consequently,

exp(i )

(0) ||

is

bounded

uniformly

in





0.

Hence,

for any  > 0, choosing

0 <  <

 exp(i)

(0) ||

2, cm

we obtain by Lemma 2.8 and (6.18) that

R2 Hm H0m  

exp(i ) H0mH0m R HmH0m

R

() 0

exp(i )

(0) ||

2
< .

exp(i ) HmHm

This finishes the proof.

Theorem 6.6. Let A = Op(a)  SESm be symmetric and let  <  such that AOD := Op(aOD )  Sm with frequency set   G. Assume that

aid() =  diag(a1(), . . . , am())

for some bounded functions a j :   R. Moreover, suppose that there exist C , c > 0 such that

inf min |a j () - ak ()|  c > 0,
>C j =k

(6.21)

and that, for all j = 1, 2, . . . , m, and   Z () =  k ,
k =1

lim


a

j (  ) a j ()

=

1.

Then, for all  > 0 and N  N there exists a symmetric operator   Sm- such that

[A] = exp(i )A exp(i ) = AD + YU + R1 + R2

with Y  Sm, R1  S-mN , R2 HmH0m <  , and Y, R1, R2 symmetric. If AOD is quasi-periodic, then one can choose R2 = 0.

44

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Proof. The proof essentially follows the scheme of the proof of Theorem 6.4. We first eliminate long-range coupling and find B  Sm and R such that A = AD + B + R and

R

() 0

<

.

Assumption (6.21) leads this time to -resonant regions



(g,c,k/)2

=

 (, j m ,

)



m

:

min

, g  

 s

,

if k = 0, if k = 0

(6.22)

for some s depending on . Put

K

:=

N +. -

We apply a parallel weak gauge transform according to (5.22). We have from Proposition 5.9 and

conjugating by Tm that there exists symmetric operators   Sm-, Y  Sm and R  S-mN such that

[A] = exp(-i )A exp(i ) = AD + YD + YR + R

and



(-)
||



1+

AO D

()

K
.

nK

(6.23)

where the implicit constant depends only on c and K . Inequality (6.23) implies that

exp(i )

(0)
||

is uniformly bounded as   0.

With the resonant region as in (6.22), for every Y  Sm,  <  we have that YD + YR = YU + RY,

where the symbol of RY has bounded support, implying RY  S-m. We put R1 = R + RY  S-mN and

R2 = exp(-i )R exp(i ) gives us

R2 HmH0m  

exp(i )

(||)
0

2
.

Therefore for any  > 0 by choosing 0 <  < 

exp(i )

(||)
0

-2
we obtain

[A] = AD + YU + R1 + R2

with the claimed properties.

PART II : APPLICATIONS TO ASYMPTOTIC PROPERTIES OF SYSTEMS
In this second part, we consider some specific examples where the methods and results developed in the first half are applicable. As was mentioned earlier, these methods work very well for operators
H = H0 + B

GAUGE TRANSFORM AND APPLICATIONS

45

of Schrödinger type acting on L2(Rd ). Here, H0 = (-)/2 and B is a pseudo-differential perturbation of order  < . In particulars, the gauge transform method allows us to solve the following two types of problems, see [BP09, MPS14, Par08, PS16, PS12, PS10, Sob06] :

· obtain a complete asymptotic expansion for the integrated density of states of almost periodic operators, as the spectral parameter goes to infinity;
· Prove that some elliptic periodic operators have the Bethe­Sommerfeld property, which asserts that the spectrum of such operators contains a half-line [; ) for some   R.

We now consider these questions in the setting of elliptic systems of operators. We establish answers to both of these problems in the case where symbols are periodic, for the BetheSommerfeld property, and almost periodic, for the integrated density of states. We will do so by using the tools developed in Part I of this paper to reduce these operators to uncoupled operators. We will show that such a reduction cannot change the integrated density of states too much, and we will show that it cannot open infinitely many gaps in the spectrum. Since elliptic systems of operators do not have to be semi-bounded, we will obtain these results as the spectral parameter goes to ±. In order to do this, we will establish quantitative estimates based upon the results of Sections 4, 5 and 6 under generic assumptions about the perturbations.
In Section 7, we describe the Besicovitch space of almost periodic functions, and the operators acting on it. We also describe the structure of operators that are periodic rather than simply almost periodic, interpreting the Floquet-Bloch decomposition through the lens of almost periodic functions.
In Section 7.2, we describe the approach and the conditions required to prove the existence of complete asymptotics for the integrated density of states (IDS), and we state Theorem 8.2, which describes the asymptotic behaviour of the IDS for elliptic systems of operators. We reduce the problem to obtaining asymptotics for the IDS in families of intervals, which is the statement of Theorem 8.5.
In Section 8, we prove Theorem 8.5 by showing that it holds for uncoupled operators. We then use the gauge transform to show that it is sufficient to obtain a complete asymptotic expansion for uncoupled operators to get one for general systems.
In Section 10, we change perspective and we study periodic operators. In Theorem 10.1, we give conditions under which elliptic systems of periodic operators enjoy the Bethe­Sommerfeld property. We then use the reduction to uncoupled operators and bounds for the density of states obtained in Section 8 to show that it is sufficient to prove that the spectral overlap function is sufficiently bounded away from 0 for uncoupled operators. This will be done by reusing the results of Section 4, but interpreting fibrewise eigenvalue counting functions as instances of the IDS.

46

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

We prove those lower bounds in Section 11 by refining arguments based on combinatorial geometry that were previously used in proving the Bethe-Sommerfeld conjecture for Schrödingertype operators.
Finally in Section 12, we spend a few words to show that periodic and almost periodic perturbations of the Dirac operator fit in the framework that we have described in this part.

7. BESICOVITCH SPACE AND SYSTEMS OF OPERATORS

In this section, we turn back to the space B2(Rd ; Cm) of almost periodic vector-valued functions, corresponding to the case where G =  = Rd and

g1g2 := g1 + g2, g   := g + ,
for all g1, g2,   Rd . The weight function is  = 1+||. From (2.2) we also get that g = 1+ g and that G has bounded range of action. The case m = 1 corresponds to the usual Besicovitch space. We now offer a concrete description of this space, along with a few results relating the properties of operators acting on L2 and B2. These results can be found in [CMS73, Shu78, Shu79b].
Let {v1, . . . , vm} be an orthonormal basis for Cm and for 1  j  m let
e,j (x) := exp(i  · x)  v j ,
The space B2(Rd ; Cm) is the closure of

span e,j :   Rd , j = 1, . . . , m ,

taken with respect to the inner product

(

f

,

g

)B

=

lim
L

1 (2L)d

f · g¯ dx.
[-L,L]d

For the remainder of this article, we will use S m , DS m , etc. to refer to the spaces of almost periodic operators acting on B2(Rd ; Cm). Let A be an operator in Sm with symbol a(x, ). The action of A in L2(Rd ; Cm as an operator in the Hörmander class (Rd ; Cm) with almost periodic symbol

is defined through the usual Fourier integral representation of pseudo-differential operators (see

e.g. [Hör07]) as

Op(a)

f

(x)

=

1 (2)d

exp(i  · (x - y))a(x, ) f (y) dy d.
Rd ×Rd

The following proposition links its properties as an operator in L2 and B2, respectively.

Proposition 7.1. If A  S m is bounded or elliptic, then

specB2(A) = specL2(A) as a set. In particular, if A is bounded, its norm in L2 and B2 coincide.

GAUGE TRANSFORM AND APPLICATIONS

47

The proof of this proposition is exactly the same as the one in [Shu78] for the case m = 1. Indeed, it relies on some facts about function approximation proven in [Shu78, Lemmata 4.1 and 4.2] which remain true as m > 1 since they apply coordinatewise. Boundedness or ellipticity then implies Proposition 7.1. When we refer to the norm of an operator, we will not distinguish whether that operator is acting in L2(Rd ; Cm) or B2(Rd ; Cm) since those norms are the same.
As mentioned in Remark 4.2, there is a faithful, norm-preserving -representation A  A of almost periodic operators given by A := a(x + y, Dy) acting in
Hm := B2(Rd )  L2(Rd )  Cm .
Here x is a variable of functions in B2(Rd ; Cm) and y is a variable of functions in L2(Rd ; Cm). The operator A is interpreted as a direct integral over x of operators acting in L2(Rd ; Cm). We denote by e J (x, y) the Schwartz kernel of the spectral projection E J (A). Note that in view of Proposition 7.1 and [CMS73], if A  B as operators, then A  B and A = A .
Finally, the operator A is affiliated to the II factor A generated by the two families of operators
e  e  M :   Rd , M  Mm and I  T  M :   Rd , M  Mm ,
where e is the operator of multiplication by ei·x, T is the operator of translation T f (x) = f (x- ) and Mm is the algebra of m × m matrices with complex entries. This means that the results of Section 4­6 on the density of states measure (DSM) also called the integrated density of states (IDS) apply to this algebra of operators and this representation.
In the classical setting, the IDS is defined for differential operators using the large box limit and for pseudo-differential operators as the trace of the Schwartz kernel

N (J ; A) = Mx(tr e J (x, x)),
where M is the almost periodic mean. Note that this kernel is actually a smooth integral kernel whenever J is a bounded interval, see [PS16].
Our terminology for the IDS is justified in [Shu79b, Remark 3.1], where it is shown that the IDS as defined in Section 4 is the same as the one obtained from the classical definition for either differential or pseudo-differential operators.

7.1. Concrete systems of operators. From now on, we turn our attention to almost periodic pseudo-differential operators whose principal symbol is diagonal and nondegenerate.
Definition 7.2. A uncoupleable operator is an operator A  ESm for which there exists an unitary operator U  S0m so that UAU = A0 + B  SESm has the following properties.

48

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

· The principal part A0  DESm, with symbol

a0() = diag a1 || , . . . , am || ,

(7.1)

with a j = 0 and without loss of generality a1  . . .  am. We set m+ = max j : a j > 0, where
by convention m+ = 0 if a1 < 0. · The subprincipal part B  Sm for  <  and has frequency set . We also suppose that B
is formally self-adjoint, i.e. that its symbol satisfies

b() = b-( + ), for all   D and   , where for a matrix a, a is its conjugate transpose. If a j = ak for j = k, we say that A is a competely uncoupleable operator.

Remark 7.3. Since we are interested only in spectral properties of elliptic operators, for the remainder of this paper we can always assume that the operators are already in SESm.

Without loss of generality, we assume that the frequency set  spans Rd , contains 0, and is symmetric about 0. Recall from (5.20) that, using sum rather than product notations for the group of shifts in Rd , that we also put

k =  + . . . + ,

where the sum is taken k times, and Z () = k
k N
The set Z () is countable and non-discrete, unless  generates a lattice.

(7.2)

7.2. Conditions on the perturbation and its frequency set. In this section, we state the exact conditions under which we can obtain asymptotics for the integrated density of states for a system of operators acting in B2(Rd ; Cm). We also show how we can reduce the problem to computing the IDS solely on some intervals contained in a large enough range of energies.
We are interested in the asymptotics for the positive energy and negative energy integrated densities of states for a uncoupleable operator A = A0 + B, defined as
N +() := N +(; A) := N ([0, ); A),
and N -() := N -(; A) := N ((-, 0]; A),
as   . For this, we will need some conditions on the frequency set of the perturbation B. In Section 8, we reduce the operator A to a direct sum of operators of the type appearing in [MPS14]. In that paper, the perturbations are required to satisfy some conditions, which we

GAUGE TRANSFORM AND APPLICATIONS

49

describe for completeness. Conditions I and IV correspond to Conditions A and C in [MPS14] and we do not use them explicitly. Condition II addresses [MPS14, equation 2.4], while Condition III addresses [MPS14, Condition B]. We refer the reader to [MPS14], as well as [PS12] for a more detailed discussion around these conditions and their genericity.
We first need the following generic condition on the set Z () defined in (7.2).

Condition I. Suppose that 1, . . . , d  Z (). Then, Z ({1, . . . , d }) is discrete.
This condition is clearly satisfied for periodic B, but for quasi-periodic or almost periodic B it is meaningful. The next two conditions describe how well B is approximated by finite sums of homogeneous functions of , and by quasi-periodic operators.

Condition II. There exists a constant C0 > 1 and a discrete subset J  (-, ] such that for all

  Rd and ||  C0,

(1 - 1C0 ())b() = || b()
J

 ||

,

where b()  S0m is positively homogeneous of degree 0. We also suppose that for   Sd-1, b()() has a series representation (written in multi-index notation)

b()() =

b(,n)n,

nNd0

which converges absolutely in a ball of radius greater than one of Rd .

If B is quasi-periodic and J0 is finite, these are the only conditions that we need. Otherwise, we need to find a quasi-periodic approximation of B. In view of (6.17), such an approximation will always exist, but we need a quantitative version of it.

Condition III. For every k  N, there exists Ck > C0 such that for each  > Ck , there exists a finite symmetric   (  B(1/k )) and a finite subset Jk  (-, ] with
#Jk  1/k

such that the symbol
satisfies, for all   N, for some c,k > 0.



r(k

)()

:=

b() b()

-

Jk || b()

 ||

if   , if   ,

r(k )

() 



c,k

-k

,

(7.3) (7.4)

50

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Finally, we need a Diophantine condition on the frequencies of B , for which we need some definitions. Fix k  N (which will depend on the order of the remainder in the asymptotic expansion, but not on k as in Condition III). We say that V is a quasi-lattice subspace of dimension q if there are linearly independent 1, . . . , q  k such that V = span(1, . . . , q ). We denote by V the collection of all quasi-lattice subspaces. For U, V  V , we write (U, V)  [0, /2] to denote the angle between them, that is the angle between U  (U  V) and V  (U  V), where for a subspace W  V, V  W is the orthogonal complement of W in V. This angle is non-zero if and only if U and V are strongly distinct, i.e. if neither of them is a subspace of the other. Recalling that for any k the choice of  depends on , we put

as well as

R() = sup || ,
k

r () = inf || ,
(k )

s := s() = s(k ) := infsin((U, V)),

where the infimum is over all strongly distinct pairs of subspaces in V . It is clear that

R() = O 1/k ,

(7.5)

where the implicit constant might depend on k and k; however, we need the following condition for r and s.

Condition IV. For each fixed k and k, the sets  can be chosen in such way that for sufficiently large , depending on k and k, the number of elements of k satisfies #k  1/k and we have that
s()  -1/k
and r ()  -1/k.

Remark 7.4. Condition IV is automatically satisfied for quasi-periodic and smooth periodic B. See [PS12] for further discussion of this condition.

8. ASYMPTOTIC EXPANSIONS FOR THE IDS
We now suppose that the perturbation B satisfies Conditions I­IV and we set  = 1/, where  is the order of A0. We prove the two following theorems, depending on whether all the a j in (7.1) are distinct or not. Recall that m+ = max j : a j > 0 , with m+ = 0 if a j < 0 for all j .
Theorem 8.1. Let A be a uncoupleable operator with subprincipal part B  Sm,   /2 satisfying Conditions I­IV. Suppose that there exists   0 such that whenever a j = ak for some 1  j = k  m,

GAUGE TRANSFORM AND APPLICATIONS

51

then [B]j,k  S and put  = max(2 - , ). Then, there exists a discrete set L  (0, 1 - ) and

constants

C

± 0

and

C

± q,

j

,

0



q



d

- 1,

j



L

such

that

N ± A;  = C0±d +

d -1

C

± j ,q

d

-

j

logq

()

+

O

 d -1+

,

j L q=0

(8.1)

as   .

If m+ = m (resp.

if

m+

=

0),

then

C0-

=

C

- j ,q

=

0

(resp.

C

+ 0

=

C

+ j ,q

=

0)

except

for

( j , q) = (d , 0).

Theorem 8.2. Let A be a competely uncoupleable operator satisfying Conditions I­IV. Then, for

every

K



R

there

exists

a

discrete

set

L



(0, d

+K

)

and

constants

C

0±,

C

± q,

j

,

0



q



d

- 1,

j



L,

such

that

d -1

N ± A;  = C0±d +

C

± j ,q

d

-

j

logq

()

+

O

-K

,

j L q=0

(8.2)

as   .

If m+ = m (resp.

if

m+

=

0),

then

C0-

=

C

- j ,q

=

0

(resp.

C

+ 0

=

C

+ j ,q

=

0)

except

for

( j , q) = (d , 0).

Remark 8.3. Note that the statement for m+  {0, m} follows from the operator being semibounded either above or below, respectively.
Note as well that if J  Z, i.e. if the symbol of A is a classical symbol, see [Tay11, Chapter 7], then L = {0, . . . , K + d - 1}.
The set L of allowable exponents can be made explicit, depending on J and K , see [MPS14, Remark 2.7].

The proof of Theorems 8.1 and 8.2 are obtained after many reductions to simpler cases. Recall that they are the general versions of Theorems 1.1 and 1.2 in the introduction.

8.1. IDS for uncoupled operators. In this subsection, we prove that the conclusion of Theorem 8.2 holds in the special case where A  USm, regardless of whether an operator is uncoupleable or competely uncoupleable. This means that in addition of satisfying the conditions of Section 7.2, its symbol is given by
a(x, ) = a0() + b(x, ),
where b(x, ) is a diagonal matrix.

Proposition 8.4. Let A  USm be an uncoupleable operator satisfying conditions I­IV. Then, for

every

K



R

there

exists

a

discrete

set

L



(0, d

+K

)

and

constants

C

0±,

C

± q,

j

,

0



q



d

- 1,

j



L,

such

that

d -1

N±

A; 

=

C0±d

+

j

L

C
q=0

± j ,q

d

-

j

logq

()

+

O

-K

,

52

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

as   .

If m+ = m (resp.

if

m+

=

0),

then

C0-

=

C

- j ,q

=

0

(resp.

C0+

=

C

+ j ,q

=

0)

except

for

( j , q) = (d , 0).

Proof. Since A  USm, it can be split as a direct sum of operators A1  . . .  Am acting in the mutually orthogonal subspaces B2(Rd )  v j . As such, we have that on any interval J ,

m
N (J ; A) = N (J ; A j ).
j =1

This means that, for j  m+, A j is semi-bounded below and acts invariantly on B2(Rd )v j as the operator considered in [MPS14]. For j > m+, it is the operator -Aj that acts in such a way. From [MPS14, Theorem 2.5], this means that N ((-, ); Aj ) (resp. N ((, ); Aj )) enjoys an asymptotic expansion of the form (8.2) for 1  j  m+ (resp. m+ < j  m). Observe that we have

m+

m+

N + ; A = N ((-, ); A j ) - N ((-, 0]; A j )

j =1

j =1

m

+

N ((0, ); A j ).

j =m++1

The terms in the first sum have the required asymptotic expansion. The terms in the second sum do not depend on , hence they might only change the constant term in (8.2). Finally, the operators in the third sum are semi-bounded above, hence for  large enough the terms are constant and once again only affect the constant term. This proves the existence of the asymptotic expansion (8.2) for N +. The proof for N - is the same, interchanging the role of the semi-bounded below and above operators.

8.2. Reduction to a finite interval. The strategy in this subsection is an adaptation of the one found in [MPS14, PS12]. It consists in showing that an asymptotic expansion holds in overlapping dyadic intervals In.
For K > -d , we choose 0 sufficiently large, to be fixed later. For every n  N, we put n := 2n-1 = 2n0. We also define the intervals In := n-1, n+1 . We prove the following theorem, which implies Theorems 8.1 and 8.2 as a corollary.

Theorem 8.5. Let A be an operator satisfying the conditions of either Theorem 8.1 or 8.2. Then, for

either K = -d + 1 -  in the former case or any K  R in the latter, there exists 0 large enough, a

discrete

set

L



(0, d

+K

)

and

constants

C

0±,

C

± j ,q

for

every

j



L

and

0



q



d

-1

such

that

for

every

GAUGE TRANSFORM AND APPLICATIONS

n  N and every 0 < µ <  with µ,   In,

N ((µ, ); A) = C0+(d - µd )+

d -1

+

C

+ j ,q

d-j logq () - µd-j logq (µ)

+O



-K n

,

j L q=0

where the implicit constants might depend on K , but not on n. Similarly,

N ((-, -µ); A) = C0-(d - µd )+

d -1

+

C

- j ,q

d-j logq () - µd-j logq (µ)

+O

 -n K

.

j L q=0

53
(8.3)

Remark 8.6. The reader familiar with previous works on the integrated density of states for almost periodic operators can notice that the roles of the dyadic decomposition in intervals In is slightly different here. In previous work, this decomposition was necessary because the resonant zones were significantly different for different spectral intervals were different. This yielded coefficients C ± depending possibly on n. It was however shown that the asymptotics had to match if the coefficients didn't grow too fast.
In our case, we need this decomposition in order to apply Theorem 8.9 when the perturbation is unbounded. Indeed, it relies on Lemma 4.12 which can only be applied for some interval with control on how far away the endpoints can be. We will therefore obtain asymptotics when both endpoints belong to a specific dyadic interval, then glue the intervals together. We end up comparing the density of states with the one obtained in [MPS14] for operators acting on scalar functions, i.e. the case m = 1. In such a case, the dependence on n of the coefficients has already been removed.

Proof of Theorems 8.1 and 8.2 assuming Theorem 8.5. We prove the theorem for N +, the proof for

N - is the same. For K  R, suppose that 0 is large enough for Theorem 8.5 to hold. Suppose without loss of generality that for all n, n is a point of continuity of N +. For   In, we have that

n-1

N +() = N +(0 ) +

N

((

j -1,



 j

);

A)

+

N

((n-1

,



);

A)

j =1

= N +(0 ) +

d -1

C

+ j ,q

d-j logq () - d0 -j logq (0)

+

n

Sj,

j L q=0

j =1

where S j = O -j K . This implies that

n

n

Sj





-K 0

2-K

j





-K n



-K

j =1

j =1

54

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

since   In. One can see that the term depending on 0 is O (1), so that it can be included either in the error term O -K when K  0 or in the constant term in (8.2) and (8.1) otherwise.

8.3. Reduction to a quasiperiodic operator. We now show in the following lemma that it is sufficient to prove Theorem 8.5 for quasiperiodic operators.

Lemma 8.7. Let A  SESm be an uncoupleable operator with subprincipal part B  Sm satisfying

Condition III and k  2. There exists 0 > 0 and 0 < c0 < 1 so that for every n  N there exists a

quasi-periodic

uncoupleable

operator

A



SESm

with

frequency

set





B

(

1/k n

)

such

that

· A - A  Sm;

· supp(aOD )  || > c0n ;

· there is   n-k such that for all J  In,

N ((±J )-; A)  N (±J ; A)  N ((±J ); A).

(8.4)

Proof. For k  N let     B(1n/k ) be the frequency set given by Condition III with  = n, and

R  Sm be the operator with symbol given in (7.3), which by (7.4) satisfies

R

() 0





-k n

.

Setting

A = A - R we have that A - A  Sm , and that  is a frequency set for A and that as long as 0 is

large enough,

A

() 0



2

A

() 0

(8.5)

for all     .

Writing

any

interval

J



±I

 n

in

the

form

[M

-

r,

M

+r

],

it

is

easy

to

see

that

|M| +

r



(2n ).

Put 0 = max , 0 . By Lemma 4.11, estimate (8.4) holds with A instead of A and

1

=

R

(0) 0

2+

R

(0) 0

instead of . Let us now define

|M | + r +C (1 +

R

) (0)
0

 -0

 n-k

A = A - AO D Pc0n = (A)D + AO D (1 - Pc0n ),

where 0 < c0 < 1 is to be determined later. By (8.5) and (3.1)

A

() 0



4

A

() 0

for all     . We apply Lemma 4.12 with

H0 = (A)D , By Proposition 2.16,

B = AO D (1 - Pc0n ),

A = AO D Pc0n ,

AO D Pc0n

 (c0n)0

AO D (0) .
0

H = A.

GAUGE TRANSFORM AND APPLICATIONS

55

Set X = (2 -  + k + 0) log3 n, and let Zl := c0n + l 2n/3,

0  l  X - 1,

(8.6)

so that if 0 is large enough, ZX -1  2c0n. For 0  l  X introduce the family of projections



P Z0

for l = 0,

Pl

:=

1P

Zl
-

- PZl P ZX -1

-1

for 0 < l < X , for l = X .

We now verify that the conditions of Lemma 4.12 are satisfied. It is clear that BPc0n PZ0 = B Pc0n , and relations (4.13) follow from (7.5) and (8.6) as long as k  2 and 0 is large enough. By Proposition 2.16, for 0  l < X ,

Pl APl



Z

 X -1

A

() 0



4(2c0n

)

A

() 0

.

(8.7)

We also have that

Pl AO D Pl-1

+

Pl AO D Pl+1

 2ZX-1

A

(0 ) 0



4(2c0n

)0

A

(0) 0

(8.8)

For 0  l < X , set

Dl = dist(J , spec(Pl APl )).

By (8.7) and Lemma 4.3 for l  X - 1

spec((Pl APl )) 

-4(2c0  n )

A

() 0

,

4(2c0



n

)

A

() 0

,

so that setting c0- = 2+3

A

() 0

gives

Dl





 n

2

,

in particular (4.14) holds. Combining with (8.8) we have that

max
0l <X

Pl AO D Pl-1 + Pl AO D Pl+1 Dl

so that for 0 large enough, (4.16) is satisfied. Since the conditions of Lemma 4.12 are satisfied, for



2(2c0)



- n

A

(0 0

)

,

2 = 32-X

AO D Pc0n



2

-k n

A

(0 0

)

,

we have that and

N I-1-2 ; A  N (I-1; A)  N (I ; A); N (I+1+2 ; A)  N (I+1; A)  N (I ; A).

56

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Our claim therefore holds with  = 1 + 2.

8.4. Reduction to uncoupled operators. In this subsection, we show that it is sufficient to prove Theorem 8.5 for quasi-periodic operators, it is sufficient to do so for uncoupled operators. At the end of the section, we finally prove Theorem 8.5 after all those reductions, which completes the proof of Theorems 8.1 and 8.2.

Theorem 8.8. Let A be an operator satisfying the conditions of Theorem 8.1. Then, for every n  N

there

is

an

operator

A



USm

and







 n

such

that

for

all

µ, 



In

and

I

=

(µ, ),

N (±I-; A)  N (±I ; A)  N (±I; A).

(8.9)

In particular,

N (±I ; A) = N (±I ; A) + O



d n

-1+

.

(8.10)

Proof. We only prove this theorem for I , the proof for -I follows from the same argument, mak-

ing the relevant sign changes. By Proposition 8.4, we see that (8.10) follows from (8.9). We there-

fore only prove the latter.

We keep a quantitative track of the estimates found in Section 6.2. By Lemma 8.7, we can

without loss of generality assume for some fixed C0 > 0 that A is a quasi-periodic operator whose

frequency

set



lies

in

the

ball

B

(

1/k n

)

for

some

k



N

and

such

that

the

support

of

aO D

lies

in

|| > C0n . In particular, we can assume that there is s > 0 such that for all   supp(aOD ), all

   and all j , k such that a j = ak ,

a j | + | - ak || > s || .

By Theorem 6.4, since A is quasi-periodic there are symmetric operators Y  USm, R  Sm and   Sm- such that A is unitarily equivalent through conjugation with exp(i ) to

A + R = AD + Y + R.

Here, the symbol of  is given by

[ ()] j ,k

=

i [bC ()] j ,k j ,k a j | + | - ak ||

,

where j,k = 1 if a j = ak and 0 otherwise. Using the fact that

ad(A; ) = ad(AOD ; ) + ad(AD ; ) = ad(AOD ; ) - AN R,

the operator R is obtained from equations (6.19), (6.20) with R = 0, and (5.5) by

R

= BR,C


+ ad(AOD ; ) +
k =2

1 k!


adk (AOD ; ) -
k =2

1 k!

adk-1(AN R ; ).

(8.11)

GAUGE TRANSFORM AND APPLICATIONS

57

By Lemma 4.11, N (I-; A)  N (I ; A + R)  N (I; A)
for  = R . Since  has order  -  and is supported on || > c , by Corollary 2.9 and Lemma 2.13 we have as in Proposition 2.16 that

ad(AOD ; )





2- n

AO D

() 0



(-)
||

,

so this gives the contribution from the second term in (8.11). The third and fourth terms uses the

same estimate and the fact that this sum is absolutely convergent. Finally, for the first term we supposed that BR,C  Sm, and it is also supported on || > c so that by Proposition 2.16,

BR,C  n.

Together, this completes the proof.

When a j = ak whenever j = k, we get the following stronger statement.

Theorem 8.9. Let A be an operator satisfying the hypotheses of Theorem 8.2. There is a decreasing sequence K K N, K  - such that for all K , n  N there is an operator AK  USm and some   -n-d-K such that for all µ,   In, and I = (µ, ),
N (I-; AK )  N (I ; A)  N (I; AK )

and such that if K1 < K2, then In particular,

AK1  AK2 mod SmK1 .

N (±I ; A) = N (±I ; AK ) + O



-K n

.

Proof. This statement is proven in the same way as the previous one, replacing the use of Theorem 6.4 with the parallel gauge transform Theorem 6.6, with a number of steps depending on K . This is possible because the condition on the terms coupling a j = ak for j = k is vacuously verified, so that it is assuredly preserved after each step of gauge transform. This yields a remainder R  S-mN for any N , allowing for the arbitrary precision in the approximation for the density of states.

Remark 8.10. Note that after this reduction, Conditions II and III, corresponding to [MPS14, Equation 2.4 and Condition B], do not hold anymore. However, the reason why these conditions are needed is to have a specific form for the functions b1(+2) 1, 2  , see [MPS14, Equation 10.5]. This expansion still holds if these conditions are imposed on the symbol prior to reduction to uncoupled operators.

58

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Proof of Theorem 8.5. By Theorems 8.8 and 8.9, there is 0 large enough so that for any n there is an operator AK  USm such that for µ,   In,
N ((µ, ); A) = N ((µ, ); AK ) + O -nK ,

where K = 1 - d -  if A satisfies the hypotheses of Theorem 8.1 and K  R if A satisfies the

hypotheses

of

Theorem

8.2.

Equation

(8.3)

(with

coefficients

C

± j ,q

depending

on

n)

then

follows

by Proposition 8.4 for AK and the fact that

N ((µ, ); AK ) = N +(; AK ) - N +(µ; AK ).

(8.12)

In order to remove the dependence on n of the coefficients, it is sufficient for every K  N to

prove that they must agree for all n large enough. Since the coefficients obtained in Proposition

8.2 do not depend on n, this means that as soon as µ,   In  In+1, (8.12) gives the same coeffi-

cients

for

the

asymptotic

expansion

up

to

terms

of

order



-K n

,

which

means

that

the

coefficients

need to agree for all n large enough.

9. THE STRUCTURE OF PERIODIC OPERATORS
We now turn our attention to periodic operators. In this section, we describe the structure of operators that are periodic with respect to some lattice , and we give a quantitative approach to the study of the Bethe­Sommerfeld property. We realise the usual Bloch­Floquet decomposition through Besicovitch spaces.

9.1. Description of periodic operators. For periodic operators we assume that G is not Rd but rather the dual lattice  :=   Rd . We note that in this case Z () = .
Invariance of A under the action of  means that for all k  Rd , the subspace

2k(; Cm ) := span e,j : 1  j  m,    + k  B2(Rd ; Cm)

(9.1)

is an invariant subspace for A, and we denote by A(k) the restriction of A to this subspace. It is clear from the definition that we can restrict ourselves to k  O = Rd /, and we call k a quasimomentum. For any   Rd , its fractional part {}  O is the image of  under the quotient map. The spectrum of A can be obtained as

spec(A) = spec(A(k)),
kO
see [Kuc93, Theorem 4.5.1]. For every k  O the spectrum of A(k) in 2k(; Cm) is discrete. The usual approach to studying the L2(Rd ; Cm) theory of periodic operators is through the
Floquet-Bloch decomposition, see e.g. [Kuc93], where we represent A as a direct integral over

GAUGE TRANSFORM AND APPLICATIONS

59

O of the fibre operators A(k). This would require us to introduce a considerable amount of machinery. However, the Bethe-Sommerfeld property is strictly about the spectrum as a set, and to every elliptic periodic operator acting in L2(Rd ; Cm) there corresponds an elliptic operator acting in B2(Rd ; Cm) with the same spectrum. We therefore consider periodic operators as operators on Besicovitch space where we decompose them according to the invariant subspaces (9.1). This makes our statements and proofs more direct.

Remark 9.1. The subspaces 2k(; Cm) can be realised as
H0( + k; Cm ) = span e+k,j ,   , 1  j  m .
The group G is  acting on  + k by translation. In this case, consider the I factor A generated by {e  M :   , M  Mm} .
It is clear that the restriction of the subalgebra of periodic operators to 2k(; Cm) is affiliated to A, and that it respects the conditions described at the beginning of Section 4. The associated trace of the spectral projection over an interval J is simply N (J ; A(k)) := # j : j (A(k))  J , the number of eigenvalues of A(k) in that interval.
We also make the observation that for a bounded, periodic self-adjoint operator , the restriction to 2k(; Cm) of the unitary operator exp(i ) is still unitary, since 2k(; Cm) is an invariant subspace. This means that we can simultaneously use the gauge transform on each of the fibre operators and that the estimates from Section 4 hold uniformly for the counting function of the fibre operators.

Let us now describe the structure of the spectrum of A in terms of the spectra of the fibre operators A(k). Since A is self-adjoint, it has Fredholm index 0, this implies that the Bloch variety
(k, )  O × R :   spec(A(k))
is a principal analytic set [Kuc93, Corollary 3.1.6 and Section 3.4.C]. As such, if A is semi-bounded below, we can naturally label the eigenvalues of A(k) in non-decreasing order, counting multiplicity. Then, the functions j (k) := j (A(k)) are piecewise analytic functions of k. If A is not semi-bounded, we can label the eigenvalues in non-decreasing order by j  Z and it is possible to choose the labelling so that the functions j (k) are piecewise analytic. This requirement determines the labelling uniquely up to a uniform shift of the indices. Note that continuity in k of the functions j and discreteness of the spectrum imply that labelling the eigenvalues at one quasimomentum k induces a labelling everywhere in O . The interval
j := j (A) := j (A(k))
kO 
is called the j th spectral band of A.

60

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

9.2. The overlap function. In order to prove that an operator has the Bethe-Sommerfeld prop-

erty we study the band overlap, characterized by the overlap function (; A),   R, introduced

by M. Skriganov [Skr85]. The overlap function is defined as the maximal number t such that the

symmetric interval [ - t ,  + t ] is entirely contained in one band, i.e.



(;

A)

:=

max 0

j

max

t  0 : [ - t ,  + t ]  j

if   spec(A) if   spec(A).

(9.2)

It is not hard to see that  is a continuous function of . In order to use our machinery we will re-

late the overlap function to the eigenvalue counting functions of the operators A(k). This type of

idea has been used in the past but crucially relied on the fact that A was semi-bounded below. In

the following proposition we find an equivalent formulation that is robust under perturbations

yet works for operators that are not semi-bounded. Recall that for an interval I = [s, t ]  R and

  R, we define

  I := [s - , t + ]

for



<

s-t 2

,

otherwise.

Lemma 9.2. Suppose that A1, A2 are self-adjoint periodic operators. Suppose that for all p  {1, 2}, k  O , Ap (k) has discrete spectrum. For   R and t > 0, let

 = min max dist(µ; spec(A1(k))) : µ  [ - t ,  + t ] .
kO

(9.3)

Suppose that there is 0    /4 such that for all k  O and any interval I  [ - t ,  + t ]

N (I ; A2(k))  N (I; A1(k)) and N (I ; A1(k))  N (I; A2(k)).

(9.4)

Then, for p  {1, 2} there exist sets of consecutive integers Jp  Z and surjective maps

(Ap (k)) : Jp  spec(Ap (k))

such that for all j  Jp , j (Ap (k)) are continuous in k and such that

j (A1(k)) - j (A2(k))  

(9.5)

for all k and j such that j (Ap (k))  [ - t ,  + t ].

Remark 9.3. We do not ask in the previous lemma that both operators share the properties of being either bounded, semi-bounded above or below, or unbounded in both directions.

Proof. For any k  O , 0 <   , we say that µ  [ - t ,  + t ] is -distant (from the spectrum of A1(k)) at k if
dist(µ, spec(A1(k)))  .

GAUGE TRANSFORM AND APPLICATIONS

61

By (9.3), for every k  O  there exists µ  [ - t ,  + t ] which is -distant at k. By the second inequality in (9.4), if µ is -distant at k for some  > /4, then for p  {1, 2}

(µ - , µ + )  spec(Ap (k)) = .

(9.6)

Choose k0  O and µ0 a point -distant at k0. Maps j  j (Ap (k)) can be uniquely defined from the properties that they are nondecreasing, mapping to continuous functions in k, and
that 0(Ap (k0)) is the smallest eigenvalue larger than µ0. Note that the sets J1 and J2 are both defined uniquely from these properties, in particular if Ap is unbounded both above and below then Jp = Z.
We now prove that, for all k  O , if µ is /2-distant at k, then for all j  J1  J2, then

j (A1(k)) - µ j (A2(k)) - µ > 0,

(9.7)

in other words, for p  {1, 2}, j (Ap (k)) are both on the same side of µ. The functions j (Ap (k)) were constructed specifically so that (9.7) holds at k0 and µ0, our goal is to show that this property propagates to other µ and k.
We first prove that if (9.7) holds for some µ /2-distant at k, then it holds for all other  /2distant at k. This is a direct consequence of (9.4) and (9.6), which imply that

N [µ, ]; A1(k) = N [µ, ]; A2(k) .

By continuity, for every k  O there is sk > 0 so that whenever µ is -distant at k, µ is also /2distant at every k  B(k, sk). This also implies that if (9.7) holds at k for one of those µ, it also holds for that µ at every k  B(k, sk), and therefore at every  /2-distant at k.
By compactness of O , there are k1, . . . , k such that O is covered by the balls U j = B(kj , skj /2), with 0  j  . If U j  U j  = , we have that kj   B(kj , skj ), so that if (9.7) holds for some µ -distant at kj then it also holds for all  /2-distant at kj , and therefore also at any k  U j  . By connectedness of O , this means that (9.7) only needs to be verified for some kj , 0  j   and one µ /2-distant at kj . Choosing k0 and µ0, this means that (9.7) holds everywhere.
Suppose now that for some p  {1, 2} there is some j  Jp and k  O such that j (Ap (k))  [ - t ,  + t ] and
j (A1(k)) - j (A2(k)) > .
Let µ be -distant at k. Without loss of generality assume that [µ, )  spec(Ap ) =  and let
j  = min  : (Ap )(k) > µ .
Supposing that j  j , and using (9.6) we obtain

N µ, j (A2(k)) ; A2(k)  j + 1 - j  > N µ, j (A2(k))  ; A1(k) ,

62

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

which contradicts the second inequality in (9.4). Similarly, supposing that j (A2(k))-j (A1(k)) >  contradicts the first inequality in (9.4). The case j < j  is treated analogously. We can therefore deduce that (9.5) holds at every k  O .

The previous lemma admits the following corollary in the situation where the difference A1 - A2 is a bounded operator. The reader interested solely in this case might notice that the proofs of the statement could have been more direct on its own.

Corollary 9.4. Let A = A0 + B be a self-adjoint unbounded periodic operator such that A(k) has discrete spectrum for all k  O and such that B is bounded. Then, there exist labelings j (A0(k)) and j (A(k)) of the eigenvalues of the fibre operators such that the functions j (A0(·)) and j (A(·))
are both continuous on O and such that for every k  O

j (A0(k) - j (A(k))  B .

Proof. It suffices to observe that B(k)  B for all k  O . Defining the continuous family of operators At = A0 + t B, it is easy to see that A1 = A and At - As = |t - s| B . From Lemma 4.11, we know that for all I  R, (9.4) holds for As , At with  = |t - s| B . It is also clear that  defined in (9.3) is continuous in the parameter t . Setting

N=

B min0t 1 t

,

and applying recursively Lemma 9.2 to the operators Aj /N and A(j +1)/N , with 0  j < N yields the

result we seek.

The previous lemma and corollary provide us with an explicit way to compare the overlap function. This is made precise in the following proposition.

Proposition 9.5. Suppose that A1, A2 are self-adjoint, periodic operators such that for all p  {1, 2}, k  O Ap (k) has discrete spectrum. Suppose that for  > 0 there is a non-decreasing labelling of their eigenvalues so that whenever j (Ap (k))  [ - 4(; A1),  + 4(; A1)] we have

j (A1(k)) - j (A2(k))  .

(9.8)

Then,

(; A2)  (; A1) - 2.

Proof. If 2 > (; A1), the result follows trivially from nonnegativity of the overlap function. Otherwise, choose j  Z such that

[ - (; A1),  + (; A1)]  j (A1).

GAUGE TRANSFORM AND APPLICATIONS

63

Then (9.8) implies [ - (; A1) + ,  + (; A1) - ]  j (A1)-  j (A2).
The claim then follows from inspection of the definition (9.2) of the overlap function.

10. SYSTEMS OF PERIODIC OPERATORS ­ THE BETHE-SOMMERFELD PROPERTY

In this section we prove that certain systems of periodic operators enjoy the Bethe-Sommerfeld property in a quantitative way. This will imply that the spectrum of an elliptic periodic operator A in some classes contains a half-line. Our proof is again based on a reduction of the problem to uncoupled operators.
It is clear that if we show that the overlap function (9.2) is bounded away from 0 at sufficiently large  for some operator A, then A has the Bethe­Sommerfeld property. This is the strategy employed in [PS10], where the self-adjoint operators of the form

A = (-) + B,

with B  S,  < 2, and B is -periodic are studied. It is shown in [PS10] that there are S, c and 0, depending only on  and the symbol norms of B , such that for all   0, (; H )  cS. However, unlike in the situation of Proposition 8.4, it is no longer possible to simply extend the result to uncoupled operators, i.e. direct sums of operators acting on scalar functions. While it is certainly true that such operators enjoy the Bethe­Sommerfeld property, it could be possible a priori that the overlap function does not stay bounded away from 0 when direct sums are taken. This would imply that the reduction to uncoupled operators would be able to open gaps. Our aim is to show that such a situation is impossible for our class of operators.

10.1. The Bethe-Sommerfeld property. Our main theorem concerning systems of periodic operators is the following.

Theorem 10.1. Suppose that A  ESm,  > 0 is periodic, self-adjoint competely uncoupleable operator with AD of the form (7.1) and a j = ak whenever j = k. Then, there exist positive , S, c such that
(1) if A is unbounded above, [, )  spec(A) and for every   , (; A)  c-S; (2) if A is unbounded below, (-, -]  spec(A) and for every   , (-; A)  c-S.
The overlap exponent S depends only on  and the dimension d . The parameters  and c can be chosen uniformly in the symbol norms of A and AOD.

Remark 10.2. Saying that the parameters are chosen uniformly in the symbol norms means that

if A and A are operators satisfying the conditions of Theorem 10.1 and for all s, ,

and

AO D

(s 

)



AO D

(s) 

then

the

parameters

obtained

for

A

also

work

for

A.

A

(s) 



A

(s) 

64

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Let us first observe that, as was the case in Sections 7.2 and 8, it is sufficient to prove case (1), case (2) will then follow from the former applied to the operator -A.
To prove Theorem 10.1, we proceed in two steps. The first one is the following proposition, the proof of which is delayed until Section 11.

Proposition 10.3. Let A  USm  ESm,  > 0 be periodic, essentially self-adjoint, with AD of the form (7.1). Then, there exist , S, c > 0 such that
(1) if A is unbounded above, the interval [, )  spec(A) and for every   , (; A)  c-S; (2) if A is unbounded below, the interval (-, -]  spec(A) and for every   , (-; A) 
c -S .
The overlap exponent S depends only on  and d . The parameters  and c can be chosen uniformly in the symbol norms of A and AOD.

The second step on the way to proving Theorem 10.1 is to show that small perturbations of an operator (in the sense of perturbations that do not change the integrated density of states much) cannot open a gap if the overlap function is large enough.

Lemma 10.4. Suppose that A  ESm satisfies the hypotheses of Theorem 10.1. Then, for every K  R, there exists an operator AK  USm  SESm satisfying the hypothesis of Proposition 10.3 such
that for every  large enough, we have that

(; A)  (; AK ) + O -K .

(10.1)

Proof. From Remark 9.1 and Theorem 8.9, it is possible for any K to find an operator AK  USm such that for  = --K and any interval I  [ - 2(; A),  + 2(; A)] we have that for every
k  O,

N (I ; A(k))  N (I; AK (k)) and N (I ; AK (k))  N (I; A(k)).

(10.2)

As in (9.3), put

 = min max dist(µ; spec(A(k))) : µ  [ - 2(; A),  + 2(; A)]
kO
(; A)  C maxk N ([ - 2(; A),  + 2(; A)]; A(k))
for some C > 0. By Lemma 9.2 and Proposition 9.5, if  < /4, then (10.2) implies (10.1). It follows from Proposition 10.3 that (; A)  -S for some S. Weyl's law implies that

max N ([ - 2(; A),  + 2(; A)]; A(k)) = O d/ .
k

It

follows

that

by

choosing

K

>

S

+

d 

,

we

have



<

/4

for



large

enough,

finishing

the

proof.

GAUGE TRANSFORM AND APPLICATIONS

65

Before making our constructions explicit in the next section, we prove the following lemma which indicates that for uncoupled operators, we may suppose without loss of generality that they are semi-bounded below.

Lemma 10.5. Let A  USm  SESm is self-adjoint and periodic, and suppose that
A = A+  A-
with A+ semi-bounded below and A- semi-bounded above. Then, Theorem 10.1, part (1) holds for A if and only if it holds for A+. Similarly, Theorem 10.1, part (2) holds if and only if it holds for A-.

Proof. We prove it for the implication of Theorem 10.1 part (1), the other one follows by replacing A by -A. Since A- is semi-bounded above, there is some M > 0 such that spec(A-)  (M , ) = . It therefore follows that for  > M ,
spec(A+)  [, ) = spec(A)  [, )
and our claim follows.

11. BETHE­SOMMERFELD FOR UNCOUPLED OPERATORS
In this section we prove Proposition 10.3. Remark 9.1, Lemmas 9.2 and 10.5; and Theorem 8.9 tell us that it is sufficient to prove Proposition 10.3 after a few simplifying assumptions. First, from now on we assume that A  USm  SESm is semi-bounded below, in other words a j > 0 for all 1  j  m. Then, we also suppose that we have already applied the gauge transform in each component, and that we have removed the remainder that changes the IDS by O -K for some large K . In other words, we suppose that the symbol of A is given by
a(x, ) = aD () + bR(x, ),
where we have abused notation and used the same symbol for A and the operator after gauge transform.
The study of the Bethe-Sommerfeld property in high dimensions [BP09, Par08, PS10] relies on variations of a certain combinatorial geometric argument. The strategy goes as follows, using the notation from [PS10]. First, find a function g : Rd  spec(A) such that on fibres of the quotient map Rd  Rd /, g is a bijection onto spec(A(k)). Such a function can be chosen in such a way that
g () - || = o || .
The goal is then to show that for any large energy  the pre-image of some small interval [ - ,  +] contains a curve connecting g -1(-) and g -1(+), and that g is continuous along

66

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

that curve. Here,  is a parameter that depends on  and corresponds to the overlap length at energy level .
In order to show that such a curve exists we split the pre-image g -1([ - ,  + ]) into bad (resonant) and good (non-resonant) regions. The latter are defined in such a way that g is continuous and radially increasing within them. The idea in [BP09, Par08, PS10] was to find a small radial interval in the non-resonant region where the eigenvalues of A(k) are all simple along that small interval, which in turn gives a lower bound for the overlap function.
This is done by showing that not only is the angular measure of the resonant region small, but that the total measure of intersections of translates of the resonant regions by elements of  with the non-resonant region is also small, in comparison to the volume of the non-resonant region. This implies the existence of a radial interval along which translations by    stay inside the non-resonant region, which gives us the desired interval where the eigenvalues of A(k) are simple and increasing.
In the case of an operator A  USm acting in L2(Rd ; Cm), hoping for the eigenvalues of A(k) to be simple is unrealistic. However, such a requirement is not necessary. Indeed, suppose that the eigenvalues of operator H acting in L2(Rd ; C) are simple. Then, since the spectrum of H  H is the same as for H , H  H enjoys the Bethe­Sommerfeld property if and only if it H also does. However, the eigenvalues of (H  H )(k) are always at least double. This means that we need a new way of reasoning. We obtain the following conditions, which are sufficient to obtain lower bounds on the overlap function.

Proposition 11.1. Suppose that there is an interval [k1, k2]  O  and three families of real-valued continuous functions µ,  and  on [k1, k2], satisfying the following properties.

· The equality of multisets (i.e. taking multiplicity into account) p (A(k)); p  N = µ(k) : µ  µ  {(k) :   }   {(k) :   }
holds for all k  [k1, k2]. · For every µ  µ, µ is increasing as k goes from k1 to k2. Furthermore, either
µ(k1) <  -  or µ(k2) >  + .

(11.1) (11.2)

· We have that # < . Furthermore,

# µ  µ : [ - ,  + ]  µ([k1, k2]) > #.

(11.3)

· For all   , we have that

([k1, k2])  [ - ,  + ] = .

(11.4)

GAUGE TRANSFORM AND APPLICATIONS

67

Then, (; A)  .

Proof. Since A is semi-bounded below, we can use Skriganov's characterisation [Skr85] of the overlap function as

(, A) = sup t : min N ((-,  + t ]; A(k)) < max N ((-,  - t ); A(k)) .

k

k

(11.5)

It then follows that if

N ( - ; A(k1)) - N ( + ; A(k2))  1,

(11.6)

then (; A)  . Equation (11.1) implies that we can separate the differences of each family µ,

 and  in (11.6). Equation (11.4) ensures that

#    : (k1)   -  - #    : (k2)   +  = 0.

(11.7)

We also have that

#    : (k1) <  -  - #    : (k2)   +   #.

Finally, from (11.2), (11.3) and the fact that all functions µ  µ are increasing, we have that

# µ  µ : µ(k1)   -  - # µ  µ : µ(k2)   +  > #.

(11.8)

Indeed, assumption (11.2) ensures that every µ  µ contributes at least 0 to the lefthand side of (11.8), whereas (11.3) ensures that there at least # + 1 functions in µ contributing 1. Combining (11.7)­(11.8) yields (11.6).

In the remainder of this section, we therefore set out to prove the existence of the interval [k1, k2] as well as of the families of functions µ,  and  satisfying the hypotheses of Proposition 11.1. We will, as we go along, use relevant results from [PS10], mostly about properties of the function g and volume of various sets associated with the preimage.

11.1. A description of the spectrum. In [PS10], Parnovski and Sobolev have constructed functions g j : Rd  spec(A j ). When restricted to a coset {}+, g j is a bijection (respecting multiplicity) with spec(A j ({})). It is useful to use g j to define a family of functions on the fundamental cell O indexed by p := ( j , )  {1, . . . , m} ×  =:  as
gp(k) := g j (k + ).
Since we assume in this section that
A = A1  . . .  Am  USm,

68

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

and that is is a semi-boudned below operator, we have by construction that p (A(k)) : p  N is a relabeling of g(j,)(k) : ( j , )   in increasing order. In particular, the latter set is discrete, bounded from below and accumulates only at infinity.
To prove Proposition 10.3, it remains to show that there exists S  R such that the hypotheses of Proposition 11.1 hold for some   S. The families µ,  and  will be realised as a partition of the set gp : p   .

Proposition 11.2. There exist 0 > 0 and S  R (depending on {a1, . . . , am},  and the implicit constants in (11.12)) such that for all   0, there exists an interval [k1, k2] and three families of functions µ, ,  on [k1, k2] satisfying the hypotheses (11.1)­(11.4) of Proposition 11.1.

The remainder of this section is dedicated to the proof of this proposition. We give some useful properties of the functions g j . For 1  j  m, there are a j > 0 and G j : Rd  R such that

g j () = a j || +G j (), a j > 0.

(11.9)

Furthermore, whenever

||  ,

(11.10)

we have G j ()  
for some  < , the implicit constant depending on the ones in (11.10). We need to control the first and second derivatives of the functions G j on a large enough
region. To this end, for   (0, /4), define the "annular" regions

Aj

:=

Aj (; ) :=

g

-1 j

 - ,  + 

.

We suppose that for every 0 <  < /4, Aj can be decomposed further into a non-resonant set

Bj := Bj (, )  Aj

and a resonant set R j := Aj \ Bj .
A precise description of those sets is given in [PS10]; the non-resonant sets Bj correspond to simple eigenvalues of the operators A j ({}), whereas the resonant sets R j correspond to clusters of eigenvalues. In particular, when   Bj ,

Ae  v j = g j ()e  v j .

(11.11)

GAUGE TRANSFORM AND APPLICATIONS

69

An important property of the non-resonant set is that the functions g j behave well there. We

suppose

that

the

restriction

of

Gj

to

Bj

is

of

class

C2

and

that

for

all





B

 j

,

the

bounds

G j ()  , 2G j ()  

(11.12)

hold, where  <  - 1 and  <  - 2, and the implicit constants are once again allowed to depend on the implicit constants in (11.10). In order to prove Proposition 11.2, it will be sufficient to show that the sets Bj are, in a sense, large enough. In subsection 11.2 we constrain the radial projection on the sphere of those resonant and non-resonant sets.

11.2. Description of the resonant sets. The description of the resonant sets in this section ex-

pands on the results in [PS10, Sections 5,7,8,9]. We first introduce some notation. Most of the

sets we define depend on the parameters  and ; however, we will be quick to drop the (explicit) dependence on these parameters to make notation lighter. For every   Rd \ {0}, let u := ||-1  be the unit vector in the direction of . For  > 0 and    \ {0}, we define spherical resonant

regions as

S (; T ) :=   Sd-1 : | · u| < T .

For any subset U of the sphere Sd-1, we denote its radial extension by

Urd :=   Rd : u  U .

The following lemma is proved in [PS10, Section 5].

Lemma 11.3. There exists c (depending on the coefficients a j ) such that for every  large enough, and   (0, c), there are , and  such that

0 <  < d -2,  := ( \ {0})  B (), d <  < 1

and such that for all 1  j  m,

Denoting and we also have that Bj  Bj .

R j (; )  Aj  S (; -)rd .

T () := Sd-1 \ S (; -)

Bj () := Aj  Trd ,

(11.13)

70

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Remark 11.4. The inclusion (11.13) means that the radial projection to the sphere of the resonant region is included in the union of the sets S (; -), justifying naming them spherical resonant regions. Consequently, we name T the spherical non-resonant region.
The object of the next lemma is that small enough neighborhoods of the spherical resonant regions have small volume.

Lemma 11.5. Let ,  and  be obtained in Lemma 11.3 and define

T () := Sd-1 \

S (; 2-) ,



Z j (; ) := Aj  Srd (; 2-),


(11.14)

and

G j (; ) := Aj  Trd = Aj \ Z j .

(11.15)

Then, G j  Bj , and for all   G j , dist(, R j )  1-. Furthermore, for 0 =  - d  > 0,

vol(Z j (; ))  d--0 .

(11.16)

and vol(G j (; ))  d-.
Proof. It is clear from the definition that G j  Bj  Bj . Define the sets

(11.17)

Ij () := Aj  {}rd .
It follows from [PS10, pp.518­519] that for all , Ij () is an interval of length Ij  1- (uniformly in ), and
Ij   : ||   . Furthermore, by definition

dist T (), S (; -) > -.

It therefore follows from (11.13), (11.15) and basic trigonometry that dist(G j , R j )  1-. For the volume estimate for Z j , we compute

vol(Z j ) 

t d-1 dt d

 S (;-) Ij ()

 #() max vold-1(S (; 2-))d-.


(11.18)

Uniformly in  we have that, vold-1(S (; 2-)  -. We also have that #  d. Putting these two estimates in (11.18) yields (11.16). For the estimate on vol(G j (; )), we observe that

GAUGE TRANSFORM AND APPLICATIONS

71

vol(G j ) = vol(Aj ) - vol(Z j ) and that by (11.9), vol(Aj )  d-.
Estimate (11.17) then follows from the fact that vol(Z j ) = o vol(Aj ) .

11.3. Volumes of intersections. For b1, b2  Rd and i , j  {1, . . . , m} we define the crossing sets

Xi j (, , b1, b2) := (Ai (; ) + b1)  (Aj (; ) + b2). We are interested in volume estimates, and since

vol(Xi j (, , b1, b2)) = vol(Xi j (, , 0, b2 - b1)), we restrict ourselves to sets of the form

Xi j (b) := Xi j (, , b) := Xi j (, , 0, b). Denote by (a, b) the (smaller) angle between a and b. For any angle   [0, ], we define the set

Xi j,(b) :=   Xi j (b) : (,  - b) >  .

From [PS10, Section 9] since gi , g j are defined as in (11.9), so that the conditions (11.12) are respected, the following holds: for any   (0, ),  > 0, if 2-+2  0 as   , then

vol(Xi j ,(, , b))  24-2+d+6 + 1--(d-1),

(11.19)

uniformly in b.

Proposition 11.6. There are constants c and C depending on , , and the numbers a j such that Xi j,(b) =  implies that c  |b|  C .
Proof. We first make the observation that there exists C > 0, depending on  and the numbers a j such that if |b| > C , then for  large enough Ai  (Aj + b) = . On the other hand, it follows from basic planar trigonometry that for every , there exists c, depending on the constants in ||  , such that if |b| < c, then (,  - b)  .
Remark 11.7. The estimates in (11.19) were established under stronger hypotheses in [PS10, Theorem 9.1]. This was because of the fact that their methods required control of the volume of Xi j (b), for all 1  |b|  , while we only need to control the volume of Xi j,(b) for |b|  . The stronger conditions were needed to treat the case of small angles, and small b (that is, such that |b| = o  ). Our approach does not require any such estimates.
Before going on, let us make the following notational convention.

72

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Convention. For any family of subsets E ()  Rd depending on the parameter  > 0, we denote E () := E (Z ),

where Z is some large constant to be determined later and depending only on the dimension d , the order  and the numbers {a1, . . . , am}.

We now define crossing sets for the non-resonant sets G j . For b  Rd , let Yi j (b) := Gi  (G j + b)
and for any angle   (0, ), Yi j,(b) :=   Yi j (b) : (,  - b) >  = Xi j,(b)  Yi j (b).
We need the following lemma.

Lemma 11.8. For any   (0, ) and  > 0, the condition 2-+2  0 as    implies

m
vol

Yij ,()  24-2+2d+6 + 1-+d-(d-1),

i , j =1 

the implicit constants depending only on , , Z , and the coefficients a j .

Proof. It is sufficient to prove the result for a single pair i , j , then sum the estimates over all m2 of those pairs. From Proposition 11.6, there are constants c and C depending only on , , T and the numbers a j such that

vol

Yij ,() 

vol Yi j,()





c||C 

 24-2+2d+6 + 1-+d-(d-1),

where the last line comes from Yi j,()  Xi j,(), estimate (11.19) and the fact that #    : c  ||  C   d .

11.4. Estimates on the overlap function. Define

Z :=

Zj,

1 j m

and

G :=

Gj.

1 j m

It follows directly from the definitions of Z j (11.14) and G j (11.15) that G  Z = . Furthermore, for every   G and every 1  j  m,   G j or   Aj .

GAUGE TRANSFORM AND APPLICATIONS

73

For every   Rd , and any subset E  Rd , we define

n(, E ) = # {   :  +   E } .

Let us take a step back to see what is needed in order to prove Proposition 11.2. The estimates on the functions G j in the non-resonant regions Bj ensure that g j are radially increasing in those regions.
We need three ingredients in order to prove the existence of a path (of the form, before projection down to O , [t1, t2] for some   Sd-1) satisfying hypotheses (11.1) ­ (11.4) in Proposition 11.2.

· That for   G j , the functions g j are increasing not only in the radial direction but also along directions deviating from the radial one by angles smaller than /4, at least for some controllable distance.
· That there are points   G such that n(; G ) > n(; Z ). · That there are some of those  such that for all    =  \ {0} satisfying  +   G , we
have that (,  + ) < /4.

The first of those statements is proved directly. For the last two, we will show that the proportion of   G such that either n(; Z )  n(; G ) or for which there exists    such that +  G  and (,  + ) > /4 is smaller than 1. Actually, for some appropriate choice of the free parameter , we will in fact show that this proportion can be made arbitrarily small.
The following lemma addresses the first bullet point.

Lemma 11.9. Let  be as obtained in Lemma 11.3. For all   G j , and all b such that | + b|   and (, +b)  /4 there is a t0  - such that for all t  [-t0, t0] the function t  g j (+t (+b))

is increasing and

d dt

g

j

(

+

t

(

+

b))





.

The implicit constant in t0  - depends only on the functions g j and the implicit constants in

| + b|  .

Proof. Since   G j , we have that not only   Bj for some j , but also, by Lemma 11.5, that there exists r > 0 such that for all j , dist(; R j ) > r 1-. Therefore, for |t |  t0 := r -, we have that
 + t ( + b)  Bj . By (11.12), we have that

d dt

G

j

(

+

t

(

+

b))

 +1 = o



.

74

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

On the other hand,

d dt

|

+

t ( + b)|

=

| +

t ( +

b)|-2

×

× || | + b| cos (,  + b) + t | + b|2

 ,

where the last line holds from the fact that cos (,  + b) > 2/2.

Lemma 11.10. Let

N :=   Rd : n(; G )  mn(; Z ) ,

and NG = N  G . Then, we have that

vol(NG )  vol(Z )  d--0 ,

where 0 is as in Lemma 11.5.

Proof. Observe first that for any E  Rd , the function n(; E ) is constant on the fibres  mod , as such it is well defined on O and N is invariant under the action of . We therefore have that

vol(NG ) =

n(; G ) d

N /

m

n(; Z ) d

N /

= m vol(N  Z )

 m vol(Z ).

The claim now follows from Lemma 11.5.

Lemma 11.11. Let

U :=   G \ N :  + 1  Yij,/4(1 - 2)

for some 1  i , j  m and 1, 2   .

Then, if  and  are such that d-+2  0, we have

vol(U )  24-2+2d+6 + 1-+d-(d-1).

Proof. Suppose that   U  G , so that   Gk for some 1  k  m. Consider the lattice elements 1, 2   such that  + 1  Yij,/4(1 - 2). By definition of Yij,/4 and translation, this means that





(Gi

-

1)



(G

 j

-

2),

and therefore that

  Yki (-1)  Ykj (-2).

GAUGE TRANSFORM AND APPLICATIONS

75

Furthermore, ( + 1,  + 2) > /4. As such,

max (,  + 1), (,  + 2) > /8.

Combining the previous two displays yields

  Yki ,/8(-1)  Yk j ,/8(-2).

Therefore,

m

vol(U )  vol

Yij ,/8()

i , j =1 

 24-2+2d+6 + 1-+d-(d-1),

the last line holding by virtue of Lemma 11.8.

Proposition 11.12. Let

s := min

d

-

d2 - 2(d

3d - + 2)



-

2

,



-

d

+

-d -2 2(d + 2)

.

For  large enough and  = o s , the set

K := G \ (NG  U )

is non empty.

(11.20)

Proof. Recall from Lemma 11.5 that vol(G )  d-. On the other hand we have from Lemma 11.10 that there is 0 > 0 such that
vol(NG )  d--0 , and from Lemma 11.11 that as soon as d-+2  0 we have that
vol(U )  24-2+2d+6 + 1-+d-(d-1).

Take



=

-d -2 2(d + 2)

.

Observe that indeed when  = o s we have 2-+2  0 as   . We also observe that with

that choice of parameters vol(U ) + vol(NG ) = o (vol(G )) and hence, for large enough , K is not

empty.

We now have all the necessary ingredients to prove Proposition 11.2.

Proof of Proposition 11.2. Let s be defined as in (11.20). For any  > 0, set s = min {s - ,  - } where  is obtained in Lemma 11.3, and put  = s. Then, by Proposition 11.12 K is nonempty

76

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

for  large enough; choose 0  K . For 1  j  m, let j , j   be defined as

j :=    : 0 +   G j ,

j :=







:

0

+





G

 j

.

It follows from the definition of K that

m
Q := #j  n(0; G ).
j =1

Since 0  U , we have that (0, 0 + )  /4 for all   j . From equations (11.9)­(11.12),

Lemma 11.9, since   - there are t  - and Z0 independent of  such that for all 1  j  m

and   j ,

 - Z0  g j (1 - t ) 0 +    - ,

(11.21)

and

 +   g j (1 + t ) 0 +    + Z0.

(11.22)

It is clear that if (11.21) and (11.22) hold, they also hold replacing Z0 with any Z > Z0. The precise value we assign to Z might change as the proof goes along, but it will remain independent of 

and . We denote by J the radial interval

J := [(1 - t )0, (1 + t )0].
We now restrict ourselves to consider in (11.5) only those k  J mod . This corresponds, at the level of Besicovitch space, to the study of the operators

AJ := APJ +,

where the projection PJ + is defined in Proposition 2.16. We also define the projection Pgood acting on the basis elements e  v j as

Pgoode  v j := (PJ +j e)  v j .

From

Lemma

11.9

and

its

proof,

for

all





J

,

and

all







j

,

we

have

that



+





B

 j

.

It

therefore

follows from (11.11) and that Pgood commutes with A and AJ . We decompose

AJ = Agood + Abad,

where Agood := AJ Pgood and Abad = AJ (Id -Pgood).
For   J , denote by µ := µp () : 1  p  Q the eigenvalues of the operators Agood({}), and ^ := ^ p () : p  N the eigenvalues of Abad({}), each ordered nondecreasingly pointwise. It follows that for every   J , we have the equality of multisets

p (A({})) : p  N = µ  ^ .

GAUGE TRANSFORM AND APPLICATIONS

77

Furthermore,

for

all





^

corresponds

(j

,

)

such

that

either

0 +



Z

 j

or

0

+



A

 j

.

By

Lemma

11.9, for 1  j  m and   j , the functions g j ( + ) are continuous and increasing for   J .

Since the functions µp are obtained simply by ordering the functions g j ( + ) for 1  j  m and

  j in nondecreasing order at every point {}, they are therefore themselves continuous and increasing on J .

Let us now consider the functions ^ p. Notice that they are formed by removing # continuous branches from a family of continuous functions. They are therefore all continuous on J , and

[PS10, Theorem 3.6] also applies to them. In particular, one can choose Z  Z0 large enough so

that all functions p such that p(0)   - Z /2, respect the bound p() <  -  for all   J .

Similarly, all functions p such that p(0) >  + Z /2 respect p() >  +  for all   J . We

therefore define the sets

 :=

  ^ :

(0) - 



Z 2

and  = ^ \ .

In

particular,

for

all







there

corresponds

( j , )

such

that

in

0

+





A

 j

and

therefore

in

Z

 j

.

By construction, we have indeed that at every k  [k1, k2] the images of the families µ, ,  are

the eigenvalues of A(k) counted with multiplicity, satisfying therefore (11.1). Hypothesis (11.2) is

also satisfied since all µ  µ are increasing, and for all µ  µ, either

µ((1 - t )0) <  - , or µ((1 + t )0) >  + .

(11.23)

It follows from our choice of t in (11.21)­(11.22) that there are at least Q  n 0; G of them so that both inequalities in (11.23). On the other hand, all    correspond to some ( j , )   such that 0 +   Z , hence there's at most mn(0; Z ) < n(0; G ) of them, hence hypothesis (11.3) holds. Finally, we constructed  explicitly so that for all   , hypothesis (11.4) holds.
Proposition 11.2 is therefore true, and we conclude that we have at least (; A) > . In view
of our choice of  this also gives us an overlap exponent at least

S  min { - , s - }

where  > 0 is arbitrary and s is given in (11.20).

12. THE DIRAC OPERATOR
In this section, we aim to get conditions on perturbations of the Dirac operator so that the gauge transform and, more importantly, all the theorems from Part II can be applied. Basic facts and theorem on the Dirac operator are found in [GM91, Tha92]. We consider Dirac operators built through Clifford algebras, of which the usual two- and three-dimensional cases are

78

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

examples. We are then able to explicitly describe perturbations to which we can apply the gauge transform method and recover the results of Sections 7­11.

12.1. Clifford algebras. We give here basic facts about Clifford algebras used to construct the Dirac operator in the flat setting. They can be found in [GM91, Section 7]. Let Rp,q be the eu-
clidean space of dimension p + q equipped with the canonical quadratic form  of signature (p, q). In our applications, we consider only the cases R0,d (Euclidean) and R1,d (Minkowski). We
denote their orthonormal bases respectively {v1, . . . , vd } and {v0, v1, . . . , vd }. Consider the algebra Ap,q generated by {1, v1, . . . , vd } or {1, v0, . . . , vd } with the relations

vj vk + vk vj = -2 j k .

(12.1)

It is easy to see that Ap,q has dimension 2p+q . For any subset S := {s1, . . . , sk }  {0, . . . , d } (or of {1, . . . , d } in the euclidean setting), we denote by vS the element vs1 · · · vsk  Ap,q , where by convention v = 1. The Clifford algebra on Rp,q is isomorphic to the exterior algebra (Rd ).
From the anticommutation relation (12.1), we deduce that each pair of the 2p+q generators of
Ap,q either commutes or anticommutes, according to the rule  vj vS = (-1)|S|vS vj if j  S,
vj vS = (-1)|S|-1vS vj if j  S.

When p +q is even, there is a faithful representation of Ap,q acting on the spinor space C . 2(p+q)/2 A specific representation by matrices constructed recursively is given in [Upm02] in the Euclidean

and Minkowski cases. This representation  has the property that for all 1  j  d , the matrix

j := (vj ) is skew-hermitian and squares to - Idp+q , 0 := (v0) is hermitian and squares to the

identity, and there is some |c| = 1 so that the grading operator  := c j j is a diagonal matrix of

the form

=

Id(p+q)/2 0

0

.

- Id(p+q)/2

We can observe that for all j , j = -j . The operator  is called "grading" because it induces a Z2 grading on Ap,q . The even subalgebra of Ap,q consists of all the elements commuting with , while the odd subspace consists of all the anti-commuting elements. In particular, all the j are in the odd subspace, which is characterised as a product of an odd number of generators, while

the even subalgebra is characterised as products of even number of generators.

Lemma 12.1. Let  be an element of the odd subspace. Then, as a matrix it has the form  := 0 X , Y0

GAUGE TRANSFORM AND APPLICATIONS

79

where each of the blocks is a m/2 × m/2 matrix. Proof. This follows from a simple computation of the relation + = 0 on the matrix elements.

The representation  also allows us to see that as a C -algebra, Ap,q is naturally isomorphic to an algebra of operators on a Hilbert space Sp+q , called the spinor space. When m is even, we have that Sp+q = C . 2(p+q)/2 Therefore, setting m = 2(p+q)/2, we can use this representation to obtain operators in S m .
12.2. Dirac operators. We define (spatial) Dirac operators differently depending on whether the number of spatial dimensions is even or odd.

Definition 12.2. Let d be odd. The d -dimensional free Dirac operator Ad is the first order system

acting

on

spinors

in

L2(Rd ; Cm),

for

m

=

2

d

+1 2

given

by

d
Ad = j j ,
j =1
where the j are given by the representation of A1,d-1 in L (Cm).

Definition 12.3. Let d be even. The d -dimensional free Dirac operator Ad is the first order sys-

tem acting on spinors

L2

(Rd

;

Cm

),

for

m

=

2

d 2

given

by

d
Ad = j j ,
j =1
where the j are given by the representation of A0,d in L (Cm ).
It is easy to see in both cases that A2d = - Idm.
Example 12.4. The two-dimensional Dirac operator with mass M is given in [Tha92, Equation 1.14] as
A2,M = -i 1x1 + 2x2 + 3M ,
where 1, 2, 3 are the Pauli matrices

0 1 = 1

1 0

, 2 =

0 i

-i 0

, 3 =

1 0

0 -1

.

It is a perturbation of order 0 of the free Dirac operator. Indeed, the Pauli matrices can be used for a representation of the Clifford algebra A0,2, and 3 corresponds to the grading operator .

Example 12.5. The three-dimensional Dirac operator with mass M from [Tha92, Equation 1.11] given by
A3,M = -i 1x1 + 2x2 + 3x3 + M

80

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

is also a perturbation of order 0 of the free Dirac operator. Here, the matrices j are the Dirac -matrices used as a representation of A1,3, and our notation generalises this notion, following [Upm02].

We now show that the operators Ad are elliptic in the sense of Section 3.

Proposition 12.6. Let m := m(d ) be the dimension of the spinor space on which Ad acts. The operator U  S0m with symbol

u(x, ) := 1{||1}() 2

Idm

+

i ||



j

d =1



j



j

+ 1{||<1}() Idm

(12.2)

is unitary. Furthermore, UAd U  DES1m and there is R  S-m such that the symbol of UAd U - R is || .

Proof. The symbol of the adjoint of U is given, following (2.14), by

u(x, ) = 1{||1}() 2

Idm

-

i ||



j

d =1



j



j

+ 1{||<1}() Idm

and we can compute that

u  u

()

=

1{||1}() 2

Idm

1 - ||2

d 2j k j k
j ,k=1

+ 1{||<1}() Idm

=

1{||1}() 2

Idm

-

1 ||2

2j 2j
j

+ 1{||<1}() Idm

= Idm .

In a very similar fashion, we see that the symbol of UAd U is given by

[u  ad  u]() = 1{||1}() ||  + 1{||<1}()ad ().

This proves our claim where R  S-m has symbol

r() = 1{||<1}()(ad () - || ).

We now see that for d = m = 2, the operators A2 + B, B  Sm,  < 1 are unitarily equivalent to an operator satisfying the hypotheses of Theorems 8.2 and Theorem 10.1, which proves that we generically have a complete asymptotic expansion for the density of states, and that if B is periodic then A has the Bethe­Sommerfeld property. In other words, the following two theorems are proved, which are more precise reformulations of Theorems 1.1 and 1.3.

GAUGE TRANSFORM AND APPLICATIONS

81

Theorem 12.7. Let  < 1 and A = A2 + B, where B  S2 satisfies the generic conditions A, B and C. Then, for every K > -2 there is a finite set L  (0, 2 + K ) so that for every j  L  {0} there are

constants

C

±j ,

C

± j ,log

such

that

N ±(A; ) = C0±2 +

C ±j 2- j + C ±j ,log2- j log  + O -K

j L

as   .

Theorem 12.8. Let  < 1 and A = A2 + B, where B  S2 is periodic. Then, A has the Bethe­ Sommerfeld property, i.e. there exists 0 > 0 such that the spectrum of A contains intervals (-, -0]
and [0, ).

We now want to address the question of the perturbations that are allowed whenever d  3.

Proposition 12.9. For  < 1, and 0  j  d (with 0 omitted when d is even), let BId, B, B j  S1 be scalar pseudo-differential operators of order , and put

B = BId Idm +B + B j j .
j

Then, there are operators B  USm, R  Sm-1 and B  Sm whose symbol has image in the odd subspace of Ap,q such that

U(Ad + B)U = Op(||) + B + B + R

(12.3)

Proof. The unitary operator U from (12.2) can be written as

U=

1 2

d
Idm + U j j
j =1

mod S-m.

Here, U j  S01 are scalar pseudo-differential operators given by

U j = Op

i j () ||

,

where  is a smooth function supported in {||  1/2} and ()  1 for all ||  3/4. We now compute UBU for different values of . All the sums range from 1 to d with additional restrictions, we have only written the restrictions to make notation lighter. For 1  j  d we have

UB j j U

=

1 2

B j j + [Uk ; B j ]k j - (U j B j + B jU j ) +
k=j

k

(Uk B jU j +U j B jUk )k -

- Uk B jUk j - [U; B jUk ] + [B j ;Uk ]U k j

k

= j

k=j

k <

mod S-m.

(12.4)

82

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Let us have a careful look at each of the six terms in Equation (12.4). The second and the last terms involve commutators of operators with scalar-valued symbols, they are in Sm-1 and we put Rj as their sum. The third term is in USm, and we denote it Bj . Finally, the first, fourth and fifth term are readily seen to have symbols in the odd subspace, we put Bj as their sum.
The operator UB00U is computed similarly as in (12.4) with some of the terms vanishing. It
is given by

UB00U

=

1 2

B00 +

[Uk ; B0]k 0 -
k

k

Uk B0Uk 0-

- ([U; B0Uk ] + [B0;Uk ]U)k 0 mod S-m.
k <

The first and third term have image in the odd subspace, we put B0 as their sum. The second
and last terms involve commutators of operators with scalar-valued symbols, as such they are in Sm-1 and we put R0 as their sum. We note that there are no uncoupled terms.
The operator UBU is given by

UBU

=

1 2

B -

(Uk B + BUk )k -
k

- Uk BUk  + ([U; BUk ] + [B;Uk ]U) k mod S-m.

k

k <

This time, the first and third terms are seen to be in USm and we put their sum as B. The second term has symbol in the odd subspace and we denote it by B. The last term can be seen to be in Sm-1 and we denote it by R.
Finally, the operator UBId Idm U is given by

UBId

Idm

U

=

1 2

BId Idm +

[Uk ; BId]k +
k

k

Uk BIdUk Idm

+ ([U; BIdUk ] + [BId;Uk ]U) k mod S-m.
k <
This time, we see that the first and third terms are in USm, we put their sum as BId, while the second and last terms are in Sm-1 and we put their sum as RId.

GAUGE TRANSFORM AND APPLICATIONS

83

Finally, put R  S-m as the sum of the remainders mod S-m obtained at every step. Combining all our computations and Proposition 12.6 gives us that (12.3) holds with
d
B = BId + B + Bj
j =1
d
B = BId + B + Bj
j =0
d
R = R + RId + R + Rj .
j =0

The next theorem follows and includes Theorem 1.2 as a special case when d = 3.

Theorem 12.10. Let m(d ) be the dimension of the spinor space on which Ad acts. For   1/2 and 0  j  d (with 0 omitted when d is even) let B, B j , BId  S be scalar pseudo-differential operators
satisfying Conditions I­IV, and put

d
B = BId Idm +B + B j j ,
j =0

and A = Ad + B. Then, putting  = max  - 1, 2 - 1 , there exists a finite set L  (0, 1 - ) and

constants

C

± 0

and

C

± j ,q

,

0



q



d

- 1,

j



L

such

that

N ±(A; ) = C0±d +

d -1

C

± j ,q

d- j

logq



+

O

d -1+

j L q=0

as   .

Proof. It follows from Proposition 12.9 that UAU satisfies the hypotheses of Theorem 8.1 with  = max  - 1, 2 - 1 . In particular, the restricted asymptotics of the IDS given in that theorem are true for such operators with  = 1.

Finally, in some highly non-generic cases we can get complete asymptotic expansions and the Bethe­Sommerfeld property for d -dimensional Dirac operators with d  3. We state both results and observe that they follow directly from the fact that after conjugation by U, these operators are uncoupled.

Theorem 12.11. Let m(d ) be the dimension of the spinor space on which Ad acts,  < 1 and B  USm satisfying Conditions I­IV. Put A = Ad + UBU. Then, N ±(A; ) satisfies the complete
asymptotic expansion (8.2) with  = 1.

84

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

Theorem 12.12. Let m(d ) be the dimension of the spinor space on which Ad acts,  < 1 and B  USm be periodic. Put A = Ad + UBU. Then, A has the Bethe­Sommerfeld property.

REFERENCES
[BP09] G. Barbatis and L. Parnovski. Bethe-Sommerfeld conjecture for pseudodifferential perturbation. Comm. Partial Differential Equations, 34(4-6):383­418, 2009.
[BS87] M. Birman and M. Solomjak. Spectral Theory of Self-Adjoint Operators in Hilbert Space. Mathematics and its Applications. Springer Netherlands, 1987.
[CMS73] L. A. Coburn, R. D. Moyer, and I. M. Singer. C -algebras of almost periodic pseudodifferential operators. Acta Math., 130:279­307, 1973.
[Dix81] J. Dixmier. Von Neumann Algebras, volume 27 of North-Holland Mathematical Library. North-Holland Publishing Co., Amsterdam-New York, 1981. With a preface by E. C. Lance, Translated from the second French edition by F. Jellett.
[GM91] J. E. Gilbert and M. A. M. Murray. Clifford algebras and Dirac operators in harmonic analysis, volume 26 of Cambridge Studies in Advanced Mathematics. Cambridge University Press, Cambridge, 1991.
[Hör07] L. Hörmander. The analysis of linear partial differential operators. III. Classics in Mathematics. Springer, Berlin, 2007. Pseudo-differential operators, Reprint of the 1994 edition.
[Ivr19] V. Ivrii. Complete Semiclassical Spectral Asymptotics for Periodic and Almost Periodic Perturbations of Constant Operators, pages 583­606. Springer, 2019.
[Kuc93] P. Kuchment. Floquet theory for partial differential equations, volume 60 of Operator Theory: Advances and Applications. Birkhäuser Verlag, Basel, 1993.
[MPS14] S. Morozov, L. Parnovski, and R. Shterenberg. Complete asymptotic expansion of the integrated density of states of multidimensional almost-periodic pseudo-differential operators. Ann. Henri Poincaré, 15(2):263­312, 2014.
[Nai72] M. A. Naimark. Normed algebras. Wolters-Noordhoff Publishing, Groningen, third edition, 1972. Translated from the second Russian edition by Leo F. Boron, WoltersNoordhoff Series of Monographs and Textbooks on Pure and Applied Mathematics.
[Par08] L. Parnovski. Bethe-Sommerfeld conjecture. Ann. Henri Poincaré, 9(3):457­508, 2008. [PS10] L. Parnovski and A. V. Sobolev. Bethe-Sommerfeld conjecture for periodic operators
with strong perturbations. Invent. Math., 181(3):467­540, 2010. [PS12] L. Parnovski and R. Shterenberg. Complete asymptotic expansion of the integrated
density of states of multidimensional almost-periodic Schrödinger operators. Ann. of Math. (2), 176(2):1039­1096, 2012.

GAUGE TRANSFORM AND APPLICATIONS

85

[PS16] L. Parnovski and R. Shterenberg. Complete asymptotic expansion of the spectral function of multidimensional almost-periodic Schrödinger operators. Duke Math. J., 165(3):509­561, 2016.
[PS19] L. Parnovski and R. Shterenberg. Perturbation theory for almost-periodic potentials I: one-dimensional case. Comm. Math. Phys., 366(3):1229­1257, 2019.
[Roz78] G. V. Rozenbljum. Near-similarity of operators and the spectral asymptotic behavior of pseudodifferential operators on the circle. Trudy Moskov. Mat. Obshch., 36:59­84, 294, 1978.
[Shu78] M. A. Shubin. Almost periodic functions and partial differential operators. Uspehi Mat. Nauk, 33(2):3­47, 247, 1978.
[Shu79a] M. A. Shubin. Pseudodifferential almost-periodic operators and von Neumann algebras. Trans. Mosc. Math. Soc., 35:103­166, 1979.
[Shu79b] M. A. Shubin. Spectral theory and the index of elliptic operators with almost-periodic coefficients. Uspekhi Mat. Nauk, 34(2):95­135, 1979.
[Skr85] M. M. Skriganov. Geometric and arithmetic methods in the spectral theory of multidimensional periodic operators. Trudy Mat. Inst. Steklov., 171:122, 1985.
[Sob05] A. V. Sobolev. Integrated density of states for the periodic Schrödinger operator in dimension two. Ann. Henri Poincaré, 6(1):31­84, 2005.
[Sob06] A. V. Sobolev. Asymptotics of the integrated density of states for periodic elliptic pseudo-differential operators in dimension one. Rev. Mat. Iberoam., 22(1):55­92, 2006.
[Tay11] M. E. Taylor. Partial differential equations II. Qualitative studies of linear equations, volume 116 of Applied Mathematical Sciences. Springer, New York, second edition, 2011.
[Tha92] B. Thaller. The Dirac equation. Texts and Monographs in Physics. Springer-Verlag, Berlin, 1992.
[Upm02] H. Upmeier. Dirac operator and real structure on Euclidean and Minkowski spacetime. In Noncommutative geometry and the standard model of elementary particle physics (Hesselberg, 1999), volume 596 of Lecture Notes in Phys., pages 136­151. Springer, Berlin, 2002.
[Wei77] A. Weinstein. Asymptotics of eigenvalue clusters for the Laplacian plus a potential. Duke Math. J., 44(4):883­892, 1977.

86

J. LAGACÉ, S. MOROZOV, L. PARNOVSKI, B. PFIRSCH, AND R. SHTERENBERG

DEPARTMENT OF MATHEMATICS, UNIVERSITY COLLEGE LONDON, GOWER STREET, LONDON, WC1E 6BT, UK Email address: j.lagace@ucl.ac.uk Email address: l.parnovski@ucl.ac.uk Email address: bernhard.pfirsch.15@alumni.ucl.ac.uk
MATHEMATISCHES INSTITUT DER UNIVERSITÄT MÜNCHEN, THERESIENSTR. 39, D-80333 MÜNCHEN, GERMANY Email address: morozov@math.lmu.de
UNIVERSITY OF ALABAMA AT BIRMINGHAM, 1300 UNIVERSITY BLVD, BIRMINGHAM, AL 35294. USA Email address: shterenb@math.uab.edu

