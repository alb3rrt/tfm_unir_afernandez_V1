arXiv:2106.01118v1 [nlin.CG] 2 Jun 2021

Koopman spectral analysis of elementary cellular automata
Keisuke Taga,1,  Yuzuru Kato,2 Yoshinobu Kawahara,3 Yoshihiro Yamazaki,1 and Hiroya Nakao2 1Department of Physics, School of Advanced Science and Engineering, Waseda University, Tokyo 169-8555, Japan 2Department of Systems and Control Engineering, Tokyo Institute of Technology, Tokyo 152-8552, Japan 3Institute of Mathematics for Industry, Kyushu University,
and Center for Advanced Intelligence Project, RIKEN, Fukuoka 819-0395, Japan (Dated: June 3, 2021)
Abstract
We perform a Koopman spectral analysis of elementary cellular automata (ECA). By lifting the system dynamics using a one-hot representation of the system state, we derive a matrix representation of the Koopman operator as a transpose of the adjacency matrix of the state-transition network. The Koopman eigenvalues are either zero or on the unit circle in the complex plane, and the associated Koopman eigenfunctions can be explicitly constructed. From the Koopman eigenvalues, we can judge the reversibility, determine the number of connected components in the state-transition network, evaluate the periods of asymptotic orbits, and derive the conserved quantities for each system. We numerically calculate the Koopman eigenvalues of all rules of ECA on a one-dimensional lattice of 13 cells with periodic boundary conditions. It is shown that the spectral properties of the Koopman operator reflect Wolfram's classification of ECA.
Electronic address: tagaksk@akane.waseda.jp
1

I. INTRODUCTION
The Koopman operator theory [1­7] for analyzing nonlinear dynamical systems have attracted much attention recently. For a given dynamical system, the Koopman operator analysis focuses on the evolution of observables rather than the system state itself. As the Koopman operator is linear even if the system dynamics is nonlinear, it provides a method to analyze nonlinear dynamical systems by using standard spectral methods for linear systems. On the other hand, because the Koopman operator acts on a function space of observables, it can be generally infinite-dimensional and difficult to analyze. Analytical solutions to the eigenvalue problems of the Koopman operator can be obtained only in a limited class of linearizable or exactly solvable systems. Koopman spectral analysis of partial differential equations (PDEs) describing spatiotemporal patterns has also been considered, but analytical results can be obtained only for solvable PDEs [8­11].
In this study, as the simplest system exhibiting spatiotemporal dynamics, we analyze elementary cellular automata (ECA) [12­18]. ECA are described by discrete space-time variables and binary state variables, which can exhibit rich dynamics including periodic and chaotic ones despite the simplicity of the evolution rules. The pattern dynamics of all 256 rules of ECA have been classified qualitatively into four classes by Wolfram [14]. Some of the ECA rules have also been studied as models of real-world systems such as pigmentation patterns on shells, peeling patterns of adhesive tapes, and congestion dynamics of traffic flows [14, 16, 17, 19].
Because the state space of ECA on a finite lattice is finite-dimensional, we can explicitly represent the Koopman operator of ECA by a finite-size matrix. Thus, we can perform direct numerical analysis of the Koopman eigenvalues, which provides insights into the relationship between the spatiotemporal dynamics and spectral properties of ECA and also serves as a testbed for examining various algorithms of dynamic mode decomposition (DMD) for estimating the Koopman eigenvalues using time-series data observed from spatially-extended dynamical systems [5, 6, 20­25].
This paper is organized as follows. In Sec. II, we briefly explain ECA and introduce the one-hot representation. In Sec. III, we introduce the Koopman operator for ECA and derive the matrix representation. In Sec. IV, we explicitly construct the Koopman eigenfunctions. In Sec. V, we perform a thorough Koopman spectral analysis for all rules of ECA with 13 cells. Section VI gives a summary.
2

II. ELEMENTARY CELLULAR AUTOMATA A. Wolfram's classification

A cellular automaton is a dynamical system whose space, time, and state variables are all discrete. In this study, we analyze ECA, the simplest case of the cellular automata on a onedimensional lattice [14]. In ECA, the state of each cell on the lattice takes either 0 or 1 and evolves with time under a given rule. The next state of each cell is determined by the current states of itself and the two neighboring cells. Despite the simplicity of the rules, ECA can exhibit various pattern dynamics including homogeneous, pulse-like, traveling, oscillating, chaotic, and complex behaviors [14]. Some of the ECA rules are directly associated with partial differential equations (PDEs) describing real-world systems. For example, rule 18 of ECA exhibits Sierpinski-gasket patterns similar to those of the Gray-Scott PDE for a chemical reaction [16], and rule 184 of ECA, which can be derived from the Burgers PDE by ultradiscretization, is discussed as a model of traffic flows [17, 26].
000 001 010 011 100 101 110 111

0

0

0

1

1

1

1

0

FIG. 1: Rule 120 of ECA.
In Fig. 1, rule 120 of ECA on a one-dimensional lattice is shown as an example, where we assign 0 to white cells and 1 to black cells, respectively. The states of the cells at the next time step can be specified by the 8 digits, which gives 120 in decimal numbers when interpreted as an 8-bit binary number. Thus, ECA on a one-dimensional lattice possess 223 = 28 = 256 possible rules in total. Among them, there are equivalent rules that can be transformed to each other by simple transformations, e.g., by spatial reflection, hence 88 rules are mutually independent [27].
Wolfram qualitatively classified these rules into four classes based on their typical dynamics in sufficiently large systems as follows [14]:
· Class I: The system converges to a homogeneous stationary state.
· Class II: The system converges to an inhomogeneous stationary state or a periodic state.
· Class III: The system exhibits chaotic dynamics.
· Class IV: The system exhibits a complex mixture of regular and chaotic dynamics.
3

Here, the term chaotic or complex describes the visual appearance of the system dynamics. The chaotic properties of the system can also be characterized in the sense that two nearby system states separate from each other exponentially [28, 29]. As the state space of ECA on a finite lattice is finite, all orbits eventually behave periodically also in class III and class IV, but their periods can be extremely large.
Wolfram's classification captures the main characteristics of ECA, but it is essentially qualitative as it is based on visual inspection of the spatiotemporal patterns. Thus, various criteria for more quantitative classification of ECA have been proposed [15, 18]. In this study, we analyze the spectral property of the Koopman operator of ECA and discuss their relationship with Wolfram's classification.

B. State space of ECA

The ECA can be considered a discrete dynamical system of the form

xn+1 = F (xn),

(1)

where xn  M represents the system state at discrete time n and the map F : M  M represents the dynamics of the system state. When the system has N cells, the state space M is a set of

N -dimensional binary vectors, i.e., M = {x = (x1, ..., xN ) | x1,...,N  {0, 1}}. The total number of possible system states is |M | = 2N .
We can also assign each system state x = (x1, ..., xN )  M an index q  {1, ..., 2N } as

N

q = 2j-1xj + 1.

(2)

j=1

For example, the state x = (0, 1, 0) of 3-cell ECA is indexed as q = 3. Using this index, we can also represent the system state as an element in the set of 2N integers, {1, ..., 2N }. We denote the system state in M with index q as x(q) in the following discussion.

The transitions between the system states can be represented by a directed state-transition net-

work, as illustrated in Fig. 2 for rule 120 on the minimal lattice with 3 cells and periodic boundary

conditions (the leftmost and rightmost cells are adjacent to each other), where the network nodes

represent individual system states and directed links represent the transitions between the states

determined by the ECA rule. The states like x = (1, 1, 0), (1, 0, 1), and (0, 1, 1), which cannot be

reached from any states, are called the garden-of-Eden states [12, 18]. ECA without garden-of-Eden

4

states are known to be reversible [18], namely, the map F is bijective and there exists another rule represented by F -1 such that x = F -1(F (x)) = F (F -1(x)) for all x  M .
As illustrated in Fig. 2, each network of ECA consists of several weakly connected components (maximal connected subnetworks), i.e., the maximal sets of states that are connected with each other when the directions of the links are neglected. In each connected component, only a single periodic orbit (including a period-1 stationary state) exists, and the system states not included in this periodic orbit belong to a tree subnetwork whose root is a state in the periodic orbit and whose leaves (terminal nodes) are garden-of-Eden states. For example, there are two connected components A and B in Fig. 2, each with a single periodic orbit of period 3 (A) or 1 (B), where the component B on the right has a period-1 orbit and a tree subnetwork with three eden-of-Garden states. This is because the rule of ECA is deterministic and each state has only a single outgoing link, hence no more than two periodic orbits can exist in the same connected component.
The system states not included in the periodic orbit converge to the periodic orbit in the same connected component within finite steps, because if an orbit that does not converge to the periodic orbit exists, the corresponding time series should include overlapping states when it becomes longer than 2N by the pigeonhole principle. Thus, the periodic orbit is an attractor and the connected component of the network is the basin of attraction.

III. KOOPMAN SPECTRAL ANALYSIS OF ECA

A. Koopman operator

We now introduce the Koopman operator for ECA. An observable G : M  C is a function that maps the system state x  M to an observed value G(x)  C. The Koopman operator K^

001


100

010

000


111

011 101 110

FIG. 2: State-transition network of ECA with 3 cells and periodic boundary conditions for rule 120, which comprises two subnetworks (connected components).

5

describes the evolution of the observable G and is defined as

(K^ G)(x) = G  F (x) = G(F (x))

(3)

for x  M , where  denotes composition of functions. Namely, instead of evolving the system state as x  F (x) and observe it by a fixed observable G to obtain the measurement results G(x)  G(F (x)), we consider that the system state is fixed at some x but rather the observable G evolves such that the same measurement results G(x)  (K^ G)(x) are obtained.
For systems with continuous states, the space of the observables can be infinite-dimensional. However, for ECA with N cells, the total number of the system states is 2N , hence the Koopman operator can be represented by a finite-dimensional 2N × 2N matrix, as we show in the next subsection.
The linearity of the Koopman operator follows from the definition, namely,

{K^ (aG + bH)}(x) = aG(F (x)) + bH(F (x))

= a(K^ G)(x) + b(K^ H)(x)

(4)

holds for arbitrary observables G and H and complex numbers a and b. Thus, even if the dynamics F is nonlinear, the corresponding evolution of the observable is linear and the spectral methods for linear systems can be used to analyze the system's dynamical properties.
In particular, by solving the eigenvalue equation for K^ (assuming K^ has only a discrete spectrum, which is the case for ECA),

(K^ )(x) = (x),

(5)

we can obtain a set of eigenvalues and associated eigenfunctions, {, }, where  = 1, ..., 2N is the index. As we explain later, the system may not possess 2N independent eigenfunctions. If so, we also consider the generalized eigenfunctions with higher ranks, which satisfy (K^ - I^)m+1(x) = 0 and (K^ - I^)m(x) = 0, where m + 1  2 is the rank and I^ is an identity operator.
The Koopman eigenfunctions play essentially important roles in the Koopman spectral analysis of nonlinear dynamical systems and can represent physical information of the system such as conserved quantities [3­7, 10]. For example, the Koopman eigenfunction (x) with eigenvalue  = 1 yields a conserved quantity (invariant) of the system because

(K^ )(x) = (F (x)) = (x).

(6)

Thus, we have (xn) = (K^ n)(x0) = (x0) = const. for all n  0. We note that we consider general conserved quantities here, not the additive conserved quantities discussed in the context of the statistical mechanical approach to ECA [30, 31].

6

B. Matrix representation of the Koopman operator

Following Budisi´c, Mohr, and Mezi´c [4], we introduce 2N indicator functions, bq : M  {0, 1} for q = 1, ..., 2N , where



1 (if x = x(q)),

bq(x) =

(7)

0 (otherwise).

This gives a 'one-hot' representation of the system state x, namely, if x takes the qth state x(q),

only a single indicator function bq(x) among {b1(x), ..., b2N (x)} takes the value 1 and all the other indicator functions br(x) with r = q are 0.
The evolution of these indicator functions, which are also observables of the system, is expressed

as

2N

(K^ bq)(x) = bq(F (x)) = Aqrbr(x)

(8)

r=1

for q = 1, ..., 2N . Here, K^ is the Koopman operator and an adjacency matrix A  {0, 1}2N ×2N of

the system states is introduced, whose components are given by



1 (if the system evolves from state r to q),

Aqr =

(9)

0 (otherwise),

for q, r = 1, ..., 2N . This adjacency matrix A represents the state-transition network of the system

as illustrated in Fig. 2. For example, when the system state xn is in the pth state at time n, i.e., xn = x(p), we have bp(xn) = 1 and br(xn) = 0 for r = p. If this state evolves into qth state at time n + 1, i.e., if xn+1 = F (xn = x(p)) = x(q) and Aqp = 1, we have bq(xn+1) = 1 and br(xn+1) = 0 for r = q. It is noted that only a single component of each column of A takes 1 and all other

components are 0 because ECA are deterministic.

For a reversible system, we can obtain the inverse dynamics by reversing the directions of all

links in the state-transition network, which can be done because the map F is bijective. Therefore, the inverse of A is given by its transpose, i.e., A-1 = AT, where T represents matrix transposition,

namely,

2N

2N

(AAT)qs = AqrATrs = AqrA-rs1 = qs.

r=1

r=1

(10)

Since A is real, ATrs = Ars holds, where  indicates conjugate transpose. Therefore, A is a unitary

matrix.

7

The indicator functions form a basis of the space of observables [4]. A general observable G(x)

can be expressed by using the indicator functions as

2N

G(x) = gqbq(x),

(11)

q=1

where the coefficient gq  C represents the measurement outcome when x = x(q) (q = 1, ..., 2N ).

The evolution of this observable G is given by

2N

2N  2N



(K^ G)(x) = gq(K^ bq)(x) = gq  Aqrbr(x)

q=1

q=1

r=1

2N  2N



=  ATqrgr bq(x).

q=1 r=1

(12)

Therefore, the matrix representation of the evolution of the observable G is given by

 

 

g1

A1,1 · · · A2N ,1

g1

 K


...

 = 

...

...

  

...

 , 

(13)

 

 

g2N

A1,2N · · · A2N ,2N

g2N

where K represents the evolution of the vector of coefficients g = (g1, ..., g2N )T of the observable G. Namely, the transposed adjacency matrix AT gives a matrix representation K of the Koopman operator K^ , which we call the Koopman matrix in what follows.

By expressing the Koopman eigenfunction (x) associated with the eigenvalue  as

2N

(x) = qbq(x)

(14)

q=1

and plugging into the eigenvalue equation (5), we obtain the eigenvalue equation for the matrix K,

 

1

1

 K


...

  =  

...

 . 

(15)

 

2N

2N

By solving the above equation, we can obtain the set of Koopman eigenvalues and Koopman eigenvectors {, () = ((1), ..., (2N))T} and construct the Koopman eigenfunction () from the obtained Koopman eigenvector (). When the system is reversible, the Koopman matrix
K = AT is unitary because A is unitary as shown in Eq. (10), thus all eigenvalues of K are on the

unit circle in the complex plane. We note that the matrix K may not be diagonalizable and 2N independent eigenvectors sat-
isfying Eq. (15) may not be obtained. In such cases, to obtain a basis set of 2N independent

8

vectors, we also need to consider the generalized eigenvectors with rank m + 1  2, satisfying

(K - I)m+1(,m+1) = 0 and (K - I)m(,m) = 0 when the eigenvalue  is defective, where

I is an identity matrix. We can then construct the generalized Koopman eigenfunction of K^ in

the form (,m+1)(x) =

2N q=1

(q,m+1) bq (x),

satisfying

(K^

-

I^)m+1(,m+1)(x)

=

0

as

mentioned

previously.

Thus, we have derived a matrix representation of the Koopman operator and observables. We

note here that the state space of the system is lifted from the N -dimensional space of binary vectors

to a 2N -dimensional space of integer indices by the introduction of the one-hot representation. This

gives a linear representation of the system dynamics characterized by the adjacency matrix A in

Eq. (9) and the linear evolution of the observable characterized by the Koopman matrix K in

Eq. (13).

000 100 010 110 001 101 011 111 000 100 010 110
,
001 101 011 111

100

010

001

000

110

101

011

111 100

010

001

000

110

101

011 111

FIG. 3: Koopman matrix K and block-diagonalized K~ for rule 120.

C. Example: rule 120 with 3 cells

As a simple example, here we analyze rule 120 of ECA with 3 cells and periodic boundary conditions shown in Fig. 2. The matrix K in Fig. 3 shows the Koopman matrix K = AT of rule 120 obtained from the state-transition network in Fig. 2, where the matrix components with 0 are left blank and only those with 1 are shown. We can block-diagonalize K as





K~

=

KA 

0 

(16)

0 KB

by reordering the rows and columns as shown in Fig. 3, where KA  {0, 1}3×3 and KB  {0, 1}5×5. This is because the state-transition network can be divided into 2 independent connected components, i.e., subnetwork A consisting of states {2, 3, 5} and subnetwork B consisting of {1, 4, 6, 7, 8},

9

as shown in Fig. 2. As the time evolution of the states belonging to different subnetworks are independent, we can analyze each subnetwork separately.

1. Subnetwork A

Let us consider the subnetwork A in Fig 2. As shown in Fig 4(a), the system has three Koopman eigenvalues, i.e., 1 = 1, 2 = e2i/3, and 3 = e4i/3. These three eigenvalues on the unit circle in the complex plane correspond to the period-3 orbit, x = (1, 0, 0)(q = 2)  (0, 1, 0)(3)  (0, 0, 1)(5) in Fig. 2.

()

()

()

FIG. 4: Koopman eigenvalues of rule 120 with 3 cells and periodic boundary conditions. (a) Eigenvalues from subnetwork A. (b) Eigenvalues from subnetwork B. (c) All eigenvalues of the whole network.

In this case, the Koopman submatrix KA corresponding to subnetwork A is diagonalizable. We find a Koopman eigenvector of KA associated with 1 = 1,

A(1) = ((21), (31), (51))T = (1, 1, 1)T,

(17)

and also two other eigenvectors associated with 2 = e2i/3 and 3 = e4i/3,

A(2)

=

((22), (32), (52))T

=

2i 4i
(e 3 , e 3 ,

1)T,

(A3)

=

((23), (33), (53))T

=

4i
(e 3

,

e

2i 3

,

1)T

.

(18)

The set of these three vectors {(A1), (A2), (A3)} corresponds to the period-3 orbit in Fig. 2. As shown in Fig. 2, this subnetwork does not have any garden-of-Eden states.

2. Subnetwork B
For the subnetwork B in Fig. 2, we cannot diagonalize the corresponding Koopman submatrix KB. As shown in Fig 4(b), we obtain five Koopman eigenvalues, 4 = 1, 5,6,7,8 = 0 (algebraic
10

multiplicity 4), and the four associated rank-1 eigenvectors of KB

B(4) = ((14), (44), (64), (74), (84))T = (1, 1, 1, 1, 1)T, B(5) = ((15), (45), (65), (75), (85))T = (0, 1, 0, 0, 0)T, B(6) = ((16), (46), (66), (76), (86))T = (0, 0, 1, 0, 0)T, B(7) = ((17), (47), (67), (77), (87))T = (0, 0, 0, 1, 0)T,

(19)

and, additionally, one rank-2 generalized eigenvector

B(8) = ((18), (48), (68), (78), (88))T = (0, 0, 0, 0, 1)T.

(20)

The rank-1 eigenvector (B4) with the eigenvalue 4 = 1 corresponds to the stationary state x =

(0, 0, 0) (q = 1) and all other states in its basin, i.e., x = (1, 1, 0), (1, 0, 1), (0, 1, 1), and (1, 1, 1)

(q = 4, 6, 7, 8), and its components uniformly take a value 1 at all q  {1, 4, 6, 7, 8}. The three rank-1 eigenvectors {(B5), (B6), (B7)} associated with eigenvalues 5,6,7 = 0 correspond to the three garden-of-Eden states, i.e., x = (1, 1, 0), (1, 0, 1), (0, 1, 1) (q = 4, 6, 7), respectively, as can be seen from the locations of the component 1. The remaining rank-2 generalized eigenvector (B8) corresponds to the state x = (1, 1, 1) in the tree subnetwork, which connects the garden-of-Eden

states and the stationary state.

3. The whole network

From the analysis for the subnetworks A and B, the original Koopman matrix K has eight eigenvalues, 1,4 = 1 (multiplicity 2), 2 = e2i/3, 3 = e4i/3, 5,6,7,8 = 0 (multiplicity 4) and associated seven rank-1 eigenvectors

(1) = (0, (A1,)1, (A1,)2, 0, (A1,)3, 0, 0, 0)T = (0, 1, 1, 0, 1, 0, 0, 0)T,

(2)

=

(0,

(A2,)1,

(A2,)2,

0,

(A2,)3,

0,

0,

0)T

=

(0,

2i
e3

,

4i
e3

,

0,

1,

0,

0,

0)T,

(3)

=

(0,

(A3,)1,

(A3,)2,

0,

(A3,)3,

0,

0,

0)T

=

(0,

4i
e3

,

2i
e3

,

0,

1,

0,

0,

0)T.

(4) = ((B4,)1, 0, 0, (B4,)2, 0, (B4,)3, (B4,)4, (B4,)5)T = (1, 0, 0, 1, 0, 1, 1, 1)T,

(5) = ((B5,)1, 0, 0, (B5,)2, 0, (B5,)3, (B5,)4, (B5,)5)T = (0, 0, 0, 1, 0, 0, 0, 0)T,

(6) = ((B6,)1, 0, 0, (B6,)2, 0, (B6,)3, (B6,)4, (B6,)5)T = (0, 0, 0, 0, 0, 1, 0, 0)T,

(7) = ((B7,)1, 0, 0, (B7,)2, 0, (B7,)3, (B7,)4, (B7,)5)T = (0, 0, 0, 0, 0, 0, 1, 0)T,

(21)

and one rank-2 eigenvector

(8) = ((B8,)1, 0, 0, (B8,)2, 0, (B8,)3, (B8,)4, (B8,)5)T = (0, 0, 0, 0, 0, 0, 0, 1)T.

(22)

11

From the two Koopman eigenvectors with 1 = 1 and 4 = 1, we can construct the corresponding Koopman eigenfunctions, namely, two conserved quantities of the system. As can be seen from Fig. 2, each of these Koopman eigenvectors with the eigenvalue 1 represents a connected component of the state-transition network.
We can summarize the above finding as follows. (i) Each eigenvector associated with the eigenvalue 1 represents a connected component of the state-transition network, so the multiplicity of the eigenvalue 1 gives the number of connected components in the network. (ii) The eigenvalues reflect the period of the orbit embedded in each connected component. (iii) The multiplicity of the zero eigenvalue gives the number of states that are not included in the periodic or stationary state. (iv) If the system has no zero eigenvalue, the system has no garden-of-Eden state and is reversible. In the next section, we explicitly construct these representative Koopman eigenvectors and rationalize the above observations.
IV. EXPLICIT FORMS OF KOOPMAN EIGENFUNCTIONS
A. Eigenvalues and eigenvectors of the Koopman matrix
In Sec. III D, we have seen the Koopman eigenvalues and eigenvectors of rule 120 as an example. As explained in Sec. III B, for reversible ECA, the Koopman matrix is unitary and all Koopman eigenvalues are on the unit circle. For non-reversible ECA, Koopman eigenvalues 0 also arise inside the unit circle as we saw for rule 120.
In general, the Koopman eigenvalues of finite ECA are either on the unit circle (including 1) or 0. This can be explained as follows. The observable  associated with the eigenvalue  obeys (Kn)(x) = (F n(x)) = n(x). Therefore, if an eigenvalue  other than 0 exists inside the unit circle, i.e., 0 < || < 1, the associated observable takes infinitely long time steps to converge to the final periodic or stationary values. On the other hand, if an eigenvalue  with || > 1 exists outside the unit circle, the associated observable  diverges. However, both of these are not allowed in finite ECA.
In this section, we explicitly construct the Koopman eigenfunctions associated with these eigenvalues [33] and discuss their relationship with reversibility and the number of conserved quantities of the system.
12

B. Eigenvalue 0

For the indicator functions corresponding to the garden-of-Eden states, we have the following lemma.

Lemma 1. Assume that the system has a garden-of-Eden state x(u)  M with index u  {1, ..., 2N }. Then, the indicator function bu(x) is a Koopman eigenfunction with the eigenvalue 0, i.e.,

(K^ bu)(x) = bu(F (x)) = 0.

(23)

Proof. Because x(u) is a garden-of-Eden state, no state x evolves into x(u), i.e., F (x) = x(u) for all x  M , hence bu(F (x)) = 0 for all x  M .
The corresponding zero eigenvector of K takes the form  = (0, ..., 0, 1, 0, ..., 0)T, where only the uth component takes 1. This can also be seen from the state-transition network A; because no link directed to u exists, all components of the uth row of A and uth column of K = AT are zero, hence the above  yields a zero vector when we multiply K, i.e., K = 0.
If the system has k different garden-of-Eden states, the system has at least k zero Koopman eigenvalues. Therefore, if the system has no zero eigenvalue, the system has no garden-of-Eden state, i.e., the system is reversible.

The above lemma can be generalized to other indicator functions as follows.

Lemma 2. Assume that the system has a state x(q)  M with index q  {1, ..., 2N } that is not included in any of the periodic orbits (including stationary states). Then, the indicator function bq(x) is a generalized Koopman eigenfunction of rank m + 1 with the eigenvalue 0, i.e.,

(K^ m+1bq)(x) = bq(F m+1(x)) = 0,

(24)

where m  0 is the distance to the most distant garden-of-Eden state from x(q) in the same tree subnetwork as x(q). When x(q) is a garden-of-Eden state, m = 0.

Proof. The state x(q) belongs to a tree subnetwork whose root state is included in the periodic orbit and whose leaves are garden-of-Eden states (Sec.II B). Therefore, if the distance from x(q) to the most distant garden-of-Eden state in the same tree subnetwork is m, we have F m+1(x) = x(q) for all x  M , hence bq(F m+1(x)) = 0 for all x  M .

13

The corresponding vector,  = (0, ..., 0, 1, 0, ..., 0)T, where only the qth component takes 1, is a generalized zero eigenvector of rank m + 1 with the eigenvalue 0 of K, i.e., Km+1 = 0. The maximal rank of the generalized eigenfunction gives the maximum number of time steps required for the system to converge to the periodic orbit in a given connected component.

C. Eigenvalue 1

For the indicator functions corresponding to isolated stationary states, we have the following lemma.

Lemma 3. Assume that a state x(s)  M with index s  {1, ..., 2N } is an isolated stationary state of the system, i.e., F (x(s)) = x(s) and F (x) = x(s) for all x = x(s). Then, the indicator function bs(x) is a Koopman eigenfunction associated with the eigenvalue 1, i.e.,

(K^ bs)(x) = bs(F (x)) = bs(x).

(25)

Proof. If x = x(s), we have bs(x) = bs(F (x)) = 0. If x = x(s), we have bs(x) = bs(F (x)) = 1. Thus, the above eigenvalue equation holds for all x  M .

The corresponding Koopman eigenvector is given in the form  = (0, ..., 0, 1, 0, ..., 0)T, where only the sth component takes the value 1 and all other components vanish.

The above lemma can be generalized to connected components (subnetworks) of the statetransition network.

Lemma 4. Let S  M be a set of states in a connected component of the state-transition network and QS  {1, ..., 2N } the corresponding set of indices. Then, the observable

c(x) = bq(x)

(26)

qQS

is a Koopman eigenfunction associated with the eigenvalue 1, i.e.,

(K^ c)(x) = c(F (x)) = c(x).

(27)

Proof. If x  S, we have F (x)  S and c(x) = c(F (x)) = 1. If x / S, we have F (x) / S and c(x) = c(F (x)) = 0. Thus, the above eigenvalue equation holds for all x  M .
The vector components of the corresponding eigenvector  = (1, ..., 2N )T are given by q = 1 for q  QS and q = 0 for q / QS.

14

D. Eigenvalue on the unit circle

We can also construct the eigenfunctions corresponding to an isolated periodic orbit. Assume that the system has an isolated period-T orbit, represented as x(0)  x(1)  ...  x(T -1)  x(T ) = x(0). We denote the set of these states as  = {x(0), x(1), ..., x(T -1)} and the corresponding

indices as {0, 1, ..., T - 1}. The system states not included in  can never reach , i.e., F (x) / 

when x / . We consider an observable of the form

T -1

c(x) = cqbq(x),

(28)

q=0

where c0, ..., cT -1 are non-zero coefficients, and seek the condition that this c(x) is a Koopman eigenfunction with the eigenvalue , i.e., it satisfies the eigenvalue equation

K^ c(x) = c(x).

(29)

First, if x / , we have K^ c(x) = c(F (x)) = 0 and c(x) = 0, thus the eigenvalue equation (29) is satisfied irrespective of . Next, for x = x(j)   (j = 0, ..., T - 1), we have

T -1

c(x) = cqbq(x) = cj

(30)

q=0

and

T -1

K^ c(x) = c(F (x)) = cqbq(F (x)) = cj+1,

(31)

q=0

where we used F (x(j)) = x(j+1) and the index j + 1 should be considered in modulo T . Thus, to satisfy the eigenvalue equation (29), we need cj+1 = cj and hence cj = jc0. Because cj+T = cj, the eigenvalue  should satisfy T = 1. Assuming c0 = 1 without loss of generality, we obtain the following lemma.

Lemma 5. Let b0(x), ..., bT -1(x) denote the indicator functions corresponding to an isolated periodic orbit x(0)  ...  x(T -1)( x(0)). Then, the observable

T -1

c(x) = qbq(x)

(32)

q=0

is a Koopman eigenfunction with the eigenvalue  = exp(2ik/T ) (k = 0, 1, ..., T - 1).

Thus, for a period-T orbit, we can construct T independent eigenfunctions. In particular, when k = 0, we obtain  = 1 and c0 = c1 = ... = cT -1 = 1, which yields the Koopman eigenfunction with

15

the eigenvalue 1 discussed in Lemma 4 for the connected component of the state-transition network.

The above discussion can be generalized to a non-isolated periodic-T orbit as follows. As before, we denote by  = {x(0), x(1), ..., x(T -1)} the set of states included in the period-T orbit. We consider a connected component S = {x(0), x(1), ..., x(T -1), x(t1), x(t2), ..., x(tp)} of the statetransition network in which  is included, where t1, ..., tp are the indices of the states in S but not included in .

Lemma 6. Let S  M denote a connected component of the state-transition network including  and QS = {0, 1, ..., T - 1, t1, t2, ..., tp}  {1, ..., 2N } the corresponding set of state indices, where p is the number of states not included in . Then, the observable

c(x) =

-Dq bq(x),

(33)

qQS

where Dq is the distance from x(q) to x(0)   along a directed path of the state-transition network, is a Koopman eigenfunction with the eigenvalue  = exp(2ik/T ) (k = 0, 1, ..., T - 1).

Proof. If x / S, we have F (x) / S and c(x) = c(F (x)) = 0, so the eigenvalue equation (29) holds. If x  S, we have

c(x) =

-Dqbq(x) = -D,

(34)

qQS

where D is the distance from x to x(0), and

K^ c(x) =

-Dqbq(F (x)) = -D+1,

(35)

qQS

which follows from the fact that F (x) is one step closer to x(0) than x along the directed path and thus the distance from F (x) to x(0) is D - 1. Thus, the eigenvalue equation (29) is also satisfied. Now, if we consider x in , e.g., x = x(0), we have c(x(0)) = 1 = c(x(T )) = -T because of the

T -periodicity, hence the eigenvalue  should be  = exp(2ik/T ) (k = 0, 1, ..., T - 1).

Similar to the case of the isolated orbit, when the connected component has a period-T orbit, we can construct T independent eigenfunctions, now with non-zero components also on the states not included in the periodic orbit. Note that Lemma 5 is reproduced when the periodic orbit is isolated and  = S.

16

E. Number of independent eigenfunctions
Let us consider the total number of independent eigenfunctions constructed above. We focus on a single connected component of the state-transition network of size T + U , consisting of a period-T orbit (T states) and other states not included in the periodic orbit (U states). As mentioned in Sec.II B, a single connected component can include only a single periodic orbit, so any connected component of the network can be regarded as such. For the eigenvalue 0, we found that the indicator functions {bq(x)} of the states {q} not included in the periodic orbit are the (generalized) eigenfunctions, hence there are U independent eigenfunctions. On the other hand, for the T eigenvalues on the unit circle (including 1), we obtained T associated eigenfunctions which are mutually independent. Thus, we obtained T + U independent eigenfunctions for a single connected component of the network of size T + U , namely, we could obtain the complete set of eigenfunctions that span the space of observables defined in the connected component under consideration. In particular, only one eigenfunction with the form of Eq. (26) associated with the eigenvalue 1 exists for each connected component. The same argument applies to all other connected components and hence we can obtain the complete set of eigenfunctions to span the observables defined in the whole state-transition network. From the above results, the following theorems follow:
Theorem 1. The algebraic multiplicity of the eigenvalue 0 is equal to the number of system states that are not included in any periodic orbits. The system without eigenvalue 0 is reversible.
Theorem 2. Each connected component corresponds to a single eigenfunction with the eigenvalue 1. Thus, the multiplicity of the eigenvalue 1 gives the number of connected components in the whole state-transition network (and also the number of independent conserved quantities).
V. RESULTS FOR ECA WITH 13 CELLS
A. Setup
We now perform a thorough numerical analysis of all rules of ECA on a lattice of 13 cells with periodic boundary conditions. Since Wolfram's classification is for large systems, it is desirable to use a large number of cells for the numerical analysis. However, as the total number 2N of the system states grows exponentially fast with the number of cells N , numerical analysis of the Koopman matrix quickly becomes impossible. In what follows, we use a lattice of 13 cells
17

with periodic boundary conditions, where 13 was the largest prime number that could be used to calculate the eigenvalues of 213 × 213 matrices by a computer with 16GB memory. For each independent ECA rule, we constructed the state-transition network and the Koopman matrix, and numerically calculated all the Koopman eigenvalues.

Class I (Rule8)

Class II (Rule25)

Class III (Rule30)

Class IV (Rule54)

FIG. 5: Typical transition networks of the four classes in ECA with 10 cells and periodic boundary conditions.

B. Properties expected for the Koopman eigenvalues
Figure 5 shows typical state-transition networks for representative rules from Wolfram's four classes, i.e., rule 8 from class I, rule 25 from class II, rule 30 from class III, and rule 54 from class IV, for the case with N = 10 cells. We can observe that the network topology shows characteristic properties for each class. From the asymptotic dynamical property of each class, the following properties for the Koopman eigenvalues are expected (zero eigenvalue does not arise in reversible ECA).
· Class I: As the system converges to a homogeneous stationary state, the Koopman eigenvalues take either 0 (with large multiplicity) or 1 (with small multiplicity).
· Class II: As the system converges to a periodic orbit with a relatively short period, the Koopman eigenvalues take T values, exp(2ik/T ) where T is the period and k = 0, 1, ..., T -1, on the unit circle. Because orbits with various periods can coexist, the overall distribution of eigenvalues on the unit circle may not be even. Eigenvalues 0 with large multiplicity also arise.
· Class III and class IV: The system exhibits chaotic or complex dynamics. The orbits are still periodic, but their periods are typically much longer than the cases in class II. Thus, a large
18

number of Koopman eigenvalues distribute on the unit circle, typically unevenly because orbits with different periods coexist. Eigenvalues 0 with large multiplicity also arise.
Figure 6 shows the Koopman eigenvalues in the complex plane for all 256 (88 independent) rules of ECA with 13 cells and periodic boundary conditions. In the caption of each figure, Wolfram's class (I to IV) and the multiplicities of the eigenvalues 0 and 1 are shown. The eigenvalue 1 corresponds to either a periodic or stationary state, hence the number of stationary states is also shown. The rules {15, 85}, 51, 204, {154, 166, 180, 210}, {170, 240}, {45, 75, 89, 101}, 105, and 150 do not possess zero eigenvalues and are reversible. These results coincide with the results obtained for systems of arbitrary sizes by de Brujin graph analysis [32].
We can observe that the distributions of the Koopman eigenvalues roughly follow our expectations above, but there are also some exceptions. This is because the Koopman matrix has the whole information of the system dynamics, including non-typical ones, while Wolfram's classification is for typical dynamics of the system, and also because of the small system size used in the numerical analysis. In the following subsections, we describe qualitative properties of the typical dynamics and eigenvalue distributions for each class.
C. Class I
As shown in Fig. 6, for most of the rules, the Koopman eigenvalues are either 1 (multiplicity 1 or 2) or 0 (large multiplicity), as expected. For the rules 40, 168, and their equivalents, the Koopman eigenvalues take 13 values on the unit circle including 1, in addition to 0. Indeed, these rules have non-typical traveling-wave states, corresponding to period-13 orbits, in addition to the typical homogeneous stationary state. Figure 7 shows the dynamics and eigenvalues for rules 8 and 168 from class I, including a non-typical traveling-wave state of rule 168.
D. Class II
As shown in Fig. 6, for most of the rules, the Koopman eigenvalues evenly distribute on the unit circle (including 1) or 0. In contrast to the case of class I, the multiplicity of the eigenvalue 1 can be relatively large. The number of eigenvalues on the unit circle is typically up to 13 and at most 104. Figure 8 shows typical dynamics and eigenvalues obtained for four rules from class II, which are briefly described below.
a) Stationary states. The system converges to a spatially inhomogeneous stationary state
19

[A] B,C,D,E

[0,255] I,8191,1,1

[8,64,239,253] I,8191,1,1

[32,251] I,8191,1,1

[40,96,235,249] I,8152,4,1

[128,254] I,8190,2,2

[136,192,238,252] I,8190,2,2

[160,250] I,8190,2,2

[168,224,234,248] I,7670,42,2

[1,127] II,7670,261,0

[2,16,191,247] II,8048,12,1

[3,17,63,119] II,6695,60,0

[4,223] II,7671,521,521

[5,95] II,6695,768,39

[6,20,159,215] II,7905,12,1

[7,21,31,87] II,7943,11,0

[9,65,111,125] II,8112,4,0

[10,80,175,245] II,7671,41,1

[11,47,81,117] II,7657,22,0

[12,68,207,221] II,7671,521,521

[13,69,79,93] II,8151,40,39

[14,84,143,213] II,7606,26,1

[15,85] II,0,316,0

[19,55] II,7670,261,0

[23] II,7670,261,0

[24,66,189,231] II,8048,12,1

[25,61,67,103] II,7943,9,0

[26,82,167,181] II,6488,27,1

[27,39,53,83] II,6695,60,0

[28,70,157,199] II,7957,118,1

[29,71] II,5434,1379,0

[33,123] II,7670,261,0

[34,48,187,243] II,7671,41,1

[35,49,59,115] II,6656,63,0

[36,219] II,8048,144,144

[37,91] II,8060,66,0

[38,52,155,211] [42,112,171,241]

II,7229,38,1

II,5435,213,1

[43,113] II,7150,61,0

[44,100,203,217] [46,116,139,209]

II,8048,144,144

II,8048,12,1

[50,179] II,7671,261,1

[51] II,0,4096,0

[56,98,185,227] II,7632,44,1

[57,99] II,8112,7,0

[58,114,163,177] [62,118,131,145]

[72,237]

II,8061,8,1

II,7554,187,1 II,8048,144,144

[73,109] II,7176,209,13

[74,88,173,229]

[76,205]

[77]

[78,92,141,197]

II,7645,26,1 II,5435,2757,2757 II,7670,521,520 II,8152,40,40

[94,133] II,7788,209,40

[104,233] II,8126,66,66

[108,201]

[130,144,190,246] [132,222]

[134,148,158,214] [138,174,208,224] [140,196,206,220]

II,6371,1171,521 II,8047,13,2

II,7670,522,522

II,7904,13,2

II,6695,117,2 II,7670,522,522

[142,212] II,7150,62,2

[152,188,194,230] [154,166,180,210]

II,8047,13,2

II,0,156,2

[156,198] II,7956,119,2

[162,176,186,242] [164,218]

II,7670,42,2

II,8047,145,145

[170,240] II,0,632,2

[172,202,216,228] II,7904,156,145

[178] II,7670,262,2

[184,226] II,7150,82,2

[200,236]

[204]

II,6695,1497,1497 II,0,8192,8192

[232] II,7670,522,522

[18,183] III,7905,29,1

[22,151] III,8126,14,1

[30,86,135,149] III,6761,5,1

[45,75,89,101] III,0,24,0

[60,102,153,195] III,4096,6,1

[90,165] III,4096,66,1

[105] III,0,196,0

[122,161] III,7905,29,1

[126,129] III,7905,29,1

[146,182] III,7904,30,2

[150] III,0,392,2

[41,97,107,121] IV,7969,7,0

[54,147] IV,7697,42,1

[106,120,169,225] [110,124,137,193]

IV,6553,46,1

IV,7840,2,1

FIG. 6: Koopman eigenvalues for all 256 rules of 13-cell ECA. Caption below each graph shows the set of equivalent rules, class, and multiplicities of the 1 and 0 eigenvalues.

20

as shown in Fig. 8(a) for rule 4, yielding Koopman eigenvalues 0 and 1. As the system can possess many different stationary inhomogeneous states (as well as periodic orbits), the multiplicity of the eigenvalue 1 can be relatively large.
b) Oscillatory states. The system exhibits periodic oscillations of relatively short periods as shown in Fig. 8(b) for rule 5, yielding Koopman eigenvalues 0 and on the unit circle. As the system can possess many different periodic orbits (as well as stationary states), the multiplicity of the eigenvalue 1 can be relatively large.
c) Traveling-wave states. The system's pattern translates to either of the directions without changing the shape as shown in Fig. 8(c), which corresponds to a period-13 state. The Koopman eigenvalues take 13 values on the unit circle in addition to 0.
d) Oscillatory-traveling states. The system exhibits a mixture of traveling and oscillating patterns as shown in Fig. 8(d) for rule 26, which travels to either of the directions while oscillating at the same time. The periods are between 26 and 104. Relatively many eigenvalues arise on the unit circle (the maximum number of different Koopman eigenvalues on the unit circle is 104 for rules 26, 154, and the equivalents).

(a-1)

(b-1)

(b-1')

(a-2)

(b-2)

FIG. 7: Dynamics and Koopman eigenvalues of class I rules. (a) Rule 8. (b) Rule 168. Results for typical homogeneous stationary states and for a non-typical traveling-wave state are shown.
21

(a-1)

(b-1)

(c-1)

(d-1)

(a-2)

(b-2)

(c-2)

(d-2)

FIG. 8: Dynamics and Koopman eigenvalues of class II rules. (a) Rule 4. (b) Rule 5. (c) Rule 184. (d) Rule 26.
E. Class III and Class IV
As shown in Fig. 6, in most of the rules, at least 13 eigenvalues appear on the unit circle. In many rules, relatively many periodic orbits with different periods coexist, resulting in a large number of eigenvalues distributed on the unit circle. In some rules, small number (e.g., 5 for rule 22) of eigenvalues appear on the unit circle, despite being in class III. This corresponds to relatively short-period oscillatory states, which can arise in small systems; in larger systems, the same rules can exhibit chaotic dynamics. Figure 9 shows the dynamics and eigenvalues for rules 30 and 54 from class III and IV, respectively. In these rules, the system exhibits complex patterns, which are periodic but with very large periods. Thus, a large number of eigenvalues arise on the unit circle.
VI. SUMMARY
We performed a Koopman spectral analysis of ECA. By introducing the one-hot representation, we derived a matrix representation of the Koopman operator. We showed that the Koopman eigenvalues are either zero or distributed on the unit circle (including 1), and constructed the associated Koopman eigenfunctions. We then numerically calculated the Koopman eigenvalues of all 88 independent rules for ECA with 13 cells and periodic boundary conditions. We found that the distributions of the Koopman eigenvalues roughly correspond to Wolfram's classification, but there were also some exceptions.
22

(a-1)

(b-1)

(a-2)

(b-2)

FIG. 9: Dynamics and Koopman eigenvalues for class III and IV rules. (a) Rule 30, class III. (b) Rule 54, class IV.
The Koopman eigenvalues and their multiplicities reflect the topology of the state-transition network. The eigenvalues on the unit circle reflect the periods of the orbits embedded in the individual connected components. The multiplicity of zero eigenvalues represent the number of states that are not included in any of the periodic orbits, and the reversibility of each rule can be judged from the non-existence of the eigenvalue 0. The Koopman eigenfunctions with the eigenvalue 1 correspond to individual connected components of the state-transition network, and the multiplicity of the eigenvalue 1 gives the number of connected components in the state-transition network and also the number of independent conserved quantities of the system.
Though the discussion on the Koopman eigenvalues and eigenvectors presented in Sec. IV is general, the number of cells that we could use for the numerical analysis was restricted to small systems (13-cell ECA in this study). It is difficult to increase this number largely in the present straightforward approach because the size of the Koopman matrix for N -cell ECA is 2N × 2N and rapidly increases with N . As an alternative, it is well known that the DMD methods can estimate the Koopman eigenvalues using time-series data from ECA and can be applied to large systems. However, in our preliminary calculations, some of the DMD methods, including the Hankel DMD, did not always reproduce all of the Koopman eigenvalues correctly, in particular for the dynamics with very long periods in class III and class IV. We will report the results of systematic numerical investigations on the DMD analysis of ECA in our subsequent paper.
23

Acknowledgments
We acknowledge JSPS KAKENHI JP17H03279, JP18H03287, JPJSBP120202201, JP20J13778, and JST CREST JP-MJCR1913 for financial support.
[1] B. O. Koopman, Proceedings of the national academy of sciences of the united states of america 17, 315 (1931).
[2] J. von Neumann, Annals of Mathematics 33, 587 (1932). [3] I. Mezi´c, Nonlinear Dynamics 41, 309 (2005). [4] M. Budisi´c, R. Mohr, and I. Mezi´c, Chaos: An Interdisciplinary Journal of Nonlinear Science 22, 047510
(2012). [5] A. Mauroy, Y. Susuki, and I. Mezi´c, The Koopman operator in systems and control (2020). [6] J. N. Kutz, S. L. Brunton, B. W. Brunton, and J. L. Proctor,
Dynamic mode decomposition: data-driven modeling of complex systems (SIAM, 2016). [7] E. M. Bollt, Q. Li, F. Dietrich, and I. Kevrekidis, SIAM Journal on Applied Dynamical Systems 17,
1925 (2018). [8] J. Nathan Kutz, J. L. Proctor, and S. L. Brunton, Complexity 2018 (2018). [9] J. Page and R. R. Kerswell, Physical Review Fluids 3, 071901 (2018). [10] H. Nakao and I. Mezi´c, Chaos: An Interdisciplinary Journal of Nonlinear Science 30, 113131 (2020). [11] J. P. Parker and J. Page, SIAM Journal on Applied Dynamical Systems 19, 2803 (2020). [12] E. F. Moore, in Proceedings of symposia in applied mathematics (American Mathematical Society New
York, 1962), vol. 14, pp. 17­33. [13] S. Wolfram, Reviews of Modern Physics 55, 601 (1983). [14] S. Wolfram, A new kind of science, vol. 5 (Wolfram media, Champaign, IL, 2002). [15] G. J. Martinez, Journal of Cellular Automata 8 (2013). [16] S. Coombes, Nottingham: Department of Mathematical Sciences, University of Nottingham (2009). [17] K. Nishinari and D. Takahashi, Journal of Physics A: Mathematical and General 31, 5439 (1998). [18] J. Kari, Theoretical computer science 334, 3 (2005). [19] S. Ohmori and Y. Yamazaki, Journal of the Physical Society of Japan 88, 105001 (2019). [20] P. J. Schmid, Journal of Fluid Mechanics 656, 5 (2010). [21] C. W. Rowley, I. Mezi´c, S. Bagheri, P. Schlatter, D. Henningson, et al., Journal of Fluid Mechanics
641, 115 (2009). [22] J. H. Tu, C. W. Rowley, D. M. Luchtenburg, S. L. Brunton, and J. N. Kutz, Journal of Computational
Dynamics 1, 391 (2014). [23] Y. Kawahara, Advances in neural information processing systems 29, 911 (2016).
24

[24] M. Korda, M. Putinar, and I. Mezi´c, Applied and Computational Harmonic Analysis 48, 599 (2020). [25] N. Takeishi, Y. Kawahara, and T. Yairi, Advances in Neural Information Processing Systems 30, 1130
(2017). [26] T. Tokihiro, D. Takahashi, J. Matsukidaira, and J. Satsuma, Physical Review Letters 76, 3247 (1996). [27] W. Li and N. Packard, Complex Systems 4 (1990). [28] P. Grassberger, Journal of Statistical Physics 45, 27 (1986). [29] F. Bagnoli, R. Rechtman, and S. Ruffo, Physics Letters A 172, 34 (1992). [30] S. Takesue, Physical Review Letters 59, 2499 (1987). [31] T. Hattori and S. Takesue, Physica D: Nonlinear Phenomena 49, 295 (1991). [32] A. Nobe and F. Yura, Journal of Physics A: Mathematical and General 37 (2004). [33] Though we focus on the Koopman matrix K in this study, we can also obtain the eigenvalues of the
adjacency matrix A and construct its eigenvectors in a similar way to the case of the Koopman matrix.
25

