arXiv:2106.00964v1 [math.AP] 2 Jun 2021

OCEAN-DEPTH MEASUREMENT USING SHALLOW-WATER WAVE MODELS
V VASAN, MANISHA, AND D AUROUX
Abstract. In this paper, we consider a problem inspired by the real-world need to identify the topographical features of ocean basins. Specifically we consider the problem of estimating the bottom impermeable boundary to an inviscid, incompressible, irrotational fluid from measurements of the free-surface deviation alone, within the context of dispersive shallow-water wave models. The need to consider the shallow-water regime arises from the ill-posed nature of the problem and is motivated by prior work. We design an algorithm using which, both fluid velocities and the bottom-boundary profile, may be accurately recovered assuming an a priori relatively inaccurate guess for the bottom boundary. We achieve this by considering two separate inverse problems: one to deduce the bottom-boundary from velocities and the surface deviation, and another to recover the velocities from the surface deviation and an approximate bottom-boundary. The former is a classic inverse problem that requires the inversion of an ill-conditioned matrix while the latter employs the observer framework. Combining the two inverse problems leads to our reconstruction algorithm. We emphasise the role played by model selection and its impact on algorithm design and the accuracy of the reconstruction.
Keywords. Bathymetry, water waves, inverse problem, observers, dispersive equations.
1. Introduction. The bottom of the ocean is as varied and diverse as the land above, replete with valleys, cliffs, seamounts and plateaus that are formed by a variety of geological processes [15]. The precise shape of the bottom boundary determines ocean circulation and mixing which impacts Earth's climate [40] and the bio-diversity of the seas [39]. Near-shore bathymetry is vital for the management of coastlines [31] and to predict tsunami inundation [44, 53]. Determining the shape of the oceanic bottom boundary is not only of utmost importance, but also one of the most challenging oceanography problems both theoretically and practically. A common method to determine the bottom topography is via underwater acoustics using echo sounders [19, 50]. However this method is slow, expensive and dangerous while leaving much of the shallow continental margin areas undersurveyed. Hence more modern approaches using satellite-gravity models that infer topography from deviations in the gravitational field have been promoted [9]. These methods work on the principle that the additional mass due to a seamount increases the strength of the local gravitational field causing a bulge in the surface height of the water directly above [48]. Despite the success of satellitegravity based bathymetry [49], recent work suggests shipboard data is more reliable to detect sharp relief features with characteristic length-scales less than 25km [52].
An alternative approach employs fluid dynamical principles to model the motion of an incompressible fluid, bounded below by a solid impermeable surface. With the rise in availability and quality of satellite imagery, fluid dynamical methods for ocean-depth measurement offer a way to survey large parts of the coastlines and oceans. The simplest of the fluid-mechanical methods consider variations in the dispersion relation of shoaling waves [47] and nonlinear corrections to these formulae [32]. All fluid dynamical methods are ultimately based on an analysis of the kinematic boundary condition at the free surface
t = w - u¯s · ,
(VV & M) International Centre for Theoretical Sciences, Tata Institute of Fundamental Research, India (DA) Universite´ Co^ te d'Azur, CNRS, Laboratoire J.A. Dieudonne´, France E-mail addresses: vishal.vasan@icts.res.in.
1

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

2

where w and u¯s are the vertical and horizontal velocities evaluated at the free surface . The free surface  and the surface velocities (w, u¯s) are functionally dependent on the bottom boundary via the full equations of motion and associated boundary conditions.
In the context of fully non-hydrostatic irrotational flow the kinematic boundary condition may be rewritten in terms of a surface potential q

t = G(, )q,

(1)

where G is the Dirichlet-Neumann operator (defined in Section 2) which, loosely speaking, maps the tangential fluid-velocity at the free surface to the normal fluid-velocity. This operator depends on the shape of the bottom-boundary profile . In [46] the authors considered the problem of estimating G (and hence inferring ) from frequencies and profiles of standing waves. Despite the ill-posed nature of the problem they were successful in determining the bottom-boundary from this information. On the other hand, Fontelos et al. [30] assumed knowledge of , t, q at one instance of time and proved that there was a unique  that satisfied (1). Moreover they proved that the solution to a minimisation problem allowed one to recover this bottom profile. Here too the authors noted the ill-posed nature of the problem which implies the reconstruction procedure is highly sensitive to noise in the input data.
The defining property of the bottom-boundary is that the fluid-velocity normal to that surface vanishes. By employing a harmonic continuation argument, Vasan & Deconinck [51] wrote a nonlinear nonlocal equation which vanished at the true bottom-boundary. However this equation depended on the surface velocities. Although satellite measurements can infer both sea-surface deviations and sea-surface velocities, often the determination of the velocities requires an estimate of the bottom boundary [18, 36]. As a result, determining the surface velocities as part of the bottomboundary reconstruction, or at least assuming some characterisation of these velocities, seems inevitable.
Equation (1) is only half the story. For a complete description of the fluid motion one must account for the momentum balance which, in the context of inviscid, irrotational, incompressible fluid flow, determines the time evolution of the surface potential q. Vasan & Deconinck [51] used this equation for q and the fact that the bottom-boundary was stationary in time to deduce a second nonlocal nonlinear equation, hence obtaining two equations for two unknowns: the bottom-boundary and the surface velocities. They were able to show reconstruction was possible based purely on surface data, i.e. measurements of the surface deviation alone. Additionally they did not require a priori knowledge of the mean depth. The authors noted the ill-posed nature of the problem and argued the reconstruction was more reliable in the shallow-water regime.
The Saint-Venant equations are a specific model for shallow-water waves widely used in modelling inundation of coastal regions. Upon averaging the incompressibility condition in the vertical and taking into account the kinematic boundary condition, one obtains

t +  · (( + h + ) u¯) = 0,

where ( + h + ) represents the height of the fluid column and u¯ is the depth-averaged horizontal velocity. Through a judicious choice of scaling, some time-averaging of the data and a knowledge of the mean-depth, the authors of [37] considered the above equation as a hyperbolic PDE for the bottom-boundary profile with known coefficients. They assumed surface deviation and surface velocities were given by satellites and employed a small Rossby number parameter regime to determine the ageostrophic component of the velocity field. However the necessity of a non-zero Coriolis parameter limits the utility of this method for fully non-hydrostatic coastal regions. Although the fluid dynamical models considered thus far all involved long length-scales and inviscid flow, domain identification is not limited to such scenarios. Indeed one can pose the problem in the context of creeping flows [34].
Our approach closely follows the work of [30, 51] but we view the problem, from the outset, in the shallow-water regime. Specifically we derive the shallow-water analogue of the equations in [30, 51]. The idea to consider the shallow-water re-formulation was inspired by a conversation

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

3

between Harvey Segur and one of the authors, several years ago. While VV attempted to describe the ill-posed nature of the problem, Harvey remarked the problem would `perhaps be easier, if one could find the right way to look at it' and suggested VV look for the `right box' for the problem. Though mysterious at the time, happily the current work is the result of understanding the insight in that stray comment.
One of the motivations of the present work is to discern whether the reconstruction is better behaved in the shallow-water regime and if reconstruction is possible over a wide range of values for the shallowness parameter. Additionally we seek to recover the bottom profile from measurements of the surface deviation  alone. Similar to [51] we only assume the velocities are consistent with the shallow-water wave model and obtain the velocities as a by-product of our reconstruction. Unlike the shallow-water reconstruction method of [37], we only consider shallow-water wave models that are dispersive. Not only do dispersive PDEs offer some mathematical advantages over their nondispersive counterparts in terms of smoothing and regularity, there are theoretical and experimental arguments that substantiate the need to take into account dispersion and the strong non-hydrostatic effects induced by varying bottom-boundaries [24, 25, 33] even in the case of depth-averaged models [16].
The outline of the paper is as follows. In Section 2 we sketch a derivation for a class of bidirectional dispersive Boussinesq-type shallow-water wave models with varying bottom-boundaries. We focus our efforts on two such models, one of which is known in the literature and another which is, to our knowledge, novel. Following this, in Section 3 we describe the first of our inverse problems: the reconstruction of the bottom-boundary profile from surface data. In this section and the remainder of the paper, we consider the reconstruction of two specific bottom-boundary profiles representing non-isolated and isolated topographic features (see also Figure 1)

Profile 1 :  = -0.12 sin(3x) cos(2x) sin(10x) + 0.05 sin(4x),

(2)

Profile 2 :  = -0.1e-100(x-x1)2 -0.05e-2(x-x2)2 - 0.2e-100(x-x3)2 ,

(3)

x1 = 3/4, x2 =1.12x1, x3 = 5/4.

Then in Section 4 we employ the observer framework [43] to determine the velocity of the fluid given the surface deviation, when the bottom-boundary profile is known. The observer framework is popular in the geophysics community and is routinely used in data assimilation to recover the state of a dynamical system from partial or sparse measurements [3­5, 8]. We then combine the two inverse problems in Section 5 to design our algorithm for bottom-boundary reconstruction from surface-deviation measurements alone. We do not require the mean-depth to be known and additionally we are able to reconstruct bottom profiles in deeper water than in [51] (though still in the shallow regime). Finally we summarise our method and describe possible extensions of the present work in Section 6.
Two key theoretical points are not discussed in the present work but nonetheless warrant attention. Firstly, one would like to know to whether the shallow-water models we consider actually model or simulate the dynamics of the full water-wave problem. For one of our models, this is already known in the literature [27]. The other model bears a close resemblance to known Boussinesq-type equations and we conjecture the ideas of [11, 41] may be adapted to obtain the required theorem. Secondly, one would like to know whether the recovered bottom-boundary in the shallow-water regime is close to the bottom-boundary obtained from the associated inverse problem for the full water-wave equations, such as what [30] consider. Essentially this boils down to showing the approximate DNO one employs in the shallow-water model approximates the DNO of the full water-wave problem. Though we do not have rigorous statements for the models in consideration, we note results of this type are available for a variety of long-wave models [42]. We hope the success of our reconstruction algorithm spurs interest in these theoretical questions too.

2. Shallow-water wave equations. Starting from the continuum description of fluid flow, the equations governing the motion of an inviscid incompressible irrotational constant-density fluid are given

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

4

0.7

0.8

z

0.9 1.0

1.1

1.2

0

1

2

3x 4

5

6

(a) Profile 1

0.7

0.8

z

0.9 1.0

1.1

1.2

0

1

2

3x

4

5

6

(b) Profile 2

Figure 1. Two different bottom-boundary profiles. Note the scale in vertical and horizontal directions is not the same. See equations (2-3) for the exact form of the boundary profiles.

by

xx + zz = 0,

- h - (x) < z < (x, t), 0 < x < L, (4)

z + xx = 0,

z = -h - (x),

(5)

t = z - xx,

z = (x, t),

(6)

t

+

1 2

x2 + z2

+ g = 0,

z = (x, t).

(7)

Here  represents the velocity potential (and hence the fluid velocity is given by the gradient of ), (x, t) represents the free surface deviation, (x) is the shape of the bottom boundary, h is a typical depth, L is the lateral extent of the fluid and g is the acceleration due to gravity. The equations above are supplemented with periodic boundary conditions in the x-variable. Though we state the equations for a fluid with only one horizontal variable, the equations may just as easily be written for the more realistic scenario with two horizontal dimensions. To simplify our discussion, we restrict ourselves to the equations as specified above.
As noted by [23, 55], equations (4-7) have an equivalent Hamiltonian description

t

=

H q

,

qt = - H , 

(8)

where the Hamiltonian is given, in terms of the surface deviation  and the Dirichlet-trace of the velocity potential at the surface q(x, t) = (x, , t), by

H

=

1 2

qG(, )q + g2 dx.

Here G(, ) is the Dirichlet-Neumann operator (DNO) that maps the Dirichlet condition of the

following boundary-value problem

xx + zz = 0,

-h - (x) < z < (x, t), 0 < x < L,

(9)

z + xx = 0,

z = -h - (x),

(10)

 = q(x, t), z = (x, t),

(11)

to the associated Neumann condition at the surface z = (x, t). Thus

G(, )q = z - xx, z = (x, t).

For the problem posed on the whole line, for any k0 > 1/2, if ,  are elements of the (realvalued) Hilbert space Hk0+1(R), at each time t, such that there exists a constant h0 > 0, (x, t) +
h + (x)  h0, then the Dirichlet-Neumann operator is a bounded linear operator defined as G(, ) : H 3/2(R)  H1/2(R) [42] where H 3/2(R) is a Beppo-Levi space [26]. Moreover G(, )
has a self-adjoint realisation on L2(R) with domain H1(R) (see Section 3.1 of [42]). On the other hand, if (x, t) = ~ f (x, t) and (x) = ~g(x) where f , g are real-analytic functions of x (for every t),

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

5

then G(, ) is analytic in ~, ~ i.e. G has a convergent Taylor-series operator-expansion when q is also real-analytic in x (for every t) [45].
We emphasise two points. Firstly, equations (8) imply the dynamically relevant quantities are those defined on the boundary: the shape of the free surface  and the value of the potential at the surface q(x, t) = (x, , t). Secondly, although the equations look like a standard partial differential equation, we note that G(, ) is not a local operator.
We now describe the formal procedure to derive models whose solutions approximate the full fluid motion. The overall methodology we follow was introduced in [10] and employed in [12­14] to deduce model water-wave equations. Model equations using approximate Hamiltonians were also employed by [20] though we consider varying bottom topography. Essentially one replaces the DNO G(, ) by a simpler operator GM(, ) (which we refer to as a model DNO). Note we do not obtain effective equations via a homogenisation theory as described in [21, 22].
One way of constructing approximations to the DNO is due to [1] where they characterise the DNO in terms of the following equations

eikx {iG(, )q cosh(k( + h)) + qx sinh(k( + h)) + Qx sinh(k)} dx = 0,

(12)

eikx {iG(, )q sinh(k( + h)) + qx cosh(k( + h)) - Qx cosh(k)} dx = 0.

(13)

Here Qx is the velocity tangential to the fluid domain at the bottom z = -h - : Qx = x - xz evaluated at the bottom boundary. We assume that  /h is small. Given qx, one solves the above equations simultaneously for both G(, )q and Qx. Note also that we do not assume the mean of  is zero. In this case, h can be thought of as an estimate for the bottom topography rather than the actual mean bottom surface.
Within the shallow-water regime, the aspect ratio h/L is assumed to be a small parameter. Suppose further that both

 ,   

h2 .

h

h

L

Then we have the following O( (h/L)4) accurate expansion for the hyperbolic functions

cosh(k(

+

h))

=

1

+

(kh)2 2

+

.

.

.

,

(14)

sinh(k(

+

h))

=

kh

+

k

+

k3h3 6

+

.

.

.

,

(15)

cosh(k) = 1 + . . . ,

(16)

sinh(k) = k + . . . .

(17)

Using these expansions in the global relations (12) we obtain

eikx

1

+

(kh)2 2

iG(, )q + qx

kh

+

k

+

k3h3 6

+ Qxk

dx = h.o.t.'s ,

(18)

eikx

kh

+

k

+

k3h3 6

iG(, )q + qx

1 + (kh)2 2

- Qx

dx = h.o.t.'s .

(19)

The higher order terms in the above expressions involve terms of O( (h/L)4) and higher. To obtain an expression for the DNO to similar order, we need only obtain an expression for Qx which is O(1) accurate. This is readily obtained from the second of the above equations: Qx = qx which is consistent with our shallow-water approximation. This leads to the following expression for a model DNO with variable bottom-boundary

1

-

h2 2

2x

GM(,

)q

=

-hqxx

+

h3 6 qxxxx

-

x[(

+

)qx].

(20)

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

6

Note however that the model DNO given above is not formally self-adjoint. Indeed on solving for GM explicitly we have

GM(, )q = -

1

-

h2 2

2x

-1

h

-

h3 6

2x

qxx -

1

-

h2 2

2x

-1
x[( + )qx],

(21)

which, due to the last term on the right-hand side, is not a self-adjoint operator. To the same level of asymptotic accuracy one could consider the alternate operator

GM(, )q = -

1

-

h2 2

2x

-1

h

-

h3 6

2x

qxx - x[( + )qx],

(22)

which is a formally self-adjoint operator acting on q. With the model DNO GM defined as above, we construct a Hamiltonian system

t

=

HM q

qt = - HM , 

HM = 1 2

qGM(, )q + 2 dx.

(23)

This gives rise to an equation which is essentially the same Boussinesq-type equation derived by [1], albeit with a non-trivial bottom boundary. However, we prefer to work with a regularised version of this Boussinesq equation which has the same level of formal asymptotic accuracy

t = 2(-ix)q - P(-ix)x [( + )P(-ix)qx] ,

(24)

qt

=

-

-

1 2

(P (-ix)qx)2

,

(25)

where

2(k)

=

1+ 1+

(µk)2 6
(µk)2 2

k2,

P (k)

=

1

1

+

(µk)2 2

,

µ

=

2 L

h

,

(26)

and we have also nondimensionalised the equations with a horizontal length-scale L/(2); a scale h
for both , ; a scale gh for qx and chosen the longer time-scale L/(2 gh). The factors of 2 are for convenience so that our wavenumbers are integers. With this scaling, the only non-dimensional parameter is the aspect ratio µ. Equations (24-25) are Hamiltonian with canonical Poisson structure with the Hamiltonian given by

H,P = 1 2

q2(-ix)q + ( + )(P qx)2 + 2 dx.

(27)

Note if we make a further substitution 2 = k2 + O(µ2) and P = 1 + O(µ2) we obtain a different Hamiltonian system: the hydrostatic shallow-water equations in one horizontal dimension. Various choices for the pseudo-differential operators 2, P can lead to the non-trivial bottom-boundary versions of the ASMP model [2] or a Hamiltonian version of the Hur-Pandey model [35]. All these

models are different types of bidirectional Whitham equations. For a comparison of different such

models see [28].

For the remainder of this paper, we concern ourselves with only two specific shallow-water wave

models, both given by equations (24-25). The first we refer to as regularised Boussinesq and is given

by the choice (26). The second model equation is given by the choice

2(k) = k tanh(µk) , µ

P (k)

=

tanh(µk) µk

,

µ

=

2h L

,

(28)

which leads to the equation considered by [27] which we refer to as regularised Boussinesq-Whitham (which is also the Hamiltonian version of the Hur-Pandey model). Note from here on, for the sake of notational convenience we will suppress the argument of 2 and P, with the understanding that they are suitably interpreted either as an operator acting on functions of the real variable x or a multiplier acting on Fourier transforms of functions.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

7

Remark 1. The equations considered in [17] are essentially a generalised version of (24-25) which include a boundary operator in the place of . The shallow-water wave models described in the current work involve shallow-water approximations to the boundary operator employed in [17].
Remark 2. To make sense of the pseudo-differential operators we restrict ourselves only to the problem with periodic boundary conditions. In a sense, this assumption was adopted when we claimed the Hamiltonian formulation of the full water-wave problem. A suitable phase space needs to be chosen before taking a variational derivative. The extension of the current work and equations such as (24-25) to non-periodic domains is interesting but will be left for future works.
Remark 3. The regularised Boussinesq-Whitham equations with trivial bottom-boundary was considered in [27] where they showed local and global wellposedness. Their equations are slightly different from those given here. Indeed their equations are written in terms of a new velocity variable. It suffices for our purposes, and makes our computer code more modular, to consider equations in terms of velocity potential since only  and P need to be defined.
Remark 4. Both regularised Boussinesq and regularised Boussinesq-Whitham have equations where the nonlinearity is a bounded operator (on some suitable function space such as L2([0, 2]) × L2([0, 2])). Indeed regularised Boussinesq has a smoothing nonlinearity. For this reason we expect regularised Boussinesq to possess a local wellposedness theory for sufficiently smooth initial data.
Remark 5. When employing a canonical Poisson bracket to define Hamiltonian evolution equations, as was done in the above passage, only the symmetric part of the model DNO appears in the equations of motion. Thus if we require both the Hamiltonian and the dynamics of the model to approximate the full water-wave system, we impose the model DNO GM to be a symmetric operator on q. This property has the further advantage that any system of the form (23) where GM is symmetric, automatically conserves the momentum I = qx when  = 0. This is evident when one computes the (canonical) Poisson bracket of the Hamiltonian HM and the momentum I. Likewise additional properties of GM imply further conserved quantities: if the range of GM is orthogonal to constant functions, then  is conserved; if GM is symmetric and GM x = -x in a distributional sense, then the centre of mass x - t qx is conserved and so on. We do not pursue this point any further since the additional conserved quantities do not directly have a bearing on our problem.

3. Bathymetry using surface data. In the bottom-profile reconstruction approach of [30], the authors determine the profile  as the minimiser of the functional
F() = 2(t - G(, )q)2dx,
0
where , q, t are given functions. They show that for the DNO of the water-wave problem, a minimiser exists and is in fact unique, when the data , t, q are given from a solution to the waterwave equations (4-7). This approach has an obvious reformulation for shallow-water wave models which employ a model DNO: one replaces the G in the above equation by a suitable approximate DNO GM. For model equations of the form (24-25) this leads to

 = arg min (t - 2q + P x(( + )P qx) )2dx.

(29)



The same functional is obtained if one adapts the reconstruction algorithm of [51] to the shallow-
water regime. For details, see Appendix A. Note that the operator P, for either choice (26) or (28), maps L2([0, 2]) functions to at least H1([0, 2]). If we further assume t,   L2([0, 2]) and qx  H1([0, 2]), then a reasonable function space for the above minimisation problem is   L2([0, 2]). This suffices for both regularised Boussinesq and regularised Boussinesq-Whitham.
Before we proceed, we emphasise the notation used in the rest of the paper. The expression P qx appears repeatedly in the following. It will always denote a function. When this expression appears
in the definition of an operator, it denotes multiplication by the function P qx.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

8

We now suppose that , t, qx are known functions. Then to find the minimiser of (29) we write the associated Euler-Lagrange equation

(P qx) P 22x ((P qx) ) = -(P qx) P x t - 2q + P x ((P qx) ) .

(30)

Evidently  =  is a minimiser of (29). From equations (24) and (30) we find

(P qx) P 22x ((P qx) ) = (P qx) P 22x ((P qx) ) ,

(31)

thus  (the true bottom boundary) is a solution to (30). To solve equation (30) for the bottom-profile  we need to invert the operator

B : f  (P qx)P 22x (P qx) f .

This operator is formed by compositions of two operators: multiplication by the function P qx and the operator P22x. Note the latter corresponds to the Fourier multiplier -k2P (k)2. Recall the definition of P depends on the particular shallow-water model we use. As mentioned above, the
operator P, for either model, maps L2([0, 2]) functions to at least H1([0, 2]). Thus from a standard Sobolev embedding the function P qx is continuous in x when qx  L2([0, 2]). Thus multiplication by P qx is a bounded operator on L2([0, 2]). Moreover, for either model, k2P (k)2 is bounded. It then follows that the operator B is a bounded linear operator on L2([0, 2]). It is readily verified B
is self-adjoint. Next, B has spectrum contained in the negative real axis since

f B f dx = f (P qx) P22x ((P qx) f ) dx = - P x (P qx) f 2 dx.

In the case of regularised Boussinesq, k2P (k)2  k-2 for large |k|. This implies P22x and hence B, maps L2([0, 2]) to H2([0, 2]). This implies B is in fact a compact operator as H2([0, 2]) is compactly embedded in L2([0, 2]) [29]. On the other hand, the operator B is not compact for regularised Boussinesq-Whitham. Indeed we have the following theorem.
Theorem 3.1. Suppose qx  L2([0, 2]) and P qx is not identically zero, then for regularised BoussinesqWhitham, B is not a compact operator.

Proof. The operator P22x has the Fourier symbol - tanh2(µk)/µ2 which is bounded but does not

decay for sequence

ilnarLg2e(|[k0|,.2A]s),avrnes=ulst,inth(nexo)p/erato, rnP=212x,

is 2, .

not compact. . . with vn 2

Indeed consider = 1. Then

the

orthonormal

P 22xvn - P 22xvm

2 2

=

(tanh(µn)/µ)4

+

(tanh(µm)/µ)4



2(tanh(µ)/µ)4.

We conclude vn is a bounded sequence that satisfies 
P22x(vn - vm) 2  2(tanh(µ)/µ)2 for every n = m.

This implies no subsequence of P22xvn converges. Thus the operator P22x is not compact. We now show that B is not compact. The function P qx is continuous when qx  L2([0, 2])
for regularised Boussinesq-Whitham. Let S be a non-empty connected component of the set {x 
[0, 2] : |P qx|  c} for some c > 0. Since P qx is not identically zero, there exists such a c. Note P qx restricted to S is in L2(S). Let X  L2(S) be the orthogonal complement to the span
of P qx and take an orthonormal sequence wn in X. The sequence is obtained from an orthonormal sequence in L2(S), projected onto X followed by the Gram-Schmidt process and then considering only non-trivial wn. Define vn  L2[0, 2] by vn = wnS where S is the indicator function on S.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

9

Then vn is a bounded sequence in L2([0, 2]) whose image under B satisfies

Bvn - Bvm

2 2

=

2 (P qx) P 22x (P qx) (vn - vm)

2
dx,

0

 

c2 µ4

 k=-

tanh4(µk) |F [(P qx) (vn - vm)]k |2

,

 2c4(tanh(µ)/µ)4, n = m,

where in the second line we use Parseval's identity. To obtain the third line, we use Parseval's in the reverse direction for which the orthogonality condition S(P qx)wn = 0 is crucial, as the zero index does not contribute to the summation. Once again it follows that no subsequence of Bvn converges and hence B is not a compact operator.

Remark 6. For regularised Boussinesq-Whitham, the function P qx is identically zero if and only if qx = 0, since P (k) = tanh(µk)/(µk) > 0 for all k.

For either shallow-water model, we have the following result regarding zero eigenvalues of the operator B.
Theorem 3.2. Suppose q  H2([0, 2]) and the function P qx only vanishes on a set of measure zero, then the operator
(P qx) P 22x (P qx) · has no zero eigenvalue for P given by either (26) or (28).

Proof. Suppose there is a zero eigenvalue. Then

(P qx) P 22x (P qx) f = 0, for some f  L2([0, 2]). But then we have

P 22x (P qx) f = 0  (P qx) f = C,

for some constant C, which follows from the fact that P22x in Fourier space is the multiplier -k2P (k)2 and P is a positive operator (see definition in 26 or 28).

Suppose the constant C = 0. Since P qx vanishes on a set of measure zero, we conclude f = 0 almost everywhere. But then f cannot be an eigenfunction and hence there is no zero eigenvalue.

Thus we assume C = 0. For q  H2([0, 2]), P qx is given by ikP q^ where q^ is the Fourier transform of q. Evidently the
function P qx has zero average. Moreover since P x is a bounded operator, P qx is also in H2([0, 2]) and from a Sobolev embedding theorem, P qx  C1,1/2([0, 2]). Since P qx is a continuous function
with zero average, it must vanish somewhere. Since P qx is periodic, we assume without loss of
generality P qx = 0 at x = 0. Then from Taylor's theorem in Lagrange form for a neighbourhood of
x = 0 we have

Pqx = x

dP qx dx

=x
x=s

dP qx dx

+x
x=0

dP qx

- dPqx

dx x=s

dx x=0

,

for some s between 0 and x, and |x| sufficiently small. As the derivative of P qx is a 1/2-Ho¨ lder function, this implies

|P qx|  |x|m1 + m2|x|3/2  |P qx|  |x|(m1 + m2), for |x| < 1,

for some constants m1, m2. Note, m1 and m2 cannot both be zero as that would imply P qx vanishes in an open set. This implies the eigenfunction f is given by

f

=

C P qx



|f|



|C| |x|(m1 + m2) ,

for

|x|

sufficiently small.

But then f / L2([0, 2]) and hence zero cannot be an eigenvalue.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

10

Despite the uniqueness result mentioned above, we expect the operator on the left-hand side (30) to be ill-conditioned. For regularised Boussinesq, where P is given by (26), as the operator B is
compact, zero is a limit point of the (negative) eigenvalues. Additionally, for both shallow-water models, the zeros of P qx can lead to further ill-conditioned behaviour. Indeed consider a sequence of smooth functions fn(x) with compact support and which approximate a Dirac delta distribution located at a zero of P qx. Then for any   L2([0, 2])

lim
n

fn(P qx)P 22x (P qx)  dx = 0.

This holds for both regularised Boussinesq and regularised Boussinesq-Whitham and is unavoidable. Indeed for q  H1([0, 2]), P qx is continuous and has zero average, which implies P qx must be zero for some x  [0, 2]. Thus the main difficulty in our approach to bathymetry is taming the ill-
conditioned nature of the operator B. This ill-conditioned nature of B is directly related to the
ill-posed nature of bottom-boundary detection in the context of the water-wave problem (4-7).

Remark 7. So far we have only discussed reconstruction with relation to the dispersive models of (26) and (28). We now briefly consider the hyperbolic model corresponding to the choice 2 = k2 and P = 1. Now , q evolve according to the Saint-Venant equations. The corresponding minimisation problem for the bottomprofile  leads to the following Euler-Lagrange equation
qx2x(qx) = -qxx(t + qxx + x(qx) ).
For sufficiently smooth qx (at least twice differentiable), the operator on the left-hand side in the above equation is in fact a Sturm-Liouville operator

qx2x(qx) = x(q2xx) + qxqxxx.
We note the same issue regarding the zeros of the coefficient qx plagues this operator, leading to a singular SL problem. However the situation is arguably worse since the forward model for qx and  is now a nonlinear hyperbolic PDE and likely forms shocks. Consequently, the coefficients of the operator above may be discontinuous thereby precluding any traditional SL theory. If we instead formally cancel the respective terms on either side of the above equation we obtain
-xqx = t + x( + 1)qx.
Further assuming that t has zero average, we formally solve for  by having to divide by qx. This seems a highly suspect way of obtaining the bottom boundary that is unlikely to be robust to noise. For these reasons we do not consider the hyperbolic model any further.

The upshot of the discussion in the previous paragraphs is the following: to solve (30) for the bottom boundary, one needs some form of regularisation so that the eigenvalues of any finite dimensional truncation of the operator are sufficiently far away from the origin. After exploring many different strategies we concluded the most straightforward and physically meaningful approach was to recover the bottom boundary from the following minimisation problem

M
 = arg min

(t(j) - 2q(j) + P x(((j) + )P q(xj)) )2dx,

(32)

 j=1

where the superscript j indicates data (, t, qx) obtained at time tj. Thus we demand the bottom boundary  minimises the functional of [30] at multiple time instances simultaneously. This was found particularly helpful when the zeros of P qx do not remain fixed in space for a given solution to the shallow-water wave model equations. We note this is not always the case, but that it is fairly straightforward to generate initial conditions that leads to such preferred solutions. Indeed an initial condition inspired by a Stokes expansion

q(x, 0) = A sin(x) + A/5 sin(2x), (x, 0) = A cos(x) + A/5 cos(2x) - 0.1,

(33)

often leads to solutions that look like travelling waves even over non-trivial bottom-boundaries. We found this initial condition was sufficient for the purpose of preventing any zero of P qx remain fixed

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

11

100

10 2

10 4

10 6

10 8

1 10

100

200

10 100

50 100 150 200 250

100

10 2

10 4

10 6

10 8

1 10

100

200

10 100

50 100 150 200 250

(a) Regularised Boussinesq (26)

(b) Regularised Boussinesq-Whitham (28)

Figure 2. Absolute value of the (sorted) eigenvalues of the operator on the left-hand side of (34) for µ = 1 in either regularised Boussinesq or regularised BoussinesqWhitham. Here q(j) = 0.1 sin(x - tj) where x  [0, 2] and tj = 2j/M, j = 1, 2, . . . M. The horizontal axis is the index of the sorted eigenvalue. The different curves correspond to different values of M as indicated in the legend. The markers on the different curves are placed to distinguish the curves and do not indicate the number of data-points in the figure. The number of grid points in x was 256 in all cases for both model equations. Hence 256 eigenvalues are shown in each curve.

in space for all time. The associated Euler-Lagrange equation for (32) is similar to (30) but includes a summation over times tj on either side

M (P q(xj)) P 22x (P q(xj)) 
j=1

M
=-

(Pq(xj)) P x

(j)
t

-

2q(j)

+

P

x

(P q(xj)) (j)

j=1

. (34)

3.1. Numerical experiments. We now present the results of some numerical experiments investigating the inverse problem formulated in this section. First we analyse the problem of inverting the operator on the left-hand side of equation (34). To do so, we consider a particular form for the function qx. Specifically we chose q = 0.1 sin(x - t), x  [0, 2] which represents a periodic travelling-wave profile for the velocity potential. We discretised this function on a uniform grid in the x-variable with 256 points. For fixed t, using a pseudospectral method we compute the matrix representation of the operator (P qx)P22x((P qx) ·) for both regularised Boussinesq (26) and regularised Boussinesq-Whitham (28). This generates a 256 by 256 real symmetric matrix for either model. We repeated this procedure for different t-values, specifically for t = 2j/M where j = 1, 2, . . . M. This results in M matrices each of size 256 by 256 (again for either model). M matrices are summed to produce a sole real symmetric matrix of size 256 × 256 for regularised Boussinesq and a different 256 × 256 real symmetric matrix for regularised Boussinesq-Whitham. We have thus computed the operator on the left-hand side of (34). We then used the standard LAPACK subroutines to determine the associated eigenvalues. This procedure was repeated for different values of M, specifically M = 1, 10, 100, 200. As expected, all the eigenvalues were negative and clustered near the origin. In Figure 2 we plot the magnitude of the sorted eigenvalues (as a function of index) for different values of M, indicated in the legend. We first note, that the operator when considered at a single instance of time M = 1 is the most singular/ill-conditioned for both model equations. However the effect of taking into account additional times is indeed a form of regularisation. The

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

12

0.6 0.7

with with with

t12r.0u4%e%qeexrrrroorrininqqxx

True bathymetry

0.8

z 0.9 1.0

1.1

1.2

0

1

2

3x 4

5

6

0.6 0.7

with with with

t11r.6u4.e%5%qexrerrorrorininqxqx

True bathymetry

0.8

z 0.9 1.0

1.1

1.2

0

1

2

3x 4

5

6

(a) Profile 1a

(b) Profile 1b

Figure 3. Bottom-boundary reconstruction using (32) for regularised BoussinesqWhitham equation (28). The black dashed lines indicate reconstruction using an erroneous value for qx with relative error percentages indicated in the legend. The construction of these inaccurate qx profiles is explained in Section 5. Note even a small amount relative error can lead to inaccurate reconstruction. The error between the true profile (solid blue line) and the reconstruction using the true qx (red line with filled markers) is below machine precision.

eigenvalues for larger values of M, show an overall increase in magnitude. This is particularly so for regularised Boussinesq-Whitham which almost levels off completely. Our other model, regularised Boussinesq, shows a markedly different behaviour. Although there is some regularisation obtained for M > 1, we still see a rapid decay in the magnitude of the eigenvalues. This is consistent with the fact that the operator for this model is in fact compact (indeed the sum of M compact operators) whereas for regularised Boussinesq-Whitham the operator is only bounded.
The rapid decay of the eigenvalues will have a strong impact on the accuracy of the bottom profile reconstruction. Note that when , t, q are consistent with the model equations, we have

(j)
t

=

2q(j)

-

P x

((j) + ) (P q(xj))

,

for each j = 1, . . . , M.

Hence the equation we need to solve for  becomes

M

M

  (P q(xj)) P 22x (P q(xj))  = (P q(xj)) P 22x (P q(xj))  ,

j=1

j=1

which provides the true solution if we can invert the matrix on the left side of the equality. If the data , t, q provided are not consistent or only approximately satisfy the necessary relationship between themselves, then these small errors will inevitably get magnified when reconstructing the bottom topography. Hence the decay of the eigenvalues determines the relative accuracy to which we require the provided data to be consistent with the underlying model.

Remark 8. The above analysis was for a fixed spatial resolution, i.e. fixed number of grid points in x. If the resolution in x were increased, one may require higher values of M to achieve a similar amount of regularisation. For regularised Boussinesq, fixing M and increasing the resolution in x, will still result in small eigenvalues and cause the operator on the left-hand side of (32) to be ill-conditioned. Thus we are assuming

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

13

0.7

with with True

t1br%auteheqyrrxmoretinryqx

0.8

z 0.9 1.0

1.1

1.20

1

2

3x 4

5

6

0.75 0.80

with with True

t1br%auteheqyrrxmoretinryqx

0.85

0.90 z
0.95

1.00

1.05

1.100

1

2

3x 4

5

6

(a) Profile 1a

(b) Profile 1b

Figure 4. Bottom-boundary reconstruction using (32) for regularised Boussinesq equation (26). The black dashed lines indicate reconstruction using an erroneous value for qx with relative error percentages indicated in the legend. The construction of these inaccurate qx profiles is explained in Section 5. Note even a small amount relative error can lead to inaccurate reconstruction. The error between the true profile (solid blue line) and the reconstruction using the true qx (red line with filled markers) is below machine precision.

the bottom-profile to be recovered is well approximated with the chosen number of grid points. Equivalently we assume the bottom-profile is not too rough. This is not unexpected in these kinds of ill-conditioned inverse problems. However, Figure 2 indicates the regularised Boussinesq-Whitham model behaves quite differently under this regularisation scheme. Recall the associated operator here is not compact. The primary source of ill-posedness comes from the zeros of P qx. When the zeros of P qx are not stationary in time, taking larger M seems to help for this model. We observed similar behaviour at higher resolutions in x.

We continue our experiments with reconstruction by considering examples using data taken from forward simulations of the model equations themselves. In Figures 3 and 4 we consider the recovery of the bottom topography profile  given , t, q from a forward simulation of the respective model equations. For each model equation, we consider the recovery of a bottom profile which consists of a number of a sine waves called Profile 1 (Figure 1a) or a localised bottom feature called Profile 2 (Figure 1b). In all cases, a solid blue line indicates the true bottom topography and the red line with filled-circle markers indicates our recovered profile when using data obtained at 200 different times from the forward simulation. For a given time instance tj, for which we seek to compute the left-hand side operator in equation (34), we recorded the solution (, q) to the forward problem from a numerical simulation of the model equations. This was done in such a way that the timederivative t could be computed using a fourth-order accurate five-point finite-difference stencil in t. This stencil lead to a time-derivative of sufficient accuracy so as to enable recovery and was, up to machine precision, equivalent to computing the right-hand side of equation (24). We define two relative errors for the recovered bottom-boundary as

Eb =

(1 + r) - (1 + ) 1+ 2

2,

Ep =

r -  2 2

(35)

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

14

where r is the reconstructed profile,  is the true profile, Eb denotes the relative error in the actual depth (including the baseline z = -1) and Ep is the relative error for the deviation from z = -1. The value of Eb for the recovered bottom-boundary with data (, t, qx) consistent with the forward model (for either regularised Boussinesq or regularised Boussinesq-Whitham) is approximately 10-12, indicating recovery is possible. We also used a second-order accurate three-point stencil to compute t. Despite a higher Eb (around 10-8) we could still reconstruct the bottomboundary.
On the other hand, using a value of qx with a small amount of error, gave rise to considerable error in the recovered bottom topographies. The reconstructions using erroneous values of qx are shown in Figures 3 and 4 by long-dashed black lines. The recovered profiles with even a 1% L2-norm relativeerror in qx (but no error in , t) resulted in Eb between 4 - 7%. Admittedly recovering bottom topographies through this approach is prone to noise and error, despite our regularisation. For the
case of regularised Boussinesq, we do not consider reconstruction corresponding to qx values with error larger than a few percent since it gave such poor results that one could not properly visualise
all recovered profiles on a single plot. In this sense, regularised Boussinesq-Whitham is arguably
better; a reflection of the slower decay in the magnitude of the eigenvalues for this model. We did try
other Tikhonov-based regularisation schemes. However these methods needed considerable tuning
of the regularisation parameter which was particular to each bottom-profile and we were unable to
find a systematic way to do so.

4. The observer model for velocimetry. In this section we consider the problem of determining the
velocity qx of the fluid from measurements of the surface elevation  when the bottom boundary  is known and   is finite. To achieve this we employ the observer framework [43]. An observer system is a dynamical system which is constructed in relation to another dynamical system when
given partial knowledge of the state of the latter dynamical system. Let y represent the state of a dynamical system that evolves according to yt = f (y). An observer for this system is y~t = f~(y~, Oy) where f~ is a modification of f and O is an operator with a null-space representing the fact that we only have knowledge of a part of the state y. The goal then is to design f~ such that y~  y as t  .
Hence by simulating the observer model, we may retrieve knowledge of the full state.
Let q,  represent the solution to (24-25) for some unknown initial condition. These represent the
true state. The observer variables are denoted by q~, ~ and we propose they satisfy

~t = 2q~ - P x (~ + ) (P q~x) - (~ - ),

(36)

q~t

=

-~

-

1 2

(P q~x)2

-

(~

-

).

(37)

Here ,  are the observer parameters. In this section we assume we have access to the function , or equivalently we are provided the surface deviation for all x, t from measurements. The problem at

hand is then to recover the velocity qx (which cannot be measured) by solving (36-37) with arbitrary initial conditions for ~, q~, assuming we know the bottom-profile . Thus we seek a rationale for choosing ,  to ensure the required convergence, namely q~x  qx as t  . At the end of this section, we present numerical simulations that validate this choice. Our numerical simulations

employ the surface deviation (x, tj) for a discrete set of times tj. Let qe = q~ - q, e = ~ - , represent the errors in the potential and free-surface respectively. We
first state a theorem for the error associated with the linear constant-coefficient part of equations

(36-37).

Theorem 4.1. For any positive number d, there exist real numbers  and  such that the solution to

te = -e + 2qe,

(38)

qet = -(1 + )e,

(39)

with periodic boundary conditions satisfies

e 2  Ce-dt, qex 2  Ce-dt,

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

15

where C is a constant that depends on the initial condition.

Proof. The proof is straightforward and follows from the Fourier series solution to the equations. Indeed the equations for e, qe are equivalent to

tet + te + (1 + )2e = 0,

which has solutions that look like exp(ikx + pkt) where

p2k

+

pk

+

(1

+

)2(k)

=

0



pk

=

- 2

±

2 4

-

(1

+

)2(k)

Note for both choices of regularised Boussinesq (26) and regularised Boussinesq-Whitham (28), 2(k)  0, vanishes only when k = 0 and is an increasing function of |k|. Hence setting  = 2d, we
obtain the required decay rate by ensuring the term under the square root is negative. This can be

done by choosing  so that


   

d2

1 1

+ +

µ2 µ2

/2 /6

,

for (26),

1+ >

(40)

   

d2

µ tanh(µ)

,

for (28).

The statement of the theorem then follows by writing the Fourier series solution and computing an estimate for sufficiently smooth initial data.

It follows from the above theorem that we can design the observer to guarantee exponentially fast error decay at any desirable rate for the constant coefficient part of (36-37). Note that the error in the mean mode of q does not decay. We observe this from the dispersion relation in the proof of the theorem where pk = 0, - when k = 0. We also note more directly from the integral of linearised version of equations (36-37)

t e = - e, t qe = -(1 + ) e,
and note that the mean mode of e vanishes exponentially, but the initial error in qe is never eliminated. For the linear observer equations, one can only recover the velocity and not the potential. This is physically reasonable.

4.1. Decay of error in the linear equations. The previous theorem not only gave us the required decay rate but it also provided (in principle) a solution expression for the constant coefficient part of the linear operator on the right-hand side of (36-37) and a representation for the associated semigroup eLt. On the other hand, the linear operator appearing in (36-37) is in fact a variable-coefficient operator due to the presence of  and we would like to estimate the decay rate of solutions associated to the entire linear part. We claim that the linear equation given by

te = 2qe - P x ((P qex) ) - e,

(41)

qet = -(1 + )e,

(42)

possesses a solution which can be given in terms of a continuous one-parameter family of solution operators. This follows from the fact that

-P x ((P q~x) ) ,

is a bounded self-adjoint operator acting on q~, for both regularised Boussinesq and regularised Boussinesq-Whitham, and employing standard results in the perturbation theory of operators [38]. Next we consider (41-42) in integral form as follows

e qe

= eLt

e(x, 0) qe(x, 0)

t
+ eL(t-s)
0

-P x ( (P qex)) 0

ds.

(43)

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

16

If we limit ourselves to initial data with zero average, then Theorem 4.1 affords a uniform decay-rate

and thus we have

y



e-

t 2

y0

+

t

e-

 2

(t-s)

0

 µj

y ds,

(44)

where j = 2 for (26) and j = 1 for (28). Here y =

e

2 2

+

qex

2 2

is

the

norm

of

the

solution

for equations (41-42). The above claim follows from the triangle inequality and the fact that the

induced L2-norm of P is bounded by 1 and the norm of P x depends on the particular choice of

shallow-water model. We now employ a simple Gro¨ nwall argument to conclude that

y  e-mt y0 ,

m

=

 2

-

 µj

.

The zero average condition for qe and e is clearly maintained by (41-42). The Gro¨ nwall's inequality we employed above follows from the following theorem due to Zadiraka [54] upon assuming b = 0.

Theorem 4.2. Let u(t) be a continuous function that satisfies

|u(t)|  |u(0)|e-t + t e-(t-s)(c|u(t)| + b)ds,
0
where a, b, c are all positive constants then

|u(t)|



|u(0)|e-(-c)t

+



b -

c (1

+

e-(-c)t ).

Remark 9. The quoted result due to Zadiraka appears in the literature with the term e-t|u(0)| in the result, as opposed to e-(-c)t|u(0)|. However we could neither find the original reference nor prove the result

ourselves. Hence we choose to refer to the result above, which we could prove.

We conclude then that the linear equations given in (41-42), like the constant coefficient counter-

part, also satisfy an exponential decay bound when  is taken sufficiently large. The error in the non-zero modes, for the linear observer problem, decays monotonically. This follows from the error

bounds derived above though one may also reach the same conclusion via energy considerations for

the linear observer problem, see Appendix B.

Note that the nonlinear observer equations (36-37) do not preserve the zero-mode for the potential

q, neither for regularised Boussinesq nor for regularised Boussinesq-Whitham. Thus we do not expect q~  q as t  . The nonlinear terms in the observer model (36-37) and shallow-water model

(24-25) are the same and are locally Lipschitz functions of their arguments. One may then anticipate a reduction in the error qex, e for finite time and  large enough. However we do not prove the
long-time convergence for the nonlinear problem which would require a long-time wellposedness

result for the underlying models. Nonetheless, our numerical simulations of (36-37) indicate the error in velocity qex does indeed vanish asymptotically in time.

4.2. Choosing the observer parameters in practice. We now present our scheme to set the observer
parameters  and  for general bottom boundary profiles. Consider the linear equation for the error terms qe and e

te = 2qe - P x ((P qex) c) - e,

(45)

qet = -(1 + )e,

(46)

where c is a constant. Rewriting this equation in terms of e alone we have

tet + te + (1 + )(2e - P x((P xe ) c)) = 0,

(47)

which has solutions of the form eikx+pt where p satisfies

p2 + p + (1 + )((k)2 + k2P (k)2c) = 0

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

17

L2 Error L2 Error

100

10 2

10 4

10 6

10 8

10 10

et

10 12

q

qx

10 14 0.0 2.5 5.0 7.5 1t0.0 12.5 15.0 17.5 20.0

100

10 2

10 4

10 6

10 8

10 10

et

10 12

q

qx

10 14 0.0 2.5 5.0 7.5 1t0.0 12.5 15.0 17.5 20.0

(a) Error decay for profile 1a

(b) Error decay for profile 1b

Figure 5. Decay of error in solution for the observer model corresponding to regularised Boussinesq-Whitham (28) with observer parameters  = 6 and  = 14. This results in a linear decay rate of /2 = 3 which is indicated in the short-dashed black line. The error for  and qx in the full nonlinear observer problem follow almost exactly the predicted linear decay rate. Shown in the green dashed-dot line is the error in q which saturates to a non-zero value.

 p = - ± 2

2 4

-

k2(1

+

)

(k)2 k2

+

cP (k)2

As in the case of Theorem 4.1 we need to ensure the term under the square root is negative for all k. The coefficient of (1 + ) is an increasing function of k for both choices of 2, P in (26) and (28). Hence it suffices to ensure the appropriate sign under the root for k = 1. If c is positive then the parameter choice of Theorem 4.1 is sufficient here too. This suggests that for a general profile , a suitable choice for c = min[0, ]. In keeping with the no-island condition, we assume  > -1 then the energy corresponding to solutions of equations (41-42) is positive and monotonically decreases
(see Appendix B). Hence we have for the constant coefficient equations a

decay rate of /2 when (1 + ) >

2 4((k)2 + cP (k)2)

k=1

c

= min[0, ].

(48)

As shown in our numerical experiments, this choice seems to give the decay rate of /2 for the variable coefficient equation (41-42) as well as the fully nonlinear observer model (36-37).

4.3. Numerical experiments. To evolve the solution of the observer equations (36-37) forward in time, we require the solution of the model shallow-water equations (24-25), or more specifically (x, t). Consequently, we solve both equations simultaneously with the observer model coupled to the original equations. Since we employ periodic boundary conditions, we represent all functions , q, ~, q~ as well as the bottom-boundary using Fourier series and employ a pseudospectral method, with 2/3-method for de-aliasing, to time-evolve the full system of (four) equations. In all the simulations, in this section and the next, we used 512 grid points in the x-direction. We used the standard explicit fourth-order Runge-Kutta scheme with a time-step t = 10-3 non-dimensional time units for the model shallow-water equations (24-25) and recorded  at each time-step. We also

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

18

L2 Error L2 Error

100

10 2

10 4

10 6

10 8

10 10

et

10 12

q

qx

10 14 0.0 2.5 5.0 7.5 1t0.0 12.5 15.0 17.5 20.0

100

10 2

10 4

10 6

10 8

10 10

et

10 12

q

qx

10 14 0.0 2.5 5.0 7.5 1t0.0 12.5 15.0 17.5 20.0

(a) Error decay for profile 1a

(b) Error decay for profile 1b

Figure 6. Decay of error in solution for the observer model corresponding to regularised Boussinesq (26) with observer parameters  = 6 and  = 14. This results in a linear decay rate of /2 = 3 which is indicated in the short-dashed black line. The error for  and qx in the full nonlinear observer problem follow almost exactly the predicted linear decay rate. Shown in the green dashed-dot line is the error in q which saturates to a non-zero value.

used fourth-order RK4 for the observer model but with a time-step of 2 × 10-3 to account for the
fact that the solution  is supplied to the observer model at a fixed rate and since the RK4 scheme
requires the value of the vector field at intermediate time steps. Additionally we conducted ex-
periments where the solution to the model equations was recorded every m time steps and hence the observer model was time evolved with a time step of 2mt. In all cases we obtained the same qualitative behaviour. In the present manuscript we only show results for m = 1 and t = 10-3.
Recall we defined the errors in the velocity potential and surface deviation as qe = q~ - q and e = ~ - , where the tilde variables correspond to the solution of the observer model and , q are the solution of our model shallow-water equations. Figures 5 and 6 show the L2 norms of qe and e
as a function of time for the two different models, regularised Boussinesq-Whitham and regularised Boussinesq respectively. In each plot, we also show the error in the velocity qex = q~x - qx as well as the predicted decay rate according to our observer design, which in this case corresponds to /2. For all cases, we took  = 6 and  = 14. This choice is consistent with the design suggested in
(48) for either of the bottom profiles we considered. We note that the errors for the full nonlinear
observer problem follow the predicted decay rate very closely. We conjecture that  was sufficiently
large to overcome any possible growth in the error due to the nonlinearity. We also note that the
error in the velocity potential does not decay to zero, as expected. The decay in the error did not
depend substantially on which of the the bottom profiles we considered. Figures 5 and 6 indicate
the errors in the surface deviation and velocity do not decrease to machine precision. The value to which they saturate depends on the frequency with which the data (x, t) of the original model is recorded. As we decreased t, the final asymptotic-in-time errors decreased. We conclude this
section by emphasising the main upshot of our numerical simulations: when the bottom-boundary
 is known, it is possible to recover the velocity of the fluid in these shallow-water models given

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

19

only measurements of the surface deviation. The error in the recovered velocity depends on the frequency of the measurements.

5. Simultaneous velocity-recovery and bathymetry. Previously we considered the problem of recovering  given , t, qx (Section 3) and then the problem of recovering qx given  and  (Section 4). In the present section we combine these two inverse problems into one, and propose a method to recover  from measurements of  alone. This will entail recovering qx as well. Henceforth we assume we know  (as a function of x and t). The recovery of velocities and the bottom-boundary involves carefully selecting the observer parameters , . To do so, we need to analyse the errors associated with the methods described in Sections 3 and 4.
This section consists of three subsections. In the first subsection, we describe the overall reconstruction algorithm. Subsequently, we obtain error estimates that motivate our particular choice for the parameters , . As the reconstruction algorithm consists of two stages, we first derive error estimates for both stages independently and then combine them. The upshot is a condition on the observer parameters. Finally we conclude with some example reconstructions, i.e. starting with an initial guess for the bottom-profile and measurements of the free surface  as functions of x given at specific instants of time, we improve our initial estimate to determine the true bottom-profile.

5.1. The reconstruction algorithm. The basic strategy is as follows. Suppose we have an a priori estimate for e, or in other words a reasonable but not necessarily accurate guess for the bottom
boundary. We employ this initial guess in the observer equations (36-37) to arrive at an estimated q~x which we record at multiple instances of time. We then employ the estimated velocity q~x in the reconstruction equation (34) to update our estimate of the bottom boundary profile.
We now present the main contribution of this manuscript. The following is our proposed algo-
rithm for bathymetry using surface-wave measurements alone.

(1) Suppose we are given (x, t), the true surface deviation, and a reasonable guess for the bottom boundary ~. We assume the constant function ~(x) = c.
(2) Pick a small number such that µ2. Choose  and  such that

1+ = , 

and

(1 + ) >

2 4((k)2/k2 + cP (k)2)

.
k=1

Note the second condition above ensures the error in the observer model decays. The moti-

vation for the first condition is given in the next subsection.

(3) Run the observer model (36-37) with these parameters (using any reasonable initial condi-

tion;

we

employ

trivial

initial

conditions)

for

a

time

till

the

predicted

error

e-

t 2

is

sufficiently

small and record q~x from this simulation for a large number of time instances (say 200).

(4) Using , t and q~x at the different instances of time, solve the reconstruction equation (34) to

recover the bottom boundary.

Note our proposed method involves two steps: an observer problem followed by a reconstruction step. This implies the estimated velocity provided by the observer problem must be sufficiently accurate so that the resultant  we reconstruct is accurate. We emphasise that we do not iterate these two steps. The ill-conditioned nature of the matrix inversion involved in solving equation (34) caused small errors to amplify when we implemented an iterative scheme. This forced errors in both the velocity estimate from the observer problem and reconstructed bottom boundary profile to rapidly grow.
The requirements on  and  imply that  cannot be too large. Indeed  is typically less than or equal to . Hence, despite the fact that we were free to choose almost any  in the observer problem, when attempting to reconstruct the bottom-profile, we cannot impose too large a decay rate on the error; the surface deviation must be assimilated slowly into the observer equations so that the resulting velocity is accurate. We recall the examples discussed in Section 3.1 which involved reconstruction from erroneous qx values. Such velocities were obtained from an observer problem (with an estimated ~) using `large' values of , namely those which did not satisfy the requirements

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

20

detailed above. In such a case, the error in the estimated velocity was too large and this lead to the poor reconstruction of the bottom boundary profile.
Remark 10. Another noteworthy point is that  is negative when 1 +  = . Indeed it is close to -1. When  is precisely -1 then the observer equation for the velocity potential is decoupled from the  equation

q~t

=

-

-

1 2

(P q~x)2

.

Thus the velocity potential is purely driven by the measured . It is not evident that the error due to the mismatch in the initial condition reduces over time. Indeed it is not evident that there is any decay in qex whatsoever. Moreover the equation is similar to a forced inviscid Burgers equation and we suspect it is liable to produce high derivatives. The case for   -1+ leads to eventual decay in the error but on a very long
time-scale given by 2/ as well as some amount of dispersive smoothing for high wave numbers as evident
from the dispersion relation (see Theorem 4.1).

5.2. Error estimates. We now present arguments that motivate the condition that (1 + )/ be taken as small as possible. The argument follows from error estimates, for both regularised Boussinesq and regularised Boussinesq-Whitham, in either of the two stages of our reconstruction algorithm, namely (i) reconstructing the bottom-profile  given (x, tj), t(x, tj) and qx(x, tj) for j = 1, 2, . . . , M (as detailed in Section 3), (ii) estimating the velocity qx given (x, t) and an initial guess for the bottom-profile ~ using the observer framework (as detailed in Section 4). Finally we combine the estimates to determine how the initial error in the bottom-profile may be reduced.

5.2.1. Error estimates for bottom-profile reconstruction. Consider equation (30) written here in terms of the errors qe = q~ - q, e = ~ -  and e =  - 

(P q~x) P 22x (P q~x) e = (P q~x) P x 2qe - P x ((P qex) ( + )) ,

(49)

where the tilde variables denote our current estimate of the observer model and q, ,  represent the
true values. This equation indicates the error in our estimation of  is proportional to the error in q. Note the operator that appears on the right-hand side, acting on qe, is in fact the right-hand side of
equation (24): the DNO for the shallow-water model with the true values of  and . However, as seen in the previous section, we only have decay in qex and not qe. Hence we consider the right-hand side as an operator on qex.
For regularised Boussinesq-Whitham (28) we note

2qe - P x ( ( + )(P qex) ) 2  2qe 2 + P x ( ( + )(P qex) ) 2

(50)

1 µ

k tanh(µk)q^e

2+ 1 µ

+



qex

2,

(51)

 1 (1 + µ

+

)

qex

2,

(52)

where we have assumed the data and true bottom boundary are bounded in the infinity norm (a reasonable supposition) and used the fact that P x corresponds to the multiplier tanh(µk)/µ in Fourier space for regularised Boussinesq-Whitham. We also point out that although increasing the parameter µ can make the right-hand side of (49) smaller, we have precisely the same scaling relationship with respect to µ on the left-hand side. Indeed setting µ 1 makes the operator on the left-hand even more poorly conditioned. Informally speaking, we wish the right-hand side to be small, but the left-hand side to be `large', in the sense that the eigenvalues are bounded away from the origin. The scaling with respect to µ offers no advantage in this regard. Next we note the factor (1 +  +  ) is always greater than unity. Hence there is a natural `amplification' of the error in qx in our proposed reconstruction method. Looking ahead, we will seek an estimate of qex that depends on an a priori estimate of e. Our error bound on e will only improve if the estimate of qex accounts for the amplification observed here.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

21

The case for regularised Boussinesq (26) follows similarly. We have

P x 2qe - P x ((P qex) ( + )) 2  P x2qe 2 + P 22x ( + ) (P qex) 2

(53)



k2 1 + µ2k2/2

1 + µ2k2/6 1 + µ2k2/2

kq^e
2

+

(1

+

k2 µ2k2

/2)2

F

[(

+



)(P

qex

)]

,
2

(54)



1 µ2

2

+

1 2

+



qex 2.

(55)

Apart from a different power of µ in the denominator, we have a similar amplification factor in front of the error in qex. In fact the factors, for regularised Boussinesq and regularised BoussinesqWhitham, are conservatively bounded above by 3 assuming both   and   are bounded above by 1. This seems a reasonable assumption both from the perspective of having no islands but also from the point of view that these models approximate the full water-wave problem only in the small-amplitude shallow-water limit. For regularised Boussinesq, the scaling in µ on the left-hand side of (49) is the same as the right-hand side. Arguably it is worse since on the left-hand we have a compact operator when P is given by (25). Hence increasing µ only decreases the magnitude of the eigenvalues of the operator. Once again we conclude, it is the error in qx that must be made small.
The above discussion pertains to the case when t, , q~x were known at a single time. The estimates obtained, translate in a straightforward manner for the minimisation problem given in (32). The only difference is we now demand estimates that are uniform in time. Hence we require q~x, the velocity as given by the observer model, to be sufficiently accurate over a period of time when  and t are also known. Here sufficiently accurate refers to the levels of accuracy required in the examples discussed in Section 3.1. We do not provide rigorous bounds on the required accuracy, which would entail an analysis of the spectrum of the operator on the left-hand side of (49) as a function of q~x.
Remark 11. It is worth mentioning the role of the operator P in obtaining the estimate (55). Note

2(k) = k2

1 + µ2k2/6 1 + µ2k2/2

,

represents an unbounded operator on q. Hence to interpret this expression as a bounded operator acting on
qx, the additional P x in the right-hand side of (49) is precisely of the right form. In fact, had one considered a shallow-water model with a hyperbolic-tangent type regularisation on the nonlinear terms but retained the same 2 as above, we would not be able to readily find a bound. Alternatively, had we considered a linear dispersion relation that included surface tension effects, we would require even greater smoothing from P.
This suggests the selection of the model is absolutely crucial for bottom-profile reconstruction. In particular it is the combination of the operators 2 and P and their compatibility that is relevant.

5.2.2. Error estimates for the observer problem. We now focus our attention on the observer equa-
tions and the choice of observer parameters , . As described in the reconstruction algorithm in Section 5.1, we initially guess the constant profile ~(x) = c. This initial guess corresponds to an initial error given by e = c - . Consider the linear equation (41-42) but now with an estimated bottom boundary:

te = 2qe - P x (P qex)  - e - P x (P qex) e - P x (P qx) e ,

(56)

qet = -(1 + )e.

(57)

Note the above equations are the error equations corresponding to the linearised version of (36-37) but with ~ in the place of . In terms of the observer problem, we seek to minimise the errors qex and e in the presence of a forcing given by the last term of (56): P x (P qx) e . As one might expect, due to the forcing term present when  is not known exactly, we cannot reduce the total error to
zero. Moreover, the strength of this forcing is directly proportional to the error in .

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

22

Equations (56-57) can be combined to obtain a single equation for qe

qett + qet + (1 + ) 2qe - P x (P qex) ( + e) = (1 + )P x ((P qx) e) .

(58)

Recall e = c -  where c is a constant. Hence the above is a constant-coefficient evolution equation for qe with a non-homogeneous term. This allows us to write an explicit solution using Fourier series. Indeed solutions to the homogeneous part are given in terms of exponential solutions of the kind eikx+pt where p satisfies
p2 + p + (1 + )((k)2 + c k2P (k)2) = 0.

Under the condition

(1 + ) >

2 4((k)2 + c k2P (k)2)

,
k=1

the roots are given by p± = -/2 ± ik where k is a non-zero real number for all |k| > 0. See also the discussion in Section 4.2. The general solution to (58) is then given by



 qe

=

e-

 2

t

eikx eiktk + e-ikt k + e-t0 + 0

k=-

 +

t

(1

+

)e-

 2

(t-s)

0

 k=-

eikx

sin(k (t k

-

s))

F

Px (Pqx) e

k

ds,

where k, k depend on the Fourier coefficients of the initial data and the prime indicates the summation does not include k = 0. We note that the error in q is driven by a forcing proportional to e, the error in our estimate of . We can now estimate qex

qex

2



e-

 2

t

(

x

2+

x 2) +

sup P 2x (P qx) e

2

t

t

(1

+

)e-

 2

(t-s)

ds,

0

and invoke Theorem 4.2. Then for regularised Boussinesq, we expect as t  

qex

2  2 1 +  sup t

P 2x

(Pqx) e

2



4(1 + ) µ2

e

2 sup
t

P qx

.

(59)

If qx  L2 for all time, then as P is a smoothing operator, sup P qx  is bounded.
t
The estimate (59) implies we cannot choose  arbitrarily large to reduce the long-time error in qx. Recall that (1 + ) is proportional to 2 in order to ensure the desired decay-rate. Hence increasing
 only forces  to be larger. We are then forced to make the combination (1 + )/ as small as possible so that the qex can be made sufficiently small.
We can make a similar argument to the one above for regularised Boussinesq-Whitham. However
there is one technical obstacle. In this case, since P x is only bounded and not smoothing, we need to impose additional regularity for e. For regularised Boussinesq-Whitham, the analogous estimate
is given by

qex

2  2 1 +  sup µ t

x (Pqx) e

2.

(60)

Note we have a similar scaling with respect to  and . Of course the above estimates are all based on
an understanding of the linear equations (56-57). However, since the nonlinear terms in (36-37) are Lipschitz functions (for , qx in L2), we expect a similar estimate to hold for the nonlinear equations, if  is sufficiently large to overcome any possible growth in the solution.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

23

L2 Error

101

100

10 1

10 2

10 3

10 4 et

10 5

q

10 6 0

qx 2

4 t6

8

10

Initial guess

0.7

Reconstruction True bathymetry

0.8

z 0.9 1.0

1.1

1.20

1

2

3x 4

5

6

(a) Error decay  = 1/100,  = -1 + 2

(b) Reconstruction

Figure 7. Reconstruction of 1a using Regularised Boussinesq

5.2.3. Combining the estimates. The key to reconstructing the bottom-boundary is to improve the

error estimate.

In

other

words,

the

final

error

in

the

bottom-profile



e f

inal

=  - , at the end

of the algorithm described in Section 5.1, should be smaller than the initial error ienit = c - ,

where c is the initial guess for the bottom-profile. Consider the case of regularised Boussinesq.

Upon combining the estimate (59) with (55), we note the right-hand side of (49) can be estimated as

follows

(P q~x) P 22x

(P

q~x

)



e f

inal

2 = (P q~x) P x 2qe - P x ((P qex) ( + ))

2

(61)



12 µ4

(1

+ 

)

ienit 2

P q~x  sup
t

Pqx .

(62)

The error in the final estimated bottom profile will be small, if coefficient of



e init

2 can be made

as small as possible. For our simulations |q~x| and |qx| are typically less than 1. This is an out-

come of our non-dimensional scaling and the initial conditions we used. Thus to ensure accurate

reconstruction, we effectively need the combination (1 + )/ to be as small as possible. Although

this conclusion only holds for regularised Boussinesq, we conjecture a similar estimate is true for

regularised Boussinesq-Whitham. Our simulations indicate this is indeed the case.

5.3. Example reconstructions. In Figures 7 to 10 we show the result of applying the algorithm detailed above in the recovery of the two bottom profiles, Profile 1 and Profile 2 (see Figures 1a and 1b). The data necessary for reconstructing the bottom-boundary was obtained from a simulation of the model shallow-water equations (24-25) for either regularised Boussinesq or regularised BoussinesqWhitham. In both cases we set the shallowness parameter µ = 1 which corresponds to an aspect ratio for the fluid h/L  0.16. The initial condition for the shallow-water model is given by (33) with A = 0.0525. The solution (x, t) of the shallow-water wave models was used to drive the observer model (36-37). The parameters for the numerical simulation of the observer were the same as those discussed in Section 4.3. The initial condition for the surface deviation in the observer model is the same as the one in (33) but we set the initial velocity potential to zero. Our initial guess for the bottom boundary was z = -0.75 which corresponds to c = -0.25. The observer parameters were  = 10-2 and  = -1 + 2 which ensured the linear decay rate of  = /2. The relative error Eb (35)

L2 Error

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

24

101

100

10 1

10 2

10 3

10 4 et

10 5

q

10 6 0

qx 2

4 t6

8

10

0.7

0.8

z 0.9 1.0

1.1

Initial guess

Reconstruction

True bathymetry

1.20

1

2

3x 4

5

6

(a) Error decay  = 1/100,  = -1 + 2

(b) Reconstruction

Figure 8. Reconstruction of 1a using Regularised Boussinesq-Whitham

L2 Error

101

100

10 1

10 2

10 3

10 4 et

10 5

q

10 6 0

qx 2

4 t6

0.65

Initial guess

Reconstruction

0.70

True bathymetry

0.75

0.80 z 0.85

0.90

0.95

1.00

8

10

1.050

1

2

3x 4

5

6

(a) Error decay  = 1/100,  = -1 + 2

(b) Reconstruction

Figure 9. Reconstruction of 1b using Regularised Boussinesq

in the initial guess for the bottom-boundary was approximately 25% or 23% (for Profile 1 and Profile
2 respectively) which corresponds to an error of over 430% in terms of Ep (35). For either profile, the values for Eb for recovered bottom-boundary was 2 × 10-4 for regularised Boussinesq and 6 × 10-5 for regularised Boussinesq-Whitham. In terms of Ep, these are 99.5% and 99.9% accurate reconstructions. We did not observe the error in the initial guess of the bottom-profile to dramatically impact
the recovery, so long as the error in the estimated velocity q~x could be reduced to a sufficiently low value. A relative error of 10-4 in the estimated velocity (measured in the L2- norm) was sufficient in

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

25

L2 Error

101

100

10 1

10 2

10 3

10 4 et

10 5

q

10 6 0

qx 2

4 t6

0.65

Initial guess

0.70

Reconstruction True bathymetry

0.75

0.80 z 0.85

0.90

0.95

1.00

8

10

1.050

1

2

3x 4

5

6

(a) Error decay  = 1/100,  = -1 + 2

(b) Reconstruction

Figure 10. Reconstruction of 1b using Regularised Boussinesq-Whitham

all our examples. As evident in Figures 7 to 10, the error in the velocity follows the predicted linear rate whereas the error in the surface deviation saturates around 10-2. The surface deviation from the observer model ~, is not needed for the reconstruction algorithm and hence the higher level of error is not a cause of concern. The observer model was run till a nondimensional time of 2000 units. Note the horizontal axis in the error plots of Figures 7 to 10 is given in terms of t where  = 0.005. Our proposed algorithm successfully recovers the bottom-boundary with both shallow-water wave models and for different bottom profiles starting from a relatively inaccurate initial guess.
6. Summary and future work. We have shown that the simultaneous recovery of both velocities and bottom-boundary from only measurements of the surface deviation, in the context of dispersive shallow-water models, is possible. The motivation to consider bottom-boundary detection in shallow water comes from prior work [51]. The aspect ratios h/L for which we are able to recover the bottom profiles are larger, by an order of magnitude, than what was previously considered in [51]. This suggests there is some advantage to our prescription. We have also shown that velocimetry, the estimation of velocities, in Boussinesq-type shallow-water models is entirely feasible when given an accurate bottom-boundary profile. Moreover, using the observer framework, velocities can be accurately estimated even when the bottom-boundary profile is not known. Unlike traditional observers, for velocimetry with inaccurate bottom-boundary profiles, we cannot use the convergence of the measured state-variable (here ) to infer convergence of the full state-vector. Instead we employed the expected decay rate to ascertain when the velocity was sufficiently accurate. Lastly, we have shown that the ability to recover the bottom-boundary and velocity is not restricted to a particular shallow-water model. Indeed it seems recovery is possible for a class of models depending on the pseudo-differential operators 2, P.
Despite our success, we emphasise the ocean-depth measurement is a delicate process that involves carefully setting the parameters for the observer problem. The requirements for the simultaneous recovery of velocities and bottom profiles are somewhat contradictory. The nonlinear observer problem requires  to be sufficiently large to dominate any possible growth in the error due to the nonlinearity. On the other hand, recovering bathymetric features requires accurate q~x which demands  be taken as small as possible. Our numerical experiments indicate there is a parameter regime for which one may accurately reconstruct the bottom-boundary profile. In a future paper

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

26

we will explore the possibility for time-dependent observer parameters ,  that slowly relax from larger to smaller values and whether this provides any advantage.
All our simulations were conducted for one spatial variable, however the extension of the shallowwater model to two horizontal dimensions is straightforward. Indeed

t = 2(-i)q - P(-i) · [( + )P(-i)q] ,

(63)

qt

=

-

-

1 2

(P (-i)q)2

,

(64)

are the 2D versions, where 2 and P are defined as before but as functions of |k|. The observer equations may be similarly rewritten in two spatial dimensions. Most of our arguments can be adapted to the 2D case without difficulty. We leave the full investigation of the 2D ocean-depth measurement problem for a future work.
The simultaneous recovery of velocities and bottom-boundaries necessitated very long time simulations for the observer model. One might suspect this requires an equally long data record for (x, t). However this is not necessarily the case. The shallow-water models are Hamiltonian and thus time-reversible. This permits us to assimilate the data into the observer model in both the forward and backward directions of time, taking care to re-index the data record. This is the principle underlying back and forth nudging [6, 7]. To be precise, suppose we only had measurements of  for a finite duration of time [0, T]. We can run the observer model forward in time up to time T and then run the model backward in time using the final state of the observer as the new initial condition. In the backward-run, the data (x, t) is reversed in time.
For real-world applications, it is important to adapt our reconstruction algorithm to the case with non-periodic data (x, t). This would represent a significant improvement upon the problem as described in the current manuscript. When the domain is not periodic,  is not necessarily a constant and thus the system involves mass flux across the lateral boundaries. The successful modelling of this scenario would entail a re-derivation of the associated DNO and the Hamiltonian formulation, and subsequently obtaining the relevant approximations.
The current work did not consider the addition of noise in the measurements. As seen in other observer problems [8], adding noise to the measurements in the observer model will likely saturate the errors in q~x to non-zero values at the level of the noise, though the observer formulation itself is easy to adapt. Since a low relative-error in the estimated velocity was crucial to obtaining accurate bottom-profile reconstructions, noise will have a significant impact on the accuracy of the reconstructed profiles. As in [51], computing the time-derivative of  using finite differences is straightforward and not the main source of error. Instead the accuracy of the estimated velocities determines the ultimate success of the reconstruction algorithm.
And finally we conclude by emphasising the role implicitly played by model selection in the entire reconstruction process. In general, the regularised Boussinesq model has a number of favourable aspects that enabled us to estimate quantities of interest. However, the drawback of this model was the rapid of decay of eigenvalues for the linear operator in (34). The regularised BoussinesqWhitham model did not suffer from such a rapid decay however, we were not able to verify some of the estimates or required additional regularity assumptions on the bottom-profile. The reduction to the shallow-water regime was also important in allowing us to design the observer and the reconstruction algorithm in a relatively simple manner. Ultimately, the choice of model is dictated by our understanding and interpretation of the data, as well as our assumptions on the true bottomboundary. However, for the shallow-water model to actually model the full water-wave equations, these two factors may not be independent of each other [42]. Our work shows that the mathematical properties of these equations, specifically the interdependence of the dispersion relation 2 and regularisation P, implies some models may be preferable to others. We hope the combination of simple estimates and numerical simulations reported in this manuscript, afforded the reader some insight into the nature of this difficult inverse problem.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

27

Acknowledgements. The authors thank Amit Apte and Mythily Ramaswamy for all their helpful comments and suggestions. The authors acknowledge support of the Department of Atomic Energy, Government of India, under project no. RTI4001. VV acknowledges support through the SERB MATRICS Grant (MTR/2019/000609) from the Science and Engineering Research Board (SERB), Department of Science and Technology, Government of India. This work has been supported by the French government, through the UCAJEDI Investments in the Future project (UCA-ICTS joint program) managed by the National Research Agency (ANR) with the reference number ANR-15IDEX-01. The authors thank the Indo-French Centre for Applied Mathematics (IFCAM) for financial support under the "Observers for coupled models and parameter estimation" project.

Appendix A. Minimisation problems in the shallow water regime. Fontelos et al. [30] minimised

the functional

F() = 2(t - G(, )q)2dx,
0

to obtain the bottom-profile , given , t, q at one time instant. They showed the minimiser of this functional corresponded to the true bottom-profile. In [51], the authors employed a slightly different

methodology to obtain a similar minimisation problem. They too defined a functional dependent on

the bottom boundary, but in this case they derived an expression for the Neumann condition at some

bottom surface  (dependent on surface quantities , t, qx) and sought to minimise this quantity, thereby enforcing the no-normal flow condition. We now show through formal calculations that, in

the shallow-water regime, both approaches lead to the same minimisation problem (29).

To derive asymptotic expressions for the Neumann condition at the bottom boundary, that are

consistent with the models introduced in the previous section, we once again employ the global

relation introduced by [1]. However our focus will shift slightly. Specifically, we assume both condi-

tions at the surface z =  are known and both boundary conditions at z = -h -  are unknown. The

global relations are given by

eikx intCk( + 1) + qxSk( + 1) + QxSk() + inbCk() dx = 0,

(65)

eikx intSk( + 1) + qxCk( + 1) - QxCk() - inbSk() dx = 0,

(66)

where Ck( f ) = cosh(µk f ) and Sk( f ) = sinh(µk f ) and nt, nb denote the Neumann condition at the top and bottom respectively. Qx, qx denote the same quantities as before. An expression for the bottom Neumann condition nb consistent with the choice (26) is obtained via the substitution

Ck(

+

1)



1

+

(µk)2 2

,

Sk (

+

1)



µk

+

µ3k

+

(µk)3 6

Ck()  1, Sk()  µ3k. This leads to Qx = qx + h.o.t. and

-nb =

1 - µ22x 2

nt

+

qxx

-

µ2 6

qxxxx

+

x

((

+

)qx)

+

h.o.t.

(67)

Evidently, requiring the Neumann condition nb to vanish to the same order as regularised Boussinesq, for some , is equivalent to requiring

(nt - 2q + P x(( + )P qx))2 dx = 0,

(68)

with the choice (26). In exactly the same manner, the equation for the bottom Neumann-condition consistent with the approximations that lead to regularised Boussinesq-Whitham, is given by the same expressions as above but with the choice (28). Thus in the shallow-water regime, the approaches of [30] and [51] are formally equivalent.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

28

Appendix B. Energy for the linear observer problem. Consider an equivalent form of (41-42) given by

tet + te + (1 + )(2e - P x  (P xe ) = 0,

(69)

from which we deduce the energy relation

1 2 t

(te)2 + (1 + )

e 2e + (P xe )2

dx = - (te)2 dx.

(70)

One might reasonably suppose that the bottom boundary does not penetrate the free surface, at least for the trivial solution. This is sometimes known as the non-cavitation or no-island condition. For the full nonlinear problem one demands the fluid height 1 +  +  > 0. The analogue for the linear equation here is 1 +  > 0. Then we have a positive energy if

(e 2e - (P xe )2) dx  0.

(71)

At this stage we must treat our two models independently. We first consider regularised Boussinesq (26) which leads to

(e 2e - (P xe )2) dx = 
k

k2

1 + µ2k2/6 1 + µ2k2/2

|^ke |2

-

(1

k2 |^ke |2 + µ2k2/2)2

,

(72)

=
k

k2 |^ke |2

1 1

+ +

µ2k2/6 µ2k2/2

-

(1

+

1 µ2k2/2)2

 0.

(73)

Likewise for regularised Boussinesq-Whitham (28) we have

(e 2e - (P xe )2) dx =  |^ke|2

k tanh(µk) µ

-

tanh2(µk) µ2

,

(74)

=


k

k

tanh(µk) µ

|^ke |2

1

-

tanh(µk) µk

 0.

(75)

Hence the energy in both cases is positive so long as e is not a constant in space. If we further assume the mean of e remains zero for all time, i.e. there is no error in the mean value of the

surface deviation, then the potential energy may be bounded below. For the problem with periodic

boundary conditions, the discrete nature of the spectrum is to our advantage. For regularised

Boussinesq we have

(e 2e - (P xe )2) dx  C1(µ)

(xe )2,

C1(µ)

=

µ2(2/3 (1 +

+ µ2

µ2/12) /2)2

,

(76)

whereas for regularised Boussinesq-Whitham we have

(e

2e

- (P xe )2)

dx



C2(µ) µ

 k tanh(µk)|^ke|2,
k=0

C2(µ) = 1 - tanh(µ) , µ

(77)

Our purpose in considering the energy relation, is to investigate when the error will decrease mono-
tonically, at least for the linear observer problem. Indeed the solutions which prevent monotonic decrease in the error are the steady solutions: te = 0 for all time. However (69) then implies

2e - P x  (P xe ) = 0  e 2e - P x(P xe ) dx = 0.

From the lower bound obtained above we conclude that only constant e (in time and space) prevent
any decay in the error. But once again, the average of (41-42) in the x-direction indicates it is the mean-mode of qe that does not decay to zero. The zero mode of e decays exponentially. This is true
for both regularised Boussinesq and regularised Boussinesq-Whitham.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

29

References.

1. M. J. Ablowitz, A. S. Fokas, and Z. H. Musslimani, On a new non-local formulation of water waves, J. Fluid Mech. 562 (2006),

313­343.

2. P. Aceves-Sa´nchez, A.A. Minzoni, and P. Panayotaros, Numerical study of a nonlocal model for water-waves with variable depth,

Wave Motion 50 (2013), no. 1, 80­93.

3. A. Apte, D. Auroux, and M. Ramaswamy, Variational data assimilation for discrete Burgers equation, Electronic J. Diff. Eq.

Conference 19 (2010), 15­30.

4. A. Apte, D. Auroux, and M. Ramaswamy, Observers for compressible Navier­Stokes equation, SIAM Journal on Control and

Optimization 56 (2018), no. 2, 1081­1104.

5. D. Auroux, Several data assimilation methods for geophysical problems, Indian J. Pure Appl. Math. 37 (2006), 41­58.

6. D. Auroux and J. Blum, Back and forth nudging algorithm for data assimilation problems, Comptes Rendus Mathematique 340

(2005), no. 12, 873­878.

7.

, A nudging-based data assimilation method for oceanographic problems: the Back and Forth Nudging (BFN) algorithm,

Nonlin. Proc. Geophys. 15 (2008), 305­319.

8. D. Auroux and S. Bonnabel, Symmetry-based observers for some water-tank problems, IEEE Trans. Automat. Control 56 (2011),

no. 5, 1046­1058.

9. J.J. Becker, D.T. Sandwell, W.H.F. Smith, J. Braud, B. Binder, J.L. Depner, D. Fabre, J. Factor, S. Ingalls, S.H. Kim, et al.,

Global bathymetry and elevation data at 30 arc seconds resolution: Srtm30 plus, Marine Geodesy 32 (2009), no. 4, 355­371.

10. T. B. Benjamin, Impulse, flow force and variational principles, IMA Journal of Applied Mathematics 32 (1984), no. 1-3, 3­68.

11. J. L. Bona, T. Colin, and D. Lannes, Long wave approximations for water waves, Archive for rational mechanics and analysis

178 (2005), no. 3, 373­410.

12. L.J.F. Broer, On the Hamiltonian theory of surface waves, Applied Scientific Research 29 (1974), no. 1, 430­446.

13.

, Approximate equations for long water waves, Applied Scientific Research 31 (1975), no. 5, 377­395.

14. L.J.F. Broer, E. W.C. van Groesen, and J.M.W. Timmers, Stable model equations for long water waves, Applied Scientific

Research 32 (1976), no. 6, 619­636.

15. J. Brown, The ocean basins: Their structure and evolution, Elsevier, 2013.

16. R. Camassa, D. D. Holm, and C. D. Levermore, Long-time effects of bottom topography in shallow water, Physica D: Nonlinear

Phenomena 98 (1996), no. 2-4, 258­286.

17. J. D. Carter, E. Dinvay, and H. Kalisch, Fully dispersive Boussinesq models with uneven bathymetry, arXiv preprint

arXiv:2007.01909 (2020).

18. B. Chapron, F. Collard, and F. Ardhuin, Direct measurements of ocean surface velocity from space: Interpretation and validation,

Journal of Geophysical Research: Oceans 110 (2005), no. C7.

19. M. D. Collins and W. A. Kuperman, Inverse problems in ocean acoustics, Inverse Problems 10 (1994), 1023­1040.

20. W. Craig and M. D. Groves, Hamiltonian long-wave approximations to the water-wave problem, Wave Motion 19 (1994), no. 4,

367­389.

21. W. Craig, P. Guyenne, D. P. Nicholls, and C. Sulem, Hamiltonian long-wave expansions for water waves over a rough bottom,

Proc. R. Soc. A 461 (2005), 839­873.

22. W. Craig, P. Guyenne, and C. Sulem, Water waves over a random bottom, Journal of Fluid Mechanics 640 (2009), 79­107.

23. W. Craig and C. Sulem, Numerical simulation of gravity waves., J. Comp. Phys. 108 (1993), 73­83.

24. A.G. Davies and A.D. Heathershaw, Surface-wave propagation over sinusoidally varying topography, Journal of Fluid Mechan-

ics 144 (1984), 419­443.

25. P. J. Dellar and R. Salmon, Shallow water equations with a complete coriolis force and topography, Physics of fluids 17 (2005),

no. 10, 106601.

26. J. Deny and J.-L. Lions, Les espaces du type de Beppo Levi, Annales de l'institut Fourier, vol. 5, 1954, pp. 305­370.

27. E. Dinvay, On well-posedness of a dispersive system of the Whitham­Boussinesq type, Applied Mathematics Letters 88 (2019),

13­20.

28. E. Dinvay, D. Dutykh, and H. Kalisch, A comparative study of bi-directional Whitham systems, Applied Numerical Mathemat-

ics 141 (2019), 248­262.

29. L. C. Evans, Partial differential equations, Graduate studies in mathematics 19 (1998), no. 2.

30. M. A. Fontelos, R. Lecaros, J.C. Lo´ pez, and J. H. Ortega, Bottom detection through surface measurements on water waves, SIAM

Journal on Control and Optimization 55 (2017), no. 6, 3890­3907.

31. L. Gorman, A. Morang, and R. Larson, Monitoring the coastal environment; part iv: mapping, shoreline changes, and bathymetric

analysis, Journal of Coastal Research (1998), 61­92.

32. S. Grilli, Depth inversion in shallow water based on nonlinear properties of shoaling periodic waves, Coastal Engineering 35 (1998),

185­209.

33. J. Grue, Nonlinear water waves at a submerged obstacle or bottom topography, Journal of Fluid Mechanics 244 (1992), 455­476.

34. C. Heining and M. Sellier, Flow domain identification in three-dimensional creeping flows, Physics of Fluids 29 (2017), no. 1,

012107.

35. V. M. Hur and A. K. Pandey, Modulational instability in a full-dispersion shallow water model, Studies in Applied Mathematics

142 (2019), no. 1, 3­47.

OCEAN-DEPTH MEASUREMENT USING SWW MODELS

30

36. J. A. Johannessen, B. Chapron, F. Collard, V. Kudryavtsev, A. Mouche, D. Akimov, and K-F Dagestad, Direct ocean surface

velocity measurements from space: Improved quantitative interpretation of envisat asar observations, Geophysical Research Letters

35 (2008), no. 22.

37. S. Kar and A. Guha, Ocean bathymetry reconstruction from surface data using hydraulics theory, Physics of Fluids 30 (2018),

no. 12, 121701.

38. T. Kato, Perturbation theory for linear operators, vol. 132, Springer Science & Business Media, 2013.

39. J. A. Koslow, Seamounts and the ecology of deep-sea fisheries: The firm-bodied fishes that feed around seamounts are biologically

distinct from their deepwater neighbors--and may be especially vulnerable to overfishing, American Scientist 85 (1997), no. 2,

168­176.

40. E. Kunze and S. G. L. Smith, The role of small-scale topography in turbulent mixing of the global ocean, Oceanography 17 (2004),

no. 1, 55­64.

41. D. Lannes, Justifying asymptotics for 3D water­waves, Instability in Models Connected with Fluid Flows II, 2008, pp. 1­22.

42.

, The water waves problem: mathematical analysis and asymptotics, vol. 188, American Mathematical Soc., 2013.

43. D. Luenberger, An introduction to observers, IEEE Transactions on automatic control 16 (1971), no. 6, 596­602.

44. N. Mori, T. Takahashi, T. Yasuda, and H. Yanagisawa, Survey of 2011 tohoku earthquake tsunami inundation and run-up,

Geophysical research letters 38 (2011), no. 7.

45. D. P. Nicholls and M. Taber, Joint analyticity and analytic continuation of dirichlet­neumann operators on doubly perturbed

domains, Journal of Mathematical Fluid Mechanics 10 (2008), no. 2, 238­271.

46.

, Detection of ocean bathymetry from surface wave measurements, European Journal of Mechanics-B/Fluids 28 (2009),

no. 2, 224­233.

47. C. Piotrowski and J. Dugan, Accuracy of bathymetry and current retrievals from air-borne optical time-series imaging of shoaling

waves, IEEE Trans. on Geoscience and Remote Sensing 40 (2002), 2606­2618.

48. W. H. F. Smith and D. T. Sandwell, Bathymetric prediction from dense satellite altimetry and sparse shipboard bathymetry, Journal

of Geophysical Research: Solid Earth 99 (1994), no. B11, 21803­21824.

49. W. H.F. Smith and D. T. Sandwell, Conventional bathymetry, bathymetry from space, and geodetic altimetry, Oceanography -

The Oceanography Society 17 (2004), no. 1, 8­23.

50. M. I. Taroudakis and G. Makrakis, Inverse Problems in Underwater Acoustics, Springer-Verlag, New York, 2001.

51. V. Vasan and B. Deconinck, The inverse water wave problem of bathymetry detection, Journal of Fluid Mechanics 714 (2013),

562­590.

52. A. B. Watts, B. Tozer, H. Harper, B. Boston, D. J. Shillington, and R. Dunn, Evaluation of shipboard and satellite-derived

bathymetry and gravity data over seamounts in the northwest pacific ocean, Journal of Geophysical Research: Solid Earth 125

(2020), no. 10, e2020JB020396.

53. S. B. Yoon, Propagation of distant tsunamis over slowly varying topography, Journal of Geophysical Research: Oceans 107

(2002), no. C10, 4­1.

54. K.V. Zadiraka, Issledoavanie nereguljarnogo vozmuscennyh differencial'nyh uravenii, Voprosy teorii i istorii differencial'nyh

uravenii, Kiev (1968).

55. V. E. Zakharov, Stability of periodic waves of finite amplitude on the surface of a deep fluid, Zhurnal Prikladnoi Mekhaniki i

Tekhnicheskoi Fiziki 8 (1968), 86­94.

