arXiv:2106.00439v1 [math.AP] 1 Jun 2021

REGULARITY OF FLAT FREE BOUNDARIES FOR A p(x)-LAPLACIAN PROBLEM WITH RIGHT HAND SIDE
FAUSTO FERRARI AND CLAUDIA LEDERMAN
Abstract. We consider viscosity solutions to a one-phase free boundary problem for the p(x)-Laplacian with non-zero right hand side. We apply the tools developed in [D] to prove that flat free boundaries are C1,. Moreover, we obtain some new results for the operator under consideration that are of independent interest.

1. Introduction and main results

In this paper we study a one-phase free boundary problem governed by the p(x)-Laplacian with non-zero right hand side. More precisely, we denote by

p(x)u := div(|u|p(x)-2u),

where p is a function such that 1 < p(x) < +. Then our problem is the following:   p(x)u = f, in +(u) := {x   : u(x) > 0},

(1.1)

 |u| = g, on F (u) := +(u)  .

Here   Rn is a bounded domain, p  C1(), f  C()L() and g  C0,(), g  0.
This problem comes out naturally from limits of a singular perturbation problem with forcing term as in [LW1], where the authors analyze solutions to (1.1), arising in the study of flame propagation with nonlocal and electromagnetic effects. On the other hand, (1.1) appears by minimizing the following functional

(1.2)

E(v) =


|v|p(x) p(x)

+

Q2(x){v>0}

+

f (x)v

dx

studied in [LW3], as well as in the seminal paper by Alt and Caffarelli [AC] in the

case p(x)  2 and f  0. We refer also to [LW4], where (1.1) appears in the study

of an optimal design problem.

We are interested in the regularity of the free boundary for viscosity solutions

of (1.1). This problem has been already faced in [LW2] for weak solutions with the

aid of the techniques developed in [AC].

Key words and phrases. free boundary problem, singular/degenerate operator, variable exponent spaces, regularity of the free boundary, non-zero right hand side, viscosity solutions.
2020 Mathematics Subject Classification. 35R35, 35B65, 35J60, 35J70. F. F. was partially supported by INDAM-GNAMPA 2019 project: Proprieta` di regolarit`a delle soluzioni viscose con applicazioni a problemi di frontiera libera. C. L. was partially supported by the project GHAIA Horizon 2020 MCSA RISE 2017 programme grant 777822 and by the grants CONICET PIP 11220150100032CO 2016-2019, UBACYT 20020150100154BA and ANPCyT PICT 2016-1022. C. L. wishes to thank the Department of Mathematics of the University of Bologna, Italy, for the kind hospitality.
1

2

FAUSTO FERRARI AND CLAUDIA LEDERMAN

In the present work we are following the strategy introduced in the important paper by De Silva [D], that was inspired by [S], for one-phase problems and linear non-divergence operators. [D] was further extended to two-phase problems in different settings, see [DFS1, DFS2, DFS3]. The same technique was applied to the p-Laplace operator (p(x)  p in (1.1)) for the one phase case, with p  2, in [LR]. See also [LT].
In the linear homogeneous case, f  0, (1.1) was studied for viscosity solutions in the pioneer works by Caffarelli [C1, C2]. The results in [C1, C2] have been widely generalized to different classes of homogeneous elliptic problems. See for example [CFS, FS1, FS2] for linear operators, [AF, F1, F2, Fe1, W1, W2, RT] for fully nonlinear operators and [LN1, LN2] for the p-Laplacian. See also [ART].
As already mentioned, problem (1.1) was originally studied in the linear homogeneous case in [AC], associated to (1.2). These techniques were generalized to the linear case with f  0 in [GS, Le]. In the homogeneous case, to a quasilinear uniformly elliptic situation [ACF], to the p-Laplacian [DP], to an Orlicz setting [MW] and to the p(x)-Laplacian with p(x)  2 [FMW]. Finally, (1.1) with 1 < p(x) <  and f  0 was dealt with in [LW2].

In this paper we show that flat free boundaries of viscosity solutions to (1.1) are C1,. In the forthcoming work [FL] we prove that Lipschitz free boundaries of viscosity solutions to (1.1) are C1,.
Our main result is the following (for the precise definition of viscosity solution to (1.1) we refer to Section 2)

Theorem 1.1 (Flatness implies C1,). Let u be a viscosity solution to (1.1) in B1. Assume that 0  F (u), g(0) = 1 and p(0) = p0. There exists a universal constant ¯ > 0 such that, if the graph of u is ¯-flat in B1, in the direction en, that is

(1.3)

(xn - ¯)+  u(x)  (xn + ¯)+, x  B1,

and

(1.4)

p L(B1)  ¯,

then F (u) is C1, in B1/2.

f L(B1)  ¯, [g]C0,(B1)  ¯,

In addition to the assumptions already stated above, we suppose that

(1.5)

p  L()

and that there exist positive numbers pmin, pmax, such that

(1.6)

1 < pmin  p(x)  pmax < .

In Theorem 1.1 the constants ¯ and  depend only on pmin, pmax and n (the dimension of the space).
The proof of Theorem 1.1 is based on an improvement of flatness, obtained via a compactness argument which linearizes the problem into a limiting one. The key tool is a geometric Harnack inequality that localizes the free boundary well, and allows the rigorous passage to the limit.
Let us point out that carrying out, for the inhomogeneous p(x)-Laplace operator, the strategy devised in [D] required the development of new tools. In fact, the p(x)Laplacian is a nonlinear operator that appears naturally in divergence form from

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

3

minimization problems, i.e., in the form divA(x, u) = f (x), with

||p(x)-2||2



i,j=1n

Ai j

(x,

)i

j



||p(x)-2||2,

  Rn.

This operator is singular in the regions where 1 < p(x) < 2 and degenerate in the ones where p(x) > 2.
Some results for this type of operators we needed to use to achieve our goals are available in the literature for weak solutions (in the sense of Definition 3.1 in Section 3). These results are Harnack inequality (see [Wo]) and C1, estimates (see [Fa] and [FZ]). However, the program followed in [D] relies on solutions of the corresponding equations in a viscosity sense (see [CIL]).
The equivalence between weak and viscosity solutions of p(x)u = f was proved in [JJ, JLM, MO] in the case of the p-Laplacian (i.e., for p(x)  p) and in [JLP] in the case of the homogeneous p(x)-Laplacian (i.e., for f  0). To our knowledge there is no such result in the literature for the inhomogeneous p(x)-Laplacian.
Hence, in order to proceed with the arguments in [D], we prove in Theorem 3.2 that weak solutions of p(x)u = f are indeed viscosity solutions. This new result is of independent interest, since it may be applied in other contexts.
On the other hand, the approach in [D] requires the use of barriers of the type w(x) = c1|x-x0|- -c2, together with suitable modification of them. In the present work we are able to employ the same kind of barriers. Showing that they are also appropriate to deal with the inhomogeneous p(x)-Laplace operator was a nontrivial and delicate task, that we perform in Lemma 4.2. Again, the difficulty relies on the nonlinear singular/degenerate nature and x dependence of our equation and also on the presence of the logarithmic term appearing in the nondivergence form of the operator (see (3.1)).
The results in Lemma 4.2 are new even for p(x)  p in the range 1 < p < 2. These barriers, which are novel in the p(x)-Laplace context, are different from the ones used in the literature for this operator (see, for instance, [FMW, Wo, LW4]). Consequently, our results in Lemma 4.2 have possible applications to other situations.
We would like to stress at this stage that partial differential equations with nonstandard growth have been receiving a lot of attention and that the p(x)-Laplacian is a model case in this class. A list of applications of this type of operators includes the modelling of non-Newtonian fluids, for instance, electrorheological [R] or thermorheological fluids [AR]. Also non-linear elasticity [Z1], image reconstruction [AMS, CLR] and the modelling of electric conductors [Z2], to cite a few.
The fact that solutions to the inhomogeneous p(x)-Laplacian are locally of class C1, plays a critical role in the analysis of this paper. A comprehensive account for sharp conditions for regularity of solutions of some elliptic equations with nonstandard growth can be found in [AM] and [Fa].
We finally remark that our main result, Theorem 1.1, is applied in the companion paper [FL] to prove that Lipschitz free boundaries of viscosity solutions of (1.1) are C 1, .
Our work is organized a follows. In Section 2 we provide notation and basic definitions, and we also present an auxiliary result on a Neumann problem which will be used in the proof of Theorem 1.1. In Section 3 we discuss the relationship between the different notions of solutions to p(x)u = f we are using. In particular,

4

FAUSTO FERRARI AND CLAUDIA LEDERMAN

we prove Theorem 3.2 which shows that weak solutions to p(x)u = f are viscosity solutions of the same equation. In Section 4 we prove some auxiliary results, which include Lemma 4.2, concerning the existence of barrier functions for p(x)u = f . Next, in Section 5 we prove a geometric Harnack inequality for problem (1.1). In Section 6 we prove an improvement of flatness lemma. Finally, in Section 7 we prove our main result, Theorem 1.1. For the sake of completeness, we also include an Appendix at the end of the paper where we introduce the Sobolev spaces with variable exponent, which are the appropriate spaces to work with weak solutions of the p(x)-Laplacian.

2. Basic definitions, notation and preliminaries
In this section, we provide notation and basic definitions we will use throughout our work. We also present an auxiliary result on a Neumann problem that will be applied in the paper. Notation. For any continuous function u :   Rn  R we denote
+(u) := {x   : u(x) > 0}, F (u) := +(u)  .
We refer to the set F (u) as the free boundary of u, while +(u) is its positive phase (or side).
Below we give the definition of viscosity solution to problem (1.1) and we deduce some consequences. In particular, we refer to the usual C-viscosity definition of sub/supersolution and solution of an elliptic PDE, see e.g. [CIL].
First we need the following standard notion.
Definition 2.1. Given u,   C(), we say that  touches u from below (resp. above) at x0   if u(x0) = (x0), and
u(x)  (x) (resp. u(x)  (x)) in a neighborhood O of x0.
If this inequality is strict in O \ {x0}, we say that  touches u strictly from below (resp. above).
Definition 2.2. Let u be a continuous nonnegative function in . We say that u is a viscosity solution to (1.1) in , if the following conditions are satisfied:
(i) p(x)u = f in +(u) in the weak sense of Definition 3.1, see Section 3. (ii) For every   C(),   C2(+()). If + touches u from below (resp.
above) at x0  F (u) and (x0) = 0, then
|(x0)|  g(x0) (resp.  g(x0)).
Next theorem follows as a consequence of Theorem 3.2 in Section 3.
Theorem 2.3. Let u be a viscosity solution to (1.1) in . Then the following conditions are satisfied:
(i) p(x)u = f in +(u) in the viscosity sense, that is: (ia) for every   C2(+(u)) and for every x0  +(u), if  touches u from above at x0 and (x0) = 0, then p(x0)(x0)  f (x0), that is, u is a viscosity subsolution; (ib) for every   C2(+(u)) and for every x0  +(u), if  touches u from below at x0 and (x0) = 0, then p(x0)(x0)  f (x0), that is, u is a viscosity supersolution.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

5

(ii) For every   C(),   C2(+()). If + touches u from below (resp. above) at x0  F (u) and (x0) = 0, then
|(x0)|  g(x0) (resp.  g(x0)).
Remark 2.4. If p(x)  p or f  0, then any function satisfying the conditions of Theorem 2.3 is a solution to (1.1) in the sense of Definition 2.2 (see Remark 3.3).

We introduce also the notion of comparison sub/supersolution.

Definition 2.5. We say that v  C() is a strict (comparison) subsolution (resp. supersolution) to (1.1) in  if v  C2(+(v)), v = 0 in +(v) and the following conditions are satisfied:
(i) p(x)v > f (resp. < f ) in +(v); (ii) If x0  F (v), then
|v(x0)| > g(x0) (resp. |v(x0)| < g(x0)).
Notice that by the implicit function theorem, according to our definition, the free boundary of a comparison sub/supersolution is C2.
As a consequence of the previous discussion we have

Lemma 2.6. Let u be a viscosity solution to (1.1) in . If v is a strict (comparison) subsolution to (1.1) in  and u  v+ in  then u > v in +(v)F (v). Analogously, if v is a strict (comparison) supersolution to (1.1) in  and v  u in  then v > u in +(u)  F (u).
Notation. From now on B(x0)  Rn will denote the open ball of radius  centered at x0, and B = B(0). A positive constant depending only on the dimension n, pmin, pmax will be called a universal constant. We will use c, ci to denote small universal constants and C, Ci to denote large universal constants.

The rest of the section is devoted to the study of the linearized problem associated with our free boundary problem (1.1). That is, the classical Neumann problem for a constant coefficient linear operator. Precisely, we consider the following boundary value problem:

(2.1)

Lp0 u~ = 0 in B  {xn > 0}, u~n = 0 on B  {xn = 0}.

Here 1 < pmin  p0  pmax < , u~n denotes the derivative in the en direction of u~ and

(2.2)

Lp0 u := u + (p0 - 2)nnu.

Theorem 1.1 will follow via a compactness argument combined with regularity

properties of solutions to (2.1), namely Theorem 2.9.

We use the notion of viscosity solution to (2.1). We recall standard notions and

a regularity result for viscosity solutions to (2.1).

Definition 2.7. Let u~ be a continuous function on B  {xn  0}. We say that u~ is a viscosity solution to (2.1) if given a quadratic polynomial P (x) touching u~ from below (resp. above) at x¯  B  {xn  0},
(i) if x¯  B  {xn > 0} then Lp0 P  0 (resp. Lp0 P  0), i.e. Lp0 u~ = 0 in the viscosity sense in B  {xn > 0};

6

FAUSTO FERRARI AND CLAUDIA LEDERMAN

(ii) if x¯  B  {xn = 0} then Pn(x¯)  0 (resp. Pn(x¯)  0).

Remark 2.8. Notice that in the definition above we can choose polynomials P that touch u~ strictly from above/below. Also, it suffices to verify that (ii) holds for polynomials P with Lp0 P > 0 (see [D]).
We will use the following regularity result for viscosity solutions to the linearized problem (2.1). For the proof we refer to Theorem 7.4 in [MS].

Theorem 2.9. Let u~ be a viscosity solution to (2.1) in B1/2  {xn  0}. Then, u~  C2(B1/2  {xn  0}) and it is a classical solution to (2.1).
Moreover, if u~   1, then there exists a constant C¯ > 0, depending only on

n, pmin and pmax, such that

(2.3)

|u~(x) - u~(0) - u~(0) · x|  C¯r2 in Br  {xn  0},

for all r  1/4.

3. Different notions of solutions to p(x)-Laplacian

In this section we discuss the relationship between the different notions of solu-
tions to p(x)u = f we are using, namely weak and viscosity solutions. We start by observing that direct calculations show that, for C2 functions u such
that u(x) = 0,

(3.1)

p(x)u = div(|u|p(x)-2u) = |u(x)|p(x)-2 u + (p(x) - 2)Nu + p(x), u(x) log |u(x)| ,

where

Nu :=

D2

u(x)

u(x) |u(x)|

,

u(x) |u(x)|

denotes the normalized -Laplace operator.

First we need (see the Appendix for the definition of Sobolev spaces with variable

exponent)

Definition 3.1. Assume that 1 < pmin  p(x)  pmax <  with p(x) Lipschitz continuous in  and p L  L, for some L > 0 and f  L().
We say that u is a weak solution to p(x)u = f in  if u  W 1,p(·)() and, for every   C0(), there holds that

- |u(x)|p(x)-2u ·  dx =  f (x) dx.





We next prove

Theorem 3.2. Let p and f be as in Definition 3.1. Assume moreover that f  C() and p  C1().
Let u  W 1,p(·)()  C() be a weak solution to p(x)u = f in . Then u is a viscosity solution to p(x)u = f in .

Proof. Let us show that u is a viscosity supersolution to p(x)u = f in . Step I. We will first prove the result under the extra assumption that f 
W 1,() and p  C1,(), for some 0 <  < 1. In fact, let v  C2() such that v touches u from below at x0  , with
v(x0) = 0. We will show that

(3.2)

p(x0)v(x0)  f (x0).

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

7

Let us fix r > 0 such that Br(x0)  . From Theorem 1.1 in [Fa] we know that u  C1, in Br(x0), for some 0 <  < 1. We can assume that   .
Since v touches u from below at x0, we know that u(x0) = v(x0) = 0. Then, we can choose r small enough so that

c1  |u(x)|  C1 in Br(x0), (c1, C1 positive constants).

Now, arguing as in Theorem 3.2 in [CL] we deduce that u  Wl2o,c2(Br(x0)) and it is a solution to the linear uniformly elliptic equation

n

n

p(x)u =

aij (x)uxixj + bi(x)uxi = f

i,j=1

i=1

in Br(x0)

where

aij (x) = |u|p(x)-2

ij

+

(p(x)

-

2)

uxi uxj |u|2

,

and bi(x) = |u|p(x)-2 pxi(x) log |u| ,

with

n

1||2 

aij (x)ij  2||2,

i,j=1

  RN , x  Br(x0),

for 1, 2 positive constants. It follows (see, for instance, Theorem 9.19 in [GT]) that u  C2, in Br(x0).
Since v touches u from below at x0, we have u(x0) = v(x0) and D2u(x0)  D2v(x0) and then,

f (x0) = p(x0)u(x0)

n

=

|u(x0 )|p(x0 )-2

i,j=1

ij

+

(p(x0)

-

2)

uxi (x0)uxj (x0 |u(x0)|2

)

n
+ |u(x0)|p(x0)-2 pxi (x0) log |u(x0)| uxi (x0)

i=1

 p(x0)v(x0).

uxixj (x0)

That is, (3.2) holds.

Step II. We now assume that f and p are as in the statement and we will show
that u is a viscosity supersolution to p(x)u = f in . Again, let v  C2() such that v touches u from below at x0  , with v(x0) =
0. We will show that

(3.3)

p(x0)v(x0)  f (x0).

Assume that p(x0)v(x0) > f (x0). Then, there exist r > 0 and  > 0 small such that

(3.4)

|v(x)| >  in Br(x0), p(x)v(x) > f (x) +  in Br(x0).

8

FAUSTO FERRARI AND CLAUDIA LEDERMAN

We

now

take

pk



C1, (Br(x0)),

for

some

0

<



<

1,

with

1 2

(1

+

pmin)



pk(x)  pmax, pk  p in Br(x0) and pk L  2L, and fk  W 1,(Br(x0)),

||fk||L  2||f ||L, such that

(3.5)

fk  f uniformly on Br(x0), pk  p and pk  p uniformly on Br(x0).

Let uk  W 1,pk(·)(Br(x0)) be the (weak) solutions to pk(x)uk = fk in Br(x0), uk = u on Br(x0).

Using Theorem 4.1 in [FZ] and Theorem 1.2 in [Fa], we get that uk  C1, in Br(x0), for some 0 <  < 1, ||uk||C1,(Br(x0))  C and

(3.6)

uk  u uniformly on Br(x0).

Moreover, from the results in Step I we know that, for every k, uk is a viscosity
supersolution to pk(x)uk = fk in Br(x0). We fix  > 0 and define

v(x) = v(x) - |x - x0|2.

Since there holds (3.4), we can choose  small enough so that

(3.7)



|v(x)| > 2 in Br(x0),

p(x)v(x)

>

f (x)

+

 2

in Br(x0).

Now, from (3.5) and (3.7), we get

(3.8)

pk(x)v(x)

>

fk(x)

+

 4

in Br(x0),

if k  k0.

We

now

take

0

<



<

 4

r2.

Recalling

(3.6),

we

can

choose

k



k0

such

that

|uk - u| <  in Br(x0),

so that we have We now take Then, |t¯|   and

uk +  > v in Br(x0), uk(x0) -  < v(x0).
t¯ = inf t  R / uk + t  v in Br(x0) .

(3.9)

uk  v - t¯ in Br(x0), uk(x¯) = v(x¯) - t¯, for some x¯  Br(x0).

Suppose x¯  Br(x0). Then,

uk(x¯) = v(x¯) - t¯ = v(x¯) - r2 - t¯  u(x¯) - r2 +   uk(x¯) + 2 - r2,

a

contradiction since Then x¯  Br(x0)

we have chosen  < and (3.9) says that

 4
v

r2 -

. t¯

touches

uk

from below at x¯.

Since

v(x¯) = 0, we get

pk(x¯)v(x¯)  fk(x¯).

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

9

This contradicts (3.8) and we conclude that (3.3) holds. So u is a viscosity supersolution to p(x)u = f in .
The proof that u is a viscosity subsolution to p(x)u = f in  follows similarly.

Remark 3.3. As already mentioned in the Introduction, the equivalence between weak and viscosity solutions to the p(x)-Laplacian with right hand side f  0 was proved in [JLP]. On the other hand, this equivalence, in case p(x)  p and f  0 was dealt with in [JJ] and [MO]. See also [JLM] for the case p(x)  p and f  0.

We also obtain the following result that will be used in the proof of Lemma 5.1

Proposition 3.4. Let p and f be as in Definition 3.1. Let B2r(x0)  . Let u  W 1,p(·)()  L() be a weak solution to p(x)u = f in  such that

c1  |u(x)|  C1 in B2r(x0), c1, C1 positive constants.

Then, u  W 2,n(Br(x0)) and it is a strong solution to the linear uniformly elliptic equation

n

n

aij (x)uxixj + bi(x)uxi = f

i,j=1

i=1

in Br(x0)

where and

aij (x) = |u|p(x)-2

ij

+

(p(x)

-

2)

uxi uxj |u|2

,

bi(x) = |u|p(x)-2 pxi(x) log |u| ,

with
n

1||2 

aij(x)ij  2||2,   RN , x  Br(x0),

i,j=1

for 1, 2 positive constants, depending only on c1, C1, pmin, pmax.

Proof. We take fk  W 1,(B2r(x0)), ||fk||L  2||f ||L, such that fk  f in L1(B2r(x0)).

Let uk  W 1,p(·)(B2r(x0)) be the (weak) solutions to

p(x)uk = fk in B2r(x0),

uk = u on B2r(x0).

Using Theorem 4.1 in [FZ] and Theorem 1.2 in [Fa], we get that uk  C1, in B2r(x0), for some 0 <  < 1, ||uk||C1,(B2r(x0))  C and

uk  u, uk  u uniformly on B2r(x0).

Then, for k large,

c1 2



|uk (x)|



2C1

in B2r(x0).

Now, arguing as in Theorem 3.2 in [CL], we deduce that, for k large, uk  Wl2o,c2(B2r(x0))

and it is a solution to the linear uniformly elliptic equation

n

n

akij (x)(uk)xixj +

bki (x)(uk)xi = fk

i,j=1

i=1

in B2r(x0)

10

FAUSTO FERRARI AND CLAUDIA LEDERMAN

where and

akij (x) = |uk|p(x)-2

ij

+

(p(x)

-

2)

(uk)xi (uk)xj |uk |2

,

bki (x) = |uk|p(x)-2 pxi (x) log |uk| ,

with

n

1||2 

akij (x)ij  2||2,   RN , x  B2r(x0),

i,j=1

for 1, 2 positive constants, depending only on c1, C1, pmin, pmax. Moreover, akij  C(B2r(x0)) and ||bki ||L(B2r(x0))  C¯.
It follows (see, for instance, Lemma 9.16 and Theorem 9.11 in [GT]) that

uk  Wl2o,cn(B2r (x0))  L(B2r(x0)) and ||uk||W 2,n(Br(x0))  C~,
for some positive constant C~. Then, passing to the limit k  , we get the desired result.

4. Auxiliary results

In this section we prove some results that will be of use in our main theorem. Namely, a Harnack inequality for an auxiliary problem of p(x)-Laplacian type and an existence result of barrier functions for the p(x)-Laplacian operator.
In the next result we assume for simplicity that ||f ||L()  1, but a similar result holds for any f  L(). We have

Lemma 4.1. Assume that 1 < pmin  p(x)  pmax <  with p(x) Lipschitz continuous in  and p L  L, for some L > 0. Let x0   and 0 < R  1 such that B4R(x0)  . Let v  W 1,p(·)()  L() be a nonnegative solution to

(4.1)

div(|v + e|p(x)-2(v + e)) = f in ,

where f  L() with ||f ||L()  1 and e  Rn with |e| = 1. Then, there exists C such that

(4.2)

1

sup v  C
BR (x0 )

inf v + R
BR (x0 )

||f ||L(B4R(x0)) pmax-1 + C

.

The constant C depends only on n, pmin, pmax, ||v||L(B4R(x0)) and L.

Proof. We define A :  × Rn  Rn

A(x, ) = | + e|p(x)-2( + e).

Then equation (4.1) takes the form

div A(x, v) = f (x) in .

We first observe that, for every   Rn,

|A(x, )| = | + e|p(x)-1  C1||p(x)-1 + C1, where C1 depends only on pmax. On the other hand, for every   Rn,
A(x, ),  = | + e|p(x)-2  + e, 

(4.3)

= | + e|p(x) - | + e|p(x)-2  + e, e

 | + e|p(x) - | + e|p(x)-1.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

11

Now, if | + e|  2, we get from (4.3)

(4.4)

A(x, ),   | + e|p(x) - 2p(x)-1  C2||p(x) - C3,

where C2 and C3 depend only on pmax. If | + e| > 2, we obtain from (4.3)

A(x, ),   | + e|p(x) - | + e|p(x)-1

(4.5)

= | + e|p(x)(1 - | + e|-1)



1 2

|

+

e|p(x)



C4 | |p(x)

-

1 2

,

where C4 depends only on pmax. Then, from (4.4) and (4.5) we deduce

A(x, ),   C5||p(x) - C6,

where C5 and C6 depend only on pmax. Now the result follows from Theorem 1.1 in [Wo].

We now continue with a technical result concerning the existence of barrier functions for the p(x)-Laplacian operator.

Lemma 4.2. Let x0  B1 and 0 < r¯1 < r¯2  1. Assume that 1 < pmin  p(x)  pmax <  and p L  1+, for some 0 <   1. Let c0, c1, c2 be positive constants and let and c3  R.
There exist positive constants   1, c¯, 0 and 1 such that the functions

w(x) = c1|x - x0|- - c2,

v(x)

=

q(x)

+

c0 2

(w(x)

-

1),

q(x) = xn + c3

satisfy, for r¯1  |x - x0|  r¯2,

(4.6)

p(x)w  c¯, for 0 <   0,

(4.7)

1 2



|v|



2,

p(x)v > 2, for 0 <   1.

Here  = (n, pmin, pmax), c¯ = c¯(pmin, pmax, c1), 0 = 0(n, pmin, pmax, r¯1, c1), 1 = 1(n, pmin, pmax, r¯1, c0, c1, ).

Proof. Without loss of generality we can assume that x0 = 0. We will divide the proof into five steps.

Step 1. For simplicity, we assume first that c1 = 1. Let us fix p  R, 1 < pmin  p  pmax <  and  > 0. Let us consider x  Rn \ {0}.
Then, w(x) = |x|- - c2 and w = -|x|--2x, so that

w |w|

=

-

x |x|

.

Moreover (4.8)

D2w

=

(

+

2)|x|--2

x |x|



x |x|

-

 |x|- -2 I

= |x|--2

(

+

2)

x |x|



x |x|

-

I

.

12

FAUSTO FERRARI AND CLAUDIA LEDERMAN

As a consequence (4.9)

Tr(D2w) = |x|--2 (( + 2) - n) .

Thus

(4.10)

pw = |w|p-2

w

+

(p

-

2)

D2w

w |w|

,

w |w|

= p-1|x|-(+1)(p-2)|x|--2

(

+

2)

-

n

+

(p

-

2)

[(

+

2)

x |x|



x |x|

-

I

]

x |x|

,

x |x|

= p-1|x|-(p-1)-p ( + 2 - n + (p - 2)( + 1))

= p-1|x|-(p-1)-p ((p - 1) + p - n)

 p-1|x|-(p-1)-p ((pmin - 1) + pmin - n)  p-1|x|-(p-1)-p,

if  > 0 is such that

(4.11)

(pmin - 1) + pmin - n  1.

On the other hand,

D2v

=

c0 2

D2w.

Then, for x such that v(x) = 0,

(4.12)

pv = |v|p-2

v

+

(p

-

2)

D2v

v |v|

,

v |v|

=

c0 2

|v|p-2

w

+

(p

-

2)

D2w

v |v|

,

v |v|

=

c0 2



|v|p-2|x|--2

(

+

2)

-

n

+

(p

-

2)

[(

+

2)

x |x|



x |x|

-

I

]

v |v|

,

v |v|

=

c0 2



|v|p-2|x|--2

( + 2) - n + (p - 2)

( + 2)

x |x|

,

v |v|

2-1

=

c0 2



|v|p-2|x|--2

( + 2)

1 + (p - 2)

x |x|

,

v |v|

2

-n-p+2

.

We also observe that (4.13)

0

x |x|

,

v |v|

2

 1.

Hence, in case pmin  p  2, it follows from (4.12)

(4.14)

pv



c0 2



|v|p-2

|x|--2

{(

+ 2)(1 + p

- 2) -

n-

p + 2}

=

c0 2



|v|p-2

|x|--2

{(

+ 2)(p - 1) -

n-

p+

2}



c0 2



|v|p-2

|x|--2

{(

+ 2)(pmin

-

1) -

n}



c0 2



|v|p-2|x|--2,

if  > 0 is such that

(4.15)

( + 2)(pmin - 1) - n  1.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

13

Moreover, in case 2 < p  pmax, it follows from (4.12)

(4.16)

pv



c0 2



|v|p-2|x|--2

(

+

2

-

n

-

p

+

2)



c0 2



|v|p-2|x|--2

(

+4

-n

- pmax)



c0 2



|v|p-2|x|--2,

if  > 0 is such that

(4.17)

 + 4 - n - pmax  1.

We now fix

(4.18)

 = (n, pmin, pmax) = max

1,

1

+ n - pmin pmin - 1

,

1+n pmin - 1

-

2,

n + pmax - 3

.

Then,  = (n, pmin, pmax)  1 and  satisfies (4.11), (4.15) and (4.17). Hence we obtain from (4.10), (4.14) and (4.16) that for every p  [pmin, pmax] and x  Rn \{0}

(4.19)

pw  |x|-(p-1)-p,

(4.20)

pv



c0 2

|v|p-2

|x|--2

,

if v(x) = 0.

Step 2. We now assume that c1 > 0 is arbitrary. We fix  = (n, pmin, pmax)  1 as above, given by (4.18). It is not hard to see that similar computations as those in Step 1, but with c1 > 0 arbitrary, imply that for every p  [pmin, pmax] and x  Rn \ {0}

(4.21)

pw  c1p-1|x|-(p-1)-p,

(4.22)

pv



c0 2

c1|v|p-2|x|-

-2,

if v(x) = 0.

Step 3. We now observe that there holds

v

=

en

+

c0 2

w.

Then, for r¯1  |x|  r¯2,

|v| - 1

=

|v| - |en|



v - en

=

c0 2

w

=

c0 2

c1|x|-

-1



c0 2

c1  r¯1- -1



1 2

,

if we let   ¯1 = ¯1(n, pmin, pmax, r¯1, c0, c1) and therefore,

(4.23)

1 2



|v|



2,

for   ¯1.

So the first assertion in (4.7) follows.

Step 4. We now consider p(x) a Lipschitz continuous function such that 1 < pmin  p(x)  pmax < .
We first observe that, for any R  1,

tp(x)-1 log t  tpmin-1 log t  C1(pmin),

if 0 < t < 1,

tp(x)-1 log t  tpmax-1 log t  Rpmax-1 log R

if 1  t  R,

so that

(4.24)

tp(x)-1 log t  C2(pmin, pmax, R),

if 0 < t  R.

14

FAUSTO FERRARI AND CLAUDIA LEDERMAN

It then follows from (4.23) and (4.24) that, for r¯1  |x|  r¯2,

(4.25)

|v|p(x)-1 log |v|  C3(pmin, pmax),

if   ¯1.

We also have, for r¯1  |x|  r¯2,

|w| = c1|x|--1  c1r¯1--1,

so using again (4.24), we get, for r¯1  |x|  r¯2,

(4.26)

|w|p(x)-1 log |w|  C4(n, pmin, pmax, r¯1, c1).

Step 5. We now assume that p(x) satisfies moreover that p L  1+, for some 0 <  < 1. Then, from (4.25) we obtain, for r¯1  |x|  r¯2,
(4.27) |v|p(x)-2 p(x), v log |v|  |v|p(x)-1 log |v| p L  1+C3,

if   ¯1. Hence, from (4.22),(4.27) and (4.23), for r¯1  |x|  r¯2,

(4.28)

p(x)v

=

|v|p(x)-2(v

+

(p(x)

-

2)

D2v

v |v|

,

v |v|

+

p(x), v

log |v| )



c0 2

c1|v|p(x)-2|x|--2

- 1+C3



c0 2

c1C5|x|-

-2

-

1+ C3



c0 2

c1C5

-

1+ C3

=

(

c0 2

c1

C5

- C3),

if   ¯1, where we have used that r¯2  1 and C5 = C5(pmin, pmax), C5 =

min{(

1 2

)pmax

-2

,

2pmin

-2

}.

We

conclude

that,

for

r¯1



|x|



r¯2,

p(x)v



(

c0 2

c1C5

-

 C3 )





c0 4

c1C5

>

2,

if moreover   ~1 = ~1(pmin, pmax, c0, c1, ). That is, the second assertion in (4.7) follows.
Finally, from (4.26) we obtain, for r¯1  |x|  r¯2, (4.29)
|w|p(x)-2 p(x), w log |w|  |w|p(x)-1 log |w| p L  1+C4.

Hence, from (4.21) and (4.29), for r¯1  |x|  r¯2,

(4.30)

p(x)w

=

|w|p(x)-2(w

+

(p(x)

-

2)

D2

w

w |w|

,

w |w|

+

p(x), w log |w| )

 cp1(x)-1|x|-(p(x)-1)-p(x) - 1+C4  2c¯ - C4,

if   1. Here we have used that r¯2  1 and we have denoted c¯ = c¯(pmin, pmax, c1) =

1 2

min{c1pmin-1, c1pmax-1}.

We

conclude

that,

for

r¯1



|x|



r¯2,

p(x)w  c¯,

if   0 = 0(n, pmin, pmax, r¯1, c1). This proves (4.6) and finishes the proof.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

15

5. Geometric regularity results

In this section we prove a Harnack type inequality for a solution u to problem (1.1), following the approach in [D]. We will argue assuming that (5.1) ||f ||L()  2, ||g - 1||L()  2, ||p||L()  1+, ||p - p0||L()  ,
holds, for 0 <  < 1, for some constant 0 <  1.
The proof of Harnack inequality is based on the following lemma.

Lemma 5.1. Let u be a solution to (1.1)­(5.1) in B1. There exists a universal constant ¯ such that if 0 <   ¯ and u satisfies

(5.2)

q+(x)  u(x)  (q(x) + )+, x  B1, q(x) = xn + ,

and

in

x0

=

1 10

en,

then

u(x0)



(q (x0 )

+

 2

)+,

||

<

1 20

,

(5.3)

u  (q + c)+ in B 1 , 2

for some universal 0 < c < 1. Analogously, if

(5.4)

u(x0)



(q (x0 )

+

 2

)+,

then

(5.5)

u  (q + (1 - c))+ in B 1 . 2

Proof. The proof follows the original one in [D] adapted by the dichotomy discussed in [LR]. We will prove the first statement.
From (5.2) we have that u  q in B1. We also notice that B1/20(x0)  B1+(u). Then,

(5.6)

p(x)u = f in B1/20(x0).

Thus, by Theorem 1.1 in [Fa], u  C1, in B1/40(x0), where  = (pmin, pmax, n)  (0, 1) and ||u||C1,(B1/40(x0))  C, with C = C(pmin, pmax, n)  1. Here we have used (5.1) and also that (5.2) implies that ||u||L(B1)  3.
We will consider two cases:

Case

(i).

Suppose |u(x0)| <

1 4

.

We choose r1

> 0, r1

= r1(pmin, pmax, n) 

1/40

such

that

|u(x)|



1 2

in

Br1 (x0).

In

addition,

there

exists

a

constant

0

<

r2 = r2(r1) = r2(pmin, pmax, n) < r1 such that (x - r2en)  Br1 (x0), for every

x  Br1/2(x0). We observe that v~ = u - q satisfies

(5.7)

div(|v~ + en|p(x)-2(v~ + en)) = f in B 1 (x0). 20

We now apply Lemma 4.1 to the function v~ = u - q in B4r3(x0), where r3 =

min{

r1 4

,

r2 8

}.

In

particular

we

obtain

from

(4.2)

that

u(x) -

q(x)



C-1(u(x0) - q(x0))

- r3



 2C

-

r3,

for x  Br3(x0). Here C = C(n, pmin, pmax) is a universal constant because ||f ||L(B1)  2, see (5.1), and ||v~||L(B1)  2.

16

FAUSTO FERRARI AND CLAUDIA LEDERMAN

On the other hand, for all x  Br3(x0) we obtain

 2C

- r3



u(x) - q(x)

=

u((x - r2en) +

r2en)

- q((x

-

r2en)

+ r2en)

=

u((x

-

r2en)

+

r2en)

-

q(x

-

r2en)

-

r2



u(x

-

r2en)

-

q(x

-

r2en)

+

r2 2

-

r2.

As a consequence, denoting c0 = C-1 and x¯0 := x0 -r2en, we get for all x  Br3(x¯0)

(5.8)

c0 2



=

 2C



 2C

- r3 +

r2 2

=

 2C

- r3 -

r2 2

+ r2

 u(x) - q(x).

Let

us

define

the

function

w

:

D¯



R,

D

:=

B4 5

(x¯0)

\

B¯r3 (x¯0)

as

w(x) = c

|x

-

x¯0|-

-

(

4 5

)-

,

for  = (n, pmin, pmax)  1 given in Lemma 4.2 (see (4.18)). We choose c = c(n, pmin, pmax) > 0 in such a way that

w=

0, on B 4 (x¯0) 5
1, on Br3 (x¯0).

As usual, we define for every x  B¯ 4 (x¯0) 5

v(x)

=

q(x)

+

c0

 2

(w(x)

-

1)

and for t  0 we set

vt(x) = v(x) + t,

x



B¯

4 5

(x¯0).

We extend w to 1 in Br3 (x¯0), so that it results

v0(x) = v(x)  q(x)  u(x), x  B¯ 4 (x¯0). 5

Let

t¯ = sup{t  0 :

vt



u

in

B¯

4 5

(x¯0

)}.

Claim:

t¯ 

c0 2

.

Assuming that the previous Claim holds, we obtain from the definition of v that,

in B 4 (x¯0), the inequality 5

u(x)  v(x) + t¯  q(x) + c0 w(x) 2

is satisfied.

On the other hand, B 1  B 3 (x¯0) and since

2

5

w(x) 

c

(

3 5

)-

-

(

4 5

)-

,

B

3 5

(x¯0

)

\

Br3

(x¯0),

1,

Br3 (x¯0),

we conclude that, in B 1 , 2

u(x) - q(x)  c1,

with 0 < c1 = c1(n, pmin, pmax) < 1 universal, as desired.

We now have to prove the Claim. We argue by contradiction assuming that

t¯ <

c0 2

.

Let

y0



B¯

4 5

(x¯0

)

be

the

contact

point

between

vt¯

and

u,

where

vt¯(y0) = u(y0).

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

17

We

will

prove

that

y0



Br3 (x¯0).

In

fact,

recalling

that

w

vanishes

on

B 4 (x¯0) 5

and from the definition of vt¯, we obtain

vt¯

=

q

-

c0 2



+

t¯ <

u

on



B

4 5

(x¯0

),

because

u



q

and

t¯ <

c0 2

.

We can apply Lemma 4.2 to v. Hence, there exists 1 = 1(n, pmin, pmax, ) a

universal constant such that

1 2



|vt¯|

=

|v|



2,

p(x)vt¯ = p(x)v > 2  f,

for

every

0

<





1

and

for

every

x



D

=

B 4 (x¯0) 5

\

Br3 (x¯0).

On the other hand, from the definition of vt¯, we have

(5.9)

|vt¯|



|(vt¯)n|

=

|1

+

c0 2

wn|,

where (vt¯)n and wn denote the partial derivatives with respect to xn of vt¯ and w. Let us show that wn > c^ in {vt¯  0}  D, for c^ > 0 universal. In fact, whenever 0 <   2, for 2 universal, we have

{vt¯



0}



D



{q



c0 2

}

=

{xn



c0 2

-

}



{xn



5 80

}.

On the other hand,

w

=

-c|x

-

x¯0|--2(x

-

x¯0)

=

-c|x

-

x¯0 |- -1

x |x

- -

x¯0 x¯0|

.

Moreover,

denoting

x

=

x-x¯0 |x-x¯0|

,

we

observe that,

in

{vt¯



0}  D,

we have

- x, en > 0 since

xn

-

(x¯0)n

=

xn

-

1 10

+

r2



-

1 80

in

{xn



5 80

}.

In particular, there holds in {vt¯  0}  D

wn =

w, en

=

-

x, en

c|x - x¯0|--1



c

1 80

5 4

(

4 5

)-1-

=

c^ >

0.

Thus, from (5.9) we deduce that

|vt¯|



1

+

c0 2

wn



1

+

c0 2

c^

in {vt¯  0}  D, which implies, for  sufficiently small,

|vt¯| > 1 + 2  g,

on F (vt¯)  D. Then vt¯ is a strict subsolution to (1.1) in D touching u at y0. Hence y0  Br3 (x¯0) and this generates a contradiction with (5.8), because
u(y0) = vt¯(y0) = v(y0) + t¯ = q(y0) + t¯ < q(y0) + c0.

Case

(ii).

Now

suppose

|u(x0)|



1 4

.

By

exploiting

the

C 1,

regularity

of

u

in

B 1 (x0), we know that u is Lipschitz continuous in B 1 (x0), as well as there exist

40

40

a

constant

0

<

r0

=

r0(n, pmin, pmax),

with

8r0



1 40

,

and

C

=

C(n, pmin, pmax)

>

1

such that

1 8



|u|



C

in B8r0 (x0).

18

FAUSTO FERRARI AND CLAUDIA LEDERMAN

In addition, since (5.6) holds, it follows by Proposition 3.4, that u  W 2,n(B4r0 (x0)) and it is a solution to the linear uniformly elliptic equation

where

Lh = f in B4r0 (x0),

Lh = Tr(A(x)D2h(x)) + b, h(x) ,

A(x) := |u|p(x)-2

I

+

(p(x)

-

2)

u(x) |u(x)|



u(x) |u(x)|

,

and b(x) := |u|p(x)-2 log |u(x)|p(x).

Hence A  C0,(B4r0(x0)), b  C(B4r0(x0)) and L has universal ellipticity constants (depending only on n, pmin, pmax). Moreover, ||b||L(B4r0 (x0))  C1+, C universal, because ||p||L(B1)  1+ (see (5.1)).
In this way, we conclude that u - q satisfies

Tr(A(x)D2h(x)) + b, h(x) = f - b, en in B4r0 (x0).

Then, applying Harnack's inequality (see, for instance, [GT], Chap. 9) and recalling again (5.1), we obtain

(5.10)

u(x) - q(x)  C1(u(x0)-q(x0)) - C2(||f ||L(B4r0 (x0)) + ||b||L(B4r0 (x0)))



C1

 2

- C2(2

+

C 1+ )



c0 2

,

for every x  Br0 (x0), for 0 <   3. Here 3, C1, C2 and c0 are positive universal

constants. At this point, we can repeat the same argument of Case (i) around the

point

x0,

considering

the

annulus

B

4 5

(x0

)

\

B¯r0

(x0).

This

completes

the

proof.

The next result is the main tool in Theorem 1.1.

Theorem 5.2 (Harnack inequality). There exists a universal constant ¯, such that if u solves (1.1)­(5.1), and for some point x0  +(u)  F (u),

(5.11)

(xn + a0)+  u(x)  (xn + b0)+ in Br(x0)  ,

with

b0 - a0  r,   ¯,

then

(xn + a1)+  u(x)  (xn + b1)+ in Br/40(x0),

with

a0  a1  b1  b0, b1 - a1  (1 - c)r,

and 0 < c < 1 universal.

Proof. Assume without loss of generality that x0 = 0, r = 1. We call q(x) = xn + a0. Assumption (5.11) gives that

(5.12)

q+(x)  u(x)  (q(x) + )+ in B1,

since b0  a0 + . We distinguish three cases.

Case 1.

|a0| < 1/20. We now distinguish two cases:

u(x^0)



(q (x^0 )

+

 2

)+

or

u(x^0)



(q(x^0) +

 2

)+,

where

x^0

=

1 10

en.

Assume that

u(x^0)



(q (x^0 )

+

 2

)+

,

x^0

=

1 10

en

,

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

19

(the other case is treated similarly). Then, by Lemma 5.1, if   ¯,

(q(x) + c)+  u(x) in B 1 , 2
for 0 < c < 1 universal, which gives the desired improvement.

Case 2. a0  -1/20. In this case it follows from (5.12) that, for  < 1/40, 0 belongs to the zero phase of (q(x) + )+, which implies that 0 belongs to the zero phase of u. A contradiction.

Case 3. a0  1/20. In this case it follows from (5.11) that

B1/20  B1+(u).

Then, denoting u^ = u - a0, we have

(5.13)

p(x)u = p(x)u^ = f in B1/20.

Observing that ||u^||L(B1)  2 and recalling (5.1), we obtain from the application of

Theorem 1.1 in [Fa] to u^, that u  C1, in B1/40, where  = (pmin, pmax, n)  (0, 1)

and ||u||C(B1/40)  C, with C = C(pmin, pmax, n)  1.

We

now

distinguish

two

cases:

u(0) - q(0)



 2

or

u(0) - q(0)



 2

.

Assume that

u(0)

-

q(0)



 2

,

(the other case is treated similarly). We will proceed as in the proof of Lemma 5.1.

If

|u(0)|

<

1 4

,

we

argue

as

in

Case

(i)

of

Lemma

5.1,

taking

x¯0

=

-r2en.

Here

r2 > 0 is universal, chosen as in that lemma, and such that we also have

B1/40  Br4 (x¯0)  B1/20,
for an appropriate chosen universal r4 > 0. We now take r3 universal as in Lemma 5.1, let
D := Br4 (x¯0) \ Br3 (x¯0), and define w in D as in that lemma. Then, arguing as in that proof, we obtain

(5.14)

u(x) - q(x)  c1 in B1/40,

with 0 < c1 < 1, if   ¯, ¯ and c1 universal.

If

|u(0)|



1 4

,

we

proceed

as

in

Case

(ii)

of

Lemma

5.1

and

we

consider

the

barrier w in

D := B1/20 \ Br0 ,

with r0 > 0 universal and small. We obtain again (5.14), thus completing the proof.

From Theorem 5.2, with the same arguments employed in [D], we obtain the following estimate that will be crucial in the improvement of flatness procedure.

Corollary 5.3. Let u be as in Theorem 5.2 satisfying (5.11) for r = 1. Then in

B1(x0),

u~(x) =

u(x) - xn 

has

a

Ho¨lder

modulus

of

continuity

at

x0,

outside

the

ball of radius /¯, i.e., for all x  +(u)  F (u)  B1(x0), with |x - x0|  /¯,

|u~(x) - u~(x0)|  C|x - x0| .

Here ¯ is as in Theorem 5.2, and C and 0 <  < 1 are universal.

20

FAUSTO FERRARI AND CLAUDIA LEDERMAN

6. Improvement of flatness

In this section we present the main improvement of flatness lemma. Theorem 1.1 will then be obtained by applying this lemma in an iterative way.

Lemma 6.1 (Improvement of flatness). Let u satisfy (1.1) in B1 and (6.1)
f L(B1)  2, ||g-1||L(B1)  2, ||p||L(B1)  1+, ||p-p0||L(B1)  ,
for 0 <  < 1, for some constant 0 <   1. Suppose that

(6.2)

(xn - )+  u(x)  (xn + )+ in B1, 0  F (u).

If 0 < r  r0 for r0 universal, and 0 <   0 for some 0 depending on r, then

(6.3)

(x ·  - r/2)+  u(x)  (x ·  + r/2)+ in Br,

with || = 1 and | - en|  C~ for a universal constant C~.

Proof. We divide the proof of this lemma into 3 steps. We will use the following
notation: (u) := B1+(u)  F (u)  B.

Step 1: Compactness. Fix r  r0 with r0 universal (the precise r0 will be given in Step 3). Assume by contradiction that we can find a sequence k  0 and a sequence uk of solutions to (1.1) in B1 with right hand side fk, exponent pk and free boundary condition gk satisfying (6.1) with  = k, such that uk satisfies (6.2), i.e.,

(6.4)

(xn - k)+  uk(x)  (xn + k)+ for x  B1, 0  F (uk),

but uk does not satisfy the conclusion (6.3) of the lemma.

Set

u~k (x)

=

uk(x) - k

xn ,

x  1(uk).

Then, (6.4) gives

(6.5)

- 1  u~k(x)  1 for x  1(uk).

From Corollary 5.3, it follows that the function u~k satisfies

(6.6)

|u~k(x) - u~k(y)|  C|x - y|,

for C and 0 <  < 1 universal and

|x - y|  k/¯, x, y  1/2(uk).

From (6.4) it clearly follows that F (uk) converges to B1 {xn = 0} in the Hausdorff distance. This fact and (6.6) together with Ascoli-Arzela give that, as k  0, the graphs of the u~k over 1/2(uk) converge (up to a subsequence) in the Hausdorff distance to the graph of a Ho¨lder continuous function u~ over B1/2  {xn  0}.

Step 2: Limiting Solution. We now show that u~ solves the following linearized problem

(6.7)

Lp0 u~ = 0 in B1/2  {xn > 0}, u~n = 0 on B1/2  {xn = 0},

in the sense of Definition 2.7. Here Lp0 is as in (2.2).

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

21

Let P (x) be a quadratic polynomial touching u~ at x¯  B1/2  {xn  0} strictly from below. We need to show that

(i) if x¯  B1/2  {xn > 0} then Lp0 P  0; (ii) if x¯  B1/2  {xn = 0} then Pn(x¯)  0.
Since u~k  u~ in the sense specified above, there exist points xk  1/2(uk), xk  x¯ and constants ck  0 such that

(6.8)

u~k(xk) = P (xk) + ck

and

(6.9)

u~k  P + ck in a neighborhood of xk.

From the definition of u~k, (6.8) and (6.9) read

uk(xk) = Qk(xk)
and uk(x)  Qk(x) in a neighborhood of xk,
where Qk(x) = k(P (x) + ck) + xn.
For notational simplicity we will drop the sub-index k from Qk. We first notice that

(6.10)

Q = kP + en,

thus,

(6.11)

Q(xk) = 0, for k large.

We now distinguish two cases. (i) If x¯  B1/2  {xn > 0} then xk  B1+/2(uk) (for k large). Since Q touches uk from below at xk, and Q(xk) = 0, we get

2k  fk(xk)

 pk(xk)Q(xk)

n

= |Q(xk)|pk(xk)-2Q + |Q(xk)|pk(xk)-4(pk(xk) - 2)

Qxi (xk )Qxj (xk)Qxixj

i,j=1

+ |Q(xk)|pk(xk)-2 pk(xk), Q(xk) log |Q(xk)|

n

= k|Q(xk)|pk(xk)-2P + k|Q(xk)|pk(xk)-4(pk(xk) - 2)

Qxi (xk)Qxj (xk )Pxixj

i,j=1

+ |Q(xk)|pk(xk)-2 pk(xk), Q(xk) log |Q(xk)|.

Using that |pk(xk)|  k, we obtain

n

k  |Q(xk)|pk(xk)-2P + |Q(xk)|pk(xk)-4(pk(xk) - 2)

Qxi (xk )Qxj (xk)Pxixj

i,j=1

- |Q(xk)|pk(xk)-1| log |Q(xk)||.

Now, passing to the limit k   and recalling that

Q(xk)  en, pk(xk)  p0, k  0,

we conclude that Lp0 P  0 as desired.

22

FAUSTO FERRARI AND CLAUDIA LEDERMAN

(ii) If x¯  B1/2  {xn = 0}, as observed in Remark 2.8, we can assume that Lp0 P > 0. We claim that for k large enough, xk  F (uk). Otherwise xkj  B1+/2(ukj ) for a subsequence kj   and as in case (i), passing to the limit, we get
Lp0 P  0,
a contradiction. Thus, xk  F (uk) for k large. Since Q+ touches uk from below at xk  F (uk) and (6.11) holds |Q(xk)|  gk(xk)  1 + 2k,
which, by (6.10), gives

|Q(xk)|2 = 2k|P (xk)|2 + 1 + 2kPn(xk)  1 + 32k. Thus, after division by k,
k|P (xk)|2 - 3k + 2Pn(xk)  0.

Passing to the limit as k  , we obtain Pn(x¯)  0 as desired.

Step 3: Improvement of flatness. From the previous step, u~ solves (6.7) and from (6.5),
-1  u~(x)  1 in B1/2  {xn  0}.
From Theorem 2.9 and the bound above we find that, for the given r,

|u~(x) - u~(0) - u~(0) · x|  C0r2 in Br  {xn  0},

if r0  1/4, for a universal constant C0. In particular, since u~(0) = 0 and also u~n(0) = 0, we obtain
x · ~ - C0r2  u~(x)  x · ~ + C0r2 in Br  {xn  0},
where x = (x1, · · · , xn-1), ~ = x u~(0) and |~|  C0. Therefore, for k large enough we get

x · ~ - C1r2  u~k(x)  x · ~ + C1r2 in r(uk),

for a universal constant C1. From the definition of u~k the inequality above reads (6.12) kx · ~ + xn - kC1r2  uk(x)  kx · ~ + xn + kC1r2 in r(uk).

We next set Then,

k =

1

1 + 2k|~|2

(en

+

k(~,

0)).

|k| = 1, |k - en|  C~k,

and k = en + k(~, 0) + 2k,
with C~ universal. We now deduce from (6.12)

| |  C~,

x · k - 2kC~r - kC1r2  uk(x)  x · k + 2kC~r + kC1r2 in r(uk). If we fix r0 satisfying C1r0  1/4 and we take k large enough so that kC~  1/4 , we get
x · k - kr/2  uk(x)  x · k + kr/2 in r(uk).
Recalling (6.4), we obtain for large k

(x · k - kr/2)+  uk(x)  (x · k + kr/2)+ in Br,

thus uk satisfies the conclusion (6.3) of the lemma, a contradiction.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

23

7. Regularity of the free boundary

In this section we finally prove our main result, namely, Theorem 1.1.

Proof of Theorem 1.1. Let u be a viscosity solution to (1.1) in B1 with 0  F (u), g(0) = 1 and p(0) = p0. Consider the sequence

uk(x)

=

1 k

u(kx),

x  B1,

with k = r¯k, k = 0, 1, · · · , for a fixed r¯ such that

r¯  1/4, r¯  r0,

with r0 the universal constant in Lemma 6.1, taking  = 1 in (6.1). Each uk is a solution to (1.1) with right hand side fk(x) = kf (kx), exponent
pk(x) = p(kx), and free boundary condition gk(x) = g(kx). For the chosen r¯, by taking ¯ = 0(r¯)2, the assumption (6.1) holds for  = k = 2-k0(r¯). Indeed, in B1, in view of (1.4),

|fk(x)|  ||f || k  ¯r¯k  2k, |gk(x) - 1| = |g(kx) - g(0)|  [g]0, k  ¯r¯k  2k,
|pk(x)|  ||p|| k  ¯r¯k  2k, |pk(x) - p0| = |p(kx) - p(0)|  ||p|| k  ¯r¯k  2k.

The hypothesis (1.3) guarantees that for k = 0 also the flatness assumption (6.2) in Lemma 6.1 is satisfied by u0. Then it easily follows, by applying inductively Lemma 6.1, that each uk is k-flat in B1 in the sense of (6.2), in the direction k, with |k| = 1, |k - k+1|  C~k (0 = en). Now, a standard iteration argument gives the desired statement.

Appendix A. Lebesgue and Sobolev spaces with variable exponent

Let p :   [1, ) be a measurable bounded function, called a variable exponent
on , and denote pmax = esssup p(x) and pmin = essinf p(x). The variable exponent Lebesgue space Lp(·)() is defined as the set of all measurable functions u :   R for which the modular p(·)(u) =  |u(x)|p(x) dx is finite. The Luxemburg norm on this space is defined by

u = Lp(·)() u p(·) = inf{ > 0 : p(·)(u/)  1}.

This norm makes Lp(·)() a Banach space. There holds the following relation between p(·)(u) and u : Lp(·)

min

|u|p(x) dx

1/pmin
,



|u|p(x) dx 1/pmax


 u Lp(·)()

 max

|u|p(x) dx

1/pmin
,

|u|p(x) dx 1/pmax .





Moreover,

the

dual

of

Lp(·)()

is

Lp (·) ()

with

1 p(x)

+

1 p(x)

= 1.

W 1,p(·)() denotes the space of measurable functions u such that u and the

distributional derivative u are in Lp(·)(). The norm

24

FAUSTO FERRARI AND CLAUDIA LEDERMAN

u 1,p(·) := u p(·) + |u| p(·)
makes W 1,p(·)() a Banach space. The space W01,p(·)() is defined as the closure of the C0() in W 1,p(·)(). For further details on these spaces, see [DHHR], [KR], [RR] and their references.
Acknowledgment
The authors wish to thank Sandro Salsa for very interesting discussions about the subject of this paper.
References
[AMS] R. Aboulaich, D. Meskine, A. Souissi, New diffusion models in image processing, Comput. Math. Appl. 56 (2008) 874­882.
[AM] E. Acerbi, G. Mingione, Regularity results for a class of functionals with non-standard growth, Arch. Ration. Mech. Anal. 156 (2) (2001) 121­140.
[AC] H. W. Alt, L. A. Caffarelli, Existence and regularity for a minimum problem with free boundary, J. Reine Angew. Math 325 (1981) 105­144.
[ACF] H. W. Alt, L. A. Caffarelli, A. Friedman, A free boundary problem for quasilinear elliptic equations, Ann. Sc. Norm. Super. Pisa Cl. Sci. (4) 11 (1) (1984) 1­44.
[AR] S. N. Antontsev, J. F. Rodrigues, On stationary thermo-rheological viscous flows, Ann. Univ. Ferrara, Sez. VII, Sci. Mat. 52 (1) (2006) 19­36.
[ART] D. J. Arau´jo, G. C. Ricarte, E. V. Teixeira, Singularly perturbed equations of degenerate type, Ann. Inst. H. Poincar´e Anal. Non Lin´eaire 34 (3) (2017) 655­678.
[AF] R. Argiolas, F. Ferrari, Flat free boundaries regularity in two-phase problems for a class of fully nonlinear elliptic operators with variable coefficients, Interfaces Free Bound. 11 (2) (2009) 177-199.
[C1] L. A. Caffarelli, A Harnack inequality approach to the regularity of free boundaries. Part I: Lipschitz free boundaries are C1,, Rev. Mat. Iberoamericana 3 (2) (1987) 139­162.
[C2] L. A. Caffarelli, A Harnack inequality approach to the regularity of free boundaries. Part II: Flat free boundaries are Lipschitz, Comm. Pure Appl. Math. 42 (1) (1989) 55­78.
[CFS] M. C. Cerutti, F. Ferrari, S. Salsa, Two phase problems for linear elliptic operators with variable coefficients: Lipschitz free boundaries are C1, , Archive for Rational Mechanics and Analysis 171 (3) (2004) 329 - 348.
[CL] S. Challal, A. Lyaghfouri, Second order regularity for the p(x)-Laplace operator, Math. Nachr. 284 (10) (2011) 1270­1279.
[CLR] Y. Chen, S. Levine, M. Rao, Variable exponent, linear growth functionals in image restoration, SIAM J. Appl. Math. 66 (2006) 1383­1406.
[CIL] M. G. Crandall, H. Ishii, P. L. Lions, User's guide to viscosity solutions of second order partial differential equations, Bull. Amer. Math. Soc. (N.S.) 27 (1) (1992) 1­67.
[DP] D. Danielli, A. Petrosyan, A minimum problem with free boundary for a degenerate quasilinear operator, Calc. Var. Partial Differential Equations 23 (1) (2005) 97­124.
[D] D. De Silva, Free boundary regularity for a problem with right hand side, Interfaces and free boundaries 13 (2011) 223­238.
[DFS1] D. De Silva, F. Ferrari, S. Salsa, Two-phase problems with distributed sources: regularity of the free boundary. Anal. PDE 7 (2) (2014) 267­310.
[DFS2] D. De Silva, F. Ferrari, S. Salsa, Free boundary regularity for fully nonlinear nonhomogeneous two-phase problems. J. Math. Pures Appl. (9) 103 (3) (2015) 658­694.
[DFS3] D. De Silva, F. Ferrari, S. Salsa, Regularity of higher order in two-phase free boundary problems. Trans. Amer. Math. Soc. 371 (5) (2019) 3691­3720.
[DHHR] L. Diening, P. Harjulehto, P. Hasto, M. Ruzicka, Lebesgue and Sobolev Spaces with variable exponents, Lecture Notes in Mathematics 2017, Springer, 2011.
[Fa] X. Fan, Global C1, regularity for variable exponent elliptic equations in divergence form, J. Differential Equations 235 (2007) 397­417.
[FZ] X. Fan, D. Zhao, A class of De Giorgi type and H¨older continuity, Nonlinear Analysis 36 (1999) 295­318.

REGULARITY OF FLAT FREE BOUNDARIES FOR THE p(x)-LAPLACIAN

25

[F1] M. Feldman, Regularity for nonisotropic two-phase problems with Lipschitz free boundaries, Differential Integral Equations 10 (6) (1997) 1171­1179.
[F2] M. Feldman, Regularity of Lipschitz free boundaries in two-phase problems for fully nonlinear elliptic equations, Indiana Univ. Math. J. 50 (3) (2001) 1171­1200.
[FMW] J. Fernandez Bonder, S. Mart´inez, N. Wolanski, A free boundary problem for the p(x)Laplacian, Nonlinear Anal. 72 (2010) 1078­1103.
[Fe1] F. Ferrari, Two-phase problems for a class of fully nonlinear elliptic operators, Lipschitz free boundaries are C1, , Amer. J. Math. 128 (2006) 541­571.
[FL] F. Ferrari, C. Lederman, Regularity of Lipschitz free boundaries for a p(x)-Laplacian problem with right hand side, preprint.
[FS1] F. Ferrari, S. Salsa, Regularity of the free boundary in two-phase problems for elliptic operators, Adv. Math. 214 (2007) 288­322.
[FS2] F. Ferrari, S. Salsa, Subsolutions of elliptic operators in divergence form and application to two-phase free boundary problems, Bound. Value Probl. 2007, art. ID 57049, 21pp.
[GT] D. Gilbarg, N. S. Trudinger, Elliptic Partial Differential Equations of Second Order, Grundlehren der Mathematischen Wissenschaften [Fundamental Principles of Mathematical Sciences], vol. 224, Springer-Verlag, Berlin, 1983 (3rd edition).
[GS] B. Gustafsson, H. Shahgholian, Existence and geometric properties of solutions of a free boundary problem in potential theory, J. Reine Angew. Math. 473 (1996) 137­179.
[JJ] V. Julin, P. Juutinen, A new proof for the equivalence of weak and viscosity solutions for the p-Laplace equation, Communications in PDE 37 (5) (2012) 934 ­ 946.
[JLM] P. Juutinen, P. Lindqvist, J. Manfredi, On the equivalence of viscosity solutions and weak solutions for a quasi-linear equation. SIAM J. Math. Anal. 33 (3) (2001) 699­717.
[JLP] P. Juutinen, T. Lukkari, M. Parviainen, Equivalence of viscosity and weak solutions for the p(x)-Laplacian. Ann. Inst. H. Poincare Anal. Non Lineaire 27 (6) (2010) 1471­1487.
[KR] O. Kova´cik, J. Ra´kosn´ik, On spaces Lp(x) and W k,p(x), Czechoslovak Math. J 41 (1991) 592­618.
[Le] C. Lederman, A free boundary problem with a volume penalization, Ann. Sc. Norm. Super. Pisa Cl. Sci. (4) 23 (2) (1996) 249­300.
[LW1] C. Lederman, N. Wolanski, An inhomogeneous singular perturbation problem for the p(x)Laplacian, Nonlinear Anal. 138 (2016) 300­325.
[LW2] C. Lederman, N. Wolanski, Weak solutions and regularity of the interface in an inhomogeneous free boundary problem for the p(x)-Laplacian, Interfaces Free Bound. 19 (2) (2017) 201­241.
[LW3] C. Lederman, N. Wolanski, Inhomogeneous minimization problems for the p(x)-Laplacian, J. Math. Anal. Appl. 475 (1) (2019) 423­463.
[LW4] C. Lederman, N. Wolanski, An optimization problem with volume constraint for an inhomogeneous operator with nonstandard growth, Discrete Contin. Dyn. Syst. 41 (6) (2021) 2907­2946.
[LR] R. Leita~o, G. Ricarte, Free boundary regularity for a degenerate problem with right hand side, Interfaces Free Bound. 20 (2018) 577­595.
[LT] R. Leita~o, E. V. Teixeira, Regularity and geometric estimates for minima of discontinuous functionals, Rev. Mat. Iberoam. 31 (1) (2015) 69­108.
[LN1] J. Lewis, K. Nystr¨om, Regularity of Lipschitz free boundaries in two phase problems for the p-Laplace operator, Adv. in Math. 225 (2010) 2565-2597.
[LN2] J. Lewis, K. Nystr¨om K., Regularity of flat free boundaries in two-phase problems for the p-Laplace operator, Ann. Inst. H. Poincar´e Anal. Non Lin´aire 29 (1) (2012) 83­108.
[MW] S. Mart´inez, N. Wolanski, A minimum problem with free boundary in Orlicz spaces, Adv. Math. 218 (6) (2008) 1914­1971.
[MO] M. Medina, P. Ochoa, On the viscosity and weak solutions for non-homogeneous p-Laplace equations. Adv. in Nonlinear Anal. 8 (1) (2019) 468­481.
[MS] E. Milakis, L. Silvestre, Regularity for fully nonlinear elliptic equations with Neumann boundary data, Comm. in Partial Diff. Equations 31 (2006) 1227­1252.
[RR] V. D. Radulescu, D. D. Repovs, Partial differential equations with variable exponents: variational methods and qualitative analysis, Monographs and Research Notes in Mathematics, Book 9. Chapman & Hall / CRC Press, Boca Raton, FL, 2015.
[RT] G. C. Ricarte, E. V. Teixeira, Fully nonlinear singularly perturbed equations and asymptotic free boundaries, J. Funct. Anal. 261 (2011) 1624­1673.

26

FAUSTO FERRARI AND CLAUDIA LEDERMAN

[R] [S] [W1]
[W2]
[Wo] [Z1] [Z2]

M. Ruzicka, Electrorheological Fluids: Modeling and Mathematical Theory, SpringerVerlag, Berlin, 2000. O. Savin, Small perturbation solutions for elliptic equations. Comm. Partial Differential Equations 32 (4-6) (2007) 557­578. P. Y. Wang, Regularity of free boundaries of two-phase problems for fully nonlinear elliptic equations of second order. I. Lipschitz free boundaries are C1,, Comm. Pure Appl. Math. 53 (2000) 799­810. P. Y. Wang, Regularity of free boundaries of two-phase problems for fully nonlinear elliptic equations of second order. II. Flat free boundaries are Lipschitz, Comm. Partial Differential Equations 27 (2002) 1497­1514. N. Wolanski, Local bounds, Harnack inequality and H¨older continuity for divergence type elliptic equations with non-standard growth, Rev. Un. Mat. Argentina 56 (1) (2015) 73­105. V. V. Zhikov, Averaging of functionals of the calculus of variations and elasticity theory, Math. USSR. Izv. 29 (1) (1987) 33­66. V. V. Zhikov, Solvability of the three-dimensional thermistor problem, Tr. Mat. Inst. Steklova D (Differ. Uravn. i Din. Sist.) 261 (2008) 101­114.

Dipartimento di Matematica dell'Universita` di Bologna, Piazza di Porta S. Donato, 5, 40126 Bologna, Italy.
Email address: fausto.ferrari@unibo.it
IMAS - CONICET and Departamento de Matema´tica, Facultad de Ciencias Exactas y Naturales, Universidad de Buenos Aires, (1428) Buenos Aires, Argentina.
Email address: clederma@dm.uba.ar

