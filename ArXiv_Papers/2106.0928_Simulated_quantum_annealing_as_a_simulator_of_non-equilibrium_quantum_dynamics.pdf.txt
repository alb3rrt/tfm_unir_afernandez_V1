Simulated quantum annealing as a simulator of non-equilibrium quantum dynamics
Yuki Bando Institute of Innovative Research, Tokyo Institute of Technology, Yokohama, Kanagawa 226-8503, Japan
Hidetoshi Nishimori Institute of Innovative Research, Tokyo Institute of Technology, Yokohama, Kanagawa 226-8503, Japan
Graduate School of Information Sciences, Tohoku University, Sendai, Miyagi 980-8579, Japan RIKEN Interdisciplinary Theoretical and Mathematical Sciences (iTHEMS), Wako, Saitama 351-0198, Japan
(Dated: June 3, 2021)
Simulated quantum annealing based on the path-integral Monte Carlo is one of the most common tools to simulate quantum annealing on the classical hardware. Nevertheless, it is in principle highly non-trivial whether this classical algorithm can correctly reproduce the quantum dynamics of quantum annealing, particularly in the diabatic regime. We study this problem numerically through the generalized Kibble-Zurek mechanism of defect distribution in the simplest ferromagnetic onedimensional transverse-field Ising model with and without coupling to the environment. It is found that simulated quantum annealing reproduces some, but not all, of the properties of the defect distribution in the short-time region. The results suggest the necessity to exert a fair amount of caution in using simulated quantum annealing to study the detailed quantitative aspects of the dynamics of quantum annealing.

arXiv:2106.00928v1 [quant-ph] 2 Jun 2021

I. INTRODUCTION

Quantum annealing was originally proposed as a meta-

heuristic to solve classical combinatorial optimization

problems [1­10]. Recent years have seen its further de-

velopment as a quantum simulator of materials [11­20].

In both of these applications, it is important to check the

reliability of outputs from real quantum devices against

the data obtained on classical computers by numerical

solutions of the Schr¨odinger equation for closed systems

(isolated from the environment) and those of quantum

master equations for open systems (coupled to the en-

vironment). It is, however, difficult to carry out those

numerical studies on classical hardware beyond moder-

ate sizes because the dimension of the relevant Hilbert

space increases exponentially with the number of qubits.

Classical simulations of quantum annealing using

stochastic processes are often considered as an alterna-

tive tool to study the properties of quantum annealing for

large systems. In spin-vector Monte Carlo (SVMC) [21],

one

replaces

spin-

1 2

Pauli

operators

in

the

Hamiltonian

by classical rotors of unit length and stochastically up-

dates the system state. This method is known to repro-

duce some features of the outputs from the quantum de-

vice, the D-Wave quantum annealer [22, 23]. Simulated

quantum annealing (SQA) is another powerful classical

tool that uses path-integral Monte Carlo [2, 5, 18, 23­

34]. This latter method is in principle designed to simu-

late equilibrium properties of quantum systems without

a sign problem [35]. However, in the context of quan-

tum annealing, it is used to simulate dynamical behav-

iors of the transverse-field Ising model, recent examples of

which include Ref. [34], where the dynamics of a random

 Present address: Arithmer Inc., R&D Headquarters, Terashimahonchonishi, Tokushima-shi, Tokushima 770-0831, Japan

Ising chain with transverse field was studied by SQA, and Refs. [36, 37], where the performance of various embedding schemes was compared using SQA.
There are few a priori reasons to expect that the classical stochastic dynamics of SQA faithfully reproduces the quantum dynamics of quantum annealing, which often operates in the regime out of equilibrium or away from the adiabatic limit. It is nevertheless known that some aspects of non-equilibrium dynamics of quantum annealing can be understood by SQA, notably in relation with incoherent quantum tunneling [33]. The present paper tries to shed a new light on this old problem through the analyses of the simplest case of the non-random onedimensional ferromagnetic Ising model in a transverse field. In particular, we study how far SQA reproduces the predictions of the generalized Kibble-Zurek mechanism on the distribution of defects after the system is driven across a critical point at a finite rate [38, 39]. We also compare SQA with the direct numerical method for lowdimensional quantum systems, the infinite time-evolving block decimation (i-TEBD) combined with the quasiadiabatic propagator path integral (QUAPI) [40, 41]. The problem of the generalized Kibble-Zurek mechanism in one dimension was studied extensively in Ref. [17], where it was seen that the behavior of the D-Wave device can be understood in terms of a quantum system under the influence of an environment. The present paper has a different point of view, i.e., not to examine the behavior of the D-Wave device but to study how far SQA is useful to explain the dynamical properties of the quantum system through comparison of the SQA data with the predictions of the generalized Kibble-Zurek mechanism as well as with the data from the i-TEBD-QUAPI.
The next section describes the problem and the methods of analyses. Section III reports the results, and the final section is devoted to discussions.

2

II. PROBLEM AND METHODS
In the present section, we describe the problem to be discussed, the methods of analyses, and the physical quantities to be observed.

A. Closed- and open-system Hamiltonians

We study the non-equilibrium dynamics, in particular the properties related to the original [42, 43] and the generalized Kibble-Zurek mechanisms [38, 39], of the ferromagnetic transverse-field Ising model in one dimension with a free boundary,

L-1

L

H(t) = -J (t) ^iz^iz+1 - (t) ^ix.

(1)

i=1

i=1

Here L is the number of sites (qubits), ^iµ (µ = x, z) is the µ component of the Pauli matrix at site i, and J(t) and (t) are the time-dependent coefficients for the target and driver terms, respectively. We use the following linear time dependence of the coefficients for simplicity,

J (t)

=

t ta

,

(2)

(t)

=

1

-

t ta

,

(3)

where ta is the annealing time and the time t runs from 0 to ta. This system in the ground state undergoes an equilibrium second-order phase transition at a critical point J =  in the limit of infinite system size [44].
In addition to the above Hamiltonian representing a closed quantum system, we also study the open system described by the Hamiltonian,

L-1

L

H(t) = -J (t) ^iz^iz+1 - (t) ^ix

i=1

i=1

L

+

Vk(a^i,k + a^i,k)^iz + i,ka^i,ka^i,k , (4)

i=1 k

where Vk is the coupling constant with the kth bosonic mode a^i,k and a^i,k representing the environment, which is assumed to have the standard Ohmic spectral density J () = 4 k Vk2( - i,k) = 2 with a cutoff at some c. The coefficient  describes the magnitude of dissipation caused by the coupling to the environment.

B. Method
The problem defined above has been studied extensively for many years. Directly pertinent to the present paper is, first, the path-integral Monte Carlo simulation by Werner et al. [45], where they studied the equilibrium phase diagram and critical exponents of the open system

of Eq. (4), and found that critical exponents are different from those of the closed system, Eq. (1), but are independent of the coupling strength (> 0). Also, Bando et al. [17] carried out experiments on the D-Wave quantum annealers and compared the data with the generalized Kibble-Zurek mechanism [38, 39] to conclude that the data from the devices can be understood in terms of a system under bosonic environment of Eq. (4), not of the closed system Eq. (1), and also that the classical SVMC is unable to explain the dynamical properties of the DWave devices.
We combine these two contributions and study the systems of Eqs. (1) and (4) by SQA, path-integral Monte Carlo simulations with time-dependent coefficients J(t) and (t), and compare the data with those from the generalized Kibble-Zurek mechanism as well as from the more direct numerical method of the i-TEBD-QUAPI [40, 41]. We also comment on SVMC.
We apply the Suzuki-Trotter decomposition [35] to the expression of the partition function for the Hamiltonian of Eq. (4). The partition function is then expressed as the corresponding partition function of a classical Ising model in two dimensions with long-range interactions in the Trotter (imaginary-time) direction [45],

Z(t) = Z0

e , -eff Heff (t,S)

(5)

{Si( )=±1}

where Z0 is the partition function of free bosons and

L-1 P

Heff (t, S) = -J (t)

Si( )Si+1( )

i=1  =1

-

(t) eff

L-1 P
Si( )Si(
i=1  =1

+

1)

(6)

-

 2eff

L-1 i=1  > 

 P

2

Si( )Si( )

sin2

(

 P

|

-

 |)

.

Here, eff = /P with  the inverse temperature and P

the number of Trotter slices along the imaginary-time

axis. The coefficient in the second line is defined as

(t)

=

-

1 2

ln

[tanh

(eff (t))].

A

periodic

boundary

con-

dition Si(P + 1) = Si(1) is imposed along the Trotter

axis. The closed system of Eq. (1) is recovered by set-

ting  = 0.

Although cluster updates have sometimes been used

in related studies [31, 34, 45], we use the simple single-

flip Metropolis-update dynamics because, first, it is non-

trivial which stochastic dynamics better simulates quan-

tum dynamics, and second, we do not expect to encounter

the problem of slow relaxation, which hampers simula-

tions of disordered systems based on simple single-spin

updates [34], or we do not need to reach equilibrium

necessary for the study of critical exponents [45]. The

annealing time ta is identified with the total number of

Monte Carlo steps divided by the number of sites (L-1)P

and will be denoted as MCS(= ta)

3

C. Physical quantities

Following Ref. [17], we measure several quantities by SQA to be compared with predictions of the generalized Kibble-Zurek mechanism and the iTEBD-QUAPI. All quantities are measured at the end of computation where (ta) = 0.
The main quantity of interest is the number of defects (spatially mis-aligned spin pairs) n,

L-1 P

n=

[1 - Si( )Si+1( )] .

(7)

i=1  =1

Notice that the true ground state of the effective Hamiltonian of Eq. (6) is perfectly ferromagnetic with n = 0.
We measure the statistics of defects to be denoted as P SQA(n) and compare it with the prediction of the generalized Kibble-Zurek mechanism [38, 39]. According to this theory, the defect distribution is bimodal and is well approximated by the Gaussian function Q(n) for large systems L  1,

Q(n) =  1 exp 22

-

(n

- 1)2 22

,

(8)

where 1  n and 2  (n - n )2 . Here the brack-
ets · · · denote the average. We quantify the difference between P SQA(n) and Q(n) by the L1 norm,

L1

=

1 2

n

Q(n) - P SQA(n) .

(9)

We also follow Ref. [17] and check the proximity of P SQA(n) to the Boltzmann distribution of the classical
Ising part of the original Hamiltonian in Eq. (1),

P BL(n) =
Z=
n

L-1 n

e-E(n)

Z

L-1 n

e-E(n),

(10)

where E(n) is the energy of the classical Ising model with n defects. We optimize  in P BL(n) by minimizing the L1 norm of Eq. (9) after replacing Q(n) with P BL(n).
The number of defects n in Eq. (7) is essentially equiv-
alent to the residual energy per site Eres, for which we use the expression of Ref. [34],

Eres

=

1 L

L-1

1

-

1 P

P
Si( )Si+1( )

.

i=1

 =1

(11)

Notice that Eres can also be regarded as the average number of defects, average over the statistics of P SQA(n),
which was denoted as 1 (the first cumulant or the average) above. The data for Eres are to be compared with

the predictions of the Kibble-Zurek mechanism, in particular the asymptotic power law,

Eres  (ta)-d/(1+z).

(12)

Here, d = 1 is the spatial dimension and z and  are the dynamical and correlation-length critical exponents, respectively.

III. RESULTS We now present our results obtained by SQA.

A. Closed system

We first report the results for the closed system of

Eq. (1). Figure 1 shows the residual energy Eres de-

fined in Eq. (11) as a function of the annealing time

MCS for system sizes L = 64, 128, 256, and 512. We set

eff

=

 P

=1

and P

= 4 × L throughout this

study.

As

shown in Appendix A, we have confirmed that the resid-

ual energy as a function of P converges for P = 4 × L.

100

L = 64

L = 128

L = 256

10-1

L = 512

Eres [arb. Unit]

10-2

101

102

103

104

MCS

FIG. 1. Residual energy Eres for the closed system with
sizes L = 64, 128, 256, and 512 as a function of the anneal-
ing time of SQA. The solid lines are fits to the power law Eres  (MCS)-b in the range 16  MCS  8192.

It is clearly observed in Fig. 1 that the residual energy follows a power law as predicted by the original KibbleZurek mechanism,

Eres  (MCS)-b.

(13)

The values of the exponent b are found as b = 0.543 ±

0.007 (L = 64), 0.519 ± 0.004 (L = 128), 0.506 ±

0.003 (L = 256), and 0.500 ± 0.003 (L = 512). These val-

ues, particularly the last one, are in close agreement with

the prediction of the Kibble-Zurek mechanism Eq. (12)

for this one-dimensional closed system, which has z = 1,



=

1,

and

thus

b

=

d/(1 + z)

=

1 2

.

This agrees

with previous reports by the direct numerical method of

the i-TEBD-QUAPI [40, 41] as well as by SQA [31, 34].

4

In contrast, as found in Ref. [17], SVMC shows close, but slightly deviated, values b = 0.477 ± 0.005 and
b = 0.482 ± 0.006, depending on the choice of the simulation temperature.
We proceed to the analysis of the distribution function of defects P SQA(n). Figure 2 shows the qth cumulants
q (q = 1, 2, 3) of the defect distribution obtained from the final state at MCS of SQA for L = 64, 128, 256, and 512. The generalized Kibble-Zurek mechanism [38, 39]

q

102

q = 1

q = 2

q = 3

101

100

L = 64

10-1

101

102

103

104

MCS

102

q = 1

q = 2

q = 3

101

100

L = 256

10-1

101

102

103

104

MCS

q

q

102

q = 1

q = 2

q = 3

101

100

L = 128

10-1

101

102

103

104

MCS

102

q = 1

q = 2

q = 3
101

100

L = 512

10-1

101

102

103

104

MCS

q

FIG. 2. qth cumulants q of defect distribution as functions of annealing time MCS for L = 64, 128, 256, and 512 for the closed system.

predicts that the second- and higher-order cumulants are
proportional to the first-order cumulant (average) 1. The data shows that this is indeed the case for MCS up to about 102 for any system size L but the tendency changes beyond MCS  102. Comparison of data for different system sizes suggests that this deviation may
possibly be a finite-size effect.
Figure 3 shows the ratios of cumulants 2/1 and 3/1 for MCS up to about 102 for L = 512, which indicates the validity of proportionality of 2 and 3 to 1 up to MCS  102. More quantitatively, we find 2/1 = 0.688 ± 0.005 and 3/1 = 0.394 ± 0.019. These values clearly deviate from the theoretical prediction for the
closed system, 2/1 = 0.578 and 3/1 = 0.134 [38, 39]. We therefore conclude that SQA does not faithfully re-
produce the statistics of the defect distribution for the
present closed system although the average or the resid-
ual energy is well described by SQA.
It may be useful recall in passing that the data from
the D-Wave devices showed similar proportionality but
with values closer to the theory, 2/1 = 0.61 ± 0.03 and 3/1 = 0.23 ± 0.15 on the device at NASA and 2/1 = 0.63±0.05 and 3/1 = 0.25±0.18 on the device at Burnaby [17]. In contrast, the SVMC data marginally
indicate proportionality of 2 to 1 in the short time region but with significant deviations for longer annealing
times [17]. The ratio 2/1 out of SVMC is close to 0.6 for the short-time region but the ratio 3/1 has large

q / q'

1.0

0.9 0.8

2 / 1 3 / 1

0.7

0.6

0.5

0.4

0.3

0.2

0.1

101

102

MCS

FIG. 3. Cumulant ratios 2/1 and 3/1 in the range of MCS  [4, 118] for L = 512 for the closed system. The constants are evaluated as 2/1  0.688 ± 0.005 and 3/1  0.394 ± 0.019, respectively.

error bars and it is impossible to determine its value with reliability.
We further follow Ref. [17] and test if the defect distribution is closer to the Boltzmann or Gaussian distribution. Figure 4 is the distribution function at MCS = 16, 256, and 4096 and the dashed line is the Boltzmann distribution Eq. (10) with the temperature optimized for each MCS. Though the data appears to be close to the

P (n)

0.3 0.25 0.2 0.15 0.1 0.05
0 0

MCS = 16 MCS = 512 MCS = 4096
10 20 30 40 50 60 70 n

FIG. 4. Probability distribution of defects by SQA at MCS = 16, 256, and 4096 for L = 512. The dashed lines are the Boltzmann distribution defined in Eq. (10) with the optimized value of the inverse temperature.
optimized Boltzmann distribution P BL(n), we see a slight deviation especially at MCS = 16, which is more clearly observed in the enhanced figure in Fig. 5, where we see a better fit by the Gaussian Eq. (8), similarly to the previous study by the D-Wave devices and SVMC [17].
Figure 6 shows the L1 norm of the difference between the defect distribution of SQA, P SQA(n), and the optimized Boltzmann distribution P BL(n) in Eq. (10) and the Gaussian distribution Q(n) in Eq. (8) as a function of the annealing time MCS for L = 512. In the time range up to MCS  102, where the proportional relationship of

5

P (n)

0.1 0.08 0.06

SQA Gaussian Boltzman

0.04

0.02

0 30 35 40 45 50 55 60 65 70 75 n

of MCS for L = 64, 128, 256, and 512 under the same

parameters as before, eff

=

 P

= 1 and P

= 4 × L.

Here, we fix the coupling strength with the boson field

to  = 0.6 for all L. It is seen that the power decay pre-

100
L = 64 L = 128 L = 256 L = 512
10-1

Eres [arb. Unit]

FIG. 5. Defect distribution at MCS = 16 for L = 512. The solid line is the Gaussian distribution defined in Eq. (8), and the dashed line is the optimized Boltzmann distribution defined in Eq. (10).

10-2

101

102

103

104

MCS

cumulants is established, the L1 norm with the Gaussian is smaller, thus SQA works as a Gaussian sampler rather than as a Boltzmann sampler, but for longer annealing times, e.g., MCS  103, two functions show similar degrees of proximity to the data.
Boltzman/SQA Gaussian/SQA
10-1

L1 Norm

10-2

101

102

103

104

MCS

FIG. 6. L1 norms between the defect distribution of SQA P SQA(n) and the optimized Boltzmann distribution QBO(n) (circle) and the normal distributions QGA(n) (square) for L =
512

Those results for the closed system indicate that the classical stochastic dynamics of SQA partly succeeds in reproducing the predictions on the quantum dynamics related to the original and generalized Kibble-Zurek mechanism. However, detailed quantitative analyses on the distribution function show deviations from the theory for the closed system.

B. Open system
We next discuss the results obtained for the open system defined in Eq. (4) and simulated by Eq. (6).
Figure 7 shows the residual energy Eres as a function

FIG. 7. Residual energy Eres obtained by SQA for the open system with L = 64, 128, 256, and 512 as a function of annealing time MCS. The solid lines are fits to (MCS)-b in the range 16  MCS  1024 with b  0.43 for all L.
dicted by the Kibble-Zurek mechanism, Eq. (13), holds up to MCS  103. Deviations are observed even for the largest system with L = 512 beyond this annealing time in contrast to the case of closed system in Fig. 1. It is anticipated from the behavior beyond MCS  103 that these deviations may be due to finite-size effects. Quantitatively, the exponents extracted from the linear region are b = 0.433 ± 0.013, 0.437 ± 0.006, 0.431 ± 0.008, and 0.425 ± 0.007 for L = 64, 128, 256, and 512, respectively, indicating deviations from the closed-system value b = 0.5. Critical exponents z = 1.985 and  = 0.638 from equilibrium Monte Carlo simulation of the open system in Ref. [45] lead to b = d/(1 + z) = 0.28. Our estimate b  0.43 from SQA with  = 0.6 is not close to either of those theoretical values 0.5 and 0.28 for closed and open systems, respectively.
Extensive numerical simulations of open quantum systems by the i-TEBD-QUAPI, which is expected to faithfully reproduce quantum dynamics for the short-time region, showed clear dependence of the exponent b on several factors including the coupling strength  and the range of annealing time [17, 40, 41]. We therefore checked the -dependence of the residual energy by SQA, and the result is in Fig. 8 for L = 256. It is seen that the exponent b is a decreasing function of  (from b = 0.50 for  = 0 to b = 0.26 for  = 1.0), consistently even quantitatively with the results of i-TEBD-QUAPI reported in Refs. [17, 40, 41]. For reader's convenience, we reproduce a figure from Ref. [17] as Fig. 15 of Appendix B of this paper, where the defect density (proportional to the residual energy) is drawn as a function of the annealing time. One observes there that b changes from b = 0.50 for  = 0 to b = 0.25 for  = 1.28, close to the values from SQA.

6

As suggested in Ref. [17], taking into account the fact that the i-TEBD-QUAPI reproduces quantum dynamics for very short times, this non-universality (dependence of the exponent on ) of the SQA data may imply that the system is still in a transient state and much longer annealing times for much larger systems may show a value of b independent  as expected from universality seen in the equilibrium Monte Carlo simulation [45]. Viewed differently, this consistency with the quantummechanical simulation by the i-TEBD-QUAPI may imply that SQA, a classical stochastic process, reproduces the non-equilibrium quantum dynamics in the short time region for the present open system.

100

L = 256

= 0.0

= 0.2

= 0.4

Eres [arb. Unit]

10-1

= 0.6 = 0.8 = 1.0

10-2

101

102

103

104

MCS

FIG. 8. Residual energy for different coupling constants with the environment  for L = 256 as a function of annealing time MCS .

We proceed to test if the distribution function of defects P SQA(n) for a typical fixed value of  = 0.6 is consistent with the prediction of the generalized KibbleZurek mechanism as we did for the closed system. Figure 9 shows the qth cumulants of the distribution as functions of the annealing time for L = 64, 128, 256, and 512. It is seen that the second cumulant is proportional to the first cumulant almost up to MCS  103, a longer time range of proportionality than in the closed system depicted in Fig. 2. The behavior of the third cumulant is unstable due to insufficient statistics.
Figure 10 shows the ratios of cumulants with the results 2/1  0.598 ± 0.008 and 3/1  0.185 ± 0.048. These values for the open system are closer to the theoretical prediction of the generalized Kibble-Zurek mechanism (2/1 = 0.578 and 3/1 = 0.174 [39]) than in the case of SQA for the closed system discussed in the previous subsection (2/1  0.688 ± 0.005 and 3/1  0.394 ± 0.019). We have also calculated cumulant ratios with a different coupling strength  = 1.0 in L = 512 to see the  dependence. The result is 2/1  0.569 ± 0.015 and 3/1  0.196 ± 0.135, indicating very weak dependence on .
It was found in Ref. [17] that the numerical data by the i-TEBD-QUAPI for the open system indicate a similar value 0.6 for 2/1 independent of  but it is difficult

q

102

q = 1

q = 2

q = 3

101

100

L = 64

10-1

101

102

103

104

MCS

102

q = 1

q = 2

q = 3

101

100

L = 256

10-1

101

102

103

104

MCS

q

q

102

q = 1

q = 2

q = 3

101

100

L = 128

10-1

101

102

103

104

MCS

102

q = 1

q = 2

q = 3

101

100

L = 512

10-1

101

102

103

104

MCS

q

FIG. 9. Cumulants of defect distribution of open systems with coupling constant  = 0.6.

to evaluate 3/1. We have thus found that SQA for the open system successfully reproduces the prediction of the generalized Kibble-Zurek mechanism for the cumulant ratios, but the behavior of the average (residual energy) is non-universal, which is not compatible with the theory. Also, agreement with the data of the iTEBDQUAPI in the short time region has been observed.



2/1



3/1

TT










 

 

 

 

T0&6

FIG. 10. Cumulant ratios 2/1 and 3/1 for L = 512 for the open system with the coupling constant  = 0.6.

As in the case of the closed system, we further check whether the distribution function is closer to the Gaussian or Boltzmann. Figure 11 shows the distribution function for MCS = 16, 256, and 4096 for L = 512 with the coupling constant  = 0.6 fitted to the Boltzmann distribution Eq. (10) with optimized effective temperature. Although the gross feature is captured by the Boltzmann distribution, we find clear deviations. In fact, as seen in Fig. 12, the Gaussian distribution better matches the data, as anticipated from the smallness of the third cumulant.
Figure 13 shows the L1 norm between the defect distri-

7

P (n)

0.3 0.25 0.2

MCS = 16 MCS = 512 MCS = 4096

0.15

0.1

0.05

0

0 10 20 30 40 50 60 70 80 90 n

L1 Norm

Boltzman/SQA Gaussian/SQA
10-1

10-2

101

102

103

104

MCS

FIG. 11. Distribution of defects at MCS = 16, 256, and 4096 for L = 512 for open systems with the coupling constant  = 0.6. The dashed lines are the optimized Boltzmann distribution.

FIG. 13. The distance, the L1 norm, between the defect distribution P SQA(n) of SQA and the optimized Boltzmann distribution P BL(n) (circle) and the Gaussian distribution Q(n)
(square) for L = 512.

P (n)

0.1 0.08 0.06

SQA Gaussian Boltzman

0.04

0.02

0 40 45 50 55 60 65 70 75 80 n

FIG. 12. Defect distribution at MCS = 16 for L = 512 of the open system with  = 0.6. The solid line is the Gaussian distribution in Eq. (8) and the dashed line is the optimized Boltzmann distribution of Eq. (10).

bution of SQA, P SQA(n), and the optimized Boltzmann distribution P BL(n) in Eq. (10) and the Gaussian distribution Q(n) of Eq. (8) as a function of the annealing time MCS for L = 512. It is seen that the data is closer to the Gaussian than to the Boltzmann, similarly to the case of the closed system and in agreement with the generalized Kibble-Zurek mechanism which predicts small values of higher-order cumulants than the second order, meaning Gaussian approximately. Thus SQA is closer to a Gaussian sampler rather than a Boltzmann sampler in the present open system as well. A similar conclusion was drawn for the D-Wave device [17], and therefore we should be careful when we use quantum annealing (simulated or on the real device) for sampling purposes at least as long as the present one-dimensional system is concerned.

IV. DISCUSSION
We have performed numerical tests to check if simulated quantum annealing (SQA) is able to describe the non-equilibrium quantum dynamics of the simple onedimensional ferromagnetic transverse-field Ising model across its critical point using the generalized KibbleZurek mechanism and the direct quantum numerics of i-TEBD-QUAPI as tools to measure the degree of success of SQA. This is a highly non-trivial problem because the classical algorithm SQA has no a priori reason to reproduce quantum dynamics, although SQA has often been used to simulate quantum annealing, in particular for large systems. It is nevertheless known that the phenomenon of incoherent quantum tunneling is well simulated by SQA if there exists a finite number of energy barriers between local minima [33], a prototypical energy landscape of a simple first-order phase transition. We have studied the problem from a point of view of non-equilibrium dynamics across a critical point (secondorder transition point) in the open system with the fact in mind that the data from SQA is known to agree with the prediction of the original Kibble-Zurek mechanism in the closed one-dimensional system without disorder [34].
We presented detailed quantitative comparison of defect distribution with the asymptotically exact theory of the generalized Kibble-Zurek mechanism and the iTEBD-QUAPI, the latter of which is expected to faithfully reproduce quantum dynamics in the short-time region in the present one-dimensional system. Our results indicate that some, but not all, of the dynamical properties of the quantum system can be reproduced by SQA for the one-dimensional system. It is not easy to predict a priori which quantities are well described by SQA. It is therefore necessary to exert a fair amount of caution when one uses SQA to clarify the dynamical properties of quantum annealing in a detailed quantitative way. It is also desirable to establish a theoretical framework to explain the present numerical observation. Though there

8

exists a formal mapping between classical stochastic dynamics and a quantum-mechanical system [46, 47], this is still far from sufficient to understand the results found in the present paper. It is also known that the convergence condition of SQA in the long-time limit has a very similar expression to that of quantum annealing [8, 48]. Whether or not this is an accidental coincidence is an interesting topic closely related to the present work.
ACKNOWLEDGMENTS

Eres [arb. Unit]

100

10-1

10-2

N =64

P = 64 P = 128 P = 256 P = 512

100

P = 128

P = 256

P = 512

10-1

P = 1024

10-2

N =128

100

101

102

103

104

100

101

102

103

104

100

P = 256

100

P = 512

P = 512

P = 1024

P = 1024

P = 2048

10-1

P = 2048

10-1

P = 4096

Eres [arb. Unit]

10-2

N =256

10-2

N =512

100 101 102 103 104

100 101 102 103 104

Monte Carlo Steps

Monte Carlo Steps

FIG. 14. Residual energy Eres for L = 64, 128, 256, and 512 as a function of Monte Carlo steps or annealing time MCS. We change the Trotter size from P = L × 1 to P = L × 8.

The research is based partially upon work supported by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA) and the Defense Advanced Research Projects Agency (DARPA), via the U.S. Army Research Office contract W911NF-17-C-0050. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the ODNI, IARPA, DARPA, or the U.S. Gov-
ednruontcmwe ieatnh(ntasd.t)adTni1sdht0iernigUbu.aStne.yGrceoopvpreiynrrntisgmhfeotnratnGinsoovateuarttnhiomonreintzhteaedlretpoounrr.peposreos-

Appendix B: Residual energy by the i-TEBD-QUAPI
In Fig. 15, we reproduce Fig. 4(b) of Ref. [17], where the density of defects (kinks), proportional to the residual energy, is plotted as a function of the annealing time obtained from the extensive numerical computation of iTEBD-QUAPI. The exponent b for the decay of the residual energy, Eq. (13), is seen to depend on the coupling constant  with the bosonic environment in reasonable agreement with the SQA result described in Sec III B.
(b)
100

10-1 Appe1n0dix A: Trotte1r0-size depend1e0nce

10-1 A
1.28 0.98 0.32 0.72 0.18 0.5 0 (closed)

103

100

101

0.25

0.32

0.35

0.4

E 0.5

0.47

102

Here, we show the Trotter-size dependence of the residual energy. Figure 14 shows the residual energy for L = 64, 128, 256, and 512 as a function of MCS for a series of Trotter size P . This figure shows that P = L × 4 is enough to reach convergence of the residual energy for those system sizes and annealing time.

FIG. 15. Density of defects (proportional to the residual energy) obtained by i-TEBD-QUAPI. ta is the annealing time measured in the unit of divided by the final coupling strength J(t = ta) (denoted B(1)/2 in the figure) for various values of . Taken from Ref. [17].

[1] T. Kadowaki and H. Nishimori, Quantum annealing in the transverse ising model, Phys. Rev. E 58, 5355 (1998).

[2] T. Kadowaki, Study of Optimization Problems by Quantum Annealing, Ph.D. thesis, Tokyo Institute of Technol-

9

ogy (1998), arXiv:0205020. [3] J. Brooke, D. Bitko, T. F. Rosenbaum, and G. Aeppli,
Quantum annealing of a disordered magnet, Science 284, 779 (1999). [4] E. Farhi, J. Goldstone, S. Gutmann, J. Lapan, A. Lundgren, and D. Preda, A quantum adiabatic evolution algorithm applied to random instances of an NP-complete problem., Science 292, 472 (2001). [5] G. E. Santoro, R. Marton´ak, E. Tosatti, and R. Car, Theory of quantum annealing of an ising spin glass, Science 295, 2427 (2002). [6] G. E. Santoro and E. Tosatti, Optimization using quantum mechanics: quantum annealing through adiabatic evolution, J. Phys. A 39, R393 (2006). [7] A. Das and B. K. Chakrabarti, Colloquium: Quantum annealing and analog quantum computation, Rev. Mod. Phys. 80, 1061 (2008). [8] S. Morita and H. Nishimori, Mathematical foundation of quantum annealing, J. Math. Phys. 49, 125210 (2008). [9] T. Albash and D. A. Lidar, Adiabatic quantum computation, Rev. Mod. Phys. 90, 015002 (2018). [10] P. Hauke, H. G. Katzgraber, W. Lechner, H. Nishimori, and W. D. Oliver, Perspectives of quantum annealing: Methods and implementations, Rep. Prog. Phys. 83, 054401 (2020). [11] R. Harris, Y. Sato, A. J. Berkley, M. Reis, F. Altomare, M. H. Amin, K. Boothby, P. Bunyk, C. Deng, C. Enderud, S. Huang, E. Hoskinson, M. W. Johnson, E. Ladizinsky, N. Ladizinsky, T. Lanting, R. Li, T. Medina, R. Molavi, R. Neufeld, T. Oh, I. Pavlov, I. Perminov, G. Poulin-Lamarre, C. Rich, A. Smirnov, L. Swenson, N. Tsai, M. Volkmann, J. Whittaker, and J. Yao, Phase transitions in a programmable quantum spin glass simulator, Science 361, 162 (2018). [12] A. D. King, J. Carrasquilla, J. Raymond, I. Ozfidan, E. Andriyash, A. Berkley, M. Reis, T. Lanting, R. Harris, F. Altomare, K. Boothby, P. I. Bunyk, C. Enderud, A. Fr´echette, E. Hoskinson, N. Ladizinsky, T. Oh, G. Poulin-Lamarre, C. Rich, Y. Sato, A. Y. Smirnov, L. J. Swenson, M. H. Volkmann, J. Whittaker, J. Yao, E. Ladizinsky, M. W. Johnson, J. Hilton, and M. H. Amin, Observation of topological phenomena in a programmable lattice of 1,800 qubits, Nature 560, 456 (2018). [13] A. D. King, J. Raymond, T. Lanting, S. V. Isakov, M. Mohseni, G. Poulin-Lamarre, S. Ejtemaee, W. Bernoudy, I. Ozfidan, A. Y. Smirnov, M. Reis, F. Altomare, M. Babcock, C. Baron, A. J. Berkley, K. Boothby, P. I. Bunyk, H. Christiani, C. Enderud, B. Evert, R. Harris, E. Hoskinson, S. Huang, K. Jooya, A. Khodabandelou, N. Ladizinsky, R. Li, P. A. Lott, A. J. R. MacDonald, D. Marsden, G. Marsden, T. Medina, R. Molavi, R. Neufeld, M. Norouzpour, T. Oh, I. Pavlov, I. Perminov, T. Prescott, C. Rich, Y. Sato, B. Sheldan, G. Sterling, L. J. Swenson, N. Tsai, M. H. Volkmann, J. D. Whittaker, W. Wilkinson, J. Yao, H. Neven, J. P. Hilton, E. Ladizinsky, M. W. Johnson, and M. H. Amin, Scaling advantage in quantum simulation of geometrically frustrated magnets, Nature Commun. 12, 1113 (2021). [14] A. Mishra, T. Albash, and D. A. Lidar, Finite temperature quantum annealing solving exponentially small gap problem with non-monotonic success probability, Nature Commun. 9, 2917 (2018).

[15] B. Gardas, J. Dziarmaga, W. H. Zurek, and M. Zwolak, Defects in Quantum Computers, Sci. Rep. 8, 4539 (2018).
[16] P. Weinberg, M. Tylutki, J. M. Ro¨nkk¨o, J. Westerholm, J. A. °Astr¨om, P. Manninen, P. T¨orma¨, and A. W. Sandvik, Scaling and Diabatic Effects in Quantum Annealing with a D-Wave Device, Phys. Rev. Lett. 124, 090502 (2020).
[17] Y. Bando, Y. Susa, H. Oshiyama, N. Shibata, M. Ohzeki, F. J. G´omez-Ruiz, D. A. Lidar, S. Suzuki, A. del Campo, and H. Nishimori, Probing the universality of topological defect formation in a quantum annealer: Kibble-zurek mechanism and beyond, Phys. Rev. Research 2, 033369 (2020).
[18] K. Nishimura, H. Nishimori, and H. G. Katzgraber, Griffiths-McCoy singularity on the diluted Chimera graph: Monte Carlo simulations and experiments on quantum hardware, Phys. Rev. A 102, 042403 (2020).
[19] A. D. King, C. Nisoli, E. D. Dahl, G. Poulin-Lamarre, and A. Lopez-Bezanilla, Quantum Artificial Spin Ice, arXiv:2007.10555 (2020).
[20] P. Kairys, A. D. King, I. Ozfidan, K. Boothby, J. Raymond, A. Banerjee, and T. S. Humble, Simulating the Shastry-Sutherland Ising Model using Quantum Annealing, arXiv:2003.01019 (2020).
[21] S. W. Shin, G. Smith, J. A. Smolin, and U. Vazirani, How "Quantum" is the D-Wave Machine?, arXiv:1401.7087 (2014).
[22] S. Boixo, T. F. Rønnow, S. V. Isakov, Z. Wang, D. Wecker, D. A. Lidar, J. M. Martinis, and M. Troyer, Evidence for quantum annealing with more than one hundred qubits, Nature Phys. 10, 218 (2014).
[23] S. Boixo, V. N. Smelyanskiy, A. Shabani, S. V. Isakov, M. Dykman, V. S. Denchev, M. H. Amin, A. Y. Smirnov, M. Mohseni, and H. Neven, Computational multiqubit tunnelling in programmable quantum annealers, Nature Commun. 7, 10327 (2016).
[24] R. Marton´ak, G. Santoro, and E. Tosatti, Quantum annealing by the path-integral Monte Carlo method: The two-dimensional random Ising model, Phys. Rev. B 66, 094203 (2002).
[25] R. Marton´ak, G. Santoro, and E. Tosatti, Quantum annealing of the traveling-salesman problem, Phys. Rev. E 70, 057701 (2004).
[26] D. Battaglia, G. Santoro, and E. Tosatti, Optimization by quantum annealing: Lessons from hard satisfiability problems, Phys. Rev. E 71, 066707 (2005).
[27] L. Stella, G. Santoro, and E. Tosatti, Monte Carlo studies of quantum and classical annealing on a double well, Phys. Rev. B 73, 144302 (2006).
[28] S. Boixo, T. Albash, F. M. Spedalieri, N. Chancellor, and D. a. Lidar, Experimental signature of programmable quantum annealing, Nature Commun. 4, 2067 (2013).
[29] N. G. Dickson, M. W. Johnson, M. H. Amin, R. Harris, and G. Rose, Thermally assisted quantum annealing of a 16-qubit problem. Supplementary information, Nature Commun. 4, 1903 (2013).
[30] H. G. Katzgraber, F. Hamze, and R. S. Andrist, Glassy Chimeras Could Be Blind to Quantum Speedup: Designing Better Benchmarks for Quantum Annealing Machines, Phys. Rev. X 4, 021008 (2014).
[31] B. Heim, T. F. Rønnow, S. V. Isakov, and M. Troyer, Quantum versus classical annealing of Ising spin glasses, Science 348, 215 (2015).

10

[32] T. Albash, W. Vinci, A. Mishra, P. A. Warburton, and D. A. Lidar, Consistency tests of classical and quantum models for a quantum annealer, Phys. Rev. A 91, 042314 (2015).
[33] S. V. Isakov, G. Mazzola, V. N. Smelyanskiy, Z. Jiang, S. Boixo, H. Neven, and M. Troyer, Understanding quantum tunneling through quantum monte carlo simulations, Phys. Rev. Lett. 117, 180402 (2016).
[34] G. B. Mbeng, L. Privitera, L. Arceci, and G. E. Santoro, Dynamics of simulated quantum annealing in random Ising chains, Phy. Rev. B 99, 064201 (2019).
[35] M. Suzuki, Relationship between d-dimensional quantal spin systems and (d+1)-dimensional Ising systems, Prog. Theor. Phys. 56, 1454 (1976).
[36] T. Albash, W. Vinci, and D. A. Lidar, Simulatedquantum-annealing comparison between all-to-all connectivity schemes, Phys. Rev. A 94, 022327 (2016).
[37] M. S. K¨onz, W. Lechner, H. G. Katzgraber, and M. Troyer, Scaling overhead of embedding optimization problems in quantum annealing, arXiv:2103.15991 (2021).
[38] A. del Campo, Universal Statistics of Topological Defects Formed in a Quantum Phase Transition, Phys. Rev. Lett. 121, 200601 (2018).
[39] F. J. G´omez-Ruiz, J. J. Mayo, and A. del Campo, Full Counting Statistics of Topological Defects after Crossing

a Phase Transition, Phys. Rev. Lett. 124, 240602 (2020). [40] S. Suzuki, H. Oshiyama, and N. Shibata, Quantum an-
nealing of pure and random Ising chains coupled to a bosonic environment, J. Phys. Soc. Japan 88, 061003 (2019). [41] H. Oshiyama, N. Shibata, and S. Suzuki, Kibble­Zurek mechanism in a dissipative transverse ising chain, J. Phys. Soc. Japan 89, 104002 (2020). [42] T. W. Kibble, Topology of cosmic domains and strings, J. Phys. A 9, 1387 (1976). [43] W. H. Zurek, Cosmological experiments in superfluid helium?, Nature 317, 505 (1985). [44] H. Nishimori and G. Ortiz, Elements of Phase Transitions and Critical Phenomena (Oxford, United Kingdom: Oxford University Press, 2011). [45] P. Werner, K. V¨olker, M. Troyer, and S. Chakravarty, Phase diagram and critical exponents of a dissipative Ising spin chain in a transverse magnetic field, Phys. Rev. Lett. 94, 047201 (2005). [46] R. Somma, C. Batista, and G. Ortiz, Quantum Approach to Classical Statistical Mechanics, Phys. Rev. Lett. 99, 030603 (2007). [47] H. Nishimori, J. Tsuda, and S. Knysh, Comparative study of the performance of quantum annealing and simulated annealing, Phys. Rev. E 91, 012104 (2015). [48] S. Morita and H. Nishimori, Convergence theorems for quantum annealing, J. Phys. A 39, 13903 (2006).

