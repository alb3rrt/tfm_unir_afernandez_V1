Draft version June 4, 2021 Typeset using LATEX preprint2 style in AASTeX631

arXiv:2106.01558v1 [astro-ph.EP] 3 Jun 2021

The Growth of Protoplanets via the Accretion of Small Bodies in Disks Perturbed by the Planetary Gravity
Tatsuya Okamura1 and Hiroshi Kobayashi1
1Department of Physics, Nagoya University, Nagoya, Aichi 464-8602, Japan
ABSTRACT
Planets grow via the collisional accretion of small bodies in a protoplanetary disk. Such small bodies feel strong gas drag and their orbits are significantly affected by the gas flow and atmospheric structure around the planet. We investigate the gas flow in the protoplanetary disk perturbed by the gravity of the planet by three-dimensional hydrodynamic simulation. We then calculate the orbital evolutions of particles in the gas structure obtained from the hydrodynamic simulation. Based on the orbital calculations, we obtain the collision rate between the planet and centimeter to kilometer sized particles. Our results show that meter-sized or larger particles effectively collide with the planet due to the atmospheric gas drag, which significantly enhances the collision rate. On the other hand, the gas flow plays an important role for smaller particles. Finally, considering the effects of the atmosphere and gas flow, we derive the new analytic formula for the collision rate, which is in good agreement with our simulations. We estimate the growth timescale and accretion efficiency of drifting bodies for the formation of a gas-giant solid core using the formula. We find the accretion of sub-kilometer sized bodies achieve a short growth timescale ( 0.05 Myr) and a high accretion efficiency ( 1) for the core formation at 5 au in the minimum mass solar nebula model.

1. INTRODUCTION
In the last ten years, the growth of protoplanets is considered via the accretion of mmcm sized particles (pebbles) as well as km sized planetesimals (e.g., Ormel & Klahr 2010; Lambrechts & Johansen 2012). Pebbles, formed from dust grain coagulation, drift inward, and are effectively accreted onto protoplanets in inner protoplanetary disks. These pebbles are aerodynamically small and well coupled to the gas, so that the gas flow significantly affects the collision rate between pebbles and planets. Recently, the detailed flow structures around a
okamura.tatsuya@nagoya-u.jp

low-mass and non-gap-opening planet embedded in a protoplanetary disk were revealed by hydrodynamic simulations (Ormel et al. 2015b; Fung et al. 2015; Lambrechts & Lega 2017; Cimerman et al. 2017; Kurokawa & Tanigawa 2018; Kuwahara et al. 2019; B´ethune & Rafikov 2019; Fung et al. 2019; Moldenhauer et al. 2021) The common flow structures of these studies are the horseshoe and vertical flow. The horseshoe flow extends along the orbital direction of the planet in the anterior-posterior direction of the planet and has a vertical structure like a column. The vertical flow comes from high altitudes to planets. These flow structures influence the collision rate between pebbles and the planet (Ormel 2013). Popovas et al.(2018,

2
2019) showed the horseshoe flow takes pebbles away from the planet and prevents the particles from accreting onto the planet. Kuwahara & Kurokawa (2020a) showed the vertical flow helps small particles accreting onto the planet, so that the collision rate increases if pebbles have a vertical distribution. The analytic formula for the collision rates with planets has been derived for particles well coupled to the gas (Ormel & Klahr 2010; Ormel 2013).
On the other hand, the planetary atmosphere enhances the accretion rate of meter-sized or larger bodies. Once protoplanets grow larger than the Moon, they can have atmospheres (e.g., Mizuno et al. 1978). The gas density of the atmosphere may be in orders of magnitude larger than the protoplanetary disk. In addition, a close encounter with a planet accelerates the velocity of particles and the velocity may exceed the speed of sound. These effects effectively reduce the kinetic energy of particles so that the particles are captured in the atmosphere. The effective capture radius for sub-kilometer sized bodies is much larger than the physical radius of the planet (Inaba & Ikoma 2003). For the accretion rate, Inaba & Ikoma (2003) derived the analytic formula, which is valid for accretion of sub-kilometer sized or larger particles. However, their formula overestimates the accretion rate of the metersized or smaller particles because the effective capture radius is estimated to be comparable to the Hill radius of the planet. Therefore, the atmosphere structure and flow around a protoplanet is necessary to derive accretion rates of centimeter to kilometer sized particles consistently.
Kurokawa & Tanigawa (2018) showed by hydrodynamic simulation, the atmospheric structure isolated from the protoplanetary disk is formed around the planet due to the cooling. Therefore, the self-consistent flow and atmosphere around a planet is obtainable via hy-

drodynamic simulation. The accretion rate of bodies from pebbles to planetesimals can be calculated via the orbital simulation of bodies based on the density and velocity profile in the disk obtained via the hydrodynamic simulation. Such combined simulations were carried out only for meter-sized or smaller particles (Popovas et al. 2018, 2019; Kuwahara & Kurokawa 2020a,b). However, the accretion rate for a wide size range of particles is helpful to discuss the dominant accreted bodies onto a planet.
In this paper, we investigate the collision rate between small bodies and a planet in the protoplanetary disk perturbed by the planetary gravity. Our goal is to find out the effects of the gas flow and planetary atmosphere on the collision rate. We perform hydrodynamic simulations and orbital calculations of centimeter to kilometer sized particles in the gas flow obtained from the hydrodynamic simulation. Based on simulations, we derive the new analytic formula for the collision rate in the disk perturbed by the planetary gravity including the gas flow and planetary atmosphere. In §2, we describe the simulation methods for hydrodynamics and orbital evolution of particles. In §3, we show the gas flow and atmospheric structure around a planet given by the hydrodynamic simulation and obtain the collision rate between the planet and particles via orbital calculation. In §4, we derive the new analytic formulae for the collision rate. In §5 and 6, we discuss and summarize our findings.
2. METHODS
2.1. Hydrodynamic Simulations
2.1.1. Basic Equations
We investigate the gas flow around a protoplanet with a circular orbit of radius a in a protoplanetary disk around the host star with mass M via hydrodynamic simulation. We assume a compressible, inviscid, non-isothermal, non-self-

gravitating fluid. The basic equations of the hydrodynamic simulations are the equation of continuity, the Euler's equation, and the energy conservation equation, given by

g t

+



·

(gvg)

=

0,

(1)



p

t + vg ·  vg = - g + (F cor + F tid + F p),

(2)

E t +  · [(E + p)vg] = gvg · (F cor + F tid + F p)
- U (g, T ) - U (g, T0) , (3) /

where g is the gas density, vg is the gas velocity, p is the pressure, F cor is the Coriolis force, F tid is the tidal force, F p is the gravitational force,  is the orbital frequency,  is the dimensionless cooling timescale, T and T0 is the fluid and background temperatures, respectively, and U and E are, respectively, the internal and total energy densities, given by

p

U=

,

(4)

-1

E

=

U

+

1 2

g

vg2,

(5)

with the ratio of specific heat  = 7/5.

The forces in Eqs. (2) and (3) are given by F cor = -2ez × vg, F tid = 3x2ex - z2ez, and

Fp = 

GMp r2 + rs2

1 1 - exp -
2

t2 ,
tinj (6)

where ei is the unit vector in the i-direction, Mp is the mass of the planet, G is the gravitational

constant, r is the distance from the center of

the planet, rs is the softening length, and tinj is the injection time of planetary gravity. To

3

avoid the numerical effect, the gravity of the planet is gradually inserted using the injection time tinj = 0.5-1 (Ormel et al. 2015a). The planet have an atmosphere with radius  RB, where RB  GMp/c2s is the Bondi radius and cs is the isothermal sound speed. To resolve the atmospheric structure, we set rs = 0.1RB according to Kurokawa & Tanigawa (2018).
The last term in Eq. (3) is the cooling function according to the  cooling model where the temperature T relaxes toward T0 in the timescale / (e.g., Gammie 2001). In this study, we adopt the  cooling model to obtain the density profile and flow around the planetary atmosphere according to Kurokawa & Tanigawa (2018), who showed the atmosphere is formed around the planet using the  cooling model. We set  = (RB/0.1cs)2 according to the previous studies (Kurokawa & Tanigawa 2018; Kuwahara & Kurokawa 2020a,b).
The time, velocity, and length are considered to be normalized by the reciprocal of the Keplerian orbital frequency -1, the isothermal sound speed cs, and the gas scale hight H  cs/, respectively. The basic equations are then characterized by a dimensionless number, given by

m = RB = GMp .

(7)

H

c3s

The Hill radius is written as a function of m:

m 1/3

RH = 3

H.

(8)

We assume a solar mass host star and a disk temperature profile T = 270(a/1 au)-1/2(i.e., the minimum mass solar nebula model, Weidenschilling 1977b; Hayashi et al. 1985), so that Mp is given by (Kurokawa & Tanigawa 2018)

a 3/4

Mp

12m 1 au

M.

(9)

We investigate the cases with m = 0.1, 0.05, and

0.03, which correspond to Mp/M = 1.2 (4.0), 0.6 (2.0), and 0.36 (1.2) at 1 (5) au, respectively.

4
2.1.2. Simulation Setups and Boundary
Conditions
In this study, we use the hydrodynamic simulation code Athena++ (White et al. 2016; Stone et al. 2020). We choose the HLLC algorithm for a Riemann solver. Our simulations are performed in a spherical-polar coordinate (r, , ) centered on the planet. We focus on the embedded, non-gap-opening regime and thus the local simulations are likely to be valid. In order to resolve the flow structure around the planet in detail, we adopt a logarithmic grid for the radial dimension. In the polar angle direction, the cell size is proportional to (32 + 1), where  is the angle from the midplane. The cell spacing near the midplane is smaller than near the pole (i.e., resolution near the midplane is higher than near the pole; Kurokawa & Tanigawa 2018). The numerical resolution is set to be 128 × 64 × 128 in the r, , and  directions, respectively. The computational domain ranges from 0 to 2 for , from 0 to  for , and from rinn to rout for r, where rinn and rout are the radii at the inner and outer boundaries, respectively.
We assume the initial and outer boundary values in hydrodynamic simulations are those of a Kepler disk without pressure gradient term, therefore given by

1 z2

g,0 = 0 exp

- 2

H

,

(10)

3

vg,0 = - 2 xey,

(11)

where 0 is the density at the midplane and z is the distance from the midplane. We focus on the shear regime of pebble accretion, where the shear velocity is more dominant than the headwind of the gas to determine the accretion rate. The condition satisfied to be in the shear regime is given by (Ormel 2017)

Mp

1 vh3w 8 GSt0

2.0

×

10-4M

1 St0

a 3/2 ×

vhw

3
,

1 au

50 m s-1

(12)

where vhw is the headwind of the gas and St0 is the dimensionless stopping time of a particle (see Eq. 18). We perform simulations for Mp = 0.36 - 1.2 M at a = 1 au (Mp = 1.2 - 4.0 M at a = 5 au) and St0 = 3.0×10-3 -1.0×1013, so that we ignore the headwind in our simulations.
We set the radius of the inner boundary according to that of the planet (Kuwahara & Kurokawa 2020a). We assume the density of the planet pl = 5 g/cm3, so that the radius of the inner boundary is given by

rinn =

3Mp 4pl

1/3
=

9M 1/3 RH

4pl

a

3 × 10-3m1/3

×

pl 5 g cm-3

-1/3

M 1M

1/3 a -1 (13.)
1 au

We introduce the reflective boundary condition for the inner boundary, but Kurokawa & Tanigawa (2018) reported this condition generates the unphysical energy flow in the results of simulations by Athena++. In order to prevent this unphysical affair from affecting the entire flow, we introduce the artificial cooling at the three inner cells ( = 10-5; Kurokawa & Tanigawa 2018). The boundary condition in the azimuthal direction is set to the periodic boundary, which means A(r, , ) = A(r, ,  + 2) holds for an arbitrary physical quantity A. We calculate until the steady state flow is almost achieved at t = tend. We set tend according to Kuwahara & Kurokawa (2020a). A summary of our simulation parameters is showed in Table 1, which are chosen from the values at a = 1 au.

2.2. Orbital Calculations 2.2.1. Equations and Gas Drag Law
We calculate orbits of particles in the gas flow obtained from hydrodynamic simulations. The

5

Table 1. List of parameters for our simulations. The first column shows the value of dimensionless mass of the planet. The second to eighth columns represent the corresponding values at 1 au for the mass of the planet normalized by the earth mass, the Bondi radius, the Hill radius, the size of the inner boundary, the size of the outer boundary, termination time of the hydrodynamic simulation, dimensionless cooling timescale .

m physical mass (M) RB (H) RH (H) rinn (H) rout (H) tend (-1) 

0.03

0.36

0.03

0.22 9.32 × 10-4 0.5

50

0.09

0.05

0.6

0.05

0.26 1.1 × 10-3 0.75

100 0.25

0.1

1.2

0.1

0.32 1.39 × 10-3

5

150

1

equation of motion of the particle is given by

dv dt

=

2vy + 3x2 

 

-2vx

- 

-z2

GMp r3

 x

 y

 

+

z

F drag , mp

(14)

where v = (vx, vy, vz) is the velocity vector of the particle, r = (x, y, z) is its position vector with respect to the center of the planet, and mp is the mass of the particle. The first and second terms on the right-hand side of Eq. (14) are the Coriolis and tidal forces and the gravity force of the planet, respectively. The third term is the gas drag force given by (e.g., Adachi et al. 1976)

F drag

=

- CD 2

rp2guu,

(15)

where rp is a particle radius, u  v-vg, u = |u| is the velocity of a particle relative to the gas,

and CD is the gas drag coefficient. We consider centimeter to kilometer sized particles; CD is given by the Stokes gas drag for small particles,

while CD is constant for large particles (Adachi et al. 1976). In addition, if particle velocities ex-

ceed the sound speed due to planetary gravity,

the supersonic gas drag law should be applied.

The gas drag coefficient, CD is approximated to be (Adachi et al. 1976; Tanigawa et al. 2014).

12 (2 - w)M

CD = rpu + 1.6 + M + w,

(16)

where  is the kinetic viscosity, M  u/cs is the Mach number, and w = 0.4 is the correction factor. In Eq. (16), the first, second,

and third terms indicate Stokes, quadratic, and

supersonic drag coefficients, respectively, and

we ignore Epstein drag for simplicity. In our

simulation, we do not consider the evaporation

or ablation. The kinetic viscosity is given by

 = lmfpcs/2, where lmfp = µmH/g is the mean
free path of the gas, µ = 2.34 is the mean molecular weight, mH = 1.67 × 10-24 g is the mass of the proton, and  = 2×10-15 cm2 is the molecu-

lar collision cross section (Chapman & Cowling

1970; Adachi et al. 1976). The stopping time of

a particle is expressed by

tstop

=

mpu |F drag|

=

4prp2 9gcslmfp

1 + CDrpu 6cslmfp

-1
,
(17)

where p is the density of a particle. We investigate the orbits of particles with different radii.

We introduce the Stokes parameter, St defined

as the stopping time multiplied by . The ini-

tial particle has u cs so that the gas drag is mainly given in the Stokes gas drag regime.

This initial Stokes parameter is approximated

to be

St0 = 4.5×10-4

p 1 g cm-3

cs

-1

rp

2
,

1 km s-1

1 cm

(18)

where the value of cs is chosen as that approximately at 1 au in the minimum mass solar neb-

ula model. Note that St continuously changes

during the calculation. The value of St can be

less than St0 due to the gas drag for u cs. We use St0 given in Eq. (18) as a parameter instead of the radii of particles.

6

2.2.2. Numerical Setups: 3D Orbital Calculations
A particle is launched from a starting point (xs, ys, zs), where ys is fixed at ys = 40RH, and xs and zs are varied (Ida & Nakazawa 1989; Ormel & Klahr 2010). The particle is initially well coupled to the gas for St0 1, while the motion is determined by Kepler's laws for St0 1. We thus set the initial condition according to the gas motion for St0 < 1 or the orbital elements for St0 > 1. If the orbital eccentricities of particles are much smaller than the Hill radius of the planet divided by a, the collision rate is independent of eccentricities (Ida & Nakazawa 1989). We set initially circular orbits. The initial conditions are given as follows.

zs = v0 =

z0 (St0 < 1),

ias sin   z0 sin  (St0 > 1),

3

0, - 2 xs, vz,0 ,

(19)

vz,0 =

0 (St0 < 1), z0 cos  (St0 > 1),

where i is the initial inclination of the particle, as is its initial semimajor axis and  is its longitude of ascending node. We assume  is distributed uniformly in the range between 0 and , and take the average for the calculation of the collision rate. For St0 < 1, we ignore the z-component of the tidal force in Eq. (14) assuming the balance with turbulent stirring according to Kuwahara & Kurokawa (2020a,b).
The lower limits of xs and z0 are set to xs = 0.0001H and z0 = 0 and the spacial intervals of xs and z0 are 0.0001H and 0.02H. The upper limits of xs and z0 are set to a few disk scale hights. We calculate orbits only coming from positive x and y because of the symmetry.
We use g, vg, and cs given from the hydrodynamic simulation at t = tend, at which the fluid is in a quasi-steady state. The starting point of the particle is out of the computational domain of our hydrodynamic simula-

tion (rout), so that we set the velocity and density of gas in r > rout are the same as the outer boundary conditions given in Eqs. (10) and (11). In our hydrodynamic simulations for m = 0.03 and m = 0.05, unexpected vortices are appeared in the horseshoe structure. These vortices are found by Kuwahara & Kurokawa (2020a,b), which are caused by the low resolution of the distant place from the planet. In these cases, we only use the results of the hydrodynamic simulation in r < 0.3H (m = 0.03) and in r < 0.55H (m = 0.05), respectively. All physical quantities obtained via hydrodynamic simulations are the discrete data, so that we interpolate physical quantities using the linear interpolation method (Kuwahara & Kurokawa 2020a).
Orbital integration is terminated if any one of the following conditions is satisfied. (i) A particle goes far away; |y| > 40RH. (ii) A particle collides with the planet; r < rinn, where rinn is the inner boundary for hydrodynamic simulations and the physical radius of the planet in Eq. (13).
We numerically integrate Eq. (14) using the Runge-Kutta-Fehlberg scheme (Fehlberg 1969; Eshagh 2005; Ormel & Klahr 2010). This integration method controls each time step comparing a fourth-order solution with a fifth-order solution. We set the relative error tolerance of 10-8, which ensures numerical convergence (Ormel & Klahr 2010; Visser & Ormel 2016).
We show the sketch of the orbital calculation of particles in Fig. 1.
3. RESULTS OF SIMULATIONS
3.1. Hydrodynamic Simulation
Figures 2 and 3 show the flow structures in the midplane (z = 0) and in the plane of y = 0 at t = tend, respectively. The additional simulations for t > tend show that the flow structure and physical quantities almost keep constant subsequent to t = tend, so that the fluid is in

Figure 1. Sketch of the orbital calculation of particles in the co-rotating frame. A planet is located at the origin of the frame. We calculate orbits only coming from positive x and y because of the symmetry. The dashed circle shows the outer radius of the hydrodynamic simulation. If the particle is within the radius, we use the gas velocity and density obtained from the hydrodynamic simulation. On the other hand, the particle is out of the radius, we use the gas velocity and density that is the same as the outer boundary conditions of the hydrodynamic simulation.
a quasi-steady state. The characteristic structures of the gas flow formed in the simulations are similar to the previous studies (Ormel et al. 2015b; Fung et al. 2015; Lambrechts & Lega 2017; Cimerman et al. 2017; Kurokawa & Tanigawa 2018; Popovas et al. 2018; Kuwahara et al.

7
2019; Chrenko & Lambrechts 2019; B´ethune & Rafikov 2019; Fung et al. 2019). These structures are divided into four parts. (i) The Keplerian shear streams exist the distant place from the planet (|x| 0.4H in Fig. 2). These streamlines are almost same as the initial and outer boundary conditions, because the planet is too far to change the flow. (ii) The horseshoe flow extends along the orbital direction of the planet in the anterior-posterior direction of the planet. The U-turn flows caused by the horseshoe flow are seen in |x| 0.1H and |y| 0.2H in Fig. 2. (iii) The vertical flow comes from high altitudes to planets, as seen in |x| 0.1H and |z| 0.1H in Fig. 3. Of course, this result is specific to three-dimensional calculations. (iv) The atmospheric structure is formed around the planet, as seen in |r| 0.1H in Figs. 2 and 3. This region is isolated from the outer flow, which means the gas recycling does not occur. This isolated envelope is formed due to the cooling (Kurokawa & Tanigawa 2018).
To see the atmospheric density profile we plot the density profile averaged over the azimuthal direction () in the midplane (Fig. 4). The density at r < 0.1H significantly increases wi th decreasing r, while the radial density slope at r 4 × 10-3H becomes shallower due to the softening. In a quasi-steady state, the density profile reaches the solution of the isothermal hydrostatic equilibrium in the one-dimensional analysis (see derivation in Appendix A). It should be noted that the density enhancement around the planet occurs even for r 0.1H  0.3RH  RB. Although the outer boundary of an atmosphere is conventionally set to the smaller of RH and RB (e.g., Inaba & Ikoma 2003), the atmospheric density enhancement occurs r RH even if RH > RB.
In the simulation, the density profile of the atmosphere is determined by the hydrostatic equilibrium in the cooling model that we use. The profile is different from that for the grow-

8
ing planet, because the  cooling model is too simple. On the other hand, the cooling is effective in the vicinity of the planet. Once the closed flow pattern forms the atmosphere, the flow outside the atmosphere would be almost independent of the cooling. Taking into account our finding in the hydrodynamic simulations, we discuss the effect of the more realistic atmosphere in §5.2.

Figure 3. Flow patterns in x-z plane (y = 0) for m = 0.1 at t = 150 -1 are shown by blue arrows and streamlines. The length of the arrows do not scale to the gas velocity. Color contour shows the velocity in the radial direction.

Figure 2. Flow patterns in the midplane (z = 0) for m = 0.1 at t = 150 -1 are shown by blue arrows and streamlines. The length of the arrows do not scale to the gas velocity. Color contour shows the gas density.
3.2. Two-dimensional Orbital Calculations
3.2.1. Example of 2D Orbits
First of all, we perform two-dimensional orbital calculations that means the particle exists in the midplane (z = 0). Figure 5 shows the trajectories of the particles with different St0.
For the large Stokes parameter, St0 = 1.0 × 1013 (Fig. 5a), the trajectories are almost the same as those in the gas-free case because particles are too large to be affected by the gas drag (Ida & Nakazawa 1989). Particles collide with the planet for the initial positions (xs) in three discrete bands (Fig. 5a).
For St0 = 1.0 × 102 (Fig. 5b), the orbits outside the Hill sphere is almost the same as those

104

103

g [ 0]

102

101

100

10 3

10 2

r [1H0] 1

100

Figure 4. Gas density profile in the midplane (z = 0) for m = 0.1 is plotted as a function of distance from the center of the planet. The red dot shows the gas density averaged over the azimuthal direction () in the midplane for our numerical simulation. The blue dashed line corresponds to the analytical solution in Eq. (A4).

for St0 = 1.0 × 1013. However, the particles feel strong gas drag in the atmosphere. All the particles entering the Bondi sphere collide with the planet.
For St0 1, the orbits of particles are almost independent of St0 and similar to the gas-free

9

ones unless r < RH. In the Hill sphere, the velocities of particles can be larger than the sound velocity and the gas density increases (see Fig. 4). Therefore, gas drag effectively damps the kinetic energies of particles, which induces the capture of passing particles.
For St0 = 1.0 (Fig. 5c), the orbits of particles are similar to those for St0 = 1.0 × 102. The orbits of particles in y < 0 are closer to the streamlines than those for St0 = 102 are. In addition, all particles entering the Hill sphere accrete onto the planet.
For St0 = 1.0 × 10-2 (Fig. 5d), the orbits are the almost same as the steady streamlines in Fig. 2. The horseshoe width is much smaller than that for St0 1. Particles are prevented from accreting onto the planet by the horseshoe flow and Keplerian shear flow, and the particles coming from the narrow band between the horseshoe and Keplerian shear flows allowed to collide with the planet. This result is consistent with previous studies (Popovas et al. 2018; Kuwahara & Kurokawa 2020a,b; Homma et al. 2020).

For St0 1, the collision rate increases with decreasing St0. For large St0, particles are scattered away due to close encounters with the planet, so that Pcol,2D is small. However for small St0, particles feel strong gas drag during close encounters because of high atmospheric density. Our hydrodynamic simulations indicate that density enhancement occurs even at r RB if r < RH (see Fig. 4). For 1 St0 102, particles can be captured at the outer edge of the atmosphere, r  RH. In addition, a close encounter with the planet accelerates the velocity, which can exceed the sound velocity. The super-sonic gas drag effectively reduces the kinetic energy prior to scattering. Particles are then captured by atmosphere, which enhances Pcol,2D (Inaba & Ikoma 2003).
For St0 1, Pcol,2D decreases with decreasing St0. Small particles are well coupled to the gas. The flow pattern of the gas due to horseshoe and Keplerian shear limits the accretion of particles onto the planet (see Fig. 5d). Therefore, the collision rate sharply decreases with decreasing St0.

3.2.2. 2D Collision Rate

3.3. Three-dimensional Orbital Calculations

We calculate the two-dimensional specific col-

3.3.1. Example of 3D Orbits

lision rate, Pcol = Pcol,2D, based on the orbital

First, we show the case of large particles (for

calculations. The definition of Pcol,2D is given by

St0 > 1). For ias or z0 RH, the 3D orbits projected on the x-y plane are almost the same

Pcol,2D = 2


(xs)|v0,y|dxs = 3
0


(xs)xsdxs,
0

as the 2D orbits. Figure 7a shows the orbits of particles projected on the y-z plane for St0 =

(20)

1.0×103. For i RH/as, particles pass through

where (xs) = 1 if the particle collides with the planet. Particles passing near the planet can

the planet and zero otherwise, and v0,y is y- be accreted onto the planet.

component of the initial velocity in Eq. (19).

Figure 7b shows the orbits of the smaller par-

In order to account for the collision from both positive xs and negative xs, we multiply the in-

ticles projected on the y-z plane for St0 = 1.0×10-2. Particles can be accreted if they pass

tegral over positive xs by two. Figure 6 shows the collision rate for m = 0.1
as a function of St0. For St0 1012, the colli-

near the planet as well as the case of St0 1. 3.3.2. 3D Collision Rate

sion rate converges to a constant value, which is

We calculate the three-dimensional specific

the same as the gas-free limit (Ida & Nakazawa collision rate. We then need the vertical dis-

1989; Inaba et al. 2001).

tribution of particles for the calculation.

10

y[RH]

4 3 2 1 0 1 2 3 4
2 1 x[R0H] 1 2
(a)St0 = 1.0 × 1013

y[RH]

4 3 2 1 0 1 2 3 4
2 1 x[R0H] 1 2
(b)St0 = 1.0 × 102

y[RH]

4 3 2 1 0 1 2 3 4
2 1 x[R0H] 1 2

y[RH]

4 3 2 1 0 1 2 3 4
2 1 x[R0H] 1 2

(c)St0 = 1.0

(d)St0 = 1.0 × 10-2

Figure 5. Trajectories of particles with different Stokes parameter for m = 0.1 are shown by solid lines. We restrict the motion of particles to 2D. The red and blue lines show the trajectories of particles that do and do not collide with the planet, respectively. The outer dotted and inner black circles are the Hill sphere and the Bondi sphere, respectively. The interval of orbits at the starting points is 0.01H.

101

Collision rate , Pcol, 2D [R2H ]

100

10 1

10 2 10 2

100

102 104 106 Stokes number

,

St1008

1010 1012

Figure 6. Two-dimensional specific collision rate, Pcol,2D, for m = 0.1 as a function of St0 given by Eq. (18). Red dots represent the collision rate obtained from the hydrodynamic and orbital calculations. The blue solid and yellow dashed lines indicate the detailed and simple analytical solutions given in Table 2, respectively.

For St0 > 1, we set the Rayliegh type distribution for inclinations (Ida & Makino 1992). Assuming the random orbital phases, we obtain the collision rate as,

Pcol,3D(i)

=

6 i2

 0

 0

z0,max /as
(xs, i, )xsi
0

i2

×exp

- i2

dxsddi

(21,)

where i is the dispersion of i and z0,max is the upper limit of z0. Note that the vertical distribution of particles under this assumption corresponds to a Gaussiandistribution for z0 with the scale hight of asi/ 2 (see Appendix B).
For St0 < 1, we assume the Gaussian distribution function of z0. The collision rate is given by

3



Pcol,3D(Hd)

=

 2Hd

0

(xs, z0)
0

11

z[RH]

3

2

1

0

1

2

3

4

8

6

4

2

y[R0H]

2

4

6

8

(a)St0 = 1.0 × 103

6

5

4

3

2

1

0

1

8

6

4

2

y[R0H]

2

4

6

8

(b)St0 = 1.0 × 10-2

z[RH]

Figure 7. Trajectories of particles for different z0 with interval 0.02 H projected on the y-z plane are shown by the solid lines for St0 = 1.0 × 103 with xs = 0.75 H (a) and for St0 = 1.0 × 10-2 with xs = 0.33 H (b). The colors of solid lines and the outer dotted and inner circles are the same as Fig.
5. Note that the ranges of z are different in Pannels
(a) and (b).

×xsexp

-

z02 2Hd2

dxsdz0,(22)

where Hd is the scale hight of particles. Figure 8 shows Pcol,3D(i) for St0 > 1.0 as a
function of Hd = asi/ 2, using the relation between Hd and i given in Eq. (B6). For Hd RH, Pcol,3D is independent of Hd and almost the same as Pcol,2D. For Hd RH, Pcol,3D decreases with Hd. This is caused by the passing by without collisions for high inclination parti-

cles (see Fig. 7a).

Figure 9 shows Pcol,3D(Hd) for St0 < 1.0. The dependence of Pcol,3D on Hd is similar to that for St0 > 1. For St0 = 0.003, Pcol,3D(Hd) increases around the Hd = RH. This increase is caused by the vertical gas flow that enters from high

12
latitudes as seen in Fig. 3 (see also Kuwahara & Kurokawa 2020a).

101

St0 = 1 × 103 St0 = 1 × 107 St0 = 1 × 1013

101

SStt00

= =

0.003 0.01

SStt00

= =

0.03 0.1

St0 = 0.3

100

Pcol, 3D [R2H ] Pcol, 3D [R2H ]

10 1
100

10 1

10 2

Hd[RH10] 1

100

Figure 8. Three-dimensional specific collision rates, Pcol,3D, for m = 0.1 as a function of the particle scale hight Hd = ai/ 2, where i is the dispersion of inclinations and a is the semimajor axis of the planet. Dots represent the collision rates obtained via the hydrodynamic and orbital simulations for St0 = 103(red), 107(green), 1013(blue). Dashed lines indicate the analytical solutions given in Table 2. The vertical solid black line is the Hill radius for reference.

4. ANALYTIC FORMULAE FOR PCOL
4.1. Analytic Formula of the 2D Collision Rate
In this subsection, we derive the analytic formulae for the two-dimensional collision rate. The dominant effects determining the accretion rate depend on St0. Therefore, we give different assumptions depending on St0 to derive analytic formulae below. In §. 4.1.1, we introduce the previous study for the analytic formula without gas drag. In §. 4.1.2, we consider the atmospheric capture regime, where particles with St0 1 entering atmospheres are captured due

10 2

10 2

Hd[R10H]1

100

Figure 9. Same as Fig. 8 but for St0 < 1.

to the energy losses by gas drag in atmospheres. In §. 4.1.3, we consider particles with St0 1 settle down to a planet with terminal velocities during a close encounter with the planet. In §. 4.1.4, we consider particles with St0 1 are strongly affected by the horseshoe and shear flows of gas.

4.1.1. Gas Free Limit
First, we confirm the analytic formula in the gas free limit that means particles and St0 are extremely large. The two-dimensional collision rate for the gas-free limit was derived in the previous studies, given by (Ida & Nakazawa 1989; Inaba et al. 2001)

Pcol,free0(Rpl) RH2 

=

11.3

Rpl/RH,

(23)

where Rpl is the radius of the planet. This formula is in agreement with our simulations for the huge Stokes number. Note that Eq. (23) is valid for Rpl RH. We improve the formula for Rpl  RH in §4.1.2.

4.1.2. Atmospheric Capture

Second, we derive the analytic formula for the atmospheric capture regime. Particles entering planetary atmosphere have high velocities due to planetary gravity. We estimate the terminal velocity of particles at r = RB as

u



GMp RB2

St0 

=

St0 m

cs

.

(24)

For St0 m, the velocity can be greater than the sound velocity, so that the super-sonic gas drag given by the second term in Eq. (16) is effective in the atmosphere.
The kinetic energies of particles are damped by gas drag in the atmosphere. Once the particles' energies are smaller than the gravitational energy at the Hill radius, the orbits of the particles are bound by the planet. The kinetic energy at infinity is negligible. The condition for capture of particles is then given by

E < - GMpmp ,

(25)

RH

where E is the energy loss due to gas drag in the atmosphere. We estimate E from the integral of the energy loss along the particle orbit in the atmosphere with radius Ratm, given by

E(q)  - rp2atm(r)u3 dt

Ratm
= -4GMprp2
q

atm(r) dr, r(r - q)
(26)

where  is the number of close encounters between the planet and the particle and we assume a parabolic orbit with pericenter distance q for the particle and then we use the relations u2 = 2GMp/r and dr/dt = 2GMp(r - q)/r for the derivation. We multiply two because the integral range is the half of a parabola. The number of close encounters and the atmospheric

13

radius are determined according to our simulation and we adopt  = 2 and Ratm = 0.5 RH. The following condition gives the captured radius Rcap

E(Rcap)

=

-

GMpmp RH

.

(27)

We derive Rcap satisfing Eq. (27). According to Inaba & Ikoma (2003), we ob-
tain Pcol from Pcol,free0 using Rcap instead of Rpl. However, Pcol,free0 is valid for Rpl RH. Figure 10 shows the collision rate in the gas-free case as a function of the planetary radius. For Rpl > 0.05RH, we obviously need to modify the formula. Therefore, we give the collision rate

Pcol,free = MIN [MAX (Pcol,free0, Pcol,free1) , Pcol,free2] , (28)
where

Pcol,free1(Rpl RH2 

)

=

1.06

×

103

(Rpl/RH

)2,

(29)

Pcol,free2(Rpl) RH2 

=

4.66(Rpl/RH)0.15.

(30)

For the atmospheric collision rate, we use Rcap instead of Rpl and then obtain

Pcol,atm = Pcol,free(Rcap).

(31)

4.1.3. Settling
Third, we derive the analytic formula for the settling regime. There are two regimes for settling; the cases of the supersonic gas drag and the Stokes gas drag.
For St0 1, Ormel & Klahr (2010) derived Pcol for constant St in the Keplerian shear flow. They obtained the analytic formula by comparing the encounter time with the settling time. For a particle with an impact parameter xs, the encounter time is estimated to be tenc = xs/|v0,y|, where |v0,y| = 3xs/2 is the encounter velocity. The settling time needed for particles to settle down to the planet is given by

14

Pcol, free [R2H ]

4 × 100
3 × 100 Pcol, free2 = 4.66Rp0l.15 2 × 100 Pcol, free0 = 11.3 Rpl
100

Pcol, free1 = 1.06 × 103 Rp2l

6 × 10 1

10 2

Rpl [RH]10 1

100

Figure 10. Pcol,2D is shown as a function of the planetary radius in the gas-free case.

tset = xs/uterm, where uterm is the terminal velocity determined by the force balance between the gravitational force and gas drag.
As explained above, for St0 m, the velocity of the particle approaching the planet exceeds the sound velocity, so that the supersonic gas drag, the second term in Eq. (16), is effective. The equation of force balance between the gravity and gas drag is given by

GMpmp r2

= rp2gu2term,

(32)

so that the terminal velocity is expressed by

uterm =

4GMpp

9gcslmfp St0

1/4
.

(33)

3gx2s

4p 

For tenc tset, particles are accreted onto the planets. The accretion condition is given as

C1

xs |v0,y

|

>

xs , uterm

(34)

where C1 is the constant value on the order of unity. The impact parameter xs required for the settling is given by

xs < xss =

8 1/4 3

C1

p g

cs RH

lmfp RH

S

t0

1/8
RH.

(35)

If xss is much larger than the half width of the horseshoe orbit, Pcol is given by

Pcol = 3x2ss.

(36)

Using Eqs. (35) and (36), we obtain

Pcol,ss RH2 

 = 2 6C1

p g

cs RH

lmfp RH

S

t0

1/4
.

(37)

On the other hand, if the terminal velocity of

particles is smaller than the sound speed, we

consider St  St0 even in the encounter. In that case, the Stokes gas drag, the first term in

Eq. (16), is effective. The terminal velocity is

given by

uterm

=

GMp r2

St0 . 

(38)

Same as above, Eq. (38) gives

xss = (2C1St0)1/3RH.

(39)

Using Eqs. (36) and (39), we obtain the collision

rate,

Pcol,set RH2 

=

3 (2C1St0)2/3 .

(40)

According to the our simulations, C1 = 1.5.

4.1.4. Effects of the Horseshoe and Outflow
around the Bondi Radius
Finally, we derive the analytic formula considering the effects of the horseshoe and outflow around the Bondi radius. In our simulation, the outflow with a few percent of the sound speed is found around the Bondi radius, as shown in the previous study (Kuwahara et al. 2019). For smaller St0, the horseshoe and outflow around the Bondi radius is effective. The collision rate is then given by Pcol = 2xs|v0,y|, where xs = |xss - rHS| is the difference between the impact parameter and the half horseshoe width rHS. The particles passing around r  RB are accreted onto the planet if they can enter the Bondi radius (see Fig. 5d). We consider the passing particles distribute from

15

r = RB to r = RB + r. The mass conservation gives xs|v0,y| = rv. If the particle at r = RB + r enters the Bondi radius with the radial drift of r during the encounter, the particle then accrete onto the planet. Therefore, the accretion condition is given by the passing time comparable to or longer than the drift time; RB/v r/vr. We thus estimate Pcol as

Pcol = 2RBvr.

(41)

Assuming the outflow velocity of cs with  1, vr is expressed by the terminal velocity uterm and the outflow velocity cs, given by

vr

=

GMP r2

St0 

-

cs.

(42)

Using Eqs. (41) and (42), we obtain

Pcol,ho RH2 

= 2 RB RH

3St0 (RB/RH)2

-



3 .
(RB/RH)

(43)

We adopt  = 0.1m, based on the results of

hydrodynamic simulations for m = 0.03 - 0.1.

Note that the radial outflow velocity determined

by  is much smaller than the flow velocity

around r  RB derived by Kuwahara et al. (2019). We use the m dependence of  given

by their formula.

4.2. Analytic Formulae of 3D Collision Rates

where Rcap is the captured radius obtained from Eq. (27).
For St0 < 1, Pcol,3D  Pcol,2D for Hd RH, while Pcol,3D  xss/Hd for Hd RH (see Fig. 9). Therefore, we empirically give

Pcol,3D(Hd) =

(Pcol,2D)-2 +

Pcol,2D

xss 0.65Hd

-2 -1/2
,

(45)

where Pcol,2D is given by the smallest of Eqs.

(37), (40), and (43) and xss is determined accordingly (see Table 2). If Pcol,2D is given by

Eq. (43), we set xss = 2RB. Figures 8, 9, 11, and 12 show the analytical

solution and simulation results. These for-

mulae are in agreement with our simulation for

almost all Stokes numbers, but for St0 = 0.003 in m = 0.1 the mean collision rate is under-

estimated for Hd RH. This is the result of vertical gas flow that enters from high latitudes

(Kuwahara & Kurokawa 2020a; Homma et al.

2020). This flow brings the particle that ac-

cretes onto the planet, so that the collision rate

is maintained or increased.

4.3. Summary of Equations for Pcol In the following equations, we summarize the two dimensional collision rate.

Pcol,2D = MIN(Pcol,atm, Pcol,ss, Pcol,set, Pcol,ho), (46)
where

In this subsection, we focus on the threedimensional specific collision rate.
For St0 > 1, the i dependence of Pcol is given in Inaba et al. (2001). Here, we consider the capture radius instead of the planetary radius according to §4.1.2 (e.g., Inaba & Ikoma 2003). We then obtain

Pcol,3D(i) RH2 

=

Pcol,2D -2 RH2 

Pcol,atm = Pcol,free(Rcap),

Pcol,ss RH2 

=

 2 6C1

p g

cs RH

lmfp RH

St0

1/4
,

Pcol,set RH2 

=

3

(2C1St0)2/3

,

(47) (48) (49)

Pcol,ho RH2 

=

2 RB RH

3St0 (RB/RH)2

-



3 ,
(RB/RH)

(50)

+

Rc2ap

17.3 + 232RH

4aiRH

Rcap

-2 -1/2 Pcol,free(Rcap) is given in Eq. (28). Figures 6, 11, (44),and 12 show the analytical solution and simula-

16

tion results for m = 0.1, 0.05, and 0.03, respec- formula is in agreement with simulations for

tively. Our analytic formulae are in agreement with our simulation.

m = 0.03 - 0.1. Table 2 shows the summary of how the colli-

If you feel the formula for Pcol,free in Pcol,atm is complicated, Pcol,atm can be simple by setting the planetary radius Rpl to the capture radius Rcap in Eq. (23), thus

sion rate Pcol can be obtained.
5. DISCUSSION 5.1. Comparison with Previous Studies

Pcol,atm RH2 

=

11.3

MIN(Rcap/RH, 1/8).

(51)

We derive the analytic solutions for the collision rates. These formulae are improved com-

Although the maximum of Rcap is much larger than RH/8, the simple formula overestimates Pcol for large Rcap so that we give the upper limit Rcap = RH/8 in Eq. (51). The simple formula is shown by the yellow dashed lines in Figs. 6, 11, and 12 and almost same as the more accurate formula.
If the vertical distribution is wide enough (Hd RH), we need the three-dimensional specific collision rate Pcol,3D. For St0 > 1, Pcol,2D  Pcol,atm and the vertical distribution of particles is determined by orbital inclinations i. For i, the dispersion of i, Pcol,3D is given by

paring to the previous studies, as explained below.
Large particles are captured via planetary atmosphere. Protoplanets larger than the Moon can have an atmosphere (e.g., Mizuno et al. 1978). Inaba & Ikoma (2003) obtained the analytic formula for Pcol using the capture radius Rcap instead of the planetary radius, Rpl. They set the atmospheric outer boundary is given by RB if RB < RH. However, the hydrodynamic simulation shows the atmospheric radius, inside which the density is enhanced, is given by the Hill radius rather than by the Bondi radius (see Fig. 4), resulting in Rcap  RH for small parti-

Pcol,3D(i) RH2 

=

Pcol,2D -2 RH2 

cles. However, their formula overestimates Pcol for Rcap  RH, because Eq. (23) is valid only for Rcap RH. As discussed in §4.1.2, we thus im-

+

Rc2ap

17.3 + 232RH

4aiRH

Rcap

-2 -1/2 prove the formula for Rcap  RH. On the other (52),hand, Inaba & Ikoma (2003) considered a single encounter. Multiple encounters are important

where i is related to the scale hight Hd as i = 2Hd/a (See Eq. B6). On the other hand, for
St0 < 1, Pcol is determined by Pcol,ss, Pcol,set, or Pcol,ho and Pcol,3D(Hd) is given by

for Rcap  Rpl so that we take into account the effect (see Eq. 26).
We consider the super-sonic gas drag as well as the Stokes gas drag. In the previous studies for St0 < 1, mainly the Stokes or Epstein

Pcol,3D(Hd) =

(Pcol,2D)-2 +

Pcol,2D

xss 0.65Hd

-2 -1/2gas drag law were considered for discussing the p, ebble accretion. However, the velocity of the particles can be greater than the sound velocity,

(53) so that the super-sonic gas drag is effective (see

where xss is given by Eq. (35) if Pcol,2D = Pcol,ss,

Eq. 24). We derive the analytic solution for

xss is given by Eq. (39) if Pcol,2D = Pcol,set, and

St0  1 considering the super-sonic gas drag.

xss = 2RB if Pcol,2D = Pcol,ho.

This solution enables smooth connection of an-

We compare the analytic formula for m = 0.1, alytic solutions, between the atmospheric and

0.05, and 0.03 in Figs. 8, 9, 11, and 12. The settling regimes.

17
Table 2. Summary of calculating the analytic collision rate.

Pcol,2D 1. Determine the size or stopping time of a particle: 2. Calculate the capture radius Rcap: 3. Calculate Pcol,2D in different regimes :
4. Result of Pcol,2D: Pcol,3D 5. Determine the distribution of particles: 6. Calculate the impact parameter xss :
7. Result of Pcol,3D:

Eq. (18) Eqs. (26) and (27) Pcol,atm Eq. (47) or Eq. (51) Pcol,ss Eq. (48) Pcol,set Eq. (49) Pcol,ho Eq. (50) Pcol,2D = MIN(Pcol,atm, Pcol,ss, Pcol,set, Pcol,ho)
 i or Hd (i = 2Hd/a) Eq. (35) if Pcol,2D = Pcol,ss Eq. (39) if Pcol,2D = Pcol,set xss = 2RB if Pcol = Pcol,ho Eq. (52) if Pcol,2D = Pcol,atm Eq. (53) otherwise

Collision rate , Pcol, 2D [R2H ] Pcol, 3D [R2H ] Pcol, 3D [R2H ]

101

101

St0 = 1 × 103 St0 = 1 × 107 St0 = 1 × 1013

101

SStt00

= =

0.003 0.01

SStt00

= =

0.03 0.1

St0 = 0.3

100

100

100

10 1

10 1

10 2 10 2

100

102 104 106 Stokes number

,

St1008

1010 1012

(a) Pcol,2D

10 1

10 2

Hd[RH10] 1

100

(b) Pcol,3D(i)

10 2

10 2

Hd[R10H]1

100

(c) Pcol,3D(Hd)

Figure 11. The same as Figs. 6, 8, and 9, but for m = 0.05.

For the even smaller particles (St0 1), the flow pattern of the gas due to horseshoe and Keplerian shear limits the accretion of particles onto the planet, as pointed out in the previous studies (Popovas et al. 2018; Kuwahara & Kurokawa 2020a,b; Homma et al. 2020). We derive the analytic solution, considering the flow effect. For the three-dimensional case, the vertical gas flow enters from high latitudes. Thus,

particles can accrete onto the planet from high latitudes. This three-dimensional effect is also shown in the previous studies. Taking into account the effect, we derive the analytical formula for the vertical distribution dependence of Pcol (see §4.2).
5.2. Collision Rate for Realistic Atmosphere

18

Collision rate , Pcol, 2D [R2H ] Pcol, 3D [R2H ] Pcol, 3D [R2H ]

101

101

St0 = 1 × 103 St0 = 1 × 107 St0 = 1 × 1013

101

SStt00

= =

0.003 0.01

SStt00

= =

0.03 0.1

St0 = 0.3

100

100

100

10 1

10 1

10 2 10 2

100

102 104 106 Stokes number

,

St1008

1010 1012

(a) Pcol,2D

10 1

10 2

Hd[RH10] 1

100

(b) Pcol,3D(i)

10 2

10 2

Hd[R10H]1

100

(c) Pcol,3D(Hd)

Figure 12. The same as Figs. 6, 8, and 9, but for m = 0.03.

In our simulation, the density of the atmosphere is unrealistic because the density profile reaches the hydrostatic isothermal solution and becomes shallower in the vicinity of the planet due to the softening. As showed above, the density profile is consistent with the hydrostatic equilibrium in r RH (see Fig. 4). Therefore, adopting the hydrostatic density profile of the atmosphere according to the accretion heating and the opacity, we then obtain realistic Pcol. In this subsection, we calculate the analytic collision rate using the more realistic density profile for the atmpsphere than that obtained by the simulation.
We consider low opacity atmospheres, where the energy transportation is dominated by radiation rather than convection. For r RB, the analytical atmospheric density profile is approximately given by (Inaba & Ikoma 2003; Kobayashi et al. 2011)

We assume

Le

=

GMp Rpl

dMp . dt

(55)

We calculate Rcap according to the density profile given in Eq. (54) and then obtain Pcol from our analytic formula.
Figure 13 shows the analytical twodimensional specific collision rates (Table 2) for the more realistic density profile, assuming dMp/dt = 1 × 10-6Myr-1. The density profile in Eq. (54) with  = 0.01 cm2 g-1 is similar to the Eq. (A4) so that the collision rate is similar to our simulation (Fig. 13). For the planet formation, the accretion rate and Pcol are determined consistently (e.g., Inaba et al. 2003; Chambers 2006; Kobayashi et al. 2011; Kobayashi & Tanaka 2018).

5.3. Estimate of Planetary Growth

atm

=

SB 12Le

GMpµmH kB

41 r3 ,

(54)

where  is the opacity of the atmosphere, kB is the Boltzmann constant, and SB is the StefanBoltzmann constant. The planetary luminosity Le mainly comes from the accretion of bodies.

In this subsection, we estimate the accretion timescale Tacc and the required disk mass Mreq for the formation of a planet with mass Mp. Solid materials drift inward to the protoplanetary disk. The drift velocity vdrift is given by (Weidenschilling 1977a; Adachi et al. 1976)

vdrift

=

-

1

2St0 + St20

vhw,

(56)

101

Collision rate , Pcol, 2D [R2H ]

100

10 1

10 2 10 2

100

102 104 106 Stokes number

,

St1008

1010 1012

Figure 13. Same as Fig. 6 but for the case of the more realistic atmosphere. The green and cyan lines correspond to the analytical solutions (Table 2) for  = 1 cm2 g-1 and  = 0.01 cm2 g-1.

where vhw is the headwind velocity. We define the accretion efficiency of solids





M p M drift

=

Pcold , 2ad|vdrift|

(57)

where d is the surface density of solids. The required disk mass and the accretion timescale are, respectively, defined by

Mreq



Mp , 

(58)

Tacc



Mp M p

.

(59)

where  is the gas to solid ratio. We assume

the particle scale hight is given by (Youdin &

Lithwick 2007)

Hd =

1 + St0 1 + 2St0  1 + St0

-1/2
H,

(60)

where  is the turbulent parameter (Shakura & Sunyaev 1973).
Figure 14 shows Tacc and Mreq for a planetary mass Mp = 10M, a = 5 au, d = 2 g cm-2,

19
vhw  50 m s-1,  = 100, and  = 1 × 10-3. We obtain Pcol via the analytic formula shown in Table 2 for low eccentricity partciles. Therefore our estimate is valid for St0 100 (see Appendix C)
Very small particles (St0 10-3) are hardly accreted onto the planet (see §4.1.4), so that the accretion timescale and required mass are huge.
For St0  1, the accretion timescale is much shorter than the disk lifetime as well as the previous studies (e.g, Ormel & Klahr 2010). However, a massive disk is required for the formation of the single core of a gas giant planet.
For large particles (St0 10), the accretion timescale is as short as that for St0  1, because of the atmospheric enhancement. The accretion efficiency is close to the unity because the drift velocity is slow. The required disk mass is thus a constant value; Mreq  Mp because of   1.
The radial drift of particles with St0  1 effectively supplies materials for planet growth in the inner disk. However, the accretion efficiency of such particles is low. Once collisional growth among drifting particles results in large bodies with St0 10, the cores of giant planets are effectively formed. We will address this issue by treating the collisional evolution and radial drift consistently (e.g., Kobayashi & Tanaka 2018).
6. SUMMARY AND CONCLUSIONS
In this paper, we investigate the effect of the protoplanetary disk perturbed by the planet on the collision rate of particles with the planet. We perform the non-isothermal three dimensional hydrodynamic simulation in the frame co-rotating with the planet and then integrate the equation of motion of particles in the gas flow obtained from the simulation considering the super-sonic and Stokes gas drag. We then derive the new analytic formulae for the collision rate, considering the following regimes:
1. Meter-sized or larger particles are captured via the planetary atmosphere. Because

20

101

100

100 10 1

Tacc [Myr] Mreq [M ]

10 1
Tacc

Mreq
10 2

10 2

10 2

10

1
Stokes

100 number

,

St0

101

102 10 3

Figure 14. Blue and red lines show the accretion timescale and the required disk mass for  = 0.01cm2 g-1 (solid), 1cm2 g-1 (dased). Note that our analytic formulae are applicable for St0 100 (see Appendix C).

they approach the planet exceeding the sound velocity, they feel strong gas drag. The atmosphere decelerates and captures the particles. The collision rate is significantly enhanced by the atmosphere.

2. Smaller particles are influenced by the gas flow in the protoplanetary disk effectively. They are well coupled to the gas flow. The collision rates are determined by comparing two timescales: the encounter timescale in which a particle has a close encounter with a planet and the settling timescale in which a particle drifts onto a planet. If the settling timescale is shorter than the encounter timescale, a particle collide with a planet. For relatively large particles, the drift velocity is determined by the super-sonic gas drag, while the Stokes gas drag is dominant for smaller particles.

3. If the particles are very small, the horseshoe gas flow and the outflow around the planet prevent particles from colliding with the planet. As a result, the collision rate sharply decreases with the decreasing size of particles. Particles can collide with the planet in the narrow band between the Keplerian shear and horseshoe flows.
These analytical formulae (summarized in Table 2) are in good agreement with our numerical simulations. In the three-dimensional case, we also derive the analytic formulae (Eqs. 52 and 53) and confirm the consistency between simulations and the analytical solutions. We show the method to obtain the analytic collision rate with the analytic formulae in Table 2 and §4.3.
We estimate the formation timescale of a solid core for the gas giant formation (Fig. 14). The formation timescale is much shorter than the disk lifetime if St0 = 10-2 to 102. However, the drift velocity is so high that the accretion efficiency is small for St0 10. Therefore, the collisional evolution between pebbles drifting from the outer disk may be important to reconcile the issue. Our results are helpful to discuss the planet formation in a wide size distribution of bodies.
We are grateful to the anonymous referee for helpful comments, which significantly improves the original version of our manuscript. We would like to thank Elijah Mullens for valuable comments. This work is supported by the financial support of JSPS KAKENHI Grant (17K05632, 17H01103, 17H01105, 18H05438, 18H05436, 20H04612, 21K03642). Hydrodynamic simulations in this work were carried out on the Cray XC50 supercomputer at the Center for Computational Astrophysics, National Astronomical Observatory of Japan. We thank Athena++ developers: James M. Stone, Kengo Tomida, Christopher White, and Kyle Gerard Felker.

21 APPENDIX

A. ANALYTICAL SOLUTION OF THE DENSITY PROFILE

In our hydrodynamic simulations, we adopt the  cooling model. The density profile reaches the

isothermal solution in the quasi-steady state. To solve the density profile analytically, we assume the

hydrostatic equilibrium in the isothermal case. The equation for the hydrostatic equilibrium is given

by

p r

=

-

GMpr (r2 + rs2)3/2

g.

(A1)

We use the relation between the density and the pressure in the isothermal, p = gc2s . We then have

1 p =-

RBr

.

p r

(r2 + rs2)3/2

(A2)

The solution to this equation is given by

p = p0 exp

RB - r2 + rs2

RB

,

RH2 + rs2

(A3)

g = 0 exp

RB - r2 + rs2

RB

,

RH2 + rs2

where we assume p = p0, g = 0 at the Hill radius. The solution is plotted in Fig. 4 and in agreement with our simulation.

(A4)

B. RELATION BETWEEN THE DUST SCALE HIGHT AND THE DISPERSION OF INCLINATIONS
The large particles have orbital inclinations, so that the z-coordinate is given by

z = ia sins,

(B1)

where s is the true anomaly of the particle. Assuming the isotropic distribution of the true anomaly, the distribution function of z for an arbitrary i, f (z) is given by

11

1

1

f (z) =  dz/ds = ia coss = ia (1 - z2/i2a2)1/2 .

(B2)

The Rayleigh-type distribution function of inclination is given by

2i

i2

n(i) = i2 exp - i2 .

(B3)

Thus, the distribution function of z is given by



 2 exp (-i2/i2)

f (z)n(i)di =

di

z/a

z/a ai2 (1 - z2/i2a2)1/2

1

z2

=  exp -

.

a i

i2a2

(B4)

22

Eq. (B4) corresponds to the Gaussian distribution of z. On the other hand, the Gaussian distribution function of z with the scale hight Hd is given by

1

z2

 exp 2Hd

- 2Hd2

.

(B5)

Comparing the two distribution functions in Eqs. (B4) and (B5), we obtain

ai Hd =  .
2

(B6)

C. CONDITION FOR E RH/A

We here estimate the dispersion of eccentricity for small particles around a planet according to

Kobayashi et al. (2010, 2011). The eccentricity damping rate due to the viscous stirring is given by

(Ohtsuki et al. 2002)

de2 dt

=

nMa2

RH a

4
PVS ,

(C1)

where e is the dispersion of eccentricity, PVS is the dimensionless stirring rate, and nM is the surface number density of protoplanets given by

1 nM = 24/3~bRHa ,

(C2)

where ~b 10 is a factor of the orbital separation of protoplanets (Kokubo & Ida 2002). On the other hand, e-damping rate due to the gas drag is given by

de2

e2

= -2 .

dt

St0

(C3)

Gas drag effectively damps e of small particles, so that we adopt PVS = 73 is independent of e for e RH/a. Thus, the equilibrium condition between the stirring and the damping gives

e2 =

(RH/a)3 PVS 27/3~b



 0.46

RH a

3
St0.

(C4)

For the planet formation with Mp = 10M (RH/a  0.02), e RH/a for St0 100. Therefore, our estimate in Fig. 14 is valid for St0 100.

REFERENCES

Adachi, I., Hayashi, C., & Nakazawa, K. 1976, Progress of Theoretical Physics, 56, 1756
B´ethune, W., & Rafikov, R. R. 2019, MNRAS, 488, 2365
Chambers, J. E. 2006, ApJL, 652, L133

Chapman, S., & Cowling, T. G. 1970, The mathematical theory of non-uniform gases. an account of the kinetic theory of viscosity, thermal conduction and diffusion in gases
Chrenko, O., & Lambrechts, M. 2019, A&A, 626, A109

Cimerman, N. P., Kuiper, R., & Ormel, C. W. 2017, MNRAS, 471, 4662
Eshagh, M. 2005, Journal of the Earth & Space Physics, 31, 1
Fehlberg, E. 1969, NASA Technical Report, 315 Fung, J., Artymowicz, P., & Wu, Y. 2015, ApJ,
811, 101 Fung, J., Zhu, Z., & Chiang, E. 2019, ApJ, 887,
152 Gammie, C. F. 2001, ApJ, 553, 174 Hayashi, C., Nakazawa, K., & Nakagawa, Y. 1985,
in Protostars and Planets II, ed. D. C. Black & M. S. Matthews, 1100­1153 Homma, T., Ohtsuki, K., Maeda, N., et al. 2020, ApJ, 903, 98 Ida, S., & Makino, J. 1992, Icarus, 96, 107 Ida, S., & Nakazawa, K. 1989, A&A, 224, 303 Inaba, S., & Ikoma, M. 2003, A&A, 410, 711 Inaba, S., Tanaka, H., Nakazawa, K., Wetherill, G. W., & Kokubo, E. 2001, Icarus, 149, 235 Inaba, S., Wetherill, G. W., & Ikoma, M. 2003, Icarus, 166, 46 Kobayashi, H., & Tanaka, H. 2018, ApJ, 862, 127 Kobayashi, H., Tanaka, H., & Krivov, A. V. 2011, ApJ, 738, 35 Kobayashi, H., Tanaka, H., Krivov, A. V., & Inaba, S. 2010, Icarus, 209, 836 Kokubo, E., & Ida, S. 2002, ApJ, 581, 666 Kurokawa, H., & Tanigawa, T. 2018, MNRAS, 479, 635 Kuwahara, A., & Kurokawa, H. 2020a, A&A, 633, A81 --. 2020b, A&A, 643, A21 Kuwahara, A., Kurokawa, H., & Ida, S. 2019, A&A, 623, A179

23
Lambrechts, M., & Johansen, A. 2012, A&A, 544, A32
Lambrechts, M., & Lega, E. 2017, A&A, 606, A146 Mizuno, H., Nakazawa, K., & Hayashi, C. 1978,
Progress of Theoretical Physics, 60, 699 Moldenhauer, T. W., Kuiper, R., Kley, W., &
Ormel, C. W. 2021, A&A, 646, L11 Ohtsuki, K., Stewart, G. R., & Ida, S. 2002,
Icarus, 155, 436 Ormel, C. W. 2013, MNRAS, 428, 3526 --. 2017, The Emerging Paradigm of Pebble
Accretion, ed. M. Pessah & O. Gressel, Vol. 445, 197 Ormel, C. W., & Klahr, H. H. 2010, A&A, 520, A43
Ormel, C. W., Kuiper, R., & Shi, J.-M. 2015a, MNRAS, 446, 1026
Ormel, C. W., Shi, J.-M., & Kuiper, R. 2015b, MNRAS, 447, 3512
Popovas, A., Nordlund, °A., & Ramsey, J. P. 2019, MNRAS, 482, L107
Popovas, A., Nordlund, °A., Ramsey, J. P., & Ormel, C. W. 2018, MNRAS, 479, 5136
Shakura, N. I., & Sunyaev, R. A. 1973, A&A, 500, 33
Stone, J. M., Tomida, K., White, C. J., & Felker, K. G. 2020, ApJS, 249, 4
Tanigawa, T., Maruta, A., & Machida, M. N. 2014, ApJ, 784, 109
Visser, R. G., & Ormel, C. W. 2016, A&A, 586, A66
Weidenschilling, S. J. 1977a, MNRAS, 180, 57 --. 1977b, Ap&SS, 51, 153 White, C. J., Stone, J. M., & Gammie, C. F. 2016,
ApJS, 225, 22 Youdin, A. N., & Lithwick, Y. 2007, Icarus, 192,
588

