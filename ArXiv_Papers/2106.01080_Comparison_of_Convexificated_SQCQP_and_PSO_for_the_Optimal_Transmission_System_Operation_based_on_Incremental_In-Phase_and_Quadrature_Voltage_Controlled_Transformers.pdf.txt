Comparison of Convexificated SQCQP and PSO for the Optimal Transmission System Operation based on Incremental In-Phase and Quadrature Voltage Controlled Transformers
Marcel Sarstedt1, Thomas Leveringhaus1, Leonard Kluﬂ1, and Lutz Hofmann1 1Institute of Electric Power Systems, Electric Power Engineering Section, Leibniz Universit‰t Hannover, Germany 1[surname]@ifes.uni-hannover.de

arXiv:2106.01080v1 [eess.SY] 2 Jun 2021

Abstract
The optimal operation of electrical energy systems by solving a security constrained optimal power flow (SCOPF) problem is still a challenging research aspect. Especially, for conventional optimization methods like sequential quadratic constrained quadratic programming (SQCQP) the formulation of the incremental control variables like in-phase and quadrature voltage controlled transformers in a solver suitable way is complex. Compared to this, the implementation of these control variables within heuristic approaches like the particle swarm optimization (PSO) is simple but problem specific adaptations of the classic PSO algorithm are necessary to avoid an unfortunate swarm behavior and local convergence in bad results. The objective of this paper is to introduce a SQCQP and a modified PSO approach in detail to solve the SCOPF problem adequately under consideration of flexible incremental in-phase and quadrature transformers tap sets and to compare and benchmark the results of both approaches for an adapted IEEE 118-bus system. The casestudy shows that both approaches lead to suitable results of the SCOPF with individual advantages of the SQCQP concerning the quality and the reproducibility of the results while the PSO lead to faster solutions when the complexity of the investigation scenario increases.
Keywords-- Redispatch, Grid Control Optimization, Security Constrained Optimal Power Flow, Sequential Quadratic Constrained Quadratic Programming, Particle Swarm Optimization

1 Motivation
The massive integration of decentral energy resources especially to the distribution grid level leads to a transition of the electric power system. The share of conventional thermal power plants in the energy mix is reduced because of the power supply priority of renewables and the phase-out of nuclear and fossil fuel based generation in Germany. The former unidirectional active and reactive power flows from the transmission to the distribution grid level become bidirectional and volatile and the directions of active and reactive power flows are decoupled. The existing grid is more stressed in operating points with a high share of renewables and partially critical system states may arise due to long distances between power generation and loads. A variety of grid control actions by the system operators are necessary to guarantee a secure and reliable energy supply. The distribution grid level becomes increasingly active due to the flexibility potentials of converter coupled energy resources, the massive integration of measurement infrastructure and information and communication technologies. In contrast to that, the flexibility potentials regarding the provision of ancillary services for the grid control decrease at the transmission grid level. Cost-intensive grid expansion measures and a large number of redispatch actions by the transmission system operators are the consequence. The optimal planning of these redispatch actions and additional grid control measures (e.g. transformer tap sets)

focusing a grid loss reduction in the interest of common welfare can be described by an security constrained optimal power flow problem (SCOPF) [1, 2]. For the solution of the SCOPF suitable robust optimization methods are necessary that can deal with the specific requirements of the meshed transmission grid level and a variety of different flexibilities to avoid local convergence. Operational degrees of freedom within this paper are represented by the active and reactive power redispatch and voltage control of thermal power plants, the curtailment of renewable power supply as well as incremental in-phase and quadrature voltage control of transformers. Solving a SCOPF is challenging, due to its non-convexity, np-hardness [3] and high number of degrees of freedom [4]. Therefore, this paper presents the comparison of two, independently developed optimization methods (see section 3) for the solution of the SCOPF problem described in section 2. The first approach is a solution by a sequentially solved convexificated Quadratically Constrained Quadratic Program (SQCQP) based on [5≠8], which is presented in section 3.1. The second approach solves a mixed integer, non-linear optimization problem using a modified particle swarm optimization (PSO) e.g. with an enhanced velocity control of the swarm (see section 3.2, [9]). For the evaluation of the swarm fitness in the PSO as well as of the quality of approximation in the SQCQP a Newton Raphson power flow calculation is used. The focus of the PSO approach is a robust application to the SCOPF problem by avoiding local optima without an

optimization of the PSO hyperparameters. The intention of the comparison and the main contribution of this paper are the benchmark and reproducibility of both approaches for the solution of SCOPF based problems at the transmission grid level and the identification of individual advantages (e.g. computation time, quality of the results). The benchmark scenario is based on an adaption of the IEEE 118-bus transmission grid regarding German transmission grid characteristic, introduced in [10]. A MathWorks MATLAB dataset of the grid and the results of the case study will be accessible at [11] for reproducibility reasons. The scenarios for the case-study and the results for the comparison of both approaches are presented in section 4.

2 Definition of the SCOPF Problem

In general the formulation of the SCOPF problem within
this paper is based on [2, 4]. The first summand of the
SCOPF objective function (see Eq. 1) to be minimized considers the grid losses Ploss monetized with the cost factor closs. The second summand is the monetarization of nodal active power adaptations pN using the energy resource specific redispatch cost vector cN. The grid losses are a function of the complex nodal voltages vN:

min

closs

∑

Ploss

(vN

)

+

c

T N

∑

pN

(1)

s.t.

vN,min  vN (vN)  vN,max (2)

iT (vN)  iT,max (3)

(pN0

+

pN

)

+

j

(qN0

+

qN)

=

3

∑

V

N

∑Y

 NN

∑

vN

(4)

The constraints (see Eq. 2, 3 and 4) of the SCOPF are
represented by the minimum and maximum of the absolute value of the nodal voltages (vN,min, vN,max), the maximum admissible absolute value of the terminal current of the lines and transformers (iT,max) and the balances of nodal active and reactive power (pN, qN) within the power equation of Eq. 4. Thereby, V N is the diagonal matrix of the nodal voltages vN and Y NN is the nodal admittance matrix of the system.
The first two categories of operational degrees of freedom
are redispatch measures represented by the change of the active and reactive power supply (pN, qN) of the different energy resources within the limits:

pN,min  pN  pN,max

(5)

qN,min  qN  qN,max

(6)

At the slack and generation buses the voltage magnitudes are control variables. The flexibility range for the voltage control are specified by Eq. 2 and constraints of the SCOPF are given by Eq. 6. Further operational degrees of freedom originate from the flexible adaptation of tap changer positions regarding an in-phase and quadrature voltage control of the transformers at their lower voltage side j. The implementation of both is based on the general T-equivalent circuit of a transformer (see Fig. 1). The electric behavior at the higher voltage level node i

i Ii

~Y i

Vi

~Y¥j
Y s,i, j

I¥j j¥ V¥j

 Ij j Vj

~

Figure 1 T-equivalent circuit of a transformer

and the lower voltage level node j is described by the
terminal currents (Ii, I j), the terminal voltages (V i,V j) interconnected by the terminal admittance matrix Y i j within the two-port equation:

Ii Ij

=Yij

Vi Vj

1 Y i j = Y i + Y j + Y s,i, j

Y i Y j + Y s,i, j

-

 j

Yi

Y

j

(7)

- j Y i Y j  j 2 Y j Y i + Y s,i, j

(8)

The rated terminal admittance matrix Y i j,r without in-phase and quadrature voltage control is based on Eq. 9. The
rated phase shifting is specified by the vector group code number k (e.g. k = 5 for vector group Yd5):



j,r

=

Vi,r V j,r

ejk30

with

Vi,r

> Vj,r

(9)

The adaptation of Y i j,r in case of in-phase and quadrature voltage control is described with the help of a diagonal tap
changing matrix T i j,rel and the relative tap changings i,rel and  j,rel in Eq. 10, wheras i,rel typically equals 1 because only one side of the transformer has tap changers.

T i j,rel =

i,rel = 1 0

0  j,rel

(10)

Thereby, the in-phase voltage control is specified by the voltage change integer n and the increment of the relative voltage change Vj,inc at the lower voltage side. The quadrature voltage control is given by the phase shift integer m and the increment of the phase shift  j,inc. Both are combined in Eq. 11 and reformulated in Eq. 12, based on the transformer model in [12]:

ejm j j,inc  j,rel = 1 + n jVj,inc  j,rel ∑ (1 + n jVj,inc) = ejm j j,inc

(11) (12)

The increment of the relative voltage change Vj,inc and the increment of the phase shift  j,inc are constant parameters of a specific transformer type. The additional non-convexity resulting from the integer property of the transformer steps complicates the solution process. The limits of the in-phase and quadrature voltage control of each transformer are given by the minimum and maximum phase shift and voltage change integers, respectively:

m j,min  m j  mj,max, m j  Z

(13)

n j,j,min  n j  nj,max n j  Z

(14)

The resulting terminal admittance matrix Y i j of a transformer can be calculated with Eq. 15.

Y

ij

=

T

 i j,rel

∑Y

i j,r

∑T

i j,rel

(15)

To combine the two-port equations of all transmission
assets, the two-port matrices Y i j,r are arranged in a block diagonal matrix Y TT,r and the tap changing matrices T i j,rel are arranged in a block diagonal matrix T T,rel. So in Eq. 16 the matrix form of Eq. 15 and the terminal admittance
matrix Y TT result. In Eq. 17 the additionally necessary matrix form of Eq. 12 is given, in which e is a one vector,
MT and N T are the diagonal matrices of all m j and n j and vT,inc and  T,inc are vectors of the increment parameters Vj,inc and  j,inc:

Y

TT

=

T

 T,rel

∑Y

TT,r

∑

T

T,rel

T T,rel ∑ (1T + N T ∑ vT,inc) = ejMT∑ T,inc

(16) (17)

For transmission lines and transformers terminals without
voltage control, the matrix T T,rel only contains ones on its corresponding diagonal elements and:

m j,min = m j,max = n j,min = n j,max = 0

(18)

Vj,inc = 0

(19)

 j,inc = 0

(20)

To consider the topology of the network the node-terminal-
incidence matrix INT is used to calculate the nodal admittance matrix Y NN in Eq. 21. The incidence matrix INT describes the topology of the grid by the specification of
the connection nodes i and j of each two-port:

Y

NN

=

-I NT

∑Y

TT

∑

I

T NT

(21)

Eq. 16, 17 and 21 need to be added to the SCOPF in Eq. 1-4 to consider the additional degrees of freedom of transformer tap changings.

3 Optimization Methods for the Solution of the SCOPF
The resulting formulation of the SCOPF has been derived in the previous section. As described in section 1, this paper presents the comparison of two, independently developed optimization methods for the solution of the SCOPF problem. Adaptions of the problem formulation according to specific needs of the approach and adaptions of solver parameters are described in the following sections.

of two. Therefor, auxiliary equations and variables are implemented. In the following these auxiliary variables will have an additional index a. All equations are split into their real and imaginary part in Cartesian coordinates. Eq. 17 takes a special role, because if proceeding in the aforementioned way, the variables m j would be part of the argument of sine and cosine functions, and therefore there would be non-quadratic functions. Due to the integer property of m j, exact reformulations as piecewise linear functions with vertices at all integer values of m j are a theoretical option, but the Special-Ordered-Sets required for these approximations would massively slow down the solution process of each sequential step and massively extend the memory requirements. Approximating these functions with first or second-order Taylor series approximations in each sequential step of the SQCQP has been tested but led to high approximation deviations and bad convergence. Deeper research has led to a somewhat counterintuitive way, but that has proven to be advantageous: Eq. 17 is not to be split into its real and imaginary parts in Cartesian coordinates, but into its squared absolute values and into the tangents of its angles, whereas the transformer tap changes in T T,rel are still to be split into their real parts T T,rel,r and imaginary parts T T,rel,i (likewise for the vector  T,rel). This procedure does not yet require approximations at this stage and so Eq. 22 results for the squared absolute values and Eq. 23 results for the tangents (whereas t T (mT) is an abbreviation for the tangents):

T

2 T,rel,r

+

T

2 T,rel,i

∑

(1T

+

N

T

∑

vT,inc)2

=

1

2 T

(22)

 T,rel,i = tan (MT ∑  T,inc) = t T (mT)

(23)

 T,rel,r

Eq 22 is of fourth degree but can be reformulated into two equations of second degree polynomial. The result is shown in Eq. 24 and 25.



2 T,rel,r

+

2 T,rel,i

=



2 T,rel

(24)

T T,rel ∑ (1T + N T ∑ vT,inc) = 1T

(25)

The geometry of the function in Eq 23 has been investigated more in detail and the tangent function can be well approximated for small angles - and only those are relevant at quadrature voltage control - by a linearization. It should be emphasized that thus approximations are used in each step of the SQCQP. To enable convergence, the point of linearization must be updated in each sequential step . The result is shown in Eq. 26. The overall system of equations is shown in Eq. 27 and 28.

3.1 SQCQP Approach
The first approach applies a sequentially solved novel convexificated Quadratically Constrained Quadratic Program (SQCQP) based on [5≠8] that is further developed in this paper to consider in-phase and quadrature voltage controlled transformers. For the convexification, the equations of the SCOPF need to be reformulated as real-valued system of equations with equal number of equations and variables and a maximal polynomial degree

 T,rel,i -  T,rel,r

t

T

(mT)

|

+

t (mT)  m TT

|

∑

mT

 0T (26)

 0T 




T,rel,r

 1T   T,rel,i

 

0T

 

 



T,rel

 

 mT 



 nT 

 

0T

 

 mT 

 

 nT 

 

uT,a,r

 

 

0T

 

 

uT,a,i

 

   

0T 0T

   

=

f

   

iT,a,r iT,a,i

   

(27)

 0T   iT,r 

   

 0T   iT,i 

 

0T

 

 

iT

 

p

 N

 

uN,r

 

q

N

 

 

uN,i

 

 0N   uN 

0

Ploss





2 T,rel,r

+



2 T,rel,i

-



2 T,rel





T T,rel ∑ (1T + N T ∑ vT,inc)



 

T,rel,i

-



T,rel,r

∑



t

T

(mT)

|

+

t (mT)  m TT

|

∑

mT

  



mT









nT



 

T

T,rel,r

∑

I

T NT

∑

uN,r

-

T

T,rel,i

∑

I

T NT

∑

uN,i

-

uT,a,r

 

 

T

T,rel,i

∑

I

T NT

∑

uN,r

+

T

T,rel,r

∑

I

T NT

∑

uN,i

-

uT,a,i

 

 =
 

GTT ∑ uT,a,r - BTT ∑ uT,a,i - iT,a,r GTT ∑ uT,a,i + BTT ∑ uT,a,r - iT,a,i

   



T T,rel,r ∑ iT,a,r + T T,rel,i ∑ iT,a,i - iT,r









T T,rel,r ∑ iT,a,i - T T,rel,i ∑ iT,a,r - iT,i



 

i2T,r + i2T,i - i2T

 

 

3 ∑ U N,r ∑ I NT ∑ iT,r +U N,i ∑ I NT ∑ iT,i - pN0

 

 

3 ∑ U N,i ∑ I NT ∑ iT,r -U N,r ∑ I NT ∑ iT,i - qN0

 

 

u2N,r + u2N,i - u2N

 

3∑

u

T N,r

∑

I

NT

∑

iT,r

+

uTN,i

∑

I

NT

∑

i

T,i

- Ploss

(28)

With this system of equations, that only has realvalued polynomial functions of degree two and whose number of equations equals the number of variables, the SQCQP approach from [8] can be applied. As reasoned and undertaken in [8], a distributed slack needs to be inserted additionally before inverting and convexifying. The resulting convexificated quadratically constrained quadratic program is shown in Eq. 29 to 31.

min closs ∑ Ploss mTT,nTT, pTN, qTN + cTN ∑ pN (29)

s.t.

vN,min  vN mTT,nTT, pTN, qTN  vN,max

(30)

iT

m

TT , n TT

,

pTN,

q

T N

 iT,max

(31)

To enhance the speed of the sequential approach, the necessary relative MIPgap to be is dynamically adjusted in each sequential step: In the first step, for which a heightened forecast error is to be expected due to the high state changings by the optimizer and the used approximations, it is set to a value of 10 %. In the following steps it is set to the tenth of the MIPgap of the respective preceding step. Furthermore an dynamically adjusted time-limit is set for the optimizer, that starts with 128 s in the first step and doubles with each step. The total time for the duration one step can be longer, due to the convexification and further scripts.

3.2 Particle Swarm Optimization Approach
In the field of electric power system, optimization metaheuristics are used for solving a variety of optimization problems concerning system planning and operation [13≠19]. For solving SCOPF problems the PSO (cf. [20, 21]) shows an appropriate convergence behavior and good performance characteristics by the adaptation of hyperparameters [13, 16, 17]. The PSO algorithm used for the investigations within this paper is described in detail at [9]. For a better understanding of the specific adaptations for solving the SCOPF presented in section 2 the main equations of the PSO and the general procedure are introduced. At the beginning of the iterative solution process the particle swarm consisting of i = 1, ..., n individuals and j = 1, ..., m control variables xi, j is initiated randomly within the corresponding flexibility limits of Eq. 2, 5, 6, 13 and 14. Analogously to the control variables, the velocity vector of the swarm particles vi is generated randomly for the initial iteration step t = 0. For each swarm particle a power flow calculation based on the Newton Raphson algorithm is performed and the fitness value is evaluated by Eq. 1 [13, 16]. By this, the implementation of different control variables to the SCOPF problem is simple and is done by the integration of the variable to the power flow calculation algorithm. An additional punishment summand g is added to Eq. 1 for the non compliance of technical constraints. See [9] for details regarding the determination of the punishment summand g [22, 23]. Based on the fitness values the global best swarm particle position pgb of all particles as well as the individual best position of each particle pb,i during all iterations steps are updated. For the next iteration step the movement of the swarm and by this the change of the control variables are determined:

vi,t+1 = wvi,t + c1r1 (pb,i - xi) + c2r2 pgb,i - xi (32) with r1,r2 = (nx1),vi,xi = (1xm) (33) xi,t+1 = xi,t + kvi,t+1 (34)

The acceleration coefficients c1 and c2 describe the social and the cognitive interactions within the swarm. The vectors r1 and r2 consist of random numbers in the interval of [0, 1] representing the stochastic nature of the PSO. The inertia w indicates how the velocity of the swarm vi,t+1 is affected by the current velocity vi,t . The initial inertia w decreases within the iteration process from wstart to wend to guarantee at the beginning of the solution process a global and at the end (t = tmax) a local search behavior of the swarm [13, 24]:

w = wstart - t

wstart - wend tmax

(35)

The constriction factor k ensures a convergence of the swarm in a reliable solution of the optimization problem [13, 24]:

2

k=

, with  = c1 + c2  4 (36)

2 -  - 2 - 4

The iterative solution process stops after the maximum iteration step tmax is reached. In the following the modifications of the classic PSO [20] approach regarding the solution of the SCOPF are introduced. Within the classic PSO only continuous variables are implemented to avoid a negative influence on the swarm behavior and to guarantee appropriate convergence. To consider integers for the in-phase and quadrature transformer tap sets the corresponding variables z are considered as rounded values only during the evaluation of the swarm fitness [19]:

xi,z =

2xi,z 2

(37)

To avoid unfeasible solutions the movements of the particles is limited in front of the next iteration step within a set-to-limit operator [14]:

xi, j(xi, j < xi, j,min) = xi, j,min xi, j(xi, j > xi, j,max) = xi, j,max

(38) (39)

The limitation of the swarm velocities is a common procedure to avoid alternating jumps between the control variable limits (xi, j,min, xi, j,max) and to guarantee a more detailed global solution search especially at the beginning of the PSO [25]. The speed coefficient z is specified individually for each control variable (see Tab. 1, active power redispatch zAR, reactive power redispatch zRR, quadrature voltage control transformer zTQ, in-phase voltage control transformer zTIP, voltage control power plants zVC):

vi, j (|vi, j| > vi, j,max) = sgn(vi, j)r3vi, j,max with (40) vi, j,max = z(xi, j,max - xi, j,min), r3 = rand([0, ..., 1]) (41)

The movement of the swarm particles to unfeasible solutions and an accumulation of the swarm at the control variable limits are restricted by [20]:

vi, j xi, j = xi, j,min  vi, j < 0 = -vi, j

(42)

vi, j (xi, j = xi, j,max  vi, j > 0) = -vi, j

(43)

At the beginning of the PSO the high inertia of the swarm enables a global solution search. As a result of the decreasing inertia over PSO iterations the search behavior becomes more local. For a better local solution search a mutation operator is introduced that manipulates a random control variable of each swarm particle [13]:

xi,r4 = r5vi,r4,max  i  [1, ..., n] with

(44)

r4 = rand([0, ..., m]), r5 = rand([-1, ..., 1]) (45)

The hyperparameters of the PSO (see Table 1) are selected manually based on references in the literature and experiences during the case study [9, 17, 18, 20, 26]. Multiple PSO runs  are performed in parallel due to the stochastic nature of the PSO and the possibility of local convergence [25].

4 Case-Study
The SQCQP and the PSO approach presented in sections 3.1 and 3.2 are both implemented in MathWorks

Table 1 Hyperparameters of the PSO

n

tmax

c1 c2

wstart

wend

zAR zRR

zTQ zTIP zVC



200 500 2 0.9 0.4 1/10 1/5 100

Table 2 Limits of the control variables and incremental voltage and in-phase change per transformer tap change

pN,min pN,max qN,min qN,max see [11]
see Fig. 7

vN,min vN,max
0.9 p.u. 1.1 p.u.

mmin mmax
-10 10

nmin nmax
-10 10

V inc 0.25 %

 inc 1∞

Matlab. The simulations are performed on computers with a 2.7 GHz QuadCore and 16 GB RAM. For the comparison of the SQCQP and the PSO approach an adaptation of the IEEE 118-bus transmission grid regarding German transmission grid characteristics (see Fig. 2, cf. [10]) is used. A MathWorks Matlab dataset of the grid model and the results of the case study for the SQCQP and the best PSO run are available at [11]. The limits of the control variables as well as the incremental voltage and phase change per transformer tap change n and m are given in Tab. 2. The costs for grid losses closs are set to 1 while the costs for active and reactive redispatch cN are set to 0. Bus number 63 is selected as slack and the voltage phase is set to 0∞. The initial grid losses with the voltage control from [10] are Ploss,0 = 189.90MW. The investigations within the case-study are divided into three scenarios. In scenario 1 operational degrees of freedom are only provided by power plants that are able to contribute to active and reactive power redispatch and to perform the voltage control at the generation buses, respectively. In scenario 2 additional flexibilities are provided by the incremental in-phase voltage control of the transformers. In scenario 3 additionally the incremental quadrature voltage control of the transformers is considered.
4.1 Scenario 1
In Fig. 4 the convergences of the SQCQP and the PSO for scenario 1 are presented. The convexificated quadratic approximations of the SQCQP approximate the non-linear system behavior well except for the second sequential step (see Fig. 4 left). The SQCQP finds a slightly better solution (Ploss = 0.06 MW) and the computation is faster (t = 516 s). Within the  PSO runs the average result is Ploss,av = 46.34 MW and the worst result is Ploss,w = 46.83 MW. In contrast to that, another advantage of the SQCQP in scenario 1 is the reproducibility of the results. The exclusive monetarization of grid losses in the objective function leads to significant active and reactive power redispatches and an increase of the control voltages at the generation buses (see [11]). For the resulting absolute values of the nodal voltages vN in Fig. 3 just small

deviations between the SQCQP and the PSO are identified. This observation also applies to the following case studies, so the evaluation of the voltages is not presented again.
4.2 Scenario 2
In scenario 2 again the SQCQP gives a slightly better result then the PSO (Ploss = 0.02 MW) in a lower computation time (t = 418 s). The scattering of the PSO results is reduced compared to scenario 1 with an average result of Ploss,av = 45.54 MW and the
, 380 kV , 220 kV
Transformer Slack bus, 380 kV, voltage control Active and reactive power dispatch , Generation bus, voltage control, active power redispatch
Figure 2 IEEE 118-bus system with control variables
Initial system state: - no redispatch - no voltage control

Grid losseGsriPldoslsoisnseGsMriPldWoslsoissnesMPloWss in MW Grid losseGsriPldoslsoisnseGsMriPldWoslsoissnesMPloWss in MW Grid losseGsriPldoslsoisnseGsMriPldWoslsoissnesMPloWss in MW Grid losseGsri lPdoslsoisnseGsMri lPdWoslsoissnesM lPoWss in MW Grid losseGsri lPdoslsoisnseGsMri lPdWoslsoissnesM lPoWss in MW Grid losseGsri lPdoslsoisnseGsMri lPdWoslsoissnesM lPoWss in MW

200

160 200

120

160

20800

120

16400

80

1200 SQC4Q0P

1

80

FSiQg2Cu04Q000rPe 41

160 2000 1 SQ1C2Q0P
160

20800

120

16400

80

1200 SQC4Q0P

1

80

SQ2C04Q000P 1

Fig12u60000re 51
SQ1C2Q0P 160
20800 120

16400 80

1200 SQC4Q0P

1

80

0 SQC4Q0P

1

Load Flow Results

200

Quadratic Approximation

t

1 23

189.90 69.69 46.46

18L9o.a9d0F1lo1w.19Re4s7u.8lt5s TimeQiunasdrati-c Appr1o2xima1ti1on

tt

14 52 63

14859..6910 4659..6619 4456..6406

TTiimmeeQiiunnassdr1a48Lt5i9o9-c..6a9A2d0pFp41lor5111ow..1261x19iRme44as5711tui..41o68ltn05s

tt TTiimmee

iinn

ss

1144885599149-....66991200

446155911152....1266611199

444455671163....4166480065

t

4 56

2 3 454.61 455.61 456.60

Iteration4s5te.6p2 t45.61 45.60

Time in s 9 11 14

160 200
120 160 20800 120 16400 80 PSO1240000 80

R2eItseruaQ3tluitaodsnrasLftti4oceoapAdrpFtplsor5owcxieRmenastu6iaoltnsrioPS1O2040000

t

1 23

189.90 63.69 46.51

2 3 18L94o.a9d0F0lo95w.76Re4s7u6.7lt8s ITtiemreaQituniaosdnrastti-cepAptpr1o1xima2ti4on

tt

14 52 63

14859..4930 4653..4619 4456..4511

TTiimmeeQiiunnassdr1a48Lt53i9o-c.1.4a9A4d0pFp40lor5914ow..1347x16iRme44as5723tui..42o47ltn18s

tt TTiimmee

iinn

ss

1144885539914-..1..44993400

446055391452....1344671196

444455672363....4244571118

t

4 56

2 3 454.43 455.41 456.41

Iteration4s5te.4p4 t45.41 45.41

Time in s 31 43 32

160 20000 PSO120 160
20800 120
16400 80
PSO1240000 80

2IteraQ3tuiaodnrasLtti4oceapAdpFtplor5owxiRmeastu6ioltns PSO2040000

Results for scenario 2 t

1 23

189.90 62.90 45.63
2ITtiemreaQ3ituniaosdnr1as8Ltti94o-ce.a9pAd0pFtp0lor885ow.48x4iRme4as65tu6i.0o7ltn5s

tt

14 52 63

14849..8920 4642..8910 4445..8603

12600000 PSO120
160

TTiimmeeQiiunnassdr1a48Lt44i9o1-c..8a29A2d0pFp410lor4,880ow..4488x404iRme424as4,65t0ui..0o776ltn954s

tt TTiimmee

iinn

ss

11448844499141-....882992200

4416044,288052....44889841004

4424444,565063....08767609354

t

4 56

2 3 444.82 445.81 446.80

Iteration4s4te.8p2 t44.80 44.79

Time in s 412 1,044 2,064

20800 120
16400 80
PSO1240000 80

2345 Iterationstep t

6

PSO4000

01 2 3 4 5 6

00

SQCQP

Iterationstep t

PSO

Figure 6 Results for scenario 3

Load Flow Results

t

500

45.66

LoTaidmFelionws Re5s7u3lts

t

500

45.66

LoTaidmFelionws Re5s7u3lts

t

500

45.66

Time in s 573

250

500

Iterationstep t

250Load Flow Resul5ts00 Iterationstep t

t

500

45.43

250LoTaidmFelionws Re5s5u9l5ts00 Iterationstep t

t

500

45.43

LoTaidmFelionws Re5s5u9lts

t

500

45.43

Time in s 559

250

500

Iterationstep t

Iterati2o5n0sLtoeapd Ftlow Resul5ts00

t

500

45.02
Iterati2o5n0sLtoTeaipdmFetlionws Re5s7u9l5ts00

t

500

45.02

LoTaidmFelionws Re5s7u9lts

t

500

45.02

Time in s 579

250

500

Iterationstep t

250

500

Iterationstep t

250

500

Iterationstep t

SQCQP

worst result Ploss,w = 45.61 MW. The differences between the results of scenario 1 and 2 are small due to an already high utilization of the voltage limits based on reactive power optimization and voltage control in scenario 1 (see Fig. 3) as well as the dominating influence of the in-phase voltage control on the same voltage magnitudes.

PSO

Bus voltages vN in p.u.

0.9

1

1.1

Figure 3 Initial and resulting nodal voltages in scenario 1

4.3 Scenario 3
In scenario 3 the additional consideration of the quadrature voltage control significantly lowers the objective value. The impact is higher than that of the in-phase voltage control in scenario 2. This can be reasoned with the dominating influence of the quadrature voltage control on the distribution of the active power flows in the grid and consequently on the losses. The SQCQP reduces the grid losses more then the PSO (Ploss = 0.23 MW), but needs significantly more time, despite the time limits defined in section 3.1. Compared to scenario 2 the scattering of the PSO results increases slightly with an average result of Ploss,av = 45.14 MW and the worst result Ploss,w = 45.30 MW. In general, both approaches utilize the flexibility potentials of the control variables in the same way (see Fig. 7). Significant differences only arise for the

1000

ActivAectpiAAovcctetiwAiecvpvtreoiervpwpeeeodoripwswroeperrawdtriercserehpdrdiiaestsdcppiahsattpccahthch pN inpNMippnNNWiipMnNn iWnMMWMWW

1080000 1086000000 10864000000
8642000000 64200000 -422000000 --22400000 ---246000000 ---2468000000 -1--0468000000 -1--068000000
-1-080000

SQCQP

SPQSOCQP

SFPQlSeOCxiQbiPlity limits

SFFPQllSeeOCxxiiQbbiiPlliittyy

limits limits

PSO

4 4

11 11

15 15

24 24

28 28

35 35

48 48

67 67

73 73

75 75

87 91 96 98 103
B87us91n9u6m98b1e0r3

104F1l0e5x1i0b6il1i0t7y1l1i0m11i1ts112
104105 106107110111 112

116 116

4 11 15 24 28 35 48 67 73 75B87us91n9u6m98b1e0r3104105 106107110111112116

-1050000

Bus number
4 11 15 24 28 35 48 67 73 75 87 91 96 98 103104105 106107110111 112116

540000

Bus number

ReactRievaeRRcteepiaaRovccetetiwaiecvpvtreoiervpwepeeoodripwswroeperrawdtriercserehpdrdiiaestsdcppiahsattpccahthch qN inqNMiqqvnNNairqiMnNnvianMrMvvaMarrvar

543000000

5432000000

4321000000

32100000

-121000000

--1200000

---123000000

---1234000000

---2345000000 --3450000

24 28 73 75 87 90 96 98 116
24 28 73 7B5us nu8m7 ber 90 96 98 116

--450000

24 28 73 7B5us nu8m7 ber 90 96 98 116

NodaNlodNNaolodNdaoalldal voltavgoeltvvaoolglvtteaoalgtgeaege In-pIhna-sIIpennh--Iappsnh-ehapassheeavsNeinvpN.iuvvn.NNipiv.nNnui.pp.n.uu.p..u. tap steatpttnsaaepptassnpeettsnent n

-510.01 1.10.81

Bus number
24 28 73 75 87 90 96 98 116
Bus number

11..100.861 11..100.86100 11..006860

4 11 15 35 48 53 63 67 91 103 104 105 106 107 110 111 112
4 11 15 35 48 53 63Bu6s7nu9m1 b10e3r 104 105 106 107 110 111 112 4 11 15 35 48 53 63Bu6s7nu9m1 b10e3r 104 105 106 107 110 111 112

1.06462460

Bus number
4 11 15 35 48 53 63 67 91 103 104 105 106 107 110 111 112
Bus number

0642

042 0 0

1 1

2 2

3 3

4 4

5 5

6 6

7 8 9 10 11 12 13 14 15 16 17 18 19 20
T7 ra8nsf9orm10er11nu1m2 b1e3r 14 15 16 17 18 19 20

02 0 1 2 3 4 5 6 T7 ra8nsf9orm10er11nu1m2 b1e3r 14 15 16 17 18 19 20

10 1008 0
1608

1

2

3

4

5

6

Transformer number
7 8 9 10 11 12 13 14 15 16 17 18 19 20
Transformer number

QuadQruataQuQdrurueaQatdudruararaapdtetrsutuarertateeuptrtmsaeaepptasspemettsemtm m

16408

6428

0642

-0242

--024

---6024

---6248

--648 0 0

1 1

2 2

3 3

4 4

5 5

6 6

7 8 9 10 11 12 13 14 15 16 17 18 19 20
T7 ra8nsf9orm10er11nu1m2 b1e3r 14 15 16 17 18 19 20

--68 0 1 2 3 4 5 6 T7 ra8nsf9orm10er11nu1m2 b1e3r 14 15 16 17 18 19 20

Figure 7-8 Utilization of coTnratnrosflorvmaerrinaubmlebesrin scenario 3 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20

Transformer number

in-phase voltage control and especially for the quadrature voltage control of the transformers.
5 Conclusion and Outlook
The flexibilities in classical Security Constrained Optimal Power Flows (SCOPF) are often only represented by active and reactive power redispatch and voltage control measures of thermal power plants or aggregated renewable energy resources. Within this paper, incremental inphase and quadrature voltage controlled transformers are considered as additional, mixed-integer control variables. For the solution of this more complex SCOPF problem two different powerful optimal power flow solvers, namely a Sequential Quadratic Constrained Quadraic Programming (SQCQP) approach and a modified particle swarm optimization (PSO), are introduced and compared

with each other regarding the quality of the results and the computation time within a case-study of an adapted IEEE 118-bus system. Within the three investigation scenarios an increasing number of control variables are considered. At scenario 1 only active and reactive power redispatch and voltage control measures are implemented. In scenario 2 and 3 additional the incremental in-phase and quadrature voltage control of the transformers are taken into account. The results of the case study can be concluded as follows: In comparison of the influence on the objective value, it can be seen, that the in-phase voltage control as well as the quadrature voltage control only have a smaller impact on the objective value compared to the reactive and specially the active power redispatch. The advantages of the voltage controllers are likely to become visible, when current and voltage congestions play an important role in the dataset. The results of the scenario 1 already show differences and specific advantages of the SQCQP and the PSO in finding an optimal solution of the SCOPF: Both algorithms nearly reach the same objective value, but the PSO takes a longer computational time. So the advantages of analytical approaches for continuous functions can be seen. The results of scenario 2, that additionally considers incremental in-phase voltage control of transformers, again reveal nearly equality of the gained objective value and an advantage of the SQCQP with respect to the summed computation time of all sequential steps. The results of the scenario 3, that additionally considers in-phase and quadrature voltage control of transformers, again reveal nearly equality of the gained objective value that can be also identified by the comparison of the control variables in Fig. 7. The convergence of both approaches to nearly the same control variable utilization lead to the assumption that the solution of the optimization problem has no pareto optimum. In contrast to scenario 1 and 2 a significant advantage of the PSO with respect to computation time arise in scenario 3. Comparing all scenarios the computation times of the PSO are constant because it scales only with the number of power flow calculations and the performance of the computer in case of background processes. In contrast to that, the integration of the incremental flexibilities to the SQCQP leads to a more complex problem and by this to an increased computation time (t = 3075 s). It was observed that the SQCQP has stuck in lowering the MIPgap without finding new solutions, but trying to increase the lower bound, when considering quadrature voltage control. Equivalent or slightly different solutions of the SCOPF are suspected in this context and this aspect as well as performance and accuracy improvements of the SQCQP will be part of future research. Similar future goals hold for the hyperparameter tuning of the PSO (e.g. swarm size, see Tab. 1) or the introduction of a sequential solution process. The optimization approaches and investigations are aimed to be extended by network configurations, flexibility potentials of underlying voltage levels or costs for redispatch by linking the simulation to a market simulation.

6 References
[1] J. Carpentier, "Contribution a l'etude du dispatching economique," Bulletin de la Societe Francaise des Electriciens, vol. 3, no. 1, 1962.
[2] H. W. Dommel and W. F. Tinney, "Optimal power flow solutions," IEEE Transactions on Power Apparatus and Systems, vol. PAS-87, no. 10, pp. 1866≠1876, 1968.
[3] D. Bienstock and A. Verma, "Strong np-hardness of ac power flows feasibility," 2019.
[4] S. Frank, I. Steponavice, and S. Rebennack, "Optimal power flow: a bibliographic survey," Energy systems, 2012.
[5] T. Leveringhaus and L. Hofmann, "Combined and optimized redispatch management of multiple congestions and voltage deviations with active and reactive power based on ac-ptdfs with distributed slack," in 2015 IEEE Power Energy Society General Meeting, 2015, pp. 1≠5.
[6] ----, "Optimal power flow comprising congestions and voltage management by global quadratic optimization of active and reactive power," in 2016 IEEE International Conference on Power System Technology (POWERCON), Sep. 2016, pp. 1≠6.
[7] T. Leveringhaus, T. Breithaupt, S. Garske, and L. Hofmann, "Modelling of sequential optimal power flow by piecewise linear convexificated quadratic approximations," in 2018 International Conference on Power System Technology (POWERCON), 2018, pp. 87≠92.
[8] T. Leveringhaus and L. Hofmann, "Detailed reasoning and derivation of a convexificated quadratic approximation approach for the security constrained optimal power flow," in 2020 International Conference on Smart Grids and Energy Systems (SGES), 2020.
[9] M. Sarstedt, L. Kluﬂ, J. Gerster, T. Meldau, and L. Hofmann, "Survey and comparison of optimization-based aggregation methods for the determination of the flexibility potentials at vertical system interconnections," Energies, 2021.
[10] H. Barrios, A. Roehder, H. Natemeyer, and A. Schnettler, "A benchmark case for network expansion methods," in IEEE PowerTech, 2015.
[11] M. Sarstedt, N. Majumdar, C. Blaufuﬂ, and L. Hofmann, "Dataset: Multi-voltage-level electric power system data sets," 2020.
[12] J. Holzer, C. Coffrin, C. DeMarco, R. Duthu, S. Elbert, S. Greene, O. Kuchar, B. Lesieutre, H. Li, W. K. Mak, H. Mittelmann, R. O'Neill, T. Overbye, A. Tbaileh, P. V. Hentenryck, A. Veeramany, and J. Wert, "Grid Optimization Competition Challenge 2 Problem Formulation," p. 79.
[13] J. Zhu, Optimal Power Flow. John Wiley & Sons, Ltd, 2015, ch. 8, pp. 297≠364.

[14] B. Zhao, C. Guo, and Y. Cao, "A multiagent-based particle swarm optimization approach for optimal reactive power dispatch," IEEE transactions on power systems, vol. 20, no. 2, pp. 1070≠1078, 2005.
[15] A. Kaviani, H. Baghaee, and G. Riahy, "Optimal Sizing of a Stand-alone Wind/Photovoltaic Generation Unit using Particle Swarm Optimization," Simulation, vol. 85, pp. 89≠99, Feb. 2009.
[16] T. Sharma, A. Yadav, S. Jamhoria, and R. Chaturvedi, "Comparative study of methods for optimal reactive power dispatch," Electrical and Electronics Engineering, vol. 3, no. 3, pp. 53≠61, 2014.
[17] M. Sarstedt, S. Garske, and L. Hofmann, "Application of PSO-Methods for the Solution of the economic Optimal Reactive Power Dispatch Problem," in 2018 IEEE Electronic Power Grid (eGrid), Nov. 2018, pp. 1≠6.
[18] M. A. Abido, "Optimal power flow using particle swarm optimization," International Journal of Electrical Power & Energy Systems, vol. 24, no. 7, pp. 563≠571, 2002.
[19] B. Zhao, Q. Jiang, C. Guo, and Y. Cao, A Novel Particle Swarm Optimization Approach for Optimal Reactive Power Dispatch.
[20] J. Kennedy and R. Eberhart, "Particle swarm optimization," in Proceedings of ICNN'95 International Conference on Neural Networks, vol. 4, Nov. 1995, pp. 1942≠1948 vol.4.
[21] R. Eberhart and J. Kennedy, "A new optimizer using particle swarm theory," in MHS'95. Proceedings of the Sixth International Symposium on Micro Machine and Human Science, Oct. 1995, pp. 39≠43.
[22] G. Coath and S. K. Halgamuge, "A comparison of constraint-handling methods for the application of particle swarm optimization to constrained nonlinear optimization problems," in The 2003 Congress on Evolutionary Computation, 2003. CEC'03., vol. 4. IEEE, 2003, pp. 2419≠2425.
[23] A. W. Mohemmed and M. Y. Alias, "Particle Swarm Optimization for Constrained and Multiobjective Problems: A Brief Review," p. 5.
[24] K. E. Parsopoulos and M. N. Vrahatis, "Particle Swarm Optimization Method for Constrained Optimization Problems," p. 7.
[25] J. F. Schutte, J. A. Reinbolt, B. J. Fregly, R. T. Haftka, and A. D. George, "Parallel global optimization with the particle swarm algorithm," International Journal for Numerical Methods in Engineering, vol. 61, no. 13, pp. 2296≠2315, Dec. 2004.
[26] J. Polprasert, W. Ongsakul, and V. N. Dieu, "Optimal Reactive Power Dispatch Using Improved Pseudogradient Search Particle Swarm Optimization," Electric Power Components and Systems, vol. 44, no. 5, pp. 518≠532, Mar. 2016.

