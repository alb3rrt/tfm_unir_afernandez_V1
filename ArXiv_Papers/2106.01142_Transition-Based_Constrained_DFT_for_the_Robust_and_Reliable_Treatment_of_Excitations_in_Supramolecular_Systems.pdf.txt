Transition-Based Constrained DFT for the Robust and Reliable Treatment of Excitations in Supramolecular Systems
Martina Stella,1 Kritam Thapa,1 Luigi Genovese,2 and Laura E. Ratcliff1,  1Department of Materials, Imperial College London, London SW7 2AZ, United Kingdom
2Univ. Grenoble Alpes, CEA, IRIG-MEM-L_Sim, 38000 Grenoble, France (Dated: June 3, 2021)
Despite the variety of available computational approaches, state-of-the-art methods for calculating excitation energies such as time-dependent density functional theory (TDDFT), are typically computationally demanding and thus limited to moderate system sizes. Here, we introduce a new variation of constrained DFT (CDFT), implemented in the wavelet-based BigDFT code, wherein the constraint corresponds to a particular transition (T) between occupied and virtual orbitals, rather than a region of the simulation space as in traditional CDFT. In this work, we perform benchmark T-CDFT calculations for a set of gas phase acene molecules and OLED emitters and compare them to SCF and TDDFT results, for different functionals and basis sets. For both classes of molecules, we find that T-CDFT based on semi-local functionals is comparable to hybrid functional results from SCF and TDDFT. Furthermore, T-CDFT proves to be more robust than SCF and does not suffer from the well-known problems encountered when applying TDDFT to charge-transfer (CT) states, and is therefore equally applicable to both local excitations and CT states. Finally, since T-CDFT is designed for large systems and has been implemented in linear-scaling BigDFT, it is ideally suited for exploring the effects of explicit environments on excitation energies, paving the way for future simulations of excited states in complex realistic morphologies, such as those which occur in OLED materials.

arXiv:2106.01142v1 [physics.chem-ph] 2 Jun 2021

I. INTRODUCTION

Studying excited states in molecules and extended systems is one of the major ongoing challenges in physics, chemistry and materials science due to the complexity of the underlying electronic structure. Nonetheless, an accurate characterization of excitation energies is crucial for a fundamental understanding of systems of technological interest, e.g. solar cells,1 organic light emitting diodes2,3 and chromophores in biological systems.4 One example of interest is thermally activated delayed fluorescence (TADF) emitters, which have gained a spotlight in recent years as a new type of organic light emitting diode (OLED).2,3 This is due to their promising maximum theoretical internal quantum efficiency (IQE) of 100%.5­7 TADF relies on a reverse intersystem crossing (RISC) mechanism (triplet-to-singlet energy up conversion, illustrated by a simplified Jablonski diagram in Fig. 1) to achieve such high efficiency without employing expensive noble metal ions. TADF is however only possible at appreciable rates if the singlet-triplet splitting, EST, (defined in Fig. 1) is smaller than or comparable to kbT, where kb is the Boltzmann constant and T the temperature. Therefore, accurate prediction of EST is a key but challenging element for designing more efficient TADF emitters. Excited states in TADF can be a mixture of charge transfer (CT) and local excitations (LE), while their nature can vary with both chemical structure and changes in molecular conformation.8
Experiments for investigating excitations can be challenging because of factors such as technical setups and short lifetimes. In addition, the classification and interpretation of the nature of different excitations (i.e. valence state, CT, LE) is often based on empirical data.

Figure 1. Simplified Jablonski diagram for TADF emitters. Reverse intersystem crossing, represented in the figure by the arrow going from T1 to S1 (with the intersystem crossing going from S1 to T1), is thermally activated when the energy difference between the two excited states is smaller or comparable to kbT. Ab initio simulations therefore represent a valuable tool. However, as the example of TADF also highlights, there are many challenges that lie within the computational modelling of excited states, including the need to go beyond gas phase simulations and instead consider realistic morphologies.9 In this context it is necessary to develop a methodology which is able to reliably capture the excited electronic structure, while accounting for both conformational and environmental effects of the full system, and still maintaining an affordable computational cost.
In this paper we present a new computational approach, named T-CDFT and described in detail in the following, motivated by the desire to simulate excitations in large systems for applications such as TADF. Nonetheless, during the past few years, a number of methods have been developed for the improved treatment of excited

2

states. At the same time, tremendous effort has been invested in the community to provide accuracy (see e.g. Ref. 10) as well as precision11 benchmarks for molecular quantities beyond the ground state. In order to motivate our approach, and to situate the formalism of our approach in the state-of-the-art panorama, we therefore start by offering an overview of currently available ab initio approaches for excited state calculations.

A. Density Functional Theory-Based Methods for Simulating Excited States

Density functional theory (DFT)12,13 has established

itself as one of the most promising approaches for study-

ing excitations in molecules and large systems, mainly

due to its notoriously favourable trade-off between accu-

racy and computational cost. However, it is equally well

known that, in its standard form, DFT falls short when

describing excited states because of the ground-state na-

ture of its formulation. For this reason a range of different

DFT-based methodologies have been developed in order

to better account for excited electronic states.

SCF (self-consistent field)14 is the simplest DFT-

based approach for computing excitation energies. For a

given excited state of interest the energy splitting is de-

fienneerdgyasandESnECnF

= is

En - E0, where E0 the energy of and

is the ground state "excited" state, la-

belled by n, which is obtained by manually controlling the

occupation of the Kohn-Sham (KS) states as the system

reaches self-consistency. The SCF approach has been

used with wide success because of its simplicity and low

computational cost and has for a long time been justified

in cases where the excited state corresponds to the lowest

state of a given symmetry.15 However, its applicability

has been also extended to the KS formalism including

excited states, such that it gets a formal justification in

the general case.16 Although a special unknown orbital-

dependent exchange-correlation potential should be used

for the excited state, in practical implementations stan-

dard exchange-correlation potentials from ground state

DFT are typically used.

The formalism of SCF method can be also ex-

tended to Hartree-Fock (HF) as well as open-shell sys-

tems, i.e. Restricted Open-shell Kohn-Sham (ROKS)

(and ROHF) and the Unrestricted Kohn-Sham (UKS)

(and UHF).17­19 In ROKS, all orbitals except the singly

occupied ones are represented in a closed-shell formalism,

i.e. the two electrons in the orbital are represented by the

same spatial function. In UKS, on the other hand, all

orbitals in the system are expressed in an open shell for-

malism, i.e. the spatial components of the up and down

spin orbitals are allowed to be different. This greater

flexibility automatically leads to an energy equal to or

lower than the RKS energy.20 However, although UKS

yields a more realistic description of the spin distribution

in open-shell species, the unrestricted wavefunctions are

not eigenfunctions of the total spin operator, i.e. they are

contaminated by states of higher spin multiplicity. If the spin contamination from higher spin states is large, the potential energy surfaces predicted by unrestricted wavefunctions can be significantly distorted, showing for example anomalously high reaction barriers.21 In contrast to UKS, the ROKS wavefunctions are eigenfunctions of the total spin operator making the resulting description more accurate. However, the ROKS formalism present some subtleties. Unlike restricted KS theory for closed shell molecules, the form of the Fock matrix is not unique. Different so-called canonicalizations can be used leading to different orbitals and different orbital energies, but the same total wavefunction, total energy, and other observables.22 As a result, despite the notorious limitations, UKS remains the most popular SCF approach.
Linear-response (LR) time-dependent DFT (TDDFT)23,24 is today the most commonly used method for investigating excitation energies of molecular systems, as it often provides good agreement with experiment. Despite being well established and more affordable than sophisticated post-Hartree-Fock methods such as CCSD(T) and CASSCF,25 LR-TDDFT still shows a number of limitations that prevent it from being feasibly employed in modelling realistic morphologies, such as those in which TADF emitters are employed. First, its computational cost is still too onerous when it comes to modelling systems larger than a few hundred atoms,26 although various approaches designed for treating large systems have been developed such as the linear scaling (LS) TDDFT approach which is implemented in the ONETEP code.27 Second, it notoriously fails when describing CT states with routinely used functionals.28,29 The latter issue in particular has been extensively studied and a number of solutions are nowadays available, of which the most successful is the use of range-separated functionals.30 However, such functionals are still not widely available and can make calculations more expensive, while good performance often necessitates the tuning of the functional parameters for the system in question.29
Another DFT-based method for studying excited states is constrained DFT (CDFT).31,32 In CDFT a constraint is added to the density, following which the energy is found by minimising the density with this additional condition. In its most common form a specific electronic charge is constrained to a region of simulation space. If opportunely guessed, such a constraint can correspond to a specific excited state where the electronic density is well localized within the region, and takes also into account, by design, the self-consistent response of the system to the imposition of such a constraint. For this reason, CDFT has performed very successfully in the simulation of molecular systems where an obvious spatial separation between donor and acceptor regions is present.32­39 Such a simple approach naturally overcomes some of the well-known limitations of DFT, e.g. the self-interaction problem and the resulting delocalization errors, making CDFT particularly appropriate for treating CT states

3

and an asset for modelling exciton formation. CDFT is conceptually intuitive and it follows the same scaling as DFT (generally scaling with the cube of system size). However, it is most appropriate where some information is known about the excitation in question (where and how much charge to impose). For a comprehensive review of CDFT, we refer the reader to Ref.40
The simplicity of its framework has also made CDFT attractive for the development of new variations. Recently, Ramos and Pavanello41,42 proposed two versions of CDFT. In a first implementation41 they combine CDFT with a frozen density embedding approach. They call this method constrained subsystem DFT (CSDFT). It is mainly applied to describe hole transfer reactions and can be employed in a molecular environment via a subsystem DFT scheme. In a later paper,42 they present a CDFT method tailored to compute low-lying electronic excitations (XCDFT) of molecular systems, where the main idea is that the virtual space of a reference ground state can be represented by employing only the occupied orbitals of the reference state. Similar to certain formulations of density functional perturbation theory which do not require the use of unoccupied (virtual) states, XCDFT resolves the space of virtual states by projection. The results show that XCDFT achieves an accuracy only slightly worse than LR-TDDFT. A more recent paper by Roychoudhury et al.43 proposes a generalization of CDFT for neutral excitations in molecules (XDFT). XDFT simulates an excitation by reducing the electronic population of the ground state valence subspace by one electron, while keeping the total number of electrons unchanged. A key feature of this approach is in that no prior assumptions are made as to the spatial form of source or drain regions for the charge constraint. The obtained results are again comparable to TDDFT.
Beyond the above methods, there are also other DFTbased approaches to excited state calculations, which are either generally applicable, such as orthogonality constrained DFT,44 or designed for CT states, such as constricted variational density functional theory.45 In short, there are many different approaches that one can use to compute low lying excitations in molecular systems, with each displaying some limitations either in the ability to describe particular classes of excited states (LE vs. CT), or in the maximum accessible system size.
Furthermore, when treating large systems, it is not only the ability to treat a large number of atoms which is necessary, rather the complexity of such systems often also necessitates the ability to map to local degrees of freedom (DoF).46,47 To this end, it would also be highly advantageous to have an excited state method which can be related to a local description of a large system, e.g. to excite a single molecule within a cluster of molecules. Given all these factors, there is no clear consensus on the best approach to use, particularly for applications such as TADF where the nature of the excitation can be a combination of LE and CT, and the effect of an extended environment can be crucial for accurately describing the

excitation. Nonetheless, the recent variants of CDFT demonstrate its potential for providing accurate results with a lower computational cost than TDDFT.
In this paper we present an alternative variation of CDFT. In this approach, which is implemented in the wavelet-based BigDFT code,48 the constraint is defined as a particular transition between given occupied and virtual states, rather than a region of the simulation space. The approach is therefore termed Transition-based CDFT (T-CDFT). The transition constraint takes inspiration from an optical excitation term, as parametrized for instance by linear response (LR) TDDFT. In this context, it can be considered as a further step beyond linear-response calculation, where SCF effects are added on top of the optical excitation. By taking the particular case of a `pure' transition between the highest occupied molecular orbital (HOMO) and lowest occupied molecular orbital (LUMO), we are able to investigate both LE and CT states, without requiring any additional inputs. We benchmark our approach on low lying singlet and triplet excitations of a set of molecules in gas phase, including both acenes and TADF emitters, putting the results in comparison with both SCF and TDDFT calculations using three different functionals. While the present results focus on single molecules simulations, we also describe a path towards future large scale simulations, which will be facilitated by the ability of BigDFT to treat large systems containing thousands of atoms.49,50
The outline of this paper is as follows. In Section II we first present the underlying formalism of T-CDFT, before describing details of the implementation in BigDFT, for both a localized support function basis and for a basis of extended KS wavefunctions. We finish Section II by defining two indicators which will be used to analyze the investigated excitations and specifying the computational details. In Section III we present the results for our benchmark set of molecules, first discussing in detail the obtained excitation energies and comparisons between methods, before discussing basis set effects. Finally, in Section IV, we present our conclusions.
II. METHODS A. Excitations in the Linear-Response Formalism
When a system is submitted to an excitation, its density matrix (and therefore its observables) are modified by the effect of a perturbing operator ^ (). Stated otherwise, we can identify a response density operator ^ () which represents the deviation of density matrix from the ground-state one, indicated by ^0. Such a response density satisfies an equation of motion written in the form of a quantum Liouville (super) operator, L^^, (for example

see Ref. 51)

 - L^^ ^() = ^ (), ^0 .

(1)

Its action on a generic operator O^ reads

L^^O^  H^0, O^ + V^ [O^], ^0 ,

(2)

where H^0 is the ground-state Hamiltonian and V^ [O^] 

drdr

V^ [^0 (r,r

] )

O(r,

r

)

encodes

the

response

of

the

^-

dependent potential to a modification of the density oper-

ator. The "excitation modes" of the molecule are defined

through the excitation operators E^a, satisfying

L^^E^a = aE^a ,

(3)

with a being the excitation energies. The representation of the above equation in the basis set of the eigenvalues of the ground-state Hamiltonian gives rise to the TDDFT Casida's equations.
Under a linear-response condition, it is possible to show52 that the excitation operators satisfy the so-called transverse condition, which states that

E^a  ^0E^aQ^0 + Q^0E^a^0 = E^a ,

(4)



where Q^0 = ^I - ^0 is the projector to the empty subspace of the ground-state Hamiltonian H^0. According to this condition, excitation operators can be parametrized as

E^a =

|ap p| + |p ap| .

(5)

p

Each excitation mode of the system, with associated en-

ergy a defined

, is thus described in the unoccupied

by a set of subspace.

states These

{obapj,ectaps}r,eeparceh-

sent, respectively, the state in which |p is excited ­ or from whom it decays ­ when the system is subject to the

monochromatic perturbation ^ a  E^a, ^0 . The spec-

trum is symmetric with respect to the inversion of the

eigenvalues a  -a and, given a specific excitation

d{esapc,ribape}d,

the by

associated solution the transposed pair

with {ap ,

opposite ap }.

energy

is

B. Transition-Based Constrained DFT

Excited states, as calculated for example with LRTDDFT, may be characterized by the orbitals involved in a given transition. Each of the occupied orbitals labelled by p is then associated with a particular transition of this state in the unoccupied sector.
Following these guidelines, we define the (Hermitian) transition operator, T^a,:

T^a



1 2

E^a + E^at

=

p

1 2

|wpa

p| + |p

wpa|

,

(6)

4

which is associated with the linear combination of a ex-

citation and a de-excitation with the same energy. A

rperporveidseendtabtyioinntroofdtuhceinsgtaatnesex|pwliapcitba|sisap

+ {|s

}|iapn

can be the sub-

space of empty represented as

states

so

that

both

|ap

and

ap| can be

|ap = Xpas |s ,
s

ap| =

s| Ypas . (7)

s

HofetrheethexeccioteedffikceietnstasnXdpabsraans dinYtpahserechporesseennbtatshies.exFporressesmioin-

local DFT functionals, the coefficients Wpas = Xpas + Ypas can then be directly extracted from the Casida's cou-

pling matrix eigenproblem, thereby providing an explicit

repWreesednetfianteioonuorfe|xwcapita=tion

senWerpags i|ess

. via

the

following:

ET(a-)CDFT  E[]

- E[0] ,

(8)

tr(^T^a)=1

where, in other terms, we minimize the energy by impos-

ing self-consistency under the transition constraint im-

posed by the operator T^a. More specifically, the density matrix operator is con-

strained such as definition. The

to include energy of

the the

styrasntesmitioisnsthepnmwinpaiminizietds

along the set of solutions implementing such a constraint.

A particular excitation (labelled by a) is then character-

ized by the set of occupied states which are excited into

the corresponding unoccupied orbitals involve only one occupied orbital, e.g.

t|hwepaH.OMThOis,

may or it

may involve a mixture of several orbitals. We refer to the

former as a `pure' transition, while the latter is consid-

ered a `mixed' transition. For a given orbital p the level

of purity of the transition a can be quantified by means

of a transition purity indicator, Ppa, defined as

Ppa  wpa|wpa ;

(9)

which would lead to a value of one if only the orbital p participates in the transition.
With this representation, the orbital sector of the configuration interaction space is, by construction, identical between up and down spins. Therefore, spincontamination is forbidden, and we work in the subspace of Sz = 0 excitations. Singlet (+) and triplet (-) transitions can be easily identified, taking the solutions with WpIasn t=he±KWSpasD,FrTespfoecrmtivaelilsym. , the ground-state density matrix ^0 is found by self-consistent field optimization of the following Lagrangian:

EBS = tr H^KS[^]^ ,

(10)

where the KS Hamiltonian HKS is functionally dependent on the density matrix. To impose the constraint we may add to the above Lagrangian the following term

Ca = Vaps s| ^ |p - Wpas .
p,s

(11)

5

The set of Lagrange the condition

multipliers

Vcs,s

is there to enforce

tr ^T^a =

Wpas s| ^ |p =

wpa| ^|p = 1

p,s

p

(12)

which would add to the KS Hamiltonian a density-

independent term:

H^ca = Vaps (|p s| + |s p|) ,

(13)

p,s

where the sum should only be performed on the set of

states values

fpo,rsthsuecLhagthraantgWe mpasul=tip0li.ersOanrecefotuhned,apthperoepnreiragtye

of the excited system can be calculated with the usual KS

expression, after removing the constraining term from the

KS Hamiltonian.

Such a formalism is particularly practical for the case

of a pure transition, where only one state p is involved

in is

the constraint. For this unique, one can choose

caansea, rabsittrhaeritlayrglaertgoerbLiataglra|wngape

multiplier, as the representability condition of the density

matrix triplet

will always transitions

guarantee can then be

wapsas|o^c|iatpedw1it. hScinognlsettraainndt

operators which are spin-averaged (+) and spin-opposite

(-), respectively: (H^ca = ±H^ca).

C. Indicators for Analyzing Excitations When analyzing excited states, it is useful to define quantitative indicators which allow the comparison of various features of a given excitation. This includes both the orbitals involved in a given transition, and its spatial character. To this end, we use two simple indicators, which are described in the following.

previously discussed, this is particularly the case for TDDFT, where energies of low-lying CT states calculated with some functionals may be severely underestimated, in some cases by several eV, while other functionals show good agreement with experiment.53 This problem has motivated the development of diagnostic tools which can be used to predict the accuracy of TDDFT in a given case by classifying the nature of the excitation. It is not straightforward to develop a unique and effective descriptor, so that several examples of such developments can be found in the literature.54­58 These generally include geometrical descriptors based on the analysis of the molecular orbitals and the electron densities.
One such descriptor is the -index,58,59 which is based on the overlap of molecular orbital moduli, and is defined as

a = Wpas2 |s(r)| |p(r)| dr.

(14)

ps

It has been suggested that a small orbital overlap, as defined by a  value of less than 0.3 for hybrid and 0.4 for GGA functionals, corresponds to a CT transition which is not correctly described by TDDFT.59
While it is possible to define indicators such as the  which depend on the output of the excited state calculation, in this work we instead employ a descriptor which is based on the particular transition that is used as the constraint in T-CDFT, i.e. based on the input, rather than the output. Since in this work we focus on pure HOMOLUMO transitions, this results in a simplified version of the -index. This descriptor, which we denote T, is based on the square root of the product of the overlap of solely the HOMO and LUMO wavefunctions and thus describes their spatial overlap:

T = |H (r)| |L(r)| dr.

(15)

1. Transition Purity Both the transition purity indicator, P (Eq. 9), and the T-CDFT formalism defined above may be applied to any given transition. However, we focus in this work on the case of a pure HOMO-LUMO transition, leading to a simplified descriptor. Thus a P = 1 refers to a pure HOMO-LUMO excitation, while a number significantly below 1 indicates that higher excitations have a non-negligible contribution to the overall description of the excitation, in other words the transition is not pure (mixed).
2. Spatial Overlap The accuracy of computed excitation energies strongly depends on whether the chosen method is able to correctly capture the character of the excitation itself. As

At the two extremes, a value of zero therefore indicates no spatial overlap between HOMO-LUMO and, hence a CT excitation, while a value of one represents full spatial overlap between the orbitals, corresponding to a LE state. We note that T does not distinguish between singlet or triplet excitations, and instead only provides a description of the spatial overlap between the HOMO and LUMO. For work requiring an in-depth analysis of a particular excitation, a modified version based on the output of T-CDFT, or other indicators such as those referenced above would therefore be more appropriate.
D. Implementation in BigDFT The T-CDFT approach defined above is not specific to any particular basis set or formalism. However, the approach is ultimately targeted at the treatment of excitations in large systems. We have therefore implemented the approach in the BigDFT code,60 which uses

a Daubechies wavelet basis.61 By taking advantage of the orthogonality, compact support and smoothness of such a basis, and in conjunction with accurate analytic pseudopotentials (PSPs), BigDFT is able to yield a high, systematically controllable precision. It was initially developed with a standard cubic scaling approach with respect to the number of atoms,62 and was later complemented with a linear scaling (LS) algorithm which is able to treat systems containing thousands of atoms.49,50 In the following we first summarize the support function (SF) based approach employed in LS-BigDFT, then describe the implementation of T-CDFT using both the SF basis and the extended KS wavefunctions coming from a cubic scaling calculation, where the latter is used as a means of independently assessing the suitability of the SF basis for excited states.

1. Linear Scaling BigDFT

In LS-BigDFT the extended KS orbitals are expressed in terms of a set of localized SFs, , via the coefficients ci ,

|i = ci | .

(16)



The density matrix, ^, is then defined in terms of the SFs and the density kernel, K,63

^ = | K | .

(17)



By taking advantage of the well known nearsighted-

ness principle, which states that the density matrix ex-

hibits exponential decay with distance for systems with

a gap,63,64 it is possible to impose strict localization on

both the SFs and density kernel. In BigDFT, the SFs

are represented in the underlying wavelet basis set and

optimized in situ during the self-consistency cycle. This

results in a set of localized SFs which have adapted to

their local chemical environment, giving a minimal ba-

sis which, by construction, can represent the occupied

KS orbitals. Since the SFs are truncated within a user-

defined localization radius, Rloc, systematic convergence is possible by increasing the localization radius. The den-

sity kernel is then also optimized, either by means of the

Fermi Operator Expansion (FOE)65,66 approach, which

works directly with the density kernel, or with the di-

rect minimization approach, which is used to obtain the

cstoreuffictceiedn. tW s chie,nfrFoOmEwishiuchsedthien

kernel can then be conconjunction with sparse

matrix algebra, as implemented in the CheSS library,46

the resulting computational cost scales linearly with re-

spect to the number of atoms, N , enabling the treatment

of systems containing thousands of atoms.

The localized SFs of LS-BigDFT also offer additional

advantages, in that they can be used as a means for fur-

ther reducing the computational cost and complexity of

6 calculations of large systems. This is achieved by means of a fragment-based analysis, in which the system studied is divided into subsystems, and can be applied in two different contexts. First, for reducing the computational cost by exploiting similarity between fragments in both molecular67 and periodic systems.68 Second, for identifying independent fragments and analysing interactions between them,47,69 which could then also be exploited to inform the setup of Quantum Mechanics/Molecular Modelling (QM/MM) calculations. For a more comprehensive overview of BigDFT the reader is referred to Ref. 60.
2. T-CDFT with a Support Function Basis The use of a transition-based constraint relies on the ability to accurately represent both the occupied orbitals, and the specific virtual orbital(s) involved in the constraint, which in this work is the LUMO. The SFs used in LS-BigDFT are optimized to accurately describe the occupied states, however, as in the ONETEP code,70 which uses a similar approach to optimize the basis of non-orthogonal generalized Wannier functions (NGWFs), the unoccupied states may be poorly represented by the optimized basis, and can be considerably overestimated in energy, particularly when one goes beyond bound states.71,72 In ONETEP this problem is overcome by using a projection operator to optimize a second set of NGWFs to represent the virtual states, which are then combined with the ground state NGWFs.72 In LS-BigDFT we instead retain a single set of SFs, exploiting the direct minimization approach to optimize select virtual states alongside the occupied states.49 When only a few virtual states are required, this may be done in a single ground state calculation. However, when a larger number of virtual states are required, it is more stable to first perform a ground state calculation without virtual states (using either FOE or direct minimization), followed by a second non-self-consistent calculation, in which the SFs and kernel are optimized to include virtual states (using direct minimization). This second step uses the optimized SFs and density kernel from the first calculation as an input guess, while the ground state density is kept frozen. Since the virtual states are more delocalized than the occupied states, particularly in the case unbound of states, it can be challenging to represent a significant number of virtual states in a localized basis. In LS-BigDFT, as in ONETEP, it is therefore typically necessary to use larger localization radii, while depending on the nature of the virtual states, it may also be necessary to include additional basis functions. CDFT with a standard spatial constraint has previously been implemented in LS-BigDFT,67 and successfully employed for the treatment of a large host-guest OLED structure.73 Building upon this existing implementation, T-CDFT has also been implemented within LS-BigDFT, following the approach described in Section II B. Given a SF basis constructed to also include

virtual states, the T-CDFT calculation is then performed without any further SF optimization, i.e. the SFs are kept fixed. SF-based CDFT can be naturally paired with the fragment-based approaches described above, and could therefore potentially be used to study excitations in environments. However, the fragment based analysis is optimal in the case of a well-localized, minimal basis, and thus it is important to consider to what extent it can be translated to the treatment of excited states, which might require considerably larger localization radii. To this end, we have also implemented a second approach, which enables us to assess the effect of imposed localization in the SF basis in T-CDFT calculations.
3. T-CDFT with a Wavefunction Basis In order to independently assess the completeness of the SF basis, it is useful to have an independent method which is not limited by localization constraints. We have therefore also performed T-CDFT using the ground state wavefunctions coming from a cubic scaling calculation. This method, referred to as wavefunction (WFN)-based T-CDFT, requires two main steps. First, the basis set is generated via a ground state cubic scaling calculation, which includes a (large) number of virtual states. Second, the wavefunctions are used as a fixed basis set for T-CDFT. This second step is performed using LSBigDFT, by treating the wavefunctions as SFs with effectively infinite localization radii. A detailed description of the workflow is given in the SI. The lack of imposed localization has the advantage of allowing for a better representation of delocalized states. Furthermore, by increasing the number of virtual wavefunctions included in the basis set, it is possible to systematically approach the complete basis set limit. However, while this protocol is straightforwardly applicable to single gas phase molecules, it is not easily extended to larger systems, while even for gas phase molecules the computational cost and memory requirements are significant when a large number of virtual states are included. It is thus primarily intended as a robust method for comparing with the SF-based results, rather than as a practical workflow for large scale calculations.
E. Computational Details The lowest energy vertical singlet (S1) and triplet (T1) excitations were calculated using T-CDFT, SCF and TDDFT. T-CDFT calculations were performed using BigDFT while SCF and TDDFT calculations were performed using both BigDFT and NWChem,74 where the latter calculations employed two commonly employed Gaussian basis sets, namely cc-pVTZ75 and 631G*.76,77 Calculations employed three functionals of different types: LDA,78 PBE79 and PBE0,80 except for BigDFT TDDFT calculations where only LDA is avail-

7

able. Since T-CDFT is targeted at large systems, where hybrid functionals are in many cases prohibitively expensive, this reflects the computational setup which would be used at scale.
T-CDFT calculations were performed using a range of basis set sizes using both the SF- and WFN-based approaches. LR-TDDFT calculations were performed within the full Casida formalism24 both in BigDFT and NWChem. SCF calculations were performed using the ground state wavefunctions as an initial guess for all BigDFT calculations and for selected NWChem calculations, as described in the SI. The SCF procedure notoriously models the non-Aufbau electronic singlet state which is not a spin eigenfunction.81 To obtain the energy of the singlet excited state, we therefore applied the common spin purification formula to the uncorrected mixed state energy ESp1urified,

ESp1urified = 2ESu1npurified - ET1 .

(18)

All S1 SCF energies reported in the following are

EstSrpi1ucrtifieedd,.whAilellexgcriotuedndstastteatcealccuallcautiloantisoanrse

are spin reunrestricted.

Further computational details are given in the SI.

III. RESULTS Benchmark calculations were performed for a set of seven molecules, which were chosen to provide a range of different LE, CT and mixed character excitations and are depicted in Fig. 2. The test set consists of four acenes, namely naphthalene, anthracene, tetracene and pentacene, which were chosen as they constitute a set of well characterized molecules; and three exemplar OLED molecules, namely NPh3 (triphenylamine), 2CzPN (1,2bis(carbazol-9-yl)-4,5-dicyanobenzene) and CBP (4,4'Bis(N-carbazolyl)-1,1'-biphenyl). NPh3 and 2CzPN are among the most investigated TADF emitters while CBP is a host molecule used to sensitize TADF emitters.82 For these molecules, we present the following results for different methods, basis sets and functionals, as described in Section II E. While experimental data is available for these systems, these are typically adiabatic excitation energies, which can differ significantly from the vertical excitation energies calculated in this work, as shown in e.g. Ref. 83. Furthermore, such experiments take place in various external conditions, with the results being sensitive to the external environment (i.e. the solvent or other molecular environment) as well as temperature.84,85 As the aim of this work is to assess the performance of T-CDFT for vertical excitations in gas phase, it is therefore not informative to make quantitative comparisons with experimental data. Indeed, one of the motivations behind this work is to provide a formalism which is capable of treating large enough systems to take into account explicit environmental effects. Such comparisons are therefore

8 in the OLED excitations could lead to a less accurate description, in particular for semi-local functionals.

(a) naphthalene

(b) anthracene

(c) tetracene

(d) pentacene

(e) NPh3

(f) 2CzPN

(g) CBP

Figure 2. Relaxed atomic structures of the investigated molecules. H/C/N atoms are depicted in white/black/blue.

saved for future work, while in the following we focus on comparisons between theoretical approaches only.

A. Benchmark Results 1. Nature of the Excitations Before discussing the excitation energies, we first characterize the electronic transitions for the benchmark molecules. The frontier orbitals for LDA are depicted in Fig. 3, alongside P and T values. The equivalent PBE and PBE0 plots and the corresponding frontier orbital energies can be found in the SI. The HOMO-LUMO transition purity values, P, show that, within our computational set up, S1 excitations are less pure than T1, however none of the values are below 0.9. In other words, the excitations considered in this paper are all relatively pure, and thus using a HOMO-LUMO constraint with T-CDFT should represent a good approximation. The high value of T for the acenes implies a strong spatial overlap in the HOMO-LUMO, in other words the transition constraint is local in nature, and will thus give rise to a predominantly local excitation (for all functionals used), as expected. On the other hand, the OLED molecules have a smaller spatial overlap, so that the transition constraint and thus the excitation display a hybrid LE/CT nature, as it has also been found in other computational works.9 As a result, we expect TDDFT to perform more robustly in computing HOMO-LUMO transitions in the acenes, whereas the CT character found

2. Acenes We first consider the benchmark results for the acenes, which are summarized in Fig. 4, with the corresponding values in the SI. For all methods, the difference between LDA and PBE results is relatively small, with PBE giving slightly lower T1 energies than LDA for all methods, and slightly higher S1 energies for SCF. In general, S1 is more sensitive to both method and functional compared to T1 ­ aside from somewhat lower T1 energies for TDDFT with PBE0, T1 is relatively consistent. On the other hand, S1 computed with SCF and semilocal functionals tends to be underestimated in comparison with PBE0. To a lesser extent, similar behaviour is observed with TDDFT. However, despite having been calculated with a cheaper semi-local functional, the PBE T-CDFT S1 results are similar to the PBE0 results from SCF and TDDFT. We expect TDDFT to be a reliable reference for this class of (local) excitations, and thus we also expect that T-CDFT results should be comparable to TDDFT. This is indeed the case, with the mean absolute deviation (MAD) between PBE results for WFN-based T-CDFT with the largest basis and TDDFT with cc-pVTZ being 0.3 eV for S1 and 0.1 eV for T1. As a final test of the quality of the results, we also compare with higher level theory calculations based on CCSD(T), which is often regarded as the gold standard of chemical accuracy in quantum chemistry.87 Taking the same basis sets, we find that the T-CDFT results agree reasonably well with CCSD(T),88,89 with a MAD of 0.5 eV for PBE S1 energies. This is comparable to MADs for S1 of 0.4 and 0.5 eV for PBE0 calculations with SCF and TDDFT respectively, and lower than the PBE-based SCF and TDDFT MADs of 1.0 and 0.8 eV respectively, further confirming the reliability of T-CDFT. For T1, in line with the smaller variation in results, all PBE and PBE0 MADs other than PBE0-based TDDFT are in the range of 0.3-0.5 eV, with the PBE-based TCDFT MAD being 0.4 eV. In contrast, the TDDFT PBE0 MAD is notably higher at 0.8 eV. A possible explanation for this behaviour is provided by the triplet instability problem, which may emerge when employing full TDDFT and some percentage of exact exchange in the functional.90 As discussed in Ref. 91, it can be avoided by using the Tamm-Dancoff approximation (TDA). Although performed using a different hybrid functional, TDA-TDDFT calculations from Ref. 88 show T1 values which are closer to the T-CDFT and SCF results than the full PBE0 TDDFT results presented here, supporting this explanation. This is also likely the reason for the PBE0 TDDFT calculations not converging for pentacene with both 6-31G* and cc-pVTZ and CBP with ccpVTZ. Indeed, TDA-TDDFT calculations for pentacene

T = 0.89 2

T = 0.88

T = 0.89

T = 0.89

T = 0.59

T = 0.47

T = 0.57

0

2

4

S1 T1

==

00..9929

S1 T1

==

01..9050

S1 T1

==

01..9060

S1 T1

==

01..9070

S1 T1

==

01..9080

S1 T1

==

01..9040

S1 T1

==

00..9969

6

8

9 LUMO+2 LUMO+1 LUMO HOMO HOMO-1 HOMO-2

Energy (eV)

naphthalene

anthracene

tetracene

pentacene

NPh3

2CzPN

CBP

Figure 3. LDA-calculated frontier orbital energies and corresponding HOMO and LUMO wavefunctions, as obtained from

NWChem using the cc-pVTZ basis. Wavefunctions were visualized in VESTA,86 using corresponding charge transfer parameter, T and transition purity values, P, are also

an isosurface value of 0.0052 given for each molecule.

a-0 3/2.

The

with 6-31G* and CBP with cc-pVTZ successfully converged onto values of 2.24 and 0.91 eV for S1 and T1 respectively for pentacene and 3.48 and 2.84 eV for S1 and T1 respectively for CBP.
In summary, we find that T-CDFT performs very well for the predominantly local excitations seen in the acenes. Indeed, T-CDFT results based on a semi-local functional are comparable to hybrid functional results from SCF and TDDFT, if one discounts the underestimation of T1 which arises with PBE0 and full TDDFT.
3. OLEDs Considering now the results for the OLED molecules, which are also depicted in Fig. 4, we see that both S1 and T1 display a stronger dependence on method and functional than the acenes. We also note that S1 energies computed with SCF and PBE0 display a strong dependence on the basis set, which is discussed in detail in Section III B. As with the acenes, the differences between LDA and PBE are small, however both semi-local functionals give S1 and T1 energies which are underestimated compared to PBE0, for both SCF and TDDFT. This is in contrast to the acenes, where it is primarily the singlet which is underestimated, and can be attributed to the CT nature of the OLED excitations. Indeed, this behaviour is most accentuated with TDDFT calculations of 2CzPN, which has the highest CT character according to T, and is therefore the most susceptible to the limitations of TDDFT when treating CT states. On the other hand, we again observe that T-CDFT does not significantly underestimate the energies, in contrast to the other results based on semi-local functionals. In other

words, the quality of the T-CDFT results is not noticeably impacted by the nature of the excitation. Indeed, we expect that for LE states such as in the acenes (large values of T), where semi-local TDDFT is expected to perform well, PBE-based T-CDFT results should be in good agreement with PBE-based TDDFT. On the other hand, for CT states (small values of T), we expect that T-CDFT should outperform TDDFT for semi-local functionals, and thus the results should differ. This is illustrated in Fig. 5, which demonstrates the expected trend of higher discrepancy between the two methods for smaller T, with S1 being more affected.
The limitations of TDDFT for CT states are well known, as is the corresponding strong dependence on the employed functional. This has motivated the use of range-separated hybrid functionals for the treatment of TADF materials. For example, Adachi and co-workers84 reported that functionals such as CAM-B3LYP41 or LCPBE42 tend to overestimate absorption energies for common TADF molecules, indicating that the range separation parameters were not optimal in such systems, and confirming the strong system-dependency of rangeseparated functionals. The situation may be improved by using `optimally' tuned range-separated functionals, which have been shown to give good agreement with experimental data,92,93 although the tuning of the separation parameters for a particular system may result in higher computational costs compared to standard functionals.
Sun et al.93 computed vertical excitation energies for NPh3, 2CzPN and CBP, among other molecules, using TDA-TDDFT with an optimally tuned LC-PBE* functional in a 6-31+G(d) basis set. Although they were performed in an implicit solvent (PCM toluene), which intro-

10

E (eV)

5 4 3 2 1 0
T-CDFT 5 4 3 2 1 0
T-CDFT

naphthalene

SCF

TDDFT

NPh3

SCF

TDDFT

anthracene

T-CDFT

SCF 2CzPN

TDDFT

T-CDFT SCF

TDDFT

T-CDFT T-CDFT

tetracene

SCF

TDDFT

CBP

SCF

TDDFT

pentacene

T-CDFT S1/LDA S1/PBE S1/PBE0

SCF T1/LDA T1/PBE T1/PBE0

TDDFT

E (eV)

Figure 4. Vertical S1 and T1 energies computed using different methods (T-CDFT, SCF, TDDFT), basis sets (6-31G*, cc-pVTZ, wavelets) and functionals (LDA, PBE, PBE0) using BigDFT and NWChem. Corresponding energies are given in the SI. The T-CDFT results are those for the largest considered basis for the WFN-based case, as well as for the SF case with 4/9/9 SFs per H/C/N atom and Rloc = 4.76 Å. Energies have been omitted for calculations which did not converge within a given number of iterations. The thickness of the bars is a function of the variation between basis sets: thicker bars indicate greater variation.

1.2

S1

1.0

T1

E T CDFT E TDDFT (eV)

0.8

0.6

0.4

0.2

0.00.4

0.6

0.8

1.0

T

Figure 5. Plot of the difference between T-CDFT and TDDFT energies vs. T, the spatial overlap, where both calculations employ the PBE functional. T-CDFT calculations are those corresponding to the largest wavelet basis set while TDDFT calculations employ cc-pVTZ. The corresponding figure for LDA is shown in the SI.

to the range-separated values. These values are averaged across both S1 and T1 values, using the same basis sets as for the acene comparisons, except in the case where cc-pVTZ calculations did not converge, when 6-31G* values were used instead. On the other hand, PBE-based SCF and TDDFT show larger deviations of 0.6 and 0.9 eV respectively.
In summary, the qualitative difference in the nature of the excitations in the OLED molecules compared to the acenes gives rise to greater variation between methods and functionals. Nonetheless, we find that T-CDFT offers a good level of accuracy, once again giving results which are of similar quality to hybrid functional calculations with SCF and TDDFT, despite the use of semilocal functionals. This is illustrated by the increasing difference between PBE-based T-CDFT and TDDFT results for smaller T. In short, unlike TDDFT, where semi-local functional calculations are known to fall short for CT excitations, T-CDFT is found to be robust with respect to the nature of the excitation.

duces an additional source of discrepancy, by comparing with the values of Sun et al. we nonetheless observe that T-CDFT with PBE gives values which are of a similar quality to the SCF and TDDFT results with PBE0, with MADs of 0.4, 0.2 and 0.4 eV respectively compared

4. EST in OLEDs As discussed in Section I, to the end of designing new, optimal TADF emitters, it is crucial to accurately calculate EST. We therefore conclude this section by dis-

11

cussing the results for EST. While many of the considerations are the same as those discussed above, EST may benefit from error cancellations if the error in S1 and T1 are comparable, or conversely, may exhibit a larger overall error. It is therefore unsurprising that extensive computational literature is available on the subject of predicting EST,83,84,92,94,95 which use methods ranging from TDDFT to ROKS, with all of these works employing range-separated hybrid functionals, among other functionals.
Comparing the PBE-calculated T-CDFT EST values to the tuned LC-PBE* values from Sun et al.,93 we find that T-CDFT gives smaller EST values, particularly for NPh3 and CBP. This is also the case for the PBE-calculated SCF and TDDFT values, with all three methods showing slightly larger MADs of 0.3-0.4 eV for PBE compared to PBE0 MADs of 0.2 eV for both SCF and TDDFT. These results imply that PBE-based SCF and TDDFT calculations benefit from a better error cancellation between S1 and T1 values than TCDFT, although a larger set of molecules would be required to more conclusively assess the differences. Furthermore, such differences are also impacted by the implicit solvent included in the range-separated calculations. Nonetheless, T-CDFT gives a comparable accuracy to both SCF and TDDFT, while having both a comparatively low computational cost and exhibiting robust convergence.
To sum up, what emerges from our benchmark calculations and other computational works9,96,97 is that the modelling of the excitations in OLED molecules is strongly method- and functional- dependant, and it is therefore not trivial to obtain a unique and consistent description. Furthermore, the large size of typical OLED molecules limits the ability to perform expensive reference calculations using higher level quantum chemistry approaches. Nonetheless, by comparing with tuned range-separated functional calculations, we see that, despite the lower computational cost, as with the acenes, TCDFT with PBE gives results which are of similar quality to hybrid functional SCF and TDDFT calculations for S1 and T1 energies, and only slightly worse EST values. Importantly, T-CDFT does not suffer from the problems encountered when applying TDDFT to CT states, and, unlike CDFT with a spatial constraint, can model both LE and CT states. Furthermore, the SF-based implementation, which is designed for large systems, is ideally suited to exploring the effects of an explicit environment on EST, which, when combined with adiabatic rather than vertical treatment of excitations, could facilitate more quantitative comparisons with experiment in future work.
B. Basis Set Effects We conclude the results section by discussing basis set effects. While Gaussian basis sets are widely used

for both ground and excited state calculations, they are not systematically improvable. Although they typically benefit from excellent error cancellation between ground and excited states, basis set choice can therefore introduce a further source of uncertainty. Wavelets, on the other hand, offer the advantage of systematic convergence, while still comprising local degrees of freedom. However, in BigDFT this comes at the cost of introducing an additional approximation in the form of PSPs. In this work the employed PSPs were generated for PBE, thereby also resulting in an inconsistency for LDA and PBE0 calculations. By comparing the wavelet results with those coming from two commonly used Gaussian basis sets, we are therefore able to assess the approximate levels of uncertainty in the excitation energies presented above due to both basis set and PSP approximations.
Considering first TDDFT, all excitation energies differ by less than 0.15 eV between basis sets, except for NPh3, which is more sensitive to the basis set (with differences up to 0.23 eV). Although such variations are not negligible, as can be seen from Fig. 4, basis set effects are typically less important than variations due to the functional, or indeed, the formalism used. Furthermore, the use of PSPs in BigDFT do not represent a significant source of error.
For SCF the picture is more complicated. Although generally considered a reliable tool for the computation of vertical HOMO-LUMO transitions in organic emitters,81 because SCF algorithms are geared toward energy minimization, it can sometimes collapse to low energy states. This can include the ground state,98 although methods such as the maximum overlap method99 have been developed to alleviate this problem. For some OLED molecules, it has also been observed to converge onto a different excited state due to a poor orbital guess or degeneracy.100 In this work no collapses onto the ground state were observed. However, large initial variations between basis sets were observed, indicating the presence of local minima. Therefore, a careful inspection of the results was carried out, as described in the SI. It was found that using the ground state orbitals as an initial guess for excited state calculations eliminated these local minima, typically also improving convergence. Following this strategy, the majority of the variations are below 0.2 eV, and thus comparable to TDDFT. However, as with TDDFT, NPh3 is sensitive to the basis set, with differences up to 0.24 eV. In addition, the wavelet results for 2CzPN and CBP S1 energies with PBE0 are 0.33 eV and 0.27 eV higher than cc-pVTZ respectively. However, these discrepancies are affected by purification (Eq. 18) ­ the differences before purification are below 0.2 eV. In other words, purification increases uncertainties in S1 due to basis set, PSP and convergence differences.
Finally, SF-based T-CDFT calculations have two key convergence parameters, namely the SF localization radii and the number of SFs per atom, while for the WFNbased calculations only the total number of basis functions need be varied. Detailed convergence plots for all

12

three parameters are shown in the SI. T-CDFT requires a good description of the LUMO, indeed as shown in the SI, the LUMO and T-CDFT errors are directly correlated. Nonetheless, provided the SFs are explicitly optimized to include virtual states, following the procedure described in Section II D 2, the LUMO is already well represented with moderate localization radii, even for a minimal SF basis with 1/4/4 SFs per H/C/N atom. The T-CDFT energies converge more slowly with both localization radii and number of SFs than the LUMO, although due to error cancellation, EST converges very quickly. Furthermore, for S1 and T1 energies, the error for even the minimal SF basis set is comparable to the differences between wavelets and Gaussian basis sets discussed above. Indeed, the values for radii of 4.76 Å with 4/9/9 SFs per H/C/N atom are all within 0.1 eV of the values we obtain with WFN-based T-CDFT using the largest basis set, which therefore represents a good choice of basis set size for future practical calculations.
In summary, by comparing the two approaches to generating basis sets, we see that the SF-based approach results in a basis which is complete enough to allow accurate T-CDFT calculations, provided the LUMO is well represented. Indeed, the differences between the two approaches are comparable to those seen between the wavelet and Gaussian results for SCF and TDDFT, while the SF approach nonetheless allows for systematic convergence. Going beyond the gas phase, the SF-based approach may therefore be directly employed without the need to also compare with the WFN-based approach. Indeed, due to the presence of additional degrees of freedom coming from environment molecules, it is possible that fewer SFs per atom may be required to converge the T-CDFT energies for large scale calculations.
IV. CONCLUSIONS This work introduces a variation of CDFT (T-CDFT), wherein the constraint is defined as a transition between particular occupied and virtual orbitals, rather than a region of the simulation space as in traditional CDFT. In so doing, we aim to provide a tool for the robust modelling of excitations in molecules, which is designed for application to large supramolecular systems. The approach is implemented in the wavelet-based BigDFT code, and is applied to both gas phase acene molecules and prototypical TADF-based OLED emitters. The results are compared to benchmark SCF and TDDFT calculations for different exchange-correlation functionals and basis sets. The current work focuses on pure HOMO-LUMO transitions, however the implementation could be generalized to treat mixed excitations involving transitions between multiple frontier orbitals. Our benchmark calculations demonstrate that TCDFT performs well for both the predominantly local ex-

citations seen in the acenes and the mix of charge transfer and local character seen in the TADF emitters. Furthermore, for both classes of molecules, we find that T-CDFT results based on semi-local functionals are comparable to hybrid functional results from SCF and TDDFT. This conclusion is further supported through comparisons with higher-level theory calculations from the literature, based on CCSD(T) for the acenes and tuned range-separated functional TDDFT calculations for the OLED emitters. Importantly, T-CDFT does not suffer from the problems encountered when applying TDDFT to CT states, and, unlike CDFT with a spatial constraint, can robustly model both LE and CT states.
For the case of pure transitions, there is no need to optimize the Lagrange multiplier used to impose the constraint. The computational cost of T-CDFT is therefore comparable to a ground state calculation, and thus significantly cheaper than TDDFT. On the other hand, TCDFT also proves to be more robust than SCF, which occasionally requires extra attention to ensure convergence onto the correct state, particularly for the OLED molecules investigated in this work. Although using the ground state orbitals as an initial guess for the excited state calculations significantly reduces the occurrence of local minima in SCF, small differences are nonetheless further exaggerated by the use of the purification formula for singlet excitations, which is not required for T-CDFT.
Finally, through detailed basis set comparisons, we demonstrate that the support function basis employed in linear-scaling BigDFT is complete enough to allow accurate fixed-basis T-CDFT calculations, providing the LUMO is well represented by the basis. The SF-based implementation, which is inherently designed for large systems, is thus ideally suited for exploring the effects of an explicit environment on both excitation energies and EST, a key quantity for modelling TADF-based OLEDs. Indeed, we foresee that the combination of TCDFT with the fragmentation approaches47,67 which are already available within the BigDFT code, will represent a powerful tool for the study of excitations in realistic supramolecular morphologies, for applications such as TADF. Work in this direction is ongoing.
ACKNOWLEDGMENTS LER and MS acknowledge support from an EPSRC Early Career Research Fellowship (EP/P033253/1) and the Thomas Young Centre under grant number TYC-101. MS acknowledges Dr. Valerio Vitale for his initial help with automating the conversion between wavefunctions and support functions. KT acknowledges support from the Engineering and Physical Sciences Research Council (EP/S515085/1). Calculations were performed on the Imperial College High Performance Computing Service and the ARCHER UK National Supercomputing Service.

13

 laura.ratcliff08@imperial.ac.uk 1 F. De Angelis, Acc. Chem. Res. 47, 3349 (2014). 2 Y. Tao, K. Yuan, T. Chen, P. Xu, H. Li, R. Chen,
C. Zheng, L. Zhang, and W. Huang, Adv. Mater. 26, 7931 (2014). 3 M. Y. Wong and E. Zysman-Colman, Adv. Mater. 29, 1605444 (2017). 4 M. A. L. Marques, X. López, D. Varsano, A. Castro, and A. Rubio, Phys. Rev. Lett. 90, 258101 (2003). 5 S. A. Carlson and D. M. Hercules, J. Am. Chem. Soc. 93, 5611 (1971). 6 P. B. Merkel and D. R. Kearns, J. Chem. Phys 58, 398 (1973). 7 U. Hiroki, G. Kenichi, S. Katsuyuki, N. Hiroko, and A. Chihaya, Nature 492, 234 (2012). 8 Y. Olivier, B. Yurash, L. Muccioli, G. D'Avino, O. Mikhnenko, J. C. Sancho-García, C. Adachi, T.-Q. Nguyen, and D. Beljonne, Phys. Rev. Mat. 1 (2017). 9 Y. Olivier, J.-C. Sancho-García, L. Muccioli, G. D'Avino, and D. Beljonne, J. Phys. Chem. Lett 9, 6149 (2018). 10 D. Jacquemin, V. Wathelet, E. A. Perpète, and C. Adamo, J. Chem. Theory Comput. 5, 2420 (2009). 11 M. J. van Setten, F. Caruso, S. Sharifzadeh, X. Ren, M. Scheffler, F. Liu, J. Lischner, L. Lin, J. R. Deslippe, S. G. Louie, C. Yang, F. Weigend, J. B. Neaton, F. Evers, and P. Rinke, J. Chem. Theory Comput. 11, 5665 (2015). 12 P. Hohenberg and W. Kohn, Phys. Rev. 136, B864 (1964). 13 W. Kohn and L. J. Sham, Phys. Rev. 140, A1133 (1965). 14 R. O. Jones and O. Gunnarsson, Rev. Mod. Phys. 61, 689 (1989). 15 O. Gunnarsson and B. I. Lundqvist, Phys. Rev. B 13, 4274 (1976). 16 A. Görling, Phys. Rev. A 59, 3359 (1999). 17 C. C. J. Roothaan, Rev. Mod. Phys. 32, 179 (1960). 18 T. Tsuchimochi and G. E. Scuseria, J. Chem. Phys 133, 141102 (2010). 19 J. A. Pople and R. K. Nesbet, J. Chem. Phys 22, 571 (1954). 20 K. B. Wiberg, J. Comput. Chem 7, 379 (1986). 21 A. S. Menon and L. Radom, J. Phys. Chem. A 112, 13225 (2008). 22 K. R. Glaesemann and M. W. Schmidt, J. Phys. Chem. A 114, 8772 (2010). 23 E. Runge and E. K. U. Gross, Phys. Rev. Lett. 52, 997 (1984). 24 M. E. Casida, "Time-dependent density functional response theory for molecules," in Recent Advances in Density Functional Methods (1995) pp. 155­192. 25 R. A. Friesner, PNAS 102, 6648 (2005). 26 J. Liu and J. M. Herbert, J. Chem. Phys 143, 034106 (2015). 27 T. J. Zuehlsdorff, N. D. M. Hine, M. C. Payne, and P. D. Haynes, J. Chem. Phys 143, 204107 (2015). 28 A. Dreuw and M. Head-Gordon, J. Am. Chem. Soc. 126, 4007 (2004). 29 S. Kummel, Adv. Energy Mater. 7, 1700440 (2017). 30 J. Toulouse, F. Colonna, and A. Savin, Phys. Rev. A 70, 062505 (2004). 31 P. H. Dederichs, S. Blügel, R. Zeller, and H. Akai, Phys. Rev. Lett. 53, 2512 (1984). 32 Q. Wu and T. Van Voorhis, Phys. Rev. A 72, 024502

(2005). 33 T. Kowalczyk, Z. Lin, and T. Van Voorhis, J. Phys.
Chem. A 114, 10427 (2010). 34 M. Segal, M. Singh, K. Rivoire, S. Difley, T. Van Voorhis,
and M. A. Baldo, Nat. Mater. 6, 374 (2007). 35 S. Difley, D. Beljonne, and T. Van Voorhis, J. Am. Chem.
Soc. 130, 3420 (2008). 36 A. M. P. Sena, T. Miyazaki, and D. R. Bowler, J. Chem.
Theory Comput. 7, 884 (2011). 37 A. M. Souza, I. Rungger, C. D. Pemmaraju, U. Schwin-
genschloegl, and S. Sanvito, Phys. Rev. B 88, 165112 (2013). 38 S. Difley and T. Van Voorhis, J. Chem. Theory Comput. 7, 594 (2011). 39 S. Roychoudhury, C. Motta, and S. Sanvito, Phys. Rev. B 93, 045130 (2016). 40 B. Kaduk, T. Kowalczyk, and T. Van Voorhis, Chem. Rev. 112, 321 (2012). 41 P. Ramos and M. Pavanello, Phys. Chem. Chem. Phys. 18, 21172 (2016). 42 P. Ramos and M. Pavanello, J. Chem. Phys 148, 144103 (2018). 43 S. Roychoudhury, D. D. O'Regan, and G. Teobaldi, Scientific Reports 10 (2020). 44 F. A. Evangelista, P. Shushkov, and J. C. Tully, J. Phys. Chem. A 117, 7378 (2013). 45 F. Senn and Y. C. Park, J. Chem. Phys 145, 244108 (2016). 46 S. Mohr, W. Dawson, M. Wagner, D. Caliste, T. Nakajima, and L. Genovese, J. Chem. Theory Comput. 13, 4684 (2017). 47 W. Dawson, S. Mohr, L. E. Ratcliff, T. Nakajima, and L. Genovese, J. Chem. Theory Comput. 16, 2952 (2020). 48 L. E. Ratcliff, W. Dawson, G. Fisicaro, D. Caliste, S. Mohr, A. Degomme, B. Videau, V. Cristiglio, M. Stella, M. D Alessandro, S. Goedecker, T. Nakajima, T. Deutsch, and L. Genovese, J. Chem. Phys. 152, 194110 (2020). 49 S. Mohr, L. E. Ratcliff, P. Boulanger, L. Genovese, D. Caliste, T. Deutsch, and S. Goedecker, J. Chem. Phys. 140, 204110 (2014). 50 S. Mohr, L. E. Ratcliff, L. Genovese, D. Caliste, P. Boulanger, S. Goedecker, and T. Deutsch, Phys. Chem. Chem. Phys. 17, 31360 (2015). 51 D. Rocca, R. Gebauer, Y. Saad, and S. Baroni, The Journal of Chemical Physics 128, 154105 (2008). 52 M. D'Alessandro and L. Genovese, Phys. Rev. Materials 3, 023805 (2019). 53 D. Jacquemin, E. A. Perpete, G. E. Scuseria, I. Ciofini, and C. Adamo, J. Chem. Theory Comput. 4, 123 (2008). 54 T. Le Bahers, C. Adamo, and I. Ciofini, J. Chem. Theory Comput. 7, 2498 (2011). 55 M. J. Bedard-Hearn, F. Sterpone, and P. J. Rossky, J. Phys. Chem. A 114, 7661 (2010). 56 H. Nitta and I. Kawata, Chem. Phys. 405, 93 (2012). 57 M. J. G. Peach, P. Benfield, T. Helgaker, and D. J. Tozer, J. Chem. Phys 128, 044118 (2008). 58 F. Plasser and H. Lischka, J. Chem. Theory Comput. 8, 2777 (2012). 59 C. A. Guido, P. Cortona, B. Mennucci, and C. Adamo, J. Chem. Theory Comput. 9, 3118 (2013). 60 L. E. Ratcliff, W. Dawson, G. Fisicaro, D. Caliste,

14

S. Mohr, A. Degomme, B. Videau, V. Cristiglio, M. Stella, M. D'Alessandro, S. Goedecker, T. Nakajima, T. Deutsch, and L. Genovese, J. Chem. Phys 152, 194110 (2020). 61 I. Daubechies, Ten Lectures on Wavelets (SIAM, 1992). 62 L. Genovese, A. Neelov, S. Goedecker, T. Deutsch, S. A. Ghasemi, A. Willand, D. Caliste, O. Zilberberg, M. Rayson, A. Bergman, and R. Schneider, J. Chem. Phys. 129, 014109 (2008). 63 E. Hernández and M. J. Gillan, Phys. Rev. B 51, 10157 (1995). 64 W. Kohn, Phys. Rev. Lett. 76, 3168 (1996). 65 S. Goedecker and L. Colombo, Phys. Rev. Lett. 73, 122 (1994). 66 S. Goedecker and M. Teter, Phys. Rev. B 51, 9455 (1995). 67 L. E. Ratcliff, L. Genovese, S. Mohr, and T. Deutsch, J. Chem. Phys. 142, 234105 (2015). 68 L. E. Ratcliff and L. Genovese, J. Phys.: Condens. Matter 31, 285901 (2019). 69 S. Mohr, M. Masella, L. E. Ratcliff, and L. Genovese, J. Chem. Theory Comput. 13, 4079 (2017). 70 J. C. A. Prentice, J. Aarons, J. C. Womack, A. E. A. Allen, L. Andrinopoulos, L. Anton, R. A. Bell, A. Bhandari, G. A. Bramley, R. J. Charlton, R. J. Clements, D. J. Cole, G. Constantinescu, F. Corsetti, S. M.-M. Dubois, K. K. B. Duff, J. M. Escartín, A. Greco, Q. Hill, L. P. Lee, E. Linscott, D. D. O' Regan, M. J. S. Phipps, L. E. Ratcliff, A. R. Serrano, E. W. Tait, G. Teobaldi, V. Vitale, N. Yeung, T. J. Zuehlsdorff, J. Dziedzic, P. D. Haynes, N. D. M. Hine, A. A. Mostofi, M. C. Payne, and C.-K. Skylaris, J. Chem. Phys 152, 174111 (2020). 71 C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, and M. C. Payne, J. Chem. Phys. 122, 84119 (2005). 72 L. E. Ratcliff, N. D. M. Hine, and P. D. Haynes, Phys. Rev. B 84, 165131 (2011). 73 L. E. Ratcliff, L. Grisanti, L. Genovese, T. Deutsch, T. Neumann, D. Danilov, W. Wenzel, D. Beljonne, and J. Cornil, J. Chem. Theory Comput. 11, 2077 (2015). 74 M. Valiev, E. Bylaska, N. Govind, K. Kowalski, T. Straatsma, H. Van Dam, D. Wang, J. Nieplocha, E. Apra, T. Windus, and W. de Jong, Comput. Phys. Commun. 181, 1477 (2010). 75 T. H. Dunning, J. Chem. Phys. 90, 1007 (1989). 76 P. C. Hariharan and J. A. Pople, Theor. Chim. Acta 28, 213 (1973). 77 W. J. Hehre, R. Ditchfield, and J. A. Pople, J. Chem. Phys. 56, 2257 (1972). 78 D. M. Ceperley and B. J. Alder, Phys. Rev. Lett. 45, 566

(1980). 79 J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev.
Lett. 77, 3865 (1996). 80 C. Adamo and V. Barone, J. Chem. Phys. 110, 6158
(1999). 81 T. Kowalczyk, S. R. Yost, and T. V. Voorhis, J. Chem.
Phys 134, 054128 (2011). 82 Z. Yang, Z. Mao, Z. Xie, Y. Zhang, S. Liu, J. Zhao, J. Xu,
Z. Chi, and M. P. Aldred, Chem. Soc. Rev. 46, 915 (2017). 83 D. Hait, T. Zhu, D. P. McMahon, and T. Van Voorhis, J. Chem. Theory Comput. 12, 3353 (2016). 84 S. Huang, Q. Zhang, Y. Shiota, T. Nakagawa, K. Kuwabara, K. Yoshizawa, and C. Adachi, J. Chem. Theory Comput. 9, 3872 (2013). 85 Y. Yang, E. R. Davidson, and W. Yang, PNAS 113, E5098 (2016). 86 K. Momma and F. Izumi, J. Appl. Crystallogr. 44, 1272 (2011). 87 L. W. Bertels, J. Lee, and M. Head-Gordon, J. Chem. Theory Comput. 17, 742 (2021). 88 T. Rangel, S. M. Hamed, F. Bruneval, and J. B. Neaton, J. Chem. Phys 146, 194108 (2017). 89 K. Lopata, R. Reslan, M. Kowalska, D. Neuhauser, N. Govind, and K. Kowalski, J. Chem. Theory Comput. 7, 3686 (2011). 90 J. S. Sears, T. Koerzdoerfer, C.-R. Zhang, and J.-L. Brédas, J. Chem. Phys. 135, 151103 (2011). 91 M. J. Peach, N. Warner, and D. J. Tozer, Mol. Phys. 111, 1271 (2013). 92 T. J. Penfold, J. Phys. Chem. C 119, 13535 (2015). 93 H. Sun, C. Zhong, and J.-L. Brédas, J. Chem. Theory Comput. 11, 3851 (2015). 94 R. Al-Saadon, C. Sutton, and W. Yang, J. Chem. Theory Comput. 14, 3196 (2018). 95 C. Wang, C. Deng, D. Wang, and Q. Zhang, J. Phys. Chem. C 122, 7816 (2018). 96 M. Moral, L. Muccioli, W.-J. Son, Y. Olivier, and J. C. Sancho-García, J. Chem. Theory Comput. 11, 168 (2015). 97 J. Sanz-Rodrigo, Y. Olivier, and J.-C. Sancho-García, Molecules 25, 1006 (2020). 98 S. Bourne Worster, O. Feighan, and F. R. Manby, J. Chem. Phys. 154, 124106 (2021). 99 A. T. B. Gilbert, N. A. Besley, and P. M. W. Gill, J. Phys. Chem. A 112, 13164 (2008). 100 K. Zhao, Ö. H. Omar, T. Nematiaram, D. Padula, and A. Troisi, J. Mater. Chem. C 9, 3324 (2021).

arXiv:2106.01142v1 [physics.chem-ph] 2 Jun 2021

Supplementary Information
Transition-Based Constrained DFT for the Robust and Reliable Treatment of Excitations in Supramolecular Systems
Martina Stella,1 Kritam Thapa,1 Luigi Genovese,2 and Laura E. Ratcliff1 1Department of Materials, Imperial College London, London SW7 2AZ, United Kingdom
2Univ. Grenoble Alpes, CEA, IRIG-MEM-L Sim, 38000 Grenoble, France (Dated: June 3, 2021)
A. Workflow for Wavefunction-Based T-CDFT
Currently, constrained density functional theory (CDFT) is only available within the linear scaling version of BigDFT. In order to also calculate T-CDFT energies for a wavelet basis set, without the need to define support functions (SFs), we have therefore implemented a workflow which allows one to treat extended Kohn-Sham (KS) wavefunctions coming from a cubic scaling calculation as SFs with effectively infinite localization radii. This method is therefore referred to as wavefunction (WFN)-based T-CDFT. The protocol has been developed within a Jupyter notebook and consists of the following steps:
1. Run a ground state cubic scaling calculation with a large number of virtual states, writing the resulting basis of delocalized KS wavefunctions to disk.
2. Run a ground state linear scaling calculation with the required number of total basis functions, using large enough localization radii such that the SFs are comparably diffuse to the KS wavefunctions. The SFs are then written to disk.
3. Convert the KS wavefunctions into a SF-like format by combining the metadata concerning the localization regions from step 2) with the wavefunctions from step 1), for both the occupied wavefunctions and as many virtual states as are necessary to give the total number of required basis functions. In this work, four basis sizes were considered (defined in Table S1), chosen to correspond to typical SF basis set sizes.
4. Use the resulting basis as a fixed basis for both ground state and excited state T-CDFT calculations using linear-scaling BigDFT.
In future, this workflow could be simplified by generalizing the data formats used to store SFs and KS wavefunctions.
B. Additional Computational Details
BigDFT calculations were performed using HGH-GTH PSPs1,2 with non-linear core corrections.3 Gas phase geometry optimizations were performed for the ground state using PBE in BigDFT, with a maximum force threshold of 0.2 eV/°A. Single point calculations were performed with a wavelet grid spacing of 0.26 °A, while geometry optimizations employed a smaller grid spacing of 0.24 °A to ensure accurate force calculations. All BigDFT calculations used coarse and fine multipliers of 7 and 9 respectively. Cubic scaling BigDFT calculations employed a gradient convergence threshold of 10-5. Due to the poor convergence behaviour of some NWChem calculations, a strict upper limit of 200 iterations was imposed for both SCF and TDDFT calculations, beyond which calculations were considered to have not reached convergence.
For the WFN-based T-CDFT calculations three different basis set sizes were investigated, corresponding to a minimal basis with 1/4/4 basis functions per H/C/N atom and two larger basis sets as defined in Table S1. For PBE an additional basis set size was considered to give a more detailed picture of the convergence behaviour, while all four basis set sizes were used for SF-based calculations. SF-based T-CDFT calculations were performed for two scenarios: without including any virtual states, and optimizing all negative energy (bound) virtual states, as identified from the equivalent cubic scaling PBE calculation. Localization radii ranging from 3.18 °A to 5.29 °A were tested for a minimal SF basis, with calculations for larger basis sets performed with Rloc = 4.76 °A only. No kernel truncation was applied, since the addition of the constraint decreases the locality of the kernel.
The HOMO-LUMO spatial overlap, T, was calculated as a post-processing calculation using the HOMO and LUMO wavefunctions extracted from cubic-scaling BigDFT. The transition purity, P, was also calculated as a postprocessing step following BigDFT TDDFT calculations with LDA.

2 C. Basis Set Sizes

TABLE S1: Number of basis functions used for each species for the four different basis set sizes considered in BigDFT, where I
corresponds to a minimal basis. Also shown are the corresponding total number of basis functions for each molecule.

I

II

III

IV

s

1

2

1

2

H

p

-

-

3

3

d

-

-

-

-

total

1

2

4

5

s

1

2

1

2

C

p

3

6

3

6

d

-

-

5

5

total

4

8

9

13

s

1

2

1

2

N

p

3

6

3

6

d

-

-

5

5

total

4

8

9

13

naphthalene

48

96

122

170

anthracene

66

132

166

232

tetracene

84

168

210

294

pentacene

102

204

254

356

NPh3 2CzPN

91

182

231

322

162

324

396

558

CBP

176

352

438

614

D. Exploring Local Minima in SCF
As discussed in the main paper, the SCF approach is susceptible to the appearance of local minima. A close comparison of the initial results across the different basis sets showed larger deviations than would be expected compared to e.g. differences between TDDFT results, implying that local minima were indeed present. These were not confined to one particular functional or basis set. For cases where the energy coming from BigDFT was noticeably higher, it was observed that using the ground state wavefunctions as an initial guess allowed a lower energy state to be found, often also improving convergence. Therefore, all excited state BigDFT calculations were performed in this manner. NWChem calculations were initially performed without using the ground state as a guess, however cases where the results differed by greater than 0.15 eV between basis sets were also repeated using the ground state as a guess. It emerged that, for cases where the energy difference between basis sets was below 0.2 eV, the same state was found irrespective of the initial guess. The final results following these additional calculations are given in Table S3.
As an additional check, for each case where the difference between basis sets remained above 0.2 eV after using a ground state guess, we inspected the charge density difference between the ground state and the corresponding excited state. We found two cases with differences greater than 0.2 eV where the guess used in NWChem had a negligible effect on the calculated energy, namely T1 in NPh3, where the 6-31G* values were higher in energy (0.21 eV and 0.24 eV compared to the wavelet results for LDA and PBE0 respectively). Upon density comparisons, it was established that all three basis sets had nonetheless converged onto the same state. Two further states showed energy differences greater than 0.2 eV between basis sets, namely 2CzPN and CBP PBE0 S1 states, where the wavelet results were higher in energy (0.33 eV and 0.27 eV compared to cc-pVTZ respectively), however a visual inspection of the densities again confirmed convergence onto the same state across basis sets. As discussed in the main text, this can be partly explained by the use of the purification formula, which increases discrepancies between basis sets ­ without purification the differences for these two cases are below 0.2 eV, in line with the other molecules.

3 E. Additional Results

Energy (eV)

T = 0.89 2 0 2 4 6 8

T = 0.88

T = 0.89

T = 0.89

T = 0.59

T = 0.47

T = 0.57

LUMO+2 LUMO+1 LUMO HOMO HOMO-1 HOMO-2

naphthalene

anthracene

T = 0.88 2 0 2 4 6 8

T = 0.87

tetracene T = 0.88

pentacene
(a)PBE
T = 0.88

NPh3 T = 0.60

2CzPN T = 0.45

CBP T = 0.57

LUMO+2 LUMO+1 LUMO HOMO HOMO-1 HOMO-2

Energy (eV)

naphthalene

anthracene

tetracene

pentacene

NPh3

2CzPN

CBP

(b)PBE0

FIG. S1: PBE- and PBE0-calculated frontier orbital energies and corresponding HOMO and LUMO wavefunctions,
as obtained from NWChem using the cc-pVTZ basis. Wavefunctions were visualized in VESTA, using an isosurface value of 0.0052 a-0 3/2. The corresponding spatial overlap, T is also given for each molecule.

4

TABLE S2: Frontier orbital energies and band gaps using different functionals with cc-pVTZ (`VTZ') and 6-31G* basis sets in NWChem, a wavelet basis using the cubic scaling approach of BigDFT and a SF basis of 4/9/9 SFs per
H/C/N atom with Rloc = 4.76 °A. All values are given in eV.

LDA

PBE

PBE0

6-31G* VTZ wavelet SF 6-31G* VTZ wavelet SF 6-31G* VTZ wavelet SF

naphthalene

HOMO-2

-6.97 -7.33

-7.36 -7.38

-6.80 -7.11

-7.16 -7.18

-7.99 -8.23

-8.26

-

HOMO-1

-6.04 -6.40

-6.43 -6.45

-5.87 -6.18

-6.23 -6.25

-6.83 -7.07

-7.10

-

HOMO

-5.30 -5.67

-5.69 -5.71

-5.13 -5.45

-5.49 -5.52

-6.04 -6.30

-6.31

-

LUMO

-1.87 -2.29

-2.31 -2.32

-1.68 -2.04

-2.10 -2.12

-0.89 -1.22

-1.25

-

LUMO+1

-1.07 -1.53

-1.55 -1.57

-0.88 -1.28

-1.36 -1.37

-0.05 -0.43

-0.48

-

LUMO+2

-0.11 -0.69

-0.81 -0.77

0.10 -0.43

-0.61 -0.55

1.12 0.59

0.15 -

gap

3.43 3.38

3.38 3.39

3.45 3.40

3.39 3.39

5.16 5.07

5.06 -

anthracene

HOMO-2

-6.31 -6.66

-6.69 -6.71

-6.13 -6.44

-6.48 -6.50

-7.22 -7.46

-7.48

-

HOMO-1

-6.02 -6.37

-6.39 -6.41

-5.84 -6.14

-6.18 -6.20

-6.75 -6.98

-7.00

-

HOMO

-4.82 -5.17

-5.19 -5.21

-4.64 -4.95

-4.99 -5.01

-5.46 -5.70

-5.71

-

LUMO

-2.48 -2.87

-2.88 -2.91

-2.29 -2.62

-2.68 -2.70

-1.60 -1.90

-1.92

-

LUMO+1

-1.18 -1.62

-1.63 -1.65

-0.99 -1.37

-1.43 -1.45

-0.21 -0.57

-0.60

-

LUMO+2

-0.80 -1.26

-1.29 -1.30

-0.60 -1.00

-1.09 -1.10

0.35 -0.03

-0.10 -

gap

2.34 2.30

2.30 2.30

2.36 2.33

2.32 2.32

3.86 3.80

3.80 -

tetracene

HOMO-2

-6.01 -6.35

-6.37 -6.39

-5.82 -6.11

-6.15 -6.17

-6.70 -6.93

-6.95

-

HOMO-1

-5.80 -6.15

-6.17 -6.19

-5.62 -5.92

-5.96 -5.98

-6.62 -6.86

-6.87

-

HOMO

-4.51 -4.86

-4.86 -4.88

-4.33 -4.63

-4.67 -4.69

-5.08 -5.31

-5.32

-

LUMO

-2.87 -3.25

-3.26 -3.28

-2.67 -3.01

-3.05 -3.07

-2.06 -2.35

-2.36

-

LUMO+1

-1.40 -1.80

-1.81 -1.83

-1.20 -1.55

-1.61 -1.62

-0.33 -0.65

-0.68

-

LUMO+2

-1.25 -1.68

-1.68 -1.70

-1.05 -1.43

-1.48 -1.49

-0.31 -0.65

-0.67

-

gap

1.63 1.60

1.60 1.60

1.65 1.62

1.62 1.62

3.01 2.96

2.96 -

pentacene

HOMO-2

-6.00 -6.34

-6.36 -6.38

-5.81 -6.10

-6.14 -6.16

-6.67 -6.90

-6.91

-

HOMO-1

-5.41 -5.76

-5.78 -5.80

-5.23 -5.53

-5.57 -5.59

-6.16 -6.39

-6.40

-

HOMO

-4.29 -4.64

-4.64 -4.66

-4.11 -4.41

-4.45 -4.46

-4.81 -5.04

-5.04

-

LUMO

-3.14 -3.52

-3.52 -3.54

-2.94 -3.27

-3.31 -3.32

-2.39 -2.67

-2.68

-

LUMO+1

-1.87 -2.25

-2.25 -2.27

-1.67 -2.00

-2.05 -2.06

-0.87 -1.17

-1.18

-

LUMO+2

-1.30 -1.72

-1.72 -1.73

-1.10 -1.46

-1.51 -1.52

-0.38 -0.72

-0.73

-

gap

1.15 1.12

1.12 1.12

1.17 1.14

1.14 1.14

2.42 2.37

2.37 -

NPh3 HOMO-2

-6.05 -6.42

-6.45 -6.47

-5.88 -6.20

-6.25 -6.28

-6.94 -7.18

-7.20

-

HOMO-1

-6.05 -6.42

-6.44 -6.47

-5.88 -6.20

-6.25 -6.27

-6.94 -7.18

-7.20

-

HOMO

-4.41 -4.78

-4.80 -4.82

-4.25 -4.57

-4.62 -4.65

-5.17 -5.43

-5.45

-

LUMO

-1.27 -1.81

-1.85 -1.86

-1.06 -1.53

-1.62 -1.63

-0.20 -0.67

-0.75

-

LUMO+1

-1.22 -1.69

-1.73 -1.74

-1.02 -1.43

-1.51 -1.52

-0.17 -0.55

-0.62

-

LUMO+2

-1.22 -1.69

-1.73 -1.74

-1.02 -1.43

-1.51 -1.52

-0.17 -0.55

-0.62

-

gap

3.14 2.98

2.95 2.96

3.19 3.04

3.00 3.02

4.97 4.77

4.70 -

2CzPN

HOMO-2

-5.65 -6.01

-6.03 -6.06

-5.47 -5.78

-5.83 -5.86

-6.36 -6.61

-6.63

-

HOMO-1

-5.50 -5.86

-5.87 -5.90

-5.31 -5.63

-5.68 -5.70

-6.26 -6.51

-6.53

-

HOMO

-5.41 -5.77

-5.78 -5.80

-5.22 -5.54

-5.59 -5.61

-6.14 -6.40

-6.42

-

LUMO

-3.36 -3.70

-3.70 -3.72

-3.14 -3.43

-3.49 -3.50

-2.49 -2.72

-2.74

-

LUMO+1

-2.83 -3.22

-3.23 -3.25

-2.60 -2.93

-3.00 -3.01

-1.81 -2.10

-2.13

-

LUMO+2

-2.01 -2.46

-2.49 -2.51

-1.80 -2.20

-2.28 -2.29

-1.04 -1.41

-1.46

-

gap

2.04 2.07

2.08 2.09

2.08 2.11

2.10 2.11

3.66 3.67

3.68 -

CBP

HOMO-2

-5.34 -5.69

-5.71 -5.73

-5.16 -5.46

-5.51 -5.53

-6.07 -6.31

-6.32

-

HOMO-1

-5.01 -5.37

-5.38 -5.40

-4.83 -5.14

-5.18 -5.20

-5.77 -6.01

-6.03

-

HOMO

-4.81 -5.15

-5.16 -5.18

-4.63 -4.92

-4.97 -4.99

-5.52 -5.75

-5.77

-

LUMO

-2.30 -2.68

-2.70 -2.71

-2.08 -2.41

-2.47 -2.49

-1.35 -1.65

-1.67

-

LUMO+1

-1.67 -2.16

-2.19 -2.20

-1.43 -1.86

-1.93 -1.94

-0.68 -1.04

-1.08

-

LUMO+2

-1.63 -2.08

-2.11 -2.12

-1.43 -1.82

-1.89 -1.91

-0.68 -1.04

-1.08

-

gap

2.51 2.47

2.47 2.47

2.55 2.51

2.50 2.51

4.17 4.11

4.09 -

5

TABLE S3: Vertical S1 and T1 energies and singlet-triplet splittings, EST in eV, calculated using SCF with cc-pVTZ (`VTZ') and 6-31G* basis sets in NWChem, and a wavelet basis using the cubic scaling approach of
BigDFT. Calculations which did not converge within 200 iterations are denoted as `NC'.

naphthalene S1 T1 EST
anthracene S1 T1 EST
tetracene S1 T1 EST
pentacene S1 T1 EST
NPh3 S1 T1 EST
2CzPN S1 T1 EST
CBP S1 T1 EST

6-31G*
3.76 3.12 0.64
2.59 2.09 0.51
1.85 1.42 0.43
1.35 0.96 0.38
NC 3.20 NC
2.71 2.53 0.18
2.87 2.67 0.19

LDA VTZ
3.69 3.08 0.61
2.54 2.06 0.48
1.81 1.40 0.41
1.30 0.94 0.36
3.13 3.02 0.11
2.70 2.51 0.18
2.78 2.62 0.16

wavelet
3.67 3.11 0.56
2.53 2.09 0.44
1.79 1.42 0.38
1.29 0.96 0.34
3.10 2.99 0.10
2.70 2.53 0.17
2.77 2.61 0.16

6-31G*
3.87 3.00 0.86
2.69 2.00 0.69
1.94 1.35 0.59
1.43 0.90 0.53
NC 3.18 NC
2.74 2.49 0.25
2.89 2.65 0.25

PBE VTZ
3.79 2.97 0.82
2.64 1.98 0.66
1.90 1.33 0.57
1.39 0.88 0.51
3.15 3.02 0.13
2.73 2.48 0.25
2.83 2.59 0.25

wavelet
3.75 2.98 0.77
2.61 1.99 0.62
1.88 1.34 0.53
1.37 0.89 0.48
3.12 2.99 0.12
2.72 2.48 0.23
2.81 2.58 0.23

6-31G*
4.55 3.11 1.44
3.35 2.08 1.27
2.56 1.39 1.17
2.03 0.92 1.11
3.83 3.70 0.13
3.28 2.76 0.52
3.62 3.03 0.59

PBE0 VTZ
4.45 3.07 1.38
3.26 2.05 1.21
2.48 1.37 1.12
1.95 0.89 1.06
3.65 3.49 0.16
3.26 2.74 0.51
3.54 2.96 0.58

wavelet
4.41 3.10 1.32
3.24 2.07 1.16
2.46 1.39 1.07
1.93 0.91 1.02
3.65 3.46 0.19
3.58 2.77 0.81
3.81 2.97 0.83

6

TABLE S4: Vertical S1 and T1 energies and singlet-triplet splittings, EST, in eV, calculated using TDDFT with cc-pVTZ (`VTZ') and 6-31G* basis sets in NWChem, and a wavelet basis using the cubic scaling approach of
BigDFT. Calculations which did not converge within 200 iterations are denoted as `NC'.

naphthalene S1 T1 EST
anthracene S1 T1 EST
tetracene S1 T1 EST
pentacene S1 T1 EST
NPh3 S1 T1 EST
2CzPN S1 T1 EST
CBP S1 T1 EST

6-31G*
4.15 3.03 1.12
2.94 2.03 0.92
2.17 1.37 0.80
1.62 0.91 0.71
3.30 3.04 0.26
2.18 2.01 0.17
2.69 2.44 0.24

LDA VTZ
4.05 3.00 1.05
2.87 2.01 0.86
2.10 1.35 0.75
1.56 0.89 0.67
3.11 2.90 0.21
2.19 2.03 0.17
2.64 2.40 0.24

wavelet
4.14 3.07 1.07
2.95 2.06 0.89
2.17 1.40 0.77
1.63 0.93 0.70
3.10 2.88 0.22
2.22 2.05 0.17
2.65 2.41 0.24

6-31G*
4.16 2.82 1.33
2.95 1.87 1.09
2.18 1.23 0.95
1.63 0.77 0.86
3.34 2.98 0.36
2.21 2.02 0.19
2.72 2.42 0.30

PBE VTZ
4.06 2.80 1.26
2.88 1.86 1.03
2.10 1.35 0.75
1.58 0.76 0.82
3.17 2.91 0.26
2.23 2.05 0.19
2.68 2.38 0.30

wavelet
-
-
-
-
-
-
-

6-31G*
4.53 2.55 1.98
3.32 1.60 1.72
2.53 0.87 1.66
NC NC NC
4.03 3.05 0.98
2.95 2.48 0.47
3.50 2.61 0.89

PBE0 VTZ
4.41 2.55 1.86
3.22 1.61 1.62
2.43 0.88 1.55
NC NC NC
3.80 3.00 0.80
2.96 2.48 0.48
NC NC NC

wavelet
-
-
-
-
-
-
-

7

TABLE S5: Vertical S1 and T1 energies and singlet-triplet splittings, EST, in eV, calculated with T-CDFT using both the wavefunction (`WFN') and support function (`SF') approaches in BigDFT for different sized basis sets, as
defined in Table S1. SF values were calculated with Rloc = 4.76 °A.

LDA

PBE

WFN

SF

WFN

SF

I II III IV

I II III IV

I II III IV

I II III IV

naphthalene

S1 T1 EST

4.67 4.50 3.13 3.12 1.53 1.38

- 4.40 4.41 4.35 4.34 4.32 4.66 4.49 4.44 4.39 4.39 4.33 4.32 4.31 - 3.11 3.14 3.13 3.12 3.12 3.00 2.98 2.98 2.97 3.00 2.98 2.97 2.97 - 1.29 1.27 1.22 1.22 1.21 1.66 1.51 1.46 1.42 1.39 1.34 1.35 1.34

anthracene

S1 T1 EST

3.36 3.23 2.11 2.10 1.26 1.13

- 3.14 3.15 3.12 3.10 3.09 3.38 3.24 3.18 3.15 3.15 3.11 3.10 3.09 - 2.09 2.12 2.11 2.10 2.10 2.02 2.01 2.00 1.99 2.02 2.00 1.99 1.99 - 1.05 1.04 1.01 1.00 0.99 1.35 1.23 1.18 1.15 1.13 1.11 1.11 1.10

tetracene

S1 T1 EST

2.52 2.40 1.46 1.45 1.06 0.95

- 2.34 2.37 2.32 2.30 2.29 2.54 2.43 2.39 2.35 2.37 2.32 2.31 2.30 - 1.45 1.45 1.44 1.43 1.43 1.39 1.37 1.37 1.36 1.37 1.35 1.34 1.34 - 0.89 0.92 0.88 0.87 0.86 1.15 1.06 1.02 0.99 1.00 0.98 0.97 0.96

pentacene

S1 T1 EST
NPh3 S1 T1 EST

1.96 1.87 1.02 1.03 0.94 0.84
3.56 3.45 3.28 3.20 0.28 0.25

- 1.81 1.84 1.79 1.78 1.78 1.94 1.87 1.85 1.81 1.85 1.81 1.80 1.79 - 1.01 1.02 1.01 1.01 1.00 0.96 0.95 0.94 0.93 0.95 0.94 0.93 0.92 - 0.79 0.82 0.78 0.78 0.77 0.98 0.93 0.91 0.87 0.90 0.87 0.87 0.86
- 3.40 3.46 3.40 3.40 3.39 3.62 3.51 3.47 3.45 3.51 3.45 3.45 3.44 - 3.15 3.20 3.16 3.16 3.15 3.32 3.22 3.20 3.17 3.23 3.18 3.18 3.18 - 0.24 0.26 0.24 0.24 0.24 0.31 0.28 0.27 0.27 0.29 0.27 0.27 0.27

2CzPN

S1 T1 EST

3.52 3.40 3.30 3.12 0.22 0.28

- 3.32 3.53 3.37 3.37 3.33 3.61 3.43 3.39 3.32 3.55 3.39 3.40 3.35 - 3.09 3.31 3.13 3.13 3.11 3.33 3.15 3.12 3.11 3.32 3.14 3.16 3.12 - 0.23 0.22 0.24 0.25 0.23 0.28 0.28 0.26 0.21 0.24 0.25 0.24 0.23

CBP

S1 T1 EST

3.43 3.29 3.09 2.98 0.34 0.31

- 3.25 3.36 3.28 3.28 3.27 3.37 3.35 3.30 3.29 3.39 3.31 3.30 3.30 - 2.95 3.06 3.00 2.99 2.98 3.11 2.99 2.97 2.96 3.07 3.00 2.99 2.98 - 0.29 0.30 0.29 0.29 0.29 0.26 0.36 0.33 0.33 0.32 0.31 0.31 0.31

8

LUMO LReUfMO (eV)

LUMO LReUfMO (eV)

1.5

SFs (minimal)

1.0

0.5

0.0

3

4

5

Rloc Å

1.5 SFs (Rloc = 4.76 Å)

1.0

SFs + Virt.(minimal)

3

4

5

Rloc Å

SFs + Virt. (Rloc = 4.76 Å)

naphthalene anthracene tetracene pentacene NPh3 2CzPN CBP

0.5

0.0

1 N SF2/NmSFinimal3

4 1 N SF2/NmSFinimal3

4

2.0

S1

T1

1.5

1.0

0.5

0.0

0.0 0.5
LUMO

LRUefM1O.0(eV)

1.5

0.0 0.5
LUMO

LRUefM1O.0(eV)

1.5

(a)LDA

E ERef (eV)

LUMO LReUfMO (eV)

LUMO LReUfMO (eV)

1.5

SFs (minimal)

1.0

0.5

0.0

3

4

5

Rloc Å

1.5 SFs (Rloc = 4.76 Å)

1.0

SFs + Virt.(minimal)

3

4

5

Rloc Å

SFs + Virt. (Rloc = 4.76 Å)

naphthalene anthracene tetracene pentacene NPh3 2CzPN CBP

0.5

0.0

1 N SF2/NmSFinimal3

4 1 N SF2/NmSFinimal3

4

2.0

S1

T1

1.5

1.0

0.5

0.0

0.0 0.5
LUMO

LRUefM1O.0(eV)

1.5

0.0 0.5
LUMO

LRUefM1O.0(eV)

1.5

(b)PBE

E ERef (eV)

FIG. S2: Convergence of the LUMO energy for SF-based calculations for both ground state SFs (`SFs') and when
also optimizing with a select number of virtual states (`SFs + Virt.'). Energies are given relative to the cubic scaling
result. Convergence is shown with respect to localization radius, Rloc for a minimal SF basis [top], and with respect to basis set size for with Rloc = 4.76 °A [centre]. Also depicted is the correlation between the error in the LUMO and the error in the corresponding T-CDFT-calculated energies across all SF basis sets, relative to the reference energy,
Eref , as calculated using the largest wavefunction basis set [bottom].

9

E ERef (eV)

E ERef (eV)

0.4 0.3 0.2 0.1 0.0 0.1
0.4 0.3 0.2 0.1 0.0 0.1
0.4 0.3 0.2 0.1 0.0 0.1
3

S1 (minimal SF)

T1 (minimal SF)

EST (minimal SF)

4

5

Rloc (Å)

S1 (SF, Rloc = 4.76 Å) T1 (SF, Rloc = 4.76 Å)

S1 (wavelet) T1 (wavelet)

naphthalene anthracene tetracene pentacene NPh3 2CzPN CBP

EST (SF, Rloc = 4.76 Å)

EST (wavelet)

1

N bas2is/Nmbainsiismal 3

4

1

N bas2is/Nmbainsiismal 3

4

(a)LDA

E ERef (eV)

E ERef (eV)

E ERef (eV)

0.4 0.3 0.2 0.1 0.0 0.1
0.4 0.3 0.2 0.1 0.0 0.1
0.4 0.3 0.2 0.1 0.0 0.1
3

S1 (minimal SF)

T1 (minimal SF)

EST (minimal SF)

4

5

Rloc (Å)

S1 (SF, Rloc = 4.76 Å) T1 (SF, Rloc = 4.76 Å)

S1 (WFN) T1 (WFN)

naphthalene anthracene tetracene pentacene NPh3 2CzPN CBP

EST (SF, Rloc = 4.76 Å)

EST (WFN)

1

N bas2is/Nmbainsiismal 3

4

1

N bas2is/Nmbainsiismal 3

4

(b)PBE

E ERef (eV)

FIG. S3: Convergence of T-CDFT calculations for S1, T1 and EST, for calculations based on both a support function (`SF') and wavefunction (`WFN') basis. Energies are given relative to the reference energy, Eref , calculated
using the largest employed basis set. Depicted is the convergence with respect to localization radius, Rloc, for a minimal SF basis [left], with respect to basis set size for the SF approach with Rloc = 4.76 °A [centre], and with
respect to basis set size for the WFN approach [right].

10

1.2

S1

1.0

T1

E T CDFT E TDDFT (eV)

0.8

0.6

0.4

0.2

0.00.4

0.6

0.8

1.0

T

FIG. S4: Plot of the difference between T-CDFT and TDDFT energies vs. T, the spatial overlap, where both calculations employ the LDA functional. T-CDFT calculations are those corresponding to the largest wavefunction
basis set while TDDFT calculations employ cc-pVTZ.

1 S. Goedecker, M. Teter, and J. Hutter, Phys. Rev. B 54, 1703 (1996). 2 C. Hartwigsen, S. Goedecker, and J. Hutter, Phys. Rev. B 58, 3641 (1998). 3 A. Willand, Y. O. Kvashnin, L. Genovese, A. Va´zquez-Mayagoitia, A. K. Deb, A. Sadeghi, T. Deutsch, and S. Goedecker,
J. Chem. Phys. 138, 104109 (2013).

