arXiv:2106.01090v1 [math.NA] 2 Jun 2021

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS: ASYMMETRIC SPATIAL OPERATORS
ROB STEVENSON, JAN WESTERDIEP
ABSTRACT. We consider a minimal residual discretization of a simultaneous spacetime variational formulation of parabolic evolution equations. Under the usual `LBB' stability condition on pairs of trial- and test spaces we show quasi-optimality of the numerical approximations without assuming symmetry of the spatial part of the differential operator. Under a stronger LBB condition we show error estimates in an energy-norm which are independent of this spatial differential operator.
1. INTRODUCTION
This paper is about the numerical solution of parabolic evolution equations in a simultaneous space-time variational formulation. Compared to classical timestepping schemes, simultaneous space-time methods are much better suited for a massively parallel implementation (e.g. [NS19, vVW20]), allow for local refinements in space and time (e.g. [SY18, GS19, SvVW21, vVW21]), and produce numerical approximations from the employed trial spaces which are quasi-best.
The standard bilinear form that results from a space-time variational formulation is non-coercive, which makes it difficult to construct pairs of discrete trial and test spaces that inherit the stability of the continuous formulation. For this reason, in [And13] R. Andreev proposed to use minimal residual discretizations. They have an equivalent interpretation as Galerkin discretizations of an extended self-adjoint, but indefinite, mixed system having as secondary variable the Riesz lift of the residual of the primal variable w.r.t. the PDE.
For pairs of trial spaces that satisfy a Ladyshenskaja­Babuska­Brezzi (LBB) condition, it was shown that w.r.t. the norm on the natural solution space, being an intersection of Bochner spaces, the Galerkin solutions are quasi-best approximations from the selected trial spaces. This LBB condition was verified in [And13] for `full' and `sparse' tensor products of various finite elements spaces in space and time. The sparse tensor product setting was then generalized in [SvVW21, Proposition 5.1] to allow for local refinements in space and time whilst retaining (uniform) LBB stability.
A different minimal residual formulation of first order system type was introduced in [FK21], see also [GS21]. Here the various residuals are all measured in L2-norms, meaning that they do not have to be introduced as separate variables, and the resulting bilinear form is coercive.
Date: June 3, 2021. 2020 Mathematics Subject Classification. 35K20, 41A25, 65M12, 65M15, 65M60, 35B25. Key words and phrases. Parabolic PDEs, space-time variational formulations, quasi-best approximations, stability, robustness. The second author has been supported by the Netherlands Organization for Scientific Research (NWO) under contract. no. 613.001.652.
1

2

ROB STEVENSON, JAN WESTERDIEP

Closer in spirit to [And13] are the space-time methods presented in [Ste15,

LMN16, BEEN19], in which error bounds are presented w.r.t. mesh-dependent

norms. In [Dev20, SZ20] space-time variational methods are presented that lead to

coercive

bilinear

forms

based

on

fractional

Sobolev

norms

of

order

1 2

.

A

first

order

space-time DPG formulation of the heat equation is presented in [DS20].

A restriction imposed in [And13], as well as in the other mentioned references

apart from [BEEN19, GS21], is that the spatial part of the PDO is not only coercive

but also symmetric. In [SW20] we could remove the symmetry condition for the

analysis of a related Brézis­Ekeland­Nayroles (BEN) ([BE76, Nay76]) formulation

of the parabolic PDE. In the current work, we prove that also for the minimal

residual (MR) method the symmetry condition can be dropped. So for both MR

and BEN we show that under the aforementioned LBB condition the Galerkin ap-

proximation are quasi-optimal, where the bound on the error in the numerical

approximation for BEN improves upon the one from [SW20].

The error bounds for both MR and BEN degrade for increasing asymmetry. This

is not an artefact of the theory but is confirmed by numerical experiments. Under

a stronger LBB condition on the pair of trial spaces, however, we will prove that

the MR and BEN approximations are quasi-best w.r.t. a continuous, i.e., `mesh-

independent', energy-norm, uniformly in the spatial PDO.

We present numerical tests for the evolution problem governed by the simple

PDE t - 2x + x + eId on (0, 1)2 with initial and boundary conditions, where e is either 0 or 1. For the case that homogeneous Dirichlet boundary conditions are

prescribed at the outflow boundary x = 1, the results for very small  illustrate

that quasi-optimal approximations do no necessarily mean accurate approxima-

tions. Indeed the error in the computed solution is large because of the unresolved

boundary layer. The minimization of the error in the energy norm of least squares

type causes a global spread of the error along the streamlines. We tackled this

problem by imposing these boundary conditions only weakly.

1.1. Organization. In Sect. 2 we recall the well-posed space-time variational formulation of the parabolic problem and study its conditioning. Under the usual LBB condition, in Sect. 3 we show quasi-optimality of the MR method without assuming symmetry of the spatial differential operator. A similar result is shown for BEN in Sect. 4. Known results concerning the verification of this LBB condition are summarized in Sect. 5, together with results about optimal preconditioning.
In Sect. 6 we equip the solution space with an energy norm, and, under a stronger LBB condition, show error estimates for MR and BEN which are independent of the spatial differential operator. We present an a posteriori error estimator which, under an even stronger LBB condition, is efficient and, modulo a date-oscillation term, is reliable.
In Sect. 7 we apply the general theory to the example of the convection-diffusion problem. We give pairs of trial- and test spaces which satisfy the 2nd and 3rd mentioned LBB conditions. Finally, in Sect. 8 we present numerical results for the MR method in the simple case of having a one-dimensional spatial domain. To solve the problems caused by an unresolved boundary layer, we modify the method by imposing a boundary condition weakly.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

3

1.2. Notations. In this work, by C D we will mean that C can be bounded by a multiple of D, independently of parameters which C and D may depend on. Obviously, C D is defined as D C, and C D as C D and C D.
For normed linear spaces E and F, by L(E, F) we will denote the normed linear space of bounded linear mappings E  F, and by Lis(E, F) its subset of boundedly invertible linear mappings E  F. We write E  F to denote that E is continuously embedded into F. For simplicity only, we exclusively consider linear spaces over the scalar field R.

2. WELL-POSED VARIATIONAL FORMULATION

Let V, H be separable Hilbert spaces of functions on some "spatial domain" such that V  H with dense embedding. Identifying H with its dual, we obtain the Gelfand triple V  H H  V . We use ·, · to denote both the scalar product on H × H as well as its unique extension to the duality pairing on V × V or V × V , and denote the norm on H by · .
For a.e.
t  I := (0, T),

let a(t; ·, ·) denote a bilinear form on V × V such that for any ,   V, t  a(t; , ) is measurable on I, and such that for some  R, for a.e. t  I,

(2.1)

|a(t; , )|  V  V (,   V) (boundedness),

(2.2)

a(t; , ) + , 



2 V

(  V) (Gårding inequality).

With A(t)  Lis(V, V ) being defined by (A(t))() := a(t; , ), given a forc-
ing function g and an initial value u0, we are interested in solving the parabolic initial value problem to finding u such that

(2.3)

du dt

(t)

+

A(t)u(t)

=

g(t)

(t  I),

u(0) = u0.

In a simultaneous space-time variational formulation, the parabolic PDE reads as finding u from a suitable space of functions X of time and space such that

(Bw)(v) :=

I

dw dt

(t),

v(t)

+ a(t; w(t), v(t))dt =

g(t), v(t) dt =: g(v)
I

for all v from another suitable space of functions Y of time and space. One possibil-

ity to enforce the initial condition is by testing it against additional test functions.

A proof of the following result can be found in [SS09], cf. [DL92, Ch.XVIII, §3] and

[Wlo82, Ch. IV, §26] for slightly different statements.

Theorem 2.1. With X := L2(I; V)  H1(I; V ), Y := L2(I; V), under conditions (2.1) and (2.2) it holds that
B  Lis(X, Y × H), 0
where for t  I¯, t : u  u(t, ·) denotes the trace map. That is, assuming g  Y and u0  H, finding u  X such that

(2.4)

B 0

u=

g u0

is a well-posed simultaneous space-time variational formulation of (2.3).

4

ROB STEVENSON, JAN WESTERDIEP

With

u~(t)

:=

u(t)e-

t,

(2.3)

is

equivalent

to

du~ dt

(t)

+

(

A(t)

+

Id)u~(t) = g(t)e- t

(t  I), u~(0) = u0. Since ((A(t) + Id))()



2 V

,

w.l.o.g.

we

will

always

assume that, besides (2.1), (2.2) is valid for = 0, i.e., for a.e. t  I,

(2.5)

a(t; , )



2 V

(  V)

(coercivity).

We define A, As  Lis(Y, Y ), Aa  L(Y, Y ), and C, t  L(X, Y ) by

(Aw)(v) := a(t; w(t), v(t)) dt,
I

As

:=

1 2

(

A

+

A

),

Aa

:=

1 2

(A

-

A

),

t := B - A, C := B - As = t + Aa,

and equip Y with `energy'-scalar product ·, · Y := (As·)(·), and norm

v Y := (Asv)(v).

being, thanks to (2.1) and (2.5), equivalent to the standard norm on Y. Equipping Y with the resulting dual norm, As  Lis(Y, Y ) is an isometric isomorphism, and so for f  Y we have

f (A-s 1 f ) = (As A-s 1 f )(A-s 1 f ) =

A-s 1 f

2 Y

=

f

2 Y

.

For some constant   1, we equip X with norm

· X :=

·

2 Y

+

t ·

2 Y

+

T ·

2 + ( - 1) 0 ·

2,

being, thanks to X  C(I; H), equivalent to the standard norm on X. In addition, we define the energy-norm on X by

||| · |||X :=

B·

2 Y

+

0 ·

2,

which, thanks to Theorem 2.1, is indeed a norm on X.

Proposition 2.2. With  := Aa L(Y,Y ), for 0 = w  X it holds that

1

+

 2

+

2 + 4

-1


|||w|||2X

w

2 X



1

+

 2

+

so that, in particular, both norms are equal when Aa = 0.

2 + 4 ,

Proof. Using that for w, v  X,

((t + t + 00)w)(v) =

I

dw dt

(t),

v(t)

+

w(t),

dv dt

(t)

dt +

w(0), v(0)

=

d I dt

w(t), v(t)

dt +

w(0), v(0)

= (TTw)(v),

we find that

(2.6)

B A-s 1B + 00 = (C + As)A-s 1(C + As) + 00 = C A-s 1C + As + C + C + 00 = C A-s 1C + As + t + t + 00 = C A-s 1C + As + TT + ( - 1)00.

For w  X,

(C A-s 1Cw)(w) = (Cw)(A-s 1Cw) =

(t + Aa)w

2 Y

(

tw

Y

+

w

Y )2 ,

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

5

and so, for any  = 0, Young's inequality shows that

Bw

2 Y

+

0w

2=

(C As-1C + As + TT + ( - 1)00)(w) (w)

 (1 + 2)

tw

2 Y

+ ((1 + -2)2 + 1)

w

2 Y

+

Tw 2 + ( - 1) 0w 2.



Solving

(1

+

2)

=

(1

+

-2)2

+

1

gives

1

+

2

=

1

+

 2

+

2 + 4 , showing

one of the bounds of the statement.

From

(t + Aa)w

2 Y

(

tw

Y

-

w

Y)2  (1 - 2)

tw

2 Y

+ (1 - -2)2

w

2 Y

again by Young's inequality, by solving 2 from 1 - 2 = (1 - -2)2 + 1 the other

bound follows.

Remark 2.3. Because · Y is defined in terms of the symmetric part As of the

spatial differential operator A,  = Aa L(Y,Y ) is a measure for the relative asym-

metry of the operator A. Indeed

Aa L(Y,Y ) =

A-s

1 2

Aa

As-

1 2

L(L2(I;H),L2(I;H)) =

( As-

1 2

Aa

A-s 1

Aa

A-s

1 2

)

1 2

=

(A-s 1

Aa

A-s 1

Aa)

1 2

,

where

we

used

that

Aa

= -Aa.

3. MINIMAL RESIDUAL (MR) METHOD

Let (X, Y) a family of closed, proper, non-zero subspaces of X and Y, respectively. For   , let EX and EY denote the trivial embeddings X  X and Y  Y that we often write for clarity. We assume that

(3.1)

X  Y (  ),

(3.2)

t

:=

inf

inf

 {wX : t EX w=0}

EY t EX w Y t EX w Y

> 0.

Furthermore, for efficiency reasons we assume to have available a KY = KY  Lis(Y , Y) (a `preconditioner'), such that for some constants 0 < r  R < ,

(3.3)

((KY )-1v)(v)  [r, R] (  , v  Y), (EY AsEY v)(v)

or, equivalently,

f (KY f ) f ((EY As EY )-1 f )

 [R- 1, r-1] ( 

, f

 Y

).

Noticing that

f

2 Y

= f ((EY AsEY )-1 f ), the expression

· KY := (·)(KY ·)
defines an equivalent norm on Y , and our Minimal Residual approximation u  X of the solution u  X of (2.4) is defined as

(3.4)

u := argmin
wX

EY (BEX w - g)

2 KY

+



0EX w - u0

2,

for some constant   1. Later we will see that, thanks to (3.2) and (3.3),

(3.5)

inf

sup

(BEX w)(EY v1) +  0EX w, v2 > 0

0=wX (v1,v2)Y×H

((KY )-1v1)(v1) +  v2 2

6

ROB STEVENSON, JAN WESTERDIEP

(even uniformly in   )1 which implies that (3.4) has a unique solution. The numerical approximation (3.4) was proposed in [And13]2, and further investigated in [SW20]. In both these references the analysis of the MR method was restricted to the case that Aa = 0. The introduction of the parameter   1 allows to appropriately weight both terms in the least squares minimization.
The solution u of the MR problem is the solution of the resulting Euler­Lagrange equations, which read as

(3.6) (EX B EY KY EY BEX + EX 00EX )u = EX B EY KY EY g + EX 0u0, as also the second component of the solution (µ, u)  Y × X of

(3.7)

(KY )-1

EY BEX

EX B EY -EX 00EX

µ u

=

EY g -EX 0u0

,

being a useful representation when no efficient preconditioner is available and one
has to resort to (KY )-1 = EY AsEY . With the "projected" or "approximate" (because generally Y = Y) trial-to-test

operator T  L(X, Y × H) defined by

(3.8) ((KY )-1Tw)(v1) +  Tw, v2 = (Bw)(EY v1) +  0u, v2 ((v1, v2)  Y × H),

and "projected" or "approximate" optimal test space Z := ran T|X , a third equivalent formulation of (3.4) (see e.g. [DG11], [BS14, Prop. 2.2], [DG14]) is finding

u  X which solves the Petrov-Galerkin system

(3.9) (BEX u)(EY v1) +  0EX u, v2 = g(EY v1) +  u0, v2 ((v1, v2)  Z).

Note that (3.9) avoids the `normal equations' (3.6). It will allow us to derive a

quantitatively sharp estimate for the error in u. From (3.3) and (3.5), one infers

that sup0=wX

Tw Y×H wX

> 0, so that, thanks to X being closed, Z is a closed

subspace of Y × H. We orthogonally decompose Y × H into Z and (Z), where

here we equip Y with inner product ((KY )-1·)(·). From (3.8) one infers that for w  X and (v1, v2)  (Z), it holds that (Bw)(v1) +  0u, v2 = 0, and so

(3.10)

sup (BEX w)(EY v1) +  0EX w, v2 = sup (BEX w)(EY v1) +  0EX w, v2 .

(v1,v2)Y×H ((KY )-1v1)(v1) +  v2 2 (v1,v2)Z ((KY )-1v1)(v1) +  v2 2

Theorem 3.1. Under conditions (3.1), (3.2), and (3.3), the solution u  X of (3.6) exists uniquely, and satisfies

u - u X 

max( R ,1)

1+

1 2

 2+ 2+4

min(r

,1)

1 2

(t )2+2+1-

((t )2+2+1)2-4(t )2

inf u - w X.
wX

(In particular, u is the best approximation to u from X when t = r = R = 1 and  = 0.)

1This follows by combining (3.13), (3.15), and (3.16).

2In [And13], the norm

0 EX w - u0

reads as sup0=zZ

0 EX w-u0,z z

for some H  Z  ran 0|X

which generalization seems not very helpful.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

7

Remarks 3.2. One can verify that

1+

1 2

 2+ 2+4

1 2

(t )2+2+1-

((t )2+2+1)2-4(t )2

1+

1 2

 2+ 2+4

t





1 2

3, 1 ,

which clarifies the behaviour of the bound from Theorem 3.1 in terms of  and t . For  = 0 (and  = 1), the estimate from Theorem 3.1 equals the one found in
[SW20, Thm. 3.7 & Rem. 3.8].
Proof. Let u be the solution of (2.4), i.e., g = Bu and u0 = 0u. The mapping P  L(X, X) from u to the solution u  X of (3.4) or, equivalently, (3.6) or (3.9), is a projector onto X which, by our assumption X  {0, X}, is unequal to 0 or Id. Consequently P L(X,X) = Id - P L(X,X) ([Kat60, XZ03]), and

(3.11)

u - u X = 

(Id - P)u X = inf (Id - P)(u - w) X
wX
P L(X,X) inf u - w X.
wX

To bound

P L(X,X) = sup0=wX

Pw X wX

,

given

w



X, let EX w

:= Pw.

Using (3.3), (3.10), (3.9), and Proposition 2.2 we estimate

(3.12)

sup
(v1 ,v2 )Y × H

(BEX w)(EY v1) +  0EX w, v2

EY v1

2 Y

+



v2

2

2



1 min(r ,1)

sup

(v1 ,v2 )Y × H

(BEX w)(EY v1) +  0EX w, v2 ((KY )-1v1)(v1) +  v2 2

2

=

1 min(r ,1)

sup

(v1,v2)Z

(BEX w)(EY v1) +  0EX w, v2 ((KY )-1v1)(v1) +  v2 2

2

=

1 min(r ,1)

sup

(v1,v2)Z

(Bw)(EY v1) +  0w, v2 2 ((KY )-1v1)(v1) +  v2 2



max( R ,1) min(r ,1)

sup
(v1 ,v2 )Y × H

(Bw)(v1) +  0w, v2

v1

2 Y

+



v2

2

2

=

max( R ,1) min(r ,1)

|||w|||2X



max( R ,1) min(r ,1)

1

+

1 2

2 + 

2 + 4

w

2 X

.

8

ROB STEVENSON, JAN WESTERDIEP

On the other hand,

sup
(v1 ,v2 )Y × H

(BEX w)(EY v1) +  0EX w, v2

EY v1

2 Y

+



v2

2

2

= sup
(v1 ,v2 )Y × H

(AsEY (EY AsEY )-1EY BEX w)(EY v1) +  0EX w, v2

EY v1

2 Y

+



v2

2

2

(3.13) = sup
(v1 ,v2 )Y × H

EY (EY AsEY )-1EY BEX w, EY v1 Y +  0EX w, v2 2

EY v1

2 Y

+



v2

2

=

EY (EY As EY )-1EY BEX w

2 Y

+



0EX w

2

= (AsEY (EY AsEY )-1EY BEX w)(EY (EY AsEY )-1EY BEX w)

+ (EX 00EX w)(w)

= (EY B EY (EY AsEY )-1EY BEX + EX 00EX )w (w).

Using (3.1), we write EX = EY F with F denoting the trivial embedding X  Y. Using B = C + As and C + C + 00 = TT, similar to (2.6) we infer that
(3.14) EX B EY (EY AsEY )-1EY BEX + EX 00EX
= F EY B EY (EY AsEY )-1EY BEY + EY 00EY F

= F EY C EY (EY AsEY )-1EY CEY + EY AsEY + EY (T T + ( - 1)00)EY F

= EX C EY (EY AsEY )-1EY CEX + EX AsEX + EX (T T + ( - 1)00)EX . We conclude that for any   (0, 1],

(3.15)

(EX B EY (EY AsEY )-1EY BEX + EX 00EX )w (w)

=

EY CEX w

2 Y

+

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2

 ( EY tEX w Y -  EX w Y)2 +

EX w

2 Y

+

T EX w

2

+ ( - 1) 0EX w 2

 (1 - 2)

EY t EX w

2 Y

+

(1 - -2)2 + 1

EX w

2 Y

+

T EX w

2

+ ( - 1) 0EX w 2

(3.2)
 (1 - 2)(t )2

t EX w

2 Y

+

(1 - -2)2 + 1

EX w

2 Y

+

T EX w

2

+ ( - 1) 0EX w 2

 min (1 - 2)(t )2, (1 - -2)2 + 1

EX w

2 X

,

where we applied Young's inequality. Solving (1 - 2)(t )2 = (1 - -2)2 + 1 for  yields

(3.16)

(1 - 2)(t )2

=

1 2

(t )2 + 2 + 1 -

((t )2 + 2 + 1)2 - 4(t )2 > 0.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

9

Recalling (3.11) and

P

L(X,X) = sup0=wX

w w

X X

,

the

proof

is

completed

by

com-

bining (3.12), (3.13), and (3.15).

4. BRÉZIS­EKELAND­NAYROLES (BEN) FORMULATION

The minimizer u  X of

B w-  0

g  u0

unique solution of (2.4), is the unique solution of

2
, that is equal to the
Y ×H

(4.1)

(B A-s 1B + 00)u = B A-s 1g + 0u0.

As we have seen in (2.6), this system is equivalent to

(4.2)

(C A-s 1C + As + TT + ( - 1)00)u = (Id + C A-s 1)g + 0u0,

showing that u is the second component of the pair (, u)  Y × X which solves

(4.3)

As C

C -(As + TT + ( - 1)00)

 u

=

g -(g + 0u0)

.

Notice that  = u. The formulation (4.2) of the parabolic equation can alternatively be derived
from the application of the Brézis­Ekeland­Nayroles variational principle ([BE76, Nay76], cf. also [And12, §3.2.4]), which generalizes beyond the linear, Hilbert space setting.
Given   , we consider the Galerkin discretization of (4.3), i.e., (4.4)

EY As EY (EY CEX )

EY CEX -EX (As + TT + ( - 1)00)EX

 u¯

=

EY g -EX (g + 0u0)

or, equivalently

(4.5) EX C EY (EY AsEY )-1EY C + As + TT + ( - 1)00 EX u¯ = EX C EY (EY AsEY )-1EY g + g + 0u0 .

Remark 4.1. Assuming X  Y ((3.1)) and KY = (EY AsEY )-1, it holds that u¯ = u, i.e., the solutions of BEN and MR are equal. Indeed, (3.14) shows that in this case the operator at the left-hand side of (4.5) equals the operator in (3.6), and from EX AsEY (EY AsEY )-1EY = EX when X  Y one deduces that also the right-hand sides agree.
In contrast to MR, with BEN, however, it is not possible to replace (EY AsEY )-1 by a general preconditioner as in (3.7)-(3.6) and still obtain a quasi-best approxi-
mation to (, u) from Y × X. This can be understood by noticing that replacing A-s 1 in (4.2) by another operator changes the solution, whereas this is not the case in (4.1). So for the iterative solution of BEN one has to operate on the saddle point system (4.4) instead of on a symmetric positive definite system as with MR, see (3.6).
On the other hand, with BEN it is not needed that X  Y, as we will see below.

The applicability of BEN for the case that Aa = 0 was already demonstrated in [SW20]. The following result gives a quantitatively better error bound.

10

ROB STEVENSON, JAN WESTERDIEP

Theorem 4.2. Under the sole condition (3.2), the solution u¯  X of (4.5) exists

uniquely, and satisfies

u - u¯ X 

1+

1 2


2+ 2+4 inf
wX

1 2

(t )2+2+1-


u - w X+ 1+2 inf
vY ((t )2+2+1)2-4(t )2

u-v Y .

Proof. With g = Bu and u0 = 0u, using B = C + As and 00 = TT - (C + C), the right-hand side of (4.5) reads as

EX C EY (EY AsEY )-1EY (C + As) + As + TT + ( - 1)00 - C u = EX C EY (EY AsEY )-1EY C + As + TT + ( - 1)00
+ C EY (EY AsEY )-1EY As - Id u.
So with G() := C EY (EY AsEY )-1EY C + As + TT + ( - 1)00, it holds that u  EX u¯ = EX (EX G()EX )-1EX G() + C EY (EY AsEY )-1EY As - Id u,

where we already used that EX G()EX is invertible, which will be verified below. Since EX (EX G()EX )-1EX G()  L(X, X) and EY (EY AsEY )-1EY As  L(Y, Y) are projectors onto X and Y, respectively, the latter being orthogonal, for any v  Y and w  X it holds that
u - u¯ =(Id - EX (EX G()EX )-1EX G())(u - EX w)
+ EX (EX G()EX )-1EX C Id - EY (EY AsEY )-1EY As (u - EY v)
and so, also using Y  {0, Y},

u - u¯ X  (EX G()EX )-1 L(X ,X)

G() L(X,X ) inf u - w X
wX

For w  X, we have

+ C L(X,Y ) inf u - v Y .
vY

(G()w)(w) =

EY Cw

2 Y

+

w

2 Y

+

Tw 2 + ( - 1) 0w 2



Cw

2 Y

+

w

2 Y

+

Tw 2 + ( - 1) 0w 2

= ((C A-s 1C + As + TT + ( - 1)00)w)(w) =



1

+

1 2

2 + 

2 + 4

w

2 X

Bw

2 Y

+

0w

2

by Proposition 2.2. Since (G()·)(·) is symmetric semi-positive-definite, we con-

clude that

G()

L(X,X

)



1+

1 2

2 + 

2 + 4 .

For w  X, one deduces

(G()EX w)(EX w) =

EY CEX w

2 Y

+

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2



1 2

(t )2 + 2 + 1 -

((t )2 + 2 + 1)2 - 4(t )2

EX w

2 X

by following the lines starting at the second line of (3.15), in particular showing that EX G()EX is invertible.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

11

 Finally, for w  X, Cw Y  tw Y +  w Y  1 + 2 w X. The theorem follows by combining the above estimates.

5. INF-SUP CONDITION (3.2), I.E., t > 0, AND CONDITION (3.3)

By the boundedness and coercivity assumptions (2.1) and (2.5), it holds that

·Y

· L2(I;V). Since with

(5.1)

 := (X, Y) :=

inf

sup

{wX : tw=0} 0=vY

I tw, v dt

,

tw L2(I;V ) v L2(I;V)

consequently it holds that t inf , we will summarize some known results about settings for which inf  > 0 has been demonstrated.
In the final subsection of this section we will briefly comment on the construc-
tion of preconditioners at the Y-side, i.e. condition (3.3), and the X-side. The pre-
conditioner KY has its application for the reduction of the saddle-point system (3.7) (reading (KY )-1 as EY AsEY ) to the elliptic system (3.6), and as an ingredient for building a preconditioner for the saddle-point system (4.4), whereas KX can be applied for preconditioning (3.6), and as the other ingredient to construct a
preconditioner for (4.4).

Since inf-sup conditions of the type  > 0, or inf  > 0, will be encountered more often in this work, in an abstract setting we recall their relation with
existence of certain Fortin interpolators, see [DSW21, Thm. 3.10].

Proposition 5.1. Let A and B be closed subspaces of Hilbert spaces A and B, and let F  L(A, B ). Let

(5.2)

Q  L(B, B) with ran Q  B and (Id - Q )FA = 0.

Then G := inf{aA : Fa=0} sup0=bB

(Fa)(b) Fa B b B



Q

-1 L(B,B)

.

Conversely, if G

>

0,

then there exists a Q as in (5.2), which is a projector, and Q L(B,B)  2 + 1/G.

5.1. `Full' tensor product case. Concerning the verification of inf  > 0, we start with the easy case of X and Y being `full' tensor products of approximation

spaces in time and space (as opposed to sparse tensor products, see below). With
Yt := L2(I) and Xt := H1(I), for Z  {X, Y} let (Zt) and (Zx) be families of closed subspaces of Zt and V, respectively, and let Z := Zt  Zx. Assuming that

(5.3)

t :=

inf

sup

{wXt : w =0} 0=vYt

w

I w vdt L2(I) v L2(I)

1,

(5.4)

x := inf sup
0=wXx 0=vYx

w, v wV vV

1,

a tensor product argument shows that

 = tx 1.

Obviously,

(5.3) is true when

d dt

Xt



Yt,

which however is not a necessary

condition. For example, when Xt is the space of continuous piecewise linears

w.r.t. some partition of I, and Yt is the space of continuous piecewise linears w.r.t. a

12

ROB STEVENSON, JAN WESTERDIEP

once dyadically refined partition, an easy computation ([And13, Prop. 6.1]) shows that t  3/4.
Considering, for a domain   Rd and   , H = L2() and V = H01,() := {v  H1() : v| = 0}, H1()-stability of the L2()-orthogonal projector onto Lagrange finite element spaces Xx = Yx is an extensively studied subject. In view of Proposition 5.1, taking F to be the Riesz map H  H viewed as a mapping V  V , this stability implies (5.4). For finite element spaces w.r.t. shape regular quasi-uniform partitions into, say, d-simplices, where  is the union of faces of T  T , this stability follows easily from direct and inverse estimates. It is
known that this stability holds also true for (shape regular) locally refined par-
titions when they are sufficiently mildly graded. In [GHS16], it is shown that in
two space dimensions the meshes generated by newest vertex bisection satisfy this
requirement, see also [DST20] for extensions.

5.2. Sparse tensor product case. As shown in [And13, Prop. 4.2], these results for

full tensor products extend to sparse tensor products. When (Zt) and (Zx) are nested sequences of closed subspaces Zt0  Zt1  · · ·  Zt, Zx0  Zx1  · · ·  V which satisfy (5.3)­(5.4), then for Zn := {0nt+nxn} Ztnt  Zxnx it holds that

n



min
0nt n

tnt

min
0nx n

tnx

1.

5.3. Time-slab partition case. Another extension of the full tensor product case is
given by the following. Let (X¯ , Y¯ )¯ be a family of pairs of closed subspaces of X and Y for which

¯

:=

inf inf

sup

¯ {wX¯  : tw=0} 0=vY¯ 

I tw, v dt

> 0.

w L2(I;V ) v L2(I;V)

Then if, for   , X and Y are such that for some finite partition I = ([ti-1, ti])i

of

I,

with

Gi (t)

:=

ti-1

+

t T

(ti

-

ti-1 )

and

arbitrary

i



¯

it

holds

that

X  {u  X : u|(ti-1,ti)  Gi  X¯ i },

Y  {v  L2(I; V) : v|(ti-1,ti)  Gi  Y¯ i },

then   ¯ > 0 as one easily verifies by writing

I

du dt

,

v

dt

=

i

ti ti-1

du dt

,

v

dt.

An example of this `time-slab partition' setting will be given in Sect. 7. Thinking of

the X¯  as being finite element spaces, notice that the condition X  X will require

that possible `hanging nodes' on the interface between different time slabs do not

carry degrees of freedom.

5.4. Generalized sparse tensor product case. Finally, we informally describe a
`generalized' sparse tensor product setting that allows for local refinements driven by
an a posteriori error estimator. For Z  {X, Y}, let the nested sequences of closed
subspaces Zt0  Zt1  · · ·  Zt, Zx0  Zx1  · · ·  V be equipped with hierarchical bases, meaning that the basis for Zti (analogously Zxi ) is inductively defined as the basis for Zti-1 plus a basis for a complement space of Zti-1 in Zti . The level of the functions in the latter basis is defined as i.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

13

Let us consider the usual case that the diameter of the support of a hierarchical basis function with level i is 2-i, and let us assign to each basis function  on level i > 0 one (or a few) parents with level i - 1 whose supports intersect the
support of . We now let (Z) be the collection of all spaces that are spanned by sets of product hierarchical basis functions, which sets are downward closed (or lower) in the sense that if a product of basis functions is in the set, then so are all their parents in both directions. Note that the sparse tensor product spaces
{0nt+nxn} Ztnt  Zxnx are included in this collection, but that it contains many more spaces.
Under conditions on the hierarchical bases for Zt0  Zt1  · · ·  Zt for Z  {X, Y}, which should be of wavelet-type, in [SvVW21] it is shown that to any X
one can assign a Y with dim Y dim X, such that  1 holds.

5.5. Preconditioners. Moving to condition (3.3), obviously we would like to construct KY such that it is not only a uniform preconditioner, i.e., it satisfies (3.3), but also that its application can be performed in O(dim Y) operations. In the full-tensor product case, after selecting bases for Yt and Yx, the construction of KY boils down to tensorizing approximate inverses of the `mass matrix' in time, which does not pose any problems, and the `stiffness matrix' in space. For V = H1() (or a subspace of aforementioned type), it is well-known that by taking a multigrid preconditioner as the approximate inverse of the stiffness matrix the resulting KY satisfies our needs. A straightforward generalization of this construction of KY applies to spaces Y that correspond to the time-slab partitioning approach.
Finally, for the efficient iterative solution of (3.6) or (4.4), one needs a KX = KX  Lis(X , X) whose norm and norm of its inverse are uniformly bounded, and whose application can be performed in O(dim X) operations. For the full and generalized sparse tensor product setting such preconditioners have been constructed in [And16] and [SvVW21], respectively.

6. ROBUSTNESS

The quasi-optimality results presented in Theorems 3.1 and 4.2 for MR and BEN

degenerate when  = Aa L(Y,Y )  . Aiming at results that are robust for   , we now study convergence w.r.t. the energy-norm ||| · |||X on X. On its own this change of norms turns out not to be helpful. By replacing · X by ||| · |||X in

Theorems 3.1 and 4.2, and adapting their proofs in an obvious way yields for MR

the same upper bound for

|||u-u |||X infwX |||u-w|||X

as we found for

u-u X infwX u-w

X

(for u



X), whereas instead of Theorem 4.2 we arrive at the only slightly more favourable

bound



|||u - u¯|||X



2+2+ 2+4 (t )2+2+1- ((t )2+2+1)2-4(t )2

inf
wX, vY

|||u -

w|||X

+

u - v Y,

which is, however, still far from being robust.

14

ROB STEVENSON, JAN WESTERDIEP

In order to obtain robust bounds, instead of the condition t > 0 ((3.2)) we now impose

(6.1)

C

:=

inf

inf

 {0=wX : CEX w=0}

EY CEX w Y CEX w Y

> 0,

which, when considering a family of operators A, we would like to hold uniformly for   .

Theorem 6.1. Under conditions (3.1), (6.1), and (3.3), the solution u  X of (3.6) satisfies

(6.2)

|||u - u|||X 

max( R ,1) min(r ,1)

(C )-1

inf
wX

|||u

-

w|||X ;

and under condition (6.1), the solution u¯  X of (4.5) satisfies

(6.3)

|||u - u¯|||X  (C)-2 inf |||u - w|||X + inf u - v Y .

wX

vY

Proof. The first estimate follows from ignoring the last inequality in (3.12), and by replacing the first inequality in (3.15) by

EY CEX w

2 Y

+

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2

 (C)2

CEX w

2 Y

+

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2

= (C)2 (EX B A-s 1BEX + EX 00EX )w (w) = (C)2|||w|||2X.

By following the proof of Theorem 4.2, recalling that now X is equipped with
||| · |||X, from C L(X,Y )  1, G() L(X,X )  1, and (EX G()EX )-1 L(X ,X)  (C)-2, one infers the estimate for BEN.

We conclude that for a family of (asymmetric) operators A robustness w.r.t. ||| · |||X is obtained when (C)-1 is uniformly bounded for  = Aa L(Y,Y )  . A family for which this will be realized is presented in Sect. 7.

6.1. A posteriori error estimation. In particular because for  = Aa L(Y,Y )   meaningful a priori error bounds for infwX |||u - w|||X will be hard to derive, it is important to have (robust) a posteriori error bounds.
Let QB  L(Y, Y) be such that ran QB  Y and (Id - QB )BX = 0. Then, with eosc(g) := (Id - QB )g Y , for w  X and u the solution of (2.4) it holds that

r

EY (g-Bw)

2 KY

+



u0 - 0w

2  |||u - w|||2X 

QB L(Y,Y) R EY (g - Bw) KY + eosc(g) 2 +  u0 - 0w 2,

which follows from g - Bw Y  g - Bw Y  QB (g - Bw) Y + eosc(g). We infer that if sup QB L(Y,Y) < , then the a posteriori error estimator

(6.4)

E (w; g, u0, ) :=

EY (g - Bw)

2 KY

+



u0 - 0w

2

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

15

is an efficient and, modulo the data oscillation term eosc(g), reliable estimator of

the error |||u - w|||X. If sup

QB

L(Y,Y)

and

max( R ,1) min(r ,1)

are

bounded

uniformly

in

  , then this estimator is even robust.

Remark 6.2. In view of Proposition 5.1, the aforementioned assumptions ran QB  Y, (Id - QB )BX = 0, and sup QB L(Y,Y) <  are equivalent to

B

:=

inf


inf
{0=wX : BEX w=0}

EY BEX w Y BEX w Y

> 0.

In applications the conditions t > 0, C > 0, and B > 0 are increasingly more difficult to fulfill.

To have a meaningful reliability result, in addition we would like to find above
QB such that, for sufficiently smooth g, the term eosc(g) is asymptotically, i.e. for the `mesh-size' tending to zero, of equal or higher order than the approximation error infwX |||u - w|||X. We will realize this in the setting that will be discussed in Sect. 7.2.

7. SPATIAL DIFFERENTIAL OPERATORS WITH DOMINATING ASYMMETRIC PART

For some domain   Rd, and   , let

H := L2(), V := H01,() := {v  H1() : v| = 0},

(7.1)

a(t; , ) :=  ·  + (b ·  + e) dx,  > 0,



b

L(I; L(div; )),

e

L(I × ),

ess

inf(e

-

1 2

divx

b)



0,

and || > 0 when the latter ess inf is zero, so that (2.1) and (2.5) are valid. In this setting, the operators Aa, As = As(), and so A = A() = As() + Aa, are given by

(Aaw)(v) =

I

(b


·

xw

+

1 2

w

divx

b)v

dx

dt,

(As()w)(v) =

I



xw

·

xv

+

(e

-

1 2

divx

b)wv

dx

dt.

Thinking of b and e fixed, and variable  > 0, one infers that  = ()   when

  0 (cf. Remark 2.3).

In the next subsection we will construct (X)  X and (Y)  Y that (essentially) satisfy inf>0 C() > 0 as families of finite element spaces w.r.t. subdivisions of I ×  into time-slabs with prismatic elements in each slab w.r.t. generally

different partitions of . Notice that although C = t + Aa is independent of , C() depends on  because it is defined in terms of the -dependent energy-norm

· Y = (As()·)(·).

As a consequence of C() being uniformly positive, for KY (EY AsEY )-1

uniformly

in



and

,

i.e.,

sup>0

max( R ,1) min(r ,1)

<

,

Theorem

6.1

gives

-robust

quasi-

optimality results for MR and BEN w.r.t. the - (and -) dependent norm ||| · |||X.

16

ROB STEVENSON, JAN WESTERDIEP

7.1. Realization of inf C() > 0. Given a conforming partition T of a polytopal  into (essentially disjoint) closed d-simplices, we define ST-1,q as the space of all (discontinuous) piecewise polynomials of degree q w.r.t. T , and, for q  1, set

ST0,,q0 := ST-1,q  H01,(),
where we assume that  is the union of faces of T  T . Let (T )¯ , (TS)¯ be a families of such partitions of , which are uniformly
shape regular (which for d = 1 should be read as to satisfy a uniform K-mesh
property), and where TS is a refinement of T  of some fixed maximal depth in the sense that |T| |T | for TS T  T  T , so that dim TS dim T . On the other hand, fixing a q  1, we require that the refinement from T  to TS is sufficiently deep that it permits the construction of a projector Pq for which

(7.2) (7.3)

ran Pq



S 0,q
TS ,0

,

ran(Id - Pq) L2()

S 0,q + S -1,q-1

T ,0

T

,

Pqw L2(T) w L2(T) (T  T , w  L2()).

As shown in [DSW21, Lemma 5.1 and Rem. 5.2], regardless of the refinement rule (e.g. red-refinement of newest vertex bisection) that is (recursively) applied to create (TS)¯ from (T )¯ , there is a refinement of some fixed depth that suffices to satisfy (7.3) as well as

(7.4)

ran Pq



{w



S 0,q
TS ,0

:

w|TT

T

=

0},

ran(Id - Pq) L2() ST-1,,0q.

Condition (7.4) is stronger than (7.2), and will be relevant in Sect. 7.2 on robust a

posteriori error estimation.

For d  {1, 2, 3} and q  {1, 2, 3}, and both newest vertex bisection and red-

refinement it was verified that it is sufficient that the aformentioned depth creates

in

the

space

S 0,q
TS ,0

an

additional

number

of

degrees

of

freedom

interior

to

any

T



T  that is greater or equal to (q+q d).

Remark 7.1. To satisfy condition (7.2)-(7.3) generally a smaller number of degrees of
freedom interior to any T  T  suffices. For d = 2 = q, in [DSW21, Appendix A] it
was shown that in order to satisfy (7.2)­(7.3) it is sufficient to create Ts from T  by one red-refinement, which creates only three of such degrees of freedom, whereas to satisfy (7.3)­(7.4) six additional interior degrees of freedom are needed.

We show robustness of MR and BEN in a time-slab partition setting.

Theorem 7.2. Let H, V, and a(·; ·, ·) be as in (7.1), with constant b and constant e  0, and let (T )¯ and (TS)¯ be as specified above. Then if, for   , X and Y are such that for some finite partition I = ([ti-1, ti])i of I, and arbitrary i  ¯ ,

(7.5)

X



{w



C(I;

H01,()) :

w|(ti-1 ,ti )



Pq(ti-1, ti)



S 0,q
T i

,0

},

Y



{v



L2(I;

H01,()) :

v|(ti-1 ,ti )



Pq(ti-1, ti)



S 0,q
TSi

,0

},

then inf>0 C() > 0. Consequently the bounds (6.2) and (6.3) show quasi-optimality of MR and BEN w.r.t. the (- and -dependent) norm ||| · |||X, uniformly in  > 0 and   1.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

17

Proof. As follows from Proposition 5.1 the statement inf>0 C() > 0 is equivalent to existence of QC  L(Y, Y) with (7.6)

sup
>0, 

QC L(Y,Y) < , ran QC  Y,

I

((t


+

b

·

x)X)(I

-

QC )Y

dx

dt

=

0,

where we recall that, thanks to constant b, Y = L2(I; H01,()) is equipped with norm

(As()v)(v) = 


I

xv

2 L2()d

+

e

v



2 L2()

dt

 xv L2(I×)d + e v L2(I;L2()).

It holds that

(7.7) (t +b · x)X 

v  L2(I×) :

v|(ti-1,ti

)



Pq

(ti-1,

ti

)



(S 0,q
T i

,0

+

S -1,q-1
T i

)

.

Let (Qx)¯ denote a family of projectors such that

(7.8) (7.9)

sup max


Qx L(L2(),L2()), Qx L(H01,(),H01,()) < ,

ran Qx



S 0,q
TS ,0

,

ran(Id - Qx) L2()

S 0,q + S -1,q-1

T ,0

T

,

and let Q,i be the L2(ti-1, ti)-orthogonal projector onto Pq(ti-1, ti). Then, the operator QC , defined by

(QC v)|(ti-1,ti)× = (Q,i  Qxi )v|(ti-1,ti)×,

satisfies (7.6). Indeed its uniform boundedness w.r.t. the energy-norm on Y follows
by the boundedness of Qx w.r.t. both the L2()- and H1()-norms. By writing Id - Q,i  Qxi = (Id - Q,i)  Id + Q,i  (Id - Qxi ), and using (7.7) one verifies
the third condition in (7.6). We seek Qx of the form Qx = Q x + Q^ x + Q^ x Q x where

(7.10)

ran Q x, ran Q^ x



S 0,q
TS ,0

,

ran(Id - Q^ x) L2() (ST0,q,0 + ST-1,q-1).

Then from Id - Qx = (Id - Q^ x)(Id - Q x), we infer that (7.9) is satisfied. We take Q^ x = Pq from (7.2)­(7.3). It satisfies the properties required in (7.10).

With h¯  being the piecewise constant function defined by h¯ |T = diam T (T 

T ), thanks to the uniform K-mesh property of T  (T )¯ , (7.3) implies that

h¯ - 1Pqh¯  L(L2(),L2()) 1, as well as Pq L(L2(),L2()) 1.

We

take

Q x

as

a

modified

Scott-Zhang

quasi-interpolator

onto

S 0,q
TS ,0

([GL01,

Ap-

pendix]). The modification consists in setting the degrees of freedom on  to zero.

When applied to a function from H01,() it equals the original Scott­Zhang inter-

polator ([SZ90]), but thanks to the modification it is uniformly bounded w.r.t. L2(),

and so Qx L(L2(),L2()) is uniformly bounded. Writing Qx = Q x + Pq(Id - Q x), from h¯ - 1(Id - Q x)  L(H01,(), L2()),
h¯ - 1Pqh¯   L(L2(), L2()), and Q x  L(H01,(), H01,()) all being uniformly

18

ROB STEVENSON, JAN WESTERDIEP

bounded, and · H1()

h¯ - 1 ·

L2()

on

S 0,q
TS ,0

,

we

infer

the

uniform

bounded-

ness of Qx L(H01,(),H01,()).

Next

under

the

condition

that

ess inf(e -

1 2

divx b)

>

0,

we

consider

the

case

of variable b and e. The scaling argument that was applied directly below Theo-

rem

2.1

shows

that

it

is

no

real

restriction

to

assume

that

ess

inf(e

-

1 2

divx

b)

>

0.

Although we will not be able to show inf>0 C() > 0, this inf-sup condition will

be valid modulo a perturbation which can be dealt with using Young's inequal-

ity similarly as in the proofs of Theorems 3.1 and 4.2. It will result in - (and -)

robust quasi-optimality results for MR and BEN similar as for constant b and con-

stant e  0.

Theorem 7.3. Consider the situation of Theorem 7.2, but now without the assumption of

b

and

e

being

constants.

Assume

b



W1 (I

×

)d,

ess

inf(e

-

1 2

divx

b)

>

0,

and,

only

for the case that b is time-dependent,

(7.11)

|ti-1 - ti| max diam(T).
TT i

Then for MR and BEN it holds

|||u - u|||X |||u - u¯|||X uniformly in  > 0 and   1.

max( R ,1) min(r ,1)

inf
wX

|||u

-

w|||X ,

inf |||u - w|||X + inf u - v Y,

wX

vY

Proof. As in the proof of Theorem 6.1, we follow the proofs of Theorems 3.1 (MR)

and 4.2 (BEN). We only need to adapt the derivation of a lower bound for the

expression in the second line of (3.15).

With



=

ess

inf(e

-

1 2

divx

b),

it

holds

that

 · Y

·

L2(I×)



1 

· Y.

Let b be the piecewise constant vector field defined by taking the average of b
over each prismatic element (ti-1, ti) × T for T  T i . We use w  b · xw to approximate Aa. We have b - b L((ti-1,ti)×T)d diam(T) b W1 ((ti-1,ti)×T)d by (7.11). An application of the inverse inequality on the family of spaces (ST0,,q0)T ¯
shows that for some constant L > 0, for w  X it holds that

(b

-

b)

·

xw

+

1 2

w

divx

b

L2(I×)  L

w

L2(I×).

Because (7.7) is also valid for piecewise constant b, and



(As()v)(v)

 xv L2(I×)d +  v L2(I;L2()),

only dependent on

e

-

1 2

divx

b

L(I×)/, the proof of Theorem 7.2 shows that

for some constant  > 0, for w  X it holds that

EY (t + b · x)EY w Y   (t + b · x)EY w Y .

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

19

By combining these estimates, we find that for w  X it holds that

EY CEY w Y



(t + b · x)EY w

Y

- L


EY w

L2(I×)



CEY w

Y

- ( + 1) L


EY w L2(I×)



CEY w

Y

-

(

+

1)

L 

EY w Y,

and so

EY CEY w

2 Y

+

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2





CEY w

Y

-(

+

1) L


EY w Y 2 +

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2

 (1 - 2)2

CEY w

2 Y

+

(1

-

-2)(

+

1)2

L2 2

+

1

EX w

2 Y

+

T EX w 2 + ( - 1) 0EX w 2.

Minimizing

over



shows

that,

with

2

:=

(

+

1)2

L2 2

,

the

last

expression

is

greater

than or equal to

1 2

2 + 2 + 1 -

which completes the proof.

(2 + 2 + 1)2 - 42 |||EX w|||2X,

7.2. Robust a posteriori error estimation. A robust error estimator will be real-
ized in the following limited setting.
Consider the spaces and bilinear form a as in (7.1), where b is constant, e = 0, and the polytope   Rd is convex. For families of quasi-uniform partitions
(I) of I, and (T ) and (TS) of  as before, where TS is a sufficiently deep refinement of T  that permits the construction of a projector P1 that satisfies (7.3)-(7.4), and for some h > 0, diam T h diam J (T  T , J  I), let X := S0I,1  ST0,1,0 and Y := S-I1,1  ST0,S1,0. For completeness, S-I1,1 denotes the space of piecewise linears w.r.t. I, and S0I,1 the space of continuous piecewise linears w.r.t. I.
In this setting, in [DSW21, Thm. 5.6] projectors QB  L(Y, Y) have been con-
structed with ran QB  Y and (I - QB )BX = 0. Moreover, these QB are uniformly bounded in Y = L2(I; H01,()) equipped with the standard Bochner norm, with H01,() being equipped with  · L2()d . Since for the current bilinear form a, the energy-norm · Y is equal to  · L2(I;H01,()), it holds that sup, >0 QB L(Y,Y) < , and so

inf
>0

B ()

>

0.

Let ((K^Y )-1v)(v)

I  |xv|2 dx dt (  , v  Y), then (-1K^Y )-1

EY .

AsEY , i.e.,

using preconditioner KY

:=

-1 K^ Y

it holds that sup>0

max( R ,1) min(r ,1)

<

What remains is to show that data-oscillation is asymptotically of higher or equal

order as the approximation error in ||| · |||X =

B·

2 Y

+

0 ·

2.

Noting that

20

ROB STEVENSON, JAN WESTERDIEP

·

Y

=

1 

·

L2(I;H01,() ), it is natural to select

 Then ||| · |||X equals

 = -1.

(t + b · x) ·

2 L2 ( I ; H01, ()

)

+

2

·

2 L2 ( I ; H01, ())

+



T ·

2 + (1 - ) 0 ·

2,



and so even for a general smooth u,  times the approximation error cannot be

expected to be smaller than 
holds that  (I - QB )g Y

=

h2. Since (I - QB

for )g

g  L2(I; H1())  H2(I; H-1()) it L2(I;H01,() ) h2 ([DSW21, Thm. 5.6]),

we conclude that E (w; g, u0, ) from (6.4) is an efficient and, modulo above sat-

isfactory data-oscillation term, reliable a posteriori estimator of the error in w in

||| · |||X-norm.

8. NUMERICAL TEST

We tested the minimal residual (MR) method applied to the parabolic initial
value problem with the singularly perturbed `spatial component' as given in (7.1). We considered the simplest case where I =  = (0, 1), b = 1, and e is either 0 or 1, and X = S0I,1  ST0,1,0, where I = T  is a uniform partition of the unit interval with mesh size h. Taking always (KY )-1 = EY AsEY , we took either
(i) Y = S-I1,1  ST0,1,0( X  tX) which for any fixed  > 0 gives t > 0 (Sect. 5.1), so that the MR approximations are quasi-optimal approximations from the trial space w.r.t. · X (Thm. 3.1), or
(ii) Y := S-I1,1  ST0,s1,0 where Ts is a uniform partition with mesh-size h/3 which even gives inf>0 C() > 0 (Thm. 7.2), so that the MR approximations are quasi-optimal approximations from the trial space w.r.t. the energy-norm ||| · |||X also uniformly in  > 0 (Thm. 6.1).
Remark 4.1 shows that in these cases the BEN and MR methods give the same
solution. As discussed in Sect. 7.2, for the case that e = 0 it is natural to take the weight
 = -1. Unlike with e = 0, for e = 1 and 0 = v  Y the energy-norm (Asv)(v) does not tend to zero for   0 but converges to v L2(I×). In view of this there is no reason to let  tend to infinity for   0, and we took  = 1.
For Y as in (ii), in Sect. 7.2 it was shown that for (e, ) = (0, -1) it holds that inf>0 B() > 0, and more specifically that the a posteriori error estimator E (w; g, u0, ) from (6.4) is an efficient and, modulo a data-oscillation term which is at least of equal order, reliable estimator of the error |||u - w|||X. Therefore to assess our numerical results, we used Y as in Option (ii) for error estimation,
even when solving with Y as in (i). For (e, ) = (1, 1), we numerically observed that for our model problems the a
posteriori error estimator E (w; g, u0, ) computed with Y as in (ii) is efficient and reliable as, knowing that the estimator equals |||u - w|||X for Y = Y, we saw that further overrefinement of the test space Y never increased the estimated error by
more than a percent. So again, regardless of whether we took Y as in Option (i)
or (ii), we used Y as in (ii) to compute E (w; g, u0, ).

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

21

In experiments below, we choose  = 1, 10-1, 10-3, 10-6; to compare different values of , we show the estimated error divided by an accurate approximation for

g

2 Y

+

u0

2 which is equal to the ||| · |||X-norm of the exact solution.

8.1. Smooth problem. We take (homogeneous) Dirichlet boundary conditions at left- and right boundary, i.e.  = , select (e, ) = (0, -1), and prescribe the exact solution u(t, x) := (t2 + 1) sin(x) with derived data u0 and g. For this problem, the best possible error in ||| · |||X-norm, divided by |||u|||X, decays proportionally to (dim X)-1/2.
Figure 1 shows this relative estimated error as a function of dim X. In accor-
dance with Theorem 3.1, for this parabolic problem with non-symmetric spatial
part, both Option (i) and Option (ii) give solutions that converge at the expected
rate. For Option (i), however, this convergence is not uniform in , but in accor-
dance with Theorem 6.1, for Option (ii) it is.

Option (i)
10 1

Option (ii)
=1 = 10 1 = 10 3 = 10 6

10 2

10 3

1/2

101 102 103 104 105

1/2 101 102 103 104 105

FIGURE 1. Relative estimated error progression for the smooth problem as function of dim X for different diffusion rates . Left: test space Y as in Option (i); right: Y as in (ii).

8.2. Internal layer problem. We choose u0 := 0 and g(t, x) := 1{x>t}, select
(e, ) = (0, -1), and prescribe a homogeneous Dirichlet boundary condition only

at the left boundary x = 0, i.e.  := {0}, and so have a Neumann boundary con-

dition at the `outflow' boundary x = 1. Due to the jump in the forcing data, in the
limit   0, the solution t · 1{x>t} is discontinuous along the diagonal x = t.
The left of Figure 2 shows the relative estimated error progression of Option (ii)

as a function of dim X; as Option (i) again suffers from degradation for small

 (with results very similar to the left of Figure 1), we omit a graph of its error

progression.

Its

right

shows

the

discrete

solution

at

h

=

1 512

and



=

10-6.

The

solution resembles the pure transport solution quite well, with the exception of a

small artefact near x = t = 0.

22

ROB STEVENSON, JAN WESTERDIEP

FIGURE 2. Solving the internal layer problem with Option (ii). Left:

relative estimated error progression as function of dim X for dif-

ferent

diffusion

rates

.

Right:

solution

at

h

=

1 512

and



=

10-6.

8.3. Boundary layer problem. We choose u0(x) := sin(x) and g = 0, select (e, ) = (1, 1), and set homogenous Dirichlet boundary conditions on , i.e.  =

{0, 1}. Due to the condition on the outflow boundary, the problem is ill-posed in

the limit  = 0, hence for  small, the solution has a boundary layer at x = 1.

Figure 3 shows that the method fails to make progress until the boundary layer

is resolved at h

.

Figure

4

shows

two

discrete

solutions

at

h

=

1 512

computed

for Option (ii). We see that for  = 10-3, the boundary layer is resolved and

the solution resembles the pure transport solution quite well, with the exception of a small artefact near x = t = 1. For  = 10-6 though, the boundary layer

cannot be resolved with the current (uniform) mesh, and the solution is completely

wrong. For   0, the energy-norm of the error in an approximation w approaches

(t + b · x)w

2 L2(I×)

+

u0 - 0w

2 L2

()

.

As

a

result,

for

streamlines

that

hit

the outflow boundary, the method `chooses' to smear the unavoidably large error

as a consequence of the layer along the whole streamline resulting in a globally

bad approximation. This is a well-known phenomenon when using a least squares

method to approximate a solution that has a sharp layer or a shock.

8.4. Imposing outflow boundary conditions weakly. One common work-around is to resolve the problem caused by the boundary layer is to refine the mesh strongly towards this layer. An alternative is to impose at the outflow boundary the Dirichlet boundary condition only weakly, see e.g. the references [CDW12, BS14, CEQ14, CFLQ14] where this approach has been applied with least squares methods for stationary convection dominated convection-diffusion methods. Without having a rigorous analysis we tried this second approach by computing, with Y as in Option (ii),

u := argmin
wX^ 

EY

(BEX w - g)

2 Y

+

0EX w - u0

2+

w(·, 1)

2 L2

(

I)

.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

23

Option (i)
102
101 100

Option (ii)
=1 = 10 1 = 10 3 = 10 6

10 1

10 2

1/2

101 102 103 104 105

1/2 101 102 103 104 105

FIGURE 3. Relative estimated error progression for the boundary layer problem as function of dim X for different diffusion rates . Left: test space Y as in Option (i); right: Y as in (ii).

FIGURE 4. Solutions of the boundary layer problem with Option (ii)

at

h

=

1 512

.

Left:

diffusion



=

10-3;

right:



=

10-6.

Here, X^  denotes the space X after removing the Dirichlet boundary condition at

x = 1. Figure 5 shows the resulting error progression, which is robust in , as well

as

the minimal residual solution at h

=

1 512

and 

=

10-6;

it resembles the

pure

transport solution quite well, and does not suffer from the artifact present at the

right of Figure 4.

REFERENCES
[And12] R. Andreev. Stability of space-time Petrov-Galerkin discretizations for parabolic evolution equations. PhD thesis, ETH Zürich, 2012.

24

ROB STEVENSON, JAN WESTERDIEP

FIGURE 5. Solving the boundary layer problem with Option (ii), and

imposing the outflow boundary condition weakly. Left: relative

estimated error progression as function of dim X^  for different dif-

fusion

rates

.

Right:

solution

at

h

=

1 512

and



=

10-6.

[And13] R. Andreev. Stability of sparse space-time finite element discretizations of linear parabolic evolution equations. IMA J. Numer. Anal., 33(1):242­260, 2013.
[And16] R. Andreev. Wavelet-in-time multigrid-in-space preconditioning of parabolic evolution equations. SIAM J. Sci. Comput., 38(1):A216­A242, 2016.
[BE76] H. Brézis and I. Ekeland. Un principe variationnel associé à certaines équations paraboliques. Le cas dépendant du temps. C. R. Acad. Sci. Paris Sér. A-B, 282(20):Ai, A1197­ A1198, 1976.
[BEEN19] T. Boiveau, V. Ehrlacher, A. Ern, and A. Nouy. Low-rank approximation of linear parabolic equations by space-time tensor Galerkin methods. ESAIM Math. Model. Numer. Anal., 53(2):635­658, 2019.
[BS14] D. Broersen and R.P. Stevenson. A robust Petrov-Galerkin discretisation of convectiondiffusion equations. Comput. Math. Appl., 68(11):1605­1618, 2014.
[CDW12] A. Cohen, W. Dahmen, and G. Welper. Adaptivity and variational stabilization for convection-diffusion equations. ESAIM: Mathematical Modelling and Numerical Analysis, 46:1247­1273, 2012.
[CEQ14] J. Chan, J. A. Evans, and W. Qiu. A dual Petrov-Galerkin finite element method for the convection-diffusion equation. Comput. Math. Appl., 68(11):1513­1529, 2014.
[CFLQ14] H. Chen, G. Fu, J. Li, and W. Qiu. First order least squares method with weakly imposed boundary condition for convection dominated diffusion problems. Comput. Math. Appl., 68(12, part A):1635­1652, 2014.
[Dev20] Denis Devaud. Petrov-Galerkin space-time hp-approximation of parabolic equations in H1/2. IMA J. Numer. Anal., 40(4):2717­2745, 2020.
[DG11] L. Demkowicz and J. Gopalakrishnan. A class of discontinuous Petrov-Galerkin methods. II. Optimal test functions. Numer. Methods Partial Differential Equations, 27(1):70­105, 2011.
[DG14] L. Demkowicz and J. Gopalakrishnan. An overview of the discontinuous Petrov Galerkin method. In Recent developments in discontinuous Galerkin finite element methods for partial differential equations, volume 157 of IMA Vol. Math. Appl., pages 149­180. Springer, Cham, 2014.
[DL92] R. Dautray and J.-L. Lions. Mathematical analysis and numerical methods for science and technology. Vol. 5. Springer-Verlag, Berlin, 1992. Evolution problems I.
[DS20] L. Diening and J. Storn. A space-time DPG method for the heat equation, 2020, 2012.13229. [DST20] L. Diening, J. Storn, and T. Tscherpel. On the Sobolev and Lp-stability of the L2-projection,
2020, 2008.01801.

MINIMAL RESIDUAL SPACE-TIME DISCRETIZATIONS OF PARABOLIC EQUATIONS

25

[DSW21] W. Dahmen, R.P. Stevenson, and J. Westerdiep. Accuracy controlled data assimilation for parabolic problems, 2021, 2105.05836.
[FK21] T. Führer and M. Karkulik. Space-time least-squares finite elements for parabolic equations. Comput. Math. Appl., 92:27­36, 2021.
[GHS16] F. D. Gaspoz, C.-J. Heine, and K. G. Siebert. Optimal grading of the newest vertex bisection and H1-stability of the L2-projection. IMA J. Numer. Anal., 36(3):1217­1241, 2016.
[GL01] V. Girault and J.-L. Lions. Two-grid finite-element schemes for the transient Navier-Stokes problem. M2AN Math. Model. Numer. Anal., 35(5):945­980, 2001.
[GS19] H. Gimperlein and J. Stocek. Space-time adaptive finite elements for nonlocal parabolic variational inequalities. Comput. Methods Appl. Mech. Engrg., 352:137­171, 2019.
[GS21] G. Gantner and R. Stevenson. Further results on a space-time FOSLS formulation of parabolic PDEs. ESAIM Math. Model. Numer. Anal., 55(1):283­299, 2021.
[Kat60] T. Kato. Estimation of iterated matrices, with application to the von Neumann condition. Numer. Math., 2:22­29, 1960.
[LMN16] U. Langer, S.E. Moore, and M. Neumüller. Space-time isogeometric analysis of parabolic evolution problems. Comput. Methods Appl. Mech. Engrg., 306:342­363, 2016.
[Nay76] B. Nayroles. Deux théorèmes de minimum pour certains systèmes dissipatifs. C. R. Acad. Sci. Paris Sér. A-B, 282(17):Aiv, A1035­A1038, 1976.
[NS19] M. Neumüller and I. Smears. Time-parallel iterative solvers for parabolic evolution equations. SIAM J. Sci. Comput., 41(1):C28­C51, 2019.
[SS09] Ch. Schwab and R.P. Stevenson. A space-time adaptive wavelet method for parabolic evolution problems. Math. Comp., 78:1293­1318, 2009.
[Ste15] O. Steinbach. Space-Time Finite Element Methods for Parabolic Problems. Comput. Methods Appl. Math., 15(4):551­566, 2015.
[SvVW21] R.P. Stevenson, R. van Venetië, and J. Westerdiep. A wavelet-in-time, finite element-in-space adaptive method for parabolic evolution equations, 2021, 2101.03956.
[SW20] R.P. Stevenson and J. Westerdiep. Stability of Galerkin discretizations of a mixed space-time variational formulation of parabolic evolution equations. IMA J. Numer. Anal., 2020.
[SY18] O. Steinbach and H. Yang. Comparison of algebraic multigrid methods for an adaptive space-time finite-element discretization of the heat equation in 3D and 4D. Numer. Linear Algebra Appl., 25(3):e2143, 17, 2018.
[SZ90] L. R. Scott and S. Zhang. Finite element interpolation of nonsmooth functions satisfying boundary conditions. Math. Comp., 54(190):483­493, 1990.
[SZ20] O. Steinbach and M. Zank. Coercive space-time finite element methods for initial boundary value problems. Electron. Trans. Numer. Anal., 52:154­194, 2020.
[vVW20] R. van Venetië and J. Westerdiep. A scalable algorithm for solving linear parabolic evolution equations, 2020, 2009.08875.
[vVW21] R. van Venetië and J. Westerdiep. Efficient space-time adaptivity for parabolic evolution equations using wavelets in time and finite elements in space, 2021, 2104.08143.
[Wlo82] J. Wloka. Partielle Differentialgleichungen. B. G. Teubner, Stuttgart, 1982. Sobolevräume und Randwertaufgaben.
[XZ03] J. Xu and L. Zikatanov. Some observations on Babuska and Brezzi theories. Numer. Math., 94(1):195­202, 2003.
KORTEWEG­DE VRIES (KDV) INSTITUTE FOR MATHEMATICS, UNIVERSITY OF AMSTERDAM, P.O. BOX 94248, 1090 GE AMSTERDAM, THE NETHERLANDS.
Email address: r.p.stevenson@uva.nl, j.h.westerdiep@uva.nl

