Draft version June 3, 2021 Typeset using LATEX default style in AASTeX63

arXiv:2106.00864v1 [astro-ph.SR] 2 Jun 2021

A new broadening technique of numerically unresolved solar transition region and its effect on the spectroscopic synthesis using coronal approximation
Haruhisa Iijima1, 2 and Shinsuke Imada1
1 Institute for Space-Earth Environmental Research, Nagoya University, Furocho, Chikusa-ku, Nagoya, Aichi 464-8601, Japan 2 National Astronomical Observatory of Japan, 2-21-1 Osawa, Mitaka, Tokyo 181-8588, Japan
ABSTRACT
The transition region is a thin layer of the solar atmosphere that controls the energy loss from the solar corona. Large numbers of grid points are required to resolve this thin transition region fully in numerical modeling. In this study, we propose a new numerical treatment, called LTRAC, which can be easily extended to the multi-dimensional domains. We have tested the proposed method using a one-dimensional hydrodynamic model of a coronal loop in an active region. The LTRAC method enables modeling of the transition region with the numerical grid size of 50­100 km, which is about 1000 times larger than the physically required value. We used the velocity differential emission measure to evaluate the possible effects on the optically thin emission. Lower temperature emissions were better reproduced by the LTRAC method than by previous methods. Doppler shift and non-thermal width of the synthesized line emission agree with those from a high-resolution reference simulation within an error of several km/s above the formation temperature of 105 K.

Keywords: hydrodynamics -- magnetohydrodynamics (MHD) -- Sun: transition region -- Sun: chromosphere -- Sun: corona -- Sun: flares

1. INTRODUCTION

The solar transition region is a thin layer between the chromosphere and the corona. In this region, the temperature and mass density change steeply from chromospheric values to coronal values. The rapid change of the mass density produces the steep gradients of the acoustic and Alfv´en speeds, which leads to wave reflection. The rate of reflection of Alfv´en waves at the thin transition region is roughly determined by the density variation in that region (Hollweg 1984; Verdini et al. 2012). The free magnetic energy injected into the solar corona is released through impulsive heating events in both the magnetic braiding and the wave heating models (e.g., van Ballegooijen et al. 2011; Rempel 2017; Matsumoto 2018). The thermal energy in the solar corona is transported by thermal conduction down to the transition region, releasing the energy as radiation into space. The resulting evaporation of the chromospheric plasma increases the coronal density (Reale 2010; Klimchuk 2015). Thus, accurate modeling of the transition region cannot be avoided in modeling the energy exchange between the chromosphere and the corona.
A simple static, coronal-loop model was introduced by Rosner et al. (1978). The major assumptions in this model are: (1) a coronal loop is sufficiently short so that the spatial variation of the gas pressure can be ignored, (2) a volumetric heating rate in a coronal loop is spatially uniform, and (3) the energy balance in a static loop is given by

 s



T s

+ Qext + Qrad = 0,

(1)

where T is the temperature, s is the coordinate along the coronal loop,  is the thermal conduction coefficient, Qext is the volumetric heating rate, and Qrad is the optically thin radiative cooling rate. In this model, the temperature profile near the transition region is sensitive to the gas pressure (or heating rate) but is not sensitive to the length of the loop. We estimated the thickness of the transition region using the spatial profile of the temperature given

Corresponding author: Haruhisa Iijima h.iijima@isee.nagoya-u.ac.jp

2
by Eq. (C1) in Appendix C of Rosner et al. (1978). The thickness of the transition region was defined as a distance s(T1)- s(T0), where T0 = 2 × 104 K (i.e., the temperature at the footpoint of the coronal loop), T1 = 105 K (the typical temperature at the transition region), and s(T ) is the coordinate s at the temperature T . The estimated thickness of the transition region was approximately s(T1) - s(T0)28 × (Ttop [K]/106)-3 km, where Ttop is the temperature at the apex of the coronal loop. Even the quiet corona cannot be resolved by a grid size of several tens of kilometers, which is typically assumed in multidimensional simulations (e.g. Gudiksen et al. 2011; Iijima & Yokoyama 2015, 2017; Rempel 2017; Abbett 2007). The transition region becomes even thinner in hotter active regions or flaring loops due to the strong temperature sensitivity of the thermal conduction coefficient and the radiative cooling.
The lack of sufficient resolution of the transition region in hydrodynamic and magnetohydrodynamic simulations has been a topic of continuing discussion (Craig et al. 1982; Klimchuk 2006; Bradshaw & Cargill 2013). One possible solution is to use a moving mesh (Carlsson & Stein 1992) or adaptive mesh refinement (Bradshaw & Klimchuk 2011). However, it is difficult to achieve such small numerical grid sizes in multidimensional simulations due to the resulting high computational cost. As the coronal heating processes (both magnetic braiding and wave heating) are intrinsically three-dimensional in nature, it is necessary to devise a way to capture the transition region adequately on a coarse numerical grid to model the solar corona realistically.
A technique for broadening the numerical transition region has been suggested by Linker et al. (2001), Lionello et al. (2009), and Miki´c et al. (2013). By introducing the problem-dependent parameter Tc, they suggested that the thermal conduction coefficient should be enhanced by a factor fc = max(1, T /Tc) to broaden the unresolved transition region. They also reduced the radiative cooling rate by the same factor fc so that the total radiative loss remains unchanged. Johnston & Bradshaw (2019) and Johnston et al. (2020) suggested a way to model the transition using a method they term Transition Region Adaptive Conduction (TRAC). This method automatically determines the optimal value of the parameter Tc in one-dimensional coronal loop simulations. By selecting the highest temperature at a location with a high temperature gradient, they showed that the dynamic evolution of a coronal loop can be reproduced with the coarse grid size of 100 km. However, a multidimensional extension of the TRAC method is not straightforward, because we need a way to track the magnetic field line as the optimal value of Tc is determined along the field line (Zhou et al. 2021). Johnston et al. (2017a,b) also suggested an alternative way to resolve the transition region using jump conditions.
Spectroscopic observations in the EUV and X-ray are important diagnostic tools for the solar corona and transition region, especially for information about plasma motions (e.g., Chae et al. 1998; Teriaca et al. 1999; Doschek et al. 2007; Imada et al. 2008). In particular, the statistical characteristics of non-thermal line widths and the Doppler velocities have been used as constraints on coronal heating models (e.g., Peter & Judge 1999; Imada et al. 2009; Brooks & Warren 2016; Testa et al. 2016; van Ballegooijen et al. 2017). As the line profiles contain considerable information about the coronal plasma, a numerical treatment of the broadening method must therefore reproduce the spectroscopic observables.
In this study, we propose a new approach called the LTRAC (localized TRAC) method to broaden unresolved transition region in numerical simulations. The local nature of the LTRAC method allows us to apply it to the parallel computation of multidimensional simulations using the domain decomposition technique. As a large number of grid points is required to resolve the transition region properly, we tested the proposed method using a one-dimensional hydrodynamic model of a solar coronal loop. We investigated the performance of the proposed method by examining the time evolution of the plasma in the transition region and corona, specifically focusing on spectroscopic observables in the optically thin approximation. We found that the LTRAC method reproduces the spectroscopic observables coming from the low temperature plasma better than previous methods.

2. METHOD
2.1. Simulation setup
To investigate the performance of the methods used to broaden the transition region, we solved the one-dimensional hydrodynamic equations along a field line, including the effects of gravity, Spitzer-H¨arm conduction, radiative cooling, and external heating. The basic equations are the continuity equation

 t

+

 s

(Vs)

=

0,

(2)

3

the equation of motion

 t

(Vs)

+

 s

Vs2

+

P s

= gs,

(3)

and the internal energy equation

e t

+

 s

[(e

+

P

)

Vx]

=

Vs

P s

+ Qcnd + Qrad + Qext,

(4)

where  is the mass density, P is the gas pressure, e is the internal energy density, Vs is the velocity along a field line, and gs is the gravitational acceleration along a field line. The equation of state is computed assuming local thermodynamic equilibrium and considering the most abundant six elements in the solar atmosphere. The ionization energies of the six elements and the latent internal energy of molecular hydrogen are included in the internal energy of the plasma.
The quantity Qcnd represents the volumetric heating rate due to the thermal conduction:

Qcnd

=

 s



T s

.

(5)

For the thermal conduction coefficient, we assume Spitzer-H¨arm conduction  = 0T 5/2 with 0 = 10-6 in c.g.s. units.

The radiative cooling rate Qrad is a combination of the cooling rates from the optically thick and thin regions, as

given by

Qrad = (1 - ) Qthick + Qthin,

(6)

where  = exp (-P/Pthick) is the switching function between optically thick cooling, Qthick, and thin cooling, Qthin. We chose Pthick = 104 dyn/cm2 as the threshold parameter. The optically thick cooling rate is given by

Qthick

=

-CV

T

- Trad 

,

(7)

where CV is the isochoric heat capacity per unit mass, and Trad = 6000 K is the radiation temperature. Following the approach of Gudiksen & Nordlund (2005), we chose the cooling timescale  to be

 = max 0.1

surf 

,

4t

,

(8)

where surf = 2 × 10-7 g/cm3. We used the slightly modified version of the optically thin cooling rate given by

Qthin = -nenH (T ) 1 -

Trad 4 T

(9)

to prevent the formation of low temperature regions with T < Trad. Here, ne and nH represent the number densities of electrons and hydrogen nuclei. This modification does not affect either the transition region or the corona.

The numerical scheme is based on the finite difference method. The hyperbolic equations are solved using the

second-order SLIP scheme (Jameson 1995) with the third-order strongly stability preserving Runge-Kutta method

(Shu & Osher 1988). The energy-consistent formulation by Iijima (2021) is used in the spatial discretization to ensure

the total energy conservation while explicitly solving the internal energy equation. We used the operator splitting

between the hydrodynamic equations and the thermal conduction equation. The thermal conduction equation is

discretized using the second-order central difference method, and it is integrated implicitly using the backward Euler

method to avoid the severe time step restriction encountered in explicit schemes.

The numerical domain extends from the solar surface (s = 0) to the top of the coronal loop (s = L). The half length

of the coronal loop L is chosen to be 25 Mm in a typical case. We assumed a semi-circular coronal loop and reduced

the field-aligned gravitational acceleration gs following the geometrical effect. We calculated the initial temperature

profile from

ln

T

(s)

=

ln

Tsurf

+

1 2

1 + tanh

s - sTR sTR

(ln Tsurf - ln Ttop) ,

(10)

where sTR = 2.5 Mm, sTR = 500 km, Tsurf = 6000 K, and Ttop = 106 K. The mass density is integrated assuming hydrostatic equilibrium, with the boundary value of  = 2 × 10-7 g/cm3. This initial condition is not energetically

4

balanced because of the thermal conduction, radiative cooling, and external heating terms. We assume reflective boundary conditions at the top and bottom of the domain. In this study, the dynamical evolution of the simulated corona is controlled by imposing an external heating rate Qext to mimic coronal heating due to arbitrary processes. In a typical case, we impose spatially uniform volumetric heating rate Qext = Fext/L. The injected energy flux Fext is set to 3 × 107 erg/cm2/s for the initial 600 s of the simulation and set to zero after the time of 600 s. This setup mimics a coronal loop in an active region.

2.2. The LTRAC method

We now describe the LTRAC method we implemented to broaden the unresolved transition region in the model described in Sec. 2.1. As our new method is an extension of the methods suggested by Lionello et al. (2009) and Johnston & Bradshaw (2019), we summarize their methods first.
Lionello et al. (2009) used energy balance between the radiative cooling and conductive heating,

Qrad

T T2 R

,

(11)

to obtain the approximate thickness of the transition region as:

TR

T Qrad

.

(12)

Here, we note that, if we assume that the typical temperature in the transition region does not depend on the
temperature at the loop top, the temperature dependence of the transition region thickness (discussed in Sec. 1) can be derived as TR  Tt-op3, where we used the scaling law of Eq. (4.3) in Rosner et al. (1978). The dependence on the loop top temperature Ttop comes from the dependence on the mass density of the radiative cooling rate Qrad.
Lionello et al. (2009) proposed that, if  and Qrad are substituted by fc and Qrad/fc, respectively, the transition region can be broadened by a factor of fc. This substitution can be alternatively expressed by

b = fc and Qbrad = Qrad/fc,

(13)

where the variable with superscript U b indicates the variable U modified by the broadening technique of the transition

region. The substitution (13) broadens the approximate thickness of the transition region (12) as TbR = fcTR. We did not include the effect of the heat flux saturation (Fisher et al. 1985; Patsourakos & Klimchuk 2005; Bradshaw & Cargill

2006) for simplicity, which is important for very hot coronal loops. One possible way to implement the heat flux

saturation is to enhance the saturated (limited) heat flux (or conductive flux) by a factor of fc instead of the thermal conduction coefficient . However, its validity and performance should be investigated in the future study.

Johnston et al. (2020) pointed out that the substitution (13) does not alter the total radiative loss from the broadened

transition region. From Eq. (12), the total radiative loss integrated across the transition region can be approximated

as
s1

QraddsQradTR QradT = bQbradT ,

(14)

s0

where s0 and s1 are the spatial coordinates at the bottom and top of the transition region, respectively, and we used Eq. (13) to derive the last equality. As the substitution of  and Qrad by Eq. (13) does not alter the right-handside of Eq. (14), the total radiative loss from the transition region is not altered even if the transition region is

numerically broadened. Similarly, the total conductive heating of the transition region (T /TR) remains unchanged by the substitution (13).

Lionello et al. (2009) suggested to determine the broadening factor fc as

fc = max(1, Tc/T )5/2,

(15)

where Tc is a parameter that depends on the specific problem and the grid size. For example, Tc is set to a typical

temperature at the top of the transition region. Lionello et al. (2009) noted that the lower Tc requires higher numerical

resolution to resolve the transition region. Johnston & Bradshaw (2019) proposed the TRAC method that determines

the optimal value of Tc from

Tc

= max (T (s))
s

s.t.

s T T s

> c,

(16)

5

where s is the grid size, and the problem independent parameter c = 1/2 is introduced. Following Johnston & Bradshaw (2019), the variable Tc is limited by imposing a lower bound of typical chromospheric temperature (2 × 104 K) and an upper limit of the 20 percents of the maximum coronal temperature. Note that a multidimensional extension of the TRAC method is not straightforward, as the maximum is taken along a field line. In parallel simulations with the domain decomposition, the computation of the maximum value along a field line requires global communication, which may result in less parallel efficiency.
There are slight differences between the implementations of the TRAC method in Johnston & Bradshaw (2019) and Johnston et al. (2020). Our implementation of the TRAC method is based on Johnston & Bradshaw (2019), not Johnston et al. (2020). Johnston et al. (2020) suggested to divide the external heating rate by the factor fc. We do not follow their approach because the modification of the external heating rate may cause an error in the total energy injected into the whole atmosphere. As we assume a spatially uniform volumetric heating rate, this minor difference in the heating term does not affect the results presented in this paper. Johnston et al. (2020) also suggested to use the temporal smoothing on Tc. This modification may reduce the temporal oscillation of the low temperature emission measure in the TRAC method observed in Fig. 4. In this study, we did not use this temporal smoothing to clarify the effect of the different spatial profiles of the broadening factor between the TRAC and LTRAC methods.
In this study, we propose a new method called LTRAC to determine the broadening factor fc using only the information from nearby grid points. Similar to the TRAC method, the LTRAC method uses the temperature gradient to detect the unresolved transition region. We define the normalized temperature gradient as

r = exp

s T T s

.

(17)

In the unresolved transition region, the quantity r becomes large and the non-negligible numerical artifacts can lead to unphysical solutions (e.g., the wrong density in the corona; see also Fig. 1 and 2). To reduce the steep temperature gradient in the high r-value region, the broadening factor fc is determined as

fc = max(1, r/rc)p,

(18)

where rc and p are non-dimensional parameters, and the overline indicates a low-pass filter in space. The threshold parameter rc>1 is introduced so that the broadening factor fc is kept unity (no broadening) in the grid points with smooth temperature profile of r < rc. The parameter p1 is introduced to accelerate convergence. We used rc = 1.5 and p = 4 as typical values in this study. The dependence of the LTRAC method on these parameters is investigated in Appendix B. The low-pass filter is introduced to smooth the spatial distribution of fc computed from the numerical gradient of the temperature, which is generally non-smooth. As our discretization described in Sec. 2.1 is second-order in space, we used the second-order low-pass filter defined by

Uj

=

Uj-1

+ 2Uj 4

+ Uj+1 ,

(19)

where Uj indicates the value of a variable U at the j-th grid point along the s-coordinate. We note that the procedure above can be extended easily into multidimensional geometries, which is one of the advantages of the LTRAC method.
Here, we summarize the broadening process of the transition region by the LTRAC method. When the temperature gradient becomes steeper (r > rc), fc is enhanced by Eq. (18). The enhanced fc broadens the transition region through the enhanced thermal conduction by Eq. (13) while preserving the total radiative loss (Eq. (14)). In the broadened transition region, the broadening factor fc decreases and approaches unity. The value of fc in the steady state is determined by the balance between the broadening effect by the LTRAC method and the thinning effect by the physical nature of the transition region.

2.3. Velocity differential emission measure
To investigate the effect on the spectroscopic observables, we use the velocity differential emission measure (VDEM) for optically thin emissions. The VDEM is defined by

VDEM(T, V)dV dT = nenH dh,

(20)

TV

h

6
where V is the line-of-sight velocity, and the integration on the right-hand-side is taken along the line-of-sight. Let us focus on the optically thin intensity that can be approximated by

I() = C(T, V, )nenH dh.

(21)

h

Equation (21) is usually valid if ionization/excitation equilibrium is satisfied in the coronal approximation (Del Zanna & Mason 2018). The VDEM can fully reproduce the intensity, as shown by

I() =

C(T, V, )VDEM(T, V )dV dT.

(22)

TV

The effect of the proposed method on the optically thin spectroscopic observables can therefore be analyzed using the VDEM. The zeroth-, first-, and second-order moments of VDEM with respect to V correspond to the usual differential emission measure (DEM), Doppler velocity, and non-thermal line width, respectively. The definition of the VDEM given above is identical to that given by Cheung et al. (2019), but it is different from the original version presented by Newton et al. (1995).
We found that calculations of the optically thin emission that employ the methods for broadening the unresolved transition region require a special care. As both the TRAC and LTRAC methods use the substitution (13), the local radiative cooling rate are reduced by a factor of fc so that the total radiative loss remains unchanged by the numerical broadening of the transition region (see Eq. (14)). Similarly, the optically thin emission from the numerical solution must be calculated taking the broadening factor into account:

I() =

h

C

(T

,

V

,

)ne

nH

dh fc

.

(23)

The VDEM must be computed in a similar manner. This correction mainly affects the low temperature region.

3. RESULTS
In this section, we analyze the performance of the LTRAC method compared with previous methods. We investigated three different methods for treating the unresolved transition region: one uses the classical Spitzer-H¨arm conduction without applying any broadening technique (denoted as SH for brevity); one uses the TRAC method; and one uses the LTRAC method.

3.1. Overall structure
The time variation of the spatially averaged variables calculated with a uniform grid size of 50 km is shown in Fig. 1. The variables at the loop top are averaged over the interval of 0.6LsL, whereas the variables at the footpoint are averaged over 4 Mm s 6 Mm. The high-resolution reference solution is calculated using the SH method with a grid size near the transition region of 100 m. We refer the reader to Appendix A for the details of the reference solution. The temperature of the under-resolved SH solution (with the grid size of 50 km) slightly deviates from the reference solution. A larger deviation of the under-resolved SH solution from the reference solution can be observed in the mass density (Bradshaw & Cargill 2013). The mass density at the loop top is more than 30 percent smaller than that of the reference solution. In contrast, the numerical solutions obtained using the TRAC or LTRAC methods show good agreement with the reference solution. For the variation of the mass density and velocity, the LTRAC solution is slightly close to the reference solution. The maximum value of the broadening factor fc in the LTRAC solution is about one order of magnitude smaller than that in the TRAC solution. The smaller value of fc implies smaller thermal conduction coefficients, which is advantageous if the thermal conduction term is integrated explicitly.
The maximum value of the broadening factor fc in the LTRAC method shows temporal oscillation as shown in Figure 1. We could not fully understand its origin, but the oscillatory nature may be caused by a kind of feedback between the broadening effect of the transition region by the LTRAC method and the thinning effect from the nature of the transition region. For a better understanding, we checked the dependence on the size of time stepping by running the simulation with 10 times smaller time step size. If the oscillatory nature of fc is due to the time discretization error in the evaluation of r and fc in Eqs. (17) and (18), it should depend on the size of time stepping. However, the temporal variation of fc in the smaller time step size was almost the same as in Fig. 1. We also checked the dependence on the LTRAC parameter p. Note that as discussed in Appendix B, the larger p is, the larger fc is expected to be. If the

7
Figure 1. Time variation of the temperature at the loop top (top left), the mass density at the loop top (top right), the velocity at the footpoint (bottom left), and the maximum value of the transition region broadening factor fc (bottom right). The coronal loop is heated using a spatially uniform volumetric heating term from t = 0 s to t = 600 s (see Sec. 2.1 for details). Shown are the numerical solutions calculated using the SH method (orange line with crosses), using the TRAC method (green line with circles), and using the LTRAC method (red line with diamonds). The reference solution is shown as a blue line with plus signs. A uniform grid size of 50 km is used except for the reference. oscillatory nature of fc is caused by the feedback between the broadening effect by the thermal conduction (enhanced by fc) and the decrease in fc (due to the smoothed temperature gradient), the period of the temporal variation of fc would depend on the parameter p. However, the period of the oscillation did not show strong dependence on the parameter p. Therefore, the oscillatory nature of fc may not be due to the thermal conduction nor the temporal discretization, but to other processes associated with the thinning of the transition region, like the radiative cooling and/or acoustic waves (related to the hydrostatic equilibrium).
Figure 2 shows the spatial variation of the temperature, mass density, velocity, and the transition region broadening factor fc at the snapshot of 800 s. Similar to the spatially averaged variables in Fig. 1, the under-resolved SH solution exhibits the largest difference from the reference solution, and the LTRAC solution is closest to the reference solution. The spatial profiles of the temperature and mass density obtained using the TRAC and LTRAC methods are close to the reference profile. In terms of the spatial profile of the velocity, both the TRAC and LTRAC solutions deviate from the reference solution by at least several km. In addition, the velocity profiles from the TRAC and LTRAC solutions are not as smooth as that of the reference solution, which may be a numerical artifact. An important difference between the TRAC and LTRAC methods can be observed in the spatial profile of the broadening factor fc. The value of fc in the LTRAC solution increases only in the transition region, whereas that value in the TRAC solution increases

8
Figure 2. Spatial variation along a coronal loop at t = 800 s. Shown are the temperature (top left), the mass density (top right), the velocity (bottom left), and the transition region broadening factor fc (bottom right), The notation is same as that in Fig. 1. all the way from the surface (s = 0) to the transition region. Considering the good agreement of the LTRAC solution to the reference solution, the increased broadening factor fc in the upper chromosphere of the TRAC solution is not necessary to reproduce the dynamics and energetics of the coronal plasma. Moreover, the redundant enhancement of thermal conduction in the upper chromosphere may lead to weak chromospheric evaporation, which causes excess of low temperature emission, as shown in Sec. 3.2.
3.2. Effects on spectroscopic observables To evaluate the performance of the LTRAC method on spectroscopic observables, we used the velocity DEM described in Sec. 2.3. Figure 3 shows the quantities calculated from the VDEM and temporally averaged from 10 s to 1500 s. The DEM from the under-resolved SH solution shows the largest deviation from the reference solution from the transition region temperature to the coronal temperature. From the resolution dependence within the range of 6.25 km  s  100 km, we found that the under-resolved SH solution always overestimates (underestimates) the DEM in T < 105.2 K (T > 105.2 K). The DEM from the TRAC solution is close to that from the reference solution in T > 105.4 K. However, the TRAC solution overestimates the DEM in lower temperatures of T < 105.4 K. This excess of low temperature emission in the TRAC solution was observed even when a finer grid size was used. We speculate that enhanced thermal conduction in the upper chromosphere to the lower transition region in the TRAC solution may be heating the high density, cool plasma in the lower layers and enhancing the emission measure in the upper transition region. In contrast, the LTRAC method successfully reproduces the DEM in the wider temperature range

9
Figure 3. Time averaged DEM (top left) and the velocity DEM averaged over the temperature intervals of [105.0, 105.5] K (top right), [105.5, 106.0] K (bottom left), and [106.0, 107.0] K (bottom right). The notation is same as that in Fig. 1. of T > 105.0 K. This result indicates the advantage of the localized broadening factor used in the LTRAC method. In the lowermost temperature of T < 105.0 K, a slight lack of the emission measure can be observed. The LTRAC solution was found to show smaller DEM even in the higher resolution (down to s = 6.25 km) in this temperature range. We also note that the lack/excess of the emission measure in T < 105.0 K depends on the parameter p in the LTRAC method (see Appendix B).
We averaged the velocity DEM over the temperature intervals [105.0, 105.5], [105.5, 106.0], and [106.0, 107.0] K to mimic a line profile produced by the optically thin emission. The resulting profile differs from the actual line profile (calculated using the coronal approximation) because the temperature-averaged VDEM profile does not include broadening processes (e.g., thermal or instrumental broadenings). However, we believe that at least a part of the effect of the LTRAC method on spectroscopic observables can be investigated using the VDEM. The velocity dependence of the VDEM from the under-resolved SH solution deviates from the reference solution, especially in the lower temperature intervals. The VDEM profile from the TRAC solution agrees well for T > 105.5 K with the reference profile, but it deviates slightly in lower temperature. In contrast, the VDEM profile calculated from the LTRAC solution shows better agreement with that of the reference solution, especially in the low temperature interval.
To evaluate the differences in the VDEM more quantitatively, we calculated the time variation of the velocity moments of the VDEM as shown in Fig. 4. The velocity shift Vshift and velocity width Vwidth for the temperature

10

Figure 4. Time variation of the emission measure (top row), the velocity shift (middle row), and the velocity width (bottom row), calculated from the VDEM averaged over the temperature intervals of [105.0, 105.5] K (left column), [105.5, 106.0] K (middle column), and [106.0, 107.0] K (right column). The notation is same as that in Fig. 1.

interval T0 < T < T1 are defined as

Vshift =

T1
V ·VDEM(T, V)dV dT /
T0 V

T1
VDEM(T, V)dV dT
T0 V

(24)

and

Vwidth =

T1

T1

V 2VDEM(T, V)dV dT /

VDEM(T, V)dV dT ,

T0 V

T0 V

(25)

respectively. All of the SH, TRAC, and LTRAC solutions produce oscillatory behavior in the lower temperature interval, because fewer grid points are used for calculating the VDEM in the transition region. The temporal oscillation of the under-resolved SH solution is the most significant because the transition region is resolved by only a few grid points in the numerical solution. As the TRAC and LTRAC solutions both have more grid points in the transition region, the temporal oscillation is slightly suppressed using these two methods. Among the three methods, we found that the LTRAC solution exhibits the smallest temporal oscillation and provides the best agreement with the reference solution. The LTRAC solution can reproduce the velocity shift and width within the difference of several km/s to the reference solution even with a coarse grid size of 50 km.

11 3.3. Convergence analysis
Figure 5. Convergence of the spatially averaged variables as function of the grid size. Shown are the mean absolute errors measured by the temperature at the loop top (top left), the mass density at the loop top (top right), and the velocity at the footpoint (bottom left), as well as the maximum value of the broadening factor fc (bottom right). The results for the SH method (blue line with plus signs), the TRAC method (orange line with crosses), and the LTRAC method (green line with circles) are shown.
Figure 5 shows a convergence analysis of the spatially averaged variables (shown in Fig. 1). The error is defined as the mean absolute difference from the reference solution. The convergence rate of the SH method is very small (less than first-order with respect to the grid size s). The TRAC method shows similarly slow convergence, although the absolute value of the error is much smaller than that of the SH method. The LTRAC method produces slightly faster convergence of the temperature at the loop top and of the velocity at the footpoint. The mass density at the loop top in the LTRAC method displays irregular convergence for s25 km. We speculate that the mass density of the LTRAC simulation with s=25 km accidentally approached the value in the reference solution. In the high resolution range of s12.5 km, both the mass density and the velocity of the LTRAC solutions exhibit slow convergence, similar to the SH and TRAC methods. These results indicate that, although the TRAC and LTRAC methods both yield smaller deviations from the reference solution, the rate of convergence in the high resolution simulation may not be significantly improved from the SH method. We also measured the dependence of the broadening factor fc on the grid size by the time average of the spatial maximum. The values of the broadening factor fc in the TRAC and LTRAC solutions show approximately a first-order convergence rate.

12
Figure 6. Convergence of the VDEM against the grid size. Shown are the mean relative error of the emission measure (top row), the mean error of the velocity shift (middle row), and the mean absolute error of the velocity width (bottom row), calculated from the VDEM averaged over the temperature intervals of [105.0, 105.5] K (left column), [105.5, 106.0] K (middle column), and [106.0, 107.0] K (right column). The notation is same as that in Fig. 5.
We also analyzed the convergence of the emission measure, the velocity shift, and the velocity width as shown in Figure 6. The LTRAC method shows the smallest error in the emission measure among the three methods, in all three temperature intervals: [105.0, 105.5], [105.5, 106.0], and [106.0, 107.0] K. The convergence of the emission measure is slow, which may be due to the slow convergence of the mass density shown in Fig. 5. The velocity shift and width show better convergence rates (especially in the LTRAC solutions), but the grid convergence are less than first-order. The errors in the velocity shift and width in the LTRAC solutions are less than 2 km/s even when a coarse grid size of 50 km is used. These results suggest that the Doppler shift and non-thermal line width of the synthesized optically thin line emission from the LTRAC solution may be accurate enough to be compared with spectroscopic observations.
4. DISCUSSION From the nature of the transition region, a large number of grid points is required to resolve this thin layer fully. In this study, we have proposed a new numerical method, called the LTRAC method, which enables the physically accurate coronal dynamics and energetics to be obtained with a coarse grid size. Following the strategy of Lionello et al. (2009) and Johnston & Bradshaw (2019), the LTRAC method broadens the unresolved transition region by modifying the thermal conduction coefficient and the radiative cooling rate. The major difference between the LTRAC method and the previous methods is that the broadening factor of the transition region is concentrated only in the region with the high temperature gradient. The localized broadening factor provides better reproduction of the emission measure

13
especially in the lower temperature region, which may result from the suppression of excess conductive heating in the upper chromosphere observed in the previous methods. We investigated the possible effect of the Doppler velocity and the non-thermal broadening of optically thin emission lines the velocity DEM from the numerical solutions. We found that the synthesized profile of the optically thin line emission is reproduced within a error of several km/s with a coarse grid size of 50 km. The LTRAC method is designed so that it can be extended to multidimensional simulations using the domain decomposition technique. Application of the LTRAC method to multidimensional coronal heating models (e.g. Gudiksen et al. 2011; Iijima & Yokoyama 2015, 2017; Rempel 2017; Abbett 2007) will allow us to reproduce the wave reflection rate at the transition region and the energy loss from the corona more accurately with a coarse grid spacing.
In this paper, we evaluated the performance of the proposed method using one-dimensional hydrodynamic simulations of a coronal loop in an active region. In flaring loops with higher temperatures, the accuracy of the coarse-resolution simulations may be worse than that for cooler loops. It should be noted that we assumed a uniform volumetric heating rate in this study. The performance of the proposed method should be tested with a wider range of numerical settings, including a spatially non-uniform heating rate. However, we believe that the proposed method will be effective even in such problems, as the free parameters in the LTRAC method determines the sensitivity based only on the normalized temperature gradient and are not chosen for specific problems.
We have ignored the realistic physical processes such as the non-equilibrium ionization or the effect of optical thickness in this study. The numerically broadened transition region may require the special care on these processes. For example, in calculating the VDEM (Sec. 2.3), we accounted for the broadening factor fc by reducing the effective line-of-sight distance by a factor of 1/fc (see Eq. (23)), which hopefully conserves the total emission measure from the artificially broadened region. Similarly, in calculating the optical thickness, the line-of-sight distance must be modified to account for the broadening factor. Modification non-equilibrium ionization process may be also required. If we assume that an ion moves across the broadened transition region at a constant velocity, the total number of radiative/collisional reactions the ion undergoes may increase by a factor of fc. To prevent this artifact, the reaction rates should also be reduced by the broadening factor fc. We emphasize that these suggestions are mere speculations, and they should be verified more precisely in a future study.
ACKNOWLEDGMENTS
H. I. was supported by JSPS KAKENHI grant No. JP19K14756. This work was supported by the computational joint research program of the Institute for Space-Earth Environmental Research (ISEE), Nagoya University. The numerical simulations were performed in the Center for Integrated Data Science, Institute for Space-Earth Environmental Research, Nagoya University through the joint research program.
APPENDIX
A. CONVERGENCE OF THE REFERENCE SOLUTION
As the requirement on the grid size is extremely severe in the transition region, we were not able to resolve the transition region fully. Figure 7 compares high-resolution runs obtained by the SH, TRAC, and LTRAC methods. The non-uniform grid spacing is used with the grid size of 100 m near the transition region. The variations of the temperature, mass density, and velocity field calculated by these three methods are very close to each other, which implies that the numerical solutions are roughly converged at this grid size. If the transition region in the numerical solution is fully resolved, the normalized temperature gradient of Eq. (17) should be smaller than the critical value (exp(c) for the TRAC method and rc for the LTRAC method), which implies that the maximum value of the fc should be unity in both the TRAC and LTRAC methods. The nearly constant (but larger than unity) value of fc in the TRAC solution after 1000 s occurs because the lower limit of Tc is set to 2 × 104 K. Unfortunately, max(fc) in the LTRAC solution is about 5, which indicates that the numerical grid size should be 20 m or less to obtain a truly converged solution (in the sense that the LTRAC solution becomes exactly identical to the SH solution). Such a high resolution simulation is difficult to achieve even in a one-dimensional domain as we do not use the adaptive mesh refinement. This requirement that the grid size be less than 20 m is consistent with the estimate obtained using the

14
Figure 7. Time variation of the temperature at the loop top (top left), the mass density at the loop top (top right), the velocity at the footpoint (bottom left), and the maximum value of the broadening factor fc (bottom right). Shown are the numerical solutions calculated using the SH method (orange line with times symbol), using the TRAC method (green line with circle symbol), and using the LTRAC method (red line with diamond symbol). The non-uniform grid spacing is used with the grid size of 100 m near the transition region. static loop model of Rosner et al. (1978), which predicts that the thickness of the transition region is about 400 m for a loop top temperature of 4 MK (see Sec. 1). The results presented in this paper do not depend on the choice of the reference solution, except for the the convergence rates of the highest resolution runs (grid sizes less than 20 km) in Appendix B. In this study, we use the SH solution with the grid size of 100 m as the reference solution.
B. DEPENDENCE ON LTRAC PARAMETERS The LTRAC method employs two parameters, the critical value rc of the temperature gradient and the acceleration factor p. Here, we briefly investigate the dependence of the LTRAC solutions on these parameters. Figure 8 shows the dependence of the convergence rates on the LTRAC parameter p, fixing the value of rc to be 1.5. Clearly, a larger value of p produces faster grid convergence. The error in the LTRAC method with p = 2 is similar to that of the TRAC method (Fig. 5). Figure 9 shows the dependence of the convergence rate on rc, with the value of p fixed to 4.0. The result is not very sensitive to the parameter rc, although a smaller rc tends to produce smaller errors and larger values of the broadening factor fc. The reader may notice that the mass density of rc = 1.2 apparently converges to the reference value regularly. However, we note that this reqular convergence may be produced by the insufficient resolution of the reference solution. If we use the high-resolution LTRAC run as a reference, the mass density shows irreqular

15

Figure 8. Same as Fig. 5 but showing the dependence on the LTRAC parameter p. The results for p = 1 (blue line with plus signs) p = 2 (orange line with crosses), p = 3 (green line with circles), and p = 4 (red line with diamonds) are shown.
convergence in all values of rc. We chose the typical value rc = 1.5 so that the threshold of the temperature gradient would be close to the value in the TRAC method (so as to exp(c)rc).
In Sec. 2.3, we have mentioned a small lack of the low temperature DEM in T < 105.0 K found in the LTRAC solution. The lack and excess of the DEM in this low temperature range depends on the parameter p. Fig. 10 shows the parameter dependence of the DEM. The uniform grid size of 50 km is used except the reference solution. In the cases of smaller p-value (i.e., p2), the emission measure in T < 105.0 K tends to show slight excess, in contrast to the cases for p3. This dependence on the parameter p was observed independently of the spatial resolution (down to s = 6.25 km). This result may imply that the optimal parameter of p lies between 2 and 3 in terms of the DEM reproducibility. We found that the dependence of the low temperature DEM on the parameter rc is not significant.

REFERENCES

Abbett, W. P. 2007, ApJ, 665, 1469, doi: 10.1086/519788 Bradshaw, S. J., & Cargill, P. J. 2006, A&A, 458, 987,
doi: 10.1051/0004-6361:20065691 --. 2013, ApJ, 770, 12, doi: 10.1088/0004-637X/770/1/12 Bradshaw, S. J., & Klimchuk, J. A. 2011, ApJS, 194, 26,
doi: 10.1088/0067-0049/194/2/26

Brooks, D. H., & Warren, H. P. 2016, ApJ, 820, 63, doi: 10.3847/0004-637X/820/1/63
Carlsson, M., & Stein, R. F. 1992, ApJL, 397, L59, doi: 10.1086/186544
Chae, J., Yun, H. S., & Poland, A. I. 1998, ApJS, 114, 151, doi: 10.1086/313064

16

Figure 9. Same as Fig. 5 but showing the dependence on the LTRAC parameter rc. The results for rc = 1.2 (blue line with plus signs) rc = 1.5 (orange line with crosses), and rc = 2 (green line with circles) are shown.

Cheung, M. C. M., De Pontieu, B., Mart´inez-Sykora, J., et al. 2019, ApJ, 882, 13, doi: 10.3847/1538-4357/ab263d
Craig, I. J., Robb, T. D., & Rollo, M. D. 1982, SoPh, 76, 331, doi: 10.1007/BF00170990
Del Zanna, G., & Mason, H. E. 2018, Living Reviews in Solar Physics, 15, 5, doi: 10.1007/s41116-018-0015-3
Doschek, G. A., Mariska, J. T., Warren, H. P., et al. 2007, ApJL, 667, L109, doi: 10.1086/522087
Fisher, G. H., Canfield, R. C., & McClymont, A. N. 1985, ApJ, 289, 414, doi: 10.1086/162901
Gudiksen, B. V., Carlsson, M., Hansteen, V. H., et al. 2011, A&A, 531, A154, doi: 10.1051/0004-6361/201116520
Gudiksen, B. V., & Nordlund, °A. 2005, ApJ, 618, 1020, doi: 10.1086/426063
Hollweg, J. V. 1984, SoPh, 91, 269, doi: 10.1007/BF00146299
Iijima, H. 2021, Journal of Computational Physics, 435, 110232, doi: 10.1016/j.jcp.2021.110232

Iijima, H., & Yokoyama, T. 2015, ApJL, 812, L30, doi: 10.1088/2041-8205/812/2/L30
--. 2017, ApJ, 848, 38, doi: 10.3847/1538-4357/aa8ad1 Imada, S., Hara, H., & Watanabe, T. 2009, ApJL, 705,
L208, doi: 10.1088/0004-637X/705/2/L208 Imada, S., Hara, H., Watanabe, T., et al. 2008, ApJL, 679,
L155, doi: 10.1086/589444 Jameson, A. 1995, International Journal of Computational
Fluid Dynamics, 4, 171, doi: 10.1080/10618569508904524 Johnston, C. D., & Bradshaw, S. J. 2019, ApJL, 873, L22,
doi: 10.3847/2041-8213/ab0c1f Johnston, C. D., Cargill, P. J., Hood, A. W., et al. 2020,
A&A, 635, A168, doi: 10.1051/0004-6361/201936979 Johnston, C. D., Hood, A. W., Cargill, P. J., & De Moortel,
I. 2017a, A&A, 597, A81, doi: 10.1051/0004-6361/201629153 --. 2017b, A&A, 605, A8, doi: 10.1051/0004-6361/201730486

17

Figure 10. Dependence of the time averaged DEM on the LTRAC parameter p. The results for p = 1 (orange line with crosses), p = 2 (green line with circles), p = 3 (red line with diamonds), p = 4 (purple line with boxes), and the reference (blue line with plus signs) are shown.

Klimchuk, J. A. 2006, SoPh, 234, 41, doi: 10.1007/s11207-006-0055-z
--. 2015, Philosophical Transactions of the Royal Society of London Series A, 373, 20140256, doi: 10.1098/rsta.2014.0256
Linker, J. A., Lionello, R., Miki´c, Z., & Amari, T. 2001, J. Geophys. Res., 106, 25165, doi: 10.1029/2000JA004020
Lionello, R., Linker, J. A., & Miki´c, Z. 2009, ApJ, 690, 902, doi: 10.1088/0004-637X/690/1/902
Matsumoto, T. 2018, MNRAS, 476, 3328, doi: 10.1093/mnras/sty490
Miki´c, Z., Lionello, R., Mok, Y., Linker, J. A., & Winebarger, A. R. 2013, ApJ, 773, 94, doi: 10.1088/0004-637X/773/2/94
Newton, E. K., Emslie, A. G., & Mariska, J. T. 1995, ApJ, 447, 915, doi: 10.1086/175929
Patsourakos, S., & Klimchuk, J. A. 2005, ApJ, 628, 1023, doi: 10.1086/430662
Peter, H., & Judge, P. G. 1999, ApJ, 522, 1148, doi: 10.1086/307672
Reale, F. 2010, Living Reviews in Solar Physics, 7, 5, doi: 10.12942/lrsp-2010-5

Rempel, M. 2017, ApJ, 834, 10, doi: 10.3847/1538-4357/834/1/10
Rosner, R., Tucker, W. H., & Vaiana, G. S. 1978, ApJ, 220, 643, doi: 10.1086/155949
Shu, C.-W., & Osher, S. 1988, Journal of Computational Physics, 77, 439, doi: 10.1016/0021-9991(88)90177-5
Teriaca, L., Banerjee, D., & Doyle, J. G. 1999, A&A, 349, 636
Testa, P., De Pontieu, B., & Hansteen, V. 2016, ApJ, 827, 99, doi: 10.3847/0004-637X/827/2/99
van Ballegooijen, A. A., Asgari-Targhi, M., Cranmer, S. R., & DeLuca, E. E. 2011, ApJ, 736, 3, doi: 10.1088/0004-637X/736/1/3
van Ballegooijen, A. A., Asgari-Targhi, M., & Voss, A. 2017, ApJ, 849, 46, doi: 10.3847/1538-4357/aa9118
Verdini, A., Grappin, R., & Velli, M. 2012, A&A, 538, A70, doi: 10.1051/0004-6361/201118046
Zhou, Y.-H., Ruan, W.-Z., Xia, C., & Keppens, R. 2021, A&A, 648, A29, doi: 10.1051/0004-6361/202040254

