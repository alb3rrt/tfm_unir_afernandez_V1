arXiv:2106.00616v1 [math.ST] 31 May 2021

HALFSPACE DEPTH FOR GENERAL MEASURES: THE RAY BASIS THEOREM AND ITS CONSEQUENCES
PETRA LAKETA AND STANISLAV NAGY
Abstract. The halfspace depth is a prominent tool of nonparametric multivariate analysis. The upper level sets of the depth, termed the trimmed regions of a measure, serve as a natural generalization of the quantiles and inter-quantile regions to higher-dimensional spaces. The smallest non-empty trimmed region, coined the halfspace median of a measure, generalizes the median. We focus on the (inverse) ray basis theorem for the halfspace depth, a crucial theoretical result that characterizes the halfspace median by a covering property. First, a novel elementary proof of that statement is provided, under minimal assumptions on the underlying measure. The proof applies not only to the median, but also to other trimmed regions. Motivated by the technical development of the amended ray basis theorem, we specify connections between the trimmed regions, floating bodies, and additional equi-affine convex sets related to the depth. As a consequence, minimal conditions for the strict monotonicity of the depth are obtained. Applications to the computation of the depth and robust estimation are outlined.
1. Introduction: Characterization of the halfspace median
The lack of natural ordering of the points in multidimensional spaces makes the nonparametric analysis of multivariate data challenging. The depth introduces a datadependent ordering of the sample points, in the direction from the most central observations being those that attain high depth values, to the peripheral ones with low depth [13, 32, 34, 4]. A definition of depth-based central regions of the data, which are the regions where the depth exceeds given thresholds, ensues naturally. The smallest non-empty depth region is often termed the depth median set of the data. The depth medians provide convenient robust location estimators, well studied in the literature.
We consider the seminal halfspace (or Tukey) depth, and the general setup of finite Borel (not necessarily probability) measures. Write Rd for the d-dimensional Euclidean space equipped with the inner product ·, · , and Sd-1 for the unit sphere in Rd. The set of all closed halfspaces in Rd is denoted by H. Elements of H can be represented as
Hx,u = y  Rd : x, u  y, u
for x  Rd a point in the boundary hyperplane and u  Sd-1 the inner unit normal of Hx,u. We write H(x) = Hx,u : u  Sd-1 for all halfspaces whose boundary passes through x  Rd. The collection of all finite Borel measures on Rd is denoted by M Rd . The halfspace depth was first considered by Tukey [28] and later substantially elaborated on by Donoho and Gasko [5]. The halfspace depth of a point x  Rd with respect to
Charles University, Faculty of Mathematics and Physics, Prague, Czech Republic E-mail addresses: nagy@karlin.mff.cuni.cz. Date: June 2, 2021.
1

2

RAY BASIS THEOREM

(w.r.t.) a measure µ  M Rd is defined as

(1)

D(x; µ) = inf µ(H) = inf µ(H).

H H(x)

H H,xH

The two expressions for the depth are easily seen to be equivalent. Our principal interest
lies in the concept of the depth-trimmed regions (also called central regions) of µ, defined for   R by D(µ) = x  Rd : D (x; µ)   . It is a simple observation that the regions D(µ) are always closed convex sets, non-increasing in   R in the sense of set inclusion. For   0 we have D(µ) = Rd; for all  large enough D(µ) = . The supremum of all  such that D(µ) =  is denoted by (µ). We call the set D(µ) the (halfspace) median set of µ, and denote it by D (µ). The median set is always non-empty and compact. Elements of D (µ) are called (halfspace) medians of µ. Any halfspace H  H(x) that satisfies D(x; µ) = µ(H) is called a minimizing halfspace of µ at x  Rd.
The so-called ray basis theorem provides a convenient characterization of a halfspace
depth median of a measure µ in terms of its minimizing halfspaces. In its simplest form, the theorem asserts that for measures µ  M Rd with continuous and positive density, a point x  Rd is a halfspace median of µ if and only if the collection of its minimizing halfspaces covers the whole space Rd. That result was first proved by Donoho and Gasko
[5, Claim on p. 1818], and later extended in Rousseeuw and Ruts [24, Propositions 8
and 12]. For the special case of uniform measures on convex bodies, such a characteri-
zation of the deepest point relates to an early observation of Gru¨nbaum [9, p. 251] from
convex geometry. For details and additional discussion about the ray basis theorem, its
history and relevance in both statistics and geometry see [20, Section 4.3.1] and [22].
Our initial goal is to revisit the ray basis theorem, and consolidate its statement by extending it to any depth region D(µ) of a general measure µ  M Rd , under minimal assumptions.1 We do so in Section 2, where tools from convex geometry are employed to
devise an elementary proof of a generalized version of the theorem. We provide conditions
under which it is possible to cover the complement to D(µ) by halfspaces of µ-mass . As a special case, we obtain connections between the median set, and the set of all points that allow covering Rd by their minimizing halfspaces. An important part of our contribution
are the examples, that throughout the paper demonstrate that the conditions stated in
our main results cannot be avoided.
In Section 3 we thoroughly discuss the links of our general ray basis theorem with the
properties of the central regions D(µ). It is known from the literature [24, Proposition 6] that, writing Ac for the complement to A  Rd in Rd,

(2)

D(µ) = {H  H : µ(Hc) < } .

Each D(µ) is thus an intersection of closed convex sets, and must be closed and convex itself. We begin from (2), and specify relations between the central regions D(µ), the trimmed regions as considered in [21, 17] and [29, Section 3.9.4.6], and the floating body
known from convex geometry [2, 20].
Our paper is concluded with three applications of our results in Section 4. The set of depth medians D (µ) is not necessarily a single point set. Especially for empirical

1The extension of these results from Borel probability measures to finite Borel measures on Rd is minor. By our treatment of general measures we mean generalizations of the ray basis theorem and related results to measures from M Rd that do not have to possess positive densities, or satisfy other
simplifying conditions concerning, e.g., their support.

RAY BASIS THEOREM

3

measures µ, that is measures corresponding to datasets, the median set is frequently fulldimensional. In Section 4.1 we propose to single out the collection of those medians that satisfy an additional covering property. We obtain a smaller collection of covering medians of µ, which share qualitatively better properties than the general elements of D (µ). An algorithm for finding covering medians is given. In Section 4.2 we obtain a consequence of the general ray basis theorem regarding the structure of the central regions D(µ) for µ an empirical measure. In that case, each facet F of the convex polytope D(µ) is shown to lie in a hyperplane determined by data points. This observation promises applications in the computation of the trimmed regions D(µ) also in the case when they are not fulldimensional, in a spirit similar to that lately employed in [15]. Finally, in Section 4.3 we provide, as an interesting by-product of our study, the minimal set of assumptions that guarantees the depth to be strictly monotone. As argued by Dyckerhoff [8, Example 4.2], strict monotonicity is one of the most important properties a depth can have. For a depth w.r.t. a probability measure µ, it ensures the almost sure uniform convergence of the depth upper level sets estimated from the data towards their population counterparts. As such, sufficient conditions for strict monotonicity find applications in the estimation of the depth-trimmed regions D(µ) from data in multivariate statistics. The proofs of all theoretical results are provided in an extensive appendix accompanying the paper.

1.1. Preliminaries and notation. In the proofs of our results, we use tools from measure theory, as well as from the theory of convex sets. Our general reference to the concepts used from convexity theory is [25]. We now set the most important notations used in the paper, and state a preliminary observation about the halfspace depth that will be useful later. For a set A  Rd its interior, closure and boundary are denoted by int (A), cl (A) and bd (A), respectively. Denote by aff (A) and conv (A) the affine hull and the convex hull of A. The sets relint (A), relcl (A) and relbd (A) represent the (relative) interior, closure and boundary of A in the space aff (A), and dim A = dim (aff (A)) is the dimension of A. The complement to A is Ac = Rd \ A. For sets A and B we write A  B if A  B and A = B. We say that H  H is a touching halfspace of a non-empty convex set A if H  cl (A) =  and int (H)  A = . The collection of all touching halfspaces to A is denoted by H(A). We also define H() = H. In this notation, H(x) is the same as H({x}) for x  Rd.
Well-behaved measures. We say that µ  M Rd is smooth if µ(bd (H)) = 0 for each H  H. We call µ smooth at a convex set A  Rd if µ(bd (H)) = 0 for all H  H(A), and smooth at a point x  Rd if it is smooth at {x}. Smoothness of µ at a point is a condition stronger than µ being atom-less; yet, it is still weaker than smoothness in the whole Rd. A measure µ is said to have contiguous support if the support of µ cannot be separated by a slab between two parallel hyperplanes of non-empty interior with zero µ-mass. Finally, µ is said to have contiguous support at a convex set A  Rd if
(3) for each H  H(A) and H  H  H, bd (H)  int (A) =  implies µ(H) < µ(H).
Note that the condition (3) is void if int (A) = , and therefore it is enough to consider A full-dimensional. In that case, (3) means that any shift H  H of a touching halfspace H of A has µ-mass larger than H. It is satisfied if, for instance, the set A is a subset of the support of µ. An absolutely continuous measure is smooth (at any A convex). A measure with connected support has contiguous support (at any convex subset A of the support of µ).

4

RAY BASIS THEOREM

Minimizing halfspaces. For x  Rd recall that H  H(x) is a minimizing halfspace of µ  M Rd at x if D(x; µ) = µ(H). In general, the set of minimizing halfspaces of µ at a point may be empty. It is guaranteed to be non-empty if, for instance, the measure µ is smooth at x. Our first observation that will prove to be useful in the sequel is that it is always possible to find H  H(x) with the property µ(int (H))  D (x; µ). We call such a halfspace H a generalized minimizing halfspace of µ at x.
Lemma 1. For any µ  M Rd there exists a generalized minimizing halfspace of µ at any point x  Rd. If µ is smooth at x, then there exists a minimizing halfspace of µ at x.

Additional notations. In addition to the upper level set of the halfspace depth D(µ) = x  Rd : D (x; µ)   , we also consider the set
U(µ) = x  Rd : D(x; µ) >  = D(µ).
>
It is convex, but not always closed. As will be seen later in the paper, the set U(µ) is also not open in general. Both D(µ) and U(µ) are bounded for  > 0.
A face of a convex set A is a convex subset F  A such that x, y  A and (x+ y)/2  F implies x, y  F . Denote by F (A) the set of all faces of cl (A). A facet of A is a face of A of dimension dim(A) - 1. For F  F (A) and A convex, denote by H(A, F ) = {H  H(A) : F  bd (H)} the collection of all halfspaces touching A at its face F . We say that a sequence of halfspaces {Hxn,un} n=1  H converges to Hx,u  H if xn  x in Rd and un  u in Sd-1.
We write L(x, y) and L[x, y] for the relatively open (that is, not containing x and y) and the relatively closed (containing x and y) line segment between distinct point x, y  Rd, respectively, and l(x, y) for the infinite line determined by x and y.

2. The general ray basis theorem

The standard ray basis theorem, as dubbed by Rousseeuw and Ruts [24], asserts that under certain conditions on a measure µ  M Rd , the halfspace median x of µ is characterized by the fact that Rd can be covered by minimizing halfspaces of x. The
formal statement of the theorem is given below.

Theorem 2 ([24, Propositions 8 and 12]). For µ  M Rd , the following holds true: (i) If for some x  Rd

(4)

Rd = {H  H(x) : µ(H) = D(x; µ)} ,

then x is a median of µ, i.e. D(x; µ) = (µ). (ii) If x is a median of µ and, in addition, µ is absolutely continuous with a density
that is continuous and positive in an open convex set, then (4) is true for x.

The proof of the direct part (i) of Theorem 2 is simple: since Rd is covered by halfspaces of µ-mass exactly D(x; µ), each y  Rd must be contained in such a halfspace Hy, and consequently D(y; µ)  µ(Hy) = D(x; µ), as follows directly from the definition of the halfspace depth (1). The proof of the so-called inverse ray basis theorem, stated in
part (ii), is slightly more involved, and technical. Our aim is to obtain a result similar
to Theorem 2 for any depth region D(µ), under minimal conditions. We prove that for well-behaved measures it is possible to cover all points outside int (D(µ)) with closed halfspaces H whose µ-mass is bounded from above by . For measures that may not be

RAY BASIS THEOREM

5

smooth the appropriate formulation of the latter condition turns out to be µ(int (H))  . In the following lemma we introduce a condition that will play an important role in the formulation of the extended ray basis theorem. We treat not only the depth-trimmed regions D(µ), but also U(µ), as well as their interiors.

Lemma 3. Let µ  M Rd ,   R and S  {D(µ), U(µ), int (D(µ)) , int (U(µ))}. Then

(5)

Sc  (int (S))c  {H  H : µ(int (H))   and int (H)  S = }.

Application of Lemma 3 to the median set S = int (D (µ)) gives a slightly weaker version of the standard inverse ray basis theorem. Suppose that the measure µ  M Rd satisfies the conditions of part (ii) of Theorem 2. First, it is not difficult to observe that for such µ our auxiliary Lemma 1 about the existence of a generalized minimizing halfspace ensures that the median set D (µ) cannot be full-dimensional.2 Because the median set is always convex, it is not full-dimensional if and only if its interior is empty. Therefore, for any µ with a positive continuous density, Lemma 3 gives that the whole space can be covered by halfspaces (i) of µ-mass at most (µ); and (ii) without a particular connection to any fixed point x  D (µ).
Our intention is now to extend the results of Lemma 3 by restricting the halfspaces on the right hand side of (5) to only those that touch S, i.e. to the collection H(S). For that purpose, we introduce additional notation.
Definition. For a convex set A  Rd and a point x / int (A) define

F(x, A) =

{F  F (A) : relint (conv (F  {x}))  cl (A) = } {F  F (A) : x  relint (F )}

if x / cl (A) , if x  bd (A) .

The collection F(x, A) consists of those faces of the closed convex set cl (A) that are completely visible from a point x / int (A). Note that F  F(x, A) implies dim(F ) < d, and that F(x, ) = {}. The concept of visible faces relates to the theory of illumination of convex bodies by external light sources [1]; for its application to the statistics of the depth see [19]. Note that any point x / int (A) illuminates at least one non-empty face of a non-empty convex set A; for details see Lemma 17 presented in the Appendix.
Now we are able to extend Lemma 3 to the touching halfspaces. Starting from (5), our intention is to find H  H(S) that covers x / S given, with the properties as on the right hand side of (5). The main idea is to approach any point y  F  F (x, S) by a sequence {yn} n=1  (cl (S))c, that converges to y from the outside of S. Lemma 3 gives that for each yn there is a halfspace Hn  yn whose interior has empty intersection with S and µ(int (Hn))  , see the left hand panel of Figure 1. Since yn  y, there exists a convergent subsequence of {Hn} n=1 whose limiting halfspace H can be shown to be touching S, containing x, and satisfying µ(int (H))  , as we wanted to show. The formal proof of Lemma 4 is postponed to the Appendix.
Lemma 4. Consider µ  M Rd and a bounded convex set S  Rd satisfying (5) with   R. For any x / S and F  F(x, S) there exists H(x, F )  H(S, F ) such that x  H(x, F ) and µ(int (H(x, F )))  . In particular,
Sc  (int (S))c = {H  H(S) : µ(int (H))  } .

2This claim is proved under weaker conditions as Corollary 7 in Section A.6 in the Appendix.

6

RAY BASIS THEOREM

1.0

3

2

x

yn

F

y

Hn

S

0.0

0.5

Lu

2

o

Ll

1

1

Lr

1

1

0

-0.5

-1

-2

Ld

-1.0

-2

-1

0

1

2

3

-1.0

-0.5

0.0

0.5

1.0

Figure 1. Left panel: Proof of Lemma 4. As yn  y, a subsequence of halfspaces {Hn} n=1 converges to H  H(y) that touches S, contains x and the face F , and µ(int (H))  . Right panel: Local smoothness is a necessary condition for the inverse ray basis theorem. The origin o  R2 is the unique median of µ
from Example 1, but it fails to satisfy the covering condition (4).

Lemma 4 is technical, but presents an important intermediate result. It provides
multiple consequences that we explore in the sequel. Lemma 3 allows us to apply Lemma 4 to the sets D(µ), U(µ) or their interiors, for any µ  M Rd . This is the foundation for the most general statement of the ray basis theorem that can be devised for general measures. To obtain finer results, it is necessary to impose additional assumptions. In the
literature on the halfspace depth, two typical assumptions are the smoothness of µ, and the contiguity of its support. We require these conditions only locally, at the considered depth regions. Application of Lemma 4 to S = D(µ) yields the following generalization of the inverse ray basis theorem.

Theorem 5 (General inverse ray basis theorem). For any µ  M Rd ,   R,
x / int (D(µ)) and F  F(x, D(µ)) there exists H(x, F )  H(D(µ), F ) such that x  H(x, F ) and µ(int (H(x, F )))  . In particular,

(6)

(int (D(µ)))c = {H  H(D(µ)) : µ(int (H))  } .

Additionally, if (i) µ is smooth at D(µ), then µ(H(x, F )) =  and (int (D(µ)))c = {H  H(D(µ)) : µ(H) = } .

(ii) µ has contiguous support at D(µ), then (int (D(µ)))c = {H  H : µ(int (H))  } .

(iii) µ is smooth at D(µ) and has contiguous support at D(µ), then (int (D(µ)))c = {H  H : µ(H) = } .

RAY BASIS THEOREM

7

Note that if D(µ) fails to be full-dimensional, the left hand sides in the formulas in Theorem 5 are all Rd, and the theorem therefore gives conditions under which the whole sample space can be covered by halfspaces of limited µ-mass. For D(µ) contained in a hyperplane, also the condition from part (ii) of Theorem 5 is trivially satisfied.
Before moving to the discussion about the relevance of Theorem 5, we state an analogous result for U(µ) as another corollary of Lemma 4. Since obviously U(µ)  D(µ), its general statement is a refinement of the first claim (6) of Theorem 5.

Theorem 6. For any µ  M Rd ,   R, x / int (U(µ)) and F  F(x, U(µ)) there exists H(x, F )  H(U(µ), F ) such that x  H(x, F ) and µ(int (H(x, F )))  . In particular,

(7)

(int (U(µ)))c = {H  H : µ(int (H))  } .

Additionally, if µ is smooth at U(µ), then U(µ) = int (U(µ)), so U(µ) is open.

Comparison of Theorem 6 and part (ii) of Theorem 5 draws connections between the
depth regions D(µ) and U(µ) -- for µ with contiguous support at D(µ), we have int (D(µ)) = int (U(µ)). We postpone this discussion into Section 3, where connections between upper level sets of the depth and related convex constructions are explored thoroughly. In that section, also further applications of these observations are found.
If µ is not smooth, the last statement of Theorem 6 certainly cannot be claimed. This was observed already in [27, Lemma 6] where it was noted that for µ an atomic measure on points with unit weights in general position, U(µ) equals D+1(µ) for any   R, and as such, U(µ) is always a closed set. Our first consequence of the general ray basis theorem is the following observation concerning the dimensionality of the median set. It presents a refinement of [26, Proposition 3.4].

Corollary 7. Let µ  M Rd .
(i) If µ has contiguous support at D (µ), then dim (D (µ)) = d. (ii) If µ is smooth at D (µ) and d > 1, then dim (D (µ)) = d - 1.

Without the assumptions of smoothness and contiguous support, the median set may be of any dimension. Consider, for instance µ  M (R2) that gives mass 1 to each of the points (-1, -1)T, (-1, 1)T, (1, 1)T, and mass 2 to (1, -1)T. It is easy to see
that (µ) = 2, and D (µ) = L (0, 0)T , (1, -1)T . For additional discussion on the
dimensionality of the median set for empirical measures we refer to [14]. We are now ready to reformulate the inverse ray basis theorem from part (ii) of Theo-
rem 2, under minimal assumptions.

Corollary 8 (Inverse ray basis theorem for the median). Suppose that µ  M Rd is smooth at D (µ). Then

(int (D (µ)))c = {H  H(D (µ)) : µ(H) = (µ)} .

If, in addition, µ has contiguous support at D (µ), then the covering condition (4) holds true for any x  D (µ).

The assumptions of Corollary 8 are weaker than those in Theorem 2: (i) instead of the existence of the density f of µ we require only local smoothness of µ, and (ii) instead of the strict positivity and continuity of f in a neighbourhood of the median we need a weaker condition of locally contiguous support at the median set.

8

RAY BASIS THEOREM

Remark (Uniqueness of the median). In Corollary 7 we show that under the assumptions of both contiguous support and smoothness of µ at D (µ), the median set cannot be of dimension d, or d - 1. In particular, for d = 1 and 2 it follows that the median must be unique. It is tempting to claim that for a smooth measure µ with convex support (part (ii) of Theorem 2), the median set must consist of a single point, compare with [18, Proposition 7] and the discussion in [26, Section 3]. Surprisingly, it turns out that there exist probability distributions with a density that is smooth and positive in a convex set in dimension d > 2 that fail to possess a unique halfspace median. The appropriate conditions for the uniqueness of the halfspace median in higher dimensions turn out to be not only smoothness and contiguous support, but, quite surprisingly, also a certain integrability assumption. For a detailed discussion on the problem of the uniqueness of the halfspace median we refer to [23]. For that reason, one has to be careful when interpreting the inverse ray basis theorem in Corollary 8. Suppose that a measure µ is smooth with contiguous support. Then for any point x  D (µ) it is true that the sample space Rd is covered by minimizing halfspaces of µ at x. That, however, does not mean that the median of µ must be unique. Especially in higher dimension, the non-trivial median set may still lie in the boundary of all the halfspaces from the covering system.
We continue by giving examples that demonstrate that the assumptions of Corollary 8 are difficult to be weakened. In our first example we show that without local smoothness, even in the case when x is the unique median of µ, it may fail to satisfy the covering condition (4).
Example 1. Consider µ  M (R2) whose support is plotted in the right hand panel of Figure 1. It is given as a mixture of the uniform distributions on line segments Lu = L (0, 0)T , (0, 1)T , Ld = L (0, 0)T , (0, -1)T , Ll = L (0, 0)T , (-1, 0)T and
Lr = L (0, 0)T , (1, 0)T , such that µ(Ll) = µ(Lr) = µ(Ld) = 1 and µ(Lu) = 2. The
origin o = (0, 0)T is the unique median of µ with D(o; µ) = 2, since for any other point x  R2 there is a halfspace H  H(x) that is parallel with one of the axes such that µ(H) < 2. At the same time, each closed halfspace containing Lu has µ-mass at least 3, implying that it is impossible to cover (any point from) Lu by H  H(o) such that µ(H)  (µ) = 2. On the other hand, observe that part (ii) of Theorem 5 is valid, as we easily find open halfspaces whose boundary passes through the origin with mass at most (µ) whose closures cover R2.
It is known that for a uniform distribution µ on a triangle  in the plane, the barycentre o   of  is the unique median of µ [24, Section 5.3]. We construct an example of a uniform distribution on the set obtained by removing a narrow strip containing o from . We show that our measure does not satisfy the assumption of contiguous support at D (µ), at the same time its median set is full-dimensional, and contains points that fail to cover the plane by their minimizing halfspaces as in (4).
Example 2. Consider the equilateral triangle in R2 centred at the origin o = (0, 0)T determined by points a = (0, 2)T, b = (- 3, -1)T and c = ( 3, -1)T as displayed in Figure 2. For x  (0, 2) and y  (0, 1) denote xc = (0, x)T and yc = (0, -y)T, and let xl and xr be the points where the horizontal line containing xc intersects L(a, b) and L(a, c), respectively. Analogously, define points yl and yr for the horizontal line that contains yc. Let µ  M (R2) be the uniform distribution on the set S = conv ({a, xl, xr}) 

RAY BASIS THEOREM

9

conv ({yl, b, c, yr}) with total mass being the area of S. It is possible to choose x and y positive, but small enough so that the set D (µ) is full-dimensional, while yc  D (µ) is the only point in R2 that satisfies the covering property (4). For a detailed technical
proof of this claim, we refer to Section A.8 in the Appendix.

a

0.0 0.5 1.0 1.5 2.0

0.0 0.5 1.0 1.5 2.0

-1.0

xl yl

xc
o yc

xr yr

-1.0

b

c

d

-2

-1

0

1

2 -2

-1

0

1

2

Figure 2. Example 2: For the inverse ray basis theorem, it is not enough to
assume only the smoothness of µ, without the property of contiguous support. For
the uniform measure µ on the coloured region, the median is a full-dimensional set, yet the point yc displayed in the left hand panel is the only point in R2 that satisfies the covering condition (4). On the right hand panel we see several numerically computed depth regions D(µ), with the median set D (µ) being the smallest region, located in the closed strip removed from the triangle.

3. Depth regions and floating body
Formula (2) allows us to write any depth region D(µ) as an intersection of closed halfspaces whose complements have µ-mass smaller than . Another important affine equivariant set is the floating body of µ corresponding to   R
UF B(µ) = {H  H : µ(Hc)  } ,
as defined in [2, Section 5]. According to the discussion in [20], the floating bodies are of great interest in both geometry and probability theory. For the special case of µ a uniform distribution on a full-dimensional convex set K  R3, the floating body has a compelling mechanical interpretation -- the set UF B(µ) can be described as the part of the convex solid K of (volumetric mass) density   (0, (µ)) that never submerges beneath the surface of water of unit density, when fully rotated on the surface. The history of the research on floating bodies goes well into the 19th century. In statistics, a construction equivalent to the floating body of a measure is much more recent, and sometimes referred to as the multivariate trimming [21, 17]. Being intersections of closed sets, both D(µ) and UF B(µ) are closed. In what follows we use the results of Section 2, and precise the connections between the depth regions D(µ), U(µ), the floating body UF B(µ), and a

10

RAY BASIS THEOREM

further set that turns out to be of interest in our analysis

U(µ) = {int (H) : H  H, µ(Hc)  } .
We demonstrate that this last region is an upper level set of a function closely related to the halfspace depth
D(x; µ) = inf µ(int (H)), xH
considered in, e.g., [18, Lemma 1]. Note also that (U(µ))c = {H  H : µ(int (H))  } already appeared in Theorem 6, meaning that U(µ) = int (U(µ)) must be an open set. The following theorem comprehensively covers the inter-relations between all these affine constructions, and generalizes several results that can be found scattered in the relevant literature on multivariate trimming concepts [26, 17, 18, 3, 20].

Theorem 9. For µ  M Rd and   R

(8)

U(µ) = int (U(µ))  cl (U(µ))  UF B(µ)  D(µ).

Additionally,

(i) U(µ) = x  Rd : D(x; µ) >  . (ii) if int (U(µ)) = , then cl (U(µ)) = UF B(µ). (iii) if µ has contiguous support at D(µ), then int (D(µ)) = int (U(µ)). (iv) if for each H  H(D(µ)) we have that H  H  H implies µ(H) < µ(H), then
UF B(µ) = D(µ). (v) if int (U(µ)) =  and µ has contiguous support at D(µ), then cl (U(µ)) =
D(µ).

An application of Theorem 9 to the estimation of the depth regions D(µ) from datasets is given in Section 4.3. The condition of non-empty interior of U(µ) that figures in parts (ii) and (v) of the previous theorem is not restrictive, as shown in the next lemma.

Lemma 10. If for µ  M Rd and   R there exists a point x  U(µ) such that µ is smooth at x, then int (U(µ)) = .
Combining Lemma 10 and Theorems 6 and 9 we get that for µ  M Rd with a density and   (0, (µ)) the set U(µ) is open and U(µ)  cl (U(µ)) = UF B(µ). If the support of µ is, in addition, contiguous, we can also write UF B(µ) = D(µ). In the simplest situation of µ  M Rd with a density that is positive in the convex support of µ, we can therefore write cl (U(µ)) = UF B(µ) = D(µ), and the floating bodies completely coincide with the central regions of the depth. The last situation is common in the literature on floating bodies in geometry, where all the above definitions are used interchangeably. In the general setup of the depth and (probability) measures, it is however necessary to differentiate between them.
Our statement of Theorem 9 is strict -- none of the inclusions can be reversed, in general. Each strict upper level set U(µ) of a smooth measure µ is open (Theorem 6), and thus strictly smaller than cl (U(µ)). It is easy to construct a measure without contiguous support that violates UF B(µ) = D(µ), see e.g. [20, Figure 7]. Even for measures with contiguous support, equality UF B(µ) = D(µ) from part (iv) of Theorem 9 can fail; consider µ being the Dirac measure at the origin o  Rd, and  = 1. In that case, UF B(µ) = , while D(µ) = {o}. In the following example we show that in the case when int (U(µ)) = , the halfspace depth may fail to satisfy cl (U(µ)) = D(µ) (the so-called strict monotonicity property), even under the assumption of contiguous

RAY BASIS THEOREM

11

support. The example demonstrates that also the remaining set inclusions in Theorem 9 cannot be reversed for general measures without local assumptions.
Example 3. Consider µ  M (R2) given by a mixture of the uniform distribution on the unit disc C = {x  R2 : x  1} with mass 1/4, and two atoms located at m = (0, 1)T and z = (0, 1/2)T with masses 1/2 and 1/4, respectively. Point m is certainly the unique halfspace median of µ, with D (m; µ) = (µ) = 1/2. It is also easy to see that the halfspace depth of µ at the point o = (0, 0)T equals 1/8. Because of the two large atoms of µ, all points in the open line segment L(o, z) have also depth 1/8. Similarly, all points in L(z, m) have the same depth as z, that is D (z; µ) = 1/8 + 1/4 = 3/8. Because for any y / L[o, m] certainly D (y; µ) < 1/8, we have for  = 1/8 that D(µ) = L[o, m], while cl (U(µ)) = L[z, m], meaning that the strict monotonicity property of the halfspace depth is violated, see also the left hand panel of Figure 3. In addition, it is easy to verify that UF B(µ) is equal to D(µ)  cl (U(µ)), while the set U(µ) from (8) is empty. We conclude that, in general, one cannot write U(µ) as a simple intersection of halfspaces, as possible for D(µ) in (2).

1.0

0.5

1/2 m 1/4 z
o

4

6

b
e d

0.0

2

-0.5

1/2

f

0

c

a

-1.0

-1.0

-0.5

0.0

0.5

1.0

-4

-2

0

2

Figure 3. Left panel: Condition int (U(µ)) =  is needed for the strict monotonicity of the halfspace depth: Example 3 of a distribution µ where
D(µ) = cl (U(µ)). The halfspace depth of µ takes only values in the set [0, 1/8]  {3/8, 1/2}. The upper level set D(µ) with  = 1/8 is the line segment between the origin o and the black atom m. Points on the thick dashed line
all attain depth equal to 3/8. Right panel: For the atomic measure µ supported in points a­f from Example 4, the set C (µ) (innermost coloured triangle) is a proper subset of D (µ) (outer coloured triangle).

4. Applications: Refined medians, computation, and consistency
4.1. Covering halfspace median. Our first application of the ray basis theorems from Section 2 is motivated by another refinement of the main equality (6) applied to  = (µ): For any measure µ  M Rd there exists a point x  D (µ) that allows us to cover the whole space with halfspaces H  H(x) whose interior has µ-mass at most
(µ) = inf{ > 0 : int (D(µ)) = } = sup{ > 0 : int (D(µ)) = }.

12

RAY BASIS THEOREM

Observe that (µ)  (µ). Therefore, the following claim is stronger than the inverse
ray basis theorem not only (i) because it asserts the existence of such a special point in D (µ), but also in the sense that (ii) the masses of the halfspaces that cover Rd are ensured to be at most (µ), and not just (µ).

Theorem 11. For any µ  M Rd there exists a point x  D (µ), such that

(9)

Rd = {H  H(x) : µ(int (H))  (µ)} .

Suppose that D (µ) is not a single point set. It is certainly of interest to single out the subset C (µ) of D (µ) of those points that satisfy the additional covering property (9) characteristic to centrally located points. We call such medians the covering halfspace medians (or simply covering medians) of the measure µ. The concept of covering medians is interesting especially in the situation when the median set is full-dimensional, as frequently happens with data generated from a smooth distribution. In that situation, the relatively large median set typically reduces to a smaller subset of the most centrally located points being the covering medians.
Example 4. For an empirical measure µ  M (R2) with atoms at points a = (3, 0)T, b = (0, 5)T, c = (-5, 0)T, d = (1, 3)T, e = (-1, 3)T and f = (-1, 1)T, the median set D (µ) is equal to the triangle determined by points d, e and f , while C (µ) is a smaller triangle determined by the lines l(a, e), l(b, f ) and l(c, d), see the right hand panel of Figure 3.

-1.0 -0.5 0.0 0.5 1.0 1.5

G IH

F J K
y ox

E

A

D

BC

-1.0 -0.5 0.0 0.5 1.0
Figure 4. Example 5: The set of covering medians C (µ) may fail to be convex. For the measure µ, whose support is displayed in this plot in colour, the points x and y belong to C (µ). But, their midpoint o is not contained in C (µ).
The covering medians present a genuine refinement of the halfspace medians. They can be shown to satisfy an array of properties expected from well-behaved location estimators, such as (i) existence as proved in Theorem 11; (ii) affine equivariance; or (iii) plausible

RAY BASIS THEOREM

13

continuity properties when considered as a set-valued function of the measure µ. The covering medians are also intimately connected with the robustness properties of the halfspace median and the depth. All these results will be presented elsewhere in an appropriate context. Here we mention only several basic observations closely linked to Theorem 11. The first one demonstrates that unlike the standard halfspace median set, the set of the covering medians does not have to be convex.
Example 5. Let µ  M (R2) be the mixture of uniform distributions on the triangles A­K displayed in Figure 4, such that µ(A) = µ(F ) = µ(G) = 2 and µ(B) = µ(C) = µ(D) = µ(E) = µ(H) = µ(I) = µ(J) = µ(K) = 1. It can be shown that the set C (µ) contains points x and y displayed in Figure 4, but it does not contain the origin o = (x + y)/2. Therefore, the set of the covering halfspace medians of µ is not convex. For a detailed proof see the Appendix, Section A.12.
The proof of Theorem 11 allows us to devise a simple algorithm for finding the covering medians of µ listed as Algorithm 1. Although this program is applicable to any measure including empirical measures of random samples, its main purpose is not the computation of the sample covering medians of large datasets. Rather, it is intended to guide a quick manual procedure for restricting the location of possible covering medians in visual examples such as those presented throughout this paper.

Algorithm 1: Search for a covering halfspace median of a measure µ. input : the full-dimensional median region D (µ) of a measure µ input : a small positive constant  determining desired precision output: a covering median of µ
S0  D (µ) ; x0  barycentre of S0 ; k0; while xk / C (µ) and volume of Sk exceeds  do
Hk  generalized minimizing halfspace of µ at xk ;
// such a halfspace exists by Lemma 1 Sk+1  cl (Sk \ Hk) ; kk+1 ; xk  barycentre of Sk ; end return xk ;

Once a covering median of µ is found, it is of interest do determine whether it is unique. Supposing that a covering median of µ and its collection of generalized minimizing halfspaces are available as the output of Algorithm 1, the following theorem gives a sufficient condition for the uniqueness of this covering median.
Theorem 12. Let x  Rd be a covering median of µ  M Rd . Denote by Hmin the collection of halfspaces on the right hand side of the following display
Rd = {H  H(x) : µ(int (H))  (µ)} .
If for each H  Hmin and H  H it follows that µ(H) > µ(H), and if there is no subset H  Hmin such that H = Rd and H = {x}, then C (µ) = {x}.

14

RAY BASIS THEOREM

Note that the point yc from Example 2 given in Section 3 satisfies the conditions of Theorem 12 and C (µ) = {yc}, while the median of that measure µ is full-dimensional. On the other hand, Theorem 12 does not apply to any of the two covering medians
x, y found in Example 5, as the condition regarding contiguous support at minimizing
halfspaces is not satisfied.

4.2. Trimmed regions for atomic measures. Our second application of the generalized ray basis theorem is a necessary condition on the depth regions D(µ) of atomic measures.

Corollary 13. For µ an atomic measure with finitely many atoms,   R, x / int (D(µ)) and F  F(x, D(µ)) there exists H(x, F )  H(D(µ), F ) such that x  H(x, F ) and µ(int (H(x, F ))) < . Moreover, each face F of the convex polytope D(µ) of dimension dim(F ) < d is contained in the convex hull of at least min{dim(D(µ)) + 1, d} atoms located in a hyperplane in Rd.

A special case of this result in the situation when D(µ) is full-dimensional was used in the derivation of a fast algorithm for the computation of the depth regions of datasets
in [15]. The present general version may find applications in the computation of the
halfspace depth of datasets in the situation when dim (D(µ)) < d. For example, suppose that for given   R and µ corresponding to a dataset the algorithm from [15] fails to
find an interior point of the region D(µ). The reason may be twofold: either (i) D(µ) is an empty set, or (ii) it is less than full-dimensional. Corollary 13 asserts that in the
latter case, the region D(µ) must be contained in a hyperplane spanned by d data points. Thus, the search for D(µ) may continue in the intersection of data-determined hyperplanes, and the last known non-empty region D(µ) for  < .

4.3. Estimation of central regions. Part (v) of Theorem 9 yields an important equal-
ity. According to Dyckerhoff [8, Definition 3.1] the halfspace depth is strictly monotone at µ  M Rd if for all   (0, (µ)) we can write D(µ) = cl (U(µ)). Strict monotonicity is a crucial assumption that ensures the sample version consistency of the halfspace depth-
trimmed regions [8, Example 4.2]. As a consequence of Lemma 10 we obtain a condition ensuring the strict monotonicity of the halfspace depth -- for a measure µ  M Rd to
have a strictly monotone depth it is enough to assume contiguous support and smoothness
at a single point of the median set. In particular, under these very mild conditions, it is
possible to guarantee the almost sure uniform convergence of the sample depth trimmed
regions to their population counterparts. To precise this, we need to consider a topology on the space of compact subsets of Rd. A natural choice is that given by the Hausdorff distance [25, Section 1.8]. For K, L  Rd compact the Hausdorff distance of K and L is
given by

H (K, L) = max

sup inf |x - y| , sup inf |x - y|

xK yL

xL yK

.

Corollary 14. Let µ  M Rd be a probability measure with contiguous support that is
smooth at some x  D (µ). Let X1, . . . , Xn be a random sample from µ defined on the probability space (, A, P), and denote by µn  µn()  M Rd the empirical measure of X1, . . . , Xn. Then for any closed interval A  (0, (µ))

P

  :

lim
n

sup
A

H

(D(µn),

D(µ))

=

0

= 1.

RAY BASIS THEOREM

15

Further, let µ  M Rd be any measure that is smooth with contiguous support. Then for any closed interval A  (0, (µ)) and any µn converging weakly to µ we have

lim
n

sup
A

H

(D(µn),

D(µ))

=

0.

This result follows directly from [8, Theorem 4.5] and our previous discussion. The General assumption in [8, p. 9] is satisfied thanks to our Lemma 10; the assumption of compact convergence of the depth from [8] follows, e.g., from [20, Section 3.2.7]. Corollary 14 should be compared with earlier contributions regarding the consistency of the trimmed regions and derived quantities [21, 10, 34, 11, 16, 31, 30]. In those references analogous consistency results are proved under more restrictive conditions.

Appendix A. Proofs of the theoretical results
We begin with a lemma collecting several properties of the convergence of halfspaces.
Lemma 15. Consider µ  M Rd , a sequence of closed halfspaces {Hn} n=1  H, and   R. The following claims hold true:
(i) If there is a sequence {xn} n=1 such that xn  bd (Hn) and xn  x, then there exists a subsequence {Hnk} k=1 converging to a closed halfspace H  H(x).
(ii) If Hn  H and µ(int (Hn))   for each n, then µ(int (H))  . (iii) If Hn  H, µ(int (Hn))   for each n, H  D(µ) =  and µ(bd (H)) = 0, then
µ(H) = . (iv) If Hn  H and x / int (Hn) for each n, then x / int (H).
Proof. For part (i), denote Hn = Hxn,vn. The set of unit vectors Sd-1 is bounded, meaning that {vn} n=1  Sd-1 contains a convergent subsequence {vnk} k=1, whose limit point we denote by v  Sd-1. We obtain that Hnk  Hx,v = H  H(x) as k   as desired. Part (ii) is a consequence of the Fatou lemma [6, Lemma 4.3.3] and the fact that int (H)  lim infk int (Hnk). Under the assumptions of part (iii) there exists x  D(µ)  H. For this point we can directly write by part (ii) of this lemma   D (x; µ)  µ(H) = µ(int (H))  . To prove (iv), assume that x  int (H). Then x  int (Hn) starting from some index, a contradiction.
Lemma 16. If H  H and S  Rd is a convex set such that int (H)  S =  and relint (S)  H = , then aff (S)  bd (H).
Proof. Consider x  relint (S)  H. Since x  relint (S), there exists a ball Bx centred at x in space aff (S) so that Bx  S. Since int (H)  S =  we get x  bd (H) and Bx  bd (H), meaning that aff (S) = aff (Bx)  bd (H).
Lemma 17. For A  Rd non-empty convex and x / int (A) the collection F(x, A) contains a non-empty set.
Proof. In the case that x  bd (A), there is a face F =  of bd (A) containing x in its relative interior [25, Theorem 2.1.2], so F(x, A) contains a non-empty set. Otherwise, let x / cl (A). The Hahn-Banach theorem [25, Theorem 1.3.4] guarantees that there exists a touching halfspace H  H(A) of cl (A) such that x  int (H). Denote F = cl (A)bd (H). Then, F is a non-empty face of cl (A), and certainly also cl (A) \ F  Hc, F  bd (H), and x  int (H), meaning that F  F(x, A).

16

RAY BASIS THEOREM

A.1. Proof of Lemma 1. Let  = D (x; µ). The definition of the halfspace depth en-
sures that for each n = 1, 2, . . . there exists Hn  H(x) such that µ(Hn) <  + 1/n. Applying part (i) of Lemma 15 we obtain a subsequence {Hnk} k=1 converging to H  H(x). From the Fatou lemma [6, Lemma 4.3.3] we get µ(int (H))  lim infkµ(int (Hnk))  .
Under the additional assumption of smoothness of µ at x we know that µ (bd (H)) =
µ (bd (Hn)) = 0 for each n = 1, 2, . . . . In that case, the Fatou lemma guarantees µ(H) = limk µ(Hn,k)  . Since also  = D (x; µ)  µ(H)  , we obtain the desired result.

A.2. Proof of Lemma 3. For any S  Rd convex and H  H, the condition int (H)  S =  implies int (H)  int (S) = . Furthermore int (S)  S. Thus, it is enough to show the claim (5) with the smaller set int (S) on the left hand side, and the condition int (H)  S =  in the expression on the right hand side.
We start with D(µ). First note that by the very definition of D(µ)

(10)

µ(int (H)) <  implies int (H)  D(µ) = .

Consider any x / int (D(µ)). Suppose first that x / D(µ), meaning that D(x; µ) < . The auxiliary Lemma 1 implies that there exists H  H(x) such that µ(int (H)) < , and
(10) ensures that x is covered by the union on the right hand side of (5). If x  bd (D(µ)), we can approach x by a sequence {xn} n=1  (D(µ))c such that xn  x. We apply Lemma 1 to each xn to obtain halfspaces Hn  H(xn) such that µ(int (Hn)) < , and consequently int (Hn)  D(µ) =  for each n by (10). From Lemma 15, parts (i), (ii) and (iv) we conclude that there exists H  H(x) such that µ(int (H))   and
int (H)  D(µ) = , as desired. The proof for U(µ) is analogous. First, observe that µ(int (H))   implies int (H) 
U(µ) =  by the definition of U(µ). Consider any x / int (U(µ)). If x / U(µ), then D(x; µ)  , so there is H  H(x) such that µ(int (H))   by Lemma 1. Otherwise, x  bd (U(µ)) may be approached by a sequence {xn} n=1  (U(µ))c such that xn  x, and Lemma 15 again gives the desired result.

A.3. Proof of Lemma 4. Since each H  H(S) has empty intersection with int (S), it is only left to prove (int (S))c  {H  H(S) : µ(int (H))  }. We take any x / int (S)
and consider three cases. Case (i): int (S) = . By definition, H () = H. Therefore, the statement reduces
directly to condition (5). Case (ii): x / cl (S) and int (S) = . We consider only the situation when F
is non-empty, which is possible by Lemma 17, as the other case follows trivially from condition (5). Denote C = relint (conv (F  {x})). Take y  relint (F ), and the sequence yn = (1 - 1/n) y + x/n  C, for n = 1, 2, . . . , that converges to y. Because x / S, the choice of F ensures that C  cl (S) = . Thus, for each n we have yn / cl (S) and condition (5) implies the existence of Hn  H such that yn  Hn, int (Hn)  S =  and µ (int (Hn))  . Applying Lemma 15, parts (i), (ii) and (iv), we conclude that there is a subsequence {Hnk} k=1 converging to H  H(y), such that µ(int (H))   and int (H)  S = . Then y  relint (F )  H. From Lemma 16 it follows that F  bd (H), so H  H(S, F ).
Case (iii): x  bd (S) and int (S) = . The face F was chosen so that x  relint (F ).
It is enough to follow the lines of Case (ii) of this proof with y replaced by x, and x replaced by z = x + u / S for u  Sd-1 (any) outer normal to S at x. The latter choice assures that F  F(y, S), which allows us to proceed exactly as in Case (ii).

RAY BASIS THEOREM

17

A.4. Proof of Theorem 5. The general statement follows from Lemmas 3 and 4. Thus, it is enough to prove only the results under additional assumptions. We take x  Rd and consider the construction of the halfspace H = H(x, F )  H(D(µ), F ) from the proof of Lemma 4. Only the situation when both D(µ) and F are non-empty is considered; the other case is straightforward and trivial.
Part (i): Under the assumption of smoothness at D(µ) we have µ(H(x, F )) = µ(int (H(x, F ))). Since  = F  D(µ) we also have that H(x, F )  D(µ) = , which implies µ(H(x, F )) = .
Part (ii): It is enough to show that for any H  H the condition µ(int (H))   implies int (D(µ))  H = . Suppose x  H  int (D(µ)) and denote by v the unit inner normal of H. Then Hx,v  H and bd (Hx,v)  int (D(µ)) = . Since D(µ) is closed and convex, there exists y  int (Hx,v) D(µ), such that Hy,v  H(D(µ)), and Hy,v  Hx,v. Because µ has contiguous support at D(µ) it follows that µ(Hy,v) < µ(Hx,v)  µ(H)  , which is in contradiction with y  D(µ).
Part (iii): The result follows from parts (i) and (ii).
A.5. Proof of Theorem 6. The inclusion "" in (7) is a direct consequence of Lemmas 3 and 4. For the other inclusion, suppose for contradiction that x  int (U(µ)) is contained in the right hand side of (7). Then we can find H  H with x  H and µ(int (H))  , and since both int (H) and int (U(µ)) are open, there must exist y  int (U(µ))int (H). Denote by v  Sd-1 the inner unit normal of H. We obtain that Hy,v  int (H), meaning that  < D (y; µ)  µ (Hy,v)  µ(int (H))  , a contradiction. We have verified (7).
If µ is smooth at U(µ), then for H(x, F )  H(U(µ), F ) from the proof of Lemma 4 we have µ(H(x, F )) = µ(int (H(x, F )))   and consequently H(x, F )  U(µ) = , meaning that F  U(µ) = . This holds true for any x / int (U(µ)) and any face F from F(x, U(µ)). In particular, it must be true for any face F of U(µ) that is not full-dimensional, by considering x  relint (F )  bd (U(µ)). That implies U(µ)  bd (U(µ)) = , meaning that U(µ) = int (U(µ)) and U(µ) is open.
A.6. Proof of Corollary 7. Part (i): Suppose for contradiction that x  int (D (µ)). Lemma 1 gives H  H(x) with µ(int (H))  (µ). We can shift H in the direction of its inner normal to obtain H  H (D (µ)) such that H  int (H). Since D (µ) is closed, there exists y  D (µ)  H. The assumption of contiguous support at D (µ) then gives D (y; µ)  µ(H) < µ(int (H)) = (µ), which is impossible as y  D (µ).
Part (ii): If dim (D (µ)) = d - 1, for any x not lying in the hyperplane aff (D (µ)) we have D (µ)  F(x, D (µ)). Theorem 5 gives that there exists a halfspace H  H that contains D (µ) in its boundary hyperplane, and x in its interior, with µ (H) = µ (int (H))  (µ) due to the assumption of the smoothness of µ at D (µ). Take any y / H. Again, by Theorem 5 we obtain G  H such that D (µ)  bd (G), y  int (G), and µ (G)  (µ). The conditions dim(D (µ)) = d - 1, D (µ)  bd (H)  bd (G) and H = G determine that H and G must be complementary, i.e. H  G = Rd. Necessarily, µ Rd = µ(H)+µ(G)  2(µ), meaning that the measure µ is halfspace symmetric [33]. But, by [33, Theorem 2.1] we know that the median of a halfspace symmetric measure is either unique, or µ is concentrated in an infinite line L in Rd. The former case contradicts dim (D (µ)) = d - 1. In the latter case, also the median set of µ is contained in L, which contradicts our assumption of smoothness of µ.
A.7. Proof of Corollary 8. The first part of the statement follows directly from part (i) of Theorem 5 with  = (µ). For the second part, note that due to the contiguous

18

RAY BASIS THEOREM

support of µ at D (µ), dim (D (µ)) < d by Corollary 7. Therefore, int (D (µ)) = , so (int (D (µ)))c = Rd. To obtain the result, apply Theorem 5 with x replaced by y / aff (D (µ)). That theorem allows to choose F to be D (µ)  F (y, D (µ)). We obtain that Rd \ aff (D (µ)) can be covered by halfspaces H from H (D (µ) , D (µ)) with µ(H) = (µ), but at the same time H  H (D (µ) , D (µ)) implies D (µ)  aff (D (µ))  bd (H). In particular, we see that also aff (D (µ)) is covered by our collection of halfspaces, and any point in the median set x  D (µ) is contained in the boundary of H for each such H. We conclude that Rd can be covered by halfspaces H
from H(x) with µ(H) = D (x; µ), as desired.

A.8. Proof of Example 2. Throughout the proof we adopt the following notation. For m = 1, 2, . . . and points x1, . . . , xm  R2, by x1 . . . xm we mean the polygon with vertices
x1, . . . , xm. For m = 2 we obtain a line segment x1x2. Where no confusion arises, by x1x2
we also denote the length of that line segment. For polygons with non-empty interior, or more generally, for measurable sets V  R2 we denote by (V ) the two-dimensional Lebesgue measure (the area) of V . Recall that for a, b  R2 we write L[a, b] for the

closed line segment between points a and b (that is, ab), L(a, b) = L[a, b] \ {a, b} is the

corresponding open line segment, and l(a, b) the infinite line spanned by a and b.
We suppose the distances between the origin o = (0, 0)T and the points xc and yc take values in ranges x  (0, 1/4) and y  (0, 1/5), respectively. Set d = (0, -1)T. Because µ

is a uniform distribution on S with total mass (S), the µ-mass of any measurable set V is proportional to (S  V ). For z  (0, y], zc = (0, -z)T, and   (-/2, /2] denote by
lz, the infinite line l zc, zc + (cos ( - /2) , sin ( - /2))T that passes through zc and

determines the angle  with line l(a, d). In Figure 6 the line lz, is drawn for  = /4-3/10. Any lz, determines two closed halfplanes. We write Hz+ for the one that contains d, and write Hz- for the complementary closed halfplane. Denote

z+ = (S  Hz+) and z- = (S  Hz-).

By Lemma 1 a minimizing halfplane of µ at zc exists. In order to determine one, we find  that minimizes min z+, z- . The condition z+ + z- = (S) reduces the problem to the search for the minimum and the maximum of z+. Because of the symmetry of the figure S, it is enough to consider   [0, /2].

As depicted in Figure 5, denote by ol and or the points of intersection of the line l o, (0, 1)T with L(a, b) and L(a, c), respectively. Computing the lengths of the corresponding line segments we obtain oor = 2dc/3 = 2/ 3. Using the similarity of triangles,

axc : ao = xxr : oor, which together with ao = 2 and axc = 2 - x gives

xcxr

=

xcxl

=

2- x. 3

Further, we obtain x : y = (oor - xcxr) : (ycyr - oor), and consequently

ycyr

=

ycyl

=

y+ 2 . 3

Part (I): yc  D (µ) and yc satisfies the covering property (4).
We start by considering those values of   [0, /2] that correspond to the change of the behaviour in the formula for the area y+. In the considered range for the angle , this happens twice: (i) at 1 when the line ly,1 passes through the vertex c, see the left hand panel of Figure 5; and (ii) at 2 when the line ly,2 passes through the point xl, see

RAY BASIS THEOREM

19

the right hand panel of Figure 5. Denote e = ly,  l(a, b) and f = ly,  l(b, c). Note that

1 and 2 correspond to f = c and e = xl, respectively. A simple computation yields 

tan 1 = dc/ycd =

3/(1 - y), 

tan 2 = xcxl/ycxc = (2 - x)/( 3(x + y)).

We see that 1  /3 and 2  /2 as x and y both decrease to 0. Thus, for x and y small enough, 1 < 2; in particular, it is straightforward to establish that for our choices of x  (0, 1/4) and y  (0, 1/5), we have 1 < 2. We distinguish three cases, according to the value of , and evaluate the function y+ in each situation.

a

a

0.0 0.5 1.0 1.5 2.0

0.0 0.5 1.0 1.5 2.0

xl ol yl

xc o yc 1

xr or
yr

xl ol yl

xc o yc 2

xr or
yr

-1.0

-1.0

b

c

b

c

d

d

-2

-1

0

1

2

-2

-1

0

1

2

Figure 5. Proof of Example 2: Angles 1 (left panel) and 2 (right panel) represent the two values in the interval [0, /2] where the function y+ fails to be differentiable.

Case (i): 0   < 1. For x the point of intersection of L(e, f ) and L(xl, xr), we derive y+ by computing

(11)

y+ = (ebf ) - (xxlylyc).

Denote x = (oorxrxc) and y = (ycyroro). Thenx = (xcxr + oor) · x/2 = x(4 - x)/(2 3) and y = (ycyr + oor) · y/2 = y(4 + y)/(2 3). Denote by h the length of

the normal from e to line l(yl, yc). We computeh : (h + 1 - y) = ycyl : bf . On the other hand, bf =bd + df = 3 + (ycd) tan  = 3 + (1 - y) tan . From here, we get h = (y + 2)/(1 + 3 tan ), and consequently



(12)

(ebf )

=

(h

+

1

-

y)

bf 2

=

(

3 + (1

2(

1 3

- y) tan + tan )

)2

.

Since xcyc = x + y and the angle between l(yc, x) and l(yc, xc) equals , it holds true that (xcxyc) = (x + y)2 tan /2 and

(13)

(xxlylyc)

=

x + y

- (xcxyc)

=

(4 -x)x 23

+

(4 +y)y 23

-

tan 2



(x

+

y)2.

20

RAY BASIS THEOREM

2

a

2

a

1

1

0

-1

e
xl ol yl
b

x' xc
o yc
 df

xr or yr
c

-1

0

e xl yl
b

xc o yc 
d

xr yr
g
hc f

-2

-1

0

1

2

-2

-1

0

1

2

Figure 6. Proof of Example 2: The situation that corresponds to the Case (i) of Part (I) of the proof (left panel), and Case (ii) of Part (I) of the proof (right panel).

Finally, substituting (12) and (13) into (11) gives



y+ = (

3 + (1 - y) tan )2

2(

1 3

+

tan

)

-

2 (x 3

+

y) -

1 (y2 23

-

x2) +

tan 2



(x

+

y)2.





Now we take t = 1/ 3 + tan , and substitute tan  by t - 1/ 3 in the last equation.

Consolidating the terms with t, we get

(14)

y+

=

1 (2 3

+

y)(1

-

x

-

2y)

+

F1(t)

where

F1(t)

=

(2

+ y)2 6

1 t

+

(1 - y)2 + (x + y)2

t 2

.

The derivative of F (t) is given by

F1 (t)

=

(1

-

y)2

+ 2

(x +

y)2

-

(2

+ y)2 6

1 t2

.

Condition F1(t) = 0 gives t2 = (2 + y)2/(3 ((1 - y)2 + (x + y)2)). Denote

tm =

2+y

.

3 ((1 - y)2 + (x + y)2)

The derivative F1(t) is negative for t < tm and positive for t > tm. Therefore, the function

F1(t) decreases with t until t = tm, and then increases again, so it is only left to check

whether tm < tan 1 + 1/ 3. In order to do so, we should verify



3 ((1

-

2+y y)2 +

(x

+ y)2)

<

3 1-y

+

1 3

=

4-y , 3(1 - y)

RAY BASIS THEOREM

21

which can be rewritten as (15)

2 + y < 4 - y.

1+

x+y 2 1-y

Since the left hand side of the last equation is smaller than 2 + y, it is enough to show 2 + y < 4 - y, which is satisfied because we started with y < 1/5. We conclude that F1(t) attains its minimum value at t = tm, or equivalently, at tan min = tm - 1/ 3. The appropriate minimum area is given by

(16)

min+ y

=

1 (2 3

+

y)(1

-

x

-

2y)

+

1 (2 3

+

y)

(1 - y)2 + (x + y)2.

Case (ii): 1   < 2. Now e  L[a, xl] and f / L(d, c), see the right hand panel of Figure 6. Denote g = L[yc, f ]  L[a, c]. In order to get the formula for y+ in this case, one simply subtracts (gcf ) from formula (14). Denote by h the orthogonal projection of g onto l(d, f ). Then tan  = f d/ycd = (f c + 3)/(1 - y), so f c = (1 - y) tan  - 3, and hc = hg/ 3. At the same time, tan  = hf /hg = (hc + cf )/hg = cf /hg + 1/ 3, implying hg = cf /(tan  - 1/ 3). Now we may calculate (gcf ) as cf · hg/2, which, after the substitution t = 1/ 3 + tan , gives

(gcf )

=

(1

- 2

y)2

t

+

(2 + y)2 1

6

t

-

2 3

 - 3(1 - y).

For  = 1 one gets (gcf ) = 0, as expected. Finally, we derive

(17)

y+

=

1 (5 3

-

6y

-

2y2

-

2x

-

xy)

+

F2(t),

where

F2(t)

=

(x

+

y)2

t 2

+

(2

+ 6

y)2



1 t

-

t

1

-

2 3

. 

The above formulaholds true for tan 1 + 1/ 3  t < tan 2 + 1/ 3. By introducing

s = t - tan 1 - 1/ 3  0, we may write

(18)

F2(t)

=

(x +y)2 23

4 1

- -

y y

+

G(s),

where

(19)

G(s)

=

(x

+ 2

y)2 s

-

(2 +y)2 33

(s

+

1



3 1-y

)2

-

1 3

.

One may investigate G(s) instead of F2(t), because t  s is a simple shift by a constant.

The derivative of G(s),



(20)

G(s)

=

(x

+ 2

y)2

+

2(2 + y)2 33

((s

+

1



3 1-y

)2

-

1 3

)2

s

+

1

3 -y

,

is always positive for s  0, so y+ grows with  for 1   < 1. Case (iii): 1    /2.

22

RAY BASIS THEOREM

As e  L [xl, yl], y+ obviously grows with increasing .

Summary of Part (I).

Now that we established the behaviour of the mapping   y+, we are able to find its extreme values. The value of y+ decreases for 0   < min and increases for min <   /2, so it attains minimum value at  = min, and maximum value at

 = 0 or  = /2. Therefore, the depth of the point yc with respect to µ is equal to

min

min+ y

,

0y-

,

y/2-

. Note that 0y- = (S)/2 and y/2- = (axlxr). As x, y  0

from the right, (axlxr) goes to 4/9 · (abc), and (S) goes to (abc). In particular, it is

easy to show that for x  (0, 1/4) and y  (0, 1/5) we have y/2- < 0y-. In what follows

we show that it is possible to choose x and y Note that y/2- = (axlxr) = xcxr · axc

such

that

y/2-

=

min+ y

.

= (2 - x)2/ 3. Therefore,

the

condition

y/2-

=

min+ y

is,

using

(16),

equivalent

with

f (x, y) = -2 - 3y - 2y2 + 2x - x2 - xy + (2 + y) (1 - y)2 + (x + y)2 = 0. 
Consider x  (0, 1/4) fixed. As y  0, f (x, y) converges to f0(x) = ( 2x + 1 + x2 - 1)( 2x + 1 - 1 + x2). To show that f0(x) > 0 for any choice of x  (0, 1/4), we should prove 2x + 1 > 1 + x2, which is equivalent with 2x + 2 2x - x2 > 0. The latter inequality follows from 2x + 2 2x - x2 = 2 2x + x(2 - x) > 0. In the case

y  1/5, f (x, y) converges to f1/5(x) = -67/25+9x/5-x2 +11 15/25 + (x + 1/5)2/5 

-67/25 + 9x/5 + 11 15/25 + (x + 1/5)2/5 < 0 for each x  (0, 1/4). Because the

mapping y  f (x, y) is continuous in y for each fixed x, the intermediate value theorem

[6, Problem 2.2.14(d)] allows us to conclude the existence of y  (0, 1/5) such that

f (x, y) = 0 for each x  (0, 1/4).

Finally, from all the considerations above, we conclude that for each x < 1/4, there

exists y such that D(yc; µ) = (axlxr) and there are three minimizing halfspaces of µ at yc, being Hymin+, Hy-min+ and Hy/2-. Obviously, those halfspaces cover the whole R2, so
yc satisfies the covering property (4), and by part (i) of Theorem 2, yc must be a median of µ. The course of the function y+ can be observed in Figure 7.

Part (II): dim (D (µ)) = 2.

We first show that there exists a point zc = (0, -z)T = yc in R2 that is also a halfspace

median of µ. For that reason, we use the results from Part (I) to calculate z+. We

consider

only

x

and

y

from

Part

(I)

that

satisfy

y/2-

=

min+ y

=

D(yc;

µ)

=

(µ).

Denote q = xryl  xlyr and consider point zc = (0, -z)T for z  (0, y) on the line

segment L(q, yc), see the left panel of Figure 8. Because zc  L(q, yc), the line l(xl, zc)

intersects L[yc, yr]. Denote  = y - z > 0 and y = l(xl, zc)  L[yc, yr].

Denote xz = lz,  l(xl, xr), yz = lz,  l(yl, yr), ez = lz,  l(a, b) and fz = lz,  l(b, c).

Consider angles 1, 2 and 3 corresponding to cases fz = c, ez = xl and yz = yr, respectively. It is not difficult to calculate



tan 1 = dc/zcd =

3/(1 - z), 

tan

2

=

xc xl /zc xc

=

(2

-

x)/( 

3(x + z)),

tan 3 = ycyr/yczc = (y + 2)( 3).

RAY BASIS THEOREM

23

+ 2.6

+ 2.6

2.4

2.4

2.2

2.2

2.0

2.0

1.8

1.8

1.6

1.6





3

0



2

0

2

2

min

1 2

 2

Figure 7. Example 2: Functions y+ (blue curve) and 0+ (thick orange curve) on their full domain [0, 2] (left panel) and the same functions zoomed into the
interval [0, /2] (right panel). Both functions attain the same minimum value. On the right hand panel, the point min where y+ attains its minimum, along with the points 1 and 2 of non-differentiability of function y+ are marked by dashed vertical lines.

a

a

0.0 0.5 1.0 1.5 2.0

0.0 0.5 1.0 1.5 2.0

-1.0

ez

xl

xz

xc q

yl

zc yc yz

b

d

fz

xr yr c

-1.0

xl yl b

xc o w zc
yc min
d

xr yr c

-2

-1

0

1

2

-2

-1

0

1

2

Figure 8. Proof of Example 2: A scheme of the configuration that corresponds to Part (II) of the proof, with point zc  D (µ) displayed (left panel), and the region where the additional median w is searched for (right panel).

If  is small enough, then 1 < 2 < 3. We consider four different cases and calculate z+.
For 0   < 1, one obtains z+ by substituting y by z in (14), and subsequently subtracting (ylyzzczl), where zl = lz,/2  l(a, b). Note that (zcycyz) = 2 tan /2 and (ylyczczl) = (4 + y + z)/(2 3), so

(21)

(yl yz zc zl )

=

2 2

t

+

4

+y + 23

z

-

1 2, 23



where t = 1/ 3 + tan .

24

RAY BASIS THEOREM

Case (i): 0   < 1. The previous calculation leads to

z+

=

1 3

2

-

3z

-

2z2

-

2x

-

xz

-

2

-

y

+ 2

z

+

2 2

+ F1(t),

where

F1(t)

=

(2 + z)2 6

1 t

+

(1 - z)2 + (x + z)2 - 2

t 2

.

For  small, F1(t) behaves similarly to F1(t). In that case z+ decreases with  for small positive values of , reaches its minimum value at

tan min =

2+z

- 1 ,

3 ((1 - z)2 + (x + z)2 - 2) 3

and then increases again as  grows. We also check tan min < tan 1 in the same way as we did in Part (I) of this proof -- analogously to (15), we should verify

2+z

< 4 - z.

1+

- x+z 2
1-z

2 (1-z)2

For  positive small enough the left hand side of the previous display is smaller than 2+z,

and we may conclude min < 1.

Case (ii): 1   < 2. In this situation, analogously to Case (i) we substitute y by z in (17) and subtract (21)

to obtain

z+

=

1 (5 3

-

6z

-

2z2

-

2x

-

xz

-

2

-

z

+ 2

y

+

2 2

)

+

F2(t),

where

F2(t) =

(x + z)2 - 2

t + (2 + z)2

2

6



1 t

-

t

1

-

2 3

.

We introduce again s = t - tan 1 - 1/ 3  0 and investigate G(s), analogously as in

(18) and (19), instead of F2(t). As in (20), we obtain the derivative of G(s) of the form





G(s) = (x + z)2 - 2 + 2(2 + z)2 

2

33

s

+

1

3 -z

2

-2

- 1

3



s

+

1

3 -z

,

which is positive for small , meaning that z+ increases as a function of   1, 2 .

Case (iii): 2   < 3. For these values of the parameter, it is easy to see that z+ grows with increasing , for the same reason as in Part (I) of this proof.

Case

(iv):

3



 2

.

In this range for , the function z+ is clearly constant, and equal to (yrylbc).

Summary of Part (II).

We conclude our analysis by observing that z+ attains its minimum at  = min, and its

maximum at  = /2. Because min  [0, 1), yc lies in the interior of Hzmin+ and therefore

min+ z

>

min+ y

=

y/2-

=

(µ).

On the other hand,

z/2- = y/2-

= (µ).

Because

RAY BASIS THEOREM

25

by Part (I) we know that yc is a median of µ, this means that zc and yc have the same depth, and the set D (µ) contains at least two distinct points zc and yc. The minimizing

halfspaces of µ at zc are those determined by the angle   [-/2, -3]  [3, /2]. Therefore, it is impossible to cover R2 with minimizing halfspaces of µ at point zc, meaning that zc  D (µ) is a point that fails to satisfy the covering property (4).
Due to the convexity of the median set D (µ) we already know that the line segment

L[yc, zc] is contained in D (µ). To see that the set D (µ) is in fact two-dimensional, now we find an additional median of µ of the form w = (-,  )T  ((-, 0) × (-y, -z)) \

H min y

+,

see

the

right

hand

panel

of

Figure

8.

The

smoothness

of

µ

implies

that

for



fixed,

inf {µ(H) : H  H(w) and {yc, zc}  Hc}  1/2 as   0. Since D (w; µ)  (µ) < 1/2

we obtain that for any  there exists  small enough so that each minimizing halfspace of

µ at w has to contain at least one of the points yc and zc. Each halfspace H  H(w) whose

boundary passes through w that contains either yc or zc, however, must have µ-mass at least (µ), since both yc and zc belong to D (µ). Therefore, for any   (-y, -z) and all  small enough, we conclude that the point w = (-,  )T is contained in the median

set D (µ), and the latter set must therefore be two-dimensional.

Part (III): The single point that satisfies the covering property (4) is yc. In Part (I) of this proof we demonstrated that yc satisfies (4). The fact that no other
point in R2 shares that property is a consequence of Theorem 12 proved in Section 4.1,
whose assumptions are satisfied by yc.

A.9. Proof of Theorem 9. First note that all the considered sets are convex, meaning
that each of them is of dimension d if and only if its interior is non-empty [25, Theorem 1.1.13]. The equality U(µ) = int (U(µ)) follows from Theorem 6; the interior of any set is a subset of its closure, which implies int (U(µ))  cl (U(µ)); the floating body UF B(µ) is an intersection of a larger collection of halfspaces than the depth region D(µ), meaning that UF B(µ)  D(µ). We prove the remaining non-trivial statements of the proposition in several steps.
Inclusion cl (U(µ))  UF B(µ). Suppose that there exists x  U(µ) \ UF B(µ). Since x / UF B(µ), there must exist Hy,v  H such that x / Hy,v and µ(Hyc,v)  . Its complement Hyc,v is an open halfspace whose boundary passes through y and has inner normal -v, i.e. Hyc,v = int (Hy,-v). We know that x  int (Hy,-v) and µ(int (Hy,-v)) = µ(Hyc,v)  . Therefore, Hx,-v  int (Hy,-v) and consequently µ(Hx,-v)  µ(int (Hy,-v))  , which is in contradiction with D(x; µ) > , as well as x  U(µ). We conclude that U(µ)  UF B(µ) and consequently cl (U(µ))  UF B(µ), because UF B(µ) is closed.
Part (i): Inclusion U(µ)  x  Rd : D(x; µ) >  . Pick x  U(µ), and suppose that D (x; µ) =   . Analogously to Lemma 1 it is possible to show that if D (x; µ) = , there must exist G  H(x) such that µ (int (G)) = . Define H = (int (G))c  H and note that x  bd (H) and µ (Hc) = µ(int (G)) =   . We reached a contradiction,
since for such a halfspace H the point x must be contained in int (H). Part (i): Inclusion x  Rd : D(x; µ) >   U(µ). If D(x; µ) > , then for each
H  H that contains x it has to be µ(int (H)) >  and therefore x / (U(µ))c. Part (ii): Inclusion UF B(µ)  cl (U(µ)) if int (U(µ)) = . Note that int (U(µ)) 
cl (U(µ))  UF B(µ), meaning that int UF B(µ) = . Therefore, if UF B(µ) \ cl (U(µ)) is non-empty, there must exist x  int UF B(µ) \ cl (U(µ)). To see this, denote by y any point in UF B(µ) \ cl (U(µ)). Since UF B(µ) is full-dimensional and convex, there exists an open ball B1  UF B(µ) [25, Theorem 1.1.13], and conv (B1  {y})  UF B(µ). Since

26

RAY BASIS THEOREM

cl (U(µ)) is a closed set that does not contain y, there exists an open ball B2 containing y that does not intersect cl (U(µ)). The set conv (B1  {y})  B2 is then a convex, full-dimensional subset of UF B(µ) \ cl (U(µ)), and as such has to contain a point in its interior x  int UF B(µ) \ cl (U(µ)), as we needed to show. Now, because x / U(µ), Lemma 1 gives that there exists H  H(x) such that µ(int (H))  D(x; µ)  . Denote
by Hx = (int (H))c the closed halfspace that satisfies µ(Hxc) = µ(int (H))  . We obtain UF B(µ)  Hx, which is in contradiction with x  int UF B(µ) .
Part (iii): int (D(µ)) = int (U(µ)). Under the considered condition of µ having
contiguous support at D(µ) the result follows by Theorem 6 and part (ii) of Theorem 5. Part (iv): UF B(µ) = D(µ). In dimension d = 1, the equality of the two expressions
is straightforward to verify by rewriting the conditions defining both UF B(µ) and D(µ) in terms of the function F (t) = µ ([t, )), for t  R. The general statement follows by projecting µ via u : Rd  R : y  y, u , for u  Sd-1, into its pushforward measure µu  M (R). The image of a halfspace Hx,u by u is the interval [ x, u , ). Knowing
the equality of the two concepts of central regions after projecting into R, it is enough to realise that D(µ) = uSd-1 u-1 (D(µu)) for u-1 the inverse map to u, and analogously for the floating body UF B(µ). For details see [7, Theorem 2].
Part (v): cl (U(µ)) = D(µ). Using part (iii) and the assumption of non-empty in-
terior of both involved sets, [25, Theorem 1.1.15] ensures that D(µ) = cl (int (D(µ))) =
cl (int (U(µ))) = cl (U(µ)) as needed to verify.

A.10. Proof of Lemma 10. Suppose that int (U(µ)) = . We may apply Theorem 6 with F = U(µ) and conclude that there exists H  H such that U(µ)  bd (H) and µ(int (H))  . At the same time, existence of x  U(µ) implies µ(H)  D(x; µ) >  and consequently µ(bd (H)) > 0. Therefore, for any x  U(µ), µ is not smooth at x.

A.11. Proof of Theorem 11. We distinguish two cases according to whether the median
set D (µ) is full-dimensional, or not.
Case (i): int (D (µ)) = . We write a = (µ) and start with Ua(µ) = >a D(µ). Since int (D(µ)) =  for each  > a and sets D(µ) are nested, we conclude that also int (Ua(µ)) = . Choose any x  aff (Ua(µ)). From Theorem 6 applied with F = Ua(µ) it follows that Rd can be covered by halfspaces H  H(Ua(µ))  H(x) such that µ(int (H))  a = (µ) for each such H. Since aff (D (µ))  aff (Ua(µ)), we obtain that also all points of D (µ) are possible to be used for such a covering, as we needed to show.
Case (ii): int (D (µ)) = . In this case, (µ) = (µ). Denote S0 = D (µ). This is a full-dimensional convex set, and for its barycentre x0  S0 and 0  M Rd the uniform probability distribution on S0 we know that D(x0; 0) > e-1, due to a result of Gru¨nbaum, see [20, Theorem 3]. Let H0  H(x0) be a generalized minimizing halfspace of µ at x0 in the sense of Lemma 1, i.e. µ (int (H0))  (µ). Writing vol(A) for the d-dimensional volume of a measurable set A, this implies 0(H0) = vol(S0  H0)/ vol(S0)  D(x0; 0) > e-1. Denote S1 = cl (S0 \ H0) with vol(S1) = vol(S0)(1 - 0(H0)) < vol(S0)(1 - e-1). We iterate the previous procedure and for k  1 define xk  Sk to be the barycentre of Sk.
In each step, we can find a generalized minimizing halfspace Hk  H(xk) of µ at xk, put Sk+1 = cl (Sk \ Hk), and again conclude

vol(Sk) < vol(S0) 1 - e-1 k .

Necessarily, vol(Sk)  0 as k  . Denote S =

 k=0

Sk

.

Then

S

 D (µ)

is

a

convex

set, vol(S) = 0, and consequently int (S) = .

RAY BASIS THEOREM

27

Note that D (µ) = S0 satisfies the assumption (5) of our main Lemma 4. Recursively, if Sk satisfies (5) for some k = 0, 1, 2, . . . , then the same holds true for Sk+1, because
Skc+1 = Skc  int (Hk) .
By the induction step, Skc is covered by halfspaces H  H with µ (int (H))  (µ) and int (H)  Sk+1  int (H)  Sk = . Adding to that collection the halfspace Hk that also satisfies µ (int (Hk))  (µ) and int (Hk)  Sk+1 = , we obtain a covering of Skc+1 with the desired property, i.e. also Sk+1 satisfies (5). We finally show that also S satisfies (5). Take any x / S and the first index k = 0, 1, 2, . . . such that x / Sk. There exists H  H with x  H, µ(int (H))   and int (H)  Sk = . Since S  Sk, it follows that int (H)  S = . Lemma 4 can now be applied to the set S to give the desired result, as follows by int (S) = .
A.12. Proof of Example 5. Each point in R2 is contained in one of the four halfspaces of µ-mass 6 determined by the dashed lines presented in Figure 9. Therefore (µ)  6. To prove that both points x and y are medians, it is enough to show D(x; µ) = D(y; µ) = 6. Because of the symmetry of µ, the problem reduces to showing D(y; µ) = 6.

-1.0 -0.5 0.0 0.5 1.0 1.5 -1.0 -0.5 0.0 0.5 1.0 1.5

p G
IH

J K
y ox

F
q E

A

D

BC

-1.0 -0.5 0.0 0.5 1.0

-1.0 -0.5 0.0 0.5 1.0

Figure 9. Example 5: Each point in R2 is contained in one of the four halfspaces of µ-mass 6 determined by the dashed lines (left hand panel). Thus, (µ)  6. On the right hand panel, several numerically computed contours D(µ) are displayed as sets with thick coloured boundaries. The median set D (µ) is the innermost convex set in this collection.

Consider an infinite line l passing through y and denote by H+ and H- the two closed halfspaces determined by l. We need to show that neither µ(H+) nor µ(H-) decreases below 6 as we rotate l around y. Equivalently, as µ(R2) = 14, it is enough to show that 6  µ(H+)  8 when rotating l by an angle of . Several specific positions of l are shown in the left hand panel of Figure 10; the corresponding halfspace H+ for line l1 is the one that does not contain the origin o. We start from l = l1 when µ(H+) = 6. As we rotate l around y counter-clockwise, µ(H+) remains the same for l being between l1 and
l2, since the triangles A and G in Figure 10 are symmetric with respect to y. Continuing the rotation, µ(H+) remains constant and then increases from l = l3 to l = l4, when µ(H+) = 7. For l between l4 and l5, H+ contains the triangles A, B, I, J, K, so

28

RAY BASIS THEOREM

µ(H+)  6 and H- contains D, E, F , G, meaning that µ(H-)  6. For l = l5, µ(H+) equals 7 and then decreases until l = l6, when µ(H+) = 6. Afterwards µ(H+) increases
again and reaches value 8 for l = l7. Finally, past l = l7 the µ-mass decreases and becomes equal to 6 when l is horizontal and then increases again and becomes 8 for l = -l1, where "-" in front of l1 means that the orientation of the halfspace H+ is the opposite from that in the beginning of the rotation. We have shown that x, y  D (µ) and (µ) = 6.
The convexity of D (µ) implies that o  D (µ), as well.

-1.0 -0.5 0.0 0.5 1.0 1.5 -1.0 -0.5 0.0 0.5 1.0 1.5

l5 l4 l3 l6
IH l7
J K

l2 l1
G
F

IH
J K

G

a

F

E

A

D

BC

E

A

D

BC

-1.0 -0.5 0.0 0.5 1.0

-1.0 -0.5 0.0 0.5 1.0

Figure 10. Example 5: In the left hand panel we display specific positions of halfspaces when rotating the line l that contains the point y. Boundaries of these halfspaces are shown as dashed lines. In the right hand panel we see several halfspaces whose boundary passes through o, as described in the proof. Each halfspace from H(o) that contains the point a has µ-mass at least 6.

Consider now the covering medians of µ. Certainly (µ) = 6. We are able to cover the whole space by halfspaces whose boundary contains y. To see this, consider the halfspaces determined by the horizontal and the vertical line containing y, respectively, and the one determined by line q in Figure 9. For x, the halfspaces are determined by the line p, and the horizontal and vertical line. Therefore, x, y  C (µ). In the right hand panel of Figure 10 we see that each halfspace whose boundary passes through the origin o and contains point a has µ-mass greater than 6. Therefore, it is not possible to cover a by minimizing halfspaces of o, and consequently o / C (µ).
A.13. Proof of Theorem 12. For any y  Rd denote by Hmin(y) the collection of those halfspaces H  H(y) that satisfy µ (int (H))  (µ). In particular, Hmin = Hmin(x). Suppose there is y  C (µ) such that y = x. Denote z = (x + y)/2. Since Rd =
{H  Hmin(y)}, there exists v  Sd-1 and Hy,v  Hmin(y) such that x  Hy,v. Then Hx,v  Hy,v and µ(int (Hx,v))  µ(int (Hy,v))  (µ), meaning that Hx,v  Hmin(x). If x  int (Hy,v), then Hx,v  Hz,v  int (Hy,v). Our contiguity assumption then implies µ(Hx,v) < µ(Hz,v)  µ(int (Hy,v))  (µ)  (µ), which contradicts x  D (µ). Thus, x  bd (Hy,v) and Hy,v  Hmin(x).
Consider any w  Rd. If w  Hy,v, choose Hw = Hy,v. Otherwise, the sequence of points zn = (1 - 1/n)z + w/n, n = 1, 2, . . . converges to z and zn / Hy,v. For

RAY BASIS THEOREM

29

each zn there is Hn  Hmin(y) such that zn  Hn and µ(int (Hn))  (µ). Using the same argument as for the halfspace Hy,v in the first part of the proof, we conclude that x / int (Hn), because of Hn  Hmin(y) and because of our contiguity assumption. Lemma 15 implies the existence of a convergent subsequence Hnk  Hw  H(z) such that µ(int (Hw))  (µ). Note that also y / int (Hn) because y  bd (Hn). Using Lemma 15, part (iv), we conclude that {x, y}  int (Hw) = . Because z  L(x, y) and z  bd (Hw), it has to be {x, y}  bd (Hw), meaning that Hw  Hmin(x)  Hmin(y). Finally, we conclude that for each w  Rd, there is Hw  Hmin(x)  Hmin(y) such that w  Hw. Then H = {Hw : w  Rd}  Hmin(x) covers Rd by halfspaces whose interior has mass at most (µ), that at the same time all contain y = x, which violates the
assumption of our theorem.

A.14. Proof of Corollary 13. The first part of the corollary is a direct consequence
of Theorem 5. Because µ is atomic with finitely many atoms, there are only finitely
many unique µ-masses of halfspaces H. Therefore, when applying the Fatou lemma of
Lemma 15 in the proof of Lemma 4, one obtains a strict inequality µ (int (H(x, F ))) < .
As for the second claim, first note that D(µ) is a convex polytope by [12, Lemma 1]. If D(µ) is full-dimensional, each face F of D(µ) is a subset of a (d - 1)-dimensional
face F of D(µ); if dim (D(µ)) < d, F  F = D(µ). If we prove our claim for F , it is necessarily true also for F . Without loss of generality, we may therefore suppose that F
is of dimension dim(F ) = min {dim(D(µ)), d - 1}. Let H(x, F ) be the halfspace from the first part of the proof. Denote by µ1  M Rd the restriction of µ to bd (H(x, F )) for H(x, F )  H (D(µ), F ) from the first part of the proof, and consider any x  F . If D(x; µ1) = 0, then there exists a closed (d-1)-dimensional halfspace H1 in the hyperplane bd (H(x, F )) such that x  H1 and µ1(H1) = 0. The existence of that minimizing halfspace follows because µ contains only finitely many atoms, thus there are only finitely many possible values of µ1(H) for H  H. Consider now a slight perturbation of the halfspace H(x, F ), in the sense that the unit normal v  Sd-1 of H(x, F ) is perturbed, but (i) the (d - 2)-dimensional affine space relbd (H1) remains in the boundary of the perturbed halfspace H  H(x), and (ii) H1  H. Because there are only finitely many atoms of µ, it is certainly possible to obtain H such that µ(H) = µ(int (H(x, F ))) +
µ(H1) = µ(int (H(x, F ))) < , which contradicts x  F  D(µ). We obtain that F  U(µ1) for  = 0. Since U0(µ1) is, again by the assumption of only finitely many atoms of µ, a polytope whose vertices are atoms of µ1, F has to be contained in a convex hull of at least dim(F ) + 1 atoms of µ, all lying in the hyperplane bd (H(x, F )).

Acknowledgement. This research was supported by the grant 19-16097Y of the Czech Science Foundation, and by project PRIMUS/17/SCI/3 of Charles University. P. Laketa was supported by the OP RDE project "International mobility of research, technical and administrative staff at the Charles University" CZ.02.2.69/0.0/0.0/18 053/0016976.

References
[1] Bezdek, K. and Khan, M. A. (2018). The geometry of homothetic covering and illumination. In Discrete geometry and symmetry, volume 234 of Springer Proc. Math. Stat., pages 1­30. Springer, Cham. [2] Bobkov, S. G. (2010). Convex bodies and norms associated to convex measures. Probab. Theory Related Fields, 147(1-2):303­332.

30

RAY BASIS THEOREM

[3] Brunel, V.-E. (2019). Concentration of the empirical level sets of Tukey's halfspace depth. Probab. Theory Related Fields, 173(3­4):1165­1196. [4] Chernozhukov, V., Galichon, A., Hallin, M., and Henry, M. (2017). MongeKantorovich depth, quantiles, ranks and signs. Ann. Statist., 45(1):223­256. [5] Donoho, D. L. and Gasko, M. (1992). Breakdown properties of location estimates based on halfspace depth and projected outlyingness. Ann. Statist., 20(4):1803­1827. [6] Dudley, R. M. (2002). Real analysis and probability, volume 74 of Cambridge Studies in Advanced Mathematics. Cambridge University Press, Cambridge. Revised reprint of the 1989 original. [7] Dyckerhoff, R. (2004). Data depths satisfying the projection property. Allg. Stat. Arch., 88(2):163­190. [8] Dyckerhoff, R. (2017). Convergence of depths and depth-trimmed regions. arXiv preprint arXiv:1611.08721. [9] Gru¨nbaum, B. (1963). Measures of symmetry for convex sets. In Proc. Sympos. Pure Math., Vol. VII, pages 233­270. Amer. Math. Soc., Providence, R.I. [10] He, X. and Wang, G. (1997). Convergence of depth contours for multivariate datasets. Ann. Statist., 25(2):495­504. [11] Kim, J. (2000). Rate of convergence of depth contours: with application to a multivariate metrically trimmed mean. Statist. Probab. Lett., 49(4):393­400. [12] Laketa, P. and Nagy, S. (2021). Reconstruction of atomic measures from their halfspace depth. J. Multivariate Anal., 183:104727. [13] Liu, R. Y., Parelius, J. M., and Singh, K. (1999). Multivariate analysis by data depth: descriptive statistics, graphics and inference. Ann. Statist., 27(3):783­858. [14] Liu, X., Luo, S., and Zuo, Y. (2020). Some results on the computing of Tukey's halfspace median. Statist. Papers, 61(1):303­316. [15] Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p > 2. J. Comput. Graph. Statist., 28(3):682­ 697. [16] Mass´e, J.-C. (2002). Asymptotics for the Tukey median. J. Multivariate Anal., 81(2):286­300. [17] Mass´e, J.-C. and Theodorescu, R. (1994). Halfplane trimming for bivariate distributions. J. Multivariate Anal., 48(2):188­202. [18] Mizera, I. and Volauf, M. (2002). Continuity of halfspace depth contours and maximum depth estimators: diagnostics of depth-related methods. J. Multivariate Anal., 83(2):365­388. [19] Nagy, S. and Dvor´ak, J. (2021). Illumination depth. J. Comput. Graph. Statist., 30(1):78­90. [20] Nagy, S., Schu¨tt, C., and Werner, E. M. (2019). Halfspace depth and floating body. Stat. Surv., 13:52­118. [21] Nolan, D. (1992). Asymptotics for multivariate trimming. Stochastic Process. Appl., 42(1):157­169. [22] Pata´kova´, Z., Tancer, M., and Wagner, U. (2020). Barycentric cuts through a convex body. In Cabello, S. and Chen, D. Z., editors, 36th International Symposium on Computational Geometry (SoCG 2020), volume 164 of Leibniz International Proceedings in Informatics (LIPIcs), pages 62:1­62:16, Dagstuhl, Germany. Schloss Dagstuhl­LeibnizZentrum fu¨r Informatik.

RAY BASIS THEOREM

31

[23] Pokorny´, D., Laketa, P., and Nagy, S. (2021). Halfspace depth for general measures: Dupin's theorem and the uniqueness of the halfspace median. In preparation. [24] Rousseeuw, P. J. and Ruts, I. (1999). The depth function of a population distribution. Metrika, 49(3):213­244. [25] Schneider, R. (2014). Convex bodies: the Brunn-Minkowski theory, volume 151 of Encyclopedia of Mathematics and its Applications. Cambridge University Press, Cambridge, expanded edition. [26] Small, C. G. (1987). Measures of centrality for multivariate and directional distributions. Canad. J. Statist., 15(1):31­39. [27] Struyf, A. and Rousseeuw, P. J. (1999). Halfspace depth and regression depth characterize the empirical distribution. J. Multivariate Anal., 69(1):135­153. [28] Tukey, J. W. (1975). Mathematics and the picturing of data. In Proceedings of the International Congress of Mathematicians (Vancouver, B. C., 1974), Vol. 2, pages 523­531. Canad. Math. Congress, Montreal, Que. [29] van der Vaart, A. W. and Wellner, J. A. (1996). Weak convergence and empirical processes. Springer Series in Statistics. Springer-Verlag, New York. [30] Wang, J. (2019). Asymptotics of generalized depth-based spread processes and applications. J. Multivariate Anal., 169:363­380. [31] Wang, J. and Serfling, R. (2006). On scale curves for nonparametric description of dispersion. In Data depth: robust multivariate analysis, computational geometry and applications, volume 72 of DIMACS Ser. Discrete Math. Theoret. Comput. Sci., pages 37­48. Amer. Math. Soc., Providence, RI. [32] Zuo, Y. and Serfling, R. (2000a). General notions of statistical depth function. Ann. Statist., 28(2):461­482. [33] Zuo, Y. and Serfling, R. (2000b). On the performance of some robust nonparametric location measures relative to a general notion of multivariate symmetry. J. Stat. Plan. Inference, 84(1-2):55­79. [34] Zuo, Y. and Serfling, R. (2000c). Structural properties and convergence results for contours of sample statistical depth functions. Ann. Statist., 28(2):483­499.

