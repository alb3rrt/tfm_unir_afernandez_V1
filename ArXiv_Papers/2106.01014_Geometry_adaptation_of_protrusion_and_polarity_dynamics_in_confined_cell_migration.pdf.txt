Geometry adaptation of protrusion and polarity dynamics in confined cell migration
David B. Bru¨ckner,1 Matthew Schmitt,1 Alexandra Fink,2 Johannes Flommersfeld,1 Nicolas Arlt,1 Edouard Hannezo,3 Joachim O. R¨adler,2 and Chase P. Broedersz1, 4 1Arnold Sommerfeld Center for Theoretical Physics and Center for NanoScience, Department of Physics,
Ludwig-Maximilian-University Munich, Theresienstr. 37, D-80333 Munich, Germany 2Faculty of Physics and Center for NanoScience, Ludwig-Maximilian-University, Geschwister-Scholl-Platz 1, D-80539 Munich, Germany
3Institute of Science and Technology, Am Campus 1, 3400 Klosterneuburg, Austria 4Department of Physics and Astronomy, Vrije Universiteit Amsterdam, 1081 HV Amsterdam, The Netherlands
Cell migration in confining physiological environments relies on the concerted dynamics of several cellular components, including protrusions, adhesions with the environment, and the cell nucleus. However, it remains poorly understood how the dynamic interplay of these components and the cell polarity determine the emergent migration behavior at the cellular scale. Here, we employ a datadriven theoretical approach to develop a mechanistic model for confined cell migration, revealing how the cellular dynamics adapt to confining geometries. Specifically, we use experimental data of joint protrusion-nucleus migration trajectories of cells on confining micropatterns to systematically determine a model linking the stochastic dynamics of cell polarity, protrusions, and nucleus. Our model indicates that the cellular dynamics adapt to confining constrictions through a switch in the polarity dynamics from a negative to a positive, self-reinforcing feedback loop. This feedback loop leads to stereotypical cycles of protrusion-nucleus dynamics that drive the migration of the cell through constrictions. Our data-driven theoretical approach therefore identifies polarity feedback adaptation as a key mechanism in confined cell migration.

arXiv:2106.01014v1 [physics.bio-ph] 2 Jun 2021

The ability of cells to migrate is essential for many physiological processes, including embryogenesis, immune response, and cancer [1­4]. In all these processes, cell migration relies on the interplay of several cellular components, including the formation of cell protrusions [5, 6], adhesive connections to the environment [7, 8], and the positioning of the bulky cell nucleus [9­11]. These components are coupled by the polarizable active cytoskeleton, and together play the dual role of sensing the cell's local microenvironment and driving its net motion. At the cellular scale, this machinery leads to coordinated, functional migration, which manifests as persistent random motion on uniform two-dimensional substrates [12, 13]. However, in physiologically relevant contexts, cells must navigate complex, structured extracellular environments [6, 14], featuring obstacles such as thin constrictions [4, 15]. Thus, migrating cells may adapt their migration strategy, and the underlying protrusion and polarity dynamics, by responding to the structure of their local micro-environment.
At the scale of whole-cell trajectories, confined cells exhibit intricate stochastic nonlinear dynamics in positionvelocity phase space, such as limit cycles and bistability [16]. These findings and other studies [10, 17­28] indicate that the migratory dynamics of cells is strongly affected by the presence of a confinement. However, the underlying physical principles and mechanisms that determine these emergent dynamics remain elusive. Specifically, it remains unclear if the dynamics of cells actively adapt to external confinement, or whether confinements simply serve as a passive boundaries. The search for such adaptive mechanisms is complicated by the intertwined behavior of the various cellular components and

features, such as cell shape, protrusions, polarity, and nucleus, which could factor into this problem. Thus, a crucial challenge is to reduce a mechanistic description to a level that can be constrained by data, while still capturing key behaviors of the important components. Achieving a mechanistic understanding of protrusion and polarity dynamics in confined cell migration could yield key insights into both the underlying molecular mechanisms and the biological functions associated with these dynamics.
To connect underlying mechanisms to the emergent behavior of migrating cells, biophysical mechanistic approaches are a promising avenue. At this level, complex computational models that include polarity processes and protrusion formation have been developed, including phase-field [29­31] and Cellular Potts models [32­ 35]. More coarse-grained models include active particle models [36], active gel theories [37, 38], molecular clutch models [39, 40], and models coupling actin flow, polarity cues, and focal adhesion dynamics [26, 41­45]. However, these approaches have two key limitations: On the one hand, computational models have many parameters that are difficult to constrain based on experiments, and testing their predictive power thus remains challenging. On the other hand, minimal models are frequently tailored to capture a particular aspect of the data, and it is often difficult to capture the full stochastic long time-scale dynamics of the cells. Indeed, there is currently a fundamental divide that has yet to be bridged: connecting mechanistic approaches for the underlying protrusion and polarity dynamics of confined migrating cells with their emergent, stochastic long time-scale motion.
Here, we develop a hybrid data-driven and mechanistic

2

FIG. 1. Data-driven development of a mechanistic model for confined cell migration. a, Schematic of our approach. We generate a large data data-set of joint protrusion-nucleus trajectories in a confined migration experiment (i, ii), and develop a data-driven approach by inferring model terms in the phase-space of protrusion and nucleus positions (iii). White arrows in (iii) indicate the stereotypical protrusion-nucleus cycling observed experimentally. Based on this inference, we systematically constrain a mechanistic model for the coupled dynamics of cell nucleus, protrusion, and the polarity driving force acting on the protrusion (iv). We test this model on a set of independent experiments, and by predicting the emergent long time-scale dynamics of the system (v). b, The model identifies three stages of protrusion-nucleus cycling. In the joint position probability distribution of nucleus xn and protrusion xp (panel a,iii, same color code as in Fig. 2f), we indicate the typical evolution of the system with white arrows, and identify three distinct stages of the process. Typical brightfield microscopy images with overlayed protrusive areas, and the positions xn and xp, are shown for each of the three stages. Schematics indicate the physical mechanisms that determine each phase according to our model.

approach, where we use experimental data to systematically constrain a minimal mechanistic model for confined cell migration postulated on the basis of physical principles and known cellular processes. To constrain this model, we experimentally study cells confined to a controlled micropatterned environment, allowing us to systematically vary the degree of confinement (Fig. 1a,i). By observing the cell shapes in these experiments, we generate a large data set of joint nucleus and protrusion trajectories (Fig. 1a,ii). Interestingly, under strong confinement, we find that cells exhibit a stereotypical migration pattern, which we term `protrusion-nucleus cycling' (Fig. 1a,iii). Using a data-driven approach, we constrain a theoretical description of the nucleus and protrusion dynamics by systematically increasing model complexity (Fig. 1a,iv). This approach reveals two key insights into the confined migration dynamics: first, we find that the average dynamics of the nucleus - roughly representing the main body of the cell - are determined by an adhesion landscape describing the locally available adhesive area. Second, the cell polarity, which drives the protrusions, couples to the local confining geometry by

switching from a negative to a positive, self-reinforcing feedback loop under strong confinement. Importantly, this mechanistic model accurately predicts cellular dynamics in systems with varying constriction width and length (Fig. 1a,v). Thus, by systematically disentangling the contributions of nucleus, protrusions, and polarity to the cellular dynamics we identify a mechanism of polarity adaptation to confinements which plays a key role in the behavioral dynamics of confined cells.
Protrusion dynamics drive confined cell migration
To investigate the dynamics of cell shapes, protrusions, and nucleus in confined migration, we study the migration dynamics of single MDA-MB-231 breast carcinoma cells confined to two-state micropatterns (Fig. 2a). These patterns consist of two adhesive islands connected by a thin adhesive bridge, allowing us to study how migrating cells respond to constrictions in the extra-cellular environment. We use time-lapse phase-contrast microscopy and fluorescent staining of the cell nuclei to investigate

3

FIG. 2. Extracting protrusion-nucleus dynamics from confined migration experiments. a. Exemplary brightfield microscopy image series of an MDA-MB-231 breast cancer cell migrating in a two-state micropattern with constriction width W = 7 µm and length L = 35 µm, indicated by arrows. Images are inverted for better visibility of cell shapes. Tracked cell shapes are shown as pink outlines. Blue dots indicate tracked nucleus position xn. b. Same time-series as in a, with protrusive areas marked in green, blue dot indicates the nucleus position xn, green dot the effective protrusion position xp. Green and blue lines indicate the trajectories of these two coordinates. c. Example image showing how protrusion areas are calculated. The solid pink line shows the current boundary of the cell area at time t, and the dashed line is the boundary at t + t. Protrusive area is shown in green. d. Kymograph of the brightfield microscopy images, with superimposed protrusion trajectory xp(t) in green. e. Joint trajectory of nucleus xn(t) (blue) and protrusion xp(t) (green). f. Joint probability distribution p(xn, xp) of the x-positions of nucleus and protrusion, plotted logarithmically and interpolated. Dotted lines indicate the boundaries of the adhesive islands. g. Position cross-correlations between nucleus and protrusion xn(t)xp(t + T ) (green), and nucleus and retraction xn(t)xr(t + T ) (red). The nucleus-protrusion correlation exhibits a peak at negative time shifts, indicating that the protrusion leads the nucleus by a typical time-shift Tnp  0.6 h. The retraction position xr is determined in a similar way to the protrusion (Supplementary Section S2). Blue line shows the nucleus position auto-correlation, xn(t)xn(t + T ) . All scale bars: 25 µm.

the joint dynamics of cell shape and nucleus motion. We find that the motion of the nucleus is correlated with the growth of a protrusion across the constriction of the pattern, suggesting that the protrusion dynamics of these cells are key to understanding cell migration dynamics.
To quantify these protrusive dynamics, we first isolate cell shapes from bright-field microscopy image stacks using a convolutional neural network with a U-Net architecture [46] (Methods). This segmentation procedure allows us to accurately determine the 2D shape of the cells as a function of time (Fig. 2a). To identify protrusions, we classify those components of the cell shape added in each time step as protrusive areas (Fig. 2b,c, Methods, Sup-

plementary Movie S3) [47]. During the traversal of cells across the constriction, large protrusive areas are formed at the leading edge of the cell. Importantly, due to the micropattern geometry, most protrusive activity is in the x-direction along the long axis of the pattern (Supplementary Section S2). Thus, to provide a low-dimensional representation of the protrusion dynamics, we define the effective protrusion position xp(t) as the x-component of the geometric center of protrusive area (Fig. 2c), referred to as the protrusion from here on. Indeed, the protrusion trajectories serve as an indicator of the protrusive dynamics of the cells, as shown by an overlay with the kymograph of the microscopy images (Fig. 2d, Supple-

4

mentary Movie S3). In addition, we track the trajectories of the cell nucleus, which mostly resides near the central body of the cell. While the cells also perform retractions at the trailing edge, we find that these are strongly correlated with the motion of the nucleus with near-zero time-lag, and therefore do not contain significant additional information (Fig. 2g, Supplementary Section S2). Thus, we restrict our analysis to the nucleus-protrusion dynamics. This analysis pipeline gives access to a large data set of low-dimensional trajectories of cell nucleus and protrusion dynamics (1400 trajectory pairs with duration up to 50h), allowing an in-depth statistical analysis of the cellular dynamics.
The joint nucleus and protrusion trajectories reveal that these cells tend to migrate across the constriction in a stereotypical manner: first, the protrusion grows slowly across the constriction, after which the nucleus rapidly follows (Fig. 2e). The nucleus motion exhibits weaker fluctuations than the protrusions and responds to the protrusions with a time delay, as quantified by the cross-correlation function xn(t)xp(t + T ) (Fig. 2g). The stereotypical migration pattern is reflected as a ring-like structure in the joint probability distribution of nucleus and protrusion positions p(xn, xp) (Fig. 2f). While the most likely states are where both nucleus and protrusion occupy one island, there is significant probability along the path where the protrusion first crosses the constriction and reaches the other island, followed by the traversal of the nucleus. In contrast, there is low probability of observing both protrusion and nucleus in the constriction. Together, these results indicate that the confined migration dynamics exhibit a stereotypical `protrusionnucleus cycling' represented as paths in xnxp-space.

Confined cells migrate in an adhesion landscape

We aim to develop a mechanistic theory to describe how the coupled stochastic dynamics of cell nucleus and protrusion determine the confined migration of cells. Our strategy will be to postulate simple model candidates based on known cellular processes, physical principles, and symmetry arguments, which we systematically constrain using the experimental data.
We expect forces on the nucleus to arise due to two main contributions: coupling to the cell protrusion [6, 10, 11, 48], and the effect of the confining micropattern. Similarly, protrusions couple to the cell nucleus [6], and may be sensitive to the external environment. Thus, considering force balance at xn and xp (Fig. 3a), we obtain

nx n = fc(xn, xp) + fn(xn)

(1)

px p = -fc(xn, xp) + fp(xp) + P (t)

(2)

where n, p are the friction coefficients of nucleus and protrusion, respectively, fc is the coupling between nu-

FIG. 3. Nuclear velocity maps constrain model candi-

dates. a. Schematic of the model. Arrows indicate the forces

acting on the cell at positions xn and xp. b. Experimental

nuclear velocity map (NVM), calculated as the conditional

average of the nucleus velocity as a function of nucleus and

protrusion positions, x n|xn, xp , shown with interpolation. c. Double-well potential W (xn) = Q(1 - (xn/x0)2)2, where

Q determines the height of the energy barrier, and x0 the

positions of the minima. Image indicates the dimensions of

the micropattern, and shows a fluorescence microscopy im-

age of the actin cytoskeleton of a confined cell (LifeAct-GFP-

transfection). d. NVM predicted by the energy potential.

Parameters are determined by a best fit to the experimen-

tal NVM (Supplementary Section S4). e. Cuts of the NVM

along the horizontal lines indicated in panel d, showing x p as a

function of xn for different xp. Dots: Experiment, solid lines:

deformation model prediction. f. Spatially variable friction

(xn)

=

min

+

1 2

(1 - min)

(1

-

cos

(xn/Lsystem))

used

in

the

adhesion landscape model, where min is the friction at the

center of the constriction, and Lsystem is the total length of

the micropattern. g. NVM predicted by the adhesion land-

scape model. h. Same plot as in panel e for the adhesion

landscape model.

cleus and protrusion, and fn,p are additional forces acting on each nucleus and protrusion due to the confinement. Additionally, we assume the protrusion to be driven by a stochastic active force P (t), which serves as a minimal implementation of the time-dependent forces driving protrusion formation, such as the active pushing force due to actin polymerization [5, 42]. This active force determines the instantaneous direction of polarization in which protrusions are generated, and we therefore refer to it as the cell polarity. In this model, the intrinsic stochasticity of the system stems from the polarity dynamics driving the protrusion. This assumption is supported by our experiments: we find that fluctuations in the nucleus velocities

5

x n are small compared to the deterministic components. By comparison, the fluctuations in the protrusion velocities x p are much larger and dominate over deterministic contributions to the protrusion velocities (Supplementary Section S3).
To constrain our model step-by-step, we start with the dynamics of the cell nucleus. In migrating cells, the motion of the nucleus is coupled to the dynamics of the leading edge, for example, through material stresses in the cytoskeleton connecting protrusion and nucleus [6, 10, 48, 49], or through mechanical feedback processes coupling the leading and trailing edge of the cell [50]. As a minimal model for this coupling, we consider a linear elastic spring, similar to previous work [26, 43].
It is less clear, however, how to incorporate the effect of the confining micropattern on the dynamics. Physically, we consider two distinct ways to couple the cell dynamics to geometry. First, a conservative force, corresponding to a double-well potential W (xn), with minima on the adhesive islands and a barrier around the constriction (Fig. 3 c), can provide a model for the contribution due to cell deformations during the transition. Such deformation dynamics of cells is frequently modelled using effective Hamiltonians including the surface and line tension of the cell [33, 35, 51­53], which would suggest that the deformed state of the cell in the constriction is associated with an increased energy. Second, the difference in adhesive area available to the cell on the island and in the constriction could lead to a dissipative force corresponding to a spatially variable friction coefficient [54, 55]. Mesenchymal migration exhibits mature focal adhesions at the cell rear, where the nucleus typically resides [56, 57]. These adhesions can only form within the micropatterned area, and we therefore expect the adhesiveness to be largest on the islands and smallest at the center of the constriction.
To test the energy potential contribution, we postulate the equation of motion for the cell nucleus

nx n = k(xp - xn) - xn W (xn)

(3)

This equation makes a concrete prediction for how the nucleus velocity x n varies with the positions of nucleus and protrusion. To test this prediction directly on the experimental data, we determine the average velocity of the cell nucleus as a function of xn and xp, x n|xn, xp , which we term the nuclear velocity map (NVM) (Fig. 3b). Importantly, with this approach based purely on the nucleus velocities, we can determine the deterministic nucleus dynamics (Eq. (1)) without making assumptions about the protrusion and polarity dynamics (Eq. (2)). Strikingly however, we find that the NVM predicted by the energy potential fails to capture the experimental data, as it does not predict the characteristic acceleration of the nucleus in the constriction (Fig. 3d,e). This approach similarly fails for more general non-linear elastic couplings

between nucleus and protrusion (Supplementary Section S3). Therefore, we conclude that such potential energy models alone are not able to recover the cellular dynamics in this setup.
To test the possible contribution of differences in local adhesion, a simple model is a spatially variable friction coefficient:

n(xn)x n = k(xp - xn)

(4)

where (xn) ensures lower friction in the constriction (Fig. 3f). Remarkably, this model provides an excellent fit to our data, and captures the characteristic increase in nucleus speeds during traversal (Fig. 3g,h). The acceleration of the nucleus could therefore be understood as a consequence of the reduced number of adhesions formed by the cell body around the nucleus when it is in the constriction. Taken together, these results indicate that a dissipative force arising from a spatially variable adhesion landscape is a key component of the effect of the confining constriction on migration dynamics, which in our setup appears to dominate over possible contributions due to cellular deformations.

Adhesion landscape model captures dependence of nucleus dynamics on constriction width
Our adhesion landscape model (Eq. (4)) makes a simple, intuitive prediction. As we widen the constricting bridge of the micropattern, more adhesive area becomes available, thereby reducing the variations in the friction profile (Fig. 4a). In the limit where the constriction has the same width as the islands, we expect a uniform adhesiveness profile. Accordingly, we predict the acceleration of the cell nucleus observed on thin bridges (Fig. 3) to decrease with the increasing adhesiveness of a wider bridge, and to completely disappear for constant adhesiveness (Fig. 4c,d). In this limiting case, we expect dynamics that are completely determined by the linear elastic coupling between nucleus and protrusion (last panel Fig. 4d).
To challenge the predictive power of the adhesion landscape model, we perform experiments with varying bridge width (Fig. 4b). Remarkably, the nuclear velocity maps inferred from these experiments are well predicted by the model, and exhibit the predicted decreasing maximum nucleus speed in the constriction (Fig. 4c,d). On the rectangular micropattern without constriction, we find an almost linear profile of the nucleus speed with position, as predicted theoretically. This further supports our model of the nucleus-protrusion coupling as a linear elastic spring. In summary, the adhesion landscape model has predictive power for confining geometries with varying constriction width.

6

FIG. 4. Adhesion landscape model predicts dynamics with varying constriction width. a. Friction profiles (xn) with increasing min as a model for increasing bridge width. The value of min is fitted for the narrowest bridge (W = 4 µm; min  0.2, k/n  0.6 h-1). For the widest system without constriction, we take a flat profile and interpolate the profiles for intermediate widths (Supplementary Section S4). b. Sketch of confinement geometries with increasing bridge widths W = 4, 7, 12, 22, 35 µm (from left to right); brightfield microscopy images of MDA-MB-231 cells migrating in these geometries with cell outline in pink and nucleus position in blue, and geometry in white. Scale bar: 25 µm. c. Predicted and experimental nuclear velocity maps (NVM) x n|xn, xp . Plotted with the same color axis as shown in Fig. 3. d. Predicted and experimental cuts of the NVM, showing x p as a function of xn for different xp as described in Fig. 3.

Protrusions driven by time-correlated polarity

Having determined how the dynamics of the nucleus couples to the confinement and protrusion, we next investigate the dynamics of the protrusion itself (Eq. (2)). As a minimal model for the protrusion dynamics, we postulate a coupling to the cell nucleus equal and opposite to the coupling introduced for the cell nucleus (Eq. (4)). In addition, we enforce a potential V (xp) = (x/xboundary)8 to confine the protrusion between the boundaries of the micropattern (Supplementary Section S3):

px p = -k(xp - xn) - xp V (xp) + P (t)

(5)

Thus, we assume that both the friction and the potential term of the protrusion are insensitive to the presence of the constriction. Importantly, however, we anticipate that the polarity P may couple to the confinement, as it models the active driving of the protrusion by the molecular migration machinery, including actin polymerization and the diffusion of polarity cues [5, 42], which may be sensitive to the geometry of the confinement.
Similar to our approach to the nucleus dynamics, this protrusion model provides a prediction for the average protrusion velocity as a function of xn and xp, x p|xn, xp , which we term protrusion velocity map (PVM). According to our general model ansatz (Eq. (2)), unlike the NVM, the PVM consists of several components, including the polarity dynamics:

x p|xn, xp = -fc(xn, xp) + fp(xp) + P |xn, xp (6)

Since the polarity term P |xn, xp does not average to zero for time-correlated polarities, we cannot in general disentangle the contributions to the protrusion dynamics based on the PVM [58, 59]. Instead, we will constrain the polarity dynamics by systematically testing models of increasing complexity.
We first show that the data cannot be captured by the simplest possible stochastic polarity dynamics: a Gaussian white noise process P = (t) with (t) = 0 and (t)(t ) = (t - t ). In this case, P |xn, xp = 0 (Inset Fig. 5a), and we directly recover the expected contractile elastic coupling (Eq. (5)) in the PVM (Fig. 5a). In striking contrast to this prediction, the PVM inferred from experiments shows an intricate dependence of the protrusion velocities as a function of xn and xp (Fig. 5c). These results indicate that to account for the experimentally observed dynamics, we need to account for time correlations in the polarity (Supplementary Section S3).
The overall structure of the experimental PVM is in line with a contractile coupling between nucleus and protrusion: it exhibits negative velocities for xp > xn and positive velocities for xp < xn. These features correspond to the protrusion being pulled back towards the nucleus. Strikingly, however, when the protrusion extends into the constriction, the protrusion velocity switches sign, corresponding to an unexpected driving force pushing the protrusion away from the nucleus. This `polarity driving' cannot be accounted for even by a non-linear contractile coupling to the nucleus in our model with a white-noise polarity. Instead, we expect that the polarity may exhibit time-correlations to account for the spatiotemporal dynamics of the migration machinery.
To investigate how time-correlated polarity dynamics affect the migration behavior, we consider the simplest choice of a persistent, exponentially correlated polarity

P = -0P + (t)

(7)

with 0 > 0. In this case, the polarity experiences negative feedback, P  -P , and exhibits time-correlations

7

FIG. 5. Dynamics of time-correlated polarities. a,b. Protrusion velocity maps (PVM) x p|xn, xp predicted by the white noise model, and the persistent polarity model. In both models, we use a potential to enforce the overall system boundaries, V (xp) = (x/xboundary)8 (see Supplementary Section S4). Inset: polarity contribution to the PVM, given by P |xn, xp . c. PVM inferred from experiments with bridge width W = 7 µm. d. Joint probability distribution p(xn, xp) predicted by the persistent polarity model, plotted logarithmically. Dotted lines indicate the boundaries of the adhesive islands. e. Probability distribution of the dwell times  , defined as the time between subsequent transitions of the cell nucleus across the bridge centre; observed experimentally (W = 7 µm, blue), and predicted by the white noise (black dashed line) and the persistent polarity model (orange).
P (0)P (t) decaying exponentially on a persistence timescale 0-1. Interestingly, these polarity dynamics have significant correlations with the state of the system: P |xn, xp = 0 (Inset Fig. 5d), and thus, unlike in the white-noise case, the polarity contributes to the PVM (Eq. (6)). Specifically, the persistent polarity exhibits a polarity driving similar to the experimental PVM (Fig. 5b,c). Taken together, these results indicate that cell protrusions are driven by time-correlated polarity dynamics.
Confinements trigger polarity self-reinforcement
While the persistent polarity (Eq. (7)) describes the qualitative features of the protrusion velocities (Fig. 5b,c), it predicts stochastic dynamics that do not capture the key features of the experiment. Specifically, it fails to capture the stereotypical protrusion-nucleus cycling indicated by the ring structure in the experimental probability distribution p(xn, xp) (Fig. 5d, Supplementary Section S3). Furthermore, this approach does not capture the distribution of dwell times (Fig. 5e), defined as the time between subsequent transitions of the cell nucleus across the bridge centre. In the experiment, this distribution exhibits a marked peak at finite times, indicating that there is a typical time-scale for re-orientation

on the island and subsequent traversal between transitions.
The persistent polarity relies on several simplifying assumptions. Firstly, we assumed the polarity to be insensitive to the local confinement, as the polarity dynamics do not explicitly depend on the position of the protrusion. Secondly, we assumed negative feedback, P  -P . This means that the polarity is effectively confined to a harmonic potential U (P ) = 0P 2/2, and thus always driven back towards zero (Fig. 6a).
To relax these assumptions, we propose a geometry adaptation model, where the strength and sign of the polarity feedback depend on the local geometry of the confinement. Thus, the feedback may vary with the position of the protrusion,  = (xp). Physically, we expect that the polarity may become more persistent when the protrusion is in the constriction. Such an increase in persistence could be due to increased alignment of actin fibers [60­63], or more stable polarity cue gradients [42, 64, 65] when the protrusion is confined to a narrow constriction. To ensure that the polarity remains bounded, we include the next-order term allowed by symmetry -P 3, with  > 0, and allowing  < 0 locally:

P = -(xp)P - P 3 + (t)

(8)

To account for larger persistence in the constriction, we choose a feedback function (xp) with a minimal value min in the center of the constriction (Fig. 6a). If min > 0, the polarity dynamics exhibits a stable fixed point at P = 0 everywhere (Fig. 6a). In contrast, if min < 0, the polarity is still driven back to P = 0 on the islands, but in the constriction, two stable fixed points P  = ± ||/ emerge. Consequently, when the protrusion is in the constriction and the polarity is small (|P | < |P |), a positive feedback mechanism P  P is activated, leading to a self-reinforcement of the polarity in the current direction of polarization, breaking the symmetry of the dynamics.
We now explore the predictions of the geometry adaptation model by varying min (Fig. 6b). As expected, for negative polarity feedback (min > 0), we find a polarity distribution p(xp, P ) with polarities centered around P = 0 at all positions xp. In contrast, for positive feedback, polarities preferentially take finite values in the constriction, yielding a ring-structure in the polarity distribution p(xp, P ) (Fig. 6b). Remarkably, the model then predicts protrusion-nucleus cycling in p(xn, xp) and a marked peak in the dwell time distribution, both in line with the experiment.
Up to this order of description, there are two possible alternative models allowed by symmetry which couple the polarity to the state of the system. First, instead of coupling the polarity feedback to the geometry, the overall amplitude of the polarity could depend on position. Second, instead of a position-dependent feedback, one could consider feedback that depends on the cell's extension

8

FIG. 6. Geometry adaptation model. a. Schematic illustration of the polarity models. The persistent polarity corresponds to a flat feedback profile, (xp) = 0, where the polarity is effectively confined to a constant harmonic potential U (P ) (left). In the geometry adaptation model (Eq. (8)), min controls the sign of the feedback. For min > 0, the feedback is negative and the polarity is confined to harmonic potentials with spatially varying stiffness (left). For min < 0, the feedback locally becomes positive, leading to two stable fixed points (right). b. From left to right, we vary the value of min = {6, 4, 0, -4, -6} h-1. The joint probability distribution of protrusion position and polarity p(xp, P ) is shown. Solid red lines indicate the position of the stable fixed points in the polarity dynamics, dashed red lines indicate unstable fixed points. c. Joint probability distributions p(xn, xp) predicted by the geometry adaptation model with varying min. d. Probability distribution of the dwell times  predicted by the model (red) and observed experimentally (W = 7 µm, blue).
|xn - xp|. Interestingly however, these alternatives fail to capture our experimental observations (Supplementary Section S3). Taken together, these results suggest that to capture the stereotypical protrusion-nucleus cycling, we require a geometry-sensitive polarity feedback.
Geometry adaptation model correctly predicts migratory dynamics in various confining geometries
We challenge the predictive power of our approach by investigating the stochastic trajectory dynamics of cells in micropatterns with increasing constriction width (Fig. 7a). Specifically, we combine the adhesion landscape model for the nucleus with the geometry adaptation model for protrusion and polarity (Eq. (4), (5), (8)) to yield a mechanistic model for confined cell migration. Increasing constriction width has a clear impli-

cation for this model: in addition to the adhesiveness profile (xn) becoming flatter (Fig. 4a), we also expect the positive polarity feedback to diminish. Strikingly, our model predicts that the protrusion-nucleus cycling should disappear with increasing constriction width: the ringstructure of the position distribution p(xn, xp) and the position-velocity distribution p(xn, vn) gradually close (Fig. 7b,c), and the typical transition time-scale, indicated by the peak in the dwell time distribution, disappears (Fig. 7d). Remarkably, these predicted features of the dynamics are confirmed experimentally (Fig. 7b-d).
These observations can be understood by examining the protrusion dynamics in the model: we find that the predicted PVM exhibits a polarity driving of decreasing magnitude with increasing bridge width (Fig. 7e). Notably, the driving disappears in the widest system with no constriction, where the protrusion velocities are thus determined by the protrusion-nucleus coupling. This coupling pulls protrusion and nucleus together, inhibiting the stereotypical cycle. Our model therefore suggests that these stereotypical cycles rely on the adaptation of the cell polarity dynamics to its local environment. We further challenge our model by exploring geometries with varying constriction length L and show that our model also captures the changes in dynamics observed in this case (Supplementary Section S3). Taken together, these results indicate that our mechanistic model has strong predictive power beyond the specific confinement geometry which we used to constrain it.
Mechanistic model captures emergent nonlinear dynamics
A central challenge for our mechanistic theoretical approach is to capture the emergent long time-scale systemlevel dynamics of the migrating cell. Based on the trajectories of the cell nucleus alone, we showed in previous work [16] that the dynamics can be described by an underdamped stochastic equation of motion: vn = F (xn, vn) + (xn, vn)(t) where (t) is Gaussian white noise. This model represents an effective description of the cellular dynamics, with no direct connection to cellular degrees of freedom such as the protrusion and polarity, which we consider here. The deterministic contribution F (xn, vn) exhibits intricate non-linear dynamics, depicted in a phase-space portrait (Fig. 7f). These phase-space portrait reveal that the nucleus deterministically accelerates into the thin constriction (orange arrows Fig. 7f) and exhibits an effective `negative friction' at the center of the constriction (Fig. 7g) [16]. These observations encapsulate the emergent long time-scale dynamics of the migrating cell, yet a mechanistic model that can capture these dynamics has thus far remained elusive.
Remarkably, we find that our mechanistic model for the coupling of the cell nucleus motion to the cellular pro-

9
active squeezing behavior is a consequence of two combined effects: lower adhesiveness and enhanced polarity persistence in the constriction (Supplementary Section S3). Accordingly, our model predicts that when the constriction is widened, corresponding to higher adhesiveness and lower polarity persistence, the amplification of nucleus velocities and the effective negative friction gradually disappear (Fig. 7f,g), as we observe experimentally. In summary, we find that the mechanistic model for the nucleus, protrusion, and polarity degrees of freedom of the cell gives insights into the origin of the system-level nonlinear dynamics inferred from confined cells.

Discussion

FIG. 7. Geometry adaptation models predict dynamics with varying constriction width. a. Stochastic trajectories xn(t) (blue), xp(t) (green), and P (t) (pink) predicted by our mechanistic model, which combines the adhesion landscape and geometry adaptation (Eq. (4), (5), (8)). We simultaneously increase min and min to account for increasing bridge width W (Supplementary Section S4). b. Joint probability distributions p(xn, xp). c. Joint probability distributions p(xn, vn). d. Predicted (red) and experimental (blue) dwell time distributions p( ). e. Protrusion velocity maps (PVM) x p|xn, xp . f. Flow field (x n, vn) = (vn, F (xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. g. Predicted (red) and experimental (blue) effective friction at the bridge center F (xn  0, vn). In panels b, c, e, f, the top row corresponds to the model prediction, the bottom row to experimental observations. Experimental observations correspond to W = 4, 7, 12, 22, 35 µm (from left to right).
trusion and polarity dynamics (Eq. (4), (5), (8)) recovers this effective dynamical description for the stochastic migration dynamics and predicts a phase-space flow similar to that inferred directly from experiments (Fig. 7f). Interestingly, we can directly map the equations of motion of the mechanistic model to the effective underdamped nucleus dynamics, revealing that the observed

In this work, we develop a mechanistic theoretical framework to describe the joint stochastic dynamics of cell nucleus, protrusion, and polarity, and their coupling to the extracellular microenvironment. Experimentally, we find that cells migrating in confinements with a thin constriction exhibit a stereotypical protrusion-nucleus cycling, with characteristic protrusion growth followed by a rapid transition of the nucleus across the bridge. Using a large experimental data set of joint protrusion and nucleus trajectories, we systematically constrain a mechanistic model for confined cell migration.
In our model, we identify three distinct stages of the protrusion-nucleus cycling (Fig. 1). First, we observe an initial exploration phase, where both nucleus and protrusion are located on the same island (Stage I). At this stage, the polarity is subject to negative feedback, causing the protrusion to frequently change direction and explore its surroundings. Stochastic polarity excitations can trigger the protrusion to enter the constriction. Within the constriction, the protrusion becomes highly confined, causing the polarity dynamics to switch from a negative to a positive feedback loop. This positive feedback reinforces the polarity, driving the protrusion growth into the constriction (Stage II). At the same time, tension builds up due to the coupling to the nucleus, which is held back on the island due to the enhanced adhesion with the substrate. Once the protrusion reaches the other end of the system, the nucleus is pulled across the constriction, relaxing the tension in the elastic coupling, reminiscent of a slingshot (Stage III). The three stages of the transition process emerge as a consequence of the interplay of the three key physical mechanisms in the system: the adhesion landscape, the nucleusprotrusion coupling, and the polarity self-reinforcement.
To develop our theoretical approach, we separately constrain the dynamics of the nucleus and the protrusion and systematically consider model terms of increasing complexity (Supplementary Table S1). We first studied the stochastic dynamics of the cell nucleus. Interestingly, the nucleus dynamics are inconsistent with movement in

10

a simple double-well potential, as might be expected for example from cellular deformation arguments [33, 35, 51­ 53]. Indeed, active particles confined to double-well potentials can exhibit excitable dynamics similar to those observed in the experimental trajectories of the nucleus alone [66], making the double well a promising model candidate. However, based on the observed joint dynamics of nucleus and protrusion, we find that this energy barrier model is unable to capture our experiments.
Instead, our model suggests that the movement of the nucleus is determined by the locally available adhesive area, manifesting as an adhesion landscape with a spatially variable friction coefficient. Thus, as the protrusion explores the environment, the back of the cell `sticks' due to the high adhesiveness on the island. This is in line with experimental observations showing that in mesenchymal migration, the movement of the cell rear, where the nucleus is typically located, is limited by the unbinding of mature adhesions [67, 68]. In the constriction, the cell polarity actively drives the protrusion away from the nucleus, causing mechanical stress to build up in the protrusion-nucleus coupling. This `self-loading' of the coupling eventually causes a contraction stage, where the cell quickly contracts and the nucleus rapidly moves across the constriction. In the model, the tension in the elastic coupling rapidly relaxes during the slip phase, similar to a slingshot. Such `slingshot' dynamics have also been observed in confined 3D migration in fibrous matrices [69].
The adhesion-limited nucleus motion is reminiscent of stick-slip processes that have been observed in cell migration on 1D lines [26, 44, 70] due to the mechanosensitive binding and unbinding dynamics of adhesions [26, 43]. In contrast, our work suggests that a key determinant for stick-slip dynamics in confined systems is the interplay of the geometry-sensitive polarity dynamics with the elastic protrusion-nucleus coupling, leading to the self-loading of the coupling. Specifically, our model indicates that the polarity dynamics adapts to the presence of the constricting geometry by activating a self-reinforcing positive feedback loop. This positive feedback leads to a broken-symmetry state, in which there is a non-zero preferred polarity. Previous work on unconfined 2D migration has suggested a similar symmetry breaking mechanism in the cell velocity dynamics, leading to a long-lived state of spontaneous polarization [41]. However, in that case, this state emerged for particular cell parameters. In contrast, our work suggests that such states may also emerge as a consequence of adaptation to a confinement.
Interestingly, we were able to rule out an alternative model to the position-dependent feedback where the polarity dynamics do not depend explicitly on external geometry, but on the extension of the cell (Supplementary Section S3). An interesting aspect of comparing these two models are their conceptually distinct implications. The position-dependent feedback implies a di-

rect coupling to the external environment, where the cell may sense and adapt to the external geometry. In contrast, an extension-dependent feedback is translationally invariant, and only depends on the internal state of the cell. Such a mechanism has recently been suggested to be decisive for protrusion growth in keratocytes [71]. In contrast, our findings suggest that the positive feedback loop in the polarity is a response to the geometry of the local microenvironment rather than to the overall extension of the cell.
This geometry adaptation at the level of cellular dynamics could emerge as a consequence of underlying biological mechanisms. This raises an important question for future work: which biophysical processes control this adaptation? First, based on the physics of active gels, which describe, for example, the actomyosin cortex in the protrusion, we expect a greater degree of alignment of actin fibers in a narrow constriction [60, 61]. Increased alignment of actin is associated with higher contractility [72, 73] and the emergence of spontaneous cell polarization [62, 63, 74­76]. A further key determinant of cell polarization are diffusable polarity cues [42, 77, 78], whose spatiotemporal organization may couple to external geometries, for example through focal adhesions [79], or the cell shape itself [64, 65]. Finally, changes in membrane tension may also provide feedback to the cell polarity [43, 80]. Our work could provide a new tool that could be used to analyze the dynamics of cells in experiments where these distinct contributions to the polarity dynamics are targeted through molecular perturbations.
Based on experiments in which we varied the dimensions of the constriction, we found that our model has predictive power beyond the specific confinement geometry used to constrain it. Thus, this model could potentially be used to make predictions for new experiments, such as cell migration on patterned lines [19, 20, 45, 81], in 3D-confinements [10, 82], or at junctions in a maze [28]. Previous work has investigated the effect of asymmetric periodic patternings, which led to a rectification of cell migration in one direction [18­20]. This rectification has been interpreted to be a consequence of the asymmetry in locally available adhesive area [21], consistent with our adhesion landscape model. Interestingly, our work suggests that the adaptation of cell polarity in response to confinements may also play an important role in such processes. Furthermore, protrusion and polarity dynamics are critical in migration in 3D extra-cellular matrices [4, 6, 83], as well as in pair-wise interactions of cells [84­86], which in turn control the collective dynamics of cells [87]. The geometry adaptation dynamics we have identified here could therefore play an important role in these more complex processes, and provide a new framework for physical models of cell migration in confining systems.

11

Methods
Sample preparation - Fibronectin micropatterns are made by microscale plasma-initiated protein patterning as described previously [16]. All two-state micropatterns are designed to have adhesive island with square dimensions ((36.7 ± 0.6)2 µm2). For patterns with varying bridge width, we use a standard bridge length L = 35.3±0.5 µm and widths W = 3.9 ± 0.5, 6.9 ± 0.6, 9.5 ± 0.5, 12.4 ± 0.5, 19.1 ± 0.5, 21.7 ± 0.5, 34.8 ± 0.2 µm. For patterns with varying bridge length, we use standard bridge width W = 6.9 ± 0.6 and lengths L = 6.4 ± 0.3, 9.2 ± 0.3, 15.7 ± 0.3, 23.7 ± 0.4, 35.3 ± 0.5, 46.2 ± 0.4, 56.0 ± 0.3 µm. We refer to the rounded values for W and L throughout the text.
Cell culture and microscopy - MDA-MB-231 cells (DSMZ) are cultured in Minimum Essential Medium (MEM, c.c. pro), containing 10% FBS (Gibco) and 2mM LGlutamine (c.c. pro). Cells are grown in a 5% CO2 atmosphere at 37C. For passaging and experiments, cells are washed once with PBS and trypsinised for 3 min. This cell solution is centrifuged at 1000 rcf for 3 min. The cell pellet is re-suspended in MEM and 10,000 cells are added per µdish and left to adhere in the incubator for 4h. The medium is then exchanged to L-15 medium containing L-glutamine (Gibco, supplemented with 10% FCS) and 25 nM Hoechst 33342 (Invitrogen) for staining cell nuclei. Experiments are performed at 37C without CO2. All measurements are performed in time-lapse mode for up to 50 h on an IMIC digital microscope (TILL Photonics) or on a Nikon Eclipse Ti microscope using a 10x objective. The samples are kept in a heated chamber (ibidi GmbH or Okolab) at 37C throughout the measurements. Images (brightfield and DAPI) are acquired every 10 mins.
Nucleus tracking and cell segmentation - The trajectories of the cell nuclei are obtained by applying a band pass filter to the images of the nuclei, binarising, and tracking the binarised images using ImageJ's Analyze Particle plugin [88]. For cell segmentation, bright-field images of cells were segmented using a convolutional neural network with a U-Net architecture [46]. We created a data set of 372 manually segmented images, and used 80% for training and 20% for validation; both data sets were augmented with random rotations, shifts, shears, zooms, and reflections. For training, we used the Adam optimization algorithm [89] with a learning rate of 10-4. No learning rate scheduling was used. After training for 20 epochs, we attain a pixel classification accuracy of > 96% on the validation dataset. Segmented cell images, which take values between 0 and 1, are subsequently binarized via thresholding. For further details, see Supplementary Section S2.
Protrusion tracking - Our image segmentation pipeline provides the 2D shape of the cells S(t) as a function of time. To identify protrusions, we classify the positive contributions to the shape velocities V(t) = S(t + t) - S(t) as protrusive components P(t). To recover a low-dimensional representation of the protrusive dynamics from these areas, we define the x-position of the protrusion xp as the geometric center of the protrusive shape xp(t) = xP(t)dx. For further details, see Supplementary Section S2.
Author Contributions - D.B.B., E.H. and C.P.B. conceived the project; A.F., D.B.B., C.P.B. and J.R. designed experiments; A.F. performed experiments; M.S., J.F.,

D.B.B. and N.A. performed tracking and image segmentation; D.B.B. and M.S. analysed data; D.B.B., M.S. and C.P.B. developed the theory; D.B.B. and C.P.B. wrote the manuscript with input from all authors.
Acknowledgements - We thank Grzegorz Gradziuk, Steven Riedijk, Janni Harju and Schnucki for inspiring discussions, and Andriy Goychuk for advice on the image segmentation. Funded by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) - Project-ID 201269156 - SFB 1032 (Project B12). D.B.B. is supported in part by a DFG fellowship within the Graduate School of Quantitative Biosciences Munich (QBM) and by the Joachim Herz Stiftung.
[1] C. M. Franz, G. E. Jones, and A. J. Ridley, Developmental Cell 2, 153 (2002).
[2] E. Scarpa and R. Mayor, The Journal of cell biology 212, 143 (2016).
[3] A. D. Luster, R. Alon, and U. H. von Andrian, Nature Immunology 6, 1182 (2005).
[4] P. Friedl and K. Wolf, Nature reviews. Cancer 3, 362 (2003).
[5] T. D. Pollard and G. Borisy, Cell 112, 453 (2003). [6] P. T. Caswell and T. Zech, Trends in Cell Biology 28,
823 (2018). [7] K. M. Yamada and B. Geiger, Current opinion in cell
biology 9, 76 (1997). [8] E. Cukierman, Science 294, 1708 (2001). [9] C. M. Denais, R. M. Gilbert, P. Isermann, A. L. Mc-
Gregor, M. Te Lindert, B. Weigelin, P. M. Davidson, P. Friedl, K. Wolf, and J. Lammerding, Science 352, 353 (2016). [10] P. M. Davidson, A. Battistella, T. Dejardin, T. Betz, J. Plastino, B. Cadot, N. Borghi, and C. Sykes, EMBO reports , e49910 (2020). [11] P. M. Davidson and B. Cadot, Trends in Cell Biology 31, 211 (2021). [12] M. H. Gail and C. W. Boone, Biophysical Journal 10, 980 (1970). [13] D. Selmeczi, S. Mosler, P. H. Hagedorn, N. B. Larsen, and H. Flyvbjerg, Biophysical journal 89, 912 (2005). [14] R. J. Petrie and K. M. Yamada, Journal of Cell Science 125, 5917 (2012). [15] C. D. Paul, P. Mistriotis, and K. Konstantopoulos, Nature Reviews Cancer 17, 131 (2017). [16] D. B. Bru¨ckner, A. Fink, C. Schreiber, P. J. F. Ro¨ttgermann, J. O. Ra¨dler, and C. P. Broedersz, Nature Physics 15, 595 (2019). [17] C. D. Paul, W.-C. Hung, D. Wirtz, and K. Konstantopoulos, Annual Review of Biomedical Engineering 18, 159 (2016). [18] G. Mahmud, C. J. Campbell, K. J. Bishop, Y. A. Komarova, O. Chaga, S. Soh, S. Huda, K. KandereGrzybowska, and B. A. Grzybowski, Nature Physics 5, 606 (2009). [19] D. Caballero, R. Voituriez, and D. Riveline, Biophysical Journal 107, 34 (2014). [20] D. Caballero, J. Comelles, M. Piel, R. Voituriez, and D. Riveline, Trends in Cell Biology 25, 815 (2015). [21] S. Lo Vecchio, R. Thiagarajan, D. Caballero, V. Vigon,

12

L. Navoret, R. Voituriez, and D. Riveline, Cell Systems 10, 1 (2020). [22] A. Fink, D. B. Bru¨ckner, C. Schreiber, P. J. Ro¨ttgermann, C. P. Broedersz, and J. O. R¨adler, Biophysical Journal 118, 552 (2020). [23] D. B. Bru¨ckner, A. Fink, J. O. Ra¨dler, and C. P. Broedersz, J. R. Soc. Interface 17, 20190689 (2020). [24] D. B. Bru¨ckner, P. Ronceray, and C. P. Broedersz, Physical Review Letters 125, 58103 (2020). [25] C. Metzner, C. Mark, J. Steinwachs, L. Lautscham, F. Stadler, and B. Fabry, Nature communications 6, 7516 (2015). [26] J. E. Ron, P. Monzo, N. C. Gauthier, R. Voituriez, and N. S. Gov, Physical Review Research 2, 1 (2020). [27] A. Reversat, F. Gaertner, J. Merrin, J. Stopp, S. Tasciyan, J. Aguilera, I. D. Vries, R. Hauschild, M. Hons, M. Piel, A. Callan-jones, R. Voituriez, and M. Sixt, Nature 582, 582 (2020). [28] J. Renkawitz, A. Kopf, J. Stopp, I. de Vries, M. K. Driscoll, J. Merrin, R. Hauschild, E. S. Welf, G. Danuser, R. Fiolka, and M. Sixt, Nature 568, 546 (2019). [29] D. Shao, W. J. Rappel, and H. Levine, Physical Review Letters 105, 2 (2010). [30] D. Shao, H. Levine, and W. J. Rappel, Proceedings of the National Academy of Sciences of the United States of America 109, 6851 (2012). [31] F. Ziebert, S. Swaminathan, and I. S. Aranson, Journal of the Royal Society Interface 9, 1084 (2012). [32] F. Graner and J. A. Glazier, Physical Review Letters 69, 2013 (1992). [33] F. J. Segerer, F. Thu¨roff, A. Piera Alberola, E. Frey, and J. O. Ra¨dler, Physical Review Letters 114, 228102 (2015). [34] F. Thu¨roff, A. Goychuk, M. Reiter, and E. Frey, eLife 8, e46842 (2019). [35] A. Goychuk, D. B. Bru¨ckner, A. W. Holle, J. P. Spatz, C. P. Broedersz, and E. Frey, (2018). [36] P. Romanczuk, M. Ba¨r, W. Ebeling, B. Lindner, and L. Schimansky-Geier, European Physical Journal: Special Topics 202, 1 (2012). [37] K. Kruse, J. F. Joanny, F. Ju¨licher, and J. Prost, Physical Biology 3, 130 (2006). [38] P. Recho, T. Putelat, and L. Truskinovsky, Physical Review E 100, 1 (2019). [39] C. Chan and D. Odde, Science 322, 1687 (2008). [40] A. Elosegui-artola, X. Trepat, and P. Roca-Cusachs, Trends in Cell Biology 28, 356 (2018). [41] P. Maiuri, J. F. Rupprecht, S. Wieser, V. Ruprecht, O. B´enichou, N. Carpi, M. Coppey, S. De Beco, N. Gov, C. P. Heisenberg, C. Lage Crespo, F. Lautenschlaeger, M. Le Berre, A. M. Lennon-Dumenil, M. Raab, H. R. Thiam, M. Piel, M. Sixt, and R. Voituriez, Cell 161, 374 (2015). [42] A. C. Callan-Jones and R. Voituriez, Current Opinion in Cell Biology 38, 12 (2016). [43] P. Sens, Proc. Natl. Acad. Sci. USA 117, 24670 (2020). [44] K. Hennig, I. Wang, P. Moreau, L. Valon, S. DeBeco, M. Coppey, Y. A. Miroshnikova, C. Albiges-Rizo, C. Favard, R. Voituriez, and M. Balland, Science Advances 6, 1 (2020). [45] C. Schreiber, B. Amiri, J. C. Heyn, J. O. Ra¨dler, and M. Falcke, Proceedings of the National Academy of Sciences of the United States of America 118 (2021), 10.1073/pnas.2009959118.

[46] O. Ronneberger, P. Fischer, and T. Brox (Springer International Publishing, Cham, 2015) pp. 234­241.
[47] M. Machacek and G. Danuser, Biophysical Journal 90, 1439 (2006).
[48] M. Crisp, Q. Liu, K. Roux, J. B. Rattner, C. Shanahan, B. Burke, P. D. Stahl, and D. Hodzic, Journal of Cell Biology 172, 41 (2006).
[49] P. M. Davidson and B. Cadot, Trends in Cell Biology (2020), 10.1016/j.tcb.2020.11.009.
[50] T. Y. Tsai, S. R. Collins, C. K. Chan, A. Hadjitheodorou, P. Y. Lam, S. S. Lou, H. W. Yang, J. Jorgensen, F. Ellett, D. Irimia, M. W. Davidson, R. S. Fischer, A. Huttenlocher, T. Meyer, J. E. Ferrell, and J. A. Theriot, Developmental Cell 49, 189 (2019).
[51] P. J. Albert and U. S. Schwarz, Biophysical Journal 106, 2340 (2014).
[52] D. Bi, J. H. Lopez, J. M. Schwarz, and M. L. Manning, Soft Matter 10, 1885 (2014).
[53] D. Bi, J. H. Lopez, J. M. Schwarz, and M. L. Manning, Nature Physics 11, 1074 (2015).
[54] K. Tawada and K. Sekimoto, Journal of Theoretical Biology 150, 193 (1991).
[55] S. Reboux, G. Richardson, and O. E. Jensen, Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences 464, 447 (2008).
[56] D. Lehnert, Journal of Cell Science 117, 41 (2004). [57] N. Q. Balaban, U. S. Schwarz, D. Riveline, P. Goichberg,
G. Tzur, I. Sabanay, D. Mahalu, S. Safran, A. Bershadsky, L. Addadi, and B. Geiger, Nature cell biology 3, 466 (2001). [58] B. Lehle and J. Peinke, Physical Review E 97 (2018), 10.1103/PhysRevE.97.012113. [59] A. Frishman and P. Ronceray, Physical Review X 10, 21009 (2020). [60] M. Soares E Silva, J. Alvarado, J. Nguyen, N. Georgoulia, B. M. Mulder, and G. H. Koenderink, Soft Matter 7, 10631 (2011). [61] F. Bonelli, G. Gonnella, A. Tiribocchi, and D. Marenduzzo, European Physical Journal E 39, 1 (2016). [62] X. Jiang, D. A. Bruzewicz, A. P. Wong, M. Piel, and G. M. Whitesides, Proceedings of the National Academy of Sciences of the United States of America 102, 975 (2005). [63] M. Prager-Khoutorsky, A. Lichtenstein, R. Krishnan, K. Rajendran, A. Mayo, Z. Kam, B. Geiger, and A. D. Bershadsky, Nature Cell Biology 13, 1457 (2011). [64] A. F. Mar´ee, V. A. Grieneisen, and L. Edelstein-Keshet, PLoS Computational Biology 8 (2012), 10.1371/journal.pcbi.1002402. [65] A. Vasilevich, S. Vermeulen, J. D. Boer, A. Carlier, and K. Eroume, PLoS ONE 16, e0248293. (2021). [66] L. Caprini, U. Marini Bettolo Marconi, A. Puglisi, and A. Vulpiani, Journal of Chemical Physics 150 (2019), 10.1063/1.5080537. [67] S. L. Gupton and C. M. Waterman-Storer, Cell 125, 1361 (2006). [68] G. Giannone, R. M. M`ege, and O. Thoumine, Trends in Cell Biology 19, 475 (2009). [69] W. Y. Wang, C. D. Davidson, D. Lin, and B. M. Baker, Nature Communications 10, 1 (2019). [70] P. Monzo, Y. K. Chong, C. Guetta-Terrier, A. Krishnasamy, S. R. Sathe, E. K. F. Yim, W. H. Ng, B. T. Ang, C. Tang, B. Ladoux, N. C. Gauthier, and M. P. Sheetz, Molecular Biology of the Cell 27, 1246 (2016).

13

[71] F. Raynaud, M. E. Ambu¨hl, C. Gabella, A. Bornert, I. F.

Sbalzarini, J. J. Meister, and A. B. Verkhovsky, Nature

Physics 12, 367 (2016).

[72] J. Prost, F. Ju¨licher, and J. F. Joanny, Nature Physics

11, 111 (2015).

[73] F. Ju¨licher, S. W. Grill, and G. Salbreux, Re-

ports on Progress in Physics 81 (2018), 10.1088/1361-

6633/aab6bb.

[74] L. Trichet, J. Le Digabel, R. J. Hawkins, S. R. K. Vedula,

M. Gupta, C. Ribrault, P. Hersen, R. Voituriez, and

B. Ladoux, Proceedings of the National Academy of Sci-

ences of the United States of America 109, 6933 (2012).

[75] M. Gupta, B. R. Sarangi, J. Deschamps, Y. Nemat-

bakhsh, A. Callan-Jones, F. Margadant, R. M. M`ege,

C. T. Lim, R. Voituriez, and B. Ladoux, Nature Com-

munications 6 (2015), 10.1038/ncomms8525.

[76] B. Ladoux, R. M. M`ege, and X. Trepat, Trends in Cell

Biology 26, 420 (2016).

[77] R. G. Hodge and A. J. Ridley, Nature Reviews Molecular

Cell Biology 17, 496 (2016).

[78] H. Warner, B. J. Wilson, and P. T. Caswell, Current

Opinion in Cell Biology 56, 64 (2019).

[79] K. A. Demali and K. Burridge,

(2003),

10.1242/jcs.00605.

[80] S. Saha, T. L. Nagy, and O. D. Weiner, Philosophical

Transactions of the Royal Society B: Biological Sciences

373 (2018), 10.1098/rstb.2017.0145.

[81] C. Schreiber, F. J. Segerer, E. Wagner, A. Roidl, and

J. O. Ra¨dler, Scientific Reports 6, 26858 (2016).

[82] A. E. Patteson, K. Pogoda, F. J. Byfield, K. Mandal,

Z. Ostrowska-Podhorodecka, E. E. Charrier, P. A. Galie,

P. Deptula, R. Bucki, C. A. McCulloch, and P. A. Jan-

mey, Small 15, 1 (2019).

[83] S. I. Fraley, Y. Feng, R. Krishnamurthy, D.-h. Kim,

A. Celedon, G. D. Longmore, D. Wirtz, and S. Louis,

Nat. Cell Biol. 12, 598 (2010).

[84] M. Abercrombie and J. E. Heaysman, Experimental Cell

Research 5, 111 (1953).

[85] C. Carmona-Fontaine, H. K. Matthews, S. Kuriyama,

M. Moreno, G. A. Dunn, M. Parsons, C. D. Stern, and

R. Mayor, Nature 456, 957 (2008).

[86] D. B. Bru¨ckner, N. Arlt, A. Fink, P. Ronceray, J. O.

Ra¨dler, and C. P. Broedersz, Proc. Natl. Acad. Sci. USA

118, e2016602118 (2020).

[87] R. Alert and X. Trepat, Annual Review of Condensed

Matter Physics 11, 77 (2020).

[88] C. A. Schneider, W. S. Rasband, and K. W. Eliceiri,

Nature Methods 9, 671 (2012).

[89] D. P. Kingma and J. L. Ba, in 3rd International Con-

ference on Learning Representations, ICLR 2015 - Con-

ference Track Proceedings (International Conference on

Learning Representations, ICLR, 2015).

Supplementary Material:
Geometry adaptation of protrusion and polarity dynamics in confined cell migration

David B. Bru¨ ckner, Matthew Schmitt, Alexandra Fink, Johannes Flommersfeld, Nicolas Arlt, Edouard Hannezo, Joachim O. Ra¨dler and Chase P. Broedersz

Contents

1 Movie descriptions

2

2 Image analysis

2

2.1 Cell segmentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2

2.2 Protrusion tracking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4

3 Model implementation and supplementary results

7

3.1 Overview of model strategy . . . . . . . . . . . . . . . . . . . . . . . . . . 7

3.2 Nucleus dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8

3.3 Non-linear nucleus-protrusion couplings . . . . . . . . . . . . . . . . . . 10

3.4 Inferred white noise model does not capture experimental dynamics . . 11

3.5 Protrusion and polarity dynamics . . . . . . . . . . . . . . . . . . . . . . . 12

3.5.1 White noise polarity . . . . . . . . . . . . . . . . . . . . . . . . . . 13

3.5.2 Persistent polarity . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

3.5.3 Geometry adaptation model . . . . . . . . . . . . . . . . . . . . . 14

3.5.4 Amplitude-adapting persistent polarity . . . . . . . . . . . . . . . 18

3.5.5 Extension adaptation polarity . . . . . . . . . . . . . . . . . . . . . 19

4 Connecting the mechanistic model to emergent stochastic nonlinear dynamics 23

1

1 Movie descriptions
Supplementary Movie S1 Single MDA-MB-231 cell migrating in a two-state micropattern with constriction length L = 35 µm and width W = 7 µm. The cell nucleus is fluorescently labelled to allow automated tracking of nucleus positions. Scale bar: 25 µm. Supplementary Movie S2 Cell shape segmentation of the brightfield microscopy images from Supplementary Movie S1, with the detected cell boundary marked in yellow. Scale bar: 25 µm. Supplementary Movie S3 Protrusion analysis of the cell shown in Supplementary Movies S1,2. Protrusive areas are marked in green. The blue dot corresponds to the x-position of the nucleus, and the green dot to the x-position of the center of protrusive area. Scale bar: 25 µm. Supplementary Movie S4 Single MDA-MB-231 cell migrating in a two-state micropattern with constriction length L = 35 µm and width W = 3 µm. The cell nucleus is fluorescently labelled to allow automated tracking of nucleus positions. Scale bar: 25 µm. Supplementary Movie S5 Single MDA-MB-231 cell migrating in a two-state micropattern with constriction length L = 35 µm and width W = 12 µm. The cell nucleus is fluorescently labelled to allow automated tracking of nucleus positions. Scale bar: 25 µm. Supplementary Movie S6 Single MDA-MB-231 cell migrating in a two-state micropattern with constriction length L = 35 µm and width W = 22 µm. The cell nucleus is fluorescently labelled to allow automated tracking of nucleus positions. Scale bar: 25 µm. Supplementary Movie S7 Single MDA-MB-231 cell migrating in a two-state micropattern with constriction length L = 35 µm and width W = 35 µm. The cell nucleus is fluorescently labelled to allow automated tracking of nucleus positions. Scale bar: 25 µm.
2 Image analysis
2.1 Cell segmentation
In the bright-field images obtained from experiment, attempts to isolate the cell from its background are easily confounded by the nontrivial structure of the micropatterned substrate. Additionally, the cell boundary is often difficult to pinpoint by eye. For these
2

reasons, we found that attempts to segment the cell images using traditional methods of image binarization failed and thus turned to more advanced machine learning techniques.
To segment our images, we utilized convolutional neural networks, which allow for high pixel classification accuracy by accounting for local properties of the image. In particular we use a U-Net architecture, which has been found to be very successful in image segmentation tasks in biology [1]. In principle, the network combines an encoder/decoder structure with skip connections across the latent layers. The encoder/decoder structure allows for efficient recognition of large-scale features in the image, while the skip connections effectively propagate local, low-level information forward in the network. The encoder and decoder branches of our network are three layers deep, with 64 channels in the first layer which are doubled after every max pool layer, similar to previous implementations [1].

a

b

Figure S1: Accuracy and loss curves of the training process for videos with (a) high and (b) low contrast. The network for high contrast videos was trained with constant  = 1, while the network for low contrast videos was trained with varying .

For training, the network is fed augmented data which has undergone random rotations, shifts, shears, zooms, and reflections. We use 80% of the original labeled data set of (N = 372) images for training, and withhold 20% for validation. Each epoch then consists of 2000 steps of batch size 16, and training is stopped after 20 epochs to prevent overfitting. Gradient updates are performed using the Adam optimizer [2] with a constant learning rate of 10-4. We used the binary cross-entropy as a loss function to optimize the pixel classification accuracy. For videos with low contrast between the cells and the background, resulting from the use of a different microscope, we adjusted the loss function throughout the training to increase the focus on the cell edges, which improved the segmentation quality, which has been found to have a similar effect in previous work [3]. Specifically, we use the total loss function

L = LBCE + (1 - )LBCE, edge.

(S1)

Here, LBCE is the binary cross entropy loss for the entire image, and LBCE, edge is the binary cross entropy only applied to pixels near the edge of the cell. The factor  is

3

deterministically reduced in each epoch to force the network to specialize and focus on the cell boundary in the later phase of the training, which makes up a comparatively small number of pixels compared to the cell as a whole. The parameter  is initialized to 1 and then gradually reduced by 0.05 with each epoch, which we found improved training compared to a fixed alpha.
Figure S2: Exemplary brightfield time-series, with segmented cell shapes shown in pink. Each image is a frame from a video which is sampled every t = 10 min; time flows from the left to the right, and each row is the continuation of the row above it. Bright-field images are inverted for better visibility. Scale bar: 25 µm.
Training according to the above protocol results in a pixel classification accuracy of 96.5% for videos with high contrast and 96.1% for videos with low contrast on the validation dataset. We note an apparent slight overfitting, with predictions on the training set achieving a slightly higher accuracy of 96.6% for both high and low contrast videos (Fig. S1). Finally, the predicted segmentations are converted to binary images by applying a threshold. Consequently, pixels with predicted values above 0.12 are mapped to 1, else to 0. This pipeline yields an accurate segmentation of the cell shape for the vast majority of frames (Fig. S2).
2.2 Protrusion tracking
To quantify the joint dynamics of nucleus and protrusion motion, we seek a minimal, low-dimensional representation of the cell protrusions. Our image segmentation pipeline gives access to the 2D shape of the cells S (t) as a function of time. To identify protrusions, we classify the positive contributions to the shape velocities V (t) = S (t + t) - S (t) as the shape of the protrusion P (t) (green areas in Fig. S3). As a low-dimensional representation of the protrusive dynamics, we define an effective position of the protrusion xp as the geometric center of the protrusive shape xp(t) =
xP (t)dx (green dot in Fig. S3). The two-state micropattern is designed in such a way that most of the behavior occurs in the x-direction along the long axis of the micropat-
4

a

b

Figure S3: Dynamics of protrusive areas in two frame sequences. The solid pink line shows the current boundary of the cell area S (t), and the dashed line is the boundary of S (t + t). The protrusive shape (green) is the area which is added between these two frames, P (t). The geometric center of the protrusive area xp is shown as a green dot. Scale bars: 25 µm.

a

xp(µm) yp(µm)
xp (µm)

b 60

c

20
60

10°2

0

00

10°3

°60

°60

0

60

xn(µm)

°20°60°60 °20

0
xn0(µm)

yn(µm)

10°4 60
20

Figure S4: 2D motion of nucleus and protrusions. a. Several examples of 2D trajectories. Left: xy-trajectories plotted on top of the micropattern dimension (shown in grey). Axis limits are -50 µm < x < 50 µm and -20 µm < y < 20 µm; (x = 0, y = 0) corresponds to the center of the constriction. Middle: x-trajectories as a function of time t. Axis limits are -50 µm < x < 50 µm and 0 < t < 30 h. Right: y-trajectories as a function of time t. Axis limits are -50 µm < y < 50 µm and 0 < t < 30 h, to allow direct comparison with the x-trajectories. Blue: nucleus, green: protrusion. b. Joint probability distribution p(xn, xp) of the x-positions, plotted logarithmically. Here shown without the Gaussian interpolation employed in Fig. 2 in the main text. c. Joint probability distribution p(yn, yp) of the ypositions, plotted logarithmically. Note the smaller axis range compared to panel b.
tern. Indeed, we find that, similar to the nucleus dynamics [4], most of the protrusive behaviour is captured by the x-component of xp (Fig. S4): the variance in y-motion is small (Fig. S4a), and the joint probability distribution p(yn, yp) is peaked around (0, 0) and exhibits no special structure, unlike the probability distribution for x-components p(xn, xp) (Fig. S4b,c). In the following, we will therefore take the x-component xp as a minimal representation of the protrusive dynamics in this system.
We find that this definition captures the characteristic features of the protrusive dynamics during the cell-hopping process: as the protrusion grows into the constriction, the effective protrusion position also moves into the channel (Fig. S5 and Fig. 2d in the main text). Thus, xp typically precedes xn in the constriction, as expected from the experimental observations (Supplementary Movies S1-3, Fig. 2d in the main text). Furthermore, we find that when protrusions form randomly and uniformly around the cell boundary, xp is located near the cell centroid (Fig. S3).
In addition to the protrusive dynamics, the cell also performs retractions, corresponding to the negative components of the shape velocities, R(t) (Fig. S6a). Using a similar
5

Figure S5: Time series of xp dynamics overlaid on images of cells with protrusions. Each image is a frame from a video which is sampled every 10 minutes; time flows from the left to the right, and each row is the continuation of the row above it. Time series curve is an interpolation of the circular points to serve as a guide for the eye. Scale bar: 25 µm.
analysis of the retractive dynamics by defining the effective position of the retractions, xr(t) = xR(t)dx, we find however that the retractions are well correlated with the position of the nucleus, which typically resides at the rear end of the cell (Fig. S6b). Specifically, the cross-correlation of nucleus and retraction positions exhibits almost no time-lag, in contrast to the correlation between nucleus and protrusion (Fig. S6c). Furthermore, the cross-correlation between nucleus and retractions is similar in magnitude and shape to the nucleus position auto-correlation, indicating that the retraction trajectories do not contain significant additional information to the nucleus trajectories. Furthermore, the joint probability distribution of nucleus and retraction positions has maximal probability around the diagonal, with little additional structure, in contrast to the distribution of nucleus and protrusion positions (Fig. S6d,e). Therefore, to achieve a minimal, low-dimensional description for the coupled dynamics of shape and nucleus motion, we restrict our analysis to the protrusions.
6

a

xr (µm) hxn(t)xn,p,r(t + T )i(µm2)

b 60
0

c

900

xn

xr

xp

x (µm)

°60 0

d

60

35 t (h)

10°2

e 60

0

°5

0

5

T (h)

10°2

xp (µm)

0

10°3

0

10°3

°60 °60

0 xn (µm)

10°4 60

°60 °60

0 xn (µm)

10°4 60

Figure S6: Dynamics of cell retractions. a. Exemplary brightfield microscopy image series with protrusive shape velocity components P (t) indicated in green, and retraction components R(t) in red. b. Trajectories of the protrusion xp(t) = xP (t)dx (green), retraction xr(t) = xR(t)dx (red), and the cell nucleus xn(t) (blue). c. Position crosscorrelations between nucleus and protrusion xn(t)xp(t + T) (green), between nucleus and retraction xn(t)xr(t + T) (red), and nucleus position auto-correlation, xn(t)xn(t + T) (blue). d. Joint probability distribution p(xn, xp) of the xpositions of nucleus and protrusion, plotted logarithmically. Here shown without the Gaussian interpolation employed in Fig. 2 in the main text. Dashed line indicates the diagonal; dotted lines indicate the boundaries of the adhesive islands. e. Joint probability distribution p(xn, xr) of the x-positions of nucleus and retraction, plotted logarithmically.

3 Model implementation and supplementary results

3.1 Overview of model strategy
To develop a mechanistic model for the joint dynamics of nucleus and protrusion, we systematically constrain the model defined by Eq. (1) and (2) in the main text. By employing a data-driven approach based on the conditional averages of the nucleus and protrusion velocities (NVM and PVM respectively), we can independently determine the dynamics of the nucleus and the protrusion. For each of these two components, we systematically increase model complexity step by step until we reach a model that captures the data (Table S1).
In the following sections, we specify implementation and parameters of each model, and present additional results on the validity of each model approach.

7

model works

model fails

model

xn-xp coupling

equation

reference/comment

Nucleus

conservative force
 (double-well potential)

first order third order

dissipative component
 first order

(spatially variable

friction)

third order

nx·n = k(xp - xn) - xnW(xn)

main text Fig. 3; 
 SI Fig. S7

nx·n = k(1)(xp - xn) + k(2)(xp - xn)3 - xnW(xn) SI Fig. S8

n(xn)x·n = k(xp - xn)

main text Fig. 3

n(xn)x·n = k(1)(xp - xn) + k(2)(xp - xn)3

no significant improvement over first order model (SI Fig. S8)

model

xp-xn coupling

equation

reference/comment

white noise

first order

px·p = - k(xp - xn) - xpV(xp) + (t)

main text Fig. 5;
 SI Section S3.5.1

white noise with state- general inferred dependent amplitude form

persistent polarity Protrusion

&
 Polarity amplitude-adapting
persistent polarity

first order first order

extension adaptation model

first order

geometry adaptation model

first order

numerical form

SI Section S3.4

px·p P·

= =

- -

k(xp 0P

- +

xn) - (t)

xpV(xp)

+

P(t)

main text Fig. 5;
 SI Section S3.5.2

px·p P·

= =

- -

k(xp 0P

- +

xn) - (t)

xpV(xp)

+

(xp)P(t)

SI Section S3.5.4

px·p P·

= =

- -

k(xp - xn) - xpV(xp) + P(t) ( | x | )P - P3 + (t)

SI Section S3.5.5

px·p P·

= =

- -

k(xp - xn) - xpV(xp) + (xp)P - P3 + (t)

P(t)

main text Fig. 6,7;
 SI Section S3.5.3

Table S1: Overview of model candidates.

3.2 Nucleus dynamics

For the nucleus dynamics, we postulate an equation of motion including a spatially variable adhesiveness:

xn = kn(xp - xn)/(xn)

(S2)

where kn = k/n and the dimensionless adhesiveness profile

(xn)

=

1

- min 2

1 - cos

xn Lsystem

+ min

(S3)

Here, (xn) varies between min at xn = 0 and 1 on the islands. The magnitude of the adhesiveness is accounted for the by the parameter n. Throughout the paper, we use dimensionful parameters, such that the simulation results can be directly compared to the experimental statistics on the same axes. However, we reduce the number of parameters by constructing parameter combinations such as kn = k/n. For all length-scale parameters, we directly use the known dimension of the experimental confinement, i.e.

8

Lsystem = a + L/2 = 52.5 µm, where a  37 µm is the side length of the adhesive islands, L the bridge length; for systems with confinement length L  35 µm. Thus, Eqn. (S2) has only two free parameters: kn and min. We determine these parameters by fitting Eqn. (S2) to the experimentally observed NVM (Fig. S7a). In Fig. 3 of the main text, we show the result for our standard constriction width W = 7 µm. To constrain the parameters used for all constriction widths throughout, we first fit the thinnest constriction width W = 4 µm, and obtain kn  0.6 h-1, min  0.2 (Fig. S7). Interestingly, the fitted value is close to that expected based on purely geometrical arguments: assuming the local friction is proportional to the width of the pattern at that point, we would expect min  W/a  0.1. The larger actual value could be due to the spatially extended shape of the cell, leading to additional contributions to the adhesive area that are not only determined by the local width of the pattern.
With this model, we find good agreement for all aspects of the NVM (see Fig. S7 for additional cuts through the map not shown in the main text). To make predictions for varying bridge width (Fig. 4 in the main text), we fix kn, and linearly interpolate min between 0.2 and 1 according to bridge width, to achieve a flat adhesiveness profile for systems without constrictions (see plots in Fig. 4a in the main text).
For the energy potential contribution, we take W(xn) = Q(1 - (xn/x0)2)2 with x0 = (L + a)/2 = 35 µm, such that the potential minimum is located in the center of the adhesive island. Using best fit parameters for kn and Q, we find that this approach robustly fails to capture the NVM for various constriction widths (Fig. S7). The fit also fails if x0 is taken as an additional free fit parameter.

adhesion model xp

a

experiment

50

b
100

h xn|xn, xpi (µm h°1)

0

0

°50

°50

0

xn

°100

50

°50

0

xn

experiment
50 100

h xn|xn, xpi (µm h°1)

0

0

°50

°50

0

xn

°100

50

°50

0

xn

c

h xn|xn, xpi (µm h°1)

100

0

°100

50

°50

0

xp

h xn|xn, xpi (µm h°1)

100

0

°100

50

°50

0

xp

d
50

model

xp

0

°50

50

°50

0

50

xn

model
50

xp

0

°50

50

°50

0

50

xn

deformation model xp

Figure S7: Parameter estimation by fitting to the NVM. a. Experimental NVM for bridge width W = 3 µm. b. Cuts of the NVM along the horizontal lines indicated in panel a, i.e. xp as a function of xn for different xp.. Dots: Experiment, Line: Fitted model. c. Cuts of the NVM along the vertical lines indicated in panel d, i.e. xp as a function of xp for different xn. Dots: Experiment, Line: Fitted model. d. Fitted NVM. Top row: adhesion landscape model. Bottom row: energy potential.

9

3.3 Non-linear nucleus-protrusion couplings

To test if a possible nonlinearity in the nucleus-protrusion coupling could provide better predictions with the double-well potential, we consider the next order coupling term allowed by symmetry in the potential model:

xn = k(n1)(xp - xn) + k(n2)(xp - xn)3 - xnW(xn)

(S4)

Fitting this model to the experimental NVM, we find that it does provide a slightly improved fit to the nucleus velocities as a function of xn compared to the linear deformation presented in the main text (Fig. S8b). Specifically, unlike the energy potential combined with a linear coupling, the non-linear coupling (Eq. (S4)) leads to an acceleration of the nucleus for large xp. This is because the best fit parameters for the coupling yield a negative spring constant k(n2) < 0 for the third order term, indicating that for large extensions, the spring is no longer contractile, but pushes the nucleus away from the protrusion. However, for smaller xp values, this fit still performs a significantly worse than the first-order coupling adhesion model (Eqn. (S2)), which has fewer fitting parameters. Furthermore, this model is unable to capture the profiles of the nucleus velocities as a function of xp (Fig. S8c), unlike adhesion model with the first-order coupling (Fig. S7 c).

adhesion model xp

a

experiment

50

b
100

h xn|xn, xpi (µm h°1)

0

0

°50

°50

0

xn

°100

50

°50

0

xn

experiment
50 100

h xn|xn, xpi (µm h°1)

0

0

°50

°50

0

xn

°100

50

°50

0

xn

c

h xn|xn, xpi (µm h°1)

100

0

°100

50

°50

0

xp

h xn|xn, xpi (µm h°1)

100

0

°100

50

°50

0

xp

d
50

model

xp

0

°50

50

°50

0

50

xn

model
50

xp

0

°50

50

°50

0

50

xn

deformation model xp

Figure S8: Parameter estimation by fitting to the NVM for non-linear nucleus-protrusion coupling models. a. Experimental NVM for bridge width W = 3 µm. b. Cuts of the NVM along the horizontal lines indicated in panel a, i.e. xp as a function of xn for different xp.. Dots: Experiment, Line: Fitted non-linear coupling model. c. Cuts of the NVM along the vertical lines indicated in panel d, i.e. xp as a function of xp for different xn. Dots: Experiment, Line: Fitted non-linear coupling model. d. Fitted NVM. Top row: adhesion landscape model. Bottom row: energy potential.

Fig. S8 also demonstrates that adding the third-order coupling term to the adhesion landscape model does not yield a significant improvement of the fit. This model is defined by the equation

xn = k(n1)(xp - xn) + k(n2)(xp - xn)3 /(xn)

(S5)

10

Fitting this model, we infer coupling constants |k(n2)|/|k(n1)|  10-6, indicating that the third order term is negligible compared to the first order term. Thus, we conclude that the first-order coupling adhesion model (Eqn. (S2)) is the simplest mechanistic model for the nucleus dynamics that captures our data accurately.

3.4 Inferred white noise model does not capture experimental dynamics

In this section, we show that a model with a general protrusion term and a white noise polarity dynamics is unable to capture the experimental dynamics. Specifically, we consider a model of the form

xn = fn(xn, xp) + n(xn, xp)(t)

(S6)

xp = fp(xn, xp) + p(xn, xp)(t)

(S7)

Here, we assume that (t) is a white noise with (t) = 0 and (t)(t ) = (t - t ). Under this assumption, we can infer the terms fn,p and n,p directly from the observed data [5, 6]. Specifically, we use the estimators fn(xn, xp)  xn|xn, xp and n2(xn, xp)  t [xn - fn(xn, xp)]2|xn, xp and similarly for the protrusion terms. These inferred terms provide the best fit estimates for a general model inferred under the white noise assumption. In this case, the inferred functions fn and fp are given by the NVM and the PVM by definition (Fig. S9a,b).

a 50

150 c 50

40 e 50

1

xp (µm)

xp (µm)

xp (µm)

0

0

0

0

°50 °50
b 50

0 xn (µm)

°150 50

°50 °50

150 d 50

0 xn (µm)

0 50
40

°50 °50
f 50

0 xn (µm)

0 50
1

xp (µm)

xp (µm)

xp (µm)

0

0

0

0

°50 °50

0 xn (µm)

°150 50

°50 °50

0 xn (µm)

0 50

°50 °50

0 xn (µm)

0 50

Figure S9: Inferred model terms based on white noise assumption. a. Inferred deterministic nucleus term fn(xn, xp) 

xp|xn, xp in units of µm h-1. b. Inferred deterministic protrusion term. c. Inferred multiplicative noise term on the

nucleus n(xn, xp)  (t [xn - fn(xn, xp)]2|xn, xp )1/2 in units of µm h-1/2. d. Inferred multiplicative noise term on

the protrusion. an increment in

e. a

Relative time-step

magnitude of t, given by

|tfhne( xdne, txepr)m|inistt/icna(nxdn

stochastic contributions to the , xp). f. Relative magnitude of

nucleus velocities, for the deterministic and

stochastic contributions to the protrusion velocities.

Interestingly, we find that the noise on the protrusion significantly exceeds that on the nucleus (Fig. S9c,d). Specifically, the average estimated noise magnitudes are ^n 

11

8.4 µm h-1/2 and ^p  33 µm h-1/2. Accordingly, we find that the nucleus dynamics is dominated by its deterministic component, with deterministic contributions exceeding stochastic fluctuations everywhere in phase space except where nucleus and protrusion are very close together (Fig. S9e). In contrast, the protrusion dynamics are dominated by the stochastic fluctuations (Fig. S9f). In the mechanistic model introduced in the main text, we assume that the source of stochasticity in the system acts on the protrusion, which is further supported by these observations.
Using the inferred terms fn,p and n,p, we perform simulations to assess the validity of the model postulated by Eqs. (S6), (S7). However, we find that this model yields predictions that are inconsistent with our experimental observations. The model does not recover the ring-structure in the probability distribution p(xn, xp) (Fig. S10a,b). Furthermore, it fails to predicts the peak in the dwell time distribution (Fig. S10e). Taken together, these results indicate that the model postulated in Eqs. (S6), (S7) does not provide a good representation of the experimental dynamics, ruling out the white noise protrusion model for all fn,p.

p(ø ) (a.u.)

vn (µm) h°1)

a 50

10°2 c 150

e

Experiment

Experiment

0

10°3

0

Experiment Model

xp (µm)

°50 °50
b 50
Model

0 xn (µm)

0

10°4 50

°150 °50

10°2 d 150
Model

0 xn (µm)

10°3

0

50

0

f 200

0

10 ø

F (0, vn) (µm h°2)

vn (µm) h°1)

xp (µm)

°50 °50

0 xn (µm)

10°4 50

°150 °50

0 xn (µm)

°200

50

°150

0

150

vn (µm h°1)

Figure S10: Predictions of the inferred white noise model. a. Experimental distribution p(xn, xp). b. Model prediction for p(xn, xp). c. xnvn phase-space portrait inferred from experiments. d. Phase-space portrait predicted by model. e. Experimental (blue) and predicted (red) dwell time distribution. f. Experimental (blue) and predicted (red) effective friction relation F(xn  0, vn).

3.5 Protrusion and polarity dynamics

For the protrusion dynamics, we use the equation of motion

xp = -kp(xp - xn) - xpV(xp) + P(t)

(S8)

where kp = k/p and p is absorbed into the boundary potential and our definition of the polarity P. We use soft-wall boundary conditions at the system boundaries, using

12

the potential V(xp) = (xp/xboundary)2n. We find that within a reasonable range, the boundary potential parameters do not strongly affect the results, and take n = 4 and xboundary = 0.4  Lsystem throughout. Similarly, we find that the choice of kp does not strongly affect the results. Physically, we expect the friction on the nucleus to be larger than on the protrusion, i.e. p < n, and thus kp > kn. We therefore take kp = 1.2 h-1, which we also find to accurately capture the PVM inferred from systems without constrictions, which is dominated by the elastic coupling.
Unlike for the nucleus and protrusion dynamics, for the polarity, we do not have access to experimental trajectories to constrain our choice of parameters. We therefore perform parameter sweeps over the parameters of the polarity dynamics. Generally, we find that the model behaviour varies smoothly and as physically expected with the parameters, and none of our conclusions depend on fine tuning parameters.

3.5.1 White noise polarity
For the white noise polarity, P = (t), there is only a single free parameter, the noise strength . As expected, the probability distributions broaden with increasing noise; however they robustly fail to capture the ring structure in p(xn, xp), the peak in the dwell time-distribution, and the flow field F(xn, vn).

3.5.2 Persistent polarity

The persistent polarity (with 0 > 0)

P = -0P + (t)

(S9)

has two parameters: the noise strength  and the persistence time 0-1. We find that this model does not capture the experimentally observed features irrespective of our choice of  and 0-1 (Fig. S11). In Fig. 5 of the main text, we use  = 100 and 0 = 1.

13

a noise amplitude
æ = 50 æ = 100 æ = 150 æ = 200 æ = 250

b noise amplitude
æ = 50 æ = 100 æ = 150 æ = 200 æ = 250

c noise amplitude
æ = 50 æ = 100 æ = 150 æ = 200 æ = 250

Æ0 = 0.33 Æ0 = 1 Æ0 = 2 Æ0 = 5 Æ0 = 10

Æ0 = 0.33 Æ0 = 1 Æ0 = 2 Æ0 = 5 Æ0 = 10

persistence time 0-1 Æ0 = 2 Æ0 = 5 Æ0 = 10

Æ0 = 0.33 Æ0 = 1

Theory

Experiment

Theory

Experiment

Figure S11: Predictions of the persistent polarity with varying noise amplitude and persistence times. Here, we use min = 0.23 and compare to the experimental data for bridge width W = 7 µm. a. Predicted distributions p(xn, xp), plotted logarithmically with the same colour axis as in Fig. 2 in the main text. b. Experimental (blue) and predicted (red) dwell time distribution. c. Experimental (blue) and predicted (red) effective friction relation F(xn  0, vn). Axis limits are the same as shown in the main text for all panels.

3.5.3 Geometry adaptation model

For the geometry adaptation model introduced in the main text, we vary the feedback on the polarity as a function of the protrusion position:

P = -(xp)P - P3 + (t)

(S10)

Here, we use a similar spatial profile as for the adhesiveness of the nuclear dynamics, with a minimal value min at xp = 0 and a maximal value 0 on the adhesive islands:

(xp)

=

0

- min 2

-

0

- min 2

cos

xp Lsystem

(S11)

Thus, this model has 4 parameters: {0, min, , }. Importantly, for positions where (xp) < 0 locally, the preferred polarity is P0 = ± ||/. Thus, we take values for  which give a reasonable order of magnitude of the preferred polarity compared to the typical order of magnitude of the protrusion velocities. Specifically, we take  = 0.0001 throughout. On the islands, we postulate that protrusions move with low persistence, and therefore take 0 = 10. This choice yields accurate results for the PVM in systems with no constriction, where we take min = 0, corresponding to a flat profile. Taking much smaller values of 0 leads to a pushing effect in the PVM for the system with no constriction, which is not observed experimentally. For min, we broadly find the behaviour shown in Fig. 6 of the main text: ring structures for min < 0, but not for min > 0. Similarly, we find that we require a negative min to capture the effective antifriction in the nucleus dynamics (see Supplementary section 4 for a parameter sweep). We find that min = -6.5 yields accurate predictions for the thinnest constriction, and systematically increase min for wider bridges, up to min = 0 for the system without constriction. Finally, the model predictions do not sensitively depend on the choice of the noise amplitude; we take  = 100 throughout.

14

In Fig. S12, the same data as in main text Fig. 7 is shown, but with additional modelexperiment comparisons. Here, we show all seven bridge widths observed experimentally (with additional widths W = 9, 18 µm). Heatmaps are plotted without the interpolation implemented in the main text, and the nucleus velocity auto-correlation is shown as an additional comparison.
15

Figure S12: Dynamics for all constriction widths. a. Brightfield microscopy images of MDA-MB-231 cells migrating in two-state micropatterns with increasing bridge width W with cell outline in pink, nucleus position in blue, and geometry in white. b. Stochastic trajectory xn(t) (blue), xp(t) (green), and P(t) (pink) predicted by the geometry adaptation model (Eq. (S15)) with increasing min, but constant polarity dynamics, as a model for increasing bridge width (Supplementary Section S4). c. Joint probability distributions p(xn, xp). d. Joint probability distributions p(xn, vn). e. Protrusion velocity maps (PVM) xp|xn, xp . f. Flow field (xn, vn) = (vn, F(xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. g. Predicted (red) and experimental (blue) nucleus velocity auto-correlation function vn(t)vn(t ) , plotted as a function of |t - t |. h. Predicted (red) and experimental (blue) dwell time distributions p(). i. Predicted (red) and experimental (blue) effective friction at the bridge center F(xn  0, vn) In panels c-f, the top row corresponds to the geometry adaptation model prediction, the bottom row to experimental observations.
To further test the geometry adaptation model, we also vary the length L of the constriction (Fig. S13a). To implement this change in the model, we vary the total length of the system, Lsys = 2a + L, where a is the side length of the square islands (see Supplementary Section S4 for exact implementation). We find that the model captures the main qualitative changes observed in the experiment. Interestingly, we find that the `polarity driving' becomes more strongly pronounced in the longest constrictions, which provides additional evidence for this effect.
16

Figure S13: Model predicts dynamics with varying constriction length. a. Brightfield microscopy images of MDAMB-231 cells migrating in two-state micropatterns with increasing bridge length L with cell outline in pink, nucleus position in blue, and geometry in white. b. Stochastic trajectory xn(t) (blue), xp(t) (green), and P(t) (pink) predicted by the geometry adaptation model (Eq. (S15)) with increasing Lsys as a model for increasing bridge length (Supplementary Section S4). c. Joint probability distributions p(xn, xp). d. Joint probability distributions p(xn, vn). e. Protrusion velocity maps (PVM) xp|xn, xp . f. Flow field (xn, vn) = (vn, F(xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. g. Predicted (red) and experimental (blue) nucleus velocity auto-correlation function vn(t)vn(t ) , plotted as a function of |t - t |. h. Predicted (red) and experimental (blue) dwell time distributions p(). i. Predicted (red) and experimental (blue) effective friction at the bridge center F(xn  0, vn) In panels c-f, the top row corresponds to the geometry adaptation model prediction, the bottom row to experimental observations.
17

3.5.4 Amplitude-adapting persistent polarity

In the geometry adaptation model, we assume that the feedback on the polarity couples to the external geometry, which therefore makes the time-correlations of the polarity geometry-sensitive. An alternative way to introduce a coupling to the external geometry is to include a spatially variable overall amplitude (xp) in the persistent polarity. Thus, the time-correlations remain unaffected by the geometry, and only the overall amplitude of the driving force of the protrusion changes. Such a model is described by the equations:

xp = -kp(xp - xn) - xpV(xp) + (xp)P(t) P = -0P + (t)

(S12) (S13)

Physically, we expect larger polarities in the constrictions, and therefore employ a generic function (xp) which takes value 1 on the islands and max > 1 in the center of the constriction:

(xp) =

max - 2

1

cos

xp Lsystem

+

max + 1 2

(S14)

Using this implementation, we expect a depletion of probability in the center of the probability distribution p(xn, xp) for large max, making it a promising candidate to capture the key features of the protrusion nucleus cycling. To test the model, we first vary the parameters {0, , max}. Interestingly, as expected, we do find an annular structure in the probability distribution p(xn, xp) for sufficiently large max (Fig. S14a). However, within the parameter range in which this distribution qualitatively matches the experiment, neither the dwell time distribution, nor the effective friction relationship of the nucleus dynamics match the experiment (Fig. S14b, c).

a polarity amplitude factor
max = 1 max = 2 max = 5 max = 10 max = 15

b polarity amplitude factor
max = 1 max = 2 max = 5 max = 10 max = 15

c polarity amplitude factor
max = 1 max = 2 max = 5 max = 10 max = 15

Æ0 = 0.33 Æ0 = 1 Æ0 = 2 Æ0 = 5 Æ0 = 10

Æ0 = 0.33 Æ0 = 1 Æ0 = 2 Æ0 = 5 Æ0 = 10

persistence time 0-1 Æ0 = 2 Æ0 = 5 Æ0 = 10

Æ0 = 0.33 Æ0 = 1

Theory

Experiment

Theory

Experiment

Figure S14: Predictions of the amplitude-adapting persistent polarity model with varying polarity amplitude factor and persistence times. Here, we use min = 0.23 and compare to the experimental data for bridge width W = 7 µm. a. Predicted distributions p(xn, xp), plotted logarithmically with the same colour axis as in Fig. 2 in the main text. b. Experimental (blue) and predicted (red) dwell time distribution. c. Experimental (blue) and predicted (red) effective friction relation F(xn  0, vn). Axis limits are the same as shown in the main text for all panels.

Additionally, we rule out this model by showing that it does not correctly predict the dynamics with changing constriction width. In the geometry adaptation model (section 3.5.3), we chose a low persistence (0 = 10 h-1) which accurately captured the

18

dynamics on all constriction widths. Accordingly, choosing this value for the persistence for the amplitude-adapting persistent polarity, we find that it captures the dynamics for the system without constriction, as in this case, it coincides with the geometry adaptation model (Fig. S15). However, extrapolating to narrower constrictions by simultaneously varying min and max, we find that several key statistics, including the probability distribution p(xn, xp), the dwell time distribution, and the effective friction relation fail to capture the experiment (Fig. S15).
Next, we increase the persistence to a value where our sweep over {0, max} showed good agreement in the probability distribution p(xn, xp) (Fig. S14a). In this case, we find that the model fails to capture various key aspects of the data with changing constriction width, including the disappearance of the active driving in the PVM, the dwell time distributions, the xv-flow field, and the effective friction relationship (Fig. S15). Taken together, these results demonstrate that the amplitude-adapting persistent polarity is not compatible with our experimental observations.

Figure S15: a. Joint probability distributions p(xn, xp). b. Protrusion velocity maps (PVM) xp|xn, xp . c. Flow field (xn, vn) = (vn, F(xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. d. Predicted (red) and experimental (blue) dwell time distributions p(). e. Predicted (red) and experimental (blue) effective friction at the bridge center F(xn  0, vn) In panels a-c, the top row corresponds to the geometry adaptation model prediction, the bottom row to experimental observations. Left panels correspond to simulations with low persistence 0 = 10 h-1, right panels to high persistence 0 = 1 h-1.

3.5.5 Extension adaptation polarity

In this section, we show that an alternative model in which the polarity feedback is sensitive to x = |xp - xn| instead of the absolute position of the protrusion xp is unable to capture our experimental observations. Such a model can be formulated by using polarity dynamics of the form

P = -(x)P - P3 + (t)

(S15)

19

We expect the polarity to become more persistent for stretched states, with a possible switch to positive feedback at large extensions. As a simple implementation of this dependence, we take  to be a linear function of x:

(x) = 0 - 1x

(S16)

A switch to positive feedback therefore occurs at a critical extension xcritical = 0/1. Note that since this model does not couple to geometry, 0 and 1 are assumed to be intrinsic cell parameters, which do not adapt to the environment. Therefore, in this model, the bridge width is implemented only through the adhesiveness profile. Of course, we could in principle also consider extension-dependent feedback which changes for changing bridge widths, e.g. using 1 = 1(xp). This could be implemented such that the critical extension at which positive feedback is activated increases with increasing bridge width - with similar arguments as those used to motivate the geometry adaptation model. However, the geometry adaptation model provides simpler implementation of such a geometry dependence, with fewer parameters. Thus, by contrasting these models, we do not seek to rule out a dependence of the polarity dynamics on the extension of the cell, but investigate whether the geometry-sensitive component to these dynamics dominates over the extension-dependent one.

This model has 4 parameters: {0, 1, , }. We take  = 0.0005,  = 200, and 0 = 10, to be consistent with the geometry adaptation model at small extensions (which we have shown to successfully capture the dynamics), and 1 = 1, such that the critical extension is xcritical = 10 µm. Interestingly, we find that there are large regions in parameter space in which the extension feedback model (Eq. (S15)) captures many of the qualitative features of the experiments with thin constrictions (w = 4, 7 µm) (Fig. S16). Specifically, the model exhibits a ring-structure in p(xn, xp) and p(xn, vn), amplification in the phase space flow with effective anti-friction, a peaked dwell time distribution, and a matching velocity velocity auto-correlation function. Based on the trajectories, we observe that spikes in the polarity precede transitions, indicating that the activation of positive feedback in this model is also correlated with the extension preceding bridge entry of the protrusion. Accordingly, the model predicts an extensile pushing effect in the PVM, although, unlike in the experimental PVM, it is not restricted to positions in the bridge.

Since 0 and 1 do not change with bridge width, even cells in systems without constrictions experience positive feedback when they are in a stretched state x > xcritical. Experimentally, we find that the distribution of cell extensions p(x) does not change significantly with bridge width, suggesting that based on the extension feedback model, we expect similar polarity dynamics, including positive feedback states also on wide bridges (Fig. S17). This already suggests that this model is unlikely to capture the observed dynamics with increasing bridge width.

To explore the predictions of this model for increasing bridge width directly, we focus on those parameter regimes of {0, 1, } in which the dynamics on thin bridges is captured. We find that the predicted dynamics qualitatively fails to capture the experiments with wide bridges (Fig. S16). Specifically, the model predicts a pronounced

20

Figure S16: Extension feedback fails to predict dynamics with varying constriction width. a. Stochastic trajectory xn(t) (blue), xp(t) (green), and P(t) (pink) predicted by the geometry adaptation model (Eq. (S15)) with increasing min and min as a model for increasing bridge width W (Supplementary Section S4). b. Joint probability distributions p(xn, xp). c. Joint probability distributions p(xn, vn). d. Protrusion velocity maps (PVM) xp|xn, xp . e. Flow field (xn, vn) = (vn, F(xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. f. Predicted (red) and experimental (blue) nucleus velocity auto-correlation function vn(t)vn(t ) , plotted as a function of |t - t |. g. Predicted (red) and experimental (blue) dwell time distributions p(). h. Predicted (red) and experimental (blue) effective friction at the bridge center F(xn  0, vn). In panels b-e, the top row corresponds to the geometry adaptation model prediction, the bottom row to experimental observations.
ring-like probability distribution even on the rectangular patterns without a constriction, in contrast to the uniform experimental distribution. The model also predicts a peaked dwell time distribution on the rectangles, in contrast to the decaying distribution observed in the experiment. Furthermore, the presence of positive feedback makes a contribution to the polarity component of the phase space flow (see section 4), and thus leads to significant amplification in systems with wide bridges, in contradiction to
21

p(xp - xn)

W =4 W =7 W =9 W = 12

W = 19 W = 22 W = 35

-60

0

60

xp - xn (µm)

Figure S17: Experimental probability distributions of protrusion-nucleus extension for all bridge widths

the experiments. This finding is robust in a wide range of parameters.
To further pinpoint the shortcomings of the model, we investigate the dependence of the protrusion velocities on the instantaneous protrusion position and protrusionnucleus extension, xp|xp - xn, xp (Fig. S18). As expected, we observe that in the extension feedback model, the protrusion velocities are predominantly determined by the protrusion-nucleus extension xp - xn. This dependence does not change much with varying bridge width. In contrast, the geometry adaptation model predicts a more complex dependence of the protrusion velocity on xp - xn, xp: for narrow bridges, for xp outside of the constriction, the elastic coupling dominates. When xp is inside the bridge, we observe the pushing effect, whose sign depends on xp - xn, as positive polarities, which lead to positive xp drive the system towards xp - xn > 0. As the bridge widens, the pushing contribution disappears. For the rectangular systems without constriction, the elastic coupling dominates, and the protrusion velocities are completely determined by xp - xn. These features are qualitatively similar to those seen in the experiments, further supporting the hypothesis that the geometry adaptation model is a better description of the data than the extension feedback model.

Figure S18: Protrusion velocities as a function of xp and xp - xn for two model candidates. The conditional average xp|xp - xn, xp is shown for the geometry adaptation model (top row), the extension feedback model (Eq. (S15)) (center row), and the experiment (bottom row), for all 7 bridge widths (in increasing order from left to right).
22

4 Connecting the mechanistic model to emergent stochastic nonlinear dynamics

A central challenge for our mechanistic approach is to capture the emergent long timescale stochastic dynamics of the system. In previous work [4], we discovered that the stochastic dynamics of the nucleus trajectories xn(t) of these cells can be described by an equation of motion for the velocity of the cell nucleus vn of the form

vn = F(xn, vn) + (xn, vn)(t)

(S17)

where (t) is Gaussian white noise, with (t) = 0 and (t)(t ) = (t - t ). This is an effective description of the dynamics of the nucleus alone, with unobserved degrees of freedom, such as the protrusion and polarity, integrated out. Thus, in contrast to our mechanistic model (Eqns. 1,2 in the main text), the emergent long time-scale dynamics exhibited by the nucleus trajectories are described by a second-order equation of motion with the velocity vn as an additional degree of freedom.

Here, we provide a direct mapping between the mechanistic and the emergent long

time-scale dynamics of the system. Specifically, we recast Eqns. 1,2 in the main text into

a single differential equation for vn. Then, using the definition F(xn, vn) = vn|xn, vn ,

we find

F(xn, vn) =

fp

 fn xp

+

vn

 fn xn

+

 fn xp

P|xn, vn

(S18)

Fcc ( xn ,vn )

Fpol ( xn ,vn )

Thus, we expect the deterministic dynamics of the nucleus to be determined by two components. A component Fcc(xn, vn) determined by the confinement and coupling dynamics, and a component Fpol(xn, vn) determined by the polarity dynamics.

a

white noise

150150

persistent polarity

positive spatial feedback

b Experiment

c
200

F (0, vn) (µm h°2)

) )

hh°°11

(µm (µm

0

vvnn

°1°50150

°5°0 50

00

505°0 5°050

00

505°0 5°050

00

505°0 5°050

00

50 50

xnx(nµ(mµ)m)

xnx(nµ(mµ)m)

xnx(nµ(mµ)m)

xnx(nµ(mµ)m)

°200

°150

0

150

vn (µm h°1)

Figure S19: Phase-space portraits of the non-linear dynamics of nucleus trajectories. a. Flow field (xn, vn) = (vn, F(xn, vn)) indicated by arrows. Arrow color indicates the direction of the local flow: acceleration is orange and deceleration is blue. From left to right, the predictions for the white noise model, the persistent polarity model, and the geometry adaptation model (with min < 0). Insets: conditional average of the polarity as a function of nucleus position and velocity, P|xn, vn , which determines the polarity component of the phase space flow Fpol(xn, vn) (see Eq. (S18)). b. Flow field inferred from the experiment for bridge width W = 7 µm (see ref. [4]). b. Effective friction at the bridge center F(xn  0, vn) for all three models and the experiment: white noise model (dashed black line), persistent polarity model (grey), geometry adaptation model (red), and experiment (blue).

For white noise polarities, the second term vanishes, as P|xn, vn = 0 (Insets Fig. S19a), and thus the phase space flow is due to the combined effects of nucleus-protrusion coupling and the space-dependent adhesiveness acting on the nucleus. Interestingly, for the white noise model, we find a small region of deterministic amplification where

23

the nucleus enters the constriction - however, the amplification only sets in at high speeds, while there is no amplification for low speeds (Fig. S19a). The amplification in the flow is due to the differential adhesiveness, as it vanishes for a flat adhesiveness profile. In contrast, in the experiments, we found that the excitable amplification regime sets in already at low speeds. Furthermore, the effective friction acting on the nucleus in the white noise model is a simple linear friction, F(xn  0, vn)  -vn, in contrast to the non-linear anti-friction observed experimentally (Fig. S19b).

In contrast, persistent polarities lead to a significant contribution to the determinis- 0 h = 0.01amin = °10.0 h = 0.12amin = °10.0 h = 0.23amin = °10.0 h = 0.34amin = °10.0 h = 0.45amin = °10.0 h = 0.56amin = °10.0 h = 0.67amin = °10.0 h = 0.78amin = °10.0 h = 0.89 amin = °10.0 h = 1.0

8 h = 0.01

tic dynamics, with P|xn, vn exhibiting positive values for positive velocities. Consequently, the polarity component of the dynamics Fpol fundamentally changes the phase space flow, leading to amplification even at small velocities, similar to the experiment

6 h = 0.01

(Fig. S19a). However, while the model predicts a non-linear effective friction relation

3 h = 0.01

F(xn  0, vn), it does not predict a sign-change, corresponding to anti-friction, in any parameter regime we investigated (Fig. S19b; see Supplementary Section 3.5.2).

Finally, for the geometry adaptation model, we find that the polarity component similarly leads to an amplification of velocity, and yields excitable dynamics similar to those 01.0hh==0.00.101amin = °10.0 h = 0.12amin = °10.0 h = 0.23amin = °10.0 h = 0.34amin = °10.0 h = 0.45amin = °10.0 h = 0.56amin = °10.0 h = 0.67amin = °10.0 h = 0.78amin = °10.0 h = 0.89 amin = °10.0 h = 1.0

observed experimentally. However, in contrast to the persistent polarity model, we find

1.7h8 =h =0.001.01

that the geometry adaptation model captures the effective anti-friction at the center of

the constriction. In the parameter regime relevant to the experiments, we find that the

3.5h6 =h =0.001.01 6.3h3 =h =0.001.01

effective anti-friction emerges for min < 0 and min 0.3 (Fig. S20). To model the effects of increasing constriction width, we simultaneously increase min and min (red arrow Fig. S20). We observe that this leads to the disappearance of the effective antifriction, first giving rise to a flat non-linear friction, and finally an almost linear regular

8.1h1 =h =0.001.01

friction (Insets Fig. S20). We observe very similar changes in the effective friction in the experiment (Fig. S12).

011hh==0.00.101

F(xn  0,vn)

F(xn  0,vn)

33 h = 0.01 56 h = 0.01 78 h = 0.01 .0 h = 0.01

vn

vn

10

5

amin = °10.0 h = 0.01amin = °10.0 h = 0.12amin = °10.0 h = 0.23amin = °10.0 h = 0.34amin = °10.0 h = 0.45amin = °10.0 h = 0.56amin = °10.0 h = 0.67amin = °10.0 h = 0.78amin = °10.0 h = 0.89 ami

5

amin = °7.78 h = 0.01 amin = °5.56 h = 0.01 amin = °3.33 h = 0.01

Æmin

dF

0

increasing bridge width

0 dvn
xn0,vn0

°5

°10

°5

0.25 0.50 0.75 1.00

min

F(xn  0,vn)

amin = °1.11 h = 0.01

vn

Figure S20: Emergence of effective anti-friction for positive feedback polarities. We vary the parameters min and min anadmidn e=te1.r1m1 hin=e0.t0h1e effective friction relationship at the center of the constriction F(xn  0, vn). The gradient of the effective friction at vn  0 is indicated by the color. Red arrow corresponds to simultaneously increasing min and min which we do as a model of increasing bridge width. Insets: effective friction relationships at the indicated locations.
amin = 3.33 h = 0.01

amin = 5.56 h = 0.01

24

amin = 7.78 h = 0.01

amin = 10.0 h = 0.01

In summary, we find that the effective non-linear dynamics of the nucleus trajectories put strong constraints on our mechanistic model, and in contrast to the white noise and persistent polarity models, the geometry adaptation model is able to capture the experimentally observed dynamics. Our model furthermore gives insight into the origin of the non-linear dynamics: F(xn, vn) is composed of a confinement-coupling and a polarity component. The effective anti-friction exhibited by the inferred dynamics is reproduced for parameters corresponding to positive polarity feedback, indicating that such a feedback mechanism may be required to explain the emergence of effective anti-friction in the underdamped nuclear dynamics.
References
[1] O. Ronneberger, P. Fischer, and T. Brox, "U-Net: Convolutional Networks for Biomedical Image Segmentation BT - Medical Image Computing and ComputerAssisted Intervention MICCAI 2015," (Cham), pp. 234­241, Springer International Publishing, 2015.
[2] D. P. Kingma and J. L. Ba, "Adam: A method for stochastic optimization," in 3rd International Conference on Learning Representations, ICLR 2015 - Conference Track Proceedings, International Conference on Learning Representations, ICLR, 2015.
[3] H. Kervadec, J. Bouchtiba, C. Desrosiers, E. Granger, J. Dolz, and I. B. Ayed, "Boundary loss for highly unbalanced segmentation," in International conference on medical imaging with deep learning, pp. 285­296, PMLR, 2019.
[4] D. B. Bru¨ ckner, A. Fink, C. Schreiber, P. J. F. Ro¨ ttgermann, J. O. Ra¨dler, and C. P. Broedersz, "Stochastic nonlinear dynamics of confined cell migration in two-state systems," Nature Physics, vol. 15, no. 6, pp. 595­601, 2019.
[5] S. Siegert, R. Friedrich, and J. Peinke, "Analysis of data sets of stochastic systems," Phys. Lett. A, vol. 243, pp. 275­280, mar 1998.
[6] A. Frishman and P. Ronceray, "Learning force fields from stochastic trajectories," Physical Review X, vol. 10, no. 2, p. 21009, 2020.
25

