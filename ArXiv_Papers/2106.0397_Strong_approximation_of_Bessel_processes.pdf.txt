arXiv:2106.00397v1 [math.PR] 1 Jun 2021

Strong approximation of Bessel processes
Madalina Deaconu1 and Samuel Herrmann2
1Universit´e de Lorraine, CNRS, Inria, IECL, F-54000 Nancy, France, Madalina.Deaconu@inria.fr
2Institut de Math´ematiques de Bourgogne (IMB) - UMR 5584, CNRS, Universit´e de Bourgogne Franche-Comt´e, F-21000 Dijon, France Samuel.Herrmann@u-bourgogne.fr
June 2, 2021
Abstract We consider the path approximation of Bessel processes and develop a new and efficient algorithm. This study is based on a recent work by the authors, on the path approximation of the Brownian motion, and on the construction of specific own techniques. It is part of the family of the so-called -strong approximations. More precisely, our approach constructs jointly the sequences of exit times and corresponding exit positions of some well-chosen domains, the construction of these domains being an important step. Based on this procedure, we emphasize an algorithm which is easy to implement. Moreover, we can develop the method for any dimension. We treat separately the integer dimension case and the non integer framework, each situation requiring appropriate techniques. In particular, for both situations, we show the convergence of the scheme and provide the control of the efficiency with respect to the small parameter . We expand the theoretical part by a series of numerical developments.
Key words: Strong approximation, path simulation, Bessel process, Brownian exit time. 2010 AMS subject classifications: primary 65C05; secondary 60J60, 60J25, 60G17, 60G50.
Introduction
Diffusion processes play a central role in the modelling and study of the behaviour of physical phenomena, of biological problems or of financial products pricing, it is thus of prime
This work has been supported by the project PERISTOCH ANR­19­CE40­0023, 2020­2024 of the French National Research Agency (ANR)
1

interest to develop numerical approaches to characterize and analyze their stochastic trajectories. However, a trajectory is an infinite mathematical object which cannot be generated directly, an approximation procedure and its corresponding error control need therefore to be emphasized.
The Euler scheme is one of the classical standard schemes to get numerical approximated solutions of stochastic differential equations. Indeed, a first method to approximate stochastic processes is the common time-discretization procedure: only the values of the diffusion process on some finite deterministic time grid t1 < t2 < . . . < tn are described (or approximated), as in the usual Euler or modified Euler scheme and the literature contains many convergence results in the small time step limit. In the standard case, that is under the conditions that ensure the existence and uniqueness of the solution of the SDEs, the numerical analysis is well-developed and a large variety of different numerical approximation schemes is available. We refer, in this framework of time splitting procedure to the important work [KP92]. A huge literature is studying this approach and we can find results on the weak convergence [BT95] or the strong convergence. It is thus well-known, that under suitable conditions on the coefficients of the SDEs, the Euler scheme has strong rate of convergence 1/2, [KP92]. A very good review on the results on the Euler method and its higher-order extensions can be found in [JKH11], and for particular diffusions interesting techniques are developed for instance in [DNS12], [Gob00], [MGY20], and many others.
Such schemes often suffer in terms of efficiency as the computational time is high and it is difficult to solve the trade-off between reducing the error and obtaining a satisfactory computational time. Thus, in non standard cases, other methods need to be developed.
An alternative approach for one-dimensional diffusions is to squeeze the stochastic trajectory (Xt)t0 under observation inbetween two simple to exhibit paths, depending on a small parameter  > 0: an upper and a lower trajectory (Xt,)t0 respectively (Xt,)t0. Obviously, these two curves need first to be easy to generate numerically (we should avoid infinite mathematical objects) and secondly be such that their difference can be controlled with respect to the parameter : on any finite time interval [0, T ],

Xt,  Xt  Xt,,

t  [0, T ] and

lim
0

sup (Xt,
t[0,T ]

-

Xt,)

=

0

a.s.

There is a challenging dual objective: to point out some upper and lower convergent bounding processes X, and X, on one hand, and to get a precise convergence result on the other hand. One interesting approach is to link the construction of the bounds with the simulation of the diffusion exiting from thin horizontal layers. Such an approach can be seen through to its successful completion using both the precise description of the Brownian paths, in particular Brownian meanders, and the exact simulation method (rejection sampling), see the seminal paper of Chen and Huang [CH13] and subsequent developments concerning killed diffusions [CR08], jump diffusions [GS13] or further techniques linked to the -strong approximation [PJR+16]. These approaches concern mainly classical diffusions or jump diffusions with regular coefficients.
The aim of this paper is to develop a different construction for the -strong approximation of Bessel trajectories. The stochastic differential equation satisfied by the Bessel process

2

Figure 1: Illustration of -strong approximation of diffusion paths based on successive exit times
of small intervals (left) or successive exits of small spheroids (right)

presents a singular drift coefficient. We shall thus emphasize an alternative approach which is not based on exit times of thin horizontal layers but rather on exit times of specific spheroids (see Figure 1). There is a substantial numerical gain to adopt this new point of view since the spheroid exit times are easy to generate and the rejection sampling linked to the exact simulation of a paths skeleton can be avoided. The new algorithm we propose concerns Bessel processes of integer or non integer dimensions and is based on observations of the Brownian trajectories. Let us first introduce the definition of the -strong approximation that we shall consider throughout our study.

Definition 0.1. The random process (yt) is an -strong approximation of the diffusion process (Xt) if there exists (xt ) satisfying

sup |Xt - xt |   a.s.
t[0,T ]

(0.1)

such that (yt) and (xt ) are identically distributed.

In the Brownian framework, such an approximation is available using the exit times of specific spheroids [DH20]. Let us consider the curve directly linked to the shape of the -dimensional heat ball:

e2

e2

,(t) :=

t ln

,

t

for t  I, := [0, r,] with r, =

. 

(0.2)

We can notice that the maximum of the curve is equal to  and is reached for tmax = 2/. The approximation is based on the so-called Brownian skeleton (BS). We recall now the particular situation   1.

Brownian Skeleton (BS)1
1. Let (An)n1 be i.i.d. random variables with gamma distribution Gamma(3/2, 2). 2. Let (Zn)n1 be i.i.d. Rademacher random variables (taking values +1 or -1 with
probability 1/2). The sequences (An)n1 and (Zn)n1 are independent.

3

Definition: Let  > 0. The Brownian skeleton (BS)1 is defined by

(un, sn)n1, (xn)n0

with



n

  

un

=

2 e1-An ,

sn =

uk ,

k=1



 

xn

= xn-1 + Zn 1,(un),

n  1

and x0 = x.

The authors proved in [DH20] that the piecewise constant function

xt =

x 1 n {snt<sn+1}

n0

is an -strong approximation of the Brownian paths starting in x. Moreover the number of

random points used to approximate the trajectory on a fixed time interval [0, T ], denoted by

NT

NT := inf{n  1 : sn  T },

(0.3)

satisfies

lim
0

2E[NT

]

=



·

T

with

 = 33/2e-1.

This means that, the cost of the numerical approximation is of the order T /2. The approximation procedure presented in [DH20] is based on a piecewise constant func-
tion whose intersection with the Brownian paths corresponds to the set of points {(sn, xn) : n  0}. The sequence (sn)n0 is built using the random variables (un)n1 which represent Brownian exit times from some typical spheroid defined by 1,. Thus, the sequence of points {(sn, xn) : n  0} is obtained as the successive Brownian exit points of time-space spheroids of size : the Brownian path is therefore completely controlled inbetween two successive points of the skeleton.
In this paper we aim to adapt and develop this technique to the approximation of Bessel processes. Whenever the dimension of the Bessel process is an integer, the paths are distributed like the norm of a multidimensional Brownian motion. Consequently, the successive exit points of spheroids for that Brownian trajectory allows to build a Bessel skeleton, the main ingredient of the -strong approximation. In the framework of Bessel processes with non integer dimension, the construction of the algorithm is more difficult: we still use successive exit points of spheroids but we first have to decompose the Bessel paths into two independent parts following the flagship identity of Shiga and Watanabe [SW73].
In both cases, for integer or non integer dimensions, we develop the corresponding approximation scheme and prove the results that characterize and control its behaviour.

4

1 Bessel processes with integer dimension

The Bessel process of dimension  is the unique solution of the following stochastic differential

equation:

Zt,y

=

y

+



- 2

1

t
(Zs,y)-1 ds + Bt,
0

t  0,

(1.1)

where y  0 is the deterministic initial value of the process and (Bt)t0 stands for a one dimensional standard Brownian motion. In particular, for integer values of , the Bessel

process and the norm of a -dimensional Brownian motion are identically distributed. This

classical property shall play a crucial role in the sequel. Let us denote by  the so-called

Bessel

index

related

to

the

dimension

by

the

following

relation



=

 2

-

1.

Bessel Skeleton (BeS) ­ integer dimension

1. Let (An)n1 be a sequence of i.i.d. random variables with gamma distribution Gamma( + 2, 1/( + 1)) that is the shape equals  + 2 and the scale 1/( + 1).
2. Let (Vn)n1 be a sequence of i.i.d. uniformly distributed random vectors on the boundary of the unitary sphere S. We denote by 1(Vn) the projection on the first coordinate. The sequences (An)n1 and (Vn)n1 are assumed to be independent.

Definition: For  > 0, the Bessel skeleton (BeS) is given by (un, sn)n1, (yn )n0



   

un

=

2 

e1-An ,

with

n
sn = uk,
k=1



  

yn

=

1/2
(yn-1)2 + 21(Vn) yn-1 ,(un) + 2,(un) , n  1

and y0 = y.

The Bessel skeleton permits to construct an approximation of the Bessel trajectory. The main idea leading to this construction is first to relate the Bessel process to the norm of a dimensional Brownian motion. Secondly we replace the Brownian trajectory by a Brownian skeleton: a random walk corresponding to the successive exits of a sequence of small timespace spheroids.

Theorem 1.1. Let  > 0 and let us consider a Bessel skeleton (BeS) with   N. Then yt =

y 1 n0

 n

{sn t<sn+1 }

is

an

-strong

approximation

of

the

Bessel

paths

starting

in

y,

solution

of (1.1). The number of approximation points NT on the fixed interval [0, T ] satisfies:

lim 2
0

E[NT ]

=

T e

 + 2 +2 .
+1

(1.2)

5

Moreover the following CLT is observed:

 lim e 0  T

+1 +2

3/2+3

2NT

-

T e

 + 2 +2 =G
+1

in distribution,

with G a N (0, 1) standard Gaussian random variable and

2 =

 + 1 +2 -

 + 1 2+4 .

+3

+2

(1.3)

It is important to notice that Theorem 1.1 leads to confidence intervals for the number of approximated points which represents the efficiency of the approximation algorithm.

Proof. We construct the proof in several steps.
Step 1: -strong approximation.
Let us consider the -dimensional Bessel process (Zt,y, t  0) starting in y. We introduce the vector y^ = (y, 0, . . . , 0)  R. It is well-known that (Zt,y, t  0) has the same distribution as ( y + Wt , t  0) where W stands for a standard -dimensional Brownian motion. It suffices therefore to strongly approximate the Brownian norm since the strong approximation is based on an identity in law. Let us now build a sequence of points (tn, zn)n0 belonging to the trajectory of the dimensional Brownian motion (t, y^ + Wt)t0 and satisfying tn+1  tn for any n  0. The sequence of times is defined by

tn+1 := inf{t > tn : Wt - Wtn = ,(t - tn)} and t0 = 0.

(1.4)

These times represent the successive exit times of spheroids sequence (also called heat balls)
whose boundary shape corresponds to the function , defined by (0.2). In order to observe points belonging to the path, we set zn := y^ + Wtn. Due to the definition of the stopping times and since the maximum of the function , equals , we get

y^ + Wt - zn  , t  [tn, tn+1], n  0.

This means that, if we denote by (zt)t0 the random function satisfying

zt :=

zn1{tn , t<tn+1} t  0,

n0

then we have that y^+ Wt - zt  , for all t  0, almost surely. Moreover y^+ Wt - zt = 0 as soon as t = tn and n  0. This approximation of the -dimensional Brownian trajectory obviously allows to approximate its Euclidean norm. The second triangle inequality leads to

| y^ + Wt - zt |  y^ + Wt - zt  , t  0.
Since the strong approximation is based on an identity in distribution, ( zt )t0 is an strong approximation of the Bessel path.

6

Step 2: Relation to the Bessel skeleton (BeS).
To construct a typical approximated trajectory, it suffices to generate the sequence of successive times (tn)n0 and the associated sequence (zn)n0 = (Wtn)n0. It corresponds in fact to the sequences of exit times and exit locations of spheroids. In [DH13], the authors described the distribution of these two sequences. We note that
· the random variables (tn+1 - tn)n0 are independent and identically distributed. Moreover (tn+1-tn)/(e2) has the same distribution as e-A where A  Gamma(+2, 1/(+ 1)).

· the -dimensional Brownian motion satisfies the rotational invariance property. Therefore z0 = y^ and zn+1 is uniformly distributed on the sphere of center zn and radius ,(tn+1 - tn). Consequently
zn+1 2 = zn 2 + 21(V )zn,(tn+1 - tn) + 2,(tn+1 - tn),
where V is uniformly distributed on the unitary sphere of dimension  and 1 stands for the projection on the first coordinate.
We deduce that (tn, zn )n0 and the Bessel skeleton (BeS) (sn, yn )n0 are identically distributed and consequently, the process (yt)t0 defined in the statement of Theorem 1.1 defines an -strong approximation of the Bessel process.

Step 3: Number of points needed to cover [0, T ].

Let us now focus our attention on the number of spheroids used until a fixed time T , defined by NT := inf{n  0 : tn  T }. The arguments used here are similar to those developed in [DH20] (Proposition 2.2). We denote by (N^t)t0 the Poisson process with independent and identically distributed arrivals (e1-An)n1, defined by the Bessel skeleton. Then the classical
asymptotic result holds

lim E[N^t] =

1

=

1

= e-1

+2

+2
.

t t

E[e1-A1] eLA1(1)

+1

(1.5)

Here LA1(s) stands for the Laplace transform of the variate A1  Gamma( + 2, 1/( + 1)),

that is

s

--2

LA1(s) =

+1 +1

, s  0.

+2

Furthermore, the central limit theorem holds:

if we denote by µ = E[e1-A1] = e

+1 +2

and use the parameter  defined in (1.3), then Var(e1-A1) = e22 and

lim tµ3 N^t - 1 = G, in distribution, t e22 t µ

(1.6)

where G is a N (0, 1) standard Gaussian random variable. These two asymptotic results

described in (1.5) and (1.6) are related to the behaviour of NT in the  small limit since

NT

=

N^ T  , 2

 > 0.

The announced statement is therefore an easy consequence of the previous identity.

7

2 Bessel processes with non integer dimension
In the previous section, it was crucial that the dimension  of the Bessel process was an integer: this allows in particular to associate the Bessel paths with the norm of the dimensional Brownian motion. In the general case the dimension of the Bessel process defined in (1.1) is just a real valued parameter so we also need to develop an -strong approximation procedure for noninteger dimensions. In the particular case:   [1, [\N, the crucial tool is the argument developed by Shiga and Watanabe [SW73] and already used for simulation purposes in [DH17]. The Bessel process of dimension  starting in y  0 has the same distribution as the sum of two independent processes:
· a Bessel process of dimension i :=  (integer dimension) starting in y (the corresponding index is denoted i),
· a Bessel process of dimension f :=  -  (fractional dimension) starting in 0 (the corresponding index is denoted f ).
A wise combination of the construction developed in Section 1 on one hand, and the identity of Shiga-Watanabe on the other hand, allows to develop an adapted procedure in the general framework.

A rejection sampling algorithm

Before defining the general Bessel skeleton, we need to introduce the generation of a particular family of random variables already mentioned in [DH17]. The probability distribution under consideration is deeply related to the Bessel process of dimension  exiting from a spheroid of size . Nevertheless, we prefer to use in this paragraph generic constants  > 0 and  > 0 for notational simplicity. In the sequel we are going to fix  = /2 and  = 2e2/. Let us introduce the function u defined by

1 u,(t, x) = t exp

x2 -
t

1 - ,

(t, x)  R+ × R+,

(2.1)

and the associated normalization constant ,:

,,t

,,t :=

u,(t, y) y2-1 dy with ,,t :=

0

 t ln .
t

(2.2)

The constant ,,t corresponds to the positive zero of the function x  u,(t, x). We deduce

therefore that

x  -,1,t u,(t, x)x2-1 1[0,,,t](x)

(2.3)

is a probability distribution function. A random variable whose density is given by (2.3) can be generated using the following rejection sampling.

8

Conditional distribution (CD)t,

1. Let (Rn)n1 be a sequence of uniformly distributed i.i.d. random variables on the interval [0, 1].
2. Let (Vn)n1 be another sequence of i.i.d. uniformly distributed random variables on [0, 1]. The sequences (Rn)n1 and (Vn)n1 are assumed to be independent.
Initialization: n = 1. While u,(t, 0) Rn > u,(t, ,,t Vn1/(2)) set n  n + 1; Outcome: Z = ,,t Vn1/(2).

This algorithm is of prime importance in the study of Bessel processes. Indeed let us consider a Bessel process (Zt,0)t0 starting in 0 and with dimension  > 0 and let us denote  the first passage time through the curved boundary given by (0.2). We omit the dependence with respect to the parameters  and  for notational simplicity. The following identity in distribution holds.
Lemma 2.1. Let 0 < t < r, = e2/. The outcome of Algorithm (CD)2t,, with  = /2 and  = 2e2/, has the same distribution as the conditional distribution of Zt,0 given  > t.

Proof. Since Algorithm (CD)t, is an acceptance-rejection sampling, we can easily describe the distribution of its outcome. Let  be any non negative measurable function. We consider
R and V two independent uniformly distributed r.v., then

() E[(Z)] = (1)

where () := E

( V )1 1/(2)

,,t

{u, (t,0) Ru, (t,,,t V 1/(2))}

.

(2.4)

Using the change of variables y = ,,t x1/(2) permits to obtain

() =

1 0

(,,t

x1/(2))

u,(t, ,,t u, (t,

x1/(2)) 0)

dx

2 = 2,,t

,,t (y) u,(t, y) y2-1dy.

0

u,(t, 0)

(2.5)

Combining (2.4) and (2.5) proves that the p.d.f. of the random variable Z  (CD)t, corresponds to the function introduced in (2.3). After setting  = /2 and  = 2e2/, we
deduce that the density of Z  (CD)2t, corresponds to the function

x

2 (2t)/2(/2) exp

x2 -
2t

2

 /2

- (/2)

2e2

x-11{0<x<,(t)}

which is exactly the conditional density of Zt,0, given  > t (see, for instance, [DH17]).

9

Remark 2.2. The algorithm (CD)t, is based on a rejection sampling method, it is therefore straightforward to describe the efficiency of the procedure. It is well known that the number of trials corresponds to a geometrically distributed random variable denoted by N , with parameter (1),  being defined in (2.4). We deduce from (2.5) that

E[N ]

=

1 (1)

=

2,,t 2

u,(t, 0) . ,,t

An integration by parts allows to compute the value of the constant ,,t, by introducing the incomplete Gamma function:

1



,,t = 2 

 + 1,  ln t

,

where

x
(a, x) = ya-1e-y dy.
0

Finally the average number of steps equals



E[N ] =





+

1,



ln

 t



t

ln t

1 -  , for t < .

The Bessel skeleton (non integer dimension  > 1)

As already mentioned, our approach for the general case is based on Shiga-Watanabe's

identity in order to split the simulation challenge into two parts: a Bessel process of integer

dimension on one hand and a Bessel process of dimension less than 1 on the other hand. In the

sequel, for an easy identification of these two parts, we shall use for most of the parameters

either the index i corresponding to the integer part or the index f for the fractional one.

Let us fix two parameters wi ]0, 1[ and wf ]0, 1[ satisfying the following relation

 wf + 2 wi = 1.

(2.6)

Let us also define the general Bessel skeleton for a non integer dimension  > 1. We need to introduce the following constants:

i := i/2, f := f /2, i := 2ewi2/i and f := 2ewf 2/f .

We approximate a Bessel path, with starting value y, by constucting the following algorithm.

Bessel Skeleton (BeS)w ­ non integer dimension  > 1
1. Let (A(ni))n1 be a sequence of i.i.d. random variables with gamma distribution Gamma(i + 2, 1/(i + 1)).
2. Let (A(nf))n1 be a sequence of i.i.d. random variables with gamma distribution Gamma(f + 2, 1/(f + 1)).

10

3. Let (Vn)n1 be a sequence of i.i.d. uniformly distributed random vectors on the boundary of the unitary sphere Si. We denote by 1(Vn) the projection on the
first coordinate.

The sequences (A(ni))n1, (A(nf))n1 and (Vn)n1 are assumed to be independent. Initialization: n = 0, yn = y, un = 0, sn = 0. Step 1. Set n  n + 1.

Step 2. If A(nf) - A(ni) < ln

wf wi

+

ln

i f

then

·

Set

un

=

e 2wi 1-A(ni) i

and

Y

=

 i, wi

(un

)

· Generate Z  (CD)2ufn,f

else

·

Set

un

=

2 wf f

e1-An(f )

and

Z

= f ,wf (un)

· Generate Y  (CD)2ui,ni

1/2

Step 3. Set yn = (yn-1)2 + 2yn-11(Vn) Y + Y2 + Z2

and sn = sn-1 + un.

Return to Step 1.

Definition: The Bessel skeleton (BeS)w corresponds to (un, sn)n1, (yn )n0 .

The algorithm is based on the construction of a sequence of points (sn, yn )n0 which essentially permit to emphasize an approximated Bessel path. This sequence is obtained in a Markovian step by step procedure. With a starting time and location (sn, yn ), corresponding to the value of the -dimensional Bessel process, we associate two sets composed of a starting
point and a spheroid: one intended for a Bessel process of integer dimension and the other one
for a Bessel process of fractional dimension. These two paths have been carefully observed
until one of them exits from its spheroid. At that random time sn+1, both paths are stopped and a combination of their position at that stage permits to compute yn+1. To sum up, each step of the algorithm starts with a splitting of the Bessel paths and ends up with a regluing procedure. The sequence (sn, yn )n0 is crucial for the path approximation as pointed out in the following statement.

Theorem 2.3. Let  > 0 and let w = (wi, wf ) ]0, 1[2 be a couple of weights satisfying the

condition (2.6). Consider a Bessel skeleton (BeS)w with a non integer dimension  > 1.

Then yt =

y 1 n0

 n

{sn t<sn+1 }

is

an

-strong

approximation

of

the

Bessel

paths

starting

in

y, solution of (1.1). The number of approximation points NT on the fixed interval [0, T ]

11

satisfies:

lim
0

2

E[NT

]

=

T µ

:=

T i ewi

F

wf wi

i f

,

f

+

2,

f

1 +

, 1

i

+

2,

i

1 +

1

-1
,

(2.7)

where F (x, a, , b, µ) = E[min(xe-A, e-B)]. Here A and B stand for two independent Gamma distributed random variables with parameters (shape a and scale ) and, respectively (b, µ). Moreover the following CLT is observed:

lim 1 µ3/2i 0  T ewi

2

NT

-

T µ

=G

in distribution,

with G a N (0, 1) standard Gaussian random variable and

2 = F

wf2 wi2

i2 f2

,

f

+2,

f

2 +

1

,

i

+2,

i

2 +

1

-F

wf wi

i f

,

f

+2,

f

1 +

, 1

i +2,

i

1 +

1

2
. (2.8)

Corollary 2.4. There exists 0 > 0, such that the average number of approximation points NT , on the fixed interval [0, T ], satisfies:

2E[NT ]



T e

max

i , f wi wf

i + 2

i+2

f + 2

f +2
,

i + 1

f + 1

for all

  0.

(2.9)



2

The right hand side of (2.9) can be minimized with the optimal choice: wi =

. i-i f

Proof of Corollary 2.4. The statement is a direct consequence of the convergence result (2.7), combined with the properties of the function F. More precisely, for x  (0, 1], the independence of the variates A and B leads to

F (x, a, , b, µ) = E[min(xe-A, e-B)] = E[exp{- max(A - log(x), B)}] > E[exp{-(A + B - log(x))}] = xE[e-A]E[e-B] = xLA(1)LB(1) = x(1 + )-a(1 + µ)-b,
since max(A-log(x), B) < A+B -log(x) as soon as A > 0 and B > 0, that is almost surely. Here LA(s) stands for the Laplace transform of the variate A, that is LA(s) = (1 + s)-a. Moreover, if x  1, then similar computations lead to
F (x, a, , b, µ) = xE[min(e-A, x-1e-B)] > x · x-1(1 + )-a(1 + µ)-b = (1 + )-a(1 + µ)-b.

Consequently, for any x > 0, we get

F (x, a, , b, µ)-1 < max(1, x-1) (1 + )a(1 + µ)b.

(2.10)

Combining (2.10) with the limiting value (2.7) leads therefore to the announced upper-bound (2.9).

12

Proof of Theorem 2.3. The structure of the proof is similar to Theorem 1.2. First we replace the paths of the Bessel process by some other paths with the same distribution. Then, on the new paths, we introduce a skeleton. Finally we count the number of points needed to cover a deterministic time interval [0, T ].

Step 1: -strong approximation.

Let us consider a Bessel process of non integer dimension  > 1, that is the solution of
equation (1.1) with initial value y  0. Let us denote the distribution of the squared process by Q,y2. We recall that the dimension can be decomposed as follows:  = i + f where i =  . Using the identity in law pointed out by Shiga and Watanabe [SW73], we obtain:

Q,y2 = Qi,y2 Qf ,0,

(2.11)

where stands for the convolution of the probability distributions. Thus, by introducing two

independent Bessel processes Z and Z, one of integer dimension i starting in y: (Zt(y))t0,

and the other of non integer dimension f , starting in 0: (Zt(0))t0 (when the starting value is equal to 0, we shall drop the dependence for notational simplicity), then (2.11) leads to

the identity

(Zt,y)t0 (=d)

1/2
Zt(y)2 + Zt(0)2 =:

1/2
Zt(y)2 + Zt2 .

t0

t0

(2.12)

Bessel processes with integer dimension i play an important role since they can be represented as the norm of the i-dimensional Brownian motion. We just note that the standard Brownian motion (Wt) is rotational invariant and moreover:

(Wt)t0 = t · Wt

,

t0

where (t)t>0 is a continuous stochastic process valued in the unitary sphere Si, independent of ( Wt )t0. We fix 0 = 0 (not continuous for t = 0) and observe that t is uniformly distributed at any fixed time t > 0. Let us denote y = (y, 0, . . . , 0)  Ri. We deduce that

(Zt(y))t0 (=d) y + t Wt

1/2
= y2 + 2y 1(t) Wt + Wt 2 ,

t0

t0

(2.13)

where 1 corresponds to the projection on the first coordinate. Combining (2.12) and (2.13)

leads to

(Zt,y)t0 (=d) Xt :=

y2

+

2y

1 (t )Z t

+

Z

2 t

+

Zt2

1/2
,

t0

(2.14)

where the processes (Zt)t0, (Zt)t0 and (t)t0 are independent. Using the strong Markov
property of the Bessel process, we can propose a more complex identity. If s1 is a stopping time with respect to the filtration F (1) := (Ft(1))t0 induced by (W, Z) (also denoted in the sequel (W (1), Z(1))) then the conditional distribution of (Xs1+t)t0 given Fs1 is identical to the distribution

(Xt(2))t0 :=

Xs21

+

2Xs1

1((t2))Z

(2) t

+

(Z (t2) )2

+

(Zt(2))2

1/2
,
t0

13

where ((Z(k), Z(k), (k))t0)k2 is a family of independent copies of (Z(1), Z(1), (1))t0. So we can build a particular stochastic process (Xt)t0 combining X (also denoted X (1)) and X (2) by the following identity

X

(2) t

:=

Xt(1)1{t<s1}

+

Xt(-2)s1 1{ts1},

t  0.

Let us note that both (X t)t0 and (Zt,y)t0 are identically distributed. Let us go on with the modification of the process. To that end, we denote by (Ft(2))t0 the filtration generated by the following stochastic processes: (W (1), Z(1))ts1 and (W (2), Z(2))(t-s1)0. For any F (2)-
stopping time s2 > s1, we can define

X

(3) t

:=

Xt(1)1{t<s1}

+

Xt(-2)s1 1{s1t<s2}

+

Xt(-3)s2 1{ts2},

t  0,

where X (3) is defined by

(Xt(3))t0 :=

(Xs(22-) s1 )2

+

2Xs(22-) s1

1((t3)

)Z

(3) t

+

(Z (t3) )2

+

(Zt(3))2

1/2
.
t0

The procedure continues step by step in this way. For any increasing sequence of stopping time (sn)n1, satisfying limn sn = +, we construct the stochastic process:

X

() t

=

Xt(-ns+n1),

if sn  t < sn+1,

(2.15)

with the definition

(Xt(n+1))t0 :=

(X (n) sn -sn-1

)2

+

2X (n) sn -sn-1

1((tn+1))Z

(n+1) t

+

(Z (tn+1) )2

+ (Zt(n+1))2

1/2
.
t0

(2.16)

By construction, we observe that (X  t )t0 and (Zt,y)t0 are identically distributed. Since the definition of the -strong approximation only depends on the distribution of the stochastic process, it suffices therefore to point out an approximation of (X  t )t0 in order to prove the statement.

Step 2: Bessel skeleton

Let us now consider a particular increasing family of stopping times. Let w ]0, 1[ be a

fixed parameter. We define  n (respectively n), the first passage time of the Bessel process

(Z

(n) t

)t0

(resp.

(Zt(n))t0),

through

the

curved

boundary

 i, wi

(resp.

f ,wf ), defined

in (0.2). We construct a new stopping time un and the associated cumulative time sn, as

follows:

un :=  n  n and sn = sn-1 + un, n  1,

(2.17)

with the initial value s0 = 0. The sequence of stopping times (sn)n0 satisfies the conditions developed in the previous paragraph Step 1. We can therefore construct the continuous process (Xt)t0 using (2.15)­(2.16) and the particular sequence (sn)n0, just described.

14

Since the maximal value of the curved boundary , equals , we can emphasize a crucial

upper-bound

of

the

difference

Dt(n)

:=

|X

 t

-

X

 sn

|.

For

any

sn



t

<

sn+1,

Dt(n) =

(X (n) sn -sn-1

)2

+

2X (n) sn -sn-1

1

((tn+1))Z

(n+1) t

+

(Z t(n+1) )2

+

(Zt(n+1))2

- X 1/2

(n)

sn -sn-1

=

(X (n) sn -sn-1

+

1((tn+1))Z

(n+1) t

)2

+

(Z

(n+1) t

)2(1

-

12((tn+1)))

+

(Zt(n+1))2

- X 1/2

(n)

sn -sn-1

.

 Let us consider aand b twonon negative numbers, then for any x  R, we have | a + b-x|  | a - x| + b, a + b  a + b and finally ||a + b| - |a||  |b|. Applying to the previous expression of Dt(n), we obtain

Dt(n) 

|X (n) sn -sn-1

+

1 ((tn+1) )Z (tn+1) |

-

X (n) sn -sn-1

+

 |1((tn+1))Z(tn+1)| + 

 wi + wf  ( wi +

wi2 + wf 2 wi + wf ) = .

The last equality is a consequence of the particular relation between wi and wf introduced in

(2.6). We deduce therefore that the stochastic process defined by yt =

n0

X

 sn

1 , {snt<sn+1}

is an -strong approximation of the Bessel paths (see Definition 0.1). In order to prove the

statement of Theorem 2.3, it suffices to check that (yt)t0 defined in the statement and (yt)t0,

are identically distributed. Let us therefore describe the joint distribution of (un)n1, (sn)n0

and

(X

 sn

)n1

=

(X (n) sn -sn-1

)n1

and

compare

it

to

the

Bessel

skeleton.

· Using the definition of the stopping times un in (2.17), we observe that (un)n0 is a

sequence of independent and identically distributed random variables. Moreover, on

one

hand,

the

distribution

of

the

first

passage

time

n

is

identical

to

that

of

2 wi i

e1-A(i) ,

where A(i) stands for a Gamma distributed r.v of parameters i + 2 and 1/(i + 1) (see

for

instance

[DH17]).

On

the

other

hand,

n

and

2 wf f

e1-A(f )

are

identically

distributed.

Here A(f) corresponds to Gamma distributed r.v. with parameters f +2 and 1/(f +1).

The stopping time un is the minimum of these two first passage times and matches the

stopping time un introduced in Algorithm (BeS)w . Consequently (sn)n0 and (sn)n0

are identically distributed.

·

Let

us

now

describe

the

sequence

(X (n) sn -sn-1

)n1.

It is defined recursively by (2.16).

In this equation, we need to know the value of three random variables: un, Z(unn), Zu(nn). Since un is only linked to stopping times defined on the processes Z(n) and Z(n),

which are independent from , and since t is uniformly distributed for any t > 0,

we obtain that un is uniformly distributed on the sphere and independent of both

Z

(n) un

and

Zu(nn).

Moreover

the

definition

(2.1)

implies

to

take

into

account

two

different

cases: either un =  n < n or un = n <  n. In the first case, we have, on the event

un

=

t,

Z

(n) un

=

i

 , wi

(t)

and

the

distribution

of

Zu(nn)

corresponds

to

(CD)2tf ,f

as

announced in Lemma 2.1: a Bessel process conditioned not to have reach a curved

boundary. In the second case, we observe the reverse situation: on the event un = t,

15

Zu(nn)

=

f ,wf (t)

and

the

distribution

of

Z

(n) un

corresponds

to

(CD)2ti,i

as

announced

in Lemma 2.1. To sum up,

(un ,

Z

(n) un

,

Zu(nn))

(=d)

(Vn,

Y,

Z ),

where Vn,Y and Z correspond to the variables introduced in Algorithm (BeS)w . Due to (2.16), we deduce quite easily that (yt)t0 and (yt)t0 are identically distributed.
We conclude that (yt)t0 is an -strong approximation of the Bessel paths.

Step 3: Number of points necessary to cover the time interval [0, T ].

The arguments for the description of the number of points have already been introduced in the proof of Theorem 1.1. We introduce (Nt)t0 a Poisson process with independent and identically distributed arrivals (Mn)n1 where

Mn =

w e i 1-A(ni) i



w e f 1-A(nf) , f

with A(i) and A(f) defined in Algorithm (BeS)w . We denote µ = E[M1]. The classical asymptotic result holds:

lim E[Nt] = 1 = i F

t t

µ ewi

wf wi

i f

,

f

+

2,

f

1 +

, 1

i

+

2,

i

1 +

1

-1
,

(2.18)

where F is defined in the statement of Theorem 2.3. The mean of M1 plays an important

role in the limit so do the variance for the confidence interval. Due to the scaling property

of

the

Gamma

distribution,

we

notice

that

Var(M1)

=

 , e2wi2 2 i2

where

2

is

defined

by

(2.8).

The central limit theorem, applied in the counting process context, leads to

lim
t

tµ3i2 e2wi22

Nt - 1 tµ

=G

in distribution,

where G is a N (0; 1) standard Gaussian variate. Let us observe that the number of approxi-

mation points NT is directly linked in distribution to the Poisson process just defined. More

exactly,

we

have

NT

(=d) N T , 2

which

gives

directly

the

statement:

the

limit

with

respect

to

the time variable is replaced by the limit with respect to the parameter .

3 Related processes and numerical illustration
3.1 Numerics: Bessel processes
Let us first illustrate the strong approximation of Bessel processes. We choose to observe the paths on some given time interval [0, T ]. In particular, we are able to present a Bessel skeleton and the corresponding upper and lower bounds for some small precision value .
16

Figure 2: A trajectory of a Bessel process either of dimension 10 (left) or of dimension 2 (right)
represented by its squeleton (crosses) and the lower and upper almost sure bounds on [0, 1] with y0 = 0.5,  = 0.2

In Figure 2, the skeletons correspond for instance to a Bessel process either of dimension 10 or of dimension 2. As we can observe, the variations of the skeleton when time elapses are obviously smaller than the limit  chosen for the approximation. We can interpret this as: even if the maximal size of the spheroids corresponds to this specific value , the difference between the values of two successive points of the Bessel skeleton is not often near to the maximum. Indeed the spheroid is applied to the -dimensional Brownian motion in a first step, and then, in a second step, a random projection is applied, see the algorithm (BeS) for integer dimensions. So denoting by  the first Brownian exit time of the spheroid (0.2) and by p its probability density function, we can compute the following average size

e2 

e2 

e2 1

E[,( )] =

,(t) p (t) dt =

0 e

0
 /2 1 1

t ln t
1 (+1)/2

t(/2)

=

u ln

du =: ().

(/2) 2

0u

u

2t

e2

ln

2e2

t

/2
dt

We can evaluate this last integral

11

1 (+1)/2

u ln

du =

2

+3
2

+3

,

0u

u

+1

2

and by using the properties of the Gamma function obtain the explicit form:

 () = 2e

()



 2

2

(

 2

+

1)

+1 2

21- .

17

The average is obviously proportional to  and the constant () can be evaluated easily. We can observe that  is a non decreasing function of the dimension  on the interval [2, +) starting with an estimated value (2) = 0.7953. This function is represented on the opposite figure. Let us note that for high dimensions the average size E[,( )] is close to , which is the optimal size for the strong approximation procedure.

On the one hand, the increments of the Bessel skeleton depend on the Brownian exit time of the spheroid. On the other hand, they are also strongly related to the projection on the first coordinate of a random variable V uniformly distributed on the sphere of dimension : 1(V ). For  > 2, using the spherical coordinates, we obtain

2 E[|1(V )|] = ( - 1)(2)/2



r-1e-

r2 2

dr

0

-3
× Wk,
k=0

(3.1)

where Wk stands for Wallis' integrals Wn :=

/2 0

sinn(x)

dx.

Let

us

note

that

the

integral

appearing in (3.1) can be related to the moments of a standard Gaussian variate.

We deduce that



r2k

e-

r2 2

dr

=

0

 (2k)! 2 2kk!

and



r2k+1

e-

r2 2

dr

=

2kk!.

0

We can therefore compute the average size

of the projection which of course depends

on the dimension. Let us just note that

the particular dimension  = 2 leads to

E[|1(V )|]

=

2 



0.6366.

The oppo-

site figure gives this dependence: for large

dimensions the projection procedure re-

duces the difference between two succes-

sive points of the skeleton.

We notice that this reduction is not too strong, for  = 20 for instance the reduction corresponds to a division by 5.
The efficiency of the approximation is deeply related to the number of spheroids used to cover the time interval [0, T ]. Theorem 1.1 (Central Limit Theorem) points out the

18

asymptotic result as  tends to 0 for Bessel processes with integer dimensions. Numerical experiments permit to obtain an histogram of the number of points for the generation of 10 000 skeletons, see Figure 3.
Figure 3: Histogram of the number of points NT for a sample of Bessel processes of dimension 2
(left) or dimension 20 (right) observed on the time interval [0, 3] with y0 = 0.5,  = 0.05, sample size 10 000.
A characteristic of the asymptotic behaviour is the mean number of spheroids necessary to cover some time interval [0, T ]. We propose here to estimate it by using an empirical mean issued from a sample of 1 000 trajectories. As already mentioned, we observe a dependence with respect to the Bessel dimension, the number of spheroids used by the algorithm increases as  increases. Figure 4 emphasizes that this dependence looks linear. Moreover the estimation of the average permits to illustrate the asymptotic linear dependence with respect to the parameter 1/2, here  stands for the accuracy of the strong approximation.
19

Figure 4: Average number of skeleton points on the time interval [0, 1] versus the dimension of
the Bessel process (left, with  = 0.05) or versus the parameter 1/2 (right) with y0 = 0.5 and a sample size for the computation of the empirical mean 1 000.
In order to completely illustrate the strong approximation of the Bessel processes, let us consider numerical experiments for non integer dimensions. In this case, Algorithm (BeS)w permits to generate the Bessel skeletons. Of course, due to the decomposition related to Shiga-Watanabe's property, we need to observe both a sequence of spheroids for the Bessel process corresponding to the integer part of the dimension and a sequence of spheroids for the fractional part. That's why it is reasonable to see a large number of skeleton points in order to approximate the paths. For instance, for a Bessel process of dimension  = 2.2, the average of this random number represented by the histogram of Figure 5 (left) is about 68 130 while the average in the particular d = 2 dimension (Figure 3 ­ left) is approximately equal to 1767. This sharp increase strongly depends on the value of the parameter w which determines the size of the spheroids of both the integer and fractional part of the algorithm. The challenge is therefore to obtain a balanced repartition. The optimal choice of the parameters (wi, wf ), satisfying the identity wf + 2 wi = 1, is illustrated by different numerical experiments in Figure 5 (right). We observe that this optimal choice depends on the Bessel dimension and can be compared to the heuristic choice suggested in Corollary 2.4 which is represented by a vertical line in the figure.
3.2 Related processes
Several stochastic processes related to the Bessel one play an important role in the finance literature. Here the aim of the discussion is not to present a complete overview of financial models which could be concerned by our approximation procedure but rather to present few examples. Let us first recall the statement of Definition 0.1: (yt) is an -strong approximation
20

Figure 5: Histogram of the number of points NT for a sample of Bessel processes of dimension 2.2
with wf = 0.5 and wi = 0.0625 (left) ­ Average number of skeleton points (in log10-scale) versus the parameter value wi (right). Both figures concern paths observed on the time interval [0, 3] with
y0 = 0.5,  = 0.05. Sample sizes: 10 000 (left), 1 000 for the empirical mean (right).

of the diffusion process (Xt) on the fixed time interval [0, T ] if there exists (xt ) satisfying
sup |Xt - xt |   a.s.
t[0,T ]

such that (yt) and (xt ) are identically distributed. Consequently, as a by-product, any approximation of the Bessel path (Zt,y, t  T ) leads to an approximation of the path (Yt, t 

T0) defined by

Yt := f (t, Z(,yt)),

(3.2)

with f : R2+  R a continuous function and  : R+  R+ a strictly monotonous time change function. Of course the identity (3.2) implies a change of accuracy for the approximation

and of course a change in the time interval under consideration. This adaptation is rather

immediate and permits to handle with a large class of processes. In the family of financial

term structure models, we can for instance focus our attention on the square-root process or

CIR model (Cox-Ingersoll-Ross). This process appearing in the seminal paper of Cox et al.

[CIR85] is the object of many studies and is simply defined as the positive solution of

dYt = k( - Yt) dt +  Yt dBt, Y0 = x,

(3.3)

under the conditions k > 0 and  > 0. Using stochastic calculus permits to point out that the process Y satisfies (not especially with respect to the same Brownian motion) (3.2) with

f (t, x) = e-ktx2,

(t) = 2 (ekt - 1), 4k

4k



 = 2 and y = x.

Let us note that the coefficients of the diffusion (3.3) are time-homogeneous. It is possible to extend this family of term structure models to inhomogeneous processes (see, for instance

21

[JYC09]) solution to

dYt = (a - (t)Yt) dt +  Yt dBt, Y0 = x,

where  is a continuous function. We are still able to emphasize a relation like (3.2) with the following functions and parameters (see, for instance Theorem 6.3.5.1 in [JYC09]):

f (t, x) =

2

x2,

2 (t) =

t
exp

4 (t)

40

s

4a



(u) du ds,
0

 = 2 and y =

x.

Both the homogeneous and the inhomogeneous CIR models are related to the squared Bessel process through a time dependent linear transformation. Modelling the volatility in finance actually requires to handle with other process: the CEV model (Constant Elasticity of Variance) which satisfies:

dYt = Yt(µ dt + Yt dBt), t  0, Y0 = x.
Under particular conditions, the process (Yt)t0 satisfies (3.2) with f (t, x) = eµtx,  depending on  and being different from the square (see for instance [JYC09]). For option pricing in finance, it is therefore of prime interest to simulate precisely trajectories of underlying assets which follow CIR or CEV models. It permits to estimate the prices of derivatives like European options but also paths dependent options like Asian or barrier options.
As already seen, families of stochastic models are directly related to the Bessel process through the identity (3.2). If the function f is globally Lipschitz continuous with respect to the space variable then the Bessel -strong approximation (yt)t0 allows to generate a  -approximation of (Yt)t0 which is given by (f (t, y(t)))t0, the parameters  and  being related through the Lipschitz constant and the time interval under consideration.
If the transformation f is not uniformly Lipschitz with respect to the space variable (CIR and CEV models, for instance), then the Bessel -strong approximation permits to obtain a lower-bound and an upper-bound of any path (Yt)t0 depending on . These bounds imply a precise estimation of path-dependent characteristics and play therefore a crucial role for applications. Let us consider the following example: a CIR model observed on the time interval [0, 2] with the parameters: k = 2,  = 1/3,  = 1 and the starting value x = 1. It is therefore expressed by Yt = f (t, Z(,yt)) for all t  [0, 2]. Introducing the -strong approximation of the Bessel process (yt)t0, based on the Bessel skeleton (BeS) or (BeS)w that is ((un, sn)n1, (yn )n0), we obtain the almost surely bounds:
f (t, y(t) - )  Yt  f (t, y(t) + ), t  [0, 2],

since the function x  f (t, x) is increasing. In Figure 6 (right), one generation of the upper and lower bounds is represented for any t  {-1(sn)}n1  [0, 2]. The accuracy of the approximation is not uniform since it depends on the value of the process and on the time
variable. More precisely, we propose to define the precision variable P by

P := sup f (t, y(t) + ) - f (t, y(t) - ) .
t[0,2]

(3.4)

22

Using the explicit expression of the function f associated with the CIR model, we obtain an explicit expression of the accuracy depending on the Bessel skeleton:
P = 4  sup yn e-2-1(sn) s.t. sn  -1(2) . The probability distribution of the ration P/ is represented in Figure 6 (left): we observe that the accuracy is close to four times the initial condition of the Bessel process.
Figure 6: Histogram of the precision variable P/ (left) and a generation of bounding points
(joined by vertical lines). Both figures concern paths of the CIR model observed on the time interval [0, 2] with x = 1, k = 2,  = 1/3,  = 1. Histogram (left): sample size 10 000 and  = 0.05. Bounding points (right):  = 0.2.
Of course the difference between the lower and upper paths is not uniformly bounded. This accuracy is nevertheless sufficient in many applications but if the challenge is to reach a uniform bound, then we suggest another approach. The key is to let the size of the spheroids used in the Bessel approximation depend on the space variable: the size is no more fixed once for ever and equal to . Such an approach was presented in detail in [DH20] for processes defined by Yt := f (t, B(t)), transformations of the time-changed Brownian motion and can be adapted to the Bessel case.
References
[BT95] V. Bally and D. Talay. The Euler scheme for stochastic differential equations: error analysis with Malliavin calculus. Mathematics and Computing in Simulation, 38(1-3):35­41, 1995.
[CH13] N. Chen and Z. Huang. Localization and exact simulation of brownian motiondriven stochastic differential equations. Mathematics of Operations Research, 38(3):591­616, 2013. 23

[CIR85] J.C. Cox, J.E. Ingersoll, and S.A. Ross. A theory of the term structure of interest rates. Econometrica, 53:385­408, 1985.
[CR08] B. Casella and G. O. Roberts. Exact Monte Carlo simulation of killed diffusions. Advances in Applied Probability, 40(1):273­291, 2008.
[DH13] M. Deaconu and S. Herrmann. Hitting time for Bessel processes--walk on moving spheres algorithm (WoMS). Ann. Appl. Probab., 23(6):2259­2289, 2013.
[DH17] M. Deaconu and S. Herrmann. Simulation of hitting times for Bessel processes with non-integer dimension. Bernoulli, 23(4B):3744­3771, 2017.
[DH20] M. Deaconu and S. Herrmann. Strong approximation of particular onedimensional diffusions. arXiv, 2006.04378, 2020.
[DNS12] S. Dereich, A. Neuenkirch, and L. Szpruch. An Euler-type method for the strong approximation of the Cox­Ingersoll­Ross. Proceedins of the Royal Society A, 468:1105­1115, 2012.
[Gob00] E. Gobet. Weak approximation of killed diffusion using Euler schemes. Stochastic Processes and their Applications, 87(2):167­197, 2000.
[GS13] K. Giesecke and D. Smelov. Exact sampling of jump diffusions. Operations Research, 61(4):894­907, 2013.
[JKH11] B. Jourdain and A. Kohatsu-Higa. Approximation of solutions of stochastic differential equations. Progress in Probability, 65:141­164, 2011.
[JYC09] M. Jeanblanc, M. Yor, and M. Chesney. Mathematical methods for financial markets. Springer Science & Business Media, 2009.
[KP92] P.E. Kloeden and E. Platen. Numerical solution of stochastic differential equations, volume 23 of Applications of Mathematics (New York). Springer-Verlag, Berlin, 1992.
[MGY20] T. Mu¨ller-Gronbach and L. Yaroslavtseva. On the performance of the euler­maruyama scheme for SDEs with discontinuous drift coefficient. Ann. Inst. H. Poincar´e Probab. Statist., 56(2):1162­1178, 2020.
[PJR+16] M. Pollock, A. M. Johansen, G. O. Roberts, et al. On the exact and -strong simulation of (jump) diffusions. Bernoulli, 22(2):794­856, 2016.
[SW73] T. Shiga and S. Watanabe. Bessel diffusions as a one-parameter family of diffusion processes. Z. Wahrscheinlichkeitstheorie und Verw. Gebiete, 27:37­46, 1973.
24

