arXiv:2106.01344v1 [math.NA] 2 Jun 2021

RANDOM WALK APPROXIMATION FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS ON MANIFOLD: ERGODICITY, UNCONDITIONAL STABILITY AND
CONVERGENCE
YUAN GAO AND JIAN-GUO LIU
Abstract. Irreversible drift-diffusion processes are very common in biochemical reactions. They have a non-equilibrium stationary state (invariant measure) which does not satisfy detailed balance. For the corresponding Fokker-Planck equation on a closed manifold, via Voronoi tessellation, we propose two upwind finite volume schemes with or without the information of the invariant measure. Both two schemes enjoy stochastic Q-matrix structures and can be decomposed as a gradient flow part and a Hamiltonian flow part, which enable us to prove unconditional stability, ergodicity and error estimates. Based on two upwind schemes, several numerical examples - including sampling accelerated by a mixture flow, image transformations and simulations for stochastic model of chaotic system - are conducted. These two structure-preserving schemes also give a natural random walk approximation for a generic irreversible drift-diffusion process on a manifold. Thus they can be adapted to manifold-related computations induced from high dimensional molecular dynamics.

1. Introduction

A general stationary (time-homogeneous) dynamical system with white noise, can be modeled by a

stochastic differential equation for yt  R



(1.1)

dyt = b(yt) dt + 2 dBt,

where  is a noise matrix. Denote D := T  R × . For simplicity, we assume D is a constant positive semi-definite matrix. By Ito's formula, SDE (1.1) gives the following Fokker-Planck equation, which is

the master equation for the time marginal density t(y)

(1.2)

t = - · (b) +  · (D) =: L.

In some physical systems, the drift vector field b = -D for some potential  representing the energy landscape. Then the Gibbs measure (y)  e-(y) is the invariant measure. The simplest example is the
 Ornstein-Uhlenbeck process with b(yt) = -yt and the diffusion coefficient  = . In this case, (1.1) is called Langevin dynamics and the corresponding Fokker-Planck equation has a gradient flow structure; see (2.21). In this Langevin dynamics case, the Markov process defined by (1.1) is reversible1, i.e., if
taking  as initial density, the time-reversed process has the same law as that of the forward process.
Equivalently, the invariant measure satisfies the detailed balance condition

(1.3)

steady flux F  := -b + D = 0.

However, numerous dynamical systems in physics and biochemistry are described by irreversible Markov processes (without detailed balance), i.e., there does not exist a potential function such that the drift vector field b = -D in (1.1). For instance, the stochastic Lorenz system, the Belousov­Zhabotinsky reaction or the Hodgkin­Huxley model describing the excitation and propagation of sodium and potassium ions in a neuron. The irreversibility in the nonequilibrium circulation balance is almost literally the primary characteristic of life activities [Hil05]. In this case, the invariant measure , even if still

2010 Mathematics Subject Classification. 60H30, 60H35, 65M75, 65M12. Key words and phrases. Symmetric decomposition, non-equilibrium thermodynamics, enhancement by mixture, exponential ergodicity, structure-preserving upwind scheme. 1In some physics literature, it is referred as microscopic reversibility [Ons31].
1

2

Y. GAO AND J.-G. LIU

stationary in time, but there is a positive entropy production rate; see (3.11). Thus Prigogine named such a invariant measure  as "stationary non-equilibrium states" or "non-equilibrium steady states" in [Pri68, Chapter VI]. We will simply call it steady state or invariant measure. Later, Hill explains Prigogine's theory using Markov chain stochastic models for some simple biochemical reactions such as the muscle contraction and clarifies the formula (3.11) for the entropy production rate [Hil05, eq. (9.20)]. Another situation is that for a Markov process on manifold, which is induced via dimension reductions (such as diffusion map [CKL+08]) from a higher dimensional Markov process based on collected data, some classical schemes such as the Euler-Maruyama scheme will break the detailed balance property.
Therefore, in this paper we focus on designing numerical schemes to simulate a general irreversible Markov process on a closed manifold N ; see (1.4). In terms of the SDE, we will design a random walk approximation which enjoys ergodicity and accuracy. In terms of Fokker-Planck equation (1.2), we will design two upwind schemes with a Q-matrix2 structure so that it also enjoys ergodicity, unconditionally stability and accuracy.
Assume N is a d-dimensional closed manifold which is smooth enough. Let b  TN be a given tangent vector field. We denote the over-damped Langevin dynamics of y by

(1.4)

d dyt = b(yt) dt + 2 iN (yt)  iN (yt)  dBt,
i=1

where   R × is a constant matrix corresponding to the thermal energy in physics, the symbol  means

the Stratonovich integral, Bt is -dimensional Brownian motion and {iN ; 1  i  d} are orthonormal

basis of tangent plane Tyt N . Here N :=

d i=1

iN

iN

=

d i=1

iN



iN 

is

the

surface

gradient

and iN = iN ·  is the tangential derivative in the direction of iN . More precised conditions on the

manifold are referred to [IW81, Chapter 4], [Hsu02]. By Ito's formula, the corresponding Fokker-Planck

equation will be

t = -N · (b) + N · (DN ),

but for notation simplicity, we drop subscript N and still use (1.2).

In terms of a general Fokker-Planck equation on a closed manifold N , if without detailed balance, we

can decompose it as a gradient flow part (described by a symmetric operator) and a Hamiltonian flow part

(described by an antisymmetric operator); see Section 2.2. It is important to design numerical schemes

that preserves this structure in the discrete sense. Thus in Section 2, based on the Voronoi tessellation for

manifold N , we will develop two upwind finite volume schemes preserving stochastic Q-matrix structures

and the discrete decompositions. The first upwind scheme does not relies on knowing the steady state 

of irreversible dynamics (1.4); see Section 2.1. The second upwind scheme, which is called -symmetric

upwind scheme, leverages a given steady state information  to simulate irreversible dynamics (1.4)

and also enjoys ergodicity to this given steady state; see Section 2.3. More importantly, schemes with

stochastic Q-matrix structures always have a -symmetric decomposition, which decomposes the discrete

flux as a symmetric part (corresponding to a dissipation part) and an antisymmetric part (corresponding

to an energy-conservative part); see Section 3. The later part has no contribution to the discrete energy

dissipation, so we have same stability and ergodicity properties for both schemes; see Proposition 3.2

and Lemma 3.5. Moreover, based on the Q-matrix structure, we will propose an unconditionally stable

explicit time discretization and prove its stability and exponential ergodicity; see Proposition 3.7.

In Section 4, we will give convergence and error estimates for the numerical steady state and the

numerical dynamic solutions solved by the first upwind scheme (2.6), which rely on the Taylor expansion

on manifold and the discrete energy dissipation law; see Theorem 4.2. In Section 5, several numerical

examples based on upwind scheme (2.6) and -symmetric upwind scheme (2.26) are conducted: (i)

accelerated sampling enhanced by an incompressible mixture flow; (ii) image transformations immersed

in a mixture flow; and (iii) the stochastic Van der Pol oscillator in which we only know the drift vector

field b in the irreversible process. In the sampling and image examples, it is interesting to see the

2a.k.a. infinitesimal generator matrix for a Markov chain

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

3

convection(the Hamiltonian flow part in the scheme) brought by the incompressible mixture flow speed up convergence of the dynamic solution to its steady state, which could be a promising direction to explore more in the future.
For Fokker-Planck equation (1.2) in a bounded open domain   R with various boundary condition, there are many pioneering studies on numerical simulations. The most famous one is the ScharfetterGummel (SG) scheme proposed in [SG69] for some 1D semiconductor device equations; see Remark 3.4 for comparison. Some extensions and mathematical analysis are studied; c.f., [Mar85, MZ88, BCJC98, XZ99] and recently in [CHH20]. We will follow similar ideas of the finite volume method for the driftdiffusion equation [EGH00, BC12, CHLP03] but emphasis more on the new Markov chain structure and -symmetric decomposition. We develop the structure preserving schemes described above which possess stochastic Q-matrix structure and discrete -symmetric decomposition. Therefore, our two schemes naturally provide a random walk approximation for irreversible Markov processes on manifolds and thus also easier to adapt to some data-driven algorithms based on high dimensional point clouds; c.f., [GLW20, GLLL20].
The remaining paper will be organized as follows. In Section 2, we propose two upwind schemes with Q-matrix structure for irreversible process (1.4). In Section 3, we give the discrete -symmetric decomposition for a generic irreversible process on a closed manifold. Based on this, a energy dissipation law and exponential ergodicity are proved for both schemes. In Section 4, we give convergence and error estimates in terms of the 2-divergence. In Section 5, several numerical examples with/without steady state information are presented. Two schemes in the 2D structured grids case with no-flux boundary condition are given in Appendix for completeness.

2. Two upwind schemes as random walk approximations for irreversible process
This section focuses on constructing random walk approximations for irreversible drift-diffusion process (1.4). The approximations are proposed based on some upwind finite volume schemes for the corresponding Fokker-Planck equation (1.2).
We focus on two kinds of fundamental problems in numerical simulations for irreversible process, i.e., the drift vector field b does not satisfy the detailed balance condition b = -D.
The first kind of problem is we only know the drift vector field b without steady state information. In this case, we will design an upwind scheme (2.6) with Q-matrix structure based on the Voronoi tessellation for manifold N to solve both numerical steady state and simulate the dynamic process described by (1.2); see Section 2.1.
The second kind of problem is that in many applications, we have information about the invariant measure , although it is not detailed balanced (pointwise steady flux F  = 0). This kinds of "steady state with nonzero flux on network" happens very common in biochemistry. In this case, we will design a -symmetric upwind scheme (2.26) which recovers the given steady state ; see Section 2.3. This scheme is motivated by a reformulation as a gradient flow part and a Hamiltonian flow part for the continuous Fokker-Planck equation; see Section 2.2. Detailed analysis for upwind schemes with generic Q-matrix structure will be given in Section 3.

2.1. Voronoi tessellation and upwind finite volume scheme. In this section, we first propose a finite volume scheme for the Fokker-Planck equation (1.2) based on a Voronoi tessellation for N . Then we design an upwind finite volume scheme with a Q-matrix structure, which can be reformulated as a Markov process on finite sites and enjoys good properties.
Suppose (N , dN ) is a d dimensional smooth closed submanifold of R and dN is induced by the Euclidean metric in R . S := {yi}i=1:n are point clouds sampled from a density function on N bounded below and above. It is proved that the data points S are well-distributed on N whenever the points are sampled from a density function with lower and upper bounds [TS15]. Define the Voronoi cell as

(2.1)

Ci := {y  N ; dN (y, yi)  dN (y, yj) for all yj  S} with volume |Ci| = Hd(Ci).

4

Y. GAO AND J.-G. LIU

Then N = ni=1Ci is a Voronoi tessellation of N . Denote the Voronoi face for cell Ci as

(2.2)

ij := Ci  Cj with its area |ij| = Hd-1(ij),

for any j = 1, · · · , n. If ij =  or i = j then we set |ij| = 0. Define the associated adjacent sample points as

(2.3)

V F (i) := {j; ij = }.

Using the above Voronoi tessellation, associated the discrete density i|Ci| at cell Ci and the sign of the flux at each site, we design the upwind scheme as follows.

For each cell Ci, denote the unit outer normal vector field on Ci (pointing from i to its adjacent j) as n  R . Denote (b · n)+ij, (b · n)-ij > 0 as the positive and negative parts of (b · n)ij respectively, where (b · n)ij means evaluate (b · n) at the intersection point of the geodesic from yi to yj. We integrate (1.2)
on Ci and use the divergence theorem on cell Ci to obtain

(2.4)

d dt

Hd(Ci) =

Ci

jV F (i)

n · (-b + D) Hd-1(ij).
ij

The probability in Ci can be approximated as

(2.5)

(y)Hd(Ci)  (yi)(1 + diam(Ci))|Ci|,
Ci

so we use i to approximate the exact solution (yi) on each cell Ci. We introduce the following upwind finite volume scheme and call it "upwind scheme". For i = 1, · · · , n,

(2.6)

d

dt i|Ci| =

|ij |

jV F (i)

nij

·

Dnij (j - |yj - yi|

i)

+

(b

·

n)-ij j

-

(b

·

n)+ij i

,

where |Ci| is the volume element at cell Ci. One can recast (2.6) as a matrix form

(2.7)

d dt i|Ci| =

Qijj|Cj|, i = 1, · · · , n,

j

where the Q-matrix is given by

(2.8)

Qij

=

|ij | |Cj |

nij · Dnij |yj - yi|

+ (b

· n)-ij

 0,

j = i,

Qii

=

jV

F (i)

|ij | |Ci|

- nij · Dnij |yj - yi|

- (b ·

n)+ij

.

Since for any two adjacent i and j, we have

(2.9)

nij = -nji, (b · n)-ji = (b · n)+ij .

Thus the transport of Q satisfies

(2.10)

Qij

=

|ij | |Ci|

nij · Dnij |yj - yi|

+ (b · n)-ji

Qii = -

Qij .

jV F (i)

= |ij | |Ci|

nij · Dnij |yj - yi|

+ (b ·

n)+ij

 0,

j = i,

Thus Q-matrix is a stochastic matrix that row sums zero; see [Lig10, Definition 2.3]. Then Q is the generator of the associated Markov process on point clouds. We list the following standard properties for Q-process (2.7), which guarantee good properties for the numerical scheme:

· positivity preserving, i.e., mini i(0)  0 = mini i(t)  0;

·

total mass preserving, i.e.,

d dt

i i|Ci| =

i,j Qij j = 0;

·

1-contraction, i.e.,

d dt

i |i - ~i||Ci| 

i,j Qij |j - ~j | = 0.

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

5

For the adjoint process tfi = j Qijfj, it satisfies maximal principle, i.e., for im := argmini fi and iM := argmaxi fi,

d

dt fim =

Qimj (fj - fim )  0;

j

d

dt fiM =

QiM j (fj - fiM )  0.

j

When the exact metric for the manifold is unknown, we can also use collected point clouds which probe the manifold to compute an approximated Vonoroi tessellation; see details in [GLW20, Algorithm 1].

Remark 2.1. One can interpret the upwind finite volume scheme (2.6) as the forward equation for a Markov process with transition probability Pji (from j to i) and jump rate j

(2.11)

d

dt i|Ci| =

jPjij|Cj| - ii|Ci|, i = 1, 2, · · · , n,

jV F (i)

where for i = 1, 2, · · · , n,

(2.12)

i := Qij ,
j=i

Pij

:=

Qij , i

j  V F (i);

Pij = 0,

j / V F (i).

Using the exponential distribution f (t; ) = e-t with rate , this interpretation can be used to realize
Gillespie's algorithm in the Monte Carlo simulation, i.e., the transition probability from site i to j at time  is p(, j; 0, i) = Pij ie-i .

Remark 2.2. The upwind finite volume scheme (2.6) belongs to monotone schemes uniform in D. It is well known all monotone schemes that uniform in D have at most first order accuracy. To achieve higher order schemes for convection-dominated problems that enjoy the above positivity preserving property and still uniform in D, one need to restore some nonlinear schemes by the method of limiter or streamline diffusion methods. However, the nonlinearity will destroy the Q-matrix structure and we will leave high order schemes for a future study. On the other hand, in the case that diffusion D is not small, standard centered scheme can be adapted as a second order scheme.

2.2. Reformulate as gradient flow structure and Hamiltonian structure. Recall the continuous Fokker-Planck operator L in (1.2). From now on, to ensure existence of a positive invariant measure ,
we assume D is positive definite. Based on [IW81, Proposition 4.5], we know the Fokker-Planck operator L on the compact manifold N has a unique invariant measure, denoted as ,

(2.13)

0 = L = - · (b) +  (D) .

We first use the invariant measure  to decompose (1.2) as two parts: gradient flow part and Hamiltonian flow part. Rewrite (1.2) as

(2.14)

t =L =  · (D - b) =  ·

 D + (D - b)


= ·

 D

+

(D

 - b) · 

=:

L 

+T

 .







Here the symmetric operator L is

(2.15)

L :=  · (D) , with f, Lg = Lf, g , u, Lu  0,

while the antisymmetric operator T is

(2.16)

T := (D - b) ·  =: u · , with f, T g = - T f, g

since  · (D - b) =  · u = 0 by (2.13). Here we remark that in terms of -variable, we usually

say  ·

D

1 

(resp.

u

·



1 

)

is

symmetric

(resp.

antisymmetric)

operator

in

L2(

1 

).

We

will

call

this

decomposition as `-symmetric decomposition'.

6

Y. GAO AND J.-G. LIU

In the irreversible case, (2.14) for the reformulated Fokker-Planck equation can be regarded as a

gradient

flow

part

t

=

L

 

=

·

D

 

plus

a

Hamiltonian

flow

part

(convection

part)

t

=

T

 

=

(D

-

b)

·



 

.

Indeed,

given

a

convex

function



with



 0, denote the free energy as

(2.17)

 E :=   dx.


Since  · (D - b) = 0, for any free energy of the form (2.17), we have

(2.18)

E 





,T = 

, T = (D - b) · 

dx = 0.

 





For the gradient flow part, we have

(2.19)

E , L  =   , L  = -







 · D dx  0.

 









This observation is quite similar to the so called GENERIC (general equation for non-equilibrium reversible-irreversible coupling) formalism, which also decomposes a general thermodynamics as a gradient flow part and a Hamiltonian flow part.
From (2.18), in terms of the energy dissipation law, the Hamiltonian part has no contribution. From now on, we denote c as a generic constant whose value may change from line to line.
Below we summarize the following lemma for the energy dissipation law for continuous equation and later we will use it to derive a corresponding discrete energy dissipation law.

Lemma 2.3. Let E be an entropy defined in (2.17), we have the energy dissipation law

(2.20)

dE





=- 

 · D dx  0.

dt





Specially, it is well known that the reversible condition (detailed balance condition) is equivalent to

b=

D ln ,

i.e.,

there

is

only

symmetric

part

t

=

L

 

.

In

this

case,

there

are

particularly

two

well

known gradient flow structures:

(i) Take (x) = x ln x then free energy becomes KL(||) =



ln

 

dx,

and

we

have

the

gradient

flow

(2.21)

KL

d





t =  ·

D 

;

KL(||) = -  ln , D ln  0;

dt





(ii)

Take

(x)

=

1 2

x2

,

then

free

energy

becomes

2-divergence

2()

=

1 2

2 

dx,

and

we

have

the

gradient flow

(2.22)

2() t =  · D  ;

d

2()

=

-

  , D

 0;

dt



Particularly,

take

(x)

=

1 2

(x

-

1)2

,

then

we

have

the

decay

estimate

for

1 2

(2.23)

d 1 ( - )2



dx = -  , D  0.

dt 2





This together with Poincare's inequality

(-)2 

dx,

|u|2 dx  c u, Du for u dx = 0,

yields the exponential decay of  to steady state .

Thanks to Poincare's inequality, -symmetric decomposition (2.14) and Lemma 2.3, we conclude that

in terms of exponential ergodicity, there is no difference between the irreversible process and the cor-

responding reversible process. Indeed, the equivalence of the exponential ergodicity for the irreversible

process and the corresponding reversible process was already established in [Che00]; particularly for

countable state space.

Moreover,

besides

the

gradient

flow

part,

the

incompressible

transport

u

·



 

brought by u = D - b usually results in mixture. Thus we will observe a speedup of convergence for

the irreversible process; see Section 5.1.

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

7

From -symmetric decomposition (2.14), for the irreversible case, the dynamics can not be described only by a gradient flow and there is an additional Hamiltonian flow part. This observation is also given by [MRP14, Example 4.3]. Moreover, by defining a L-function in the large deviation principle, [FK06, MRP14] established the relation between (generalized) gradient flow and the L-function in the large deviation principle.
Designing a structure preserving numerical scheme is important and will be studied for schemes with generic Q-matrix structure in Section 3 via a discrete -symmetric decomposition. Specifically, we will show both "upwind scheme" (2.6) and "-symmetric upwind scheme" (2.26) are structure preserving numerical scheme which enjoy the above -symmetric decomposition, a discrete dissipation law and exponential ergodicity.

2.3. -symmetric upwind scheme for irreversible processes with an invariant measure. In
this section, we design a finite volume scheme based on -symmetric decomposition (2.14) and based on
a given steady state information, i.e., the invariant measure . The expected numerical scheme, which defines a numerical i, should recover the given steady state i = i. This kind of idea that preserves given steady state is known as "well-balanced scheme." Recall the symmetric decomposition (2.14)

(2.24)

t =  · (D - b) =  ·

 D


+ (D

-

 b) · 

=:

L 

+T

 .





From stationary equation (2.13), the new drift velocity

(2.25)

u := D - b,  · u = 0.

Then two common scenarios in applications are (i) given the non-gradient form drift b and steady

state , we can compute the new drift velocity (2.25); (ii) given any incompressible velocity field u such

that



·

u

=

0,

based

on

,

then

the

original

drift

is

given

by

b

=

D

 

+

u 

.

Now based on the symmetric decomposition (2.14) and based on the given steady state information

, we design the following upwind finite volume scheme and call it "-symmetric upwind scheme". For

i = 1, · · · , n,

(2.26)

d

dt i|Ci| =

|ij |

jV F (i)

D(i + j) 2|yj - yi|

j - i j i

+

(u

·

n)-ij

j j

-

(u

·

n)+ij

i i

,

where |Ci| is the volume element at cell Ci. Here (u · n)+ij, (u · n)-ij > 0 as the positive and negative parts of (u · n)ij respectively.
Denote

(2.27)

Qij

=

|ij | |j ||Cj |

Qii =
j

D(i 2|yj

+ -

j ) yi|

+

(u

·

n)-ij

 0, j = i,

|ij | |i||Ci|

- D(i 2|yj

+ j) - yi|

-

(u

·

n)+ij

Then from (2.9)

(2.28)

Qij

=

Qji

=

|ij | |j ||Cj |

D(i 2|yj

+ j) - yi|

+

(u

·

n)-ij

 0, j = i,

Qii = - Qij ,
j=i

which is still a stochastic Q-matrix that row sums zero. Then (2.26) can be recast as

(2.29)

d dt i|Ci| =

Qij j |Cj |.

j

8

Y. GAO AND J.-G. LIU

2.3.1. Structure preserving decomposition. For the upwind part of (2.26), notice

(2.30)

(u

·

n)+ij

j j

=

(u

·

n)ij

i i

+

(u

·

n)-ij

i i

.

Then the flux Fji in (2.26) can be recast as

(2.31)

Fji = |ij |

D(i 2|yj

+ j) - yi|

+

(u

·

n)-ij

j - i j i

-

(u

·

n)ij

i i

.

Notice another anti-symmetric decomposition for the upwind parts

(2.32)

(u

·

n)-ij

j j

-

(u

·

n)+ij

i i

=

1 - 2 (u · n)ij

j + i j i

1

+

|(u 2

·

n)ij |

j - i j i

.

Then another recast of flux Fji in (2.26) is

(2.33)

Fji = |ij |

D(i 2|yj

+ j) - yi|

+

1 |(u
2

·

n)ij |

j - i j i

1

-

(u 2

·

n)ij

j + i j i

.

Using

(2.33),

multiplying

(2.26)

by

i i

and

taking

summation

w.r.t

i,

we

have

(2.34)

d dt

2i i

|Ci|

=

-

i,j

|ij | 2

D(i + j) |yj - yi|

+

|(u

·

n)ij |

j - i j i

2
+ Ie,

Ie := -

|ij 2

|

(u

·

n)ij

i,j

j j

i i

+

2i i2

=-
i,j

|ij 2

|

(u

·

n)ij

2i i2

.

Notice in the continuous case, given  and b, the drift u in (2.25) is divergence free. If we have same divergence free condition in the discrete case, then Ie = 0 and we obtain the accurate convergence to steady state. Thus we construct the discrete velocity field such that the incompressible condition holds

(2.35)

|i,j |(u · n)i,j = 0.
j

There are some well-known schemes in computations for incompressible flows, Maxwell's equations and magnetohydrodynamics [EL96, LS00]. We adapt them in the 2D case as follows. In 2D, there exists a stream function (x, y) such that u = (-y, x). For each 2D cell Ci, we set a counterclockwise orientation for its face ij, j  V F (i). Then at each face ij, denote the starting point as ij and the ending point as ij. Then the discrete incompressible velocity field is defined as

(2.36)

(u

· n)ij

:=

 



(ij ) |ij

- (ij) - ij |

=

(ij) - (ij) , |ij |

which automatically satisfies (2.35). In 3D case, we need use a vector potential instead of stream function while in higher dimension there are more freedoms to construct the incompressible velocity.
Thanks to (2.35) and Ie = 0, (2.34) becomes the discrete energy dissipation law

(2.37)

d dt

2i i

|Ci|

=

-

1 2

i,j

i,j

j - i

2
0

j i

with a symmetric coefficient ij = |ij|

D(i+j ) |yj -yi|

+

|(u

·

n)ij |

; see Proposition 3.2 for same result with

a general Q-matrix. Then with the truncation error estimate, we will give the convergence analysis in

Theorem 4.2 for the numerical solution in terms of the 2-divergence.

After choosing u satisfying (2.35), from (2.31), -symmetric upwind scheme (2.26) is equivalent to

(2.38)

d

dt i|Ci| =

Fji,

jV F (i)

Fji = |ij |

D(i 2|yj

+ j) - yi|

+

(u

·

n)-ij

j - i . j i

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

9

Thus although the original Fokker-Planck (1.2) is irreversible, but the discrete flux Fji can be chosen such that the discrete steady flux

(2.39)

Fji = |ij |

D(i 2|yj

+ j) - yi|

+

(u

·

n)-ij

j - i  0, i, j. j i

This implies the scheme is well balanced, i.e., numerical steady state i = i.

Remark 2.4. Although we can choose the discrete flux satisfies (2.39), however, we remark this does not contradict with the equivalent irreversible condition, i.e., the flux F  = 0 pointwisely for continuous Fokker-Planck equation; c.f. [QQT02, GLL21]. Indeed, because of different decomposition of flux and (2.35), in the numerical schemes, one can either use the pointwise flux Fji in (2.38) or use original Fji in (2.31); however, only the former one satisfies (2.39).

3. Structure preserving, stability and ergodicity

In this section, for numerical schemes with an abstract generic Q-matrix structure, we present a structure preserving reformulation, which is the discrete counterpart of -symmetric decomposition (2.14). Then we use it to prove stability and ergodicity for schemes with a generic Q-matrix structure. These results apply to both (2.6) and (2.26).

3.1. Structure preserving for the -symmetric decomposition in discrete case. In this section, we leverage the numerical steady state i to recover the -symmetric decomposition for numerical schemes with a generic Q-matrix structure, for instance (2.6), and derive the discrete energy dissipation
law.
Before doing the symmetric decomposition, we first clarify the existence of a positive numerical steady state . Let Q be the Q-matrix defined in (2.10). Notice the Vonoroi tessellation implies the directed
graph associated to Q is connected. Thus Q is irreducible. We construct a new stochastic matrix

(3.1)

Q

K := + I, a

with constant a > max(-Qii) > 0
i

such that

(3.2)

Kij

=

Qij a

 0,

j = i;

Kii

=

1+

Qii a

>

0.

Since Kii > 0, the resulted Markov chain with transition probability matrix K is aperiodic. It is easy to see j Kij = 1, so we know 1 is an eigenvalue to K with a right eigenvector e := (1, 1, · · · , 1)T , i.e. Ke = e. Then by the Perron-Frobenius theorem for K, we know

· µ1 = 1 is the principle eigenvalue of K and all the other eigenvalues |µi| < 1, i = 2, · · · , n; · there is a positive eigenvector, denoted as  T , being the left eigenvector corresponding to 1, i.e.
 T K =  T .
Here and in the following context, the vector T is short for T := (1|C1|, · · · , n|Cn|). Thus we know the positive vector  is the unique numerical stationary solution to

(3.3)

Qij j|Cj | = 0.
j

One can interpret the right-hand-side of (2.7) as the flux gained and lost at site i. Denote

(3.4)

Fji := Qjij |Cj | - Qij i|Ci|,

then the dynamic solution satisfies

(3.5)

t(i|Ci|) =

Fji, i = 1, 2, · · · , n.

jV F (i)

Denote the steady flux as

(3.6)

Fji := Qjij|Cj | - Qij i|Ci|,

Fji = 0

jV F (i)

10

Y. GAO AND J.-G. LIU

then we have the symmetric property

(3.7)

Fij = -Fji, Fij = -Fji.

Next, leveraging the positive numerical steady state , we reformulate the flux Fji using a discrete -symmetric decomposition. Using an elementary identity, we have

(3.8)

Fji =Qjij |Cj | - Qij i|Ci| = Qjij|Cj | + Qij i|Ci| 2

j j

-

i i

+ Qjij|Cj | - Qij i|Ci| 2

j j

+

i i

1 = 2 ij

j j

-

i i

+

1 2

Fji

j j

+

i i

=: Lij + Tij ,

where ij := Qjij|Cj| + Qiji|Ci| = ji > 0 is the symmetric positive coefficients. For the reversible case, ij is known as Onsager matrix. For the irreversible case, we still call it Onsager matrix.
From the row sums zero property for Q-matrix, the natural tangent space of the probability space will be TP := {u  Rn; i ui = 0}. Then from the antisymmetric property, we have

(3.9)

ij
ij

j j

-

i i

= 0,

Fji
ij

j j

+

i i

= 0.

Thus the discrete -symmetric decomposition (3.8) ensures each component in the decomposition still belongs to the tangent space TP .
From stationary equation (3.6) and (2.9), we have

(3.10)

j

Tij =

j

Fji 2

j j

,

i,j

Tij

i i

=

i,j

Fji

j j

i i

= 0.

Therefore the second part Tij in the decomposition has no contribution in the energy dissipation law. Indeed, if the reversible condition (detailed balance) holds, i.e., Qjij|Cj| = Qiji|Ci|, then Tij = 0 and we obtain exactly same energy dissipation law as the irreversible case. However, for the irreversible case, i.e., Qjij|Cj| = Qiji|Ci|, Prigogine characterized the energy transport when the dynamical system reaches the "stationary non-equilibrium state " via the concept of entropy production rate
[Pri68]. Importantly, using Markov chain models in biochemical reactions, Hill gives the following
specific formula for the entropy production rate and call it "the total rate of free energy dissipation"
[Hil05, eq. (9.20)]

(3.11)

kT dS :=
2
i,j

Qij i|Ci| - Qjij|Cj |

log

Qij i|Ci| Qjij|Cj |

>

0.

Apparently, dS = 0 if and only if the detailed balance condition holds (reversible case).

Remark 3.1. Hill derives (3.11) by calculating the change of free energy individually as follows. Denote Gi as the Gibbs free energy at site i. Then the chemical potential at site i at the steady state is

(3.12)

µi = Gi + µM + kT log i.

Here µM is the energy provided by the environment (heat bath in the open system) which probably has different values for different orientations of a circulation in a biochemical reaction. For instance, in a simple Enzyme-substrate-product example [Hil05, Section 9], µM = µS is the chemical potential of the substrate for a positive circulation, while µM = µP is the chemical potential of the product for an opposite circulation. Then by the Arrhenius law, the transition rate from site i to site j is given by

(3.13)

Qij

Gi-Gj +µM

= e , kT

Qji

µM = µS for i = 1, µM = -µP for j = 1.

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

11

This together with (3.12), implies

(3.14)

µi

-

µj

=

kT

log

Qij i Qjij

.

Thus at the steady state, the individual energy change (in the unit of energy per unit time) due to the nonzero flux i  j is always

(3.15)

Fij (µi - µj ) = (Qij i - Qjij ) kT

log

Qij i Qjij

 0.

Adding each sites together and with our notation, we obtain (3.11).

In the following convergence analysis, since D is positive definite, so nij · Dnij  c > 0. Thus for notation simplicity, we now assume Dij = Dij, D > 0 is a scalar constant. From the definition of Q for (2.6),

Fji = |ij |

D (j - i) |yj - yi|

+

(b

·

n)-ij j

-

(b

·

n)+ij i

.

Respectively, the steady flux at site i is

(3.16)

Fji = |ij |

D j - i |yj - yi|

+ (b · n)-ij j - (b · n)+ij i

.

We summarize the discrete energy dissipation law below.

Proposition 3.2. Let i be the solution to (3.5) and i be the solution to (3.6).

(3.17)

d dt

i

2i i

|Ci|

=

-

1 2

i,j

ij

j j

-

i i

2
D -

|ij |(i + j)

2
i,j

|yi - yj|

j j

-

i i

2
 0,

where ij = Qjij|Cj| + Qiji|Ci| = ji > 0. Moreover, we have also

(3.18)

d dt

i

(i

- i)2 i

|Ci|

=

-

1 2

i,j

ij

j j

-

i i

2
D -

|ij |(i + j)

2
i,j

|yi - yj|

2

j j

-

i i

 0,

We remark the 2-divergence energy identity (3.17) always holds with/without detailed balance con-

dition.

Usually

the

dissipation

term

1 2

i,j ij

- j
j

i i

2
is called discrete Dirichlet form.

As a

consequence, the symmetric coefficients for "upwind scheme" is

(3.19)

ij := |ij |

D |yj - yi|

i + j

+ (b · n)+ij i + (b · n)+jij

= ji,

while for "-symmetric upwind scheme" is

(3.20)

ij = |ij |

D(i + j) |yj - yi|

+

|(u

·

n)ij |

= ji.

Proof. Using the definition of Q, direct calculations show ij = Qjij|Cj|+Qiji|Ci| is given by (3.19). From the decomposition (3.8) and (3.10), the discrete energy dissipation law becomes

(3.21)





i

i i

i|Ci|

=

i

i  i

j

1 Fji = - 4 ij
i,j

2

j j

-

i i

 0.

Since  is positive, we have the estimate

(3.22)

ij

>

D |ij |(i + j) . |yj - yi|

12

Y. GAO AND J.-G. LIU

Then (3.21) implies (3.17). Moreover, from conservation of total mass,

(3.23)

i

i i

i|Ci|

=

i

i i

-

1

1d i|Ci| = 2 dt

i

(i

- i)2 i

|Ci|,

so we also conclude (3.18).

We remark that the stability analysis here and in the remaining section also works for the Fokker-Planck equation on non-compact manifold as long as a positive solution to Q = 0 exists. However, there is no general Perron-Frobenius theorem to ensure the existence of (3.3) for a Q-matrix on a countable states.

Remark 3.3. Compared with the -symmetric decomposition in the continuous case (2.14), the gradient flow part in (3.8)

(3.24)

Lij

=

D|ij | |yj - yi|

i

+ 2

j

j j

-

i i

1

+

|yj

-

yi|

(b

·

n)+ij i + (b · n)+jij D(i + j)

has an additional numerical dissipation terms O (|yj - yi|). This numerical dissipation comes from the
upwind discretization. Indeed, without this additional numerical dissipation term, then ti|Ci| = j Lij is exactly the finite volume scheme designed in [GLW20] for reversible case.

Remark 3.4. The famous Scharfetter­Gummel(SG) scheme was first proposed in [SG69] for 1D semiconductor device equation and there are many mathematical analysis and extensions on it, c.f., [MZ88, XZ99] and recently summarized as B-schemes in [CHH20]. We remark it also has the Q-matrix structure and the -symmetric decomposition. Indeed, the finite volume scheme can be reformulated as

(3.25)

d dt i|Ci| =

j

D|ij| B |yj - yi|

1 D (b · n)ij|yj - yi|

j - B

1 D (b · n)ji|yj - yi|

i ;

x Scharfetter­Gummel: B(x) = ex - 1 , x = 0, B(0) = 1;

Upwind scheme: B(x) = 1 + x-.

Since

B(x)

>

0,

then

with

Qji

=

B D|ij |
|yj -yi||Cj |

1 D

(b

·

n)ij

|yj

- yi|

,

we

have

exactly

same

decomposition

as (3.8). Specially, for the reversible case, let  be the potential such that b = - and thus   e-/D.

Take the approximation (b · n)ij|yj - yi|  i - j, then one can directly verify the detailed balance condition for  = e-i/D

Qjij |Cj | =

|ij |

i - j

|yj - yi| ei/D - ej/D

=

|ij | |yj - yi|

(i-1, j-1) -1 = Qij i|Ci|,

where

(x, y) =

x-y log x-log y

is

the

so-called

logarithmic

mean.

Hence

in

(3.8),

Fji

=0

while

the

symmetric

coefficient ij in (3.8) then becomes

ij

=

Qjij |Cj |

=

D|ij | |yj - yi|

1

1

-1

dx ,

0 e-i/D+s(i-j )/D

where the average is the harmonic average of  with linear interpolation for  along edge [yi, yj]; c.f. [MZ88, Mar85]. If replacing the harmonic average above by the arithmetic mean of i and j, then SG scheme becomes our scheme (2.26) in the reversible case, i.e., u = 0 in (2.25).

3.2. Ergodicity. Let Q be the Q-matrix defined in (2.10). Recall the nonnegative irreducible stochastic matrix K defined in (3.1). Recall the right eigenvector e := (1, 1, · · · , 1)T , i.e. Ke = e corresponding to 1 and the left eigenvector, i.e. T K = T due to the Perron-Frobenius theorem for K. We have the
Jordan decomposition for K

(3.26)

K = S 1 0 S-1 = eT + S 0 0 S-1

0J

0J

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

13

where J consists of Jordan blocks with |µi| < 1, i = 2, · · · , n and we used Si1 = ei, S1-j1 = j. Here and in the following context, the vector T is short for T := (1|C1|, · · · , n|Cn|).

Lemma 3.5. Let Q be the Q-matrix defined in (2.10) and t be the solution to (2.7). Given initial data 0, then we have

(3.27)

t - 

1



ce

at 2

(|µ2

|-1)

0

1,

where |µ2| < 1 is the second eigenvalue of Q and a > 0 is the constant in (3.1).

Proof. From the construction for K and the Jordan decomposition in (3.26), we know

(3.28)

Q = a(K - I) = S 0

0

S-1.

0 a(J - I)

Thus (3.29)

eQt = eT + S

00 0 ea(J-I)t

S-1.

Then for the solution t to (2.7), we have

(3.30)

Tt - T = T0 eQt - T = T0 S

00 0 ea(J-I)t

S-1.

Notice J consists of Jordan blocks with |µi| < 1, i = 2, · · · , n, and each Jordan block can be written as the sum of µ I and a nilpotent matrix N . Thus we have eat(J -I) = eat(µ -1)eatN and eatN 1  ctn-2.
Therefore, combining (3.30) with

ea(J -I )t

1



ctn-2eat(|µ2|-1)



ce , at(|µ2|-1) 2

we conclude (3.27).

Another proof for the ergodicity is using the following discrete mean Poincare's inequality [EGH00, Lemma 10.2]. As a consequence, the exponential decay rate will not depend on the data size n.

Lemma 3.6 ([EGH00]). Assume i uii|Ci| = 0, then we have the discrete mean Poincare inequality

(3.31)

i

u2i i|Ci|  c
i,j

|ij |(i |yi -

+ j) yj |

(ui

-

uj

)2

.

Using

(3.18)

in

Proposition

3.2

and

then

taking

ui

=

i i

-

1

in

Lemma

3.6,

we

have

(3.32)

d dt

i

(i

- i)2 i

|Ci|



-

D 2

i,j

|ij |(i + j ) |yi - yj|

j - i j i

2
 -c

i

(i

- i

)2

|Ci

|.

This implies the exponential decay in 2-divergence

(3.33)

i

(i

- i)2 i

|Ci|



e-ct

i

(i

(0) - i

i

)2

|Ci|.

3.3. Unconditionally stable explicit scheme. Although there is no detailed balance property, we

will use a mixed explicit-implicit time discretization to design an unconditionally stable explicit scheme

for (2.7), which enjoys a new stochastic-matrix structure.

Let ki |Ci| be the discrete density at the discrete time kt. Recall the constant a > 0 and nonnegative

irreducible

matrix

K

=

Q a

+I

defined

in

(3.1).

Introduce

the

mixed

explicit-implicit

scheme

as

(3.34)

ki +1|Ci| - ki |Ci| = at Kjikj |Cj | - ki +1|Ci| , i = 1, 2, · · · , n.
j

14

Y. GAO AND J.-G. LIU

Now we recast it as a new discrete Markov chain with a transition probability K~ , which is unconditionally stable and enjoys fast convergence to the same steady state . Rewrite (3.34) as

(3.35)

(1 + at)ki +1|Ci| = at Kjikj |Cj| + ki |Ci| = t Qjikj |Cj| + (1 + at)ki |Ci|,

j

j

then we obtain a new Markov semigroup

(3.36)

ki +1|Ci|

=

t 1 + at

Qjikj |Cj | + ki |Ci| =:

K~jikj |Cj |

j

j

It is easy to verify

(3.37)

K~ = t Q + I =: tQ~ + I 1 + at

is a Markov semigroup operator and  being its positive invariant measure. Indeed, since

K~ =

at

Q + I,

at < 1,

1 + at a

1 + at

we know K~ is always nonnegative, irreducible, aperiodic matrix and obtain the right eigenvector e := (1, 1, · · · , 1)T , i.e. K~ e = e corresponding to 1 and the left eigenvector, i.e. T K~ = T . From the Perron-Frobenius theorem, we have the Jordan decomposition for K~

(3.38)

K~ = S 1 0 S-1 = eT + S 0 0 S-1,

0J

0J

where J consists of Jordan blocks with K~ 's eigenvalues |µi| < 1, i = 2, · · · , n and we used Si1 = ei, S1-j1 = j .
Therefore, thanks to Q~-matrix, the explicit scheme (3.36) still enjoys good properties such as positive
preserving, total mass preserving. Particularly, we give the following proposition for the unconditional 1-contraction and ergodicity.

Proposition 3.7. Let t be the time step and let k be the solution to the explicit scheme (3.36). Then we have
(i) the 1 contraction, i.e., for any two solutions k, ~k,

(3.39)

|ki +1 - ~ki +1||Ci|  |ni - ~ni ||Ci|;

i

i

(ii) the exponential convergence

(3.40)

k -  1  c 0 1 |µ2|k-n+2, |µ2| < 1,

where

µ2

is

the

second

eigenvalue

(in

terms

of

the

magnitude)

of

K~

=

I

+

t

Q 1+at

.

Proof. First, let  and ~ be two solutions to (3.36). Denote eki = ki - ~ki . Then (3.36) becomes

(3.41)

eki +1|Ci|

=

1

t + at

Qij ekj |Cj | + eki |Ci|.

j

Then take absolute value and summation in i to show that

(3.42)

|eni +1||Ci|



1

t + at

Qij |ekj ||Cj | +

|eki ||Ci| =

|eki ||Ci|.

i

i,j

i

i

Second, (3.36) and the Jordan decomposition (3.38) yield

(3.43)

(k - )T = T0 K~ k - T = T0 S

00 0 Jn

S-1.

Then from J n 1  c|µ2|k-n+2 and K~ 's second eigenvalue |µ2| < 1, we conclude

(3.44)

k -  1  c 0 1 |µ2|k-n+2.

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

15

The advantage of this mixed implicit-explicit scheme (3.34) is that the Markov semigroup is always positive no matter how larger t is. However, when t becomes large, the spectral gap 1 - |µ2| becomes small.

4. Convergence and error estimates
In this section, we present convergence and error estimates for the upwind scheme (2.6) including error estimates for numerical steady state solution i and the numerical dynamic solution i(t). The estimates relies on the Taylor expansion along geodesic between each cell center and the discrete energy dissipation in Proposition 3.2. Same procedures can be done for -symmetric upwind scheme and will be omitted.

4.1. Error estimate for steady state . Let (y) be the exact solution to stationary Fokker-Planck
equation (2.13) and let i be the numerical solution satisfying (3.6). In this section, for notation simplicity, we denote i as the numerical steady state i. Plug the exact solution (y) into the numerical scheme and we estimate

(4.1)

ji :=

n · (D - b) dHd-1 - Fjiex ,

ij

where n is the restriction of the unit outward normal vector field on ij. Let ei := i - (yi) be the error between the numerical steady state and the exact steady state. Then we have

(4.2)

Fjei := Fji - Fjiex = |ij |

Fjei =

ji.

j

j

D (ej - ei) |yj - yi|

+

(b

·

n)-ij ej

-

(b

·

n)+ij ei

= -Fiej ,

Proposition 4.1. Let ei := i - (yi) be the error between the numerical steady state i and the exact steady state (yi). Assume the Vonoroi tessellation satisfies

(4.3)

|ij||yj - yi|  c.
i jV F (i)

Then we have (4.4)

i

e2i i

|Ci|



c

i,j

|ij | |yj - yi|

ej - ei

2
 ch2.

j i

Proof. Step 1. Estimates for truncation error ji. Let Gij be the bisector between yi and yj, which is a d - 1 submanifold containing ij. Suppose y is
the intersection point of the geodesic from yi to yj and Gij. We have dN (y, yi) = dN (y, yj). Notice
the unit tangent vector of the geodesic at y is perpendicular to ij at y and can be chosen as the unit normal nij(y)3. From the Taylor expansion of  along the geodesic, we have

(4.5) (4.6)

(yj) - (y) = nij · (y)dN (y, yj) + O(d2N (y, yj)), (y) - (yi) = nij · (y)dN (y, yi) + O(d2N (y, yi)).

Therefore, if we add the above two equations , we have

(4.7) Hence,

(yj) - (yi) = nij · (y)dN (yi, yj) + O(d2N (yi, yj)).

(4.8)

nij

·

(y)

=

(yj) - (yi) dN (yi, yj )

+

O(dN (yi, yj))

=

(yj) - (yi) |yi - yj|

+

O(dN (yi, yj)),

3on the d - 1 dimensional submanifold containing ij

16

Y. GAO AND J.-G. LIU

where we used |yi - yj| = dN (yi, yj) + o(dN (yi, yj)) for dN (yi, yj) small enough. Similarly,

(4.9)

(yj) - (y) = O(dN (y, yj)),

(4.10)

(y) - (yi) = O(dN (y, yi)).

Hence we have

(4.11)

-(b · n)+ij + (b · n)-ij (y) = -(b · n)+ij(yi) + (b · n)-ij(yj) + O(dN (yi, yj)).

Thus if y is changes to any y on ij,

O(dN (yi, y) + dN (yi, yj)) = O(diam(Ci) + dN (yi, yj))  O(h),

where

(4.12)

h := max max (diam(Ci)), max ( max dN (yi, yj)) .

i=1,...,n

i=1,...,n jV F (i)

This, together with (4.8) and (4.11), we conclude

(4.13)

ij  ch|ij |.

Step 2. H1 estimates via anti-symmetric structure. Using same derivations as Proposition 3.2, we have

(4.14)





i

ei 
i

j

Fjei

=

-

1 2

ij

i,j

ej - ei

2
,

j i

where ij defined in (3.19). And thus (4.2) implies

(4.15)





i

ei 
i

j

Fjei =

i,j

ji

ei i

=

1 2

i,j

ji

ei - ej i j

.

Then combining this with (4.14) and Young's inequality, we know

(4.16)

ij
i,j

ej - ei j i

2
= - ji
i,j

ei - ej i j

1

 2

ij

i,j

ei - ej i j

21 +

(ji)2 .

2
i,j

ij

Then by (4.13) and (3.22), we conclude

(4.17)

ij
i,j

ej - ei j i

2


i,j

(ji)2 ij

 ch2

i,j

|ij||yj - yi|  ch2.

Moreover, since (4.18)

i ei|Ci| = 0,

we

take

ui

=

ei i

in

Lemma

3.6

to

obtain

i

e2i i

|Ci|



c

i,j

ij

ej - ei

2
 ch2.

j i

This, together with the definition of ij in (3.19), concludes (4.4).

4.2. Convergence of dynamic solution in 2-discrepancy. Let t(y) be the exact solution to (1.2). Let ei(t) := t(yi) - i(t) be the error between the exact solution and the numerical solution. Now for any fixed T > 0, we give the convergence result in terms of the 2-discrepancy between the exact solution
and the numerical solution.

Theorem 4.2. Let ei(t) := i(t) - t(yi) be the error between the numerical solution i(t) and the exact steady state t(yi). Assume the Vonoroi tessellation satisfies (4.3), then for any T > 0 and h defined in (4.12), we have

(4.19)

max
t[0,T ]

i

ei(t)2 i

|Ci

|



i

ei

(0)2 i

|Ci|

+

O(h2)

eT .

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

17

Proof.

Let

ei

:=

1 |Ci |

Ci  dy be the cell average. Plug the exact solution into the numerical scheme

(4.20)

t(ei |Ci|) =

Fjeix +

ji,

jV F (i)

jV F (i)

ji :=

n · (D - b) dHd-1 - Fjeix,

ij

where n is the restriction of the unit outward normal vector field on ij and

(4.21)

Fjeix

:=

1 2 ij

(yj) - (yi)

j

i

+ Fji 2

(yi) + (yj)

i

j

with ij defined in (3.19). Exchanging i, j above, we see both ji and Fjeix are anti-symmetric. Subtracting the numerical scheme (2.6) from (4.20), we have

(4.22)

d dt ei|Ci| =

ij 2

jV F (i)

ej - ei j i

+ Fji 2

ei + ej i j

+

ji + t((yi) - ei )|Ci|.

jV F (i)

Similar

to the

derivation

of

dissipation

relation

(3.17),

we

multiply

this

by

2ei i

and

use

(3.6)

to

show

that

(4.23)

d dt

i

e2i i

|Ci|

=

-

i,j

ij 2

ej - ei j i

2
+ ji
i,j

ei - ej i j

+

i

2t((yi

)

-

ei )|Ci|

ei i

,

due to ij = -ji. Applying Young's inequality to the last two terms, we have

(4.24)

ji
i,j

ei - ej i j



ij

4

i,j

ej - ei

2
+

2ji ;

j i

i jV F (i) ij

i

2t((yi)

-

ei )|Ci|

ei i



i

[t((yi)

-

ei )]2

|Ci| i

+

i

e2i i

|Ci|.

Thus we have (4.25)

d dt

i

ei(t)2 i

|Ci

|



i,j

2ji + ij

i

[t((yi)

-

ei )]2

|Ci| i

+

i

e2i i

|Ci|.

The estimates for ji and t((yi) - ei ) using Taylor expansion on manifold are same as (4.13). From (4.13) and (3.22), we have

(4.26)

2ji ij

 ch2|yj

- yi||ij|.

From the assumption (4.3), we know

(4.27)

2ji  ch2. i,j ij

By Gronwall's inequality, we obtain for any T > 0,

(4.28)

max
t[0,T ]

i

ei(t)2 i

|Ci|



i

ei(0)2 i

|Ci

|

+

O(h2

)

eT .

18

Y. GAO AND J.-G. LIU

Figure 1. The normalized initial density (left) and the target density: smiling triple banana (right).

5. Numerical examples
In this section, we demonstrate three examples based on two upwind schemes developed in Section 2. Section 5.1 focus on the case that we know information of an invariant measure . In realistic situations, knowing the output of  from a computer code instead of an analytic formula is enough. In this case, we use -symmetric upwind scheme (2.26) to conduct two interesting applications: (i) efficient sampling enhanced by an incompressible mixture flow (ii) image transformations immersed in a mixture flow. Section 5.2 focus on the case we only know the drift vector field b in the irreversible drift-diffusion process (1.4) and we adapt the numerical scheme (2.6) to solve both a steady state solution and simulate the irreversible dynamics. The -symmetric upwind scheme (A.8) and upwind scheme (A.15) for a 2D structured grids case with no-flux boundary conditions are given in Appendix A.1 and Appendix A.2 for completeness.

5.1. Simulations for irreversible dynamics given an invariant measure. In this section, assume we know the output of an invariant measure , which could be a steady state in a biochemical process, or a given target density function in sampling, or given images. We will use -symmetric upwind scheme (2.26) for a 2D structured grids to demonstrate two examples.

5.1.1. Example: Sampling enhanced by an incompressible mixture flow. Take 2D domain as  = [a, b] × [c, d] = [-4.5, 4.5] × [-4.5, 4.5]. Choose the stream function for a 2D sinusoidal cellular flow

(5.1)

k(x - a) k(y - c)

(x, y) := A sin

sin

,

b-a

d-c

where A represents the amplitude of the mixture velocity u and k is the normalized wave number of the

mixture. Then the incompressible velocity field u =

-y  x

can be discretized using (2.36).

Now we use (2.38), i.e., (A.8) for 2D structured grids, to sample a given target density: a smiling

triple-banana in (5.2). Based on the Laplace principle, we can use the smooth minimum method to

construct a smiling triple-banana as a target density

(5.2)

(x, y) e-20

(x-

6 5

)2

+(y-

6 5

)2

-

1 2

2
+log

e-10(y-2)2

+ e ( ) ( ) -20

x+

6 5

2+

y-

6 5

2

-

1 2

2
+log

e-10(y-2)2

+ e ( ) -20 x2+y2-2 2+log e-10(y+1)2 + 0.1;

see Fig.1(right). Then we take a Gaussian mixture

(5.3)

0(x, y)  e-16(x+3)2-4y2 + e-16(x-3)2-4y2 + e-4x2-16(y+3)2 + e-4x2-16(y-3)2 + 0.1

as an initial density; see Fig.1(left). Set the computational parameters as diffusion constant D = 0.5,

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

19

Figure 2. The time evolution of dynamic solution for sampling the smiling triple banana using (2.38). The amplitude of the mixture velocity is A = 0.1 and snapshots are shown at iterations nt = 50, 200, 1200, 10000.
time step t = 0.01, uniform grid size x = y = 0.09. Then with the amplitude of the mixture velocity A = 0.1 and the frequency k = 8, the time evolution of dynamic density t is shown at time iteration nt = 50, 200, 1200, 10000 in Fig.2. Moreover, the relative root mean square error between the dynamic solution t and the target density  are shown w.r.t time iterations using semilog plot in Fig.3 with different amplitude of the mixture velocity A = 0 and 0.1. Notice if A = 0, then the Fokker-Planck equation (2.14) and the corresponding upwind scheme (2.38) are reduced to the reversible case, i.e., we only have the gradient flow part in (2.14). The corresponding Q-matrix for the reversible case (u = 0) of course also leads to an efficient sampling for the target density. However, the additional incompressible convection with larger mixture velocity u, although makes the dynamics irreversible, can speed up the convergence to the target density function. This observation is shown in the semilog plot in Fig.3 for the decay of the relative root mean square error with amplitude A = 0.1, compared with A = 0. The enhanced convergence and diffusion by a mixture velocity filed is a classical topic in the fluid dynamics and PDE analysis [FP94, CKRZ08]. This technique has a promising applications in sampling, Markov chain Monte Carlo and non-convex optimizations. We will leave this line of research as a future study.
5.1.2. Example: image transformation immersed in an incompressible flow. In this example, we use van Gogh's `The Starry Night' to simulate an image immersed in an irreversible dynamics but still converge to a given target image. Choose an initial image with the same village view but with a purely blue sky, as shown in Fig.4(left). The target image `The Starry Night' is shown in Fig.4(right). Each matrix exacted from these two images contains values of a color mode (R or G or B) and are both N = 256 pixels in width and M = 203 pixels in height.

20

Y. GAO AND J.-G. LIU

10-2

amp0.1 amp0

10-3

Root Mean Square Errors

10-4

10-5 0

1000

2000

3000

4000

5000

6000

Time Iteration

7000

8000

9000

10000

Figure 3. The relative root mean square error between the dynamic density and the target triple banana density is shown in semilog plot w.r.t time iterations. With different amplitude A = 0, 0.1, 0.2, we observe the enhancement of convergence brought by the incompressible mixture velocity u.

0

Figure 4. The initial image (left) and the target image: The Starry Night(right).

Set the computational parameters as diffusion constant D = 0.4, time step t = 0.01, uniform grid size

x

=

 N

,

y

=

 M

.

Then

with

the

amplitude

of

the

mixture

velocity

A

=

1000

and

the

normalized

wave

number k = 8, the time evolution of dynamic density t is shown at time iteration nt = 5, 80, 400, 2000

in Fig.5. Starting from a purely blue sky, we can see the night sky immersed in the incompressible flow,

which is discretized using (2.36) with (5.1), becomes starry, unbalanced and distorted. At nt = 2000,

the image is very close to the target image while the more unbalanced inbetweening image is shown

at nt = 400. Moreover, the relative root mean square error between the dynamic solution t and the

target density  are shown w.r.t time iterations using semilog plot in Fig.6. We still observe that larger

amplitude of the mixture velocity has an enhancement for the convergence of dynamic solution to its

steady state.

5.2. Simulations for general irreversible dynamics without information of invariant measure. In this section, assume in irreversible drift-diffusion process (1.4), we only know the drift vector field b. Then we use the upwind scheme (2.6) in 2D structured grids to simulate a stochastic Van der Pol oscillator.

5.2.1. Example: Stochastic Van der Pol oscillator model. The famous Van der Pol model is first proposed by Van der Pol to describe electrical circuit and also has numerous extended applications in biology, pharmacology and seismology. For instance the FitzHugh-Nagumo model describing the excitation and

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

21

nt = 5

nt = 80

nt = 400

nt = 2000

Figure 5. The time evolution of image transformations immersed in an incompressible flow using scheme (2.38). The amplitude of the mixture velocity is A = 1000 and snapshots are shown at iterations nt = 5, 80, 400, 2000.
amp20 amp200 amp1000
10-3

Root Mean Square Errors

10-4

0

0.5

1

1.5

2

2.5

3

Time Iteration

104

Figure 6. The relative root mean square error between the dynamic image in blue colormodes and the target image is shown in semilog plot w.r.t time iterations. Enhanced convergence is shown with different amplitude A = 20, 200, 1000.

22

Y. GAO AND J.-G. LIU

propagation of sodium and potassium ions in a neuron [IF06]. There are lots of classical investigations

on the limit circle, bifurcations and chaos on this model; c.f. [VG01].

To illustrate our numerical scheme for the irreversible dynamics without steady state information,

consider a stochastic version of Van der Pol oscillator model

(5.4)

x3



dx = (x - + y) dt + 2 dB;

3



dy = ( - x) dt + 2 dB

with a set of classical parameters  = 10 and  = 0 or  = 1. After adding the Brownian motion with  > 0, this is a typical example which can be decomposed as a gradient flow part and a Hamiltonian part.
The corresponding Fokker-Planck equation is

(5.5)

t =  · ( - b) ;

x3 b = (x - + y), ( - x) .
3

We take domain as  = [-3, 4] × [-3, 3], noise level as  = 0.1, computational parameters as t = 0.05, x = 0.07, y = 0.06 and take the no-flux boundary condition (A.13). Then based on (3.35) (i.e., (A.15)), starting from the initial density 0 = 0.2, we compute the time evolution of the density function t.
With parameter  = 0, the numerical solution at time iteration nt = 1000, 5000, 40000 are shown in Fig 7. Meanwhile, the numerical steady state  is computed by setting the time iteration as nt = 200000, because in Proposition 4.1 we have proved the exponential ergodicity for the unconditionally explicit scheme (3.36). The root mean square error between the numerical solution t and the numerical steady state  is shown in the semilog plot in Fig 7(downright) in terms of time iterations. We can see for  = 0, the steady state density tends to concentrate near a large limit circle in Fig 7 (downleft), which is the stable limit circle for the deterministic Van der Pol oscillator in the large damping regime (a.k.a. relaxation oscillation).
As a comparison, with different parameter  = 1, the numerical solution at time iteration nt = 1000, 5000, 40000 are shown in Fig 8. The root mean square error between the numerical solution  and the numerical steady state  is shown in the semilog plot in Fig 8(downright), where the numerical steady state is still obtained by setting the time iteration as nt = 200000. We can see clearly the steady state density now concentrates near a smaller region in Fig 8(downleft). Indeed, this small region is near another smaller limit circle for the deterministic Van der Pol oscillator, but due to the random noise, the steady state density does not exactly concentrate only on the smaller limit circle.

Acknowledgements The author Jian-Guo Liu was supported in part by NSF under award DMS-1812573 and DMS-2106988.

References
[BC12] Marianne Bessemoulin-Chatard. A finite volume scheme for convection­diffusion equations with nonlinear diffusion derived from the scharfetter­gummel scheme. Numerische Mathematik, 121(4):637­670, 2012.
[BCJC98] Randolph E Bank, WM Coughran Jr, and Lawrence C Cowsar. The finite volume scharfetter-gummel method for steady convection diffusion equations. Computing and Visualization in Science, 1(3):123­136, 1998.
[Che00] Mu-Fa Chen. Equivalence of exponential ergodicity and l2-exponential convergence for markov chains. Stochastic Processes and their Applications, 87(2):281­297, Jun 2000.
[CHH20] Claire Chainais-Hillairet and Maxime Herda. Large-time behaviour of a family of finite volume schemes for boundary-driven convection­diffusion equations. IMA Journal of Numerical Analysis, 40(4):2473­2504, 2020.
[CHLP03] Claire Chainais-Hillairet, Jian-Guo Liu, and Yue-Jun Peng. Finite volume scheme for multi-dimensional drift-diffusion equations and convergence analysis. ESAIM: Mathematical Modelling and Numerical AnalysisMod´elisation Math´ematique et Analyse Num´erique, 37(2):319­338, 2003.
[CKL+08] R. R. Coifman, I. G. Kevrekidis, S. Lafon, M. Maggioni, and B. Nadler. Diffusion maps, reduction coordinates, and low dimensional representation of stochastic systems. Multiscale Modeling & Simulation, 7(2):842­864, 2008.
[CKRZ08] Peter Constantin, Alexander Kiselev, Lenya Ryzhik, and Andrej Zlatos. Diffusion and mixing in fluid flow. Annals of Mathematics, pages 643­674, 2008.

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

23

nt = 1000

nt = 5000

nt = 40000

10 -2 10 -3

Root Mean Square Errors

10 -4

10 -5

10 -6

10 -7

10 -8

0

0.5

1

1.5

2

2.5

3

3.5

4

Time Iteration

10 4

Figure 7. The time evolution of density function to (5.5) with  = 0. At time iteration
nt = 40000, the steady state tends to concentrate near the larger limit circle (downleft). The root mean square error between the numerical solution t and the numerical steady state  is shown in the semilog plot (downright).

[EGH00] Robert Eymard, Thierry Gallou¨et, and Rapha`ele Herbin. Finite volume methods. Handbook of numerical analysis, 7:713­1018, 2000.
[EL96] Weinan E and Jian-Guo Liu. Vorticity boundary condition and related issues for finite difference schemes. Journal of computational physics, 124(2):368­382, 1996.
[FK06] Jin Feng and Thomas G Kurtz. Large deviations for stochastic processes. Number 131. American Mathematical Soc., 2006.
[FP94] Albert Fannjiang and George Papanicolaou. Convection enhanced diffusion for periodic flows. SIAM Journal on Applied Mathematics, 54(2):333­408, 1994.
[GLL21] Yuan Gao, Jian-Guo Liu, and Zibu Liu. Some remarks on reversibility and linear response theory. in preparation, 2021.
[GLLL20] Yuan Gao, Tiejun Li, Xiaoguang Li, and Jian-Guo Liu. Transition path theory for langevin dynamics on manifold: optimal control and data-driven solver. arXiv preprint arXiv:2010.09988, 2020.
[GLW20] Yuan Gao, Jian-Guo Liu, and Nan Wu. Data-driven efficient solvers and predictions of conformational transitions for langevin dynamics on manifold in high dimensions. arXiv preprint arXiv:2005.12787, 2020.
[Hil05] T.L. Hill. Free Energy Transduction and Biochemical Cycle Kinetics. Dover Books on Chemistry. Dover Publications, 2005.
[Hsu02] Elton P Hsu. Stochastic analysis on manifolds, volume 38. American Mathematical Soc., 2002. [IF06] E. M. Izhikevich and R. FitzHugh. FitzHugh-Nagumo model. Scholarpedia, 1(9):1349, 2006. [IW81] Nobuyuki Ikeda and Shinzo Watanabe. Stochastic differential equations and diffusion processes. Amsterdam:
North-Holland Pub. Co., 1981. [Lig10] Thomas Milton Liggett. Continuous time Markov processes: an introduction, volume 113. American Mathemat-
ical Soc., 2010. [LS00] Jian-Guo Liu and Chi-Wang Shu. A high-order discontinuous galerkin method for 2d incompressible flows.
Journal of Computational Physics, 160(2):577­596, 2000. [Mar85] Peter A Markowich. The stationary semiconductor device equations. Springer Science & Business Media, 1985.

24

Y. GAO AND J.-G. LIU

nt = 1000

nt = 5000

nt = 40000

10 -3

Root Mean Square Errors

10 -4

10 -5

0

0.5

1

1.5

2

2.5

3

3.5

4

Time Iteration

10 4

Figure 8. The time evolution of density function to (5.5) with  = 1. The steady state tends to concentrate near the smaller limit circle (downleft). In terms of time iterations, the root mean square error between the numerical solution  and the numerical steady state  is shown in the semilog plot (downright).

[MRP14]
[MZ88] [Ons31] [Pri68] [QQT02] [SG69] [TS15] [VG01] [XZ99]

Alexander Mielke, D. R. Michiel Renger, and Mark A. Peletier. On the relation between gradient flows and the large-deviation principle, with applications to markov chains and diffusion. Potential Analysis, 41(4):1293­1327, Nov 2014. Peter A Markowich and Milos A Zl´amal. Inverse-average-type finite element discretizations of selfadjoint secondorder elliptic problems. Mathematics of computation, 51(184):431­449, 1988. Lars Onsager. Reciprocal relations in irreversible processes. i. Phys. Rev., 37:405­426, Feb 1931. I. Prigogine. Introduction to Thermodynamics of Irreversible Processes. Wiley, 1968. Hong Qian, Min Qian, and Xiang Tang. Thermodynamics of the general diffusion process: time-reversibility and entropy production. Journal of statistical physics, 107(5):1129­1141, 2002. Donald L Scharfetter and Hermann K Gummel. Large-signal analysis of a silicon read diode oscillator. IEEE Transactions on electron devices, 16(1):64­77, 1969. Nicol´as Garcia Trillos and Dejan Slepcev. On the rate of convergence of empirical measures in -transportation distance. Canadian J. Math., 67(6):1358­1383, 2015. Subbarao Varigonda and Tryphon T Georgiou. Dynamics of relay relaxation oscillators. IEEE Transactions on automatic control, 46(1):65­77, 2001. Jinchao Xu and Ludmil Zikatanov. A monotone finite element scheme for convection-diffusion equations. Mathematics of Computation, 68(228):1429­1446, 1999.

Appendix A. Finite volume scheme for 2D structured grids
A.1. -symmetric upwind scheme in 2D with a given invariant measure. After choosing u satisfying (2.36), we use (2.38) to present the -symmetric upwind scheme in a structured 2D domain  := [a, b] × [c, d].

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

25

(i) Define the rectangle cells as

(A.1)

Cij = ((i - 1)x, ix) × ((j - 1)y, jy), i = 1, · · · , N, j = 1, · · · , M.

Denote the approximated density on Cij as i,j; Denote the cell centers (xi, yj) as

(A.2)

1

1

xi

=

a

+

(i

-

)x, 2

yj

=

c

+

(j

-

)y, 2

i = 1, · · · , N, j = 1, · · · , M ;

(ii) Denote the discrete drift (u · n)i,j|i.j| of cell Cij on each (right/left/up/down) faces ij along outer normal n as

(u

·

n)Ri,j y

=

(xi

+

x ,
2

yj

+

y )
2

-

(xi

+

x ,
2

yj

-

y ),
2

(u

·

n)Li,j y

=

(xi

-

x ,
2

yj

-

y )
2

-

(xi

-

x ,
2

yj

+

y ),
2

(u

·

n)Ui,j x

=

(xi

-

x ,
2

yj

+

y )
2

-

(xi

+

x ,
2

yj

+

y ),
2

(u

·

n)Di,j x

=

(xi

+

x ,
2

yj

-

y )
2

-

(xi

-

x ,
2

yj

-

y ).
2

(iii) Based on (2.38), using the negative part of the discrete drift above, define the inward flux F into

cell Cij from four cell faces (right/left/up/down) ij as

(A.3)

FiR,j = y FiL,j = y FiU,j = x FiD,j = x

D(i+1,j + 2x

i,j )

+

(u

·

n)Ri,j-

D(i-1,j + 2x

i,j )

+

(u

·

n)Li,j-

D(i,j+1 + 2y

i,j )

+

(u

·

n)Ui,j-

D(i,j-1 + 2y

i,j )

+

(u

·

n)Di,j-

i+1,j - i,j i+1,j i,j i-1,j - i,j i-1,j i,j i,j+1 - i,j i,j+1 i,j i,j-1 - i,j i,j+1 i,j

, , i = 2, · · · , N - 1, j = 1, · · · , M ; , , i = 1, · · · , N, j = 2, · · · , M - 1.

(iv) Impose the no-flux boundary condition

(A.4)

F1L,j = FNR,j = 0, j = 1, · · · , M ; FiD,1 = FiU,M = 0, i = 1, · · · , N.

Then the continuous-time finite volume scheme is

(A.5)

i,j xy = FiR,j + FiL,j + FiU,j + FiD,j

for i = 1, · · · , N, j = 1, · · · , M with the no-flux boundary condition (A.4). Here i,j refers to the time

derivative

of

i,j .

Denote

gi,j

:=

. i,j
i,j

Recast

(A.5)

as

a

five-point

scheme

1 i,j gi,j = x2

D(i+1,j 2

+

i,j )

+

x(u

·

n)Ri,j-

1 gi+1,j + x2

D(i-1,j 2

+

i,j )

+

x(u

·

n)Li,j-

gi-1,j

1 + y2

D(i,j+1 2

+

i,j )

+

y(u

·

n)Ui,j-

1 gi,j+1 + y2

D(i,j-1 2

+

i,j )

+

y(u

·

n)Di,j-

gi,j-1 - i,j gi,j ,

i,j

:=

D(i+1,j

+ 2i,j 2x2

+ i-1,j )

+

D(i,j+1

+ 2i,j 2y2

+ i,j-1)

+

(u · n)Ri,j- + (u · n)Li,j- x

+

(u · n)Ui,j- + (u · n)Di,j- . y

Following the idea for the unconditionally stable explicit scheme (3.35), choose constant a > max i,j . i,j i,j
Using constant a > 0, we can construct an unconditionally stable explicit scheme, which can be regarded as a new Markov chain with a transition probability K~ . With Q defined in (2.28), the time descretization

is

(A.6)

k+1 - k = Qk + a(k - k+1). t

26

Y. GAO AND J.-G. LIU

Thus the transition probability K~  is given by

(A.7)

k+1 = K~ k, K~  := I + tQ , 1 + at

K~ij = 1, K~ij  0.

j

Notice we have chosen u satisfying (2.35) and thus the equivalent flux Fji in (2.38) still defines a stochastic

Q-matrix.

With

the

notation

gi,j

=

, i,j
i,j

(A.7)

reads

as

three

parts:

interiors,

four

sides,

and

four

corners.

For interior cells i = 2, · · · , N - 1, j = 2, · · · , M - 1:

(A.8)

ki,+j 1

=

(1

+

t at)x2

t + (1 + at)x2

t + (1 + at)y2

t + (1 + at)y2

D(i+1,j 2

+

i,j )

+

x(u

·

n)Ri,j-

gik+1,j

D(i-1,j 2

+

i,j )

+

x(u

·

n)Li,j-

gik-1,j

D(i,j+1 2

+

i,j )

+

y(u

·

n)Ui,j-

gik,j+1

D(i,j-1 2

+

i,j )

+

y(u

·

n)Di,j-

gik,j-1

+

i,j

+

t(ai,j - 1 + at

i,j ) gik,j .

For left side cells i = 1, j = 2, · · · , M - 1:

(A.9)

k1,+j 1

=

(1

+

t at)x2

D(2,j + 2

1,j )

+

x(u

·

n)R1,-j

g2k,j

t + (1 + at)y2

D(1,j+1 2

+

1,j )

+

y(u

·

n)U1,-j

g1k,j+1

t + (1 + at)y2

D (1,j-1 + 2

1,j )

+

y(u

·

n)D1,j-

g1k,j-1

+

1,j

+

t(a1,j - 1 + at

1,j ) g1k,j ,

1,j

:=

D(2,j + 1,j ) 2x2

+

D(1,j+1

+ 21,j 2y2

+ 1,j-1)

+

(u · n)R1,-j x

+

(u · n)U1,-j + (u y

· n)D1,j- .

Similar for the right, down and up side cells. For left-down corner cell i = 1, j = 1:

(A.10)

k1,+11

=

(1

+

t at)x2

D(2,1 + 2

1,1)

+

x(u

·

n)R1,-1

g2k,1

t + (1 + at)y2

D(1,2 + 2

1,1)

+

y(u

·

n)U1,-1

g1k,2

+

1,1

+

t(a1,1 - 1 + at

1,1) g1k,1

1,1

:=

D(2,1 + 1,1) 2x2

+

D(1,2 + 1,1) 2y2

+

(u · n)R1,-1 x

+

(u · n)U1,-1 . y

Similar for the left-up, right-down and right-up corner cells.

A.2. Upwind scheme in 2D for general irreversible process. Take a 2D domain as  := [a, b]×[c, d].

We present the upwind scheme (2.6) based on structured grids for a Fokker-Planck equation on the 2D

domain

.

Let

the

grid

size

be

x

=

b-a N

,

y

=

d-c M

.

(i) Define the rectangle cells and cell centers as (A.1), and (A.2).

(ii) Denote the drift b =: (u, v) of cell Cij on the bisection point on edges as

(A.11)

1

1

ui±

1 2

,j

=

u(xi

±

2 x, yj),

vi,j±

1 2

= v(xi, yj

±

y); 2

UPWIND SCHEMES FOR IRREVERSIBLE DRIFT-DIFFUSION PROCESS

27

(iii) Based on (2.6), define the inward flux F into cell Cij from four cell faces as

(A.12)

FiR,j = y FiL,j = y FiU,j = x FiD,j = x

D(i+1,j - x

i,j )

+

u-i+

1 2

,j

i+1,j

-

u+i+

1 2

,j

i,j

,

D(i-1,j - x

i,j )

+

u+i-

1 2

,j

i-1,j

-

u-i-

1 2

,j

i,j

, i = 2, · · · , N - 1, j = 1, · · · , M ;

D(i,j+1 - y

i,j )

+

vi-,j

+

1 2

i,j+1

-

vi+,j

+

1 2

i,j

,

D(i,j-1 - y

i,j )

+

v+
i,j

-

1 2

j

i,j-1

-

v-
i,j-

1 2

i,j

, i = 1, · · · , N, j = 2, · · · , M - 1.

(iv) Impose the no-flux boundary condition

(A.13)

F1L,j = FNR,j = 0, j = 1, · · · , M ; FiD,1 = FiU,M = 0, i = 1, · · · , N.

Then the continuous-time finite volume scheme is

(A.14)

i,j xy = FiR,j + FiL,j + FiU,j + FiD,j

for i = 1, · · · , N, j = 1, · · · , M with the no-flux boundary condition (A.13). Here i,j refers to the time derivative of i,j. Recast (A.14) as a five-point scheme

1 i,j = x2

D

+

xu-i+

1 2

,j

1 i+1,j + x2

D

+

xu+i-

1 2

,j

i-1,j

1 + y2

D

+

yvi-,j+

1 2

1 i,j+1 + y2

D

+

yvi+,j-

1 2

i,j-1 - i,j i,j ,

i,j

:=

2D x2

+

2D y2

+

u+i+

1 2

,j

+

u-i-

1 2

,j

x

+

vi+,j

+

1 2

+

vi-,j-

1 2

y

.

Following the unconditionally stable explicit scheme (3.35), define a := maxi,j i,j. Then (3.35) reads as three parts: interiors, four sides, and four corners.

For interior cells i = 2, · · · , N - 1, j = 2, · · · , M - 1:

(A.15)

ki,+j 1

=

(1

+

t at)x2

D

+

xu-i+

1 2

,j

ki+1,j

+

(1

+

t at)x2

D

+

xu+i-

1 2

,j

ki-1,j

t + (1 + at)y2

D

+

yvi-,j+

1 2

ki,j+1

+

(1

+

t at)y2

D

+

yvi+,j-

1 2

ki,j-1

+

1

+

t(a - i,j 1 + at

)

ki,j

i,j

:=

2D x2

+

2D y2

+

u+
i+

1 2

,j

+

u-
i-

1 2

,j

x

+

v+
i,j

+

1 2

+

v-
i,j-

1 2

y

.

For left side cells i = 1, j = 2, · · · , M - 1:

(A.16)

1k,+j 1

=

(1

+

t at)x2

D + xu-32 ,j

k2,j

+

(1

+

t at)y2

D

+

yv1-,j+

1 2

t + (1 + at)y2

D

+

yv1+,j-

1 2

k1,j-1

+

1

+

t(a - i,j 1 + at

)

ki,j

1,j

:=

D x2

+

2D y2

+

u+32 ,j x

+

v1+,j+

1 2

+

v1-,j-

1 2

y

.

k1,j+1

Similar for the right, down and up side cells.

28

Y. GAO AND J.-G. LIU

For left-down corner cell i = 1, j = 1:

(A.17)

k1,+11

=

(1

+

t at)x2

D + xu-32 ,1

k2,1

+

(1

+

t at)y2

1,1

:=

D x2

+

D y2

+

u+32 ,1 x

+

v1+,

3 2

y

.

Similar for the left-up, right-down and right-up corner cells.

D

+

yv1-,

3 2

k1,2

+

1

+

t(a - 1,1) 1 + at

ki,j

Remark A.1. Since this example has rectangle grids, we can also define the flux F in the x-direction

and y-direction respectively

(A.18)

Fi-

1 2

,j

=

FiL,j ,

i = 2, · · · , N, j = 1, · · · , M,

Fi,j

-

1 2

= FiD,j ,

i = 1, · · · , N, j = 2, · · · , M,

F

1 2

,j

=

FN

+

1 2

,j

=

0,

j = 1, · · · , M,

Fi,

1 2

=

Fi,M

+

1 2

= 0,

i = 1, · · · , N.

Then (A.14) can be recast as

(A.19)

i,j xy

+

Fi+

1 2

,j

-

Fi-

1 2

,j

+

Fi,j+

1 2

-

Fi,j-

1 2

= 0.

Department of Mathematics, Purdue University, West Lafayette, IN Email address: gy2012yg@gmail.com
Department of Mathematics and Department of Physics, Duke University, Durham, NC Email address: jliu@math.duke.edu

