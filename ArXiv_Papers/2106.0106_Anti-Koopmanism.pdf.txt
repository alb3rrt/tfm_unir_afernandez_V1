Anti-Koopmanism

arXiv:2106.00106v2 [math.FA] 6 Jun 2021

Efrain Gonzalez Department of Mathematics and Statistics
University of South Florida Tampa, Fl 33620
egonzalez@usf.edu

Moad Abudia School of Mechanical and Aerospace Engineering
Oklahoma State University Stillwater, OK 74078 abudia@okstate.edu

Michael Jury Department of Mathematics
University of Florida Gainesville, FL 32608
mjury@ufl.edu

Rushikesh Kamalapurkar School of Mechanical and Aerospace Engineering
Oklahoma State University Stillwater, OK 74078
rushikesh.kamalapurkar@okstate.edu

Joel A. Rosenfeld  Department of Mathematics and Statistics
University of South Florida Tampa, Fl 33620
rosenfeldj@usf.edu

Abstract
This article addresses several longstanding misconceptions concerning Koopman operators, including the existence of lattices of eigenfunctions, common eigenfunctions between Koopman operators, and boundedness and compactness of Koopman operators, among others. Counterexamples are provided for each misconception. This manuscript also proves that the Gaussian RBF's native space only supports bounded Koopman operator corresponding to affine dynamics, which shows that the assumption of boundedness is very limiting. A framework for DMD is presented that requires only densely defined Koopman operators over reproducing kernel Hilbert spaces, and the effectiveness of this approach is demonstrated through reconstruction examples.
1 Introduction
Dynamic mode decomposition (DMD) has been gaining traction as a model-free method of making short-run predictions for nonlinear dynamical systems using data obtained as snapshots of trajectories. DMD and its variant, extended DMD, have proven effective at extracting underlying governing principles for dynamical systems from data, and reconstruction methods using DMD allow for the modeling of nonlinear dynamical systems as a sum of exponential functions, which is analogous to models obtained for linear systems (Kutz et al., 2016).
DMD is closely connected to the Koopman operator corresponding to discrete time dynamical systems (Schmod, 2010). The Koopman Operator KF over a Hilbert function space, H, is a composition operator corresponding to the discrete time dynamics, F : Rn  Rn, acting on functions in the Hilbert space. Specifically, KF g = g  F . In the context of discrete time dynamical systems, F is
The following YouTube playlist discusses the content of this manuscript: https://youtube.com/ playlist?list=PLldiDnQu2phuB64ccOYWxeSBZxq0Gg47g
Preprint. Under review.

the discrete time dynamics that maps the current state of the system to a future state xi+1 = F (xi). Frequently, the function g  H is referred to as an observable.
DMD aims to obtain a finite rank representation of the Koopman operator by studying its action on the full state observable (i.e. the identity function) (Schmod, 2010). Koopman operators over reproducing kernel Hilbert spaces (RKHSs) were studied to take advantage of infinite dimensional feature spaces to extract more information from the snapshots of a system in Williams et al. (2015a). This perspective also enacts a dimensionality reduction by formulating the DMD method in a reproducing kernel Hilbert space (RKHS) framework and implicitly using the kernel trick to compute inner products in the high-dimensional space of observables. In (Williams et al., 2015b), it is shown that kernel-based DMD produces a collection of Koopman modes that agrees with other DMD results in the literature.
However, present in the literature are several misconceptions concerning Koopman operators and their properties (cf. Kutz et al. (2016); Brunton and Kutz (2019)). These properties include boundedness, a lattice of eigenfunctions, common eigenfunctions, and many others. In many cases, each of these concepts arose from particular examples, where tools from ergodic theory or the study of Banach algebras allow for many of these ideas to work, such as (Budisic´ et al., 2012). However, these concepts don't generally extend to a data driven context, where samples and particular Hilbert spaces are used in the execution of DMD methods. In particular, boundedness has been implicitly assumed, when there is no restriction on the selection of observables from a Hilbert space. Many of these misconceptions arise from an agnostic approach to the domain and codomain of Koopman operators, which ignores the structure of the underlying vector spaces that the operator is posed over. As properties of operators directly depend on their underlying spaces, this manuscript presents a thorough and transparent treatment of the Koopman operator as a densely defined operator over a RKHS, and several counterexamples are presented to dispel misconceptions. It should be emphasized, that even though these misconceptions are present in the literature, they have little impact on the practice of DMD, where there are a tremendous number of outstanding results present in the field. This manuscript is focused on a particular collection of misconceptions concerning the underlying operator theory.
The paper is organized as follows. Sections 2 and 3 provide a brief overview of reproducing kernel Hilbert spaces, and Koopman operators, respectively. Section 4 provide several counter examples to many of the misconceptions concerning Koopman operators in the field. Additionally, Section 4 proves that the only bounded Koopman operators over the Gaussian RBF's native space are those corresponding to affine dynamics. Section 5 details a DMD algorithm leveraging only the assumption that the Koopman operators are densely defined, and that they contain the kernel functions within their domain. A numerical example is provided in Section 6 and Section 7 concludes the paper.

2 Reproducing Kernel Hilbert Spaces

A Reproducing Kernel Hilbert Space (RKHS) H over a set X is a Hilbert space composed of functions from X to C such that for all x  X the evaluation functional Exf := f (x) is bounded. Therefore, for all x  X there exists a function Kx  H such that f (x) = f, Kx for all f  H. The function Kx is the reproducing kernel function centered at x and the function K : X × X  C defined by K(x, y) = Ky, Kx is the unique kernel function corresponding to H (Aronszajn, 1950). Throughout most of this manuscript, the methods used will be restricted to RKHSs of real valued
functions. However, for some specific examples in Section 4, it will be more convenient to employ
RKHSs of complex valued functions.

Reproducing kernels can be equivalently expressed as realizations of inner products of feature

space mappings in 2(N). In particular, given an orthonormal basis for a RKHS, {em(·)} n=1 

H, the kernel function may be expressed as K(x, y) =

 m=1

em

(x)em(y),

where

(x)

:=

(e1(x), e2(x), . . .)  2(N) is called a feature map. Equivalently, given a feature mapping

 : X  2(N), there is a RKHS whose kernel function is given as K(x, y) = (x), (y) 2 .

We will make repeated use of projections onto finite dimensional vector spaces arising from spans

of collections of kernel functions centered at snapshots from a dynamical system. For a collection

of centers {x1, . . . , xm} the

is given as argminh h -

expanding

m i=1

wiKxi

-

g

projection g , which

of a function g can be resolved

 H onto  = by expressing h

span{Kx1 as h =

,

...
m i=1

, Kxm } wiKxi ,

2 via inner products, and finally setting the derivative with respect to

2

w := (w1, . . . , wm)T  Rm to zero. This results in the following expression for the weights

 w1   K(x1, x1) · · · K(x1, xm) -1  g(x1) 

 

...

= 

...

...

...

 

 

...

 

wm

K(xm, x1) · · · K(xm, xm)

g(xm)

Hence, the projection is defined by Pg :=

m i=1

wiKxi

where

the

weights

are

obtained

as

above.

3 Koopman Operators over RKHSs

Let H be a RKHS over Rn. For a function F : Rn  Rn we define the Koopman Operator (sometimes called a composition operator), KF : D(KF )  H, as KF g = g  F where D(KF ) = {g  H : g  F  H}. When D(KF ) is dense in H, KF is said to be densely defined. While not all densely defined Koopman operators over RKHSs are bounded, they are all closed operators.
Lemma 1. Let F : X  X be the symbol for a Koopman operator over a RKHS H over a set X. KF : D(KF )  H is a closed operator where D(KF ) is given above.

Proof. Suppose that {gm} m=1  D(KF ) such that gm  g  H and KF gm  h  H. To show that KF is closed, we must show that g  D(KF ) and KF g = h. This amount to showing that
h = g  F , by the definition of D(KF ). Fix x  X, then

h(x) =

h, Kx

=

lim
m

KF gm, Kx

=

lim
m

gm(F

(x))

=

lim
m

gm, KF (x)

=

g, KF (x)

= g(F (x)).

As x was an arbitrary point in X, h = g(F (x)) and the proof is complete.

As Koopman operators are densely defined and closed over RKHSs, their adjoints are densely
defined and closed as well (Pedersen, 2012). Given the kernel function centered at x, KF g, Kx = g  F, Kx = g(F (x)) = g, KF (x) . Thus, Kx  D(KF ) for all x  X, and KF kx = kF (x). Hence, each kernel function is in the domain of the adjoint of a densely defined Koopman operator.

4 Misconceptions Concerning Koopman Operators
There are several long standing misconceptions concerning Koopman operators and their properties. Many of these misconceptions stem from well founded work, such as (Budisic´ et al., 2012), but many of the properties discussed here were removed from their original contexts. Ultimately they appear in recent textbooks and review papers (Kutz et al., 2016; Brunton and Kutz, 2019; Brunton et al., 2021), but without the qualificiations necessary to ensure that they hold. While these misconceptions do not negatively impact the practical implementation of DMD and other Koopman based methods, they should be addressed. Most of these misconceptions and occasional errors stem from an agnostic treatment of the underlying vector spaces in which the Koopman operator acts. To wit, properties of the Koopman operator strongly depend on the selection of underlying vector space, and boundedness, compactness, eigenvalues, etc. change based on this selection. While Koopman operators were introduced by Koopman in 1931 in (Koopman, 1931) and then later picked up by the data science community in the early 2000s (e.g. (Mezic´, 2005)), the study of composition operators and their properties continued in earnest througout the 20th century as composition operators (e.g. (Shapiro, 2012)). The extensive work on composition operators by the function theoretic operator theory community will help facilitate the discussion here.
4.1 Misconceptions concerning Sampling and Discretizations
4.1.1 Sampling and Data Science
Fundamental to any data science method is the collection and exploitation of samples. Machine learning techniques leverage samples to gain an approximation of a function. Sometimes these functions are classifiers, such as in support vector machines as in (Steinwart and Christmann, 2008), they can be continuous time signals as in (Higgins et al., 1996), and many other quantities (cf. (Hastie

3

et al., 2009)). Sampling theory has a long history and are closely intertwined with RKHSs, where
Shanon's sampling theory introduced in (Shannon, 1948) was placed on solid theoretical footing by
G. H. Hardy through the introduction of the Paley-Wiener space in (Hardy, 1941). What is important
to note is that sampling theory requires that the underlying space where samples are being exploited is a function space. This requirement rules out the space L2(Rn) as a domain of the Koopman operator
for Dynamic Mode Decompositions as suggested by many sources such as (Kutz et al., 2016), (Klus et al., 2015), and (Takeishi et al., 2017), since L2(Rn) is a space of equivalence classes of functions. Every two elements of L2(Rn) are allowed to agree over any finite collection of samples, and thus samples have no meaning in L2(Rn). Note that in (Takeishi et al., 2017), it is assumed that there is
a finite dimensional invariant subspace for the Koopman operator, which changes the problem to a
finite dimensional linear algebra problem, but at the cost of a very strong restriction on the Koopman
operator.

4.1.2 Forward Invariant Dynamics

In applications, Koopman operators enter the theory of continuous time dynamics through a

discretization of the continuous time dynamical system. That is, given the dynamical system

x = f (x), the system is discretized through the selection of a fixed time-step, t > 0, as

xm+1 = xm +

tm +t tm

f (x(t))dt,

where

the

right

hand

side

plays

the

role

of

the

discrete

dy-

namics. However, for such a discretization to exist for arbitrarily large values of m, it is necessary

that the dynamics be forward invariant.

For example, consider the one dimensional dynamics, x = 1 + x2. For fixed 0 < t < /2, the corresponding discrete time dynamics are given as xm+1 = tan(arctan(xm) + t). Setting xm = tan(/2 - t), it is clear that xm+1 is undefined. Consequently, the composition symbol, F (x) = tan(arctan(x) + t) for the hypothetical Koopman operator, is not well defined over Rn for any selection of t.

The majority of papers dedicated to DMD leave this assumption unstated, such as (Li et al., 2017), and (Brunton et al., 2016), with (Bittracher et al., 2015) and (Mauroy and Mezic´, 2016) being notable exceptions.

4.2 Properties of the Operators

In this section, we consider a single simple example. Consider the dynamical system x = (x2 -x1)T , which corresponds to circular dynamics in the plane. For any fixed  := t, the

discretization of this system yields the linear discrete dynamics xm+1 =

cos() sin()

- sin() cos()

xm.

That is, the discretization corresponding to a fixed time-step corresponds to a fixed rotation of R2. To simplify the presentation, we use C as a model for R2, where rotation of the complex plane reduces to multiplication by a unimodular constant, zm+1 = eizm. The corresponding discrete time dynamics will be written as F(z) := eiz.

As a function space for definition of the Koopman operator, this section will consider the classical Fock space consisting of entire functions for most of the counterexamples, which is used extensively in Quantum Mechanics (Hall, 2013) and it is a space where operators have been well studied (Zhu, 2012). The Fock space is given as



F 2(C) := f (z) = amzm : |am|2m! <  .

m=0

m=0

The Fock space is a RKHS, with kernel function K(z, w) = ew¯z. Kernel function for the Fock
space over Cn may be obtained through a product of single variable kernels as K(z, w) = ewz = ew¯1z1 · · · ew¯nzn .

Closely related to the Fock space is the exponential dot product kernel, exT y, where for a sin-

gle variable, the exponential dot product kernel's native space may be obtained by restricting

the Fock space to the reals, and then taking the real part of the restricted functions. Through

a conjugation of the exponential dot product kernel, the Gaussian RBF may be obtained as

KG(x, y) = e- x 2/2exT ye- y 2/2 = exp

-

x-y 2

2

, and performing the same operation on

4

the Fock space kernel over Cn yields KG(z, w) = e-z2/2ewze-w¯2/2 = exp

-

(z-w¯)2 2

, which is

the kernel corresponding to the complexified native space for the Gaussian radial basis function over

Cn (cf. (Steinwart and Christmann, 2008)). This space may be expressed as

HG2 (C) = g(z)e-z2/2 : g  F 2(Cn) ,

and the native space corresponding to the Gaussian RBF can be obtained by taking the real parts of functions from HG2 and restricting to Rn.

4.2.1 Lattice of Eigenfunctions

As presented in (Budisic´ et al., 2012), there is a statement that the eigenfunctions for the Koopman operator form a lattice. That is if 1 and 2 are two eigenfunctions for the Koopman operator, then so is 1 · 2. This assumes that the product of these eigenfunctions are also members of the underlying vector space. There are circumstances where this would hold, such as the space of continuous functions and other Banach algebras. For example, (Klus et al., 2015) discuss lattices of eigenfunctions for the setting of L1(Rn), which is a Banach algebra, but that paper does not make a distinction when discussing L2(Rn). Doubtless, the authors of (Klus et al., 2015; Brunton and Kutz, 2019) and others are aware of this constraint. It is explicitly stated by the authors of Budisic´ et al. (2012), but the others leave the statement of a lattice of eigenfunctions unqualified, which may be misleading to new practitioners. Hilbert spaces are not generally Banach algebras, and since it is desirable to work over Hilbert spaces for properties such as best approximations, projections, and orthonormal bases among others (cf. (Folland, 1999)), it is important to demonstrate that this property of eigenfunctions of Koopman operators does not hold in general.
Setting  = , the discrete dynamics corresponding to rotation by  in the complex plane becomes zm+1 = eizm = -zm. That is the corresponding Koopman operator, KF : F 2(C)  F 2(C), is given as KF g(z) := g(-z). Hence, every even function is an eigenfunction for this Koopman operator with eigenvalue 1.
An important property of the Fock space should be noted. That is, given g  F 2(C), the function g exhibits a strict bound on its growth rate (cf. (Zhu, 2012)). To wit, |g(z)| = | g, K(·, z) F 2(C)| 
|z|2
g F 2(C) K(·, z) F 2(C) = g F 2(C)e 2 . That is, if a function is in the Fock space then the function is of order at most 2, and if the function is of order 2 it has type at most 1/2 (cf. (Boas, 2011)). Conversely, if an entire function is of order less than 2, it is in the Fock space, and if it is of order 2 and type less than 1/2, then it is also in the Fock space. While functions of order 2 and type 1/2 can be in the Fock space, it does not hold for every such function. For example, ez2/2 is of order 2 and type 1/2, but is not in the Fock space.
Thus, (z) = ez2/4 is an eigenfunction for KF in the Fock space. However,  ·  = ez2/2 is not in the Fock space, and cannot be an eigenfunction for KF : F 2(C)  F 2(C). Hence, the eigenfunctions for KF do not form a lattice.

4.2.2 Common Eigenfunctions

The intuition behind the use of Koopman operators in the study of continuous time dynamical systems is that eigenfunctions for the Koopman operators should be "close" to that of the Koopman generator for small timesteps. Moreover, (Brunton and Kutz, 2019) (equation (7.64) ) expresses strong operator topology limits of Koopman eigenfunctions as the time-step approaches zero. However, there is a missing parameter in these equations, where the eigenfunctions are not expressed with their step size dependence. The absence of step size dependence belies the assumption that the eigenfunctions are common between Koopman operators corresponding to different fixed step sizes.
To dispel this misconception, set  = /2, which yields F/2(z) = iz. In this case, the polynomial z4 + z8  F 2(C) is an eigenfunction for the Koopman operator corresponding to  = /2 with eigenvalue 1. However, z2 + z8 is not an eigenfunction for KF/3 , as (ei/3z)4 + (ei/3z)8 = ei4/3z4 + ei2/3z8, and the constants cannot be factored out of the polynomial as an eigenvalue.
Hence, since each Koopman operator obtained through a fixed time-step may produce a different collection of eigenfunctions, there is no way to distinguish which, if any, should correspond to eigenfunctions of the Koopman generator.

5

4.2.3 Boundedness of Koopman Operators
In many contexts it is tacitly assumed that Koopman operators are bounded. In particular, an unrestricted selection of observables in the study of the Koopman operator means that the Koopman operator is frequently assumed to be defined over the entire Hilbert space. In this setting, the Koopman operator is an operator whose domain is the entire Hilbert space that is also closed. Hence, by the closed graph theorem (cf. (Folland, 1999)), such an operator must be bounded. The collection of finite rank operators is dense in the collection of bounded operators over a Hilbert space in the strong operator topology (SOT) (cf. (Pedersen, 2012)). This was used in the work (Korda and Mezic´, 2018) where the DMD routine was demonstrated to converge to a bounded Koopman operator in SOT, and cited by (Li et al., 2017), among others.
In fact, SOT convergence does not in general lead to convergence of the eigenvalues as mentioned in (Korda and Mezic´, 2018), and the finite rank approximations produced by DMD algorithms should converge to Koopman operators in the operator norm topology to preserve spectral convergence. Hence, it is implicitly assumed in the literature that the Koopman operators are compact in addition to being bounded. It isn't immediately clear when one can expect a continuous dynamical system to yield a compact Koopman operator through discretizations. For example, the Koopman operator corresponding to discretizations of the continuous time system x = 0 is the identity operator, I, for any fixed timestep, and I is not compact over any infinite dimensional Hilbert space.
In addition, for any given RKHS, the collection of bounded Koopman operators is very small. In particular, it was demonstrated in (Carswell et al., 2003) that a Koopman operator over the Fock space is bounded only when the corresponding discrete dynamics are affine. It follows that the same result holds over the exponential dot product kernel's native space.
It may perhaps be less obvious that this extends to the Gaussian RBF's native space, and a proof of this is given here. As far as the authors are aware, this is the first time this result has appeared in the literature, and it demonstrates that even for popular selections of RKHSs, the collection of bounded Koopman operators is small.
Lemma 2. If KF is a bounded operator over the Gaussian RBF's native space, then F is a real analytic vector valued function over Rn.

Proof. If KF is bounded, then KF Ky(x) = Ky(F (x)) = exp(- F (x) - y 2) is in the RBF's native space for each y  Rn. Since every function in the RBF's native space is real analytic, so is Ky(F (x)), and thus, the logarithm, - F (x) - y 2 = - F (x) 2 + 2yT F (x) - y 2 is real analytic. This holds if y = 0, and hence F (x) 2 is real analytic. Thus, for every y, the quantity yT F (x) is real analytic. That each component of F (x) is real analytic follows from the selection of y as the cardinal basis elements of Rn, and this completes the proof.
Lemma 3. If F is a real analytic vector valued function that yields a bounded Koopman operator, KF , over a the Gaussian RBF's native space, then its extension to an entire function, F : Cn  Cn induces a bounded operator over HG(Cn).

Proof. Since an entire function on Cn is uniquely determined by its restriction to Rn, it follows that the span of the complex valued Gaussian RBFs with centers in Rn is dense in HG. Moreover, to
demonstrate that KF is bounded, it suffices to show that there is a constant C such that

C2KG(z, w) - KG(F (z), F (w))

(1)

is a positive kernel. By the above remark, it suffices to show this for real x, y  Rn, but then this is equivalent to the statement that KF is bounded over the Gaussian RBF's native space over Rn.

Theorem 1. If F : Cn  Cn is an entire function, and KF is bounded on HG, then F (z) = Az + b for a matrix A  Cn×n and vector b  Cn.

Proof. If KF KF KG(·, z)

is =

bounded, then it KG(·, F (z)). In

hpaasrtaicbuolaurn,dthederaedijsoiantc,oKnsFta, nwthCich>ac0tssuocnhththeactomKpGle(x·,GFa(uzs)s)ian2

as 

C2 KG(·, z) 2. Noting the identity KG(·, z) 2 = exp 2

n j=1

(I

zj

)2

and taking the logarithm,

6

it follows that

n

n

(IFj(z))2  log(C2) + (Izj)2  log(C2) + z 2.

(2)

j=1

j=1

From this inequality, it follows that for each coordinate j = 1, . . . , n, the harmonic function vj(z) = IFj(z) has linear growth. That is, there is a constant C~ so that |vj(z)|  C~(1 + z ) for all z  Cn. It follows (e.g. from the standard Cauchy estimates) that vj(z) = vj(x + iy) must be an affine linear function of x and y, and therefore, so must its harmonic conjugate uj(z), and we conclude that F (z) = Az + b.

Corollary 1. If F is a real analytic vector valued function, and KF is bounded on the Gaussian RBF's native space over Rn, then F is affine.

Hence, for the most commonly used kernel function in machine learning, the collection of bounded (and hence compact) Koopman operators over its native space is restricted to only those Koopman operators corresponding to affine dynamics. Each selection of RKHS and kernel function will yield a correspondingly small collection of bounded Koopman operators. It should be noted that Koopman operators were completely classified for over the classical sampling space, the Paley-Wiener space (Chacón and Giménez, 2007), as also being those that correspond to affine dynamics, and it is a simple exercise to show that the native space for the polynomial kernel also only admits bounded Koopman operator when the dynamics are affine.
Consequently, in most practical respects Koopman operators should not be assumed to be bounded, and certainly not compact.

5 Dynamic Mode Decomposition with Koopman Operators over RKHSs
As a product of its genesis in the machine learning community, many DMD procedures appeal to feature space, and this continues to hold in the current implementations of kernel-based extended DMD (Williams et al., 2015b), which casts the snapshots from a finite dimensional nonlinear system into an infinite feature space. The direct involvement of the feature space in the estimation of the Koopman operator leads to rather complicated numerical machinery. To avoid directly computing the infinite dimensional vectors that result, an involved collection of linear algebra techniques are leveraged to extract the Koopman modes. Here it is shown that this process may be simplified and that a procedure that directly involves the kernel functions centered at the snapshots simplifies the design of DMD algorithms. This approach keeps to the spirit of the "kernel trick," where feature vectors should never be directly evaluated and only accessed through evaluations of the kernel function itself.
Throughout this algorithm, a Koopman operator will be assumed to be densely defined, as Section 4 demonstrated that most Koopman operators cannot be expected to be bounded or compact. An additional assumption will be made that the kernel functions themselves reside in the domain of the Koopman operator. It was demonstrated in Section 3 that the kernels are always in the domain of the adjoint, and so alternatively, a finite rank representation may be derived for the adjoint operator without adding an assumption.
Moreover, for the sake of discussion, it is assumed that the Koopman operator is actually diagonalizable, which shouldn't generally be expected to hold. However, the finite rank representations leveraged here are almost always diagonalizable, since the set of non-diagonalizable matrices are of measure zero in the collection of all matrices. Moreover, for periodic data sets, the adjoint of the Koopman operator will be invariant on the span of the collection of kernel functions centered at the snapshots, and thus, the finite rank representations will be explicitly the adjoint of the Koopman operator on that subspace, which supports the assumption of the availability of eigendecompositions for the Koopman operator in the periodic or quasiperiodic settings.
For a given collection of snapshots {x1, x2, ..., xm}2, the goal is to determine a finite rank representation of KF that is derived from the kernel functions centered at the snapshots. To express a finite rank representation, the ordered basis  = {kx1 , ..., kxm-1 } is leveraged. In particular, if P is the
2While availability of a time series of snapshots {x1, x2, ..., xm} such that xi+1 = F (xi) is a more typical use case, the developed method does not require such a time series. It can also be implemented using arbitrary snapshots {x1, x2, ..., xm} and {y1, y2, ..., ym} provided yi = F (xi).

7

projection on to span(), the operator PKF maps span() to itself, which enables the discussion of eigenfunctions and eigenvalues of KF using only functions in span().

Suppose that given a function g  span , with coefficients a1, ..., am-1, the function PKF g can
be expressed in the basis  using the coefficients b1, ..., bm-1. As a result, the operator PKF can be represented using a matrix that maps the vector (a1, ..., am-1)T to the vector (b1, ..., bm-1)T . In
the following development, the finite rank representation of PKF , expressed in a matrix form, is denoted by [PKF ], where the notation [·] indicates that both the domain and range of PKF is restricted to span().

Consequently, the ith column of [PKF ] may be determined through the examination of the action of the operator PKF on the basis function Kxi , for i = 1, . . . , m - 1. Using the fact that KF Kxi (x) = Kxi (F (x)), [PKF ] may be written as

 K(x1, x1) · · · K(x1, xm-1) -1  K(x2, x1) · · · K(x2, xm-1) 

[PKF

]

=

 

...

...

...

 

...

...

...

. 

K(xm-1, x1) · · · K(xm-1, xm-1)

K(xm, x1) · · · K(xm, xm-1)

It should be noted that this is precisely the pair of matrices examined in (Williams et al., 2015b) after the use of a truncated SVD.

The objective of DMD is to use the finite rank representation determined above to create a data

driven model of the dynamical system. This makes use of a fundamental property of eigenfunctions

of the Koopman operator. In particular, suppose that  is an eigenfunction of KF with eigenvalue . Evaluating the eigenfunction at a snapshot reveals (xi+1) = (F (xi)) = KF (xi) = (xi). Hence, (xi+1) = i(x1). Now suppose that {j} j=1 is an eigenbasis for a diagonalizable Koopman operator, KF , corresponding to the eigenvalues {j} j=1. For a state x  Rn, let (x)d
be the d-th component of x for d = 1, . . . , n. If it is assumed that the mapping x  (x)d is in the RKHS (as it is when H is the native space for the exponential dot product space (Steinwart and Christmann, 2008)), then it may be expressed as (x)d = limM M j=1(j,M )di(x) for some coefficients {(j,M )d} j=1. Note that since the Koopman operator is not generally a normal operator, i is not expected to be an orthonormal basis, and hence, there may be nonzero influences between the coefficients obtained by projection and this is expressed by the additional index M in j,M . Hence,
Koopman modes are not fixed quantities unless there is an orthonormal basis of eigenfunctions for

the Koopman operator. By stacking each (x)d, the full state observable gid, given by gid(x) = x, is expressed as

M

gid(x) = lim j,M j(x).

(3)

M 

j=1

Hence, each snapshot may be reconstructed as

M

xi+1 = lim
M 

j,M ij j (x1).

(4)

j=1

Since the Koopman operator is approximated here by a finite rank representation, perfect reproduction
of gid through a series of eigenfunctions is not possible. Instead, eigenfunctions determined through the finite rank representation are used to construct the approximation of gid. In particular, the matrix [PKF ] is the matrix representation of PKF . If vj is an eigenvector for the matrix [PKF ] with eigenvalue j, then

PKF

m-1
(vj)iK(x, xi)
i=1

 K(x, x1) T

m-1

= 

...

 

[PKF ]vj = j

(vj)iK(x, xi).

K(x, xm-1)

i=1

That is, m i=-11(vj)iK(x, xi) is an eigenfunction of PKF . The corresponding normalized eigen-

function

is

denoted

by

^j (x)

:=

1
vjT Gvj

m i=-11(vj )iK(x, xi), where G = (K(xi, x ))m i, -=11 is the

Gram matrix associated with the snapshots and kernel function.

8

Using a finite rank representation of (3), it is easy to see that the d-th row of the matrix ^ :=

^1 . . . ^m-1 of Koopman modes is comprised of the components of (x)d along the (non-

orthogonal) directions ^j. That is, gid(xi) = xi =

m-1 j=1

j

^j

(xi),

which

yields

^

=

X

V T G -1 ,

where X := (x1 . . . xm-1) is the data matrix and

V :=

 v1
v1T Gv1

...

 vm-1
vm T -1Gvm-1

is the matrix of normalized eigenvectors of [PKF ].

Using the approximate eigenfunctions, ^j, a data driven model for the system is obtained as

m-1

xi+1 

^j ij ^j (x1).

(5)

j=1

(a) This figure presents the reconstruction of the same time points using three different kernel functions. The first row contains the ground truth, the second leverages the Gaussian RBF kernel, and the third uses the exponential dot product kernel. The left column presents the reconstruction of the initial state, x1. The middle column shows the reconstructions of the state, x15, and the right column corresponds to the reconstruction of the state x30. Note that each kernel generates nearly identical reconstructions of each state.

(b) This figure presents prediction of the same snapshots using three different kernel functions. The first row contains the ground truth, the second leverages the Gaussian RBF kernel, and the third uses the exponential dot product kernel. The left column presents the prediction of, x51. The middle column shows the reconstructions of the state, x101, and the right column corresponds to the reconstruction of the state x151. Note that each kernel generates nearly identical prediction of the future states.

6 Numerical Example

The website accompanying the textbook (Kutz et al., 2016) provides several data sets that serve as benchmarks for spectral decomposition approaches to nonlinear modeling, which have been released to the public through their website at http://www.dmdbook.com/. This section utilizes the cylinder flow data set to demonstrate the results of the developed DMD method. The cylinder flow example is numerically generated, and the data provided corresponds to a planar steady state flow of the system. The data set consists of 151 snapshots, containing values of the vorticity of the flow at several mesh points in a plane, recorded every 0.02 seconds. In this demonstration, snapshots 1 through 30 are used as the input data, and snapshots 2 through 31 are used as output data, assuming that the ith and (i + 1)th snapshots satisfy xi+1 = F (xi) for some unknown nonlinear function F .

The Koopman modes, eigenvalues, and eigenfunctions are then computed using the developed

technique and snapshots 1 through 30 are reconstructed using (5). DMD is implemented using the

exponential

dot

product

kernel,

K(x, y)

=

exp(

1 µ

xT

y)

(with

µ

=

500),

and

the

Gaussian

RBF

kernel, K(x, y) = exp

-

1 µ

x-y

2 2

(with µ = 500). Each of the kernels result in comparable

reconstruction results that match with the input data as shown in Figure 1a.

To further demonstrate the accuracy of the obtained finite-dimensional representation of the Koopman operator, snapshots 32 through 151 are predicted using (5). As shown in Figure 1b, given the first 31

9

snapshots, the developed DMD technique is able to accurately predict the remaining 120 snapshots without the knowledge of the underlying physics, F .
7 Conclusion
This manuscript discusses several long standing misconceptions surrounding the Koopman operator, which includes notions of boundedness, eigenfunctions, the existence of a unique collection of Koopman modes, and lattices of eigenfunctions. For each misconception, an example has been provided, where a major theoretical result was demonstrated that showed the Gaussian RBF's native space only supports bounded Koopman operators that correspond to affine dynamics. Moreover, this manuscript gives a kernel-based DMD algorithm that simplifies that of (Williams et al., 2015a).
Acknowledgments and Disclosure of Funding
This research was supported by the Air Force Office of Scientific Research (AFOSR) under contract numbers FA9550-20-1-0127 and FA9550-21-1-0134, and the National Science Foundation (NSF) under award numbers 2027976 and 1900364. Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the sponsoring agencies.
References
N. Aronszajn. Theory of reproducing kernels. Trans. Am. Math. Soc., 68(3):337­404, 1950.
A. Bittracher, P. Koltai, and O. Junge. Pseudogenerators of spatial transfer operators. SIAM Journal on Applied Dynamical Systems, 14(3):1478­1517, 2015.
R. P. Boas. Entire functions. Academic Press, 2011.
S. L. Brunton and J. N. Kutz. Data-driven science and engineering: Machine learning, dynamical systems, and control. Cambridge University Press, 2019.
S. L. Brunton, B. W. Brunton, J. L. Proctor, and J. N. Kutz. Koopman invariant subspaces and finite linear representations of nonlinear dynamical systems for control. PloS one, 11(2):e0150171, 2016.
S. L. Brunton, M. Budisic´, E. Kaiser, and J. N. Kutz. Modern koopman theory for dynamical systems. arXiv preprint arXiv:2102.12086, 2021.
M. Budisic´, R. Mohr, and I. Mezic´. Applied koopmanism. Chaos: An Interdisciplinary Journal of Nonlinear Science, 22(4):047510, 2012.
B. Carswell, B. D. MacCluer, and A. Schuster. Composition operators on the fock space. Acta Sci. Math.(Szeged), 69(3-4):871­887, 2003.
G. Chacón and J. Giménez. Composition operators on spaces of entire functions. Proceedings of the American Mathematical Society, 135(7):2205­2218, 2007.
G. B. Folland. Real analysis: modern techniques and their applications, volume 40. John Wiley & Sons, 1999.
B. C. Hall. Quantum theory for mathematicians, volume 267. Springer, 2013.
G. H. Hardy. Notes on special systems of orthogonal functions (iv): the orthogonal functions of whittaker's cardinal series. In Mathematical Proceedings of the Cambridge Philosophical Society, volume 37, pages 331­348. Cambridge University Press, 1941.
T. Hastie, R. Tibshirani, and J. Friedman. The elements of statistical learning: data mining, inference, and prediction. Springer Science & Business Media, 2009.
J. R. Higgins et al. Sampling theory in Fourier and signal analysis: foundations. Oxford University Press on Demand, 1996.
S. Klus, P. Koltai, and C. Schütte. On the numerical approximation of the perron-frobenius and koopman operator. arXiv preprint arXiv:1512.05997, 2015.
10

B. O. Koopman. Hamiltonian systems and transformation in hilbert space. Proceedings of the National Academy of Sciences of the United States of America, 17(5):315, 1931.
M. Korda and I. Mezic´. On convergence of extended dynamic mode decomposition to the koopman operator. Journal of Nonlinear Science, 28(2):687­710, 2018.
J. N. Kutz, S. L. Brunton, B. W. Brunton, and J. L. Proctor. Dynamic mode decomposition: data-driven modeling of complex systems. SIAM, Philadelphia, PA, USA, 2016.
Q. Li, F. Dietrich, E. M. Bollt, and I. G. Kevrekidis. Extended dynamic mode decomposition with dictionary learning: A data-driven adaptive spectral decomposition of the koopman operator. Chaos: An Interdisciplinary Journal of Nonlinear Science, 27(10):103111, 2017.
A. Mauroy and I. Mezic´. Global stability analysis using the eigenfunctions of the koopman operator. IEEE Trans. Autom. Control, 61(11):3356­3369, 2016.
I. Mezic´. Spectral properties of dynamical systems, model reduction and decompositions. Nonlinear Dyn., 41 (1):309­325, 2005. doi: 10.1007/s11071-005-2824-x.
G. K. Pedersen. Analysis now. Springer Science & Business Media, 2012. P. J. Schmod. Dynamic mode decomposition of numerical and experimental data. J. Fluid Mech., 656:5­28,
2010. doi: 10.1017/S0022112010001217. C. E. Shannon. A mathematical theory of communication. The Bell system technical journal, 27(3):379­423,
1948. J. H. Shapiro. Composition operators: and classical function theory. Springer Science & Business Media, 2012. I. Steinwart and A. Christmann. Support vector machines. Springer Science & Business Media, 2008. N. Takeishi, Y. Kawahara, and T. Yairi. Learning koopman invariant subspaces for dynamic mode decomposition.
arXiv preprint arXiv:1710.04340, 2017. M. O. Williams, I. G. Kevrekidis, and C. W. Rowley. A data­driven approximation of the koopman operator:
Extending dynamic mode decomposition. J. Nonlinear Sci., 25(6):1307­1346, 2015a. M. O. Williams, C. W. Rowley, and I. G. Kevrekidis. A kernel-based method for data-driven Koopman spectral
analysis. J. Comput. Dyn., 2(2):247­265, 2015b. K. Zhu. Analysis on Fock spaces, volume 263. Springer Science & Business Media, 2012.
11

