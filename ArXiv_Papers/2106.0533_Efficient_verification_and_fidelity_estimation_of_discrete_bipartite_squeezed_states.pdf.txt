Efficient verification and fidelity estimation of discrete bipartite squeezed states
Russell P Rundle1,  1School of Mathematics, Fry Building, University of Bristol, UK
(Dated: Wednesday 2nd June, 2021)
To gain an advantage, quantum technologies utilize phenomena particular to quantum mechanics. Two such phenomena are squeezing and entanglement. Having generated states that exhibit these features, verification of their generation with local measurements can be a difficult process. Here we consider the states that are generated using the two-qudit single-axis squeezing Hamiltonian, that not only produces entangled two-qudit squeezed states but also results in various forms of interesting entangled states. We show how one can use local measurements to both efficiently verify and directly estimate the fidelity of these generated states.

arXiv:2106.00533v1 [quant-ph] 1 Jun 2021

I. INTRODUCTION
Utilizing quantum mechanical effects can lead to advantages in quantum technologies over their classical counterparts. It is therefore important to devise methods to effectively and efficiently verify quantum processes and states. One could choose to reconstruct the quantum state by means of quantum state tomography [1­4]. However, as the size of the quantum system in question increases, it becomes increasingly more difficult and timeconsuming to fully reconstruct a quantum state. It then becomes more important to find a more computationallyefficient method to verify that a desired state has been created; and to verify that a given computation or procedure was performed correctly.
There have been many alternative approaches to verify the generation of a quantum state [5­7]. These include considering and measuring certain properties and attributes via an appropriate metric; this has been done for properties such as entanglement [8, 9], entropy, purity, coherence [10, 11], among others, see Ref. [12] for a survey of quantum property testing. Alternatively methods to more directly certify the creation of a state, such as estimating the fidelity [13, 14] and quantum state verification [15­20], have been devised recently.
In quantum state verification the goal is to devise a strategy that is made up of a set of measurements, where each measurement accepts a given target state with certainty and rejects any other state with some probability [15]. The strategy is then a convex sum of these measurements, in a way that optimizes the rejection of a state that isn't the target state. Measurements are then taken in line with this strategy a given number of times. If any of these measurements fail, we can say with certainty that the generated state is not the target state.
This method of verification assumes that the target state is pure, however in experimental situations sufficient purity often proves difficult to achieve. Resulting in a non-zero chance that the generated state is not the target state. It may then be more useful to instead accept that the generated state is not the target state, and
 r.rundle@bristol.ac.uk

calculate how close you are to generating the state, with respect to some distance measure in state space. This is where protocols such as direct fidelity estimation are useful [13, 14]. By taking a sequence of measurements, one can calculate the fidelity by using the measured results with the theoretical results of the target state.
Here, we extend previous results for quantum state verification and fidelity estimation to bipartite-qudit systems. As the dimension of qudits increase, we then need d - 1 degrees of freedom to uniquely define a bipartite qudit state, up to local rotations; we therefore consider how states that are generated by a two-qudit squeezing Hamiltonian can be verified. This will require just a time degree of freedom and allows us to consider particular states that may be of interest.
We will first consider an extension to the quantum state verification protocol found in Ref. [15], where we will discuss the previous results for two-qubit systems and then extend this to larger discrete systems. This will be followed by how one can extend the direct fidelity estimation method from Ref. [13] to bipartite qudit systems.
II. THE MODEL: SQUEEZING AND ENTANGLEMENT
Squeezed states of light are generated by squeezing a coherent state of light along a given quadrature. Such states have been demonstrated to give an advantage in various applications [21], such as in continuous-variable quantum computing and quantum information processing [22­24]. They have also been useful in quantum metrology [25, 26], where squeezed states of light are used in the detection of gravitational waves [27­29]. Alternatively, given two modes of light, one can squeeze the state along quadratures shared by the two modes, this creates an entangled state across these two modes. When considering optical systems restricted to Gaussian states, one way to generate entanglement between two modes is to apply this squeezing operation across the two modes [22].
Conversely, there has been considerable attention into the generation of squeezed states in finite Hilbert spaces. Where spin squeezed states have proven to be a valuable

2

resource in the generation of atomic clocks [30, 31]. One

3.5

method to produce such states is by applying the single-

3

axis twisting Hamiltonian [32]. Further application

of this Hamiltonian then produces atomic Schr¨odinger

2.5

cat states ­ the superposition of many spin coherent

2

N ()

states [32]. By considering a single large spin as the

1.5

symmetric subspace of many qubits, the single-twisting

Hamiltonian has also been a reliable method to generate

1

GHZ states of up to 20 qubits [33].

0.5

Analogously to a two-mode squeezed state, one can

adapt the single-axis twisting Hamiltonian to generate a

0

two-qudit squeezing operation. Given two spin-j qudits,

each with dimension d = 2j+1, two-qudit squeezed states

d = 21 d = 11 d=5 d=3 d=2

 2



3 2

2



can be generated by applying the Hamiltonian

FIG. 1. The negativity of bipartite qudit states through the

Hd = µJ^dz  J^dz,

two-qudit squeezing evolution. The blue curve (bottom) is the (1) negativity of two qubits; the red (middle) line is the negativity

where J^dz is the d-dimensional spin operator that rotates a d-dimensional state around the z-axis.

of two qutrits; the following green curve is for two 5-level qudits. The top to curves show the values for two 11-level and 21-level qubits in grey and black respectively. This quantifies

This Hamiltonian can then be applied to an initial the entanglement between the two qudits at different times

state |(0) d, where

in the evolution. At each of the troughs in the negativity particularly interesting entangled states are generated, and

1 d-1 d-1 |(0) d = 2d-1
k=0 k =0

d-1 k

d-1 k

1 2
|k |k .

(2)

This state is the eigenstate of the J^dx  J^dx operator with eigenvalue (d - 1)2/4, generating a spin-coherent state

will be considered separately in Section III A.
From Fig. 1, it can be seen that as the squeezing occurs, the negativity between the two systems increases. Unlike the infinite-dimensional case, different forms of

that is aligned along the equator of the Bloch sphere [34, entangled states arise throughout the evolution. These

35]. For two qubits, this state is simply (|0 +|1 )(|0 + can be identified by the dips in the negativity. A cu-

|1 )/2.

rious effect is the fractal-like behaviour throughout the

Applying exp (-i Hd) to Eq. (2), where  = µt is di- evolution [38].

mensionless time, we yield the time-dependent state

At  = , the negativity is always equal to 1, regard-

|(t) = e-iJ^dzJ^dz |(0) d

(3)

less of the dimension. In all cases, this state is of the same form; that is, locally equivalent to (|00 + |11 )/ 2,

d-1 e-i (j-k)(j-k )

=

2d-1

k,k =0

d-1 k

1
d-1 2

and for two qubits is a maximally entangled state. Al-

|k |k . ternatively, we can think of it as a bipartite-qubit, two-

k

component atomic Schr¨odinger cat state. Such a state

The evolution of this initial state under this Hamiltonian results in the state twisting around the z axis, causing the initial coherent state to squeeze, creating a discrete analog of two-mode squeezing as the two states entangle [36]. This has also been considered as a method to entangle two Bose Einstein condensates [37­39], to treat Bose Einstein condensates as qubits in quantum

will be labelled |(2, 2) where the first 2 represents the dimension of each qudit and the second 2 represents the number of components.
As the dimension increases, the form of the state is the same, albeit with a larger overall Hilbert space, where we will label a general state in the Schmidt decomposition at  =  as

computations. A method to verify the creation of such states can therefore be used to verify the generation of entangled Bose Einstein condensates.
Given we are only considering pure states during the evolution, one can use multiple metrics to consider the entanglement, such as the purity [36] or von Neumann entropy. Here we consider the negativity, where

1

|(d, 2)

=

 (|00 2

d

+ |11

d),

(5)

where d is the dimension of each qudit. When the dimension increases, other forms of entan-
glement start to appear. These can be seen in the local minima in the negativity for higher-dimensional sys-

N ()

=

||A ||1

-

1 ,

2

tems. The states at these points are bipartite-qudit,
(4) -component atomic Schr¨odinger cat states. In the Schmidt decomposition, these states can be written as

A is the partial transpose of the density matrix  with respect to qubit A. ||X||1 = Tr XX is the trace norm.

1 -1

|(d, ) =  

|kk d .

(6)

k=0

3

Note that when  = d these state are maximally entangled states. Alternatively, when  < d the state is maximally in a subspace of the full Hilbert space, however the full state itself is not maximally entangled.
Note that only the two-qubit state creates a maximally entangled state. Interestingly, when the dimension is large enough, the state |(d, ) appears at  = 2/, and certain multiples thereafter ­ unless coinciding with a lower value of . For example a  = 4 state appears at  = /2 and 3/2, but not at  =  where a  = 2 state appears.
All the entangled states that appear at these dips in negativity are special cases of Eq. (3) that have a more simple procedure for optimal verification; these cases will be considered separately in Section III A. Following this, we will consider the methods that we can verify any general state of the form Eq. (3).

III. EXISTING VERIFICATION METHODS
There are cases where verification methods have already been given. In Ref. [15], a method to optimally verify any two-qubit state was presented, where the authors also presented a method to verify stabilizer states. This was followed results in Ref. [17] where any multi-qubit maximally entangled state can be generated. We also note that adaptive protocols have been presented both for the two-qubit case and for two-qudits [18, 20], where such protocols require communication between measurements. Here we are interested in generalizing a non-adaptive protocol to any two-qudit system. The results of this will be given in Section V. First, we will discuss the two-qubit case from Ref. [15], along with the maximally entangled states considered in Ref. [17] and a discussion around certain types of special cases.

A. Special cases

Verification of bipartite states with local measurements can be complicated procedure, where there has been much work on providing methods to do verify arbitrary quantum states [15­20]. There are however certain states that require a much simpler procedure than the general case, it is then worth considering these cases first.
An important class of these are maximally entangled states

1 d-1

|(d, d)

=

 d

|kk
k=0

d.

(7)

It was shown in Ref. [17] such states for any dimension can be verified. Where for prime-dimensional systems, the strategy can be simply calculated with the Weyl algebra, otherwise a strategy can be generated through a 2-design structure [17].

For two qubits, the verification of the maximally entangled state | = (|00 2 + |11 2)/ 2 can be performed by the strategy

1 Bell = 3

12 + 22 + 32

,

(8)

made up of the projectors i2, such that each

i2 =

|i, k i, k|2  i, k i, k 2 (9)

k{-1,1}

where the subscript refers to d = 2. The states in Eq. (9)

are the eigenstates of the Pauli operators i |i, k 2 = k |i, k 2 and i, k 2 is the complex conjugate of the vector. Note that every two-qubit maximally entangled state

is simply a local rotation of this state.

When considering the evolution of Eq. (1), at t = 

a state of this form is produced regardless the dimen-

sion of the qudits, producing a state of the form |(d, 2)

in Eq. (5). When d > 2, |(d, 2) is not maximally en-

tangled. This can be seen in comparison to the the two-

qutrit maximally entangled state calculated from Eq. (7).

Further we can see this by the value of the negativity

of this state in Fig. 1. These are still interesting entan-

gled states, it is therefore worthwhile discussing how such

states can be verified.



To verify |(d, 2) , consider the state (|00 d +|11 d)/ 2,

that is equivalent to the target state up to local rotations.

This state is then an eigenstate of the first three gener-

ators of the su(d) algebra. The matrix representation of

these three can be given by

id =

i 0

0 0d-2

,

(10)

where i = 1, 2, 3. These are d × d matrices with with the Pauli operators in the top-left.
Similarly to Eq. (9), we can define the projectors

id =

id, k id, k  id, k id, k

k{-1,1}

(11)

where id id, k = k id, k and id, k is the complex conjugate of the vector. The strategy for |(d, 2) can then be built by

Bell = 1d + 2d + 3d,

(12)

This can be generalized to measure any entangled state of the form in Eq. (6). Where just a -dimensional subspace of |(d, ) needs to be measured.
Note in the two-qudit squeezing evolution, that as the dimension of the qudits increases, more variants of these states emerge. Each of the troughs in the negativity in Fig. 1 is one of these entangled states. We can treat these states as subspaces of the full two-qudit space, much as we did in Eq. (12).
We now have a method to efficiently verify each of the local minima in the negativity. However this misses out an important part of the evolution, the spin-squeezed states that are produced at the beginning.

4

B. Two-qubit verification

The optimal method to verify any two-qubit state was given in Ref. [15]; we will now present the main results from Ref. [15] in order to consider a method to scale the generated strategy up to larger system sizes. Note that other strategies have been considered that are adaptive [18, 20], here our goal is to generalize the nonadaptive strategy in Ref. [15] to larger qudits to create a protocol that is efficient and easily scalable.
We start with a general two-qubit state as our target state. The general target state given in Ref. [15] is the same as the Schmidt decomposition of two-qubit solution of Eq. (3)

|( ) = cos  |00 + sin  |11 ,

(13)

where the only difference with the target state in Ref. [15] is that the sin and cos terms are swapped.
In Ref. [15], the authors started with a general strategy for this state that is made up of the convex sum

 = c11 + c22 + c33 + c44,

(14)

where i is some rank-i strategy. At  = 0 and  = 2 all that is needed is a rank-1 strategy for optimal verification. Since such states are themselves separable, the strategy will simply be | |. As was shown in Section III A, there is also a special case when  = , where we only need the rank-2 strategy given in Eq. (8)
It was shown in Ref. [15], that for any other state, we need the addition of a rank-3 strategy as well as the rank-2 operator

PZ+Z2 = |00 00|2 + |11 11|2 .

(15)

The required rank-3 strategy is of the form

3 = 1 - j |j j|

(16)

j

for some normalization j, where

j|( ) = 0

(17)

for every j and each |j is separable. This results in the overall strategy

 = PZ+Z2 + (1 - )3.

(18)

Now all that is needed is the explicit form of Eq. (16) and the value of . In Ref. [15], the authors proved that the optimal form of Eq. (16) is given when j = 1/3 for j = 1, 2, 3, and

2ij

1

e3

|j =



|0 + 

|1

1 + cot 

1 + tan 

2i(3-2j)

1

e3



|0 + 

|1

1 + cot 

1 + tan 

(19)

note that the coefficients are swapped here in comparison to Ref. [15]. Also note that only three values of j are needed in the sum, this is equivalent to integrating over all valid values of the phases on the states.
The phase difference on the first and second qubit is fixed, this can be seen by considering the requirement in Eq. (17). This requirement means that any state |j needs to have a value  sin  as a coefficient of |00 and - cos  as a coefficient of |11 , for some normalization . This results in j|( ) =  sin  cos  - cos  sin  = 0.
One way to arrive at the states in Eq. (19) is then to start with a state

|j

=

 sin  |0

+ eicos  |1



 sin  |0

+

ei(-)

 cos



|1

.

(20)

 Normalizing results in  = 1/ 1 + 2 sin  cos  . This gives the correct values in Eq. (19). The next step is to integrate over the values of , it was shown in Ref. [15] that taking the sum over the three phases in Eq. (19) yields equivalent results to integrating over all phases.
Now that both parts of the strategy are generated, it is necessary to find the optimal value of . This means optimizing between the PZ+Z2 and the 3 components of the strategy. Note that PZ+Z2 accepts both the target state and the orthogonal state ( ) = sin  |00 + cos  |11 with certainty while also always rejecting |01 and |10 . 3, on the other hand, accepts the target state with certainty and rejects ( ) with some given probability; 3 also accepts |01 and |10 with some probability.
Optimizing for  is then a balance between these two scenarios, where we want to decrease the probability of accepting ( ) as much as possible while not increasing the probability of accepting |01 and |10 too much. This results in solving ( )  ( ) = 01|  |01 = 10|  |10 , resulting in a value of  = (2 - sin 2 )/(4 + sin 2 ). For more detail into the proof of this optimization, see the supplementary material of Ref. [15].

C. Two-qubit fidelity estimation
In experimental settings it is known that the state created isn't exactly the target state. It can then be much more desirable to estimate the fidelity of the created state with respect to the target state.
This can be done in various ways, one of which is an extension of the two-qubit verification strategy, where it was shown in Ref. [40] that the infidelity is bounded by the second highest and the lowest eigenvalue of the strategy. These inequalities are then saturated when the strategy is of a homogenous form ­ when these eigenvalues are equal.
Here we will instead focus on the direct fidelity estimation protocol laid out in Refs. [13, 14]. In Ref. [13] a protocol to estimate the fidelity of multi-qubit states

5

and processes was given by considering the characteristic function of the state. Similar results were shown in Ref. [14] where they also extended their results to continuous-variable systems. In Ref. [14], the authors considered the use of the Wigner function for a continuous-variable system, which is the Fourier transform of the characteristic function. We note that any informationally complete probability distribution function can be used to perform the procedure for any system, the procedure just may need some adjustment [5, 41].
For estimating the fidelity of a general two-qubit state, we begin with introducing the two-qubit characteristic function, where

1

(k, k ) = 2 Tr [ k  k ] .

(21)

Note that the characteristic function is normalized so that k,k (k, k )2 = 1. For our two-qubit state in Eq. (13) the characteristic function is only non-zero in
six elements

1 (0, 0) = (3, 3) =
2

1

(1, 1) = -(2, 2) = sin 2

(22)

2

1 (0, 4) = (4, 0) = cos 2.
2

This means we only need to take measurements in six bases where, from this, one can then calculate the fidelity

F (1, 2) = 1 (k, k ) 2 (k, k ),

(23)

k,k

where 1 (k, k ) is the characteristic function for the target state in Eq. (22) and 2 (k, k ) is the measured characteristic function.
Following the protocol in Refs. [13, 14], we choose

= 1/ 2

(24)

values of (k, k ), where is the adaptive error and  is
the failure probability [5, 13, 14]. Each sample will be chosen with the probability |(ki, ki)|2. On average, the measurements 1  1 and z  z will be selected 25% of the times each, and together take up half the basis
choices for measurement. The other half come from the
other four measurement bases; where on average x  x and y  y will be selected sin2(2 )/4 times each; and 1  z and z  1 will be chosen cos2(2 )/4 times each.
Every time one of these measurement bases are chosen,
we then need to measure each choice k  k a total of mi times, where

1

mi = 2 2(ki, ki)2 log(2/) .

(25)

For each of the 1  1 and z  z measurements, 2 log(2/)/ 2 measurements need to be
made. Likewise x  x and y  y will require

2 sin2(2 ) log(2/)/ 2 measurements; and 1  z and z  1 require 2 cos2(2 ) log(2/)/ 2 measurements each.
The steps to then calculate the fidelity for the given
states can be found in Following Refs. [5, 13, 14] and
App. A.

IV. TWO-QUTRIT STATES
Now that we've discussed the existing methods for quantum state verification and direct fidelity estimation, we will consider how these can be extended for larger qudits. We start with systems of two qutrits here before going on to how these protocols can be generalized for larger bipartite systems in Section V. Note that in the case of quantum state verification, we're more interested in generating a strategy that is both efficient and simply scalable, rather than the optimal strategy.

A. Efficient quantum-state verification

As the dimension of each qudit increases, so does the number of possible substrategies. Here we will show how an efficient strategy can be generated by just considering two substrategies. Note also that as the dimension of the qudits increases, the possible target states in the Schmidt decomposition has two degrees of freedom to choose from. We will therefore decrease this to one degree of freedom and consider the squeezing evolution for two qutrits; doing so allows us to consider and provide results for a subset of interesting and useful states that can be generated in systems of two qutrits.
Considering two qutrits, the time-dependent state from Eq. (3) for d = 3 is locally equivalent to

|( )

1 =

2 cos2  + 6 + ( )

1
2 |00

4

1 + | sin  | |11

(26)

2

1 +

2 cos2  + 6 - ( )

1
2 |22 ,

4

where

( ) = (2 cos( ) + 2) cos( )2 - 2 cos( ) + 5. (27)

It was demonstrated in Ref. [15] that a strategy for a state in the Schmidt decomposition gives equivalent results to the equivalent local rotation of the strategy applied to the actual state. This is also valid for states of larger dimension. We can therefore consider the strategy for the state in Eq. (26) as the Schmidt decomposition of Eq. (3).
The three parts of the state Eq. (26) are shown in Fig. 2 (a), where the blue on the top shows the coefficients in the |00 basis through time. Likewise the green line underneath shows the coefficients for |11 and the

6

1 (a)

|00

0.5

|11

|22

0

 2



3 2

2



1 (b)

|00

0.5

|11

|22





0

 2



3 2

2



700
(c)
650

600

550

500

n

450
0

 2



3 2

2



FIG. 2. (a) shows the elements of the state vector for twoqutrit state through two-qutrit squeezing evolution. (b) shows the values of  from Eq. (29) in blue, and the value of  from Eq. (43) in green. These are numerical results where we have optimized the value of 3. (c) shows the number of measurements needed to verify two-qutrit state with error rate = 0.01 and failure probability  = 0.1.

red line is |22 . Like in the two-qubit case, different types of states require more specialized strategies. At the beginning and end of the evolution the state is separable, and so the optimal strategy is straightforward. Also like the two-qubit case, at  =  we yield the state (|00 + |11 )/ 2. To verify the state at this point, we simply need to utilize the strategy in Eq. (12). We note that other points in the evolution may themselves require a separate form of a strategy to be more efficient or optimal, however we will now consider a more general form of a two-qutrit strategy.
In order to provide a strategy to verify a general twoqutrit state in this evolution, we need to consider the structure of a generalized strategy. A strategy for two qutrits can be generated as the convex sum

8
 = cii,
i=1

(28)

where is i is a rank-i strategy. Like for Eq. (14), each rank-i strategy, i, is generated by a weighted sum of

projectors Pik, where each Pik | = | . We want to construct each i so that, given a set of
states l orthogonal to | , we minimize the maximum value of l i l . After finding each substrategy, we want to find the values of ci in Eq. (28) such that we minimize the maximum value of l  l . Now, to simplify the strategy and to create analogy to the two-qubit
case, we will consider rank-3 and rank-7 substrategies.
We can then introduce our general strategy

 = PZ+Z3 + (1 - ) j7,

(29)

j

where rank-3 part is constructed

PZ+Z3 = |00 00| + |11 11| + |22 22| ,

(30)

and the rank-7 strategy is of the form

j7 = 7j (19 - (j7  7j + j7  7j))

(31)

where | j7  7j | = | j7  7j | = 0. Note that we generalize PZ+Z2 for two qubits to PZ+Z3 as
this provides the same role of always accepting a state that is in the Schmidt decomposition, while rejecting all other orthogonal states. We then need the second part of the strategy pull the down the probability of accepting one of the orthogonal state that PZ+Z3 accepts. Here we have chosen a rank-7 strategy of the form in Eq. (31), where more on how we construct part of the strategy can be found in App. D.
Following the logic for two qubits, we now consider two general states that are orthogonal to the target state. To simplify this calculation, let's first consider a general twoqutrit state

|(1, 2) = sin 2 cos 1 |00

(32)

+ sin 2 sin 1 |11 + cos 2 |22 ,

that is locally equivalent to any two-qutrit pure state. The state in Eq. (26) is generated by setting

1

sin2 

2

1 = arccos 2 2 cos2  + 6 + ( )

(33)

2 = arctan

1

2 cos2  + 6 - ( )

1 2

4

,

(34)

where ( ) is defined in Eq. (27). We can then choose two general states that are orthogonal to Eq. (32)

1 = (cos 1 cos 2 cos 3 - sin 1 sin 3) |00

+ (sin 1 cos 2 cos 3 + cos 1 sin 3) |11

- sin 2 cos 3 |22

(35)

2 = (cos 1 cos 2 sin 3 + sin 1 cos 3) |00

+ (sin 1 cos 2 sin 3 - cos 1 cos 3) |11

- sin 2 sin 3 |22 ,

(36)

that hold for any value of 3.

7

To create general separable states that are orthogonal entries. This results in separable states

to Eq. (26), we want to create an analog to the state in Eq. (20), this can be done by generating two states that are proportional to Eq. (35) and Eq. (36) in the relevant

|1(, ) = |7(, )  |7(, )

|2(, ) = 7 (, )  7(, ) ,

(37)

where

1 |7(, ) = N1

cos 1 cos 2 cos 3 - sin 1 sin 3 |0 + ei1 sin 1 cos 2 cos 3 + cos 1 sin 3 |1

+ ei2 - sin 2 cos 3 |2

(38)

1 |7(, ) = N1

cos 1 cos 2 cos 3 - sin 1 sin 3 |0 + e-i1 sin 1 cos 2 cos 3 + cos 1 sin 3 |1

+ e-i2 - sin 2 cos 3 |2

(39)

7 (, )

1 = N2

cos 1 cos 2 sin 3 + sin 1 cos 3 |0 + ei1 sin 1 cos 2 sin 3 - cos 1 cos 3 |1

+ ei2 - sin 2 sin 3 |2

(40)

7(, )

1 = N2

cos 1 cos 2 sin 3 + sin 1 cos 3 |0 + e-i1 sin 1 cos 2 sin 3 - cos 1 cos 3 |1

+ e-i2 - sin 2 sin 3 |2 ,

(41)

whose construction is shown in App. D, and N1 and N2 are the appropriate normalizations of these states. Eq. (31) then becomes

j7 = 7j 19 - |n(, ) n(, )|

(42)

n

We now have the two parts of the strategy in Eq. (29). To calculate the sum of the rank-7 strategies, we need to average over all values of 1 and 2. Like before for the phase terms, we can take 1, 2 = {0, 2/3, 4/3}. Averaging over these discrete values is equivalent to integrating over both  degrees of freedom.
Next we need to consider what values of 3 we need for each  . Here we will simply choose a fixed value of 3, rather than averaging over different values like we did with the  degrees of freedom. Our goal is to devise an efficient strategy that is simply scalable to higherdimensional systems, and the procedure is vastly simplified by choosing a fixed value of 3.
Note that when generalizing to qudits in Section V, we will simply let the extra  degrees of freedom be 0; in this section however, we will choose the optimal value for a single choice of 3 for each time step ­ note that this does not necessarily mean that the overall strategy is optimal.
Given a value of 3, we can now build an orthonormal basis to describe the construction of our strategy. These are the target state and 8 orthogonal states i for 1  i  8, where 1 and 2 are in Eq. (35) and

Eq. (36) respectively. The other six states are 3 = |01 , 4 = |02 , 5 = |10 , 6 = |12 , 7 = |20 , 8 = |21 .
Considering the strategy in the form of Eq. (29), we
now need to use these states to find an efficient strategy. Like in the two qubit-case, the PZ+Z3 term accepts the | , 1 and 2 with certainty and rejects all the other states that are orthogonal to these three. 7 accepts | with certainty and accepts all other states with a non-
zero probability. It provides a role of pulling down the probability of accepting 1 and 2 , while increasing the probability of accepting the other orthogonal states.
All that is required is to optimize  to ensure the lowest
chance of accepting a state orthogonal to | .
We now apply this strategy to the target state. At
the beginning of the evolution, 0 <  < /2, setting
3 = 0 is the optimal choice of 3. Given this choice of 3, we will now consider the how the components of the strategy interact with the basis states. For the 7 part of the strategy, the largest value of i 7 i is for 8 . Likewise, the largest value for i PZ+Z3 i is for 2 . To optimize the strategy, we then need to solve 8  8 = 2  2 . The resulting solution of  is shown in the blue line in Fig. 2 (b). For the rest of
the evolution, we then numerically optimize over values
of 3.
After calculating the optimal value of  for the given
construction, we can then calculate the corresponding

8

value of , were

 = max
i

i

 i

,

(43)

is the highest probability that an orthogonal state will be accepted. We have shown the values of  over time in Fig. 2 (b) in green.
Taking the values of , we can then calculate the optimal number of measurements needed to verify that a given state has been generated, up to some error and some failure probability . Given these parameters, we need to take

ln -1 n

ln

1 1- (1-)

(44)

measurements [5, 15, 40]. Saturating this inequality, we

get the values of n in Fig. 2 (c), where we have chosen

= 0.01,  = 0.1.

The value of  at each point is important to understand

and to minimize, we can see in Eq. (44) its role in lowering

the number of measurements needed to verify a target

state. We can also see this by considering a given pure

state

 | = 1 -

 | +

 ,

(45)

where | is the target states and  is some state orthogonal to the target state ­ that could be any superposition of i discussed earlier.
Applying this erroneous state to the strategy we yield
|  | = 1 - +    (46)
= 1 - (1 - )

which can be seen by noting the requirement  | = | . If  = 1, then this equals 1, resulting in a state that is demonstrably not the target state being accepted by the strategy. Since  = 1 nowhere, this strategy can successfully distinguish the target state from any other state.
Note that Fig. 2 (b) and (c) only provide the answers when using the strategy in Eq. (29). As we have already shown, certain states are special cases and can be verified more efficiently using a modified strategy. This has already been shown for  = 0, , 2 in Section III A. Explicitly, keeping the same values for and , this reduces the number of measurements needed from 460 to 229 for  = 0, 2; and from 695 to 345 for  = .

B. Fidelity estimation
The fidelity estimation protocol for two qubits can easily be extended for a two-qutrit system. The general protocol to do this can be found in App. A. We give now given an explicit example of two-qutrit systems here.
First we need to begin with a characteristic function. This first requires a basis that is a generalization of the

0.5
(a)

0

(1, 1) = -(2, 2)

(4, 4) = -(5, 5)

(6, 6) = -(7, 7)

-0.5

0



2



0.5
(b)

0.25



(3, 3)

0 (3, 8) = (8, 3) (3, 0) = (0, 3)

(8, 8)

(8, 0) = (0, 8)

-0.25

0



2



FIG. 3. Elements of the two-qutrit characteristic function of the state Eq. (26) throughout the two-qutrit squeezing evolution. (a) shows six of the elements, which are constructed from the off-diagonal generators of su(3). These come in pairs, half of the elements and -1 times the other half. (b) shows the elements of the characteristic function that are generated from the diagonal operators. Note that (0, 0) = 1/3 always and so is not included in these plots.

Pauli operators for qubits. The generalization of the Pauli operators can be done in various ways, where it is common to either choose the Weyl algebra or the su(N ) algebra. Here we will consider the su(3) algebra, also known as the Gell Mann matrices. The su(3) algebra is commonly represented by the matrices

0 1 0

0 -i 0

13 = 1 0 0 , 23 =  i 0 0

000

000

0 0 1

0 0 -i

43 = 0 0 0 , 53 = 0 0 0 

100

i0 0

0 0 0

0 0 0 

(47)

63 = 0 0 1 , 73 = 0 0 -i

010

0i 0

1 33 = 0
0

0 -1 0

0 0 , 0

83

=

1 3

1 0
0

0 1 0

0 0 . -2

Along with the identity operator 03 = 1 we have an informationally complete Weyl function for two qutrits

1 (k, k ) = NkNk

Tr

 k3  k3

(48)

where



Nk =

3 2

for k = 0, otherwise.

(49)

9

100%
50%
0% 0
mi

(0, 8) (8, 0) (0, 3) (3, 0) (8, 3) (3, 8) (8, 8) (7, 7) (6, 6) (5, 5) (4, 4) (3, 3) (2, 2) (1, 1) (0, 0)



2



0



2

(0,0()1,1()2,2()3,3()4,4()5,5()6,6()7,7()8,8()3,8()8,3()3,0()0,3()8,0()0, 8)

FIG. 4. Direct fidelity estimation of two-qutrit states during the squeezing evolution. (a) shows the average proportion each measurement basis is chosen, where each color represents a different value of the characteristic function, where the values representing the colors are shown on the right-hand side. These measurements are shown for each point in the evolution, that goes along the horizontal axis. The proportion each basis takes along the vertical axis then corresponds to the probability any given basis has of begin chosen for measurement. (b) shows the number of measurements needed when each of the bases are chosen. Note that the vertical axis is on a logarithmic scale.

For our target state from Eq. (26), at most 15 element of the characteristic function are non-zero. Where at  = 0, , 2 even fewer are non-zero. The elements of the characteristic function over time are shown in Fig. 3.
In Fig. 3 we separate the elements of the characteristic function into the diagonal and off-diagonal operators. This is because all of the diagonal operators needed are symmetric, i. e. k = k . This then generates six of the elements of the characteristic function. These can be found in Fig. 3 (a), where only three curves are shown since (2, 2) = -(1, 1), (5, 5) = -(4, 4) and (7, 7) = -(6, 6)
The other nine elements of the characteristic function come from all combinations of the three diagonal operators. This produces five the unique values shown in Fig. 3 (b) where (i, j) = (j, i) for i, j  {0, 3, 8}.

Note that (0, 0) = 1/3 always, and so isn't included in Fig. 3 (b).
Now that we have the values for the characteristic function of the target state at each point in the evolution, we can now consider how many measurements are needed for fidelity estimation. Given choices of basis in Eq. (24), we can calculate the probability each basis will be chosen. This is shown visually in Fig. 4 (a), where we have presented the measurement bases as the average percentages for each time step. Each measurement basis is represented by a unique color in the contour plot. The area each color takes up in the vertical axis is the average proportion of the measurements each basis will be chosen, for each moment in the time of the evolution.
Because (0, 0) = 1/3 always, we can see how measurement of 1  1 has an 11% chance of being chosen. Also note that at certain points, far fewer bases need to be taken, where at  = 0, , 2, there are four fewer measurement bases that need to be considered.
Now we need to consider how many measurements are needed when each basis is chosen. This is calculated by

2

mi = N2kN2k 2(ki, ki)2 log(2/) .

(50)

Choosing = 0.01 and  = 0.1 to calculate mi for each point in the evolution, we yield the results in Fig. 4 (b). Again each basis is represented by a unique color, where the vertical axis shows the number of measurements needed on a log axis. When value of the characteristic function is particularly small, the number of measurements needed increase with 1/2, resulting in some large peaks in Fig. 4 (b).
This gives the number of measurements needed to calculate the fidelity, by following the procedure laid out in App. A one can then estimate the fidelity of any of the states produced in this evolution.

V. TWO-QUDIT QUANTUM STATE VERIFICAITON

Given the previous results for two-qubit systems and the extension to two-qutrit systems, we now further generalize these results to two qudits of arbitrary dimension. We will focus on the construction of an efficient procedure to verify a general two-qudit state, where the generalization of the fidelity estimation protocol is given in App. A.
To generalize the construction of this strategy to a bipartite system of any dimension, we first need to define the substrategies. Like in Eq. (29), the strategy is built from two parts. The first part is the generalization of the PZ+Zd operator, this is simply

d-1
PZ+Zd = |dd dd| .
i=0

(51)

10

The second part is to generalize the rank-7 part of the strategy in Eq. (29). In general we will require a rank-r strategy, where r = (d2 - d + 1). This rank-r strategy needs to itself be constructed from separable states that are orthogonal to the target state. We then in effect build a rank-d - 1 strategy from the projectors of these states, that we then subtract from the identity operator, generating a rank-r strategy.
In Eq. (35) and Eq. (36) we gave two general states that are orthogonal to the target state. We then went onto making separable versions of these states. Specifically, this involved creating a separable state, di (, ) , where

kk di (, ) =

kk i

, (52)

di (, )|di (, )

i. e. the |kk elements of the separable states are proportional to kk i .
To generalize these states, we first need a reliable method to create an orthonormal basis for a ddimensional system. One way is to adapt the coherentstate approach for states with an SU(d) symmetry [42, 43]. The procedure to do this is given in App. C.
The goal is to use the Euler-angle construction to compose a coherent state whose elements are the Schmidt coefficients of the target state. That is, given the Schmidt decomposition of a general two-qutrit target state

d

| = ck |kk ,

(53)

k=1

we wish to create a coherent state

d

| = ck |k ,

(54)

k=1

finding the solution for the  degrees of freedom. In
the spin-coherent state construction, this is defined as
the Euler operator applied to the highest-weighted state,
|d - 1 .
We can then generate an orthonormal basis by ap-
plying the Euler operator to the other computational
basis states, |k where 0  k < d - 1. By reversing
the step from Eq. (54) to Eq. (53) we can convert these
single-qudit orthogonal states into two-qudit states in the
Schmidt decomposition, which are the generalization of 1 and 2 from Eq. (35) and Eq. (36). This along with the states |k1k2 , where k1 = k2, builds a basis for a two-qudit strategy.
From the first d - 1 orthogonal states i , and by following the procedure in App. C, we can then get a general set of separable states di (, ) for i = 1...d - 1, that are orthogonal to the target state.
The steps are now similar to the two-qutrit case, where
we now generate

1 r = 3d-1


d-1

1d -

dn(, ) dn(, )

n=1

. (55)

n
2200 1800 1400 1000
600 0
 1 2
1 4

(a)

 2




d = 2, 3, 5, 11, 21

(b)

0

 2





FIG. 5. The number of measurements needed to verify a state with = 0.99 and  = 0.1. (a) shows the number of measurements needed for the two-qudit squeezing evolution for d = 2, 3, 5, 11, and 21 for 0    . (b) is the value of  for each case, that shows the balance between the PZ+Zd and r substrategies. Note that we have only shown half the evolution here as the second half identical, only reversed.

The sum over  is an average over the phases, where we
restrict this to each i = {0, 2/3, 4/3}. This results in 3d-1 different phases.
We now need to build the full strategy

 = PZ+Zd + (1 - )r,

(56)

where we want to optimize over  and , where  = {d-1, ..., d(d-1)/2}. Although a more efficient strategy
can be found by optimizing over , it is a far more simple construction to just set  = 0. Given this compromise in optimality, we have calculated the optimal values for  in these cases numerically.
We have applied this to the two-qudit squeezed Hamiltonian for d = 2, 3, 5, 11 and 21, showing the results for the number of measurements needed and the values of  in Fig. 5. Note that we have considered 0     here, as the results are just reversed for the second half of the evolution. From the value of  we can then construct an efficient strategy. From this strategy, we just need to find the second largest eigenvalue, . Applying this value of  to Eq. (44) then yields the number of measurements needed to verify that the desired state is generated within some choice of and . Fig. 5 (b) shows this calculated for = 0.01 and  = 0.1.

VI. CONCLUSIONS
Here we have provided procedures to generate efficient strategies to verify ­ and to directly estimate the fidelity

11

of ­ two-qudit states, both with local measurements. Although not optimal, this quantum-state verification procedure is simply extendable to a bipartite system of any size.
The strategies provided can be used to verify any twoqudit state, where a two-qudit target state in the Schmidt decomposition has d - 1 degrees of freedom. We gave examples of how these strategies perform in the two-qudit squeezing evolution. The states produced in this evolution are of particular interest as both two-qudit squeezed states and various entangled states are generated. States that are of particular interest in a quantum technology setting.
We also note that the techniques used here can be used to verify a single-axis twisting Hamiltonian on a single qubit, by utilizing the Choi-Jamiolkowski isomorphism and verifying the two-qutrit Choi matrix [44]. Both the single-qudit and two-qudit squeezing evolutions have themselves seen significant interest, whether in creating large entangled state [33] or when entangling Bose Einstein condensates [37­39]. It is therefore conceivable that we could use the strategies provided in this work to experimentally verify the creation of these bipartite squeezed and entangled Bose Einstein condensates.

We have focussed here on providing a simple procedure to generate a strategy for two qudit states, but this may have sacrificed optimality. Future work is needed to optimize these strategies, which will require optimizing over the degrees of freedom; whether by averaging over many values or by finding an optimal value. Further optimization may also come in the form of introducing more and different types of components to the strategy.
We also note that an adaptation of the strategy could be useful when applied to a bipartite infinite-dimensional system, if we choose to truncate the Hilbert space to some degree. We could then apply this method to verify the creation of two-mode squeezed states. However, this would depend on the possibility of measuring the necessary observables in such systems.
ACKNOWLEDGMENTS
We would like to thank Noah Linden for general support and enlightening conversation. We would also like to thank Martin Kliesch for interesting discussions. The author acknowledges support from the EPSRC grant number EP/T001062/1 (EPSRC Hub in Quantum Computing and Simulation).

[1] G. Mauro D'Ariano, Matteo G.A. Paris, and Massimiliano F. Sacchi, "Quantum tomography," (Elsevier, 2003) pp. 205­308.
[2] Daniel F. V. James, Paul G. Kwiat, William J. Munro, and Andrew G. White, "Measurement of qubits," Phys. Rev. A 64, 052312 (2001).
[3] G Mauro D'Ariano, Martina De Laurentis, Matteo G A Paris, Alberto Porzio, and Salvatore Solimeno, "Quantum tomography as a tool for the characterization of optical devices," Journal of Optics B: Quantum and Semiclassical Optics 4, S127­S132 (2002).
[4] David Gross, Yi-Kai Liu, Steven T. Flammia, Stephen Becker, and Jens Eisert, "Quantum state tomography via compressed sensing," Phys. Rev. Lett. 105, 150401 (2010).
[5] Martin Kliesch and Ingo Roth, "Theory of quantum system certification," PRX Quantum 2, 010201 (2021).
[6] Alexandru Gheorghiu, Theodoros Kapourniotis, and Elham Kashefi, "Verification of quantum computation: An overview of existing approaches," Theory of Computing Systems 63, 715­808 (2019).
[7] Jens Eisert, Dominik Hangleiter, Nathan Walk, Ingo Roth, Damian Markham, Rhea Parekh, Ulysse Chabaud, and Elham Kashefi, "Quantum certification and benchmarking," Nature Reviews Physics 2, 382­390 (2020).
[8] Otfried Gu¨hne and G´eza To´th, "Entanglement detection," Physics Reports 474, 1­75 (2009).
[9] Ryszard Horodecki, Pawel Horodecki, Michal Horodecki, and Karol Horodecki, "Quantum entanglement," Rev. Mod. Phys. 81, 865­942 (2009).
[10] T. Baumgratz, M. Cramer, and M. B. Plenio, "Quantifying coherence," Phys. Rev. Lett. 113, 140401 (2014).

[11] Alexander Streltsov, Uttam Singh, Himadri Shekhar Dhar, Manabendra Nath Bera, and Gerardo Adesso, "Measuring quantum coherence with entanglement," Phys. Rev. Lett. 115, 020403 (2015).
[12] Ashley Montanaro and Ronald de Wolf, "A survey of quantum property testing," Theory of Computing Graduate Surv 7 (2016), DOI: 10.4086/toc.gs.2016.007.
[13] Steven T. Flammia and Yi-Kai Liu, "Direct fidelity estimation from few pauli measurements," Phys. Rev. Lett. 106, 230501 (2011).
[14] Marcus P. da Silva, Olivier Landon-Cardinal, and David Poulin, "Practical characterization of quantum devices without tomography," Phys. Rev. Lett. 107, 210404 (2011).
[15] Sam Pallister, Noah Linden, and Ashley Montanaro, "Optimal verification of entangled states with local measurements," Phys. Rev. Lett. 120, 170502 (2018).
[16] Masahito Hayashi and Tomoyuki Morimae, "Verifiable measurement-only blind quantum computing with stabilizer testing," Phys. Rev. Lett. 115, 220502 (2015).
[17] Huangjun Zhu and Masahito Hayashi, "Optimal verification and fidelity estimation of maximally entangled states," Phys. Rev. A 99, 052346 (2019).
[18] Zihao Li, Yun-Guang Han, and Huangjun Zhu, "Efficient verification of bipartite pure states," Phys. Rev. A 100, 032316 (2019).
[19] Kun Wang and Masahito Hayashi, "Optimal verification of two-qubit pure states," Phys. Rev. A 100, 032315 (2019).
[20] Xiao-Dong Yu, Jiangwei Shang, and Otfried Gu¨hne, "Optimal verification of general bipartite pure states," npj Quantum Information 5, 112 (2019).

12

[21] G. Breitenbach, S. Schiller, and J. Mlynek, "Measurement of the quantum states of squeezed light," Nature 387, 471­475 (1997).
[22] Samuel L. Braunstein and Peter van Loock, "Quantum information with continuous variables," Rev. Mod. Phys. 77, 513­577 (2005).
[23] A. Furusawa, J. L. Sørensen, S. L. Braunstein, C. A. Fuchs, H. J. Kimble, and E. S. Polzik, "Unconditional quantum teleportation," 282, 706­709 (1998).
[24] Nicolas C. Menicucci, Steven T. Flammia, and Olivier Pfister, "One-way quantum computing in the optical frequency comb," Phys. Rev. Lett. 101, 130501 (2008).
[25] E. S. Polzik, J. Carri, and H. J. Kimble, "Spectroscopy with squeezed light," Phys. Rev. Lett. 68, 3020­3023 (1992).
[26] B. J. Lawrie, P. D. Lett, A. M. Marino, and R. C. Pooser, "Quantum sensing with squeezed light," ACS Photonics, ACS Photonics 6, 1307­1318 (2019).
[27] S S Y Chua, B J J Slagmolen, D A Shaddock, and D E McClelland, "Quantum squeezed light in gravitationalwave detectors," Classical and Quantum Gravity 31, 183001 (2014).
[28] J. Aasi, J. Abadie, B. P. Abbott, R. Abbott, T. D. Abbott, M. R. Abernathy, C. Adams, T. Adams, P. Addesso, R. X. Adhikari, and et al, .
[29] J. Abadie, B. P. Abbott, R. Abbott, T. D. Abbott, M. Abernathy, C. Adams, R. Adhikari, C. Affeldt, B. Allen, G. S. Allen, and et al, .
[30] Ian D. Leroux, Monika H. Schleier-Smith, and Vladan Vuleti´c, "Orientation-dependent entanglement lifetime in a squeezed atomic clock," Phys. Rev. Lett. 104, 250801 (2010).
[31] Anne Louchet-Chauvet, Ju¨rgen Appel, Jelmer J Renema, Daniel Oblak, Niels Kjaergaard, and Eugene S Polzik, "Entanglement-assisted atomic clock beyond the projection noise limit," New Journal of Physics 12, 065032 (2010).
[32] G. S. Agarwal, R. R. Puri, and R. P. Singh, "Atomic schr¨odinger cat states," Phys. Rev. A 56, 2249­2254 (1997).
[33] Chao Song, Kai Xu, Hekang Li, Yuran Zhang, Xu Zhang, Wuxin Liu, Qiujiang Guo, Zhen Wang, Wenhui Ren, Jie Hao, Hui Feng, Heng Fan, Dongning Zheng, Dawei Wang, H. Wang, and Shiyao Zhu, "Generation of multicomponent atomic schro¨dinger cat states of up to 20 qubits," Science 365, 574­577 (2019).
[34] F. T. Arecchi, Eric Courtens, Robert Gilmore, and Harry Thomas, "Atomic coherent states in quantum optics," Phys. Rev. A 6, 2211­2237 (1972).
[35] A. Perelomov, Generalized Coherent States and Their Applications (Springer-Verlag, Berlin, 1986).
[36] W. H. Chan and C. K. Law, "Fractional revivals and quantum entanglement via coupled angular momenta," Phys. Rev. A 74, 024301 (2006).
[37] Tim Byrnes, Kai Wen, and Yoshihisa Yamamoto, "Macroscopic quantum computation using bose-einstein condensates," Phys. Rev. A 85, 040306 (2012).
[38] Tim Byrnes, "Fractality and macroscopic entanglement in two-component bose-einstein condensates," Phys. Rev. A 88, 023609 (2013).
[39] Xin Meng, Jonas Kitzinger, Matteo Fadel, Valentin Ivannikov, Kae Nemoto, William J. Munro, and Tim Byrnes, "Bell correlations in a split two-mode-squeezed boseeinstein condensate," arXiv preprint arXiv:2101.06190

[quant-ph] (2021), 2101.06190. [40] Huangjun Zhu and Masahito Hayashi, "General frame-
work for verifying pure quantum states in the adversarial scenario," Phys. Rev. A 100, 062335 (2019). [41] Russell P. Rundle and Mark J. Everitt, "Overview of the phase space formulation of quantum mechanics with application to quantum technologies," Advanced Quantum Technologies , 2100016. [42] Kae Nemoto, "Generalized coherent states for SU (N ) systems," J. Phys. A: Math. Gen. 33, 3493 (2000). [43] Todd Tilma and Kae Nemoto, "SU (N )-symmetric quasiprobability distribution functions," J. Phys. A: Math. Theor. 45, 015302 (2012). [44] Ye-Chao Liu, Jiangwei Shang, Xiao-Dong Yu, and Xiangdong Zhang, "Efficient verification of quantum processes," Phys. Rev. A 101, 042315 (2020). [45] Martin Kliesch, "Lecture notes: Characterization, certification, and validation of quantum systems," . [46] D. Gross, "Hudson's theorem for finite-dimensional quantum systems," Journal of Mathematical Physics 47, 122107 (2006). [47] A. Vourdas, "Phase space methods for finite quantum systems," Rep. Math. Phys. 40, 367 ­ 371 (1997). [48] R. P. Rundle, Todd Tilma, J. H. Samson, V. M. Dwyer, R. F. Bishop, and M. J. Everitt, "General approach to quantum mechanics as a statistical theory," Phys. Rev. A 99, 012115 (2019). [49] William K Wootters and Brian D Fields, "Optimal statedetermination by mutually unbiased measurements," Annals of Physics 191, 363­381 (1989).

13

Appendix A: Fidelity estimation

Here we will discuss how the direct fidelity estimation protocols in Refs. [13, 14] can be extended to higherdimensional discrete systems. A similar result has been presented in terms of a frame theoretic construction [45]. By following these results and using an appropriate choice of operators for a characteristic function, this is a fairly simple extension. Further, the fidelity estimation of a bipartite states is particularly straightforward when considering the Schmidt decomposition of the state.
We begin by introducing the bipartite characteristic function for two qubits

1 (k, k ) = 2 Tr [ k  k ] .

(A1)

To generalize this to two-qudit states, we first need to generalize the characteristic function to higherdimensional states. To build a discrete characteristic function we need a set of d2 operators, we denote by Dd(k), that fully describe a single-qudit state. Such a choice is not unique, as there are many generalizations to the Pauli operators to higher-dimensional systems.
We show two of the most common approaches, the Weyl algebra and the su(d) algebra (or the generalized Gell Mann matrices). The construction of which can be found in App. B.
We note here that it is important that we normalize the characteristic function such that

|(k)|2 = 1,
k

(A2)

which is different from more standard constructions of a characteristic function, found in texts such as Refs. [41, 46­48].
Given a suitable choice of representation to build a characteristic function, Eq. (A1) can be generalized to

1 (k) = N (k) Tr [ Dd(k)] ,

(A3)

where k = (k, k ), Dd(k) = Dd(k)  Dd(k ) and N (k) = N (k)N (k ) is the normalization to ensure Eq. (A2) is
satisfied. This normalization can be simply calculated by requiring Tr Dd(k)Dd(k) /Nd(k)2 = 1. In practice this results in N (k) = d in the Weyl algebra case, and
N (k) = Tr [Dd(k)2] in the su(d) case. Note that we also require that Tr Dd(k1)Dd(k2) = 0 when k1 = k2.
From this, one can then calculate the fidelity

F (1, 2) = 1 (k) 2 (k)
k

(A4)

where we note that the characteristic function can be complex-valued, which is generally the case when using the Weyl algebra. Now that the characteristic function has been defined, we will now follow the protocol laid out in Ref. [13] for direct fidelity estimation.

Begin by choosing = 1/ 2 values of k, where is
the adaptive error and  is the failure probability. Each sample ki will be chosen with the probability |(ki)|2, for k1, ..., k . We then need to measure Dd(ki) a total of mi times, where

mi =

2 2N (ki)2 (ki)2 log(2/).

(A5)

Note that different approaches need to be taken here, depending on your choice of operators.
For each i, we then define the random variable

X (ki )

=

2 (ki) 1 (ki)

=

Tr [2 Dd(ki)] N (ki)1 (ki)

(A6)

such that E[X(ki)] = 1 (ki) 2 (ki). We can then calculate the estimator for X(ki) by

X~ (ki)

=

1 miN (ki) (ki)

mi
Mij .
j=1

(A7)

Repeating this process, we can then calculate the estimator for the fidelity

Y~ = 1 X~ (ki).
i=1

(A8)

This yields an estimator to the fidelity within the range [Y~ -2 , Y~ +2 ] with probability greater than 1-2. More
details on how to construct these for specific choice can
be found in App. B.
Because the measurement process involves choosing k with probability P (k) = 1 (k)2, any points where 2 (k) = 0 requires no measurement to be taken. Given the structure of the Schmidt decomposition, this results
in a big reduction in the number of measurement bases.
If all the measurements are needed, we would need the full d4 described by the representation, however this is reduced to at most d3 needing to be taken if considering the Weyl operators, and 2d2 - d if considering the su(2)
algebra.

Appendix B: Bases to measure the characteristic function
The generalization of the characteristic function in Section A to higher-dimensional systems can take multiple forms. Here we consider two approaches to construct the characteristic function with discrete degrees of freedom. These will be the Weyl algebra, also known as the clock and shift matrices. And the generators for su(d), also known as the generalized Gell-Mann matrices.
Note that one could also describe the characteristic function of a finite-dimensional system with continuous degrees of freedom, see for example Refs. [41, 48]; one could then use a procedure similar to the continuousvariable calculation of the fidelity in Ref. [14] to perform

direct fidelity estimation. Such an approach may be beneficial for particularly large Hilbert spaces, but is beyond the scope of this paper.

1. su(d) algebra

We will now focus on the construction of the characteristic function through the su(d) generalized Gell-Mann algebra. The diagonal generators are constructed

dn2-1 =

n-1

2 n(n-1)

|i i| -

i=1

2(n-1) n

|n

n| , (B1)

for n  2, and d0 = 1. The off-diagonal generators are simply the su(2) gener-
ators, spanning the full su(d) space. We can separate the
off-diagonal operators into two types, the generalization of ^x and ^y, where

Xdi,j = |i j - 1| + |j - 1 i| Yid,j = i |i j - 1| - i |j - 1 i|

(B2)

where 1  i  d - 1,1  j  i. Formally these operators
are then ordered with respect to an su(2) subspace of
su(d), see Refs. [43, 48] for more detail. However the
ordering is not that important as long as it is kept track
of. We will then assume some order and refer to the algebra by the matrices dk.
The characteristic function is then

1 (k) = N (k) Tr

 dk

,

(B3)

where to satisfy Eq. (A2) the normalization is

1 , for k = 0,

N (k) =

d
1 ,

for 1  k  d2 - 1.

2

(B4)

The characteristic function is informationally complete, and the full state can be reconstructed by

=

N

1 (k)



(k)dk ,

k

(B5)

where N (k) is the normalization required by the operators used to define the Weyl function.
The fidelity of some state, , with respect to a target state, , can then be calculated through the characteristic functions, where

Tr [] = (k)(k).
k

(B6)

From this we can then follow the procedure in Section A. It is now worth following the proof of this procedure as outlined in Ref. [13] and point how and why this still holds for the su(d) algebra. We want to prove that

14

the fidelity is estimated with in the range [Y~ - 2 , Y~ + 2 ] with probability greater than 1-2. Equivalently we can express this as

Pr |Y~ - F (1, 2)|  2  1 - 2.

(B7)

We begin by introducing Y = 1 i X(ki), where Y is an unbiased estimator of F (1, 2). Therefore by Cheby-
shev's inequality we can say

1 Pr [|Y - F (1, 2)|  ]  2


(B8)

from the definition of in Section A. Now that we have a relation for Y and the fidelity,
we want to consider Y~ . So far the procedure has followed previous work in Refs. [5, 13], this is where a little more care is needed for the su(d) algebra. Substituting Eq. (A7) into Eq. (A8) we yield

Y~

=

1

mi i=1 j=1

1 miN (ki) (ki) Mij,

(B9)

where E[Y~ ] = Y . For the multi-qubit case, we then move onto Hoeffd-
ing's inequality, where Mij  {-1, 1}. This results in the bounds

1

b±

=

± miN (ki)

(ki)

(B10)

and more importantly to the denominator in Hoeffding's inequality

2

|b|

=

b+

-

b-

=

. miN (ki) (ki)

(B11)

Applying Hoeffding's inequality

Pr |Y~ - Y |   2 exp 

-2 2
2 i=1 miN (ki) (ki)

(B12)

given the definition for mi. By applying union bound this results in the desired

Pr |Y~ - F (1, 2)|  2  1 - 2.

(B13)

Returning to Eq. (B9), we note that when using the
su(d) algebra the results of Mij change. Any single measurement of a state with any of the off-diagonal operator dk will still yield the result M  {-1, 1}. This leaves the inequality in Eq. (B12) unchanged. A measurement
with any of the diagonal operators will on the other hand
yield

Mij 

-

2(n-1) n

,

2 n(n-1)

.

(B14)

And so for these measurements, Y~ is bounded by this new interval, dependent on the measurement choice.
Considering bipartite systems, we can choose two values, n1 and n2, where we say n1 the choice of a diagonal operator for the first qudit and n2 is the choice for the second qudit. The measurement outcomes can now be anywhere between

-

2(n1 -1) n1

n2

2 (n2

-1)

,

resulting in the difference

2 n1 (n1 -1)

2 n2 (n2 -1)

,

(B15)

2

n1

 2,

(n1 - 1)n2(n2 - 1)

(B16)





since 0 < 1/(n2(n2 -1)) < 1/ 2, and 2n1/(n1 -1)  2.

The bound to put into Hoeffding's inequality are now

2 |bn1n2 | = miN (ki) (ki)
2 
miN (ki) (ki)
so

n1 (n1 - 1)n2(n2 - 1)

(B17)

Pr |Y~ - Y | 

 2 exp  2 exp  .

-2 2 i=1 |bn1n2 | -2 2 i=1 |b|

(B18)

Therefore, the results from Section A hold for this choice of basis.

2. Weyl algebra

The Weyl algebra can be constructed from the generators Zd and Xd, defined

Zd |k d = e2i/d |k d , Xd |k d = |k  1 d ,

(B19)

where the  is addition modulo k. The particulars of the construction of the characteristic function now depend on the dimension of the system in question, and there are multiple rules one can follow. Much work has focussed on a Galois field theory construction that valid only for d being prime, see for example Ref. [47]. The prime construction has an advantage in that a set of d+ 1 mutually orthogonal bases (MUBs) exist for such dimensions.
Here we will focus on the construction from Gross in Ref. [46], here we are concerned with d being odd. Note that this is informationally complete for any dimension as long as we only consider the characteristic function. Ref. [46] focussed on generating a discrete Wigner

15

function for prime-dimensional systems through a discrete Fourier transform from the characteristic function; although this only defines a prime-dimensional Wigner function, the characteristic function can define a system of any dimension.
Given the generators in Eq. (B19), the Weyl algebra can by fully described by the Weyl operator

Dd(p, q) = exp(-ipq/d)ZpXq.

(B20)

The characteristic function for one qudit can then be generated by taking

1 (p, q) = 

Tr

 Dd(p, q)

.

d

(B21)

This is an informationally complete function, where the state can be recovered

1  =  (p, q)Dd(p, q).
d q,p

(B22)

The fidelity can then be calculated

F (1, 2) = Tr [12] = 1 2

(B23)

Note that in this case that the operators are now nonHermitian and the characteristic function may have complex values. Of course, since the Dd(p, q) operators are not observables, in practice the actual measurement of the characteristic function will be constructed from eigenstates of the given operator. This is the advantage of choosing p-prime for this method, as we are guaranteed to have a set of d + 1 MUBs [49].
Note that we also need to consider complex numbers. Because of this, Eq. (A7) may need extra care, which gives using the su(d) a preferential advantage. However, The advantage of using the Weyl algebra is that N (ki) =
d for all i, resulting in N (ki) = d in Eq. (A7).

16

Appendix C: Generalized Euler Angles and the construction of the two-qutrit strategy

We begin by defining the generalized SU(d) Euler angles, that can be created from a subset of the generators of su(d), that can be found in App. B 1. The definition of the Euler angles presented here will differ from more standard approaches, where we will concentrate only on the generalization of a ^y rotations. Where we define

Ykd,1 = i |k 0| - i |0 k|

(C1)

Note that we only require this subset of the operators for the states we want to generate.
The rotation operator is then defined

2q

Rd() =

exp((-1)1-q,d-1 iYpd,1p-1+j(q)), (C2)

q=d p=2

where j(q) = 0 when q = d and j(q) =

d-q i=1

(d

-

i)

otherwise. Applying this to the highest-weighted state

then yields the coherent state

| d = Rd() |d - 1 ,

(C3)

where

 sin d-1 

d-1 i=1

cos

i,

k | d = cos(d-1)

sin d-1 sin k

d-1 i=k

cos

i,

if k = 0, if k = d - 1, otherwise.
(C4)

Note that only the first d - 1 degrees of freedom have

any effect on the highest-weighted state. This is ideal as

this is the number of degrees of freedom needed to fully

define the elements of the target state in the Schmidt

decomposition. The other degrees of freedom will, how-

ever, have an effect on the orthogonal states, this allows

us to optimize over these extra degrees of freedom to find

a more efficient strategy.

The elements of the coherent state then coincide with

the elements of the target state in the Schmidt decom-

position, | , when we choose

 arctan 

2| 1|



k = arccos( d - 1 | )

 arcsin

k| N (k,d)

if k = 1, if k = d - 1, otherwise,

(C5)

where

d-1

N (k, d) =

sin(i).

i=k+1

(C6)

We can now redefine the target state in terms of this coherent state structure, where

d-1
| = k| |kk .
k=0

(C7)

An orthogonal basis can then be constructed by

d-1

i =

k| Rd() |i - 1 |kk ,

k=0

(C8)

for i = 1...d - 1. To generate separable states that are orthogonal to the
target state, we then define

i (, ) i(, )

=

1

d-1
eik

Ni k=0

=

1

d-1
e-ik

Ni k=0

k| Rd() |i - 1 |k

(C9)

k| Rd() |i - 1 |k ,

where 0 = 0 and

Ni =

d-1
eik | k| Rd() |i - 1 |
k=0

(C10)

The general separable orthogonal states are then generated by

|i(, ) = i (, )  i(, ) .

(C11)

17

Appendix D: Elements of the qutrit strategy

To create general separable states that are orthogonal to Eq. (26), we need states that are proportional to Eq. (35) and Eq. (36) in the relevant entries. We then follow the procedure laid out in App. C for d = 3. This results in the rotation operator

cos 1 cos 2 cos 3 - sin 1 sin 3 R3() = sin 1 cos 2 cos 3 + cos 1 sin 3
- sin 2 cos 3

cos 1 cos 2 sin 3 + sin 1 cos 3 sin 1 cos 2 sin 3 - cos 1 cos 3
- sin 2 sin 3

cos 1 sin 2 sin 1 sin 2  .
cos 2

(D1)

We can then create the coherent state

cos 1 sin 2
| 3 = R3 |2 = sin 1 sin 2  cos 2

(D2)

whose entries correspond to the coefficients to the Schmidt decomposition of a two-qutrit state, given in Eq. (32). We also have two orthogonal states

cos 1 cos 2 cos 3 - sin 1 sin 3

1 = R3 |0 = sin 1 cos 2 cos 3 + cos 1 sin 3

3

- sin 2 cos 3

(D3)

and

cos 1 cos 2 sin 3 + sin 1 cos 3

2 = R3 |1 = sin 1 cos 2 sin 3 - cos 1 cos 3

3

- sin 2 sin 3.

(D4)

From these, using Eq. (C9), we can then construct two separable states |7(, )  |7(, ) and 7 (, )  7(, ) , where

1 |7(, ) = N1

cos 1 cos 2 cos 3 - sin 1 sin 3 |0 + ei1 sin 1 cos 2 cos 3 + cos 1 sin 3 |1

+ ei2 - sin 2 cos 3 |2

(D5)

1 |7(, ) = N1

cos 1 cos 2 cos 3 - sin 1 sin 3 |0 + e-i1 sin 1 cos 2 cos 3 + cos 1 sin 3 |1

+ e-i2 - sin 2 cos 3 |2

(D6)

7 (, )

1 = N1

cos 1 cos 2 sin 3 + sin 1 cos 3 |0 + ei1 sin 1 cos 2 sin 3 - cos 1 cos 3 |1

+ ei2 - sin 2 sin 3 |2

(D7)

7(, )

1 = N1

cos 1 cos 2 sin 3 + sin 1 cos 3 |0 + e-i1 sin 1 cos 2 sin 3 - cos 1 cos 3 |1

+ e-i2 - sin 2 sin 3 |2 ,

(D8)

where the N are the appropriate normalizations for the states and (, ) = (1, 2, 3, 1, 2). These states can now be put into Eq. (31), where j7 = |7(, ) 7(, )|, and likewise for 7j, j7 and 7j.

