1
On the Stability of Mixed Finite-Element Formulations for High-Temperature Superconductors
Julien Dular, Mané Harutyunyan, Lorenzo Bortot, Sebastian Schöps, Benoît Vanderheyden, and Christophe Geuzaine

arXiv:2106.00313v1 [math.NA] 1 Jun 2021

Abstract--In this work, we present and analyze the numerical stability of two coupled finite element formulations. The first one is the h-a-formulation and is well suited for modeling systems with superconductors and ferromagnetic materials. The second one, the so-called t-a-formulation with thin-shell approximation, applies for systems with thin superconducting domains. Both formulations involve two coupled unknown fields and are mixed on the coupling interfaces. Function spaces in mixed formulations must satisfy compatibility conditions to ensure stability of the problem and reliability of the numerical solution. We propose stable choices of function spaces using hierarchical basis functions and demonstrate the effectiveness of the approach on simple 2D examples.
Index Terms--Finite element analysis, high-temperature superconductors, mixed formulations, stability analysis.
I. INTRODUCTION
M ODELING accurately and efficiently the magnetic response of high-temperature superconductors (HTS) is important for the developement of numerous magnet and electrical power applications, e.g., superconducting rotating machines. One of the main tools used to model the properties of superconductors is the finite element method (FEM), based on formulations of Maxwell's equations combined with the E-J power law. This law is strongly non-linear and requires a carefully chosen formulation.
In the past few years, several FEM models based on coupled formulations have been proposed. An h-a-formulation was introduced in a 2D model of rotating machines with superconducting windings [1]. The superconducting materials were modeled with an h-formulation, whereas the continuity conditions between the fixed and the rotating parts were treated with the a-formulation. A second h-a-formulation formulation was introduced for modeling HTS magnets with a coupling to an external circuit, in order to reduce the number of degrees of freedom in the non-superconducting regions [2] with respect to a full h-formulation [3], [4]. A third h-a-formulation was considered for systems containing superconductors and ferromagnets, in order to model each material with its most efficient formulation [5]. Another type of combined formulation, the ta-formulation, was introduced in [6] to model superconducting tapes, presenting a high width over thickness ratio. The current
J. Dular, B. Vanderheyden, and C. Geuzaine are with the Department of Electrical Engineering and Computer Science, Institut Montefiore B28 in University of Liège, B-4000 Liège, Belgium.
M. Harutyunyan, L. Bortot, and S. Schöps are from Computational Electromagnetics, Technical University of Darmstadt, Germany.
L. Bortot is with CERN, Geneva, Switzerland. J. Dular is a research fellow funded by the F.R.S-FNRS.

density inside the tapes was described by a surface current potential, whereas the magnetic field outside the tape was expressed with a magnetic potential. Both fields were coupled by means of integrals on the surface of the (infinitely thin) HTS tape. In [2], the same formulation is derived from the h-a-formulation with a thin-sheet approximation. The t-aformulation has also recently been extended to finite volume systems, e.g., by modeling a stack of tapes in full or in parts as an equivalent homogeneous bulk material [7], [8].
In each of these coupled formulations, different finite element fields are introduced region-wise, while they coexist and are coupled through a common boundary or a common region. The coupling makes these formulations mixed, for which care must be taken in the choice of function spaces and the discretization. For instance, naive choices of approximation function spaces can easily lead to stability issues manifesting themselves as spurious oscillations in the numerical solution (chapter 8 of Ref. [9]). Such oscillations have been indeed observed numerically in the t-a-formulation [7] when using first-order polynomials for both the t- and a-approximation spaces. General mathematical conditions for solvability and stability have been stated and studied in a number of mixed finite element problems [9], [10], [11], both for the continuous and the discrete problems. One of these conditions, known as the inf-sup condition, is usually difficult to prove analytically but may be tested numerically [10].
The problems we consider are nonlinear but the stability issues and the resulting oscillations are not a direct consequence of the nonlinearity of the constitutive laws. We observed that they actually already appear in linear problems with the same coupled formulations and non-compatible function spaces. However, the nonlinearity of the constitutive laws is one of the motivations for using coupled formulations, which is the reason why we discuss their stability in the framework of superconducting systems.
In this work, we consider the h-a-formulation for systems containing superconductors and ferromagnets and the t-aformulation, which can be seen as the limit of the h-aformulation for thin superconducting tapes. Following the general theory of mixed finite elements, we analyze the related conditions for obtaining numerically stable mixed formulations. In section II, we introduce and derive the two coupled formulations. In particular, we derive a version of the t-aformulation that directly includes global variables on current intensity or voltage in the weak form. To the best of our knowledge, it has not been introduced in that form yet. In section III, we present several choices of discretized function

© 2021 IEEE. Personal use of this material is permitted. Permission from IEEE must be obtained for all other uses, in any current or future media, including reprinting/republishing this material for advertising or promotional purposes, creating new collective works, for resale or redistribution to servers or lists, or reuse of any copyrighted component of this work in other works.

2

spaces and illustrate the occurence of the spurious oscillations that arise when spaces are not compatible. We recall the classical theory of mixed formulations and perturbed saddlepoint problems [9] in section IV and present a numerical infsup test based on [10] to check the compatibility of discretized function spaces. In the last two sections, the theory is applied to the h-a-formulation (section V) and the t-a-formulation (section VI), restricting to 2D problems with in-plane magnetic fields.

II. FINITE-ELEMENT FORMULATIONS

The magnetic response of a system containing type-II superconductors with strong pinning can be described by Maxwell's equations in the magnetodynamic (quasistatic) approximation [12], and magnetic and electrical constitutive laws,

 div b = 0,  
curl h = j,

(magn. Gauss) (Ampère) and

 

curl

e

=

-tb,

(Faraday)

b = µh, (1)
e = j,

with b, h, j, e, µ, and , being the magnetic flux density (T), the magnetic field (A/m), the electric current density (A/m2), the electric field (V/m), the permeability (H/m), and the resistivity (m), respectively. The permeability can be a function of h. In non-conducting materials,    and j = 0. In superconductors, b = µ0h and we assume a power law for the resistivity [13],

 = ec

j n-1 ,

(2)

jc jc

where ec = 10-4 V/m is a threshold electric field defining the critical current density jc (A/m2). The dimensionless number n = U0/kBT , with U0 a pinning energy and T the temperature, is a critical exponent associated with magnetic flux creep.
In the following, the system is modeled in a domain . Boundary conditions are applied on its external boundary , which is decomposed into two complementary domains: e, where the normal component of b or the tangential component of e is imposed, and h, where the tangential component of h is imposed. We also use the following notation for volume
and surface integrals:

(f1 , f2) = f1 · f2 d, (f1 , f2) = f1 · f2 d, (3)





with f1 and f2 being two scalar or vector fields and · the scalar multiplication or the dot product, respectively.

We now present two mixed finite element formulations of

the magnetodynamic problem.

A. Coupled formulation 1 - h-a-formulation
When a system contains both a superconductor and a nonlinear ferromagnetic material, classical formulations such as the h-formulation or the a-formulation may face convergence issues. The power law in superconductors is easier to handle with a Newton-Raphson method in the h-formulation, which involves the electrical resistivity. Conversely, the a-formulation is more efficient than the h-formulation to deal with the typical saturation law describing the permeability of ferromagnets [5].

Combining the h-formulation and a-formulation into a coupled h-a-formulation by choosing the best formulation in each
region has proven to be an efficient solution for systems with
both materials [5]. The domain  is decomposed into two parts: h, containing
the superconducting domain, and a, containing the nonlinear ferromagnetic domain. The parts of  where constitutive laws are linear can be put in h or a. Inside h, the conducting domain is denoted by h,c, and the non-conducting domain is denoted by Ch,c, with h = h,c  Ch,c. The common boundary of h and a is denoted by m. Coupling operates via this common interface. We also introduce the outer normal vectors nh and na . For illustration, consider the simple 2D stacked bar geometry in Fig. 1, where the h-formulation is applied to a superconducting bar, the a-formulation is applied
to a ferromagnetic bar and to the air region, while the coupling surface m is taken as the boundary of the superconducting region. In this example, the external boundary belongs to e, and m is the boundary of the superconducting region, which constitutes the entire h domain.

Air Ferro Super

a

bext

a nh

h m

e

(a) Problem geometry.

(b) Domain definition and mesh.

Fig. 1: Stack of a superconducting bar (below, n = 20, jc = 3 × 108 A/m2) and a ferromagnetic bar (above, µr = 1000), subjected to an external field (bext = 0.4 T). The thick curve is m.

We derive the two formulations in a and h, then couple them to obtain the h-a-formulation.
The classical a-formulation is a weak form of Ampère's law where the magnetic flux density b is expressed via a vector potential a as b = curl a. Here, it is introduced in a only. We choose a  A(a) with
A(a) = a  H(curl; a) |
a × na = a¯ × na on e  a , (4)
with a¯ × na a fixed trace on e  a. For conciseness, we place all conducting materials in h, and Ampère's law reads curl h = 0 in a. We multiply this equation by a test function a in the space A0(a) with homogeneous essential boundary conditions a × na = 0 on e  a, and integrate the product over a. We obtain
(curl h , a )a = 0  (h , curl a )a - (h × na , a )(ha)m = 0, (5)
using a Green's identity. Prescribing the value of h × na on h  a constitutes a natural boundary condition for the a-formulation. For conciseness, we consider homogeneous

3

natural boundary conditions on h  a. Therefore, after introducing the vector potential a, the formulation amounts to finding a  A(a) such that a  A0(a),
( curl a , curl a )a - (h × na , a )m = 0, (6)
with the reluctivity  = µ-1. On m, the tangential magnetic field is still unknown. It will be coupled with the formulation in h that we derive next.
In h, we use the h-formulation with curl-free functions in Ch,c, also called the h--formulation. This is a weak form of Faraday's law. We consider N distinct conducting subdomains h,ci of h,c, with i  C = {1, 2, . . . , N }, on which we impose either the current or the voltage. The current is imposed on a subset CI of C, and the voltage is imposed on the complementary set CV . In the h-formulation, the magnetic field h is sought in H(h) defined as
H(h) = h  H(curl; h) | curl h = 0 in Ch,c, h × n = h¯ × nh on h  h, Ii(h) = Ii for i  CI . (7)
Only curl-free functions are considered for h in the nonconducting domain Ch,c, so that the current density j = curl h is exactly zero in Ch,c, by construction. Functions associated with net electrical currents in the conducting regions (that are not gradients of a scalar potential) are however still considered, they form a cohomology basis of dimension N [14]. Each of these functions can be associated with a (group of) conducting subdomain(s) h,ci of h,c, i  C = {1, 2, . . . , N }. The notation Ii(h) denotes the net current Ii flowing in (a group) of conductor(s) i for a given function h [15], i.e., the circulation of h along a closed loop Ci around that (group of) conductor(s):

Ii(h) = h · d .

(8)

Ci

The corresponding applied voltage is denoted below by Vi (voltage per unit length in 2D). Either Ii or Vi must be imposed for each i. Note that imposing a zero curl in Cc drastically reduces the number of degrees of freedom in
the function space (7), after discretization. Indeed, in 2D
problems with in-plane magnetic field or 3D problems, with
Whitney basis functions [16], only one unknown per node is
necessary, compared to one unknown per edge for the "full h-formulation".

The weak form is obtained by projecting Faraday's law on test functions, h  H0(h),

t(µ h) , h

+
h

curl e , h

=0
h

 t(µ h) , h h + e , curl h h

- e × nh , h (eh)m = 0. (9)

The space H0(h) for test functions is with homogeneous essential boundary conditions, h × nh = 0 on h  h and Ii(h) = 0 for i  CI .
In Ch,c, curl h = 0. In h,c, e =  curl h. We model localized power sources and their associated current and voltage
on each conducting subdomain as proposed in [15], [17]. For

conciseness again, we consider homogeneous natural boundary conditions on e  h. Formulation (9) then becomes

t(µ h) , h h +  curl h , curl h h,c
- e × nh , h m = - ViIi(h ), (10)
iC
with the Vi's being natural "boundary" conditions for i  CV . For i  CI , the current Ii is imposed, then Ii(h ) = 0 and the global term does not enter the problem. It can however be exploited to build a circuit equation, to compute the voltage Vi associated with the imposed current Ii as a post-processing quantity. Conversely, for i  CV , the voltage Vi is imposed, then Ii is a degree of freedom and the global term enters the system of equations [17].
On m, the tangential electric field e is still unknown. It will be coupled with the formulation in a.
The final step in the h-a-formulation derivation consists in coupling the two separate formulations (6) and (10) in a and h. The tangential trace of the magnetic field on m in (6) can be directly expressed in terms of the magnetic field h of (10). Similarly, the tangential trace of the electric field on m in (10) can be expressed in terms of the vector potential a of (6), with e = -ta - grad v. In fact, only the -ta term contributes to the integral (see Appendix).
The resulting coupled h-a-formulation reads: From an initial solution at time t = 0, find h  H(h) and a  A(a) such that, for t > 0, h  H0(h), and a  A0(a),

t(µ h) , h h +  curl h , curl h h,c

+ ta × nh , h m = - ViIi(h ),

(11)

iC

(h × na , a )m - ( curl a , curl a )a = 0.

The discrete function spaces must be chosen with care. In

particular, the choice of basis functions spanning the trace space on m will affect the stability of the method. Different possibilities will be analyzed in section III.

B. Coupled formulation 2 - t-a-formulation for thin tapes
The second formulation we consider is the so-called ta-formulation for modeling thin superconducting tapes [6]. The tape is modeled as a line in 2D (a surface in 3D). The current density inside the tape is described via a current vector potential whereas the external magnetic flux density is expressed as the curl of a magnetic vector potential, naturally allowing discontinuous tangential components of the magnetic field across the tape. This t-a-formulation can be viewed as a geometric limit case of the h-a-formulation for thin geometries. It possesses the same continuity properties and advantages.
In [2], this formulation is derived from the h-a-formulation with a thin-sheet approximation. Circuit coupling is then performed by means of winding functions [18].
Here, we present a version of the t-a-formulation following a different approach for circuit coupling. With the same philosophy as in [17], in each tape we either strongly impose

4

the current intensity, directly in the function space, or weakly impose the voltage, with a circuit equation contained in the formulation. The formulation is valid in 2D or 3D. The stability analysis will be conducted in 2D in section IV.

n

I

w nw

-w

+w

a

+w

w

nw I

-w

V

a

(a) 2D problem.

(b) 3D problem (for illustration).

Fig. 2: Conventions for the t-a-formulation derivation. (a) 2D case, a tape with current density perpendicular to the modeled plane. (b) 3D case with a tape loop, e.g., a racetrack coil. In 3D, the effect of an external voltage/current source is modeled on an arbitrary crosssection.

This t-a-formulation applies to situations with thin conducting domains. Let us consider a conducting domain w  a of thickness w, see Fig. 2. We start from the classical aformulation in the whole domain a, with homogeneous natural boundary conditions for conciseness: find a  A(a) such that a  A0(a),

( curl a , curl a )a - (j , a )w = 0,

(12)

with a given current density j (A/m2) in w. Instead of modeling the tape w as a volume, we collapse it into a surface and replace j by a surface current density k = wj

(A/m), perpendicular to the normal vector n. This constitutes

the main approximation of the formulation: the thickness is not

represented in the geometry but introduced inside the equation.

Possible variations of j across the thickness are therefore

chosen not to be modeled.

Definition (4) implies that the vector potential a  A(a) is continuous across w, but allows h×n =  curl a×n to be discontinuous. Actually, we can show that (h1 - h2) × n = k is weakly satisfied (with an upward normal, h1 is the field on the top of the tape and h2 is the field below).
If the current density were known, the problem would be

closed. Here, we want to represent eddy currents and an

equation for the distribution of k is required. Since the current

density is divergence free (magnetodynamic regime), we can

express the current density j via a current vector potential t

defined up to a gradient such that j = curl t. To gauge t, we

choose it along the normal to the tape, i.e., t = tn [6].

For simplicity, in 3D, we restrict ourselves to closed current

loops. The tape boundary w is decomposed into two disjoint parts, -w and +w, as represented in Fig. 2. We model a
possible power source on an arbitrary cross-section of the tape

that imposes either a current intensity I or a voltage V . On lateral edges -w and +w, j · nw = 0 so t is constant. Let us (strongly) fix it to 0 on -w and let its value, denoted by T , remain free on the other lateral edge +w. The value of T

is related to the total injected current intensity I. Indeed, on any cross-section S of the tape, using Stokes' theorem,

I = j · dS = curl t · dS = t · d S

S

S

S

= w(t|+ w - t|- w ) = wT.

(13)

To obtain a weak formulation for t, we use Faraday's law, tb + curl e = 0, more specifically its component along n. It amounts to finding t  T (w), such that t  T0(w),

0 = (tb , t )w + (curl ( j) , t )w

 0 = (t(curl a) , t )w + (curl ( curl t) , t )w

 0 = (ta , curl t )w + ( curl t , curl t )w

- ((e + ta) × nw , t )w ,

(14)

where we expressed the normal flux density b·n via the vector
potential of the a-formulation. Note that the outer normal nw of w arising from Green's identities is different from n, see Fig. 2. The spaces T and T0 will be defined later.
The last term in (14) is exploited to impose global quanti-

ties, such as current intensity or voltage. The electric field in
an a-formulation is expressed as e = -ta - grad v, with a scalar electric potential v. Because t = 0 on -n , the line integral in (14) reads

((e + ta) × nw , t )w = - (grad v × nw , T n)+ w

= - (grad v · , T )+ w = -V T ,

(15)

with = nw × n, and V being the net potential difference (V) applied by the generator in 3D. In 2D, V is a voltage per

unit length (V/m) in the out-of-plane direction. In the tape, either the total current I or the associated voltage V must be imposed. As with the h-a-formulation, if the current I is imposed, then t = 0 on +n , and the equation does not enter the problem. It can however be used as a circuit equation to compute the voltage V associated with the imposed current I, as a post-processing quantity. Conversely, if the voltage V is imposed, then I is a degree of freedom and Eq. 15 enters the

system of equations. We now consider N distinct tapes w,i with i  C =
{1, 2, . . . , N }. The union of these tapes is w. Current is imposed on a subset CI of C whereas voltage is imposed on the complementary set CV . For conciseness, we consider homogeneous natural boundary conditions on h. The t-aformulation reads as follows:
From an initial solution, find a  A(a) and t  T (w), such that for all time instants and a  A0(a), t  T0 (w ),

( curl a , curl a )a - (w curl t , a )w = 0,

(w ta , curl t )w + (w  curl t , curl t )w

(16)

= - ViIi(t ),

iC

with Ii(t ) = wTi = Ii being the net current flowing in tape i for the potential t . The space T (w) (resp. T0(w)) is the
set of functions t = tn such that curl t is in the dual space
of the relevant trace space on w of functions in A(a), with t = 0 on -w , and t = (Ii/w)n (resp. t = 0) on +w,i for

5

i  CI . Since in 2D the vector potential a has only one outof-plane component, A(a) can be identified with H1(a) (see chapter 2 of Ref. [9]). With z being the direction of the current density, perpendicular to the 2D plane, if w  e =  [19], we can choose t in
T (w) = t = tn (z · curl t)  H-1/2(w), t = 0 on -w , t = Ii/w on +w,i for i  CI . (17)
As with the coupled h-a-formulation, the discrete function spaces must be chosen with care. In particular, the choice of basis functions spanning the trace space on w will affect the stability of the method. Different possibilities will be analyzed in section III.
III. DISCRETIZATION AND OSCILLATIONS
To proceed, we discuss different discretization schemes and their consequences on the stability of the coupled formulations.
For the numerical resolution, the domain  is discretized as  with a finite element mesh of characteristic size . Function spaces for h, a and t are approximated by basis functions on the finite elements and we denote the approximated functions by h, a, and t. We then integrate over time with an implicit Euler method and solutions to nonlinear systems are obtained by Newton-Raphson iterations.
We focus on 2D problems, such as those represented in Figs. 1(a) and 2(a). Finite element modeling is performed by GetDP [20] and finite element meshes are generated by Gmsh [21]1.
All three fields h, a, and t of the coupled formulations (11) and (16) are approximated by 1-forms [22]. The h-aformulation is b-conform in a and h-conform in h. The t-a-formulation is b-conform in a and the current density j = curl t in w is a 2-form so that the continuity of its normal component is satisfied [22]. Note that the lack of h-conformity for the t-a-formulation in a naturally allows the tangential magnetic field n × ( curl a × n) to be discontinuous across each tape, while the discontinuity strength is enforced weakly by means of the surface terms.

A. Lowest order Whitney basis functions

The simplest approximation spaces are generated by lowest
order Whitney edge functions for the three fields [16]. We use the following notation: n  ¯  or e  ¯  refers to nodes n or edges e in  and on its boundary . To exclude entities on a boundary , we note n (or e)  ¯  \  explicitly.
We build the magnetic field h in h as follows,

h =

he e+

n grad n+ Ii ci, (18)

e¯ h,c\h,c

n¯ Ch,,c

iC

with e being the edge function of edge e, n the node function of node n, and ci a discontinuous basis function as-
sociated with the cut related to conducting region i, defined on
a transition layer. Note that grad n and ci can be expressed as sums of edge functions [17], [15]. We denote by H,1(h)

1Model files for the main test cases are available on www.life-hts.uliege.be.

the space generated by these lowest order functions, including essential boundary conditions. We have H,1(h)  H(h). Coefficients he, n and Ii are the degrees of freedom for h. We have Ii(h) = Ii with the notation of formulation (11),
i.e., Ii is the net current intensity flowing in (a group of) conductor(s) i for the field h.
The magnetic vector potential a in a in both h-a and t-a formulations reads

a =

an nz,

n¯ a

(19)

where nz is a "perpendicular edge function" associated with node n, such that a is chosen along z, the direction perpendicular to the plane in 2D. The field a automatically satisfies the Coulomb gauge condition div a = 0. We denote by A,1(a) the space generated by these lowest order
functions, including essential boundary conditions. We also have A,1(a)  A(a). Coefficients an are the degrees of freedom for a.
The current vector potential t reads

t =

tn nn + Ti i, (20)

n¯w \(- w, + w, )

iC

with nn being a "perpendicular edge function" associated
with node n and i the perpendicular edge function associated with the node on +w,,i. (Note that in 3D, i is the sum of all perpendicular edge functions associated with nodes on +w,,i; this is a global basis function.) We denote by T ,1(w) the space generated by these functions, including essential boundary conditions. Again, we have T ,1(w)  T (w). Coefficients tn and Ti are the degrees of freedom for t.
In h-a and t-a coupled formulations, using lowest order

Whitney elements for both fields may lead to spurious os-

cillations. Let us consider a typical example with the h-a-

formulation, in which the numerical solution exhibits nonphysical oscillations when the coupling interface m separates two regions of different permeabilities. The geometry is de-

picted in Fig. 1: two bars (height: 10 mm, width: 20 mm)

are stacked and subjected to an external field. The bottom bar is a superconductor (n = 20, jc = 3 × 108 A/m2) and defines h, whereas the top bar is a linear ferromagnet (µr = 1000). The air and ferromagnetic domains constitute a. With h  H,1(h) and a  A,1(a), spurious oscillations
of the magnetic flux can be clearly seen at the interface of the

two materials, see Figs. 3(a) and 4(a).

It is important to emphasize that oscillations are not a

consequence of the nonlinearity of the equations. Indeed, if

the superconductor is replaced by a linear conductor, stability

issues remain. However, the oscillation amplitude decreases

when the permeability of the ferromagnet is lowered. Note that

oscillations can therefore easily be missed in case of nonlinear

ferromagnets, that saturate quickly at the large fields involved

in many superconducting systems.

Similarly, in the numerical solution of the t-a-formulation,

the current density displays oscillations across the tape, typ-

ically at low imposed currents. A representative example is

shown in Figs. 2(a) and 5(a), illustrating a single straight tape in air (thickness: 10-3 mm, width: 10 mm, n = 20,

6

b · nh (T)

b · nh (T)

(a) h  H,1(h) and a  A,1(a).

a
w e

(b) h  H,2(h) and a  A,1(a).
Fig. 3: Details of two solutions for the stacked bar problem, magnetic flux density near the material interface (arrows represent the average value in each element). (a) Unstable choice of function spaces, resulting in non-physical oscillations on m. (b) Example of a stabilized problem with hierarchical basis functions on m for h.

2

0.1mm above the interface

0.1mm below the interface

(a) Problem geometry and mesh.

(b) Magn. flux density (zoom).

Fig. 5: Simple problem for the t-a-formulation: a superconducting
tape in air, with an imposed total current intensity. (a) The problem
geometry and domains. (b) Magnetic flux density in the neighbour-
hood of the tape, solution with first-order basis functions. Oscillations are not visible when looking at b only.

1

a  A,1(a) and t  T ,1(w)

a  A,2(a) and t  T ,1(w)

0.5

jz/jc (-)

1

0

0

(a) h  H,1(h) and a  A,1(a).

2

0.1mm above the interface

0.1mm below the interface

1

0
(b) h  H,2(h) and a  A,1(a). Fig. 4: Normal magnetic flux density distribution (horizontal position in abscissa) just above and just below the material interface for the stacked bar problem. (a) Unstable choice of function spaces, large spurious oscillations take place. (b) Stabilized solution, with higher order basis functions on m for h.

jc = 2.5 × 108 A/m2), with an imposed current intensity. The magnetic flux density distribution does not exhibit problematic oscillations, but the current density is clearly non-physical. See Figs. 5(b) and 6.
Oscillations can be avoided by choosing adapted function spaces. We investigate one possibility in the following subsection.

B. Enriched spaces with hierarchical basis functions
One possibility to stabilize the problem is to enrich locally the function space of one of the two fields for the h-aformulation. This is illustrated in Figs. 3 and 4, where using higher-order basis functions for h on m allows to overcome non-physical oscillations. Likewise, enriching the a space

Fig. 6: Current density for the simple tape problem. Non-physical oscillations appear when using lowest-order elements for both fields. Enriching the space for a on w stabilizes the problem and spurious oscillations disappear.
yields a similar effect. For the t-a-formulation, enriching the a space stabilizes the problem, see Fig. 6. This procedure is a solution inspired by well-known results in mixed formulations in mechanics, such as Stokes' (nearly) incompressible flow problems [23]. However, the situation is not the same, since fields in these problems are coupled inside the domain, whereas here, we couple the fields via boundaries of domains.
The above observations and the stability results of the next sections motivate the use of higher-order functions. Since we will only enrich functions locally, we use hierarchical functions [24], [25]. In 2D, we formally associate these functions with edges. Let ne,1 and ne,2 be the nodes at the ends of an edge e, we define the associated hierarchical basis function 2,e := ne,1 ne,2 . It vanishes on all nodes and is referred to as a bubble function.
To obtain stable formulations, it is sufficient to introduce these functions on the domain interfaces only: m or w. We add to the expansion (18) for h the term
em 2,e grad 2,e, with the new degrees of freedom 2,e. Note that as curl grad · = 0, the new terms do not contribute to the current density. We denote the resulting function space by H,2(h).
For the magnetic vector potential a, we add to (19) the term e a2,e 2,ez, with  = m in the h-a-formulation and  = w in the t-a-formulation, z being the out-of-plane direction, and a2,e representing the new degrees of freedom. The associated function space is denoted by A,2(a).

7

Finally, although it will lead to issues with the NewtonRaphson technique, we consider for the current vector potential t in 2D the term ew t2,e 2,en, in addition to decomposition (20), with t2,e being the new degrees of freedom, to construct the space T ,2(w).
As explained in what follows, these hierarchical basis functions enrich the polynomial order of the span of function traces on m and w by one. This will be shown to be sufficient to obtain stability in sections V and VI.
C. Function space for the traces on m and w
The coupling integrals involve the traces of functions on the interfaces m and w. The range of these traces depends on the chosen function spaces and, as we will see, determines the stability of the system.
The trace h × n|m of h  H,1(h), involved in the coupling terms of the h-a-formulation is in the z-direction and is piecewise constant. With the hierarchical enrichment, it becomes piecewise linear. Similarly, in the t-a-formulation, with t  T ,1(w), curl t is along z and is piecewise constant. For t  T ,2(w), curl t is piecewise linear.
The vector potential a  A,1(a) is along z. It is continuous and piecewise linear. For a  A,2(a), it is continuous and piecewise quadratic.
Now that the discrete framework has been presented, we summarize the basics of saddle point stability analysis, and then apply the theory on the two-bar and single-tape examples, in order to explain how a proper choice of approximation space leads to a stable coupled formulation.
IV. BASICS OF STABILITY ANALYSIS
Mixed finite element formulations face numerical stability issues if function spaces for their unknowns are not chosen consistently. Typically, spurious oscillations in the numerical solution may arise and affect the accuracy of the method, as illustrated in the previous section. The theory of mixed finite element formulations [9] provides compatibility conditions on spaces to ensure the numerical stability of the problem.
Both the h-a-formulation and t-a-formulation fit into the classical framework of perturbed saddle-point problems, as will be shown in sections V and VI. In this section, we present the stability conditions relevant to this class of problems, following closely Brezzi's classical treatment [9]. We also describe the inf-sup test [26], a numerical test which is used for checking the compatibility of specific functions spaces in the discrete setting.
A. Theory
We consider two Hilbert spaces V and Q and their dual space V and Q containing all linear functionals V  R and Q  R, respectively. On these spaces, we build perturbed saddle-point problems of the following form: for given f  V and g  Q , find u  V and p  Q such that
a(u, v) + b(v, p) = f, v , v  V, (21)
b(u, q) - c(p, q) = g, q , q  Q,

with a(·, ·), b(·, ·), and c(·, ·) continuous bilinear forms on V × V , V × Q, and Q × Q, respectively, and where f, v (resp. g, q ) denotes the value of the functional f (resp. g) at v (resp. q). The term -c(p, q) is considered to be a perturbation
of the classical saddle-point problem.
In practice, we solve a discretized version of (21) and look for u and p in finite-dimensional spaces V   V and Q  Q respectively (the finite element spaces), with
operators defined on these discrete spaces. Spaces V  and Q are equipped with norms · V  and · Q . Dual norms are used for elements in the dual spaces
V  and Q . The norms of the bilinear operators are finite
and are defined as follows:

a

:= sup
u ,v V 

a(u, v)

u

V

v

,
V

b

:= sup
u V  ,q Q

b(u, q)

u

V

q

,
Q

c

:= sup
p ,q Q

c(p, q)

p

Q

q

.
Q

(22) (23) (24)

Before stating the main stability theorem, we finally introduce the kernels

K := {v  V  : b(v, q) = 0, q  Q}, (25) H := {q  Q : b(v, q) = 0, v  V }. (26)

Let (u¯, p¯) be the exact solution of the perturbed saddle point-problem (21). With a(·, ·) and c(·, ·) symmetric, positive
semi-definite continuous bilinear forms, Proposition 5.5.2. in [9] states that, if a(·, ·) is coercive on K and c(·, ·) is coercive on H, i.e., if there exist two constants  > 0 and  > 0
such that

a(v, v)  

v

2 V



,

v  K,

(27)

c(q, q)  

q

2 Q

,

q  H,

(28)

and if there exists a constant  > 0 such that

inf sup
q (H ) v (K )

b(v, q) q Q v V 

=  > 0

(29)

is satisfied on the orthogonal complements · of H and K, then the discretized problem has a unique solution (u, p)
satisfying

u - u¯ V  + p - p¯ Q

 C inf v - u¯ V  + inf q - p¯ Q , (30)

v V 

q Q

with a constant C depending only on the stability constants, , , , and continuity constants, a , b , c .
If these values can be chosen independent of the mesh, C is bounded with mesh refinement and the problem is said to be stable.
Condition (29) is the so-called inf-sup condition, or the Babuska-Brezzi condition [11], [27].

8

B. Numerical Inf-Sup Test

In most practical cases, the inf-sup value  cannot be

evaluated analytically. Instead, it can be estimated with a

numerical inf-sup test [9], [26]. On a given mesh, unknown

fields v  V  and q  Q are described by vectors v

and q containing the degrees of freedom. We define norm

matrices NV  and NQ such that

v

2 V

=

v T NV  v and

q

2 Q

=

q T NQ q and we introduce B, the coupling

matrix satisfying b(v, q) = q T Bv, obtained from the

finite element assembly.

In terms of these matrices, Eq. (29) reads

inf sup
q (H ) v (K )

q T Bv (q)T NQ q (v)T NV  v

= . (31)

The inf-sup value  in Eq. (31) can be shown to be equal to the square root of the smallest non-zero eigenvalue of the generalized eigenvalue problem [28]

B NV  -1 B T q = NQ q.

(32)

Note that we disregard zero eigenvalues because they are associated with eigenvectors defining elements in H that are not involved in the inf-sup condition. Note also that the norm b is the square root of the largest eigenvalue of problem (32).
The inf-sup test consists in computing  values for progressively refined meshes. If the values appear to be bounded from below by a positive value independent of mesh size, and if the other conditions (coerciveness and continuity) are met, then the sequence of problems is considered to be stable. On the other hand, if some eigenvalues tend to zero, we expect stability issues, because the inf-sup condition then fails to be satisfied. Even if the numerical test does not provide a formal proof of stability, experience shows that it is a reliable indicator [26], [10].
In the next sections we apply these results on the h-a- and t-a-formulations in order to investigate the stability.
From now on, we only keep the · superscript for functions spaces, continuity, coerciveness and inf-sup values, to stress the importance of mesh-dependency. As we will only stay in the discrete setting, we drop it elsewhere, for conciseness.

V. ANALYSIS OF THE h-a-FORMULATION
For simplicity, we start by presenting the h-a-formulation on materials with constant permeability and conductivity. We will then extend the conclusions to systems with superconductors and nonlinear ferromagnetic materials.
The analysis is restricted to 2D problems with in-plane magnetic field.

A. Linear materials
We begin the analysis with a linear problem, i.e., materials that have a constant resistivity and reluctivity, but are not necessarily homogeneous.

Using the implicit Euler method, at a given time step n, the solution (a, h) := (an, hn) depends on the solution at the previous time step (·)n-1. If we multiply the first equation of (11) by the time step t, we obtain the system

µh,h

+
h

t  curl h , curl h

h,c

+ a × nh , h m = s, h ,

(33)

(h × na , a )m - ( curl a , curl a )a = 0,

with the right-hand side functional defined by

s, h

=

an-1 × nh , h

+
m

(µ h)n-1 , h

h

- t ViIi(h ). (34)

iC

System (33) can be rewritten as

µ h,h

+
h

t  curl h , curl h

h,c

+ a × nh , h m = s, h ,

(35)

(a × nh , h)m - ( curl a , curl a )a = 0,

using na = -nh . For conciseness, we consider homogeneous essential boundary conditions. Problem (35) can be cast into the form of Eq. (21), with identical function spaces for unknown functions and test functions. The case of nonhomogeneous essential boundary conditions can be easily treated, and the analysis remains unchanged.
After discretization, we obtain a system of linear equations in a matrix-vector form. The formulation will be considered stable if a sequence of problems on progressively refined meshes satisfies conditions (22) to (24) and (27) to (29), with constants , , , a , b , and c independent of mesh size.
In H0(h) and A0(a), we define the norms

h

2 H0

= (µ0 h , h)h + (t0 0 curl h , curl h)h,c ,

(36)

a

2 A0

= (0 curl a , curl a)a ,

(37)

with 0 being a characteristic resistivity (e.g., the resistivity
of region h,c) and t0 a characteristic time step. With these norms, whatever the discretization, h  H0(h) and a  A0(a),

a(h, h) = µ h , h h + (t  curl h , curl h)h,c

 min(µ/µ0, t/t0 · /0)

h

2 H0

,

(38)

c(a, a) = ( curl a , curl a)a

 min(/0)

a

2 A0

,

(39)

which proves the coerciveness properties (27), and (28), with   min(µ/µ0, t/t0 · /0) > 0, and   min(/0) > 0. Similarly, we can prove a  max(µ/µ0, t/t0 · /0) < , and c  max(/0) < , using the Cauchy-
Schwarz inequality.
To guarantee stability, the inf-sup condition remains to be met. There must exist a  > 0 independent of mesh size that
fulfils

inf sup (a × nh , h)m  .

aH hK

a A0 h H0

(40)

9

Norm b

Inf-sup value 

We also have to verify that b is bounded from above. To check both properties, a numerical inf-sup test is conducted on the stacked bar geometry represented in Fig. 1, with linear homogeneous materials ( = 1.6 × 10-8 m, µr = 1000), for different discretization choices. Results are shown in Fig. 7, with 0 = 1.6 × 10-8 m.
First, the norm b of the coupling operator is bounded from above independent of the function spaces, as shown in the upper part of Fig. 7. However, the evolution of the inf-sup value shows two different behaviors. When exactly one of the two fields h and a is enriched with hierarchical elements, the inf-sup value does not decrease and (30) ensures the stability of the associated problem. Otherwise, the inf-sup value typically decreases with    and stability issues, i.e., oscillations in the numerical solution, are expected.

with sa and sh the right-hand sides of the final system (after treating non-homogeneous essential boundary conditions). The
problem is actually always stable in the sense of Eq. (41). However, the provided bound deteriorates when either  or 
decreases, which is the case when considering a ferromagnetic material in a. Indeed, when 1/   in a,   0. With practical mesh resolutions, the bounding Eq. (41) is not strict
enough and stability issues arise.
As said above, we can extend to spaces with non-
homogeneous essential boundary conditions. In practice, when dealing with ferromagnetic materials adjacent to m, it is therefore recommended to choose either h  H,1(h) and a  A,2(a), or h  H,2(h) and a  A,1(a), to guarantee stability.

1.7 1.6 1.5 1.4 1.3
10-2 100

10-1

H0,2 and A0,1 H0,1 and A0,2 H0,1 and A0,1 H0,2 and A0,2

10-1

10-120-2

10-1 Mesh size /W

Fig. 7: Evolution of the inf-sup constant  from Eq. (40) and norm
b with mesh refinement (  0) on the stacked bar linear problem. Four cases are considered: h  H0,i(h) and a  A0,j (a), for (i, j)  {1, 2} × {1, 2}. We can only conclude on stability when i =
j, i.e., when exactly one space is enriched with respect to Whitney
elements (black lines).

B. Interpretation
To illustrate the link between the eigenvalue problem and the spurious oscillations, we investigate Eq. (32) applied on the stacked-bar problem with linear materials.
For the stability analysis, we are only interested in the non-zero eigenvalues, whose associated eigenvectors form a basis of H. These eigenvalues are represented in Fig. 8 for both stable and unstable choices of function spaces, at two different discretization levels. The same conclusions as from Fig. 7 can be drawn. In particular, with the choice h  H,1(h) and a  A,1(a), the problem is unstable because it contains modes of smaller and smaller eigenvalues when the mesh is refined. The eigenvector associated with the smallest eigenvalue is represented in Fig. 9(a). Clearly, such a mode (among others) is also activated in the unstable solution of Fig. 3(a) with nonlinear materials. Its weight in the coupling term (a × nh , h)m is small with respect to its norm.
Of course, such oscillating modes still exist in the H basis with the stable choice h  H,1(h) and a  A,2(a), but their eigenvalues are not decreasing with mesh refinement.
100

In practice, when choosing h  H0,1(h) and a  A0,1(a), or h  H0,2(h) and a  A0,2(a), we do observe such oscillations. However, they only appear at interfaces with large permeability jumps. In contrast, when no ferromagnetic material is present in the geometry, the numerical results are satisfying. These behaviors can be explained by Proposition 4.3.1 of [9], that follows from the Lax-Milgram theorem. When a(·, ·) and c(·, ·) are coercive, irrespective of whether the coupling operator satisfies the inf-sup condition, the problem has a unique solution (a, h) and we have the following inequality:





1

1

2 a A0 + 2 h H0  2 sa (A0) + 2 sh (H0) ,

(41)

i

10-1 100

H0,1; A0,2 (coarse) H0,1; A0,2 (fine) H0,1; A0,1 (coarse) H0,1; A0,1 (fine)

101

102

Eigenvalue number i

Fig. 8: Distribution of the square root of the non-zero eigenvalues
from problem (32) on the stacked-bar geometry with linear materials. The smallest values are the inf-sup values , the largest are the norms b . Eigenvectors associated with the square and circle points
are represented in Fig. 9.

10

a h
(a) Associated with the square in Fig. 8, smallest non-zero eigenvalue.
a h

(b) Associated with the circle in Fig. 8.
Fig. 9: Eigenvectors associated with the two dots in Fig. 8, for h  H,1(h) and a  A,1(a) (unstable) and the same mesh as in Fig. 3. The thick curve is m.

C. Nonlinear materials

We consider anhysteretic ferromagnets in a, characterized by a saturation law for the permeability, and type-II supercon-
ductors in h, whose resistivity is described by a power law. The associated system of equations after time discretization is
as in Eq. 33, but with variable coefficients  and . With
a Newton-Raphson linearization, we obtain a problem that is iteratively solved. The solution (h, a) := (hkn, akn) at time step n and iteration k depends on the solutions at the previous time step (·)n-1 and previous iteration (·)k-1. Using, na = -nh , we obtain the linear system

µ0 h , h h + t (e/j)k-1 curl h , curl h h,c

+ a × nh , h m = s~h, h ,

(42)

(a × nh , h)m - (h/b)k-1 curl a , curl a a

= s~a, a ,

with right-hand side functionals s~h and s~a defined by

s~h, h

=

an-1 × nh , h

+
m

(µ h)n-1 , h

h

- t ((I - e/j) curl h)k-1 , curl h h,c (43)

- t ViIi(h ),

iC

s~a, a = - ((I - h/b) curl a)k-1 , curl a

(44)

a

with the identity matrix I. The structure is similar to that of system (35). Coerciveness and continuity of diagonal operators, a(·, ·) and c(·, ·), in the sense of norms (36) and (37) are only satisfied if the eigenvalues of matrices (e/j)k-1 and (h/b)k-1 are bounded away from zero and infinity, independently of the mesh. This is the case for the differential reluctivity with classical saturation laws. However, using the power law, the differential resistivity tends to zero for small current densities so that we cannot verify the coerciveness condition with norm (36). Note that continuity is not satisfied either.
As for the inf-sup value  and norm b , results are exactly similar to those in Fig. 7. In contrast to the linear case, we do not establish a formal proof of stability due to this particular operator a(·, ·). However, we found that in practice, the conclusions obtained for the linear case remain and lead to the same recommendations. When choosing h  H,1(h) and a  A,2(a), or h  H,2(h) and a  A,1(a), we observe stable results, whereas the other combinations lead to spurious oscillations. Note that in the large fields involved with high-temperature superconductors, the ferromagnets usually saturate quickly, and the oscillation amplitude decreases.
To avoid the technical difficulty due to the power law, we could restrict to a regularized version, with two limiting resistivity values. See also [29], [30] for a rigorous treatment of the power law in simpler formulations.

VI. ANALYSIS OF THE t-a-FORMULATION
We directly consider a nonlinear material in w, e.g., a superconducting tape. Including a nonlinear ferromagnetic material in a does not raise any additional issue. We restrict the analysis to 2D problems with an in-plane magnetic field. With the same procedure as for the h-a-formulation, for every iteration k at time step n, we obtain the following discrete linear system for the unknowns t  T0(w) and a  A0(a):

( curl a , curl a )a - (w curl t , a )w = 0, - (w curl t , a)w - t w (e/j)k-1 curl t , curl t w
= s~t, t , (45)
with a right-hand side functional s~t defined by

s~t, t = - (w an-1 , curl t )w + t ViIi(t )
iC
+ t w ((I - e/j) curl t)k-1 , curl t . (46)
w
In A0(a), we use the same norm as for the h-aformulation,

a

2 A0

= (0

curl a , curl a)a ,

(47)

and we have   min(/0) > 0, and a  max(/0) < , whatever the mesh.

For the discrete inf-sup condition, to avoid the evaluation of a H-1/2(w)-norm, we use a mesh-dependent norm, as is common in the discrete setting [19]. We assume a uniform
mesh on w, for which there exist a  and two finite non-zero

11

constants c1 and c2 such that c1  e  c2, e  w, with e the length of edge e. For a given mesh-length , we define

t

2 T0

=  (w

t0

0

curl t , curl t)w ,

(48)

with t0 and 0 being characteristic time step and resistivity

values. The inverse inequality [31]

 µ H-1/2()  c  µ L2(), µ  H -1/2(),

(49)

with a finite constant c implies that satisfying the inf-sup test
with norm (48) is a necessary condition for stability in terms of norm · . H-1/2(w) In [32], the condition is also shown to be sufficient.
Fig. 10 gives the evolution of the inf-sup constant for a
sequence of progressively refined meshes, for four choices of function spaces. Analogously to the h-a-formulation, it is
only when exactly one approximation space is enriched with
hierarchical elements that the inf-sup constant is uniformly
bounded from below. These choices are good candidates if we
want a stable formulation. On the other hand, when choosing t  T0,1(w) and a  A0,1(a), or t  T0,2(w) and a  A0,2(a), the test suggests that stability issues may arise. In practice, this is indeed the case, see Fig. 6.
We observed that with the choice t  T0,2(w) and a  A0,1(a), the Newton-Raphson procedure faces convergence troubles. No satisfying numerical solution has been obtained
in that case. Since the inf-sup test indicates that this choice is
however acceptable, we believe that the issue is related to the
iterative technique rather than to the structure of the saddle-
point problem. In constrast to that, the choice t  T0,1(w) and a 
A0,2(a) provides good results and no issues have been observed. Our results match the observations in [7], where the function space for a is however enriched in the whole a domain, instead of only in the vicinity of w.

10-2 10-3

T0,1 and A0,2 T0,2 and A0,1 T0,1 and A0,1 T0,2 and A0,2

10-4

T ,1(w) and a  A,2(a). This choice ensures a bounded inf-sup value and does not exhibit any stability issues.
VII. CONCLUSION
In this work, we presented two coupled finite element formulations. The h-a-formulation is efficient for systems containing both superconductors and ferromagnetic materials, whose nonlinear constitutive laws are most efficiently handled by combining different formulations. The so-called t-aformulation is an efficient method for modeling superconducting tapes as surfaces. Two fields are used and coupled on the tapes. We proposed a new derivation of the t-a-formulation with global constraints, on either current or voltage for each tape.
Both formulations are mixed on the coupling interfaces and the associated systems of equations take the form of a perturbed saddle point problem. They fit into the classical framework of mixed formulations. It is well known that this problem structure may be exposed to stability issues, e.g., spurious oscillations in the numerical solutions, if function spaces are not chosen correctly. We illustrated the stability issues arising for naive choices of function spaces. We then investigated the formulations stability in the discrete setting, using the classical mixed formulation theory, for several choices of finite element spaces, restricting our study to 2D problems.
The conclusions for both formulations are similar. Using basis functions of different suitable polynomial orders on the coupling interfaces helps to avoid stability issues, whereas with identical orders, the inf-sup value fails to be uniformly bounded above zero. For the h-a-formulation, either the space for h, or the space for a should be enriched, e.g., locally via hierarchical elements on the coupling boundary. For the t-a-formulation, the only satisfying configuration consists in using second-order hierarchical elements on the tapes for a while using first-order elements for t.
Extending to 3D problems would constitute an interesting research topic in further works. Other solutions for stabilizing the problem could also be considered, such as using dual meshes on coupling interfaces for the two fields.
APPENDIX
A. Coupling term in the h-a-formulation
The surface integral to be coupled with the a-field of the a-formulation reads

10-2

Mesh size /W

10-1

Fig. 10: Evolution of the inf-sup constant with mesh refinement (  0) on the simple tape problem (n = 20, jc = 2.5 × 1010 A/m2). Four cases are considered t  T0,i(h) and a  A0,j (a), for (i, j)  {1, 2} × {1, 2}. We observe instabilities when i = j. The
usual Newton-Raphson scheme with i = 2, j = 1 does not converge.
Only the case i = 1, j = 2 leads to satisfying results.

To conclude, extending to spaces with non-homogeneous essential boundary conditions, we recommend choosing t 

e × nh , h m .

(50)

In this work, m is placed in Cc . On m, the test magnetic field h is therefore locally the gradient of a scalar function:

h = grad  (intersections with possible cut functions are

already treated in the global term ViIi(h )). Consequently,

we have:

(e × nh , grad  )m = (curl ( e) , nh )m - ( curl e , nh )m . (51)
If m is a closed surface, then the first term in the right-hand side vanishes by Stokes theorem. In the second term, only the

Inf-sup value 

12

curl of e appears. Because e = -ta-grad v in a, we have curl e = -curl (ta).
If m is not a closed surface, then m  (e  h)  (h  h) is closed. On (h  h),  = 0, and on (e  h), we considered homogeneous natural boundary conditions so e × nh = 0  curl e · nh = 0. The treatment of nonhomogeneous natural boundary conditions is straightforward as well.
ACKNOWLEDGMENT
We would like to thank Prof. Barbara Wohlmuth from the Technical University of Munich and Prof. Eric Béchet from the University of Liège for the insightful discussions about meshdependent norms. We would also like to thank Prof. Herbert Egger from Technical University of Darmstadt for the fruitful exchanges about saddle-point problems stability analysis.
REFERENCES
[1] R. Brambilla, F. Grilli, L. Martini, M. Bocchi, and G. Angeli, "A finiteelement method framework for modeling rotating machines with superconducting windings," IEEE Transactions on Applied Superconductivity, vol. 28, pp. 1­11, Aug. 2018.
[2] L. Bortot, B. Auchmann, I. C. Garcia, H. De Gersem, M. Maciejewski, M. Mentink, S. Schöps, J. Van Nugteren, and A. P. Verweij, "A coupled a­h formulation for magneto-thermal transients in hightemperature superconducting magnets," IEEE Transactions on Applied Superconductivity, vol. 30, no. 5, pp. 1­11, 2020.
[3] Z. Hong, A. M. Campbell, and T. A. Coombs, "Numerical solution of critical state in superconductivity by finite element software," Superconductor Science and Technology, vol. 19, pp. 1246­1252, oct 2006.
[4] B. Shen, F. Grilli, and T. Coombs, "Overview of h-formulation: A versatile tool for modeling electromagnetics in high-temperature superconductor applications," IEEE access, vol. 8, pp. 100403­100414, 2020.
[5] J. Dular, C. Geuzaine, and B. Vanderheyden, "Finite-element formulations for systems with high-temperature superconductors," IEEE Transactions on Applied Superconductivity, vol. 30, no. 3, pp. 1­13, 2019.
[6] H. Zhang, M. Zhang, and W. Yuan, "An efficient 3d finite element method model based on the t­a formulation for superconducting coated conductors," Superconductor Science and Technology, vol. 30, no. 2, p. 024005, 2016.
[7] E. Berrospe-Juarez, V. M. Zermeño, F. Trillaud, and F. Grilli, "Realtime simulation of large-scale hts systems: multi-scale and homogeneous models using the t­a formulation," Superconductor Science and Technology, vol. 32, no. 6, p. 065003, 2019.
[8] Y. Wang, H. Bai, J. Li, M. Zhang, and W. Yuan, "Electromagnetic modelling using ta formulation for high-temperature superconductor (re) ba2cu3o x high field magnets," High Voltage, vol. 5, no. 2, pp. 218­226, 2020.
[9] D. Boffi, F. Brezzi, M. Fortin, et al., Mixed finite element methods and applications, vol. 44. Springer, 2013.
[10] K.-J. Bathe, "The inf­sup condition and its evaluation for mixed finite element methods," Computers & structures, vol. 79, no. 2, pp. 243­252, 2001.
[11] I. Babuska, "The finite element method with lagrangian multipliers," Numerische Mathematik, vol. 20, no. 3, pp. 179­192, 1973.
[12] J. D. Jackson, Classical electrodynamics. AAPT, 1999. [13] J. Rhyner, "Magnetic properties and ac-losses of superconductors with
power law current--voltage characteristics," Physica C: Superconductivity, vol. 212, no. 3-4, pp. 292­300, 1993. [14] M. Pellikka, S. Suuriniemi, L. Kettunen, and C. Geuzaine, "Homology and cohomology computation in finite element modeling," SIAM Journal on Scientific Computing, vol. 35, no. 5, pp. B1195­B1214, 2013. [15] P. Dular, Modélisation du champ magnétique et des courants induits dans des systèmes tridimensionnels non linéaires. PhD thesis, University of Liège, 1994. [16] A. Bossavit, "Whitney forms: A class of finite elements for threedimensional computations in electromagnetism," IEE Proceedings APhysical Science, Measurement and Instrumentation, Management and Education-Reviews, vol. 135, no. 8, pp. 493­500, 1988.

[17] P. Dular, C. Geuzaine, and W. Legros, "A natural method for coupling magnetodynamic h-formulations and circuit equations," IEEE transactions on magnetics, vol. 35, no. 3, pp. 1626­1629, 1999.
[18] S. Schöps, H. De Gersem, and T. Weiland, "Winding functions in transient magnetoquasistatic field-circuit coupled simulations," COMPEL: The international journal for computation and mathematics in electrical and electronic engineering, 2013.
[19] É. Béchet, N. Moës, and B. Wohlmuth, "A stable lagrange multiplier space for stiff interface conditions within the extended finite element method," International Journal for Numerical Methods in Engineering, vol. 78, no. 8, pp. 931­954, 2009.
[20] P. Dular, C. Geuzaine, F. Henrotte, and W. Legros, "A general environment for the treatment of discrete problems and its application to the finite element method," IEEE Transactions on Magnetics, vol. 34, no. 5, pp. 3395­3398, 1998.
[21] C. Geuzaine and J.-F. Remacle, "Gmsh: A 3-d finite element mesh generator with built-in pre-and post-processing facilities," International journal for numerical methods in engineering, vol. 79, no. 11, pp. 1309­ 1331, 2009.
[22] I. V. Lindell, Differential forms in electromagnetics, vol. 22. John Wiley & Sons, 2004.
[23] F. Brezzi and K.-J. Bathe, "A discourse on the stability conditions for mixed finite element formulations," Computer methods in applied mechanics and engineering, vol. 82, no. 1-3, pp. 27­57, 1990.
[24] O. C. Zienkiewicz, R. L. Taylor, and J. Z. Zhu, The finite element method: its basis and fundamentals. Elsevier, 2005.
[25] C. Geuzaine, High order hybrid finite element schemes for Maxwell's equations taking thin structures and global quantities into account. PhD thesis, 2001.
[26] D. Chapelle and K.-J. Bathe, "The inf-sup test," Computers & structures, vol. 47, no. 4-5, pp. 537­545, 1993.
[27] F. Brezzi, "On the existence, uniqueness and approximation of saddlepoint problems arising from lagrangian multipliers," Publications mathématiques et informatique de Rennes, no. S4, pp. 1­26, 1974.
[28] D. Malkus, "Eigenproblems associated with the discrete lbb condition for incompressible finite elements," International Journal of Engineering Science, vol. 19, no. 10, pp. 1299­1310, 1981.
[29] K. Van Bockstal, Numerical techniques for partial differential equations in superconductivity and thermoelasticity. PhD thesis, Ghent University, 2015.
[30] M. Laforest, "The p-curlcurl: Spaces, traces, coercivity and a helmholtz decomposition in lp," arXiv preprint arXiv:1808.05976, 2018.
[31] N. El-Abbasi and K.-J. Bathe, "Stability and patch test performance of contact discretizations and a new solution algorithm," Computers & Structures, vol. 79, no. 16, pp. 1473­1486, 2001.
[32] J. Pitkäranta, "Boundary subspaces for the finite element method with lagrange multipliers," Numerische Mathematik, vol. 33, no. 3, pp. 273­ 289, 1979.

