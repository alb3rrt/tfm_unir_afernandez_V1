arXiv:2106.00646v2 [physics.geo-ph] 2 Jun 2021

Open source code for downward continuation and redatuming of marine seismic data
C. E. Jimenez-Tejero *1, Cesar R. Ranero 1,2, Valenti Sallares1, and Claudia Gras1
1Barcelona Center for Subsurface Imaging, Institute of Marine Sciences, CSIC, Pg. Mar´itim de la Barceloneta 37-49, 08003 Barcelona
(Spain). 2 ICREA at CSIC
June 4, 2021
Abstract
The purpose of marine seismic experiments is to provide information of the structure and physical properties of the subsurface. The p-wave velocity distribution is the most commonly modelled property, usually by inversion of waveform attributes. In wide-angle reflection/refraction (WAS) experiments, arrival times of seismic phases identified in Ocean Bottom Seismometers (OBS), are used to image relatively deep structures. Most experiments have relatively low redundancy and produce limited resolution velocity models. As alternative to WAS experiments, the shallow subsurface is commonly studied with Multi-Channel Seismic (MCS) data collected in towed streamers. In this case, the recording of refractions as first arrivals is limited primarily by the streamer length and by structural features like water depth and P-wave velocity structure and, in general, a considerable amount of the refractions are masked by reflections and noise. However, MCS data of variable quality are available in many regions where no other data exist and previous work has shown that most of these data can also be used to retrieve velocity models through travel-time and full waveform inversion provided that first arrival information is extracted from the record sections with high accuracy and reliability. The most widely used tool to extract refraction information from MCS data is the so-called downward continuation technique, which is designed to redatuming streamer field data to the seafloor. In this new virtual configuration, the early refractions transform to first arrivals becoming visible from zero offset, which facilitates identification and use in travel-time tomography. However, there is little literature, let alone available codes, to be used with the available MCS data sets.
This work presents a user friendly open source HPC software for redatuming 2D streamer field data to the sea bottom for any seafloor relief. The main ingredient is the acoustic wave equation used backward in time, allowing first the redatuming of the receivers, and after, the redatuming of the sources. Assessment tools are provided to evaluate the information available after redatuming for specific data acquisition configurations. Also, we present a step-by-step analysis that defines the most important features that influence the quality of the redatumed, virtual recordings.
*ejimenez@icm.csic.es
1

1 Introduction
The estimation of physical properties of the subsurface has a broad range of applications in different scientific fields and industry sectors. This cross-disciplinary interest have prompted a sustained development of a suite of geophysical technologies to estimate them and determine their spatial distribution. The most commonly modelled physical property is the P-wave velocity (Vp). The determination of the spatial distribution of Vp can have multiple purposes, as it may serve as a base to estimate other physical properties or to infer other attributes such as rock type, porosity degree, and fluid or gas content and distribution. Additionally, the Vp distribution is a necessary input for a range of other products including a proper seismic imaging and particularly for depth migration.
The information on the Vp distribution may be needed as a low resolution map for seismic processing including stacking and time migration, or it may be needed as a high-resolution model for more sophisticated imaging applications like pre-stack depth migration. The resolution and uncertainty of any Vp distribution is strongly dependent on the characteristics of the field data available and on the technology used to extract it. Many works have discussed the different technologies available for Vp determination, which mainly include different forms of seismic data inversion, including both travel-time and waveform tomography approaches. All these methods exploit some characteristics of the input data, however, the field data potential is often not thoroughly analyzed nor fully exploited.
Most active-source methods used to determine the Vp distribution use pre-defined attributes of either reflected or refracted seismic phases. Reflected phases at structural boundaries may abound in stratigraphical sequences, but they are absent or highly discontinuous in basement rocks. Further, there is an intrinsic uncertainty between reflector position in the subsurface and the overlying Vp. In contrast, refracted waves are dominantly influenced by the seismic velocity of the media where they travel, and provide a more robust information of its Vp, but do not have direct information on the location and geometry of structural boundaries.
Seismic data recorded in hydrophone streamers is the most common method to study the sub-seafloor structure in marine settings. These data have source to receiver offsets limited to a few km, with modern-data offsets ranging from 6-15 km, but there exist a substantial archive of data acquired with shorter streamers, of 4-6 km from the late nineties and early two thousands, and 2.4-3 km for pre-90's vintage data. These data are of interest because they often image regions where no other data set exists.
The vast majority of the marine streamer data have been used to obtain only lowresolution Vp models through simplistic approaches, such as normal move out correction, which have an inherently high uncertainty. This is because these data were processed for imaging of impedance contrasts, and this type of regular processing and imaging does not require detailed Vp information. However, the limitations on the determination of the Vp distribution are also due to the limited acquisition offsets that provide only reflected arrivals in most cases. Clear refraction arrivals allowing to improve Vp modelling are only recorded in particular settings, typically in relatively shallow-water environments and/or in the most distal sections of the streamer.
Attempts to circumvent the shortcoming of Vp model building with streamer data and producing better-constrained and more accurate Vp models include the transformation, or redatuming, of the wavefield recorded by the streamer hydrophones to a virtual geometry with the acoustic source and hydrophone array downward continued to the depth and following the relief of the seafloor. This procedure allows collapsing
2

the reflection wavefield and exposing the refracted arrivals masked in the originally seismic record as first arrivals from zero offset. In this way, the arrival times can be picked and used to perform first arrival [11] or joint refraction and reflection travel time tomography [12] or their waveforms can be inverted for Vp determination ([29], [21], [18]).
Although this method has the potential to provide data for robust Vp model building to be used for depth imaging or as initial model for waveform inversion, it has not been widely used to data possibly because no standard downward continuation method has been described in the literature with sufficient detail and no freely available userfriendly code has been released. Further, no systematic analysis has been presented to describe how offset distance, water depth and subsurface Vp distribution affect or even prevent the recording of refracted arrivals in the streamer.
Here we present, describe and provide a dedicated in-house software and a short manual to apply DC to data with Seismic Unix (SU) format in a user friendly manner. Additionally, we include a series of tests to provide a guide to understand and predict the presence of refracted arrivals in streamer data and use it for Vp model building after downward continuation (DC) of the records. The code is intended to produce the DC record that could be used for Vp model building using a preferred tomographic approach and our guide gives some clues on how much of the record propagated to the seafloor can reliably be used for travel-time inversion.

2 Materials and methods
In this work, the two-way acoustic wave equation in 2D is solved to generate synthetic shot gathers with different acquisition geometries and it is also the main ingredient for redatuming the streamer field data from the sea surface to the seafloor. This section describes the implementation of the wave equation in detail and how to use it for the data redatuming procedure. Besides, we frame our work within the different redatuming techniques presented in the literature. Also, we describe the computational aspects related to the code and the data pre-processing techniques applied to improve the quality of the results.

2.1 2D acoustic wave propagation

The homogeneous, isotropic and acoustic approximations are applied to the wave equa-

tion. The wave propagation equation is solved using a finite difference scheme of 6th

order in space and 2nd order in time. We apply a free surface at the top and con-

volutional perfectly matched layers (CPML) scheme [27] to avoid artificial numerical

reflections on the left, right and bottom boundaries. The wave-equation is defined

differently outside and inside the PML layers. The acoustic wavefield propagation,

p = p(r,t), of a given source, fs = fs(S, t), in a velocity model, v = v(r, t), is defined

as follows:

1 v2

t2p

=

k2pk

+

fs

+

fpPML

,

(1)



k · k(p) + k(p), r  PML

fpPML = 0, r / PML

(2)

3

Geometry Velocity: v

Streamer OBS DC

vwater  vEarth vwater  vEarth vwater  vEarth

Source: fs
Ricker(Suj p, t) Ricker(Suj p, t) Ricker(Sdj own, t)

Wavefield: p shot gather solution at r = R

pstreamer(r, t)

pstreamer(Rup, t)

pOBS(r, t)

pOBS(Rdown, t)

pDC(r, t)

pDC(Rdown, t)

Redatumed OBS
Redatumed DC

vwater vwater

pstreamer(Rup, -t) prOBS(r, -t)

prOBS(Rdown, t)

-PG ~prOBS(Sup, -t) ~prDC(r, -t) -SG prDC(Rdown, t)

Table 1: Components and solution of the 2D-wave equation for the different geometries. First column: list of the different geometries, real (streamer, OBS and DC) and redatumed (rOBS and rDC). Second column: velocity model. Third column: source function, fs. Forth column: wavefield function propagating in space and time. Fifth column: shot gather solution in the set of receivers, R. The expression PG (SG) indicates the conversion to point gather (shot gather) and the functions p and ~p refer to the shot gathers and point gathers, respectively. The up and down indexes refer to the datum geometry, i.e. depth of the source and receiver at the surface and seafloor, respectively. The symbol  in the second column refers to the joint consideration of the water and Earth layers to describe the velocity model. The minus sign in the time, -t, refers to the backwards propagation. For more details, check sections 2.1 and 2.2.

The additional term for the PML layer fpPML is defined with the auxiliary variables k(p) and k(p), whose evolution for each component (k=x,z) and time step, n, is:

[k(p)]n = ak · [k(p)]n-1 + bk · [kpk]n ,

(3)

[k(p)]n = ak · [k(p)]n-1 + bk · k2pk + kk(p) n ,

(4)

(5)

where the parameters ak and bk are:

ak = e-(k+k)·t ,

bk

=

k k + k

· (ak

-

1)

.

(6)

with t the time step, k the absorption damping factor of the acoustic wave and k the real positive pole shifting factor [35].
Table 1 displays the different components conforming the acoustic wave equation (Eq. 1) and the shot gather solution depending on the geometry (first column). The three first rows refer to the acquisition geometries: streamer geometry in which sources and receivers at the sea surface, Ocean Bottom SOBSeismometer geometry (OBS) with sources at surface and receivers at the seafloor, and DC geometry with both sources and receivers at the seafloor. The second column indicates the velocity model used, defined

4

by a water layer and the sub-seafloor layer (vwater  vEarth). The third column shows the source used to synthetically generate shot gathers in these geometries, defined as a Ricker wavelet located in the surface of the sea (upper index 'up') for the streamer and OBS geometries and in the seafloor (upper index 'down') for the DC geometry. Each source position j is defined as:

Sujp = (xSj , zSupj ); Sdjown = (xSj , zSdojwn) ,

(7)

where the index j, runs on the number of sources, j = 1, ..., NS. The solution for a shot gather in the different geometries is shown in last column of the table, and it is

obtained by collapsing the wavefield (fourth column) at each receiver position, i.e. at

the sea surface for geometries (Rdiown

the streamer geometry ), respectively:

(Rui p )

and

at

the

seafloor

for

the

OBS

and

DC

Ruip = (xRi , zRupi ); Rdiown = (xRi , zRdoiwn) ,

(8)

where the index i, runs on the number of receivers, i = 1, ..., NR.

2.2 Downward Continuation redatuming
The DC redatuming of the streamer data from the sea surface () to the seafloor () is done in two steps:

Receivers redatuming First, the receivers are redatumed to the seafloor, giving as a result a virtual shot gather in OBS geometry. To do so, Eq.1 is used as well with the components displayed in Tab. 1 in the "redatumed OBS" row. In this step, the traces recorded in the streamer are used as sources but propagated to the seafloor back in time, for each shot gather. Note that in this case the source is in fact a super-shot built with the traces in the streamer propagating all at once. The super-shot propagation is necessary so that the waveform transforms successfully into the new geometry. The source is indicated in Tab. 1 as pstreamer(Rup, -t), in which -t refers to the back propagation:

- t = (tNt , tNt-1, ..., t1) ,

(9)

and R refers to the position of all the traces, now sources, conforming the super-shot:

Rup = (Ru1p, ..., RuNpR ) .

(10)

The solution of the wave equation for the streamer shot gather redatumed to the OBS geometry, is prOBS(Rdown, t) (see Tab. 1).

Sources redatuming The second and last step is the downward continuation of the sources. The propagation is solved again using Eq.1 with the components displayed in Tab. 1 in the "redatumed DC" row. For that purpose, the virtual shot gathers in OBS geometry obtained in the first step are transformed into a set of point gathers. A point gather is the collection of shots which contribute with a trace to that specific point in the model. The maximum number of shots which can influence a point gather is limited by those located forward from this point at a maximum distance equal to the streamer length, SL. For example, 120 is the maximum number of shots for a point gather in the case of having SL = 6 km and 50 meters of distance between sources. The shots located further from the SL distance in the direction of the boat, or those behind

5

the point gather, do not contribute with any trace because the boat with the streamer

is already out of radar or it has not passed by the point yet, respectively. Notice also

that the number of shots for a point gather depends on the location of this point along

the model. Thus, the point gathers at the edges of the model, beginning and end, are

influenced by less shots compared to the point gathers in the middle of the model. To

understand this statement, the first point gather, which coincides with the last receiver

in the streamer of the first shot, is only influenced by that one shot.

Once the point gathers are built, they are propagated backward in time (-t), from the

sea surface to the seafloor. Similarly to the redatuming of receivers to the seafloor in the

first step, the propagation of each point gather needs to be done as a super-shot so that

the waveform transform correctly into the DC geometry (see Tab.1). The super-shot

of point gathers backward in time and acting as a source, is defined as ~prOBS(Sup, -t), where S refers to the position of all the shots in the sea surface, conforming each point

gather:

Sup = (Su1p, ..., SuNpSP G )

(11)

being NSP G the number of shots conforming an specific point gather. Finally, the solution of the wave equation for the streamer shot gather redatumed to the DC geometry, is defined as prDC(Rdown, t) (see Tab. 1).

2.3 Differences with other methodologies
The idea of redatuming was first introduced by [6] and [7] as a wavefield extrapolation for migration ([14], [15], [23]). The datuming can be considered an ingredient of migration, when migration is done as a downward continuation process ([3], [2]). That is because migration intents to remove the effects of wavefield propagation by means of inverse extrapolation [3]. But migration, in addition to downward continuation, requires imaging principle [34].
It is difficult to compare contributions for a specific redatuming method with other ones based on the literature. There are many factors defined differently in each work depending on the extrapolation method used, such as the type of operator or approach, assumptions, the extrapolation domain, and approaches to the wave propagation, which all play important roles in the result.
In general, redatuming methods apply time shifts and amplitude factors to simulate data acquired at a different surface. First redatuming approaches had model-based operators ([6], [7], [30], [8], [25]) which require the true velocity model between datums to work well. Besides model-driven redatuming operators, there is another way to derive these operators by using data-driven approaches. In this case, the operators are extracted from the input data set using the common-focus-point (CFP) described by [4] and [5]). For the CFP technology, the traveltimes from the surface to a designed subsurface point are estimated from the shot gathers by focusing seismic sources iteratively toward a subsurface point while updating the involved traveltimes according to some criteria ([26], [31]). Three different techniques to compute the wavefield extrapolation are described in [3], which are the Kirchhoff-summation approach ([6], [7], [30], [8], [31]), the plane-wave method ([17], [1], [13]), and the finite difference technique ([25], [11]). All of them are wave equation datuming (WED) methods as they use extrapolation operators that account for different forms of wave propagation between the acquisition surface and the new datum level by means of the wave equation. These operators represent Green's functions. Some of them are based on simplifying assumptions such as one-way wave propagation and primary-only data ([6], [7], [30], [8], [4],

6

[5], [31], [18]). In contrast, two-way wave propagation redatuming operators ([22], [23], [25], [26], [11]) also include multiples and refractions. Many implementations have also problems dealing with lateral Vp variations due to the approximate solution to the wave equation ([6], [7], [30], [1], [18], [13]). More recently, cross-correlation redatuming methods have also emerged and been developed [28] to overcome model-based limitations of wave-equation statics, or the need to specify certain events in CFP technology, among others. The cross-correlation redatuming require weighted correlation of the traces with one other, followed by summation over all sources and sometimes receivers ([28], [32], [33]).
Here, redatuming is formulated by solving the two-way full acoustic wave equation by the finite difference approach in the space-time domain. This scheme has a simple implementation, includes all data with no a prior phase selection, can easily be adapted to irregular new datum surfaces being stable to steeply dipping areas, and allows to deal with arbitrary Vp models. Its drawbacks are the ones associated to the finite difference scheme, mainly the numerical dispersion and, since it is a model-based redatuming approach, the need of having a sufficiently good Vp model to construct the operators. But the accuracy of Vp becomes a minor problem in the case of applying it through the water column.
2.4 Computational aspects
The DC software presented here is an open source code developed under fortran 90 and HPC architecture built with open MPI. For a good performance, the main requirement is to run it on a cluster environment. Next, we describe the main computational features and requirements of the code: Input/output data The input field data is directly read in SU format, which is a modification of the standard binary SEG-Y to work with Seismic Unix. SU is similar to SEG-Y but with less amount of information encoded in the headers. In the SU format, each shot consists of a collection of traces, each of them attached to a 240 bytes header encoding experimental information. Apart from reading the traces content, parameters like the shot gather location and the offset at each trace can also be given through the headers. The bathymetry is provided as a text file and the value of the main acquisition parameters (number of receivers, nt, dt ...) is read also as a text file. Regarding the output results, they are stored also in SU format. We refer to the software manual for more specific details about the input/output files. HPC architecture The parallelization is designed differently in the first and second step of the redatuming process. In the first step, each set of receivers is downward continued to the seafloor propagating through the water layer back in time. This is an independent process for each shot gather, and therefore the number of shot gathers are parallelized with the number of available process slots at the cluster. On the contrary, in the second step the point gathers are the ones that are independently back propagated through the water layer, and that is why the parallelization is applied in this case to the number of point gathers. Stack overflow Due to the fact that a realistic seismic line commonly consists of thousands of shot gathers, the SU file must be divided in parts to avoid stack overflow at the time of reading the file in Fortran. The maximum size allowed for each partition is
7

2 GB and it should contain a whole number of shot gathers. That is, taking into account

that float numbers occupy 4 bytes, the number of bytes occupied by one shot stored in

SU format is, Bytesshot = NR · (240 + 4 · Nt), being NR the number of receivers in

the streamer and Nt the number of time-steps. In this way, the maximum number of

shots stored partition of

in each SU file partition the main SU file can be

odfo, nfoerwexitahmthpeles, c1r.i9ptGpBroisvi1d.e9d·B(1yit.ne0s7sth·ho1t0e9s)osfhtwotasr.eT, hoer

directly by the user. This partition does not affect the redatuming results, it is only a

requirement so that the complete SU data file can be read in the code.

2.5 Data pre-processing
Field data processing prior to redatuming helps maximize the quality of the results. Here we list some useful processing techniques:

Muting or filtering direct waves This is important to avoid the screening of the first arrivals in the redatumed shot gathers due to the propagation of the direct wave through the water column. It also allows to clean noise that commonly masks the region, between zero time and the first arrivals. The muting of the direct wave can be done using some form of dip filter or simply by surgical mute.

Band-pass filter A Butterworth type filter can be applied to remove the lowest frequencies  2 Hz and frequencies  80 Hz to improve signal to noise ratio.

Spherical divergence Applying spherical divergence on the data to use realistic amplitudes along the offset.

Improve acquisition geometry A low fold acquisition geometry produces redatumed results with a poor signal to noise ratio. Interpolating shot gathers to a closer acquisition geometry, that is, decreasing the distance between receivers and also the distance between sources, hence improving the signal to noise ratio in the redatumed results. This is typically necessary for most pre-90's vintage data.

Shorten record time To save computational time, it is plausible to shorten the record time of the input data. This applies when only the time of the first arrivals is needed from the whole redatumed shot gather. A good estimation for this cut-off in order to not eliminate essential information is:

timecut-off = FAoDfCfset=SL + TWTwater

(12)

where FAoDfCfset=SL refers to the estimated first arrival at the end of streamer (SL) in the new virtual DC geometry, and TWTwater the 2-way travel time propagating through the water layer with depth, D:

FAoDfCfset=SL

=

SL VEarth ;

TWTwater

=

2·D Vwater

(13)

As an example, if having field data set with SL = 6 km, D = 1 km and the estimation for the velocity is VEarth = 2 km/s, a cut-off of 4.3 seconds can be applied to the streamer data. A typical record time is 8 seconds, therefore to be able to shorten record times by 50% in this example, directly would reflect in saving computational resources, including not only RAM but also the back-propagation time at both redatuming steps.

8

3 Tests and results
3.1 Overview
To introduce the main questions to be addressed in this analysis, we show in Fig 1 the redatuming process applied to a field data case from the TopoMed experiment ([9], [10]). Panel a) displays the original field data and panels b) and c) show the virtual shot gather redatumed to OBS and DC geometries, respectively. The most remarkable features in Fig. 1 are the full waveform transformation and the water layer decrease of 50% in the virtual OBS geometry (panel b) and 100% in the DC one (panel c), respectively. It is also noticeable the short segment of visible refractions in the original data (panel a), around 0.5 km at the end of the streamer. In the virtual OBS shot gather (panel b), the refractions are visible from 4 km and in the DC shot gather (panel c) the refractions appear as first arrivals from 0 km offset, as expected. Additionally, the appearance of aliasing noise and the odd performance of the redatumed waveforms at long offsets lead to the following questions:
· Does the total amount of available refractions increase in the virtual redatumed shot gathers?
· The redatumed data appear to be truncated at long offsets. Why do the phases retract upwards and the amplitudes decrease?
· Where does the noise in the virtual redatumed shot gathers come from? Can it be reduced?
These and more issues are explored in detail in this section. First, we test the performance of the redatuming algorithm with synthetic data. Benchmark models are used to focus on the most relevant attributes of the process and to understand how the refractions and reflections transform at the virtual OBS and DC acquisition geometries. The redatumed results are compared to the ones directly simulated in such configurations. As a second step and to visualize the results on a more realistic geological setting, the redatuming algorithm is applied to data generated using the Marmousi-2 model ([16]). Finally, we show the redatumed results for two different field data sets, TopoMed (already introduced in Fig. 1) and FRAME experiments, recorded with the same acquisition system and setting but at different water depths.
3.2 Unraveling the DC redatuming using benchmark models: seafloor refractions and critical offsets
The key point on data redatuming lies on the straightforward visualization of the refractions as first arrivals in the virtual DC shot gathers from zero offset, in contrast to the substantial amount of refracted waves masked in the original streamer data. Choosing a suitable experimental acquisition configuration is essential to record a significant amount of refractions in the streamer. The empirical "rule of thumb" suggests that the streamer length should be at least the water depth to record refracted arrivals. In fact, an optimal streamer length is key to properly redatuming data to the seafloor, as we show below.
In addition to streamer length, several more parameters influence the length of recorded refractions. These are the Vp model structure, the seafloor depth, and the
9

seafloor slope angle. We explore the parameter space with a set of benchmark models, all of them with a constant water velocity, Vwater = 1.5 km/s. The models were generated varying the following parameters:

· Water column depth, D, from 0.5 to 6 km.

· One subsurface layer defined with the p-wave velocity, VEarth, from 2 to 5 km/s. · Slope angle, , from 0º to 20º.

Simple benchmark models permit to predict the critical offset distances. On the one hand, the minimum offset at which refractions are recorded in the streamer data and on the other hand, the maximum offset at which the first arrivals are truncated in the virtual redatumed shot gathers. Appendix A shows the analytical calculation of the minimum offset at which refractions appear earlier than reflections for the streamer geometry (see Fig. 14-a), and the same in appendix B for OBS geometry (see Fig. 14-b). For a flat seafloor ( = 0) the minimum offset with refractions, depending on the acquisition geometry, is:

Offsetsmtrienamer

=

2 · D · u , 1 - u2

(14)

OffsetOmBinS

=

D · u , 1 - u2

(15)

OffsetDmCin = 0 ,

(16)

where D is the seafloor depth and u = Vwater/VEarth. Given an specific streamer length, SL, the total offset length containing refractions in the streamer is:

Offsettotal = SL - Offsetsmtrienamer .

(17)

By applying the redatuming process, the waveform is transformed accordingly to the new datum surface, containing the existing information in the original streamer shot gather, no more no less. The total length containing refractions in the streamer shot gathers increases when the shot gathers are directly simulated in OBS and DC acquisition geometries, however it is important to understand in this respect, that this total offset length remains the same when the streamer shot gather is virtually redatumed to these geometries. As an example for the case of the virtual DC geometry, the total offset with refractions does not change it only gets displaced to start at zero offset. Taking this into account, it is easy to predict the maximum reliable offset in the virtual redatumed shot gathers:

OffsetOmBaxS = OffsetOmBinS + Offsettotal ,

(18)

OffsetDmCax = Offsettotal .

(19)

Data, including first arrivals, are truncated beyond this point, leading after to the appearance of diffraction tails which are naturally produced by the inverse wave-equation solver. This maximum offset is indeed, the limit-of-use of the whole virtually redatumed shot gather.
It is worth mentioning that the simulation time must be large enough to ensure the recording of refractions and reflections along the entire streamer cable. This can be accomplished by calculating the minimum time required in the equations 24 and 25 (appendix A) with the offset parameter set to the specific streamer length. Setting a

10

Shot geometry Min offset Max offset Total offset

Streamer

F

SL

SL - F

OBS DC

F 2

SL

SL

-

F 2

0

SL

SL

redatumed OBS

F 2

redatumed DC

0

SL

-

F 2

SL - F

SL - F SL - F

Table 2: Outline for the critical offset distances for refractions in real and virtually redatumed shot gathers for streamer, OBS and DC geometries, considering a flat seafloor. SL means streamer length and F = Offsetsmtrienamer( = 0) (see Eq. 14). It is assumed that SL > F.
long enough recording time guarantees an optimal efficiency of the experimental setup chosen to study a particular geological setting.
As an example, we show in Fig. 2 the DC test applied to one of the benchmark models, with a 2 km seafloor depth, a subsurface velocity of VEarth = 3 km/s and a streamer length with SL = 6 km. Concerning the main acquisition parameters, the simulation time is set to 10 seconds, the source is a Ricker wavelet with central frequency of 10 Hz, the distance between sources is 50 m and between receivers is 25 m. Panels a, b1 and c1 display the shot gathers directly generated in streamer, OBS and DC geometry, respectively. In contrast, panels b2 and c2 display the redatumed shot gather from panel a) into the virtual OBS and DC geometries. The minimum offset at which refractions are recorded in the streamer geometry is indicated in the figure with a dashed blue line (panel a). In contrast, the dashed yellow and red lines indicate the maximum offset limit for OBS and DC geometry (panels b2 and c2), respectively. It is apparent the considerable offset length, 1 km, where the refractions remain masked in the streamer (panel a). In the following list, we provide assessment tools to understand whether the DC tool is worth to be applied to a specific field data set:
· Tab. 2 displays a summary of the critical offset distances and total refraction length in each real and virtual acquisition geometries for flat seafloor marine settings.
· The minimum offset at which refractions are recorded in streamer geometry is represented in Fig. 3, for a wide range of depths and subsurface velocities, and for a flat seafloor. The equation 14 is used to compute the minimum offset. This figure helps to understand the challenge and difficulties for recording refractions in marine settings. As expected, there is an inversely proportional decrease of refractions with increasing water depth. Also, the higher the sub-seafloor velocity, the longer the recorded refractions.
· Upper panels in Fig. 4 (a, b and c) shows the maximum offset with refractions in the redatumed shot gathers to virtual DC geometry, OffsetDmCax (Eq. 19). To
11

recreate realistic marine seismic acquisition experiments, we select three different streamer lengths; 3 km (panel a), 6 km (panel b) and 10 km (panel c). For each length, the results are shown depending on the different p-wave velocities of the subsurface (x-axis) and seafloor depths (y-axis). The areas in white are the domains in which the DC method cannot be applied due to the absence of refractions (OffsetDmCax SL). As expected, the longer the streamer, the greater the maximum offset in the redatumed shot gathers · Lower panel in Fig 4 (d) summarize the three upper panels in one. It shows tlsheunebgsstuahrmfaaencdepavtrhealemocweittaeitere,srO. cTfofhsliuestmDmfiCnagxu,drbeeuphtthed,lepnpset=noduSiDnnLgd, eaornnsdtathnthedirstahtieisocdobosentt/ewefeffioecnrietthnheceysdtbirfaeflaearmnecneert depending on the streamer length in a particular geological setting. Clearly, the slope of the different lines is particularly steep for the first n = 3 steps. This means that if using an streamer length at least 3 times the seafloor depth, it is relatively easy to register refractions in 60%-70% of the total streamer length (depending on VEarth). However, to go beyond 80% efficiency, the streamer length must be 10-20 times the water column depth, an unfeasible geometry for deep water. We refer to Supplementary Material to see more tests using benchmark models. In each test, each specific parameter (water depth, p-wave velocity and streamer length) is modified separately to show its influence in the redatumed results. Also, an analysis is done for a 2-layer Benchmark model to study the behavior of the reflections. Regarding the reflections, which are always recorded from zero offset, their transformation into virtual geometries is shown to be suitable whenever they had previously been recorded in the entire streamer length.
3.3 DC redatuming applied to a realistic model
The sub-seafloor Marmousi model allows to test the redatuming process in a realistic geological scenario. For this test, the model has been re-dimensioned to 19 km length x 4 km depth and a water column of 1 km has been added (see Fig. 5). The simulation time is 10 seconds, the shot point distance 50 m, streamer length of 6 km, receiver distance of 12.5 m, and with a source using a Ricker wavelet centered at 10 Hz. The results are shown in Fig. 6 for a shot gather placed at 12 km in the model.
The near offsets record refractions from the shallowest subsurface and the far offsets from deeper parts of the model. As velocity increases with depth, the average velocity of first arrivals increases with offset. This agrees with the results in Fig. 6panel c1, where the first arrivals form a line with a slope of 2 km/s at near offsets and increases up to 2.7 km/s by the end of the streamer.
Considering the geological complexity of this model, it is not possible to predict the critical offsets analytically. However, this information can be obtained using Tab. 2 with SL = 6 km, D = 1 km, and the sub-seafloor velocity which ranges between 2 and 3 km/s (see Fig. 5-b). This configuration sets the minimum offset to record refractions in streamer geometry between 1.15 and 2.26 km, i.e. the maximum offset for DC geometry with information between 3.74 and 4.85 km. Comparing the shot gather in panel c2 with the shot gather generated with DC geometry in panel c1, we know that OffsetDmCax  4.5 km, which fits within the range of possible predicted values. This implies that the minimum offset at which seafloor refractions are recorded in the streamer
12

Parameter Streamer length Distance (sources) Distance (receivers) Recording time Depth (1D-profile)

TopoMed 6 km 50 m 12.5 m 8s
1.62 km

Frame 6 km 37.5 m 12.5 m 14 s 5 km

Table 3: Acquisition parameters for the synthetic and field TopoMed and Frame tests. For each case, the specific depth of the field shot gather redatumed, coincident with the position of the 1D-depth profile, is also displayed in the table.

is 1.5 km. The fact that refractions were totally masked at this offset and beyond (see Fig. 6-a), shows the advantage of applying redatuming techniques.

3.4 DC redatuming applied to field data
In this section, we apply the DC scheme presented above to field data recorded during FRAME and TopoMed experiments in order to redatuming them to the seafloor. The panels a1) and b1) in Fig. 7 display the Vp tomographic models obtained from the seismic records. The black and red arrows indicate de location of the source and depth profiles shown in panels a2) and b2). The TopoMed experiment was conducted in the Alboran Sea ([9], [10]), whereas the FRAME experiment was conducted in the West Iberian margin [24], and collected by the Spanish R/V Sarmiento de Gamboa. Although the upper kilometres of sub-seafloor velocity gradients of both experiments are similar,(Fig 7, panel c) the water depth of TopoMed profile is 1.5 km whereas for FRAME data it is 5 km.
To better understand the redatumed field data results at each experiment, the 1Ddepth profiles are used as Vp model to synthetically generate shot gathers with the same acquisition geometry than the original experiment. Then, the redatuming algorithm is applied to the synthetic generated data and also to the field data records. Within each experiment, the results obtained between the redatumed synthetic and field shot gathers are consistent. However, the algorithm performance works very differently for each geological setting.

3.4.1 Well-suited case: TopoMed experiment

The TopoMed field data records were collected with the acquisition parameters shown

in the first column of Tab. 3. The ratio between the streamer length and the water

tcoolruemconrdderpetfhraicstnio=nsSDLi=n

3.7, and, as shown at least 50%-75%

in Fig. of the

4-d), total

it is an efficient ratio that allows streamer length. The synthetic

test using the TopoMed 1D-depth profile, Fig 8 (left panels), shows that the maximum

offset in the DC-redatumed shot gather coincides with the range of Vp values provided in Fig. 4, around 4.4 km in panel c2). Similarly for the field data in Fig. 8 (panels d-e-f), the virtual redatumed shot gathers transform according to the OBS and DC geometry,

showing the critical offset around 4.4 km as well (panel f).

13

3.4.2 Poorly-suited case: Frame experiment Second column of Tab. 3 shows the acquisition geometry of the FRAME experiment. In this case, the ratio between the streamer length and the water column depth is n = 1.2 (see panel d, Fig 4), which indicates a very poor efficiency to register refractions in the streamer and therefore this portends a bad functioning of the redatuming algorithm. The synthetic test using the model defined with the Frame 1D-depth profile is shown in Fig. 9 (left panels). The simulated and redatumed shot gathers in the OBS geometry in panels b1) and b2) are only coincident up to 3 km offset (yellow dashed line). This confirms that the refractions in streamer geometry can only be recorded from 6 km onwards and that the average velocity of the recorded waves is below 3 km/s. This means that there are no refractions originally recorded in the streamer and therefore only reflections are properly redatumed up to the maximum offset in OBS geometry. Regarding the DC geometry in panels c1) and c2), it is apparent that the results only show the propagation tails. Furthermore, the field data redatuming shown in panels e) and f) fails in the same manner too. We can conclude that for marine settings in which the water column depth is 5 km, streamer lengths of at least 10 km should be used (n = 2) if we aim at recording refractions as first arrivals.
3.5 Other relevant aspects
3.5.1 Water column modelling For simplicity, in all the tests shown above, the water layer is defined using an homogeneous value for the velocity model Vwater = 1500 m/s. However sea water P-wave velocity commonly ranges between 1520 m/s and 1450 m/s. Due to the fact that the DC algorithm presented in this work is based on the 2-way wave equation, it is important to understand the influence of the water layer modelling on the streamer data propagation. As an example, we show in panels a) and b) of Fig. 11, XBT data collected for salinity and temperature at an specific point in the Atlantic Ocean (3730'N,1230'W) where the seafloor reaches 5 km depth. The panel c) of the same figure displays the P-wave velocity calculated using the Mackenzie empirical equation [20] (solid black line), which depends on the depth, salinity and temperature. The dashed blue line indicates the averaged velocity from the sea-surface till each specific depth. It is easy to see that this line oscillates around 1511 m/s.
In Fig. 12 the TWT misfit is calculated between the true and synthetic water models, for the reflections and refractions from the seafloor. The TWT misfits, taking into account the equations 24 for refractions and 25 for reflections, are defined as:

TWTrefraction = |ttrreufreaction - tsreyfnrtahction|, TWTreflection = |ttrreufleection - tsreyflnethction|

(20) (21)

The propagation in the true water model (black solid line in panel c of Fig.11), is compared to two different homogenous synthetic models; the default value in most of the studies, 1500 m/s, and the averaged value for this particular setting, 1511 m/s. The TWT misfit for reflections (panels a and b) is shown for different offsets (x-axis) and seafloor depths (y-axis). The panel a) shows the misfit between the true model and the synthetic one with Vwater = 1500 m/s, and similarly in panel b) but for the synthetic model with Vwater = 1511 m/s. Also, the TWT misfit for seafloor refractions is shown at the lower panels (c and d), but in this case the x-axis indicates the p-wave

14

velocity of the subsurface, VEarth. The most important observation is that when using a constant velocity model outside the true velocity ranges, the error can reach the order of 0.1 second (2% in this example). However, if using a suitable p-wave velocity value, the propagation error becomes negligible (0.5%). Although the algorithm is prepared also to read real data from XBT measurements, for simplicity reasons and on those cases where marine field data is not available, we recommend to use a realistic constant water velocity value.

3.5.2 Seafloor slope

The DC algorithm presented in this work can be applied to any type of marine setting

independently of seafloor roughness or steepness. The transformation will be success-

ful whenever there is enough refractions recorded in the original field data, and this

mainly depends on the water column depth, subsurface velocity and streamer length.

When the seafloor slope is pronounced, it is convenient to take it into account to prop-

erly predict the critical offset. The equation 34 in Appendix A, gives the exact pre-

diction for the minimum offset depending on the tilted angle of the seafloor, . To

understand the effects of the slope of the recorded streamer data, we compute the error

formula:

Error =

Offsetmin() - Offsetmin(0) Offsetmin(0)

.

(22)

This formula is interpreted as the error for the prediction of the minimum refraction offset in streamer data, when the seafloor is considered flat and the slope angle ignored. Fig. 10 shows as an example of the error(%) depending on the subsurface velocity (x-axis) and the slope angle  (y-axis) for an experimental situation in which Ds < Dr (Eq.34, appendix A). The top limit for the tilted angle is set to 20º which is a realistic upper limit for many submarine slopes [19]. It is easy to see that for angles,  < 10º, the total segment of the recorded refractions varies less than 15% with respect to that recorded for flat surfaces. Therefore, the prediction for  = 0º is a good first approximation to evaluate field data refractions in common marine scenarios.

3.5.3 Streamer data with poor acquisition geometry The same test shown for the Marmousi model in Fig. 6 is repeated here, but to simulate vintage field data, where shot point distance is 100 m and receiver distance 50 m. The challenge for the redatuming algorithm is bigger in this case, as there is less data available due to the sparse acquisition geometry. In Fig. 13, we plot only the results obtained after redatuming the shotgather to DC geometry. As expected, the signal to noise ratio is poor (panel a), and aliasing noise is apparent. However, if the original shot gathers are interpolated to halve shot point and receiver distance before the redatuming, the signal to noise ratio improves (panel b).

4 Discussion
This work addresses the performance and scope of a redatuming procedure based on the 2-way wave equation. The redatuming transforms the streamer field data from the sea surface to the seafloor, removing the water column from the data. In the particular case of the early refractions, they transform as first arrivals. This provides the advantage to visualize originally hidden recorded refractions, becoming distinguishable as first

15

arrivals in the virtual DC configuration. In that respect, the characterization of field data as suitable and unsuitable cases for redatuming depends on the amount of refractions recorded, as shown in the tests. The recorded length depends on the ratio between the streamer length and the seafloor depth, the subsurface velocity and seafloor slope.
The quantification of early refractions is central point to this analysis due to their importance for building robust velocity models. Besides, it is also the best marker to verify the reliability of the virtual shot gathers and quantify the maximum offset in all cases. This is possible thanks to the easy estimation of the seafloor bathymetry and the water velocity model, in contrast to the difficult characterization of the subsurface. We have shown that the redatumed results are a space-time transformation of only the recorded field data. In this respect, the redatuming does not increase the amount of information from deeper areas as if the shot had directly been recorded on the seafloor. For this reason, it is essential to determine as good as possible the maximum reliable offset in the redatumed virtual geometry.
The tests using benchmark models helps to understand that the first point (time and offset distance) where seafloor refractions are recorded in the streamer is the actual starting point of the redatumed shotgather in DC geometry. The first arrivals in this virtual DC geometry form a line with a slope equal to the value of the velocity of those layers where the refractions travelled, i.e. near offsets register refractions from the shallowest parts of the subsurface and the far offsets from deeper parts.
Regarding the reflections from the different subsurface layers, the tests with the benchmark model with two subsurface layers (see Supplementary Material) show that the transformation is also suitable up to the maximum offset in DC virtual geometry, whenever the reflection has been previously recorded in the streamer.
It is also noticeable the poor transformation of the resultant direct wave traveling through the water layer in the redatumed DC shot gathers (see Figs. 2, 6, 8, 9 and figures displayed in the Supplementary Material). In this case, the original wave in the streamer data which transform as the direct wave through the water in the virtual DCshot gather corresponds to the refractions just above the seafloor, in the water part. As in the case of refractions, and given a specific geological scenario, this offset can only improve using longer streamers. However, the offset of the properly transformed direct wave is always going to be shorter compared to the offset of the properly transformed refractions, and this would be a problem in the case of needing to use the full waveform in the virtual geometry DC.
In this way, although the first arrivals in the virtual shot gather and also the reflections are predictable and their reliability easy to quantify, it is not straightforward to understand and control all the details related to the entire waveform. Taking all these aspects into account and the analysis presented in Fig. 4, the best field data candidates to be redatumed to the seafloor are those recorded with streamer lengths at least three times the seafloor depth (n 3), and with an average p-wave velocity of the subsurface of VEarth 3 km/s. Under these conditions, refractions are recovered at least in 50% to 90% of the streamer length.
The redatuming procedure in this work is based on wave propagation throughout the water column, and in this sense the algorithm is model-dependent. However, as the model refers only to the sea water, where the velocity variation oscillates in a relatively small range of velocity values (< 70 m/s), the absence of detailed information from the water layer is not a drawback to obtain reliable results. If the water column is characterized with a constant but realistic value for the velocity model, the estimated error at a specific offset for reflections and refractions is negligible, from 0.5% to 2%, compared to the value obtained using the real water velocity model.
16

With respect to noise produced by data aliasing, it is a natural sub-product of the redatuming. The approach to minimise it is data interpolation that increases signal to noise ratio attenuating aliasing noise.
5 Conclusion
· We present and provide an easy-to-use open source software that enables the redatuming of 2D streamer data to the seafloor.
· It is a HPC-based code, therefore for a suitable performance it should be executed on a cluster.
· The input field data is required in SU format, which is a common format to store geophysical data.
· Not all field data are suitable to be redatumed, only if enough amount of refractions have been registered in the streamer. We provide a suit of analytical formulas and assessment visual tools to estimate the suitability of a given data set for DC. We show that this depends on the streamer length, seafloor depth, subsurface p-wave velocity and seafloor slope.
· After applying the DC algorithm the refracted arrivals recorded in the streamer appear as first arrivals from zero offset, so that they are straightforward to pick. This is the main advantage taking into account that a considerable amount of the refractions are screened by reflections and noise in the original streamer recordings.
· Apart from the first arrival picking, it is also possible to use the reflection information. However, the usage of the whole redatumed waveform is not so straightforward.
· The absence of a detailed velocity model of the water layer is not an impediment to obtain reliable results.
· For vintage data recorded with poor acquisition geometry, narrowing the acquisition mesh allows the correct redatuming improving the data contrast and avoiding aliasing noise. This would give a second chance to many past experiments with relevant information in areas where no new data is available.
6 Documentation
The software with a short manual will be soon available online.
Acknowledgments
This is a contribution of the Barcelona Center for Subsurface Imaging. The work has been partially supported by project FRAME with reference CTM2015-71766-R, funded by the Spanish Ministry of Science, Innovation and Universities. ICM has also had funding support of the `Severo Ochoa Centre of Excellence' accreditation (CEX2019-000928-S), of the Spanish Research Agency (AEI).
17

A Refractions in streamer geometry

To calculate the minimum offset in the streamer at which the critical early refractions appear earlier than reflections, one needs to solve the inequality:

trefraction treflection,

(23)

where trefraction and treflection refers to the TWT from the seafloor, respectively. Following the notation used in the Fig.14:

trefraction

=

2 · S1 Vwater

+

O1 - 2 · p VEarth

+

L1 Vwater

,

(24)

Defining



as

the

treflection = incidence angle,

2 · S2 Vwater

+

L2 Vwater

.

u : sin() = Vwater/VEarth,

w

:

cos()

=

 1

(25) - u2,

and doing some algebra, eq. 23 transforms as:

u · O1 + 2 · d · w + L1

d2+

O1 2

2
+ L2,

(26)

where

d = d · cos ,

(27)

O1

=

Offset

·

cos



· (w w

-

u

·

tan

)

,

(28)

L1

=

Offset · w

sin



,

(29)

O2

=

2

·

d

2· +

d · cos  Offset · tan



,

(30)

L2

= Offset · sin  ·

1+

Offset

2

2 · d + Offset · tan  .

(31)

and  is the subfloor slope. Solving eq.26, the offset minimum at which refractions appear earlier than reflexions is:

OffsetSmtirneamer

=

u2

·

2 · d · u · (w (tan2  - 1) -

- u · tan 2·u·w·

) tan



+

1

.

(32)

For any type of marine setting, and eliminating the explicit dependence on Dr as:

Dr = Ds + Offset · tan  · Sign · [Dr - Ds],

(33)

The solutions for the minimum offset with refractions, depending on the marine setting

type is:



Ds · G()

if Ds < Dr, ( > 0)

OffsetSmtirneamer

=

Ds ·G()
D1+sG·(G)(·t0a)n 

if Ds > Dr, ( > 0) if Ds = Dr, ( = 0)

(34)

where

 

u2

2·u·(w-u·tan ) ·(tan2 -1)-2·u·w·tan

+1

G() =  2·u

w

if  > 0 if  = 0

(35)

18

B Refractions in OBS geometry

For the OBS geometry and following the notation of Fig.14, the TWT refraction and reflection arrivals are:

trefraction

=

S1 Vwater

+

Offset' - p VEarth

+

q

,

(36)

treflection

=

S2 Vwater

.

(37)

(38)

Defining

u

:

sin()

=

Vwater/VEarth

and

w

:

cos()

=

 1

-

u2,

and

doing

some

algebra, the equation to solve, taking into account Eq. 23, is:

d + u · (O^ · w - u · d ) w · d 2 + O^2

(39)

where

d = d · cos ,

(40)

O^ = Offset · cos  + d · sin .

(41)

(42)

The solution for the minimum offset with refractions in this specific configuration is:

OffsetOmBinS

=

d

·

u w

-

D tan ,

(43)

and the general solution at any marine setting, and taking into account Eq. 33, is:





Ds

·(

u w

-tan

1+tan2 

)

if Ds < Dr, ( > 0)

OffsetOmBinS = DDss1·(·+wuwtua+nt2an )

if Ds > Dr, ( > 0) if Ds = Dr, ( = 0)

(44)

References

[1] Arnulf, A. F., Singh, S. C., Harding, A. J., Kent, G. M., and Crawford, W. C.: Strong seismic heterogeneity in layer 2A near hydrothermal vents at the Mid-Atlantic Ridge, Geophys. Res. Lett., 38, L13320, https://doi.org/10.1029/2011GL047753, 2011.
[2] Barison, E., Brancatelli, G., Nicolich, R., Accaino, F., Giustiniani, M. and Tinivella, U.:Wave equation datuming applied to marine OBS data and to land high resolution seismic profiling, J. Appl. Geophys.,73, 267-277, https://doi.org/10.1016/j.jappgeo.2011.01.009, 2011.
[3] Berkhout, A. J.: Wavefield extrapolation techniques in seismic migration, a tutorial, Geophysics, 46, 1638­1656, https://doi.org/10.1190/1.1441172, 1981.

19

[4] Berkhout, A. J.: Pushing the limits of seismic imaging. Part I: prestack migration in terms of double dynamic focusing, Geophysics, Soc. Expl. Geophys., 62, 937­953, https://doi.org/10.1190/1.1444201, 1997a.
[5] Berkhout, A. J.: Pushing the limits of seismic imaging. Part II: integration of prestack migration, velocity estimation, and AVO analysis, Geophysics, Soc. Expl. Geophys., 62, 954­969, https://doi.org/10.1190/1.1444202, 1997b.
[6] Berryhill, J. R.: Wave-equation datuming, Geophysics, 44, 13291344, https://doi.org/10.1190/1.1441010, 1979.
[7] Berryhill, J. R.: Wave-equation datuming before stack, Geophysics, 49, 2064­2066, https://doi.org/10.1190/1.1441620, 1984.
[8] Bevc, D.: Flooding the topography: wave-equation datuming of land data with rugged acquisition topography, Geophysics, 62, 1558-1569, https://doi.org/10.1190/1.1885634, 1997.
[9] Booth-Rea, G., Ranero, C. R., Mart´inez-Mart´inez, J. M., and Grevemeyer, I.: Crustal types and Tertiary tectonic evolution of the Albora´n sea, western Mediterranean, Geochem. Geophys. Geosyst., 8, 1525­2027, https://doi.org/10.1029/2007GC001639, 2007.
[10] Booth-Rea, G., Ranero, C. R., and Grevemeyer, I.: The Alboran volcanic-arc modulated the Messinian faunal exchange and salinity crisis, Sci. Rep.-UK, 8, 13015, https://doi.org/10.1038/s41598-018-31307-7, 2018.
[11] Gras C., Dagnino D., Jime´nez-Tejero C.E., Mele´ndez A., Sallare`s V. and Ranero C.. Full-waveform inversion of short-offset, band-limited seismic data in the Alboran Basin (SE Iberia). Solid Earth, 10, 1833­1855, 2019 https://doi.org/10.5194/se-10-1833-2019.
[12] Gras C., Jime´nez-Tejero C.E., Sallare`s, V. Mele´ndez A., and Ranero C. Under revision.
[13] Cho, Y., Ha, W., Kim, Y., Shin, S., and Park, E.: Laplace-FourierDomain Full Waveform Inversion of Deep-Sea Seismic Data Acquired with Limited Offsets, Pure Appl. Geophys., 173, 749773, https://doi.org/10.1007/s00024-015-1125-7, 2016.
[14] Claerbout, J. F.: Fundamentals of Geophysical Data Processing, McGraw-Hill Inc., New York, 1976.
[15] Claerbout, J.F.: Imaging the Earth's Interior, Blackwell Scientific Publications, Oxford, 414pp, 1985.
[16] Gary S. Martin, Robert Wiley, Kurt J. Marfurt; Marmousi2 : An elastic upgrade for Marmousi. The Leading Edge 2006;; 25 (2): 156­166. doi: https://doi.org/10.1190/1.2172306.
[17] Gazdag, J.: Wave equation migration with the phase-shift method, Geophysics, 43, 13421351, https://doi.org/10.1190/1.1440899, 1978.
20

[18] Harding, A. J., Arnulf, A. F., and Blackman, D. K.: Velocity structure near IODP Hole U1309D, Atlantis Massif, from waveform inversion of streamer data and borehole measurements. Geochem. Geophys. Geosyst., 17, 1990­2014, https://doi.org/10.1002/2016GC006312, 2016.
[19] Harders, R., Ranero, C. R., Weinrebe, W., & Behrmann, J. H. (2011). Submarine slope failures along the convergent continental margin of the Middle America Trench. Geochemistry, Geophysics, Geosystems, 12(6).
[20] K.V. Mackenzie, Nine-term equation for the sound speed in the oceans (1981) J. Acoust. Soc. Am. 70(3), 807-812. https://doi.org/10.1121/1.386920.
[21] Marjanovic´, M., Fuji, N., Singh, S. C., Belahi, T., and Escart´in, J. (2017). Seismic signatures of hydrothermal pathways along the East Pacific Rise between 916' and 956'N. Journal of Geophysical Research: Solid Earth, 122, 10, 24110, 262. https://doi.org/10.1002/2017JB015004.
[22] McMechan, G. A.: Determination of source parameters by wavefield extrapolation, Geophys. J. Roy. Astr. S., 71, 613­628, https://doi.org/10.1111/j.1365246X.1982.tb02788.x, 1982.
[23] McMechan, G. A.: Migration by extrapolation of timedependent boundary values, Geophys. Prospect., 31, 413­420, https://doi.org/10.1111/j.13652478.1983.tb01060.x, 1983.
[24] Merino, Irene; Prada, Manel ; Ranero, Ce´sar R. ; Sallare`s, Valent´i ; Grevemeyer, Ingo; Calahorrano, Alcinoe ; Cameselle, Alejandra L. ; Neres, Marta. The seismic structure of the West Iberian continent-ocean transition.European Geosciences Union.EGU General Assembly (2020).
[25] Mo, L.: Datuming by wavefield extrapolation. Stanford Exploration Project, Report 75, 181-202: 1997.
[26] Mulder, W. A.: Rigorous redatuming, Geophys. J. Int., 161, 401-415, https://doi.org/10.1111/j.1365-246x.2005.02615.x, 2005.
[27] D. Pasalic and R. McGarry, "Convolutional perfectly matched layer for isotropic and anisotropic acoustic wave equations," in Proc. SEG Tech. Program Expanded Abstracts, 2010, pp. 2925­2929.
[28] Schuster, G. T. and Zhou, M.: A theoretical overview of modelbased and correlation-based redatuming methods, Geophysics, 71, SI103­SI110, https://doi.org/10.1190/1.2208967, 2006.
[29] Qin, Y., and Singh, S.C.: Detailed seismic velocity of the incoming subducting sediments in the 2004 great Sumatra earthquake rupture zone from full waveform inversion of long offset seismic data, American Geophysical Union, http://doi.org/10.1002/2016GL072175, 2017.
[30] Shtivelman, V., and Caning, A.: Datum correction by wave-equation extrapolation, Geophysics, 53, 10, 1311­1322, https://doi.org/10.1190/1.1442409, 1988.
[31] Tegtmeier, S., Gisolf, A. and Verschuur, D. J.: A data-mapping approach to 3-D wavefield redatuming. Geophys. J. Int., 172, 759-769, https://doi.org/10.1111/j.1365246x.2007.03675.x, 2008.
21

[32] Wapenaar, K., Thorbecke, J., van der Neut, J., Broggini, F., Slob, E., and Snieder, R.: Marchenko imaging, Geophysics, 79, WA39WA57, https://doi.org/10.1190/GEO2013-0302.1, 2014.
[33] Wapenaar, K. and Thorbecke, J.: Review paper: Virtual sources and their responses, Part I: time-reversal acoustics and seismic interferometry, Geophys. Prospect. EAGE, 1-19, httpd://doi.org/10.1111/1365-2478.12496, 2017.
[34] Yilmaz, O.: Seismic Data Analysis: Processing, Inversion, and Interpretation of Seismic Data (Investigations in Geophysics 10), ISBN 1-56080-094-1, Society of Exploration Geophysicists, 2001.
[35] W. Zhang and Y. Shen. Unsplit complex frequency-shifted PML implementation using auxiliary differential equations for seismic wave modeling. Geophysics, 75, 4, 141-154. https://doi.org/10.1190/1.3463431.
22

Redatuming of streamer field data
Figure 1: DC redatuming applied to field data recorded on TopoMed experiment ([9], [10]). For this experiment and location, the streamer length 6 km and the water depth is 1.6 km, respectively. Panel a) streamer shot gather. Panel b) the shot gather in panel a) redatumed to OBS acquisition geometry. Panel c) the shot gather in panel a) redatumed to the seafloor, or DC acquisition geometry.
23

Synthetic test: benchmark model with 1 layer
Offsetmin

Offsetmin Offsetmin

Offsetmax

Offsetmax

Figure 2: DC redatuming of a streamer shot gather to the seafloor using a synthetic

model with VEarth= 3 km/s and 2 km water depth. The dashed blue line indicate the minimum offset at which early refractions are registered as first arrivals in the streamer

(and OBS) configuration offset in the virtual OBS

and and

tDheCdraesdhaetdum2y4eedlloswhoatngdatrheedrsliwnehserpeoitnhteafitrtshtearmriavxailms uamre

truncated.

km
Figure 3: Minimum offset (see Eq. 14), at which the refractions are registered in a shot gather with streamer acquisition geometry, for a flat seafloor ( = 0). The x-axis displays the seafloor velocity in the benchmark models from 2 and 5 km/s and the y-axis the water column depth between 0.5 to 6 km.
25

Maximum offset in virtual DC shot gathers

Offsetmax(%)

km

km

km

100%

d)

75%

VEarth = 2 km/s

50%

VEarth = 2.5 km/s VEarth = 3 km/s

VEarth = 3.5 km/s

25%

VEarth = 4 km/s VEath = 4.5 km/s

VEarth = 5 km/s
00 1 2 3 4 5 6 7 8 9 10 11 12

n = SL / D

Figure 4: Maximum offset in virtual DC redatumed shot gathers, OffsetDmCax, where first arrivals are truncated. Upper panels: maximum offset for different streamer lengths

(SL) of a) 3 km, b) 6 km and c) 10 km. The x-axis displays the seafloor velocity in the

benchmarkk models from 2 to 5 km/s and the y-axis the water column depth from 0.5

to 6 km. Lower panel d: diagram which summarizes the three upper panels into one.

Here the maximum offset is expressed as a percentage (%) of the total length (y-axis)

depending on with the water

the rate column

dne=pthSDL(D(x).-aExviesr)y,

which compares the size of the line refers to an specific p-wave

streamer (SL) velocity of the

subsurface, VEarth.

26

a) Marmousi model

b) Vp-depth profile
0

Depth (km)

1

2

3

4 1,5 2 2,5 3 3,5 4 4,5 5

km/s

Vp (km/s)

Figure 5: a) Synthetic Marmousi model with a 1 km water column. The Marmousi model has been re-dimension for this test to the following proportions, 19 km length x 4 km depth. The black line located at around 12 km distance indicates de position at which we show the depth profile in panel b), which is also the position of the shot gather shown in Fig. 6. b) Velocity-depth profile at the specific location indicated in panel a) with a black arrow.

27

Synthetic test: Marmousi model
Offsetmax Offsetmax
Figure 6: Redatuming synthetic test using the Marmousi model shown in Fig. 5. Panel a) displays an streamer shot gather28generated at the location indicated with a black arrow in Fig. 5. Panel b1 and b2 show the shot gather generated in OBS geometry and the redatumed result of panel a) into OBS geometry, respectively. Similarly, panels c1 and c2 show the same as the panels above but for the DC geometry. The yellow dashed line in panel b2) indicate the maximum critical offset for the first arrivals before data are truncated in the virtual OBS geometry. The same for panel c2 but for the virtual DC geometry.

a1) TopoMed model

Profile TopoMed

Depth (km)

a2) Vp-depth profile TopoMed
0 1 2 3
1,5 2 2,5 3 3,5 4
Vp (km/s)

b1) Frame model

Profile Frame
Distance (km)

25 50 75 0
74 73 72 71
10
20

100 125 150 175 200 225 250 275 300 325 350 375 400 425 450

69 68 67 66 65 64 63 62 61 60

5

6.5

6

7

6.5

7.5

7

7.5

8

58 57 56 55 54
5 6

52 51 50 49 48 47 46 45

76

5

7.5

8

107 108 109 110

3

4

6

6

7 7.5

8

0

Depth (km)

b2) Vp-depth profile Frame
0 1 2 3 4 5 6 7
1,5 2 2,5 3 3,5 4 4,5
Vp (km/s)

10

Figure 7: Field data cases. Vp tomographic models obtained with travel-time tomog-

raphy for the experiments a1) TopoMed [11] and b1) Frame [24]. The black and red

20

arrows indicate the location of the depth-profile shown in panels a2 and b2.

25 50 75 100 125 150 175 200 225 250 275 300 325 350 375 400 425 450

Distance (km)

2345678 P-waves seismic velocity (km/s)

10-2 101 102 103 Derivative Weight Sum

Depth (km)

Depth (km)

29

Synthetic data: TopoMed

Field data: TopoMed

Offsetmax

Offsetmax

Offsetmax

Offsetmax

Figure 8: TopoMed case. Left side: similarly as in Fig. 6, it shows the redatuming synthetic test using the 1D depth profile from TopoMed model, shown in Fig. 7. Right side: redatuming of field data from TopoMed experiment; panel a) field data and panels b) and c) virtual redatumed results for to the OBS and DC geometries, respectively.
30

Synthetic data: Frame

Field data: Frame

Offsetmax

Offsetmax

Figure 9: Frame case. Left side: similarly as in Figs. 6 and 8, it shows the redatuming synthetic test using the 1D-depth profile from Frame model, shown in Fig. 7. Right side: redatuming of field data from Frame experiment; panel a) field data and panels b) and c) virtual redatumed results for to the OBS and DC geometries, respectively.
31

%
Figure 10: Error (%) of the critical minimum offset to register refractions depending on the p-wave velocity of the subsurface (x-axis) and the angle of the seafloor slope () (y-axis). The error formula is computed with eq. 22.
32

Depth (km)

a) Salinity
0 1 2 3 4

b) Temperature c) Water velocity

0

0

1

1

2

2

Average velocity

at each depth

3

3

4

4

34,5 35 35,5 36 36,5 0 5 10 15 20 1,5 1,52 1,54

S (ppt)

T (ºC)

Vwater (km/s)

Figure 11: An example of a) salinity, b) temperature and c) p-wave velocity of the water column. The data for the salinity and temperature are taken from XBT measurements at an specific location in the Atlantic ocean (3730'N,1230'W). The p-wave velocity (black line in panel c) is calculated using the Mackenzie empirical equation [20]. The dashed blue line in panel c) is the average velocity calculated with the velocity values from the sea surface till each specific depth.

33

Reflections

Reflections

Refractions

Refractions

seconds

Figure 12: Panels a) and b) show the TWT misfit for seafloor reflections, and panels c) and d) for seafloor refractions, both for  = 0. The panels on the left (a and c) compute the misfit between the 'true' water column shown in Fig. 11 and a homogeneous water column with Vwater = 1500 m/s. Similarly in the right panels (b and d) but using for the homogeneous water column the average value of velocity Vwater = 1511 m/s.

seconds

34

Figure 13: Synthetic test simulating vintage field data with a poor streamer acquisition geometry (dshots = 100 m, drec = 50 m) and using the Marmousi model (Fig. 5). Panel a) shows the virtual DC redatumed shot gather for the poor acquisition geometry, which evidence a very low signal to noise ratio. In panel b), the signal to noise ratio is clearly improved by interpolating the original streamer shot gathers to a narrower mesh before applying the DC-algorithm as (dshots = 50 m, drec = 12.5 m).

Source

Offset 



d'

S1

S2

Vwater
.

p

VEarth

O2/2

O1
Offset'
a) Streamer geometry

S2 O2/2

Receiver
L2 L1


D' D

S1



p
.

Source



d'

S1

Vwater
.

p

VEarth

b) OBS geometry

Offset 
S2
Offset'

Figure 14: Diagrams with the notation used in appendixes A and B for the calculation of the minimum offset with refractions recorded in a) streamer and b) OBS experiments, respectively. The parameters Vwater and VEarth are the water and subsurface p-wave velocities. The angle  refers to the critical incident refraction angle, and  to the angle of the seafloor slope. The source is indicated with a red star and the receiver with a black triangle.

35

.

D' D

OBS q

arXiv:2106.00646v2 [physics.geo-ph] 2 Jun 2021

Supplementary Material
1 DC tests with Benchmark models
In this analysis, we present the different synthetic tests using the Benchmark models. A total set of 84 models are generated varying the following parameters:
· Water column depth, D, from 0.5 to 6 km, every 0.5 km. · Constant subsurface p-wave velocity, VEarth, from 2 to 5 km/s, every 0.5 km/s. The common features are: · Flat seafloor surface. · Constant water p-wave velocity, Vwater = 1.5 km/s. To recreate realistic marine seismic acquisition experiments, we select three different cable lengths for the streamer in our tests; 3, 6 and 10 km. The advantage of using shorter streamers ( 3 km) is that they can be deployed in areas with possible obstacles, providing a good control over the data. Streamers of 6 km length are the most common ones and widely used in academy and industry research. Longer streamers of 10 km length, mostly used in industry nowadays, provide information from deeper areas of the subsurface but greatly increase the cost and experimental requirements. Concerning the main acquisition parameters, the simulation time is set to 10 seconds, the source is a ricker wavelet with central frequency of 10 Hz, the distance between sources is 50 m and between receivers is 25 m, and three different streamer lengths are tested: 3, 6 and 10 km. The figures S1, S2 and S3 show the virtual redatumed shotgathers to DC geometry depending on the streamer length (SL), the water column depth (D) and seafloor p-wave velocity (VEarth), respectively. For space and clarity reasons, the results for the real and virtual OBS configurations are omitted in these figures. First and second columns show the shotgather directly simulated with streamer and DC geometry, and the third column the virtually redatumed shotgather from column 1 into DC geometry, respectively. In Fig. S1, the parameters are set to D = 2 km and VEarth = 3 km/s and SL at each row is 3, 6 and 10 km. As expected, the longer the streamer, the longer the offset with refractions registered. In Fig. S2 the fixed parameters are SL = 6 km and VEarth = 3 km/s and D at each row is 1, 2 and 3 km, showing a inversely proportional decrease of refractions with the increasing depth. Finally in Fig. S3, the fixed parameters are SL = 6 km and D = 2 km/s, with VEarth varying at each row with 2, 3 and 4 km/s. In this case, the higher the velocity of the subsurface, the more refractions registered.
1

2 Two-layer models: reflections and secondary refractions

Benchmark models with 2-subsurface layers helps to better understand not only the redatuming of reflections but also how the refractions from deeper layers transform into first arrivals. We use a similar synthetic model as the one used in Fig. 2 from the manuscript, but adding a second layer, i.e. a model with water depth of 2 km followed by a first subfloor layer of V1 = 3 km/s till 3 km depth and followed by a second layer defined with V2 = 5 km/s. The streamer length is 6 km. The redatuming results for the 2-layer model are displayed in Fig. S4.
To determine the minimum offset for refractions in this configuration, the geometric problem described in the appendix included in the manuscript should be recalculated, but taking into account the refractions coming from the second layer. In any case, the minimum offset will generally be achieved by the seafloor refractions, since to record first the refractions from deeper layers, they should be very close to the seafloor and defined with a higher velocity value compared to the shallow sub-seafloor velocity. This means that also the maximum offset for the virtual DC geometry is limited in the same way as in the 1-layer type of models (see Figs. S1, S2 and S3).
If the depth of the second subsurface layer is known, it can be calculated the minimum offset where refractions appear earlier than the reflections in the DC geometry, adapting the formula for the minimum refraction offset in streamer geometry:

OffsetDmCin2

=

2 · D^ · u , 1 - u2

(1)

where D^ = (D2 - D1) is the inter-reflector distance and u = V1/V2, with V1 and V2 the velocities of the first and second subsurface layers, respectively. For the given model

parameters line. From

tthheisrepsouilnttisonOwffasredtsDm,Cint2h=e

1.5 km, indicated in refractions from the

the figure with a white dotted second layer might overpass

the seafloor refractions and become first arrivals. This can be observed around 3.5 km

offset, from where the slope of the first arrivals changes from 3 km/s to 5 km/s. Besides,

aonndceOOBffSs)e.tDmGCini2veisnctahlcaut ltahteedm, iitniismeuamsy

to infer it for the rest of the geometries offset for seafloor refractions in DC

(streamer geometry

iosffzseertos,foOrftfhseetsDmeCina2flcoooirnacniddefsowr tihthe

the inter-distance between the second layer for any geometry.

minimum

refraction

Also, it is noticeable that the maximum offset in the virtual geometries appears ex-

tended at least 0.5 km beyond the predicted value. Most of the times, this extra length

is picked as real first arrivals, as the phase seems to extrapolate well aligned with the

real refractions and also the amplitudes keep their values quite well. This could be

considered as a positive secondary effect, depending on the subsurface characteristics.

However, the reliable maximum offset should only be extended over the physical lim-

its when the Vp characteristics of the subsurface model are reasonably well known. Picking beyond the predicted offset could produce artifacts in the velocity model, in-

troducing velocities higher than the actual value.

Concerning the reflections, which are always recorded from zero offset, their trans-

formation into virtual geometries is suitable whenever they had previously been recorded

in the entire streamer length. In the example of Fig. S4, the reflections from the second

layer are fully recovered up to the maximum offset, OffsetDmCax.

2

Synthetic test I. Varying streamer length: 3 km, 6 km and 10 km
Offsetmax

Offsetmin

Offsetmax

Offsetmin

Offsetmax

Offsetmin
Figure S1: DC redatuming of a streamer shotgather to the seafloor using a synthetic model with VEarth= 3 km/s and 2 km water depth. Every row refers to a different streamer length with the value of 3, 6 and 10 km, respectively. The first and second columns show the simulated shotgather with streamer and DC geometry, respectively. The third column shows the results for the virtual redatumed shotgather after applying the DC-algorithm. The dashed blue line indicate the minimum offset at which early refractions are registered in the streamer configuration (first column, panels a, d, g) and the dashed red line points at the maximum offset in the virtual DC redatumed shotgather where the first arrivals are truncated (third column, panels c, f, i).

3

Synthetic test II. Varying depth: 1 km, 2 km and 3 km
Offsetmax

Offsetmin

Offsetmax

Offsetmin

Offsetmax

Offsetmin
Figure S2: Similarly to the test shown in Fig. S1 but in this test, the fixed parameters are VEarth = 3 km/s and SL = 6 km. Here, the seafloor depth is the parameter changing at each row with the value of 1, 2 and 3 km, respectively.

4

Synthetic test III. Varying VEarth: 2 km/s, 3 km/s and 4 km/s
Offsetmax

Offsetmin

Offsetmax

Offsetmin

Offsetmax

Offsetmin
Figure S3: Similarly to the test shown in Fig. S1 and S2 but in this test, the fixed parameters are 2 km/s water depth and SL = 6 km. Here, the subsurface velocity, VEarth is the parameter changing at each row with the value of 2, 3 and 4 km/s respectively.

5

Synthetic test: benchmark model with 2 layers
Offsetmin

Offsetmin2

Offsetmax

Offsetmin Offsetmin

Offsetmin2

Offsetmin2

Offsetmax

Offsetmin2

Offsetmin2

Figure S4: Similarly to the test shown in Fig. S1 but in this test, there is a second subsurface layer starting at 3 km depth from the sea surface (or 1 km depth from the seafloor) with VEarth = 5 km/s. In this case, the added dotted white lines indicate the minimum offset at which refractions from the second layer of the model are registered in the streamer.
6

