arXiv:2106.01445v1 [quant-ph] 2 Jun 2021

Cracking the Quantum Advantage threshold for Gaussian Boson Sampling
A. S. Popova1 & A.N. Rubtsov1,2
1Russian Quantum Center, Bolshoy Bulvar 30, bld. 1, Skolkovo, Moscow 121205, Russia 2Department of Physics, Lomonosov Moscow State University, Leninskie gory 1, Moscow 119991, Russia
Quantum advantage, defined as a computational result unattainable with classical computers, is a major goal of scientists currently developing quantum technologies. Recently, quantum advantage was claimed for a Gaussian boson sampling setup in which N = 50 squeezed states of light pass through a linear optical network. The emulation of many-body statistics of identical photons in this system is seen as a computationally hard problem: the number of elementary operations grows exponentially with N . Thus, reproducing the experimentally observed counting statistics of the output detectors is believed to be far beyond capabilities of any classical computer. Here we challenge this statement by introducing a series of approximations for the probability of any specific measurement outcome, obeying a polynomial complexity. Our fourth order approximation gives an accuracy comparable with that of the experimental set-up and can be calculated using a laptop computer.
Quantum computing devices process information in a way very different from and not achievable by classical machines. Impressive results of calculations with the quantum processors have been already demonstrated with superconducting qubits 1,2, trapped ions 3,4, neutral atoms 5,6 and
1

photonic hardware 7,8. One of the most important concepts in the field is so-called boson sampling problem. In general, boson sampler is a quantum optical set-up in which many non-classical sources are mixed by a linear optical network, as depicted in Figure 1. The indistinguishability of the photons from the different sources leads to a complex photon counting statistics of the output detectors. When the number of the input/output channels of boson sampler is large, the emulation of such device with a classical computer is believed to be #P-hard 9,10. Here the notion of quantum advantage is introduced, which is defined as a regime which is out of reach for any classical simulator. At the current level of quantum technology, the mainstream efforts are concentrated more on demonstration of its future potential rather than on the immediate practical applications. At this stage, there is no preferred choice for the set-up parameters; for example, the interferometer matrix can be considered a random unitary one. In this respect, boson sampling can be seen as a counterpart to a random quantum circuit of qubit system. After the quantum advantage is established, one should look for a some practical task that can be mapped to boson sampling problem. This, in turn, will require construction of the device with the particular parameters defined by that problem. Several promising applications of boson sampling have already been proposed, in particular, calculating the vibronic spectrum of a molecule 11,12, molecular docking 13, statistical modelling 14, counting the number of perfect matchings in a graph 15 and machine learning 16,17.
In the original formulation, boson sampler was introduced as a device equipped with the single-photon sources at the input of a linear interferometer and photon-counting detectors at the output channels. This was implemented in a number of experiments, in particular, the integrated 21-mode optical circuit with 5 input photons 18 and the set-up with 20 input photons in 60-mode
2

nonclassical light

output detectors

interferometer

Figure 1: Boson sampling model: nonclassical light states transferring through a linear interferometer are measured with output detectors. interferometer 19. The fastest known classical algorithm 20 requires time roughly proportional to 2k, where k is the number of the photons in the scheme. This puts the quantum advantage threshold to k  50, still remarkably higher then the best experimental achievement.

To escape the complications using the single-photon sources, Gaussian boson sampling

(GBS) scheme was proposed 21. In this architecture, the input states are the single-mode squeezed

light generated by parametric down-conversion sources. After passing a linear interferometer, the

output state is described by the wave function that, up to a normalization factor, equal (see Methods

section)

|X = e- |0 , jj Xjj aj aj

where aj is the creation operator for the jth output channel, |0 is the vacuum state, and Xjj is

3

a complex-valued symmetric matrix determined by the parameters of the interferometer and light sources. Despite this formally simple wave function, it is believed to be exponentially hard to find its projection to a state with a definite number of photons in each channel.
In the recent paper 22, the realization of the GBS set-up with a 100-mode interferometer was reported. A half of the input channels was irradiated by the squeezed light states with the squeezing parameter 23 up to r = 1.84 (Figure 1(B) in Ref. 22). The output light was registered with the threshold detectors, so the scheme detects only one of the photons passed to an output channel. The number of experimentally detected photons n fluctuated within the range from 10 to 76 in each measurement. The probability distribution of the measurement outcomes appeared to be very different from what would be observed for the classical light sources in the input channels. In the classical emulation of a bosonic sampler, one needs to calculate the probability of the individual measurement outcomes. It requires calculation of the so-called Torontian for the n-rank matrix. An estimated calculation time for one of the world-best supercomputers Sunway TaihuLight is 2 days per single n = 50 matrix and grows with n exponentially 22. Certain acceleration can be achieved than emulating a lossy device 24 but still an exponential effort is required if the photon losses at each interferometer are small enough. This allows to see n  50 as the quantum advantage threshold for the GBS devices. Consequently, authors of 22 claimed the quantum advantage of their set-up.
In this paper, we develop an alternative method of the classical emulation of the GBS devices. Instead of numerically exact calculation of the outcome probabilities, we introduce a series of approximations, each one having a polynomial complexity. Conceptually, we treat the GBS em-
4

ulation as a reversed problem of statistical physics. Relative probabilities of different realizations of a classical statistical ensemble are easy to obtain from the Gibbs distribution, whereas calculation of the statistical averages can be complicated. In contrast, it turns out that averages over the ensemble of the GBS measurement outcomes, such as the average number of the detected photons n¯, are easy to obtain (that is, it can be exactly calculated with a polynomial operation count). We use this information about averages to estimate the probabilities of the individual outcomes.
We start our analysis with the probability p(n) that photons have been detected in n of N channels. This is one of the key experimental observables, see Figure 3(C) in Ref. 22. In Figure 2 we show p(N ) calculated using a numerically exact procedure for a model set-up with the 30mode interferometer. This moderate-size system still allows for a numerically exact computing which is used later to benchmark our approach. The input was 15 squeezed states with squeezed parameter  = 1.4 each, and the interferometer matrix was a randomly chosen unitary one. With these parameters, the dependence of p(N ) is qualitatively similar to what was observed in the experiment 22. For the scheme with the threshold detectors, it is not possible to determine the exact number of photons emitted by the sources at each measurement. Nevertheless, the observable n commutes with the total photon number operator. Therefore, in the theoretical description, p(n) can be presented as a sum over the sectors with respect to the always-even total number of the photons k: p(n) = k pk(n). The dependencies pk(n) on some values of k are shown in Figure 2. The larger k is, the more probable outcomes with larger n are. Consequently, maxima of pk(n) shift to the right for the sectors with larger k.
5

p

10-1 10-2 10-3 10-4 10-5 10-6
0

50

20

80

110

140

170

5

10

15

20

25

30

n

Figure 2: The total probability p(n) to detect photons in n channels of the 30-mode interferometer with 15 input SMSV states (solid line) and the contributions pk(n) to p(n) from some of the ksectors (dashed lines), where k is a number of photons injected into the scheme. The data for k = 20, 50, 80, 110, 140, and k = 170 are shown.

6

The point n = N in the dependencies pk(n) is special: it corresponds to a single possible measurement outcome, when all detectors clicked. So that

pk(N ) =

Xk|1,2...N |Xk X |X

,

where 1,2,...,N is a projector to the subspace in which photons are present in all modes 1, 2, ..., N , and |Xk is the projection of |X to the sector k. We will see later that having a method to estimate this probability one can also estimate a probability of any other possible outcome. We provide an approximate procedure based on the momentum expansion for the pk(n) in each sector.

Our approach is based on two observations. First, the dependencies pk(n) are regular in the sense that each of them can be approximated with a smooth curve described by a few parameters. Second, the low-order momenta n njpk(n) can be calculated with a polynomial complexity. In the Methods section, we outline a way to calculate the set of moments up to j = 4 using  N 5 operations. Each next order in j requires an extra power of N . These observations suggest the existence of some approximate expression p~k(n), which requires that moments calculated for this approximation match their true values. In general, this inverse moment problem is known to be ill-posed 25. However, our particular situation is greatly simplified by the fact that the function pk(n) has a clear single-peak form. The inverse moment problem is better defined when photon probability distribution is restored in the vicinity of its single maximum. We also note that a such procedure is better justified when working with separate k-sectors, as we do. Indeed, the point n = N , we are interested in, is mostly contributed by the sectors with large k, for which maxima in pk(n) are shifted closer to this point.

7

In our calculations we put p~k(n) = e-rk(n), where r(n) is a polynomial. To make the problem well-defined, the moments of p~ are calculated over the range nkmin < n  N , where the cutoff nkmin is placed well below the maximum of pk(n). This allowed us to construct an iterative scheme which converges to the desired rk(n), so that the coefficients of this polynomial are adjusted to deliver known values of the moments. The order of the polynomial rk(n) equals the number of known moments.

The results obtained for the N = 30 benchmark system are shown in Figure 3. The left panel shows the numerically exact data for the k = 110 sector compared with our solution of the inverse moments problem. The approximate solution reproduces the reference data well, and an accuracy increases with the number of moments taken into account. This picture appeared to be very similar also in other sectors. We extracted the result for the n = N point from all the sectors. The probabilities in the last point pk(N ) are plotted in the right panel of the Figure 3. It can thus be seen that the behaviour of the reference data is well reproduced and the accuracy increases with the number of accounted moments. Finally, we take a sum over k-sectors, p(N ) = k pk(N ). For the data presented in Figure 3, the 2nd-, 3rd-, and 4th-order approximations for p(N ) deviate from the reference value by respectively 77%, 49%, and 28%.

Let us now turn to the case of a generic measurement outcome, when photons are detected in some channels labelled j1...jN and not detected in other ones. As explained in the Methods section, the corresponding probability is given by the the expression

X |j1...jN |X X |X

,

8

p p

a) 10-3
10-4

b)
10-6

exact

10-5

approximations:

2nd order

10-6

3rd order

4th order

18

20

22

24

26

28

30

n

10-7
10-8 60

exact

approximations: 2nd order 3rd order 4th order

100

140

180

220

k

Figure 3: a) The contributions pk(n) to the total distribution p(n) of k = 110 photons in the 30-mode GBS set-up; b) Comparison of the approximations with the various number of moments for the last N = 30 point probability (i.e. for the case when photons come into all detectors). where |X = e- j,j =j1...jN |0 Xjj ajaj . One can see that the structure of the expressions remains the same as it was when calculating p(N ). The only difference is that the matrix Xjj in the numerator is now replaced with its submatrix built from the rows and columns j1...jN . Therefore our approach described previously is directly applicable. Given certain measurement outcome, we solve the inverse moments problem in each sector, and estimate the probability that photons have been detected in all N desired channels.

To understand how our scheme performs in general, we randomly generated  102 measurement outcomes for our benchmark N = 30 system with photons detected in N = 10, 15, and 20 channels. As well, we generated other 10 N = 30 systems with different interferometer matrices and estimated the probability pn=N for each of them. In all cases, behaviour of the exact data and the approximations was similar to the results considered above. For the statistical analysis, we calculated a relative deviation of the approximate data from the exact result for each outcome, and
9

p

0.8

2nd order

0.7

3rd order

0.6

4th order

0.5

0.4

0.3

0.2

0.1

0.0 0

5

10

15

20

25

30

N

Figure 4: The relative deviation p between the exact value of p(n) and an estimated one as a function of the number of detected photons N ; bars show the standard deviation of the approximate results. Solid lines are to guide the eye. Dashed line is a linear interpolation of the data for the 4th order scheme.

10

calculated its average and variance for each N . The results are shown in Figure 4. As one can observe, the relative deviation grows approximately linearly with N . This suggests that our 4th order scheme can emulate the N = 100 device with an accuracy of about 50%, quite comparable to what is realized experimentally. Furthermore, variances shown in Figure 4 are relatively small. This signals that our description behaves uniformly well; no estimated probability fell far apart its exact value. We also did not observe any particular "heavy" 22 outcomes for which our method would show an anomalously large deviation from the reference data.
Finally, let us recall the main properties of GBS that allowed for us a successful emulation. This is, first, the exact polynomial formulas for the moments p(n) and, second, a regular singlepeak shape of this dependence that enables us to solve the inverse moment problem. While the moments can be calculated for a fully arbitrary GBS state, there might be special cases when the series based on the inverse moment problem does not converge. Nevertheless, we have empirically established a good convergence observed for a typical GBS set-up with a random interferometer matrix and threshold detectors. Keeping in mind imperfections of the up-to-day experimental realizations, we consider our 4-th order method as been fully sufficient to claim emulation of the existing GBS devices at their level of accuracy.

Methods

Here we show how the averages for the GBS set-up with threshold detectors can be obtained

within a polynomial time. The single-mode Gaussian state is described by the wave function



|x = e-xaa |0 =

l

(-x)l l!

(2l)! |2l

in the Fock basis, which is also called single-mode squeezed

11

vacuum state 23. We work with the non-normalized expressions; summing the series up yields

x|x =

l

|x|2l(2l)! (l!)2

=

1 . 1-4|x|2

The

multimode

Gaussian

state

is

defined

as

|X

= e-Xjj aj aj |0 ,

where X is a symmetrical complex-valued matrix and j, j - the number of mode. For the Gaussian

state at the output of the GBS device, Xjj = i UijUij xi, where Uij is the unitary matrix of the interferometer, and xi characterize the input single-mode states. In what follows the important role

is played by the norm of the multimode Gaussian state. It equals to

ZX  X|X =

1

,

det(1 - 4XX)

where X is a conjugate of the matrix X. This formula can be established by considering the basis

where the matrix X is diagonal.

The value of ZX can be presented as a sum over the sectors with different number of photons in the system: ZXk = X|( j ajaj - k)|X . We expand the Kronecker symbol  in the Fourier series and obtain ZXk = ZX e-ikd with ZX = X|ei |X j ajaj . In practice, we introduce an upper cutoff for k, so that ZXk becomes a sum over the discrete set of . The values of ZX can be obtained similarly to ZX, by performing the Taylor expansion of the operator exponents in the basis where X is diagonal. It gives

ZX =

1

.

det(1 - 4eiXX)

While studying GBS with the threshold detectors, one can consider the measurement outcomes

as certain Grand-canonical statistical ensemble. Then ZXk is a partition function of this ensemble

which to the sum of the weights of all possible measurement outcomes.

Let's consider now the sub-ensemble in which the photons are definitely not detected in 12

some channels, whereas the state of other channels labelled j1...jN can be arbitrary. The state |X can be projected to the corresponding subspace by putting to zero the creation operators a¯j with ¯j = j1...jN . The projected state |X is therefore a Gaussian state in which the matrix Xjj is replaced by its submatrix Xjj with j, j = j1...jN . The partition function of the sub-ensemble is ZXk , and the probability to observe a state belonging to the sub-ensemble is ZXk /ZXk .

This technique also allows getting the average number of counts over the entire system or

any sub-ensemble. Let's consider, for example, the states for which photons are definitely present

in

the

¯jth

channel.

The

partition

function

of

the

corresponding

sub-ensemble

is

ZXk

-

Zk X¯j

,

and

the

average

number

of

counts

in

the

¯jth

channel

is

therefore

1

-

Zk X¯j

/ZXk

.

Consequently,

the

average

number of counts in all N channels is N -

¯j

Zk X¯j

/ZXk

.

The

second-

and

higher-order

correlators

can be expressed in exactly the same way. It is worth mentioned calculation of moments required

us finding determinants of multiple similar matrices. Use of the Sherman-Morrison formula 26

allowed us to accelerate the procedure and to obtain ZXk together with the 4th- and lower-order correlators in all k-sectors using  N 5 operations.

1. Arute, F. et al. Quantum supremacy using a programmable superconducting processor. Nature 574, 505­510 (2019).
2. Kjaergaard, M. et al. Superconducting qubits: Current state of play. Annual Review of Condensed Matter Physics 11, 369­395 (2020).
3. Zhang, J. et al. Observation of a many-body dynamical phase transition with a 53-qubit quantum simulator. Nature 551, 601­604 (2017). 13

4. Bruzewicz, C. D., Chiaverini, J., McConnell, R. & Sage, J. M. Trapped-ion quantum computing: Progress and challenges. Applied Physics Reviews 6, 021314 (2019).
5. Bernien, H. et al. Probing many-body dynamics on a 51-atom quantum simulator. Nature 551, 579­584 (2017).
6. Henriet, L. et al. Quantum computing with neutral atoms. Quantum 4, 327 (2020). 7. Qiang, X. et al. Implementing graph-theoretic quantum algorithms on a silicon photonic
quantum walk processor. Science Advances 7, eabb8375 (2021). 8. Arrazola, J. et al. Quantum circuits with many photons on a programmable nanophotonic chip.
Nature 591, 54­60 (2021). 9. Aaronson, S. & Arkhipov, A. The computational complexity of linear optics. In Proceedings
of the forty-third annual ACM symposium on Theory of computing, 333­342 (2011). 10. Wu, B. et al. Speedup in classical simulation of gaussian boson sampling. Science Bulletin
65, 832­841 (2020). 11. Huh, J., Guerreschi, G. G., Peropadre, B., McClean, J. R. & Aspuru-Guzik, A. Boson sampling
for molecular vibronic spectra. Nature Photonics 9, 615­620 (2015). 12. Huh, J. & Yung, M.-H. Vibronic boson sampling: generalized gaussian boson sampling for
molecular vibronic spectra at finite temperature. Scientific reports 7, 1­10 (2017). 13. Banchi, L., Fingerhuth, M., Babej, T., Ing, C. & Arrazola, J. M. Molecular docking with
gaussian boson sampling. Science advances 6, eaax1950 (2020). 14

14. Jahangiri, S., Arrazola, J. M., Quesada, N. & Killoran, N. Point processes with gaussian boson sampling. Physical Review E 101, 022134 (2020).
15. Bra´dler, K., Dallaire-Demers, P.-L., Rebentrost, P., Su, D. & Weedbrook, C. Gaussian boson sampling for perfect matchings of arbitrary graphs. Physical Review A 98, 032310 (2018).
16. Schuld, M., Bra´dler, K., Israel, R., Su, D. & Gupt, B. Measuring the similarity of graphs with a gaussian boson sampler. Physical Review A 101, 032314 (2020).
17. Banchi, L., Quesada, N. & Arrazola, J. M. Training gaussian boson sampling distributions. Physical Review A 102, 012417 (2020).
18. Carolan, J. et al. On the experimental verification of quantum complexity in linear optics. Nature Photonics 8, 621­626 (2014).
19. Wang, H. et al. Boson sampling with 20 input photons and a 60-mode interferometer in a 1 0 14-dimensional hilbert space. Physical review letters 123, 250503 (2019).
20. Clifford, P. & Clifford, R. The classical complexity of boson sampling. In Proceedings of the Twenty-Ninth Annual ACM-SIAM Symposium on Discrete Algorithms, 146­155 (SIAM, 2018).
21. Hamilton, C. S. et al. Gaussian boson sampling. Physical review letters 119, 170501 (2017). 22. Zhong, H.-S. et al. Quantum computational advantage using photons. Science 370, 1460­1463
(2020). 23. Walls, D. F. & Milburn, G. J. Quantum optics (Springer Science & Business Media, 2007).
15

24. Oh, C., Noh, K., Fefferman, B. & Jiang, L. Classical simulation of lossy boson sampling using matrix product operators. arXiv preprint arXiv:2101.11234 (2021).
25. John, V., Angelov, I., O¨ ncu¨l, A. & The´venin, D. Techniques for the reconstruction of a distribution from a finite number of its moments. Chemical Engineering Science 62, 2890­2904 (2007).
26. Sherman, J. & Morrison, W. J. Adjustment of an inverse matrix corresponding to a change in one element of a given matrix. The Annals of Mathematical Statistics 21, 124­127 (1950).
Acknowledgements The work was carried out in the framework of the Russian Quantum Technologies Roadmap. Correspondence Correspondence and requests for materials should be addressed to Anastasia Popova (email: a.popova@rqc.ru).
16

