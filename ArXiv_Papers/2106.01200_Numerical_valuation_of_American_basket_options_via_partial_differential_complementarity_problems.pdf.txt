arXiv:2106.01200v1 [math.NA] 2 Jun 2021

Numerical valuation of American basket options via partial differential complementarity problems
Karel J. in 't Hout  and Jacob Snoeijer 
June 3, 2021
Abstract We study the principal component analysis based approach introduced by Reisinger & Wittum [1] and the comonotonic approach considered by Hanbali & Linders [2] for the approximation of American basket option values via multidimensional partial differential complementarity problems (PDCPs). Both approximation approaches require the solution of just a limited number of low-dimensional PDCPs. It is demonstrated by ample numerical experiments that they define approximations that lie close to each other. Next, an efficient discretisation of the pertinent PDCPs is presented that leads to a favourable convergence behaviour.
Key words: American basket option, partial differential complementarity problem, principal component analysis, comonotonicity, discretisation, convergence.
1 Introduction
This paper deals with the valuation of American-style basket options. Basket options constitute a popular type of financial derivatives and possess a payoff depending on a weighted average of different assets. In general, exact valuation formulas for such options are not available in the literature in semi-closed analytic form. Therefore, the development and analysis of efficient approximation methods for their fair values is of much importance.
In this paper we consider the valuation of American basket options through partial differential complementarity problems (PDCPs). If d denotes the number of different assets in the basket, then the pertinent PDCP is d-dimensional. In this paper, we are interested in the situation where d is medium or large, say d  5. It is well-known that this renders the application of standard discretisation methods for PDCPs impractical, due to the curse of dimensionality. For European- and Bermudan-style basket options, leading to high-dimensional partial differential equations (PDEs), an effective approach has been introduced by Reisinger & Wittum [1] and next studied in e.g. Reisinger & Wissmann [3, 4, 5] and In 't Hout & Snoeijer [6]. This approach is based on a principal component analysis (PCA) and yields an approximation formula for the value of the basket option that requires the solution of a limited number of only low-dimensional PDEs. In the literature, an alternative useful approach has been investigated that employs the idea of comonotonicity. For European basket options, this comonotonic approach has been developed notably by Kaas et al. [7], Dhaene et al. [8, 9], Deelstra et al. [10, 11] and Chen et al. [12, 13]. Recently, an extension to American basket options has been presented by Hanbali & Linders [2], who consider a comonotonic approximation formula that requires the solution of just two one-dimensional PDCPs. In the present paper we shall study and compare the PCA-based and comonotonic approaches for the effective valuation of American basket options. To our knowledge, this is the first paper where these two, different but related, approaches are jointly investigated. In our subsequent analysis, we shall include also the (simpler) case of European basket options.
Department of Mathematics, University of Antwerp, Middelheimlaan 1, B-2020 Antwerp, Belgium. Email: {karel.inthout,jacob.snoeijer}@uantwerpen.be.
1

A European-style basket option is a financial contract that gives the holder the right to buy

or sell a prescribed weighted average of d assets at a prescribed maturity date T for a prescribed

strike price K. We assume in this paper the well-known Black­Scholes model. Thus the asset

prices Si (i " 1, 2, . . . , d) evolve according to a multidimensional geometric Brownian motion, which is given (under the risk-neutral measure) by the system of stochastic differential equations

(SDEs)

dSi " rSi d ` iSi dWi p0    T, 1  i  dq.

(1.1)

Here  is time, with  " 0 representing the time of inception of the option, r  0 is the given risk-free interest rate, i  0 (i " 1, 2, . . . , d) are the given volatilities and Wi (i " 1, 2, . . . , d) is a multidimensional standard Brownian motion with given correlation matrix pij qdi,j"1. Further, the initial asset prices S0i  0 (i " 1, 2, . . . , d) are given. In essentially all financial applications, the correlation matrix is full.
Let ups, tq " ups1, s2, . . . , sd, tq be the fair value of a European basket option if at time till maturity t " T ´  the i-th asset price equals si (i " 1, 2, . . . , d). Financial mathematics theory
yields that u satisfies the d-dimensional time-dependent PDE

Bu Bt

ps,

tq

"

Aups, tq

:"

1 2

ÿd ÿd ij ij sisj
i"1 j"1

B2u BsiBsj

ps, tq

`

ÿd Bu i"1 rsi Bsi

ps, tq

´

rups, tq

(1.2)

whenever ps, tq P p0, 8qd ^ p0, T s. The PDE (1.2) is also satisfied if si " 0 for any given i, thus at

the boundary of the spatial domain. At maturity time of the option its fair value is known and

specified by the particular option contract. If  is the given payoff function of the option, then

one has the initial condition

ups, 0q " psq

(1.3)

whenever s P p0, 8qd. An American-style basket option is a financial contract that gives the holder the right to buy
or sell a prescribed weighted average of d assets for a prescribed strike price K at any given single time up to and including a prescribed maturity time T . The fair value function u of an American basket option satisfies the (nonlinear) d-dimensional time-dependent PDCP

ups, tq  psq,

(1.4a)

Bu Bt

ps,

tq



Aups,

tq,

^



pups, tq ´ psqq

Bu Bt

ps,

tq

´

Aups,

tq

"0

(1.4b) (1.4c)

whenever ps, tq P p0, 8qd ^ p0, T s. The PDCP (1.4) is provided with the same initial condition

(1.3). Further, (1.4) also holds if si " 0 for any given i.

In this paper we shall consider the class of basket put options. These have a payoff function

given by

~

¸

ÿd

psq " max K ´ isi , 0

(1.5)

i"1

with

prescribed

weights

i



0

(i

"

1, 2,

.

.

.,

d)

such

that

d
i"1

i

"

1.

An outline of our paper is as follows.

Following Reisinger & Wittum [1], in Section 2.1 a convenient coordinate transformation is

applied to the PDE (1.2) for European basket options by means of a spectral decomposition of the

covariance matrix. This way, a d-dimensional time-dependent PDE for a transformed option value

function is obtained in which each coefficient is directly proportional to one of the eigenvalues.

In Section 2.2 this feature is exploited to derive a principal component analysis (PCA) based

approximation. The key property of this approximation is that it is determined by just a limited

2

number of one- and two-dimensional PDEs. The presentation in Sections 2.1 and 2.2 follows largely that in [6]. In Section 2.3, the PCA-based approximation approach is extended to American basket options. This gives rise to an approximation that is defined by a limited number of one- and twodimensional PDCPs. In Section 3.1, an efficient discretisation of the one- and two-dimensional PDEs for European basket options is described, which employs finite differences on a nonuniform spatial grid followed by the Brian and Douglas alternating direction implicit (ADI) scheme on a uniform temporal grid. This discretisation is adapted in Section 3.2 to the pertinent PDCPs for American basket options, where the basic explicit payoff (EP) approach as well as the more advanced Ikonen­Toivanen (IT) splitting technique are considered. Section 4 collects results from the literature on the comonotonic approach for valuing European and American basket options. We consider the same comonotonic approximation as Hanbali & Linders [2], which is determined by just two one-dimensional PDEs (for the European basket) or PDCPs (for the American basket). Section 5 contains the main contribution of our paper. In this section we perform ample numerical experiments and obtain the positive result that the PCA-based and comonotonic approaches yield approximations to the option value that always lie close to each other for both European and American basket put options. We next study in detail the error in the discretisation described in Section 3 for the PCA-based and comonotonic approximations and observe a favourable, near second-order convergence behaviour. The final Section 6 presents our conclusions and outlook.

2 PCA approximation approach

2.1 Coordinate transformation

In this preliminary section we apply two subsequent coordinate transformations to the PDE (1.2)

for a European basket option. We assume here that the elementary functions ln, exp, tan, arctan

are taken componentwise whenever their argument is a vector.

The covariance matrix  " pijq P Rd^d is given by ij " iijj for i, j " 1, 2, . . . , d. Let
 " diagp1, 2, . . . , dq denote a real diagonal matrix of eigenvalues of  and Q a real orthogonal matrix of eigenvectors of  such that  " QQT. Then, following [1], we apply the coordinate

transformation

xps, tq " QT plnps{Kq ´ bptqq ,

(2.1)

where

bptq

" pb1ptq, b2ptq, . . . , bdptqqT

with

biptq "

p

1 2

i2

´

rqt

for

1

i



d.

Let

the

function

v

be

defined by

ups, tq " vpxps, tq, tq.

An easy calculation yields that v satisfies

Bv Bt

px,

tq

"

1 2

ÿd
k"1

k

B2v Bx2k

px,

tq

´

rvpx, tq

(2.2)

whenever x P Rd, t P p0, T s. Clearly, (2.2) is a pure diffusion equation, without mixed derivative
terms, and with a simple reaction term. Following [1], we apply a second coordinate transformation, which maps the spatial domain Rd onto the d-dimensional open unit cube,

ypxq

"

1 

arctanpxq

`

1 2.

(2.3)

Let the function w be defined by

vpx, tq " wpypxq, tq.

Then it is readily seen that

Bw Bt

py,

tq

"

Bwpy,

tq

:"

ÿd
k"1

k

,, ppyk q

B2w Byk2

py,

tq

`

q pyk q

Bw Byk

py,

 tq

´

rwpy,

tq

(2.4)

3

whenever y P p0, 1qd, t P p0, T s with

ppq

"

1 22

sin4pq ,

qpq " 1 sin3pq cos pq 

for  P R.

The PDE (2.4) is a convection-diffusion-reaction equation without mixed derivatives. Let  denote

the transform of the payoff function ,

py, tq "  pK exp rQx ` bptqsq

with

x

"

tan

" py

´

1 2

 q

(2.5)

whenever y P p0, 1qd, t P r0, T s. Then for (2.4) one has the initial condition

wpy, 0q " py, 0q.

(2.6)

At the boundary BD of the spatial domain D " p0, 1qd we shall consider a Dirichlet condition. As in [6], we make the minor assumption in this paper that each column of the matrix Q satisfies one of the following two conditions:

(a) all its entries are strictly positive; (b) it has both a strictly positive and a strictly negative entry. For any given k P t1, 2, . . . , du such that the k-th column of Q satisfies condition (a) there holds

wpy, tq " Ke´rt

(2.7)

whenever y P BD with yk " 0 and t P p0, T s. On the complementary part of BD a homogeneous Dirichlet condition is valid. For a short proof of this result, see [6].

2.2 PCA-based approximation for European basket option
Assume the eigenvalues of the covariance matrix  are ordered such that 1  2  ¨ ¨ ¨  d  0. In many financial applications it holds that 1 is dominant, that is, 1 is much larger than 2. In view of this observation, Reisinger & Wittum [1] introduced a PCA-based approximation of the exact solution w to the d-dimensional PDE (2.4). To this purpose, regard w also as a function of the eigenvalues and write wpy, t; q with  " p1, 2, . . . , dqT. Let
p " p1, 0, . . . , 0qT and  "  ´ p " p0, 2, . . . , dqT.
Under sufficient smoothness, a first-order Taylor expansion of w at p yields

wpy,

t;

q

«

wpy,

t;

pq

`

ÿd
l"2

l

Bw Bl

py, t; pq.

(2.8)

The partial derivative Bw{Bl (for 2  l  d) can be approximated by a forward finite difference,

Bw Bl

py, t; pq

«

wpy, t; p

`

l elq l

´

wpy, t; pq

,

(2.9)

where el denotes the l-th standard basis vector in Rd. From (2.8) and (2.9), it follows that

wpy,

t;

q

«

wpy,

t;

pq

`

ÿd

" wpy,

t;

p

`

l

elq

´

wpy,

t;

i pq

.

l"2

Write

wp1qpy, tq " wpy, t; pq and wp1, lqpy, tq " wpy, t; p ` l elq.

4

Then the PCA-based approximation reads

ÿd "

i

wpy, tq « wrpy, tq " wp1qpy, tq ` wp1, lqpy, tq ´ wp1qpy, tq

l"2

(2.10)

whenever y P p0, 1qd and t P p0, T s. By construction, wp1q satisfies the PDE (2.4) with k being set to zero for all k " 1, and wp1, lq satisfies (2.4) with k being set to zero for all k R t1, lu. This
is completed by the same initial and boundary conditions as for w, given above. We write

urps, tq " wrpypxps, tqq, tq

for the PCA-based approximation in the original coordinates. In financial practice, one is often interested in the option value at inception in the single point
s " S0, where S0 " pS01, S02, . . . , S0dqT is the vector of initial (spot) asset prices. Let
Y0 " ypxpS0, T qq P p0, 1qd
denote the corresponding point in the y-domain. Then wp1qpY0, T q can be acquired by solving a one-dimensional PDE on the line segment L1 in the y-domain that is parallel to the y1-axis and passes through y " Y0. Hence, yk can be fixed at the value Y0,k whenever k " 1. Next, wp1, lqpY0,T q (for 2  l  d) can be acquired by solving a two-dimensional PDE on the plane segment Pl in the y-domain that is parallel to the py1, ylq-plane and passes through y " Y0. Hence, in this case, yk can be fixed at the value Y0,k whenever k R t1, lu. Determining the PCA-based approximation wrpY0, T q " urpS0, T q thus requires solving just 1 one-dimensional PDE and d ´ 1 two-dimensional PDEs. This clearly constitutes a major computational advantage, compared to solving the full d-dimensional PDE at once whenever d is medium or large. Notice further that the different terms in the approximation (2.10) can be computed in parallel independently of each other. Then the total computational cost equals that of solving just 1 two-dimensional PDE.
A rigorous error analysis of the PCA-based approximation relevant to European basket options has been given by Reising`er & Wissmann [4]. In particular, under mild assumptions, these authors showed that w ´ wr " O 22 in the maximum norm.

2.3 PCA-based approximation for American basket option

Applying the coordinate transformation from Section 2.1 to the PDCP (1.4) for the value function u of an American basket option, directly yields the following PDCP for the transformed function w,

wpy, tq  py, tq,

(2.11a)

Bw Bt

py,

tq



Bwpy,

tq,

^



pwpy, tq ´ py, tqq

Bw Bt

py,

tq

´

Bwpy,

tq

"0

(2.11b) (2.11c)

whenever y P p0, 1qd, t P p0, T s with function  defined by (2.5). As for European options, a Dirichlet condition is taken at the boundary of the spatial domain D. For any given k P t1, 2, . . . , du such that the entries of the k-th column of Q are all strictly positive there holds

wpy, tq " K

(2.12)

whenever y P BD with yk " 0 and t P p0, T s. Notice that, compared to (2.7), the discount factor expp´rtq is absent in (2.12). On the complementary part of BD, a homogeneous Dirichlet condition
is valid.
The PCA-based approximation for the American basket option value function w is given by (2.10), where by definition wp1q satisfies the PDCP (2.11) with k being set to zero for all k " 1, and wp1, lq satisfies (2.11) with k being set to zero for all k R t1, lu.

5

3 Discretisation

3.1 Discretisation for European basket option

To numerically obtain the values wp1qpY0, T q and wp1, lqpY0, T q (for 2  l  d) in the approximation wrpY0, T q of wpY0, T q for a European basket option, we adopt the finite difference discretisation of the pertinent one- and two-dimensional PDEs on a Cartesian nonuniform smooth spatial grid
constructed in [6]. Let m  1 be the number of (unidirectional) spatial grid points in the interval p0, 1q. Semidis-
cretisation of the PDE for wp1, lq on the plane segment Pl as described in [6] yields a system of ordinary differential equations (ODEs) of the form

W 1ptq " pA1 ` Alq W ptq ` gptq

(3.1)

for t P p0, T s. Here W ptq is a vector of dimension m2 and A1, Al are given m2 ^ m2 matrices that are tridiagonal (possibly up to permutation) and commute and correspond to, respectively, the first and the l-th spatial direction. Next, gptq " g1ptq ` glptq is a given vector of dimension m2, which is obtained from the Dirichlet boundary condition stated at the end of Section 2.1. The
ODE system (3.1) is provided with an initial condition

W p0q " W0,

where the vector W0 is determined by p¨, 0q on Pl, with function  defined by (2.5).

Since the payoff function  given by (1.5) is continuous but not everywhere differentiable, the

same holds for . It is well-known that this nonsmoothness can have an adverse impact on the

convergence of the spatial discretisation. To mitigate this, we apply cell averaging near the points

of nonsmoothness of p¨, 0q in defining the initial vector W0, see e.g. [14].

For the temporal discretisation of the ODE system (3.1), a common Alternating Direction

Implicit (ADI) method is used. Let a step size t " T {N with integer N  1 be given and

define temporal grid points tn " nt for n " 0, 1, . . . , N . Then the familiar second-order Brian

and Douglas ADI scheme for two-dimensional PDEs yields approximations Wn « W ptnq that are

successively defined for n " 1, 2, . . . , N by

$

''''''''&

Z0 Z1

" Wn´1 ` t pA1 ` Alq Wn´1 ` t gptn´1q,

" Z0 `

1 2

t

A1pZ1

´

Wn´1 q

`

1 2

t

pg1

ptn

q

´

g1ptn´1qq,

''''''''%

Z2 " Z1 ` Wn " Z2.

1 2

t

Al

pZ2

´

Wn´1 q

`

1 2

t

pglptnq

´

glptn´1qq,

(3.2)

The two linear systems in each time step can be solved very efficiently by employing a priori LU

factorisations of the pertinent two matrices. The number of floating-point operations per time

step is then directly proportional to the number of spatial grid points m2, which is optimal.

As for the spatial discretisation, also the convergence of the temporal discretisation can be

adversely affected by the nonsmooth payoff function. To alleviate this, we apply backward Euler

damping at the initial time, also known as Rannacher time stepping, that is, the first time step is

replaced by two half steps with the backward Euler method, see e.g. [14].

Discretisation of the PDE for wp1q on the line segment L1 is done analogously to the above.

Then a semidiscrete system

W 1ptq " A1W ptq ` g1ptq

(3.3)

is obtained with W ptq and g1ptq vectors of dimension m and A1 an m ^ m tridiagonal matrix. Temporal discretisation is performed by the Crank­Nicolson scheme with backward Euler damping. Recall that the Crank­Nicolson scheme can be regarded as a special case of the Brian and Douglas scheme, which is seen upon setting Al and gl both equal to zero in (3.2).
Favourable rigorous stability results for the spatial and temporal discretisations discussed in this section have been proved in [6].

6

3.2 Discretisation for American basket option

Semidiscretisation of the pertinent one- and two-dimensional PDCPs in the case of American basket options follows along the same lines as described in Section 3.1 for the corresponding PDEs in the case of European basket options. The relevant boundary condition (2.12) is now independent of time, and hence, the same holds for g. Semidiscretisation of the PDCP for wp1, lq on the plane segment Pl yields

W ptq  ptq,

(3.4a)

W 1ptq  pA1 ` Alq W ptq ` g,

(3.4b)

pW ptq

´

ptqqT

` W

1ptq

´

pA1

`

Alq W ptq

´

 g

"

0

(3.4c)

for t P p0, T s and W p0q " W0. Here ptq is a vector of dimension m2 that is determined by the
function p¨, tq on Pl. Inequalities for vectors are to be understood componentwise.
For the temporal discretisation of the semidiscrete PDCP (3.4) we consider two adaptations of the Brian and Douglas ADI scheme (3.2). They both generate successive approximations Wxn to W ptnq for n " 1, 2, . . . , N with Wx0 " W0.
The first adaptation is elementary and follows the so-called explicit payoff (EP) approach,

$ '''''''''''''&

Z0 Z1

" Wxn´1 ` t pA1 ` Alq Wxn´1

"

Z0

`

1 2

t

A1pZ1

´

Wxn´1q,

`

t g,

'''''''''''''%

Z2

"

Z1

`

1 2

t

Al

pZ2

´

Wxn´1q,

Wn " Z2,

Wxn " maxtWn, nu.

(3.5)

Here n " ptnq and the maximum of two vectors is to be taken componentwise. The adaptation (3.5) can be regarded as first carrying out a time step by ignoring the American constraint and next applying this constraint explicitly.
The second adaptation is more advanced and employs the Ikonen­Toivanen (IT) splitting

technique [15, 16, 17],

$ '''''''''''''''''&

Z0 Z1 Z2

" Wxn´1 ` t pA1 ` Alq Wxn´1

"

Z0

`

1 2

t

A1pZ1

´

Wxn´1q,

"

Z1

`

1 2

t

Al

pZ2

´

Wxn´1q,

`

t g

`

t µpn´1,

'''''''''''''''''%

Wn Wxn µpn

" Z2, " max " max

Wn

´

t

µpn´1

,

( n

,

0 , µpn´1 ` pn ´ Wnq{t(

(3.6)

with µp0 " 0. The auxiliary vector µpn is often called a Lagrange multiplier. For a useful interpretation of this adaptation we refer to [18]. The vector Wxn and the auxiliary vector µpn are computed in two parts. In the first part, an intermediate vector Wn is computed. In the second part, Wn and µpn´1 are updated to Wxn and µpn by a certain simple, explicit formula.

7

The obtained accuracy for the adaptation by the IT approach is generally better than by the EP approach, see e.g. [14, 18] and also Section 5 below. A virtue of both adaptations (3.5), (3.6) is that the computational cost per time step is essentially the same as that for (3.2).

4 Comonotonic approach

In a variety of papers in the literature, the concept of comonotonicity has been employed for

arriving at efficiently computable approximations as well as upper and lower bounds for option

values. For European-style basket options, relevant references to the comonotonic approach are,

notably, Kaas et al. [7], Dhaene et al. [8, 9], Deelstra et al. [10, 11] and Chen et al. [12, 13]. Recently,

an extension to American-style basket options has been considered by Hanbali & Linders [2]. In

this section we review results obtained with the comonotonic approach and applied in loc. cit.

Here the assumption has been made that the payoff function  is convex, which is satisfied by

(1.5), and that all correlations in the SDE system (1.1) are nonnegative.

It follows from [7] that an upper bound for the European basket option value function u is

acquired by setting all correlations in (1.1) equal to one, i.e., ij " 1 for all i, j. Denote this upper bound by uup. Consider the same coordinate transformations as in Section 2.1 and denote the

obtained transformed functions by has single nonzero eigenvalue up "

vudip"1andi2 .

wup. The pertinent Hence, the function

covariance matrix up " pij q vup satisfies the one-dimensional

PDE

B

vup Bt

px,

tq

"

1 2

up

B2vup Bx21

px,

tq

´

rvuppx, tq

(4.1)

whenever x P Rd, t P p0, T s. Next, the function wup satisfies the one-dimensional PDE

B

wup Bt

py,

tq

"

B upwup py ,

tq

:"

up

,, ppy1q

B2wup By12

py,

tq

`

qpy1q

Bwup By1

py,

 tq

´

rwup py ,

tq

(4.2)

whenever y P p0, 1qd, t P p0, T s. The same initial and boundary conditions apply as in Section 2.1,

using the pertinent function up.

It turns out that the upper bound above is, in general, rather crude. In the comonotonic

approach, accurate lower bounds for the European basket option value have been derived, however.

We consider here the lower bound chosen in [2], which has been motivated by results obtained in

[7, 10]. Let i P p0, 1s be given by

i

"

bd
j"1

d
j"1
d
k"1

j j

S0jij j k S0j S0k

jk

j

k

for 1  i  d.

(4.3)

The lower bound is acquired upon replacing the volatility i by ii for 1  i  d and subsequently

setting in (1.1) all correlations equal to transformed functions by vlow and wlow.

one. Then,

Denote this with low "

bodiu"n1dpbiyiqu2l,owtheanfudntchtieoncovrlroewspsaotnidsfiinegs

the one-dimensional PDE

B

vlow Bt

px,

tq

"

1 2

low

B

2vlow Bx21

px, tq

´

rvlowpx, tq

(4.4)

whenever x P Rd, t P p0, T s. Next, the function wlow satisfies the one-dimensional PDE

B

wlow Bt

py,

tq

"

B low wlow py ,

tq

:"

low

,, ppy1q

B2wlow By12

py,

tq

`

qpy1q

Bwlow By1

py,

 tq

´

rwlow py ,

tq

(4.5)

whenever y P p0, 1qd, t P p0, T s. The same initial and boundary conditions apply as in Section 2.1, using the pertinent function low.
Clearly, the comonotonic upper as well as lower bound can be viewed as obtained upon replacing in the PDE (1.2) the covariance matrix  by a certain matrix of rank one. For the lower bound,

8

this rank-one matrix is given by low "  T with (eigen)vector  " p11, 22, . . . , ddqT and single nonzero eigenvalue low " T.
Based on a result by Vyncke et al. [19], a specific linear combination of the comonotonic lower and upper bounds has been considered in [2], which approximates the value of a European basket option. This comonotonic approximation reads

uapppS0, T q " zulowpS0, T q ` p1 ´ zquuppS0, T q,

(4.6)

where z  0 is given by with

z

"

c´b c´a

a

"

ÿd

ÿd

ij S0i S0j

`eij ij T

 ´1 ,

i"1 j"1

b

"

ÿd

ÿd

ij S0i S0j

`eij ij T

 ´1 ,

i"1 j"1

c

"

ÿd

ÿd

ij S0i S0j

`eij T

 ´1 .

i"1 j"1

In [2] the authors next proposed (4.6) as an approximation to the value of an American basket option, where ulow and uup are now defined via the solutions wlow and wup to the PDCP (2.11) with B replaced by Blow and Bup, respectively, and function  replaced by low and up, respectively. We remark that, to our knowledge, it is an open question in the literature at present whether these functions ulow and uup form actual lower and upper bounds for the American basket option value.
For the numerical solution of the pertinent PDEs and PDCPs, in [2] a finite difference method was applied in space and the explicit Euler method in time, with the EP approach for American basket options. In the following, we shall employ the spatial and temporal discretisations described in Section 3. In particular this allows for much less time steps than is required, in view of stability, by the explicit Euler method.

5 Numerical experiments

In this section we perform ample numerical experiments. Our main aims are to determine whether

the PCA-based and comonotonic approaches define approximations to European and American

basket put option values that lie close to each other, and next, to gain insight into the error of the discretisations described in Section 3 in computing these approximations.
We consider two parts of experiments, depending on the parameter sets chosen for the basket

option and underlying asset price model. In the first part we choose the same six parameter sets

A­F as considered in [6]. In the second part we shall select parameter sets similar to those in [2].

Commencing with the first part, Set A is taken from Reisinger & Wittum [1]. Here d " 5,

K " 1, T " 1, r " 0.05 and

¨



1.00 0.79 0.82 0.91 0.84

pijqdi,j"1 " °°°°000...987129

1.00 0.73 0.80

0.73 1.00 0.77

0.80 0.77 1.00

000...977026<<<<,,

0.84 0.76 0.72 0.90 1.00

pi qdi"1

"

` 0.518

piqdi"1

"

` 0.381

0.648 0.065

0.623 0.057

0.570 0.270

 0.530 ,
 0.227 .

9

The corresponding covariance matrix  has eigenvalues

pi qdi"1

"

` 1.4089

0.1124

0.1006

0.0388

 0.0213

and it is clear that 1 is dominant.

Sets B and C are obtained from Jain & Oosterlee [20] and possess dimensions d " 10 and d " 15,

respectively. Here K " 40, T " 1, r " 0.06 and ij " 0.25, i " 0.20, i " 1{d for 1  i " j  d. Sets B and C have 1 " 0.13 and 1 " 0.18, respectively, and 2 " . . . " d " 0.03. Hence, 1 is

also dominant for these parameter sets.

Sets D, E, F possess dimensions d " 5, 10, 15, respectively, where K " 100, T " 1, r " 0.04

and ij " expp´µ|i ´ j|q, i " 0.30, i " 1{d for 1  i, j  d with µ " 0.0413. The relevant

correlation structure has been considered in for example Reisinger & Wissmann [3] and yields

eigenvalues that decrease rapidly. Sets D, E, F have in particular

`

`

`



p1 2 3q " 0.4218 0.0180 0.0053 , 0.7897 0.0647 0.0187 , 1.1126 0.1337 0.0402 ,

respectively. It can be verified that for all Sets A­F the pertinent matrix of eigenvectors Q satisfies the
assumption from Section 2.1.

10´1 10´2 10´3

PCA (EP) Com (EP) PCA (IT) Com (IT)

error

10´4

10´5

10´160´2

1/N

10´1

Figure 1: Error with respect to the semidiscrete values for urpS0, T q and uapppS0, T q if m " 100. Two reference lines included for first-order convergence (dotted) and second-order convergence (dashed).
Our first numerical experiment concerns the two adaptations of the temporal discretisation scheme to PDCPs by the EP and IT approaches as described in Section 3.2 for American-style options. Consider Set A and S0 " pK, K, . . . , KqT. For a fixed number of spatial grid points, given by m " 100, we study the absolute error in the two pertinent discretisations of the PCA-based and comonotonic approximations urpS0, T q and uapppS0, T q in function of the number of time steps N " 10, 11, 12, . . . , 100. Figure 1 displays the obtained errors with respect to the values computed for a large number of time steps, N " 1000. Note that these errors do not contain the error due to spatial discretisation, but only due to the temporal discretisation. Figure 1 clearly illustrates that, in the PCA-based as well as the comonotonic case, the IT approach yields a (much) smaller error than the EP approach for any given N . Further, the observed order of convergence for IT is approximately 1.5, whereas for EP it is only approximately 1.0. The better performance of IT compared to EP is well-known in the literature, see e.g. [14, 17, 18]. Accordingly, in the following, we shall always apply the IT approach.
Let S0 " pK, K, . . . , KqT as above. Table 1 displays our reference values for the PCA-based and comonotonic approximations urpS0, T q and uapppS0, T q, respectively, as well as the lower bound

10

ulowpS0, T q for the European basket put option. These values have been obtained by applying the PDE discretisation from Section 3 with m " N " 1000 spatial and temporal grid points. Clearly, the positive result holds that, for each given set, the two approximations and the lower bound lie close to each other.

Set urpS0, T q uapppS0, T q ulowpS0, T q

A 0.17577 0.17583

0.17577

B 0.83257 0.84125

0.83942

C 0.77065 0.78083

0.77955

D 9.46550 9.46570

9.46523

E 9.10039 9.10128

9.09974

F 8.76358 8.76554

8.76255

Table 1: Reference values urpS0, T q, uapppS0, T q, ulowpS0, T q for European basket put option.

Similarly, Table 2 shows our reference values for urpS0, T q, uapppS0, T q, ulowpS0, T q for the American basket put option. These values have been obtained by applying the PDCP discretisation from Section 3 and m " N " 1000. We find the favourable result that also in the American case, for each given set, the PCA-based and comonotonic approximations lie close to each other. Recall that, at present, it is not clear whether ulowpS0, T q forms an actual lower bound in this case.

Set urpS0, T q uapppS0, T q ulowpS0, T q

A 0.18110 0.18120

0.18114

B 1.07928 1.08615

1.08431

C 1.01641 1.02435

1.02306

D 9.86176 9.86206

9.86159

E 9.49645 9.49774

9.49620

F 9.15935 9.16219

9.15920

Table 2: Reference values urpS0, T q, uapppS0, T q, ulowpS0, T q for American basket put option.

We next study, for European and American basket put options and Sets A­F, the absolute error in the discretisation described in Section 3 of the PCA-based and comonotonic approximations urpS0, T q and uapppS0, T q in function of m " N " 10, 11, 12, . . . , 100. To determine the error of the discretisation for the PCA-based and comonotonic approximations, the corresponding reference values from Tables 1 and 2 are used.
Figures 2 and 3 display for Sets A, B, C and D, E, F, respectively, the absolute error in the discretisation of urpS0, T q and uapppS0, T q versus 1{m, where the left column concerns the European option and the right column the American option.
As a main observation, Figures 2 and 3 clearly indicate (near) second-order convergence of the discretisation error in all cases, that is, for all Sets A­F, for both the European and American basket options, and for both the PCA-based and comonotonic approximations. This is a very favourable result. Additional experiments indicate that the error stems essentially from the spatial discretisation (and not the temporal discretisation).
For the European option and Sets A and D, we remark that the error drop in the (less important) region m  20 corresponds to a change of sign. Besides this, in the case of the European basket option, the behaviour of the discretisation error is always seen to be regular.
For the American option, it is found that the discretisation error often behaves somewhat less regular, with oscillations occurring. A similar phenomenon has recently been observed and studied in [6] for Bermudan basket options and is attributed to the spatial nonsmoothness of the exact option value function at the early exercise boundary.
In the following we consider the second part of experiments and choose parameter sets inspired by those from [2]. Here a basket put option with d " 8 equally weighted underlying assets is taken and S0 " p40, 40, . . . , 40qT. Next, the strike K P t35, 40, 45u and the maturity time T P t0.5, 1, 2u.

11

For the interest rate we choose1 r " 0.05 and the volatilities are given by

pi q8i"1

"

` 1

0.6

0.1

0.9

0.3

0.7

0.8

 0.2

with 1 P t0.3, 0.9u. We select correlation ij " 0.8 for all i " j. Then, for the pertinent two covariance matrices, the first eigenvalue is dominant. In particular, there holds

1 " 0.3 : 1 " 0.9 :

`



piq8i"1 piq8i"1

" "

2.1398 ` 2.7299

0.1461 0.1620

0.1101 0.1396

0.0796 0.1076

... , 
... .

Further, the relevant matrices of eigenvectors Q satisfy the assumption from Section 2.1. Tables 3 and 4 show our reference values for urpS0, T q, uapppS0, T q, ulowpS0, T q for the European
and American basket put option, respectively, which have been obtained in the same way as above. Again, we find the favourable result that, for each given parameter set and each given (European or American) option, these three values lie close to each other.
Figure 4 displays, analogously to Figures 2 and 3, the absolute error in the discretisation of urpS0, T q and uapppS0, T q for the (representative) three parameter sets given by T P t0.5, 1, 2u, K " 40, 1 " 0.3. The outcomes again indicate a favourable, second-order convergence result. The regularity of the error behaviour is seen to decrease as the maturity time T increases. We note that for T " 2 this behaviour is partly explained from a (near) vanishing error when m « 20.

6 Conclusions
In this paper we have studied an extension of the PCA-based approach by Reisinger & Wittum [1] to valuate American basket options. This approximation approach is highly effective, as the numerical solution of only a limited number of low-dimensional PDCPs is required. In addition, we have considered the comonotonic approach, which was developed for basket options notably in [7, 8, 9, 10, 11, 12, 13, 19]. We have studied the comonotonic approximation formula for American basket option values recently examined in Hanbali & Linders [2]. This comonotonic approach is also highly effective, since it requires the numerical solution of just two one-dimensional PDCPs.
For the discretisation of the pertinent PDCPs, we applied finite differences on a nonuniform spatial grid followed by the Brian and Douglas ADI scheme on a uniform temporal grid and selected the Ikonen­Toivanen (IT) technique [15, 16, 17] to efficiently handle the complementarity problem in each time step.
As a first main result, we find in ample numerical experiments that the PCA-based and comonotonic approaches always yield approximations to the value of an American (as well as European) basket option that lie close to each other.
As a next main result, we observe near second-order convergence of the discretisation error in all numerical experiments for both the PCA-based and comonotonic approaches for American (as well as European) basket options.
At this moment it is still open which (if any) of the two approaches, PCA-based or comonotonic, is to be preferred for the approximate valuation of American basket options on d  5 assets. In particular, whereas in our experiments the two approaches always define approximations that lie close to each other, it is not clear at present which approach (if any) generally yields the smallest error with respect to the exact option value. A further investigation into the PCA-based and comonotonic approaches, both experimental and analytical, will be the subject of future research.

1In [2] the rate r " 0.01 is taken, but then American option values are often close to their European counterpart, which is less interesting.
12

100 10´1

European basket option
PCA Com

100 10´1

American basket option
PCA (IT) Com (IT)

10´2

10´2

error

10´3

10´3

10´4

10´4

10´150´2 100
10´1

10´1
PCA Com

10´150´2 100
10´1

10´1
PCA (IT) Com (IT)

10´2

10´2

error

10´3

10´3

10´4

10´4

10´150´2 100
10´1

10´1
PCA Com

10´150´2 100
10´1

10´1
PCA (IT) Com (IT)

10´2

10´2

error

10´3

10´3

10´4

10´4

10´150´2

1/m

10´1

10´150´2

1/m

10´1

Figure 2: Discretisation error for urpS0, T q and uapppS0, T q in cases A (top), B (middle) and C (bottom). Left: European basket option. Right: American basket option. Reference line (dashed) included for second-order convergence.

13

European basket option
101
PCA Com
100

American basket option
101
PCA (IT) Com (IT)
100

10´1

10´1

error

10´2

10´2

10´3

10´3

10´140´2 101
100

10´1
PCA Com

10´140´2 101
100

10´1
PCA (IT) Com (IT)

10´1

10´1

error

10´2

10´2

10´3

10´3

10´140´2 101
100

10´1
PCA Com

10´140´2 101
100

10´1
PCA (IT) Com (IT)

10´1

10´1

error

10´2

10´2

10´3

10´3

10´140´2

1/m

10´1

10´140´2

1/m

10´1

Figure 3: Discretisation error for urpS0, T q and uapppS0, T q in cases D (top), E (middle) and F (bottom). Left: European basket option. Right: American basket option. Reference line (dashed) included for second-order convergence.

14

T K 1 urpS0, T q uapppS0, T q ulowpS0, T q

35 0.3 2.13020

2.13271

2.12954

0.9 2.74982

2.75307

2.74963

0.5 40 0.3 4.40336

4.40715

4.40328

0.9 5.14582

5.15003

5.14595

45 0.3 7.45442

7.45827

7.45427

0.9 8.21316

8.21738

8.21313

35 0.3 3.35805

3.36599

3.35620

0.9 4.23834

4.24750

4.23731

1 40 0.3 5.78199

5.79261

5.78114

0.9 6.79656

6.80770

6.79599

45 0.3 8.75406

8.76551

8.75329

0.9 9.82315

9.83486

9.82235

35 0.3 4.71159

4.73545

4.70532

0.9 5.89254

5.91682

5.88742

2 40 0.3 7.20593

7.23607

7.20149

0.9 8.54494

8.57378

8.54048

45 0.3 10.08246 10.11611 10.07862

0.9 11.51843 11.54974 11.51371

Table 3: Reference values urpS0, T q, uapppS0, T q, ulowpS0, T q for European basket put option.

T K 1 urpS0, T q uapppS0, T q ulowpS0, T q

35 0.3 2.17006

2.17293

2.16973

0.9 2.79440

2.79840

2.79494

0.5 40 0.3 4.50018

4.50506

4.50118

0.9 5.24177

5.24795

5.24387

45 0.3 7.64424

7.65063

7.64670

0.9 8.38729

8.39562

8.39142

35 0.3 3.48012

3.48874

3.47879

0.9 4.37236

4.38280

4.37246

1 40 0.3 6.01652

6.02870

6.01717

0.9 7.03281

7.04676

7.03498

45 0.3 9.14612

9.16072

9.14867

0.9 10.19561 10.21256 10.20013

35 0.3 5.06452

5.08982

5.05865

0.9 6.27930

6.30536

6.27500

2 40 0.3 7.78521

7.81748

7.78222

0.9 9.14045

9.17258

9.13855

45 0.3 10.94634 10.98327 10.94585

0.9 12.36710 12.40399 12.36770

Table 4: Reference values urpS0, T q, uapppS0, T q, ulowpS0, T q for American basket put option.

15

European basket option
102
PCA Com
101

American basket option
102
PCA (IT) Com (IT)
101

100

100

error

10´1

10´1

10´2

10´2

10´130´2

10´1

10´130´2

10´1

102

102

PCA

PCA (IT)

Com

Com (IT)

101

101

100

100

error

10´1

10´1

10´2

10´2

10´130´2

10´1

10´130´2

10´1

102

102

PCA

PCA (IT)

Com

Com (IT)

101

101

100

100

error

10´1

10´1

10´2

10´2

10´130´2

1/m

10´1

10´130´2

1/m

10´1

Figure 4: Discretisation error for urpS0, T q and uapppS0, T q in cases T " 0.5 (top), T " 1 (middle) and T " 2 (bottom) where K " 40, 1 " 0.3. Left: European basket option. Right: American basket option. Reference line (dashed) included for second-order convergence.

16

References
[1] C. Reisinger and G. Wittum. Efficient hierarchical approximation of high-dimensional option pricing problems. SIAM J. Sci. Comp., 29:440­458, 2007.
[2] H. Hanbali and D. Linders. American-type basket option pricing: a simple two-dimensional partial differential equation. Quant. Fin., 19:1689­1704, 2019.
[3] C. Reisinger and R. Wissmann. Numerical valuation of derivatives in high-dimensional settings via partial differential equation expansions. J. Comp. Finan., 18:95­127, 2015.
[4] C. Reisinger and R. Wissmann. Error analysis of truncated expansion solutions to highdimensional parabolic PDEs. ESAIM: M2AN, 51:2435­2463, 2017.
[5] C. Reisinger and R. Wissmann. Finite difference methods for medium- and high-dimensional derivative pricing PDEs. In High-Performance Computing in Finance: Problems, Methods, and Solutions, pages 175­196. Chapman and Hall/CRC, 2018.
[6] K.J. in 't Hout and J. Snoeijer. Numerical valuation of Bermudan basket options via partial differential equations. Int. J. Comp. Math., 98:829­844, 2021.
[7] R. Kaas, J. Dhaene, and M.J. Goovaerts. Upper and lower bounds for sums of random variables. Insur. Math. Econ., 27:151­168, 2000.
[8] J. Dhaene, M. Denuit, M.J. Goovaerts, R. Kaas, and D. Vyncke. The concept of comonotonicity in actuarial science and finance: theory. Insur. Math. Econ., 31:3­33, 2002.
[9] J. Dhaene, M. Denuit, M.J. Goovaerts, R. Kaas, and D. Vyncke. The concept of comonotonicity in actuarial science and finance: applications. Insur. Math. Econ., 31:133­161, 2002.
[10] G. Deelstra, J. Liinev, and M. Vanmaele. Pricing of arithmetic basket options by conditioning. Insur. Math. Econ., 34:55­77, 2004.
[11] G. Deelstra, I. Diallo, and M. Vanmaele. Bounds for Asian basket options. J. Comp. Appl. Math., 218:215­228, 2008.
[12] X. Chen, G. Deelstra, J. Dhaene, and M. Vanmaele. Static super-replicating strategies for a class of exotic options. Insur. Math. Econ., 42:1067­1085, 2008.
[13] X. Chen, G. Deelstra, J. Dhaene, D. Linders, and M. Vanmaele. On an optimization problem related to static super-replicating strategies. J. Comp. Appl. Math., 278:213­230, 2015.
[14] K.J. in 't Hout. Numerical Partial Differential Equations in Finance Explained. Financial Engineering Explained. Palgrave Macmillan UK, 2017.
[15] T. Haentjens and K.J. in 't Hout. ADI schemes for pricing American options under the Heston model. Appl. Math. Fin., 22:207­237, 2015.
[16] S. Ikonen and J. Toivanen. Operator splitting methods for American option pricing. Appl. Math. Lett., 17:809­814, 2004.
[17] S. Ikonen and J. Toivanen. Operator splitting methods for pricing American options under stochastic volatility. Numer. Math., 113:299­324, 2009.
[18] K.J. in 't Hout and R.L. Valkov. Numerical study of splitting methods for American option valuation. In Novel Methods in Computational Finance, pages 373­398. Springer, 2017.
[19] D. Vyncke, M. Goovaerts, and J. Dhaene. An accurate analytical approximation for the price of a European-style arithmetic Asian option. Finan., 25:121­139, 2004.
[20] S. Jain and C.W. Oosterlee. The stochastic grid bundling method: efficient pricing of Bermudan options and their Greeks. Appl. Math. Comp., 269:412­431, 2015.
17

