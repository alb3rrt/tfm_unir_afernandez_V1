arXiv:2106.01517v1 [math.NT] 3 Jun 2021

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES
JEFFREY HATLEY, DEBANJANA KUNDU, AND ANWESH RAY
Abstract. We study the average behaviour of the Iwasawa invariants for Selmer groups of elliptic curves, considered over anticyclotomic Zp-extensions. The results in this paper lie at the intersection of arithmetic statistics and Iwasawa theory.
1. Introduction
In [14], H. Cohen and H. W. Lenstra introduced a plausible heuristic on the distribution of class groups of number fields. It was claimed (and justified) that their asymptotic behaviour mimics that of generic finite abelian groups weighted inversely by the size of the automorphism group. Over the years, these heuristics have been suitably modified (see for example [36, 15, 34, 35, 22, 1]) and are known to match numerical results fairly well. In [21], E, Friedman and C. Washington reinterpreted the Cohen­Lenstra heuristics using random matrix theory. These ideas have since become a powerful source of predictions for number fields, which kick-started the field of arithmetic statistics. One route that arithmetic statistics took was in the direction of elliptic curves. Motivated by the strong analogy between number fields and elliptic curves, C. Delaunay modelled Tate­Shafarevich groups of elliptic curves based on the Cohen­Lenstra heuristics, see [18].
An important conjecture in the theory of elliptic curves is the rank distribution conjecture which claims that over any number field, half of all elliptic curves have Mordell­Weil rank zero and the remaining half have Mordell­Weil rank one. Finally, higher Mordell­Weil ranks constitute zero percent of all elliptic curves, even though there may exist infinitely many such elliptic curves. Therefore, a suitably-defined average rank would be 1/2. The best results in this direction are by M. Bharagava and A. Shankar (see [7, 8]). They show that the average rank of elliptic curves over Q is strictly less than one, and that both rank zero and rank one cases comprise nonzero densities across all elliptic curves over Q. Proving results about the Mordell­ Weil rank almost always involves a thorough analysis of the Selmer group. This idea dates back to the proof of the Mordell­Weil theorem, and is an essential part of results of Bhargava­Shankar. In [5, 6], they explicitly computed the average sizes of certain Selmer groups to deduce asymptotic results of Mordell­Weil ranks and made the following conjecture.
2010 Mathematics Subject Classification. 11R18, 11F11, 11F33, 11R23 (primary); 11F85 (secondary).
Key words and phrases. Arithmetic statistics, Anticyclotomic extensions, Iwasawa theory, Selmer groups, elliptic curves.
1

2

J. HATLEY, D. KUNDU, AND A. RAY

Conjecture 1.1. Let F be a number field and n be any positive integer. Then, when all elliptic curves E are ordered by height, the average size of the n-Selmer group, denoted by Seln(E/F ), is (n), the sum of the divisors of n.
This conjecture has been verified for n = 2, 3, 4, 5 and was enough to deduce powerful partial results for the rank distribution conjecture.
Another subject of active research is Iwasawa theory. It was introduced by K. Iwasawa in the late 1950's and started as the study of class groups over infinite towers of number fields (see [26, 27]). The close relationship between the group of units of number fields and the rational points elliptic curves motivated B. Mazur to initiate the study of Iwasawa theory of Selmer groups of elliptic curves in [37].
In [32], the second and the third named authors initiated the study of average behaviour of the Iwasawa invariants for the p-primary Selmer groups of elliptic curves over the cyclotomic Zp-extension of Q. In this paper, we extend the ideas to study the average behaviour of the p-primary Selmer group of an elliptic curve with good ordinary reduction at p over the anticyclotomic Zp-extension of an imaginary quadratic field K/Q. These two settings are substantially different from each other. Over the cyclotomic Zp-extension of Q, Mazur conjectured that for an elliptic curve with good ordinary reduction at an odd prime p, the p-primary Selmer group is cotorsion as a module over the Iwasawa algebra, denoted by . This conjecture was settled by K. Kato, see [28, Theorem 17.4]. Unlike in the cyclotomic case, M. Bertolini showed (see [2]) that over an anticyclotomic Zp-extension, the Selmer group need not always be -cotorsion. Several authors have studied classical Selmer groups of elliptic curves (more generally, modular forms) in the anticyclotomic setting (see for example [50, 3, 41]).
The Iwasawa algebra is isomorphic to the power series ring Zp T . The algebraic structure of the Selmer group (as a -module) is encoded by Iwasawa invariants, µ and . By the p-adic Weierstrass Preparation Theorem, the characteristic ideal of the Pontryagin dual of the Selmer group is generated by a unique element fE(p)(T ), which can be expressed as a power of p times a distinguished polynomial. The µ-invariant is the power of p dividing fE(p)(T ) and the -invariant is its degree. In [41, Theorem 5.11], R. Pollack­T. Weston show that when condition (CR) holds the Selmer group is -cotorsion and the algebraic µ-invariant is 0 (see [30] for a corrected version of condition (CR)). In a slightly more general setting, vanishing of the µ-invariant can be deduced from the arguments given in the last two pages of [11]. Further, if the p-primary part of the Tate­Shafarevich group, denoted by X(E/K)[p], is finite, then the -invariant is at least as large as the Mordell­Weil rank of E over K (see Lemma 2.1). However, the -invariant may indeed be strictly larger than the rank, and one of our main objectives is to determine its behaviour on average. We analyze the following three separate but interrelated problems.
(1) For a fixed elliptic curve E over a fixed imaginary quadratic field K, how do the Iwasawa invariants vary as p varies over all odd primes p at which E has good ordinary reduction?
(2) For a fixed elliptic curve E and a fixed odd prime p of good ordinary reduction, how do the Iwasawa invariants vary as K = Q( -d) varies over all primes d > 0?
(3) For a fixed prime p and a fixed imaginary quadratic field K, how do the Iwasawa invariants vary as E varies over all elliptic curves defined over Q, ordered by height (with good ordinary reduction at p)?

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 3
With regards to the first question, we show that for non-CM elliptic curves, the exact order of growth for the number of primes at which µ = 0 is closely related to the Lang-Trotter Conjecture. A more precise answer to Question 1 is provided in Theorem 4.7 and Corollary 4.8. The second question, is subtle and we can only provide a partial result in this direction (see Theorem 7.4). It is shown that this question is largely dependent on how often the order of the Tate­Shafarevich group over K is not divisible by p. We address Question 3 in Theorem 8.18, and the answer is largely dependent on the variation of Tate­Shafarevich groups over all elliptic curves of Mordell­Weil rank 0. In this paper, we not only extend, but also refine the approach taken in [32], and relate the results to Cohen­Lenstra heuristics.
Organization: Including this introduction, this article has 9 sections. Section 2 is preliminary in nature. We give definitions of the objects of interest and record some basic results from the literature. In Section 3, we discuss in detail the Euler characteristic associated to the Selmer group of an elliptic curve. We prove several important lemmas which are used throughout this article. In Section 4, we fix an imaginary quadratic field K/Q and consider the anticyclotomic Zp-extension K/K. Using the Euler characteristic formula, we study the variation of the Iwasawa invariants of a fixed rank 0 elliptic curve (defined over Q) without complex multiplication as p varies. In Section 5, we give sufficient conditions for elliptic curves to have finitely many anomalous primes both over Q and over K. In Section 6. for a given pair (E, p) we study for what proportion of imaginary quadratic fields the dual Selmer group is a finitely generated Zp-module over the anticyclotomic Zpextension. Further, we supplement our results with concrete examples. In Section 7, we move one step ahead and study for what proportion of imaginary quadratic fields the dual Selmer group is trivial. In Section 8 we extend the results proved in [32]. We study the variation of Iwasawa invariants of the Selmer groups Selp (E/Q) and Selp (E/K) as E ranges over all elliptic curves (defined over Q) of rank zero (over K) with good ordinary reduction at the prime(s) above p. Finally, in Section 9 we survey the heuristics for the Tate­Shafarevich groups for elliptic curves ordered by height and explain their consequences to our results. Computational evidence for our results are presented in tables in Section 10.
Acknowledgements. DK acknowledges the support of the PIMS Postdoctoral Fellowship. AR would like to thank Tom Weston and Stanley Xiao for helpful discussions.
2. Background and Preliminaries
2.1. Throughout, let p be an oddprime and E an elliptic curve defined over an imaginary quadratic field K = Q( -d). Denote by K the anticyclotomic Zpextension of K. This is the unique Zp-extension of K which is Galois over Q, for which the Galois group Gal(K/Q) is pro-dihedral. Set  to be the Galois group Gal(K/K) and pick a topological generator   . The Iwasawa algebra  is the completed group algebra Zp  := lim-n Zp[/pn]. Fix the isomorphism of rings   Zp T , that sends  - 1 to the formal variable T .
Assume throughout that E has good ordinary reduction at the primes v|p of K. We recall the definition of the p-primary Selmer group of E over K, which will be the main object of study in the paper. Let Sp denote the primes v of L such that v|p. Choose a finite set of primes S containing Sp and the primes at which E

4

J. HATLEY, D. KUNDU, AND A. RAY

has bad reduction. For any finite extension L/K, write S(L) to denote the set of primes v of K such that v lies above a prime in S. Write

Jv(E/L) := H1 (Lw, E) [p]
w|v

where the direct sum is over all primes w of L lying above v. Then, the p-primary

Selmer group over L is defined as follows









Selp (E/L) := ker H1 KS/L, E[p] -

Jv(E/L) .

vS

Next, set Jv(E/K) to be the direct limit

Jv(E/K) := l-im Jv(E/L),
L

where L ranges over all number fields contained in K. Taking direct limits, the

p-primary Selmer group overK is defined as follows







Selp (E/K) := ker H1 KS/K, E[p] -

Jv(E/K) .

vS

Note that Jv(E/K) is a -module and the map above is a map of -modules. A -module M is said to be cofinitely generated (resp. cotorsion) if its Pontryagin dual M  := HomZp M, Qp/Zp is finitely generated (resp. torsion) as a -module. A standard application of Nakayama's lemma shows that Selp (E/K) is cofinitely generated, but need not always be cotorsion. The property of being -cotorsion
holds if some additional hypotheses are satisfied, which are discussed in §4.

2.2. Let M be a cofinitely generated -module. We introduce the Iwasawa invari-

ants associated to M . By the Structure Theorem for -modules (see [51, Theorem 13.12]), M  is pseudo-isomorphic to a finite direct sum of cyclic -modules, i.e.,

there is a map of -modules







s

t

M  - r   /(pµi )   /(fj(T ))

i=1

j=1

with finite kernel and cokernel. Here, r is the rank of M , µi > 0 and fj(T ) is
a distinguished polynomial (i.e., a monic polynomial with non-leading coefficients divisible by p). The characteristic ideal of M  is (up to a unit) generated by

fM(p)(T ) = fM (T ) := p i µi fj (T ).
j

The µ-invariant of M is defined as the power of p in fM (T ). More precisely,

µp(M ) :=

s i=1

µi

0

if s > 0 if s = 0.

The -invariant of M is the degree of the characteristic element, i.e.

p(M ) :=

s i=1

deg

fi

0

if s > 0 if s = 0.

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 5

Denote by µp(E/K) (resp. p(E/K)) the µ-invariant (resp. -invariant) of the Selmer group Selp (E/K).

Lemma 2.1. Let E/K be an elliptic curve and assume that the Selmer group Selp (E/K) is cotorsion as a -module. Then, p(E/K)  rankZE(K).
Proof. Set r to denote the Zp-corank of Selp (E/K). Since Selp (E/K) is cotorsion, r is finite. Consider the short exact sequence,

0  E(K)  Qp/Zp  Selp (E/K)  X(E/K)[p]  0.

We deduce that

(2.1)

corankZp Selp (E/K)  rankZE(K),

with equality if X(E/K)[p] is finite. It follows from the structure theory of -

modules that p(E/K)  r. It suffices to show that r  rankZE(K). This is

indeed the case, since there is a natural map

Selp (E/K)  Selp (E/K)

with finite kernel. From (2.1), we see that r  rankZE(K) and the result follows.

3. The Euler characteristic

In this section, we introduce the Euler characteristic associated to Selp (E/K) and its relationship with the Iwasawa invariants µ and .

3.1. In what follows, M will be a cofinitely generated and cotorsion -module. Since  has p-cohomological dimension equal to 1, the cohomology groups Hi(, M ) are trivial for i  2. Recall that H1(, M ) is identified with the module of coinvari-
ants M, see [40, Proposition 1.7.7]. Since M is cofinitely generated as a -module, both M  and M are cofinitely generated as Zp-modules. In fact, their coranks are equal, as the following result shows.

Lemma 3.1. Let M be a cofinitely generated cotorsion -module. Then, corankZp H0(, M ) = corankZp H1(, M ).
Proof. See [32, Lemma 2.1].

As a result, H1(, M ) is finite if and only if H0(, M ) is finite.

Definition 3.2. Assume that the cohomology groups Hi(, M ) are finite. The Euler characteristic of M is defined as follows

(, M )

:=

#H #H

0(, 1(,

M M

) )

.

Denote by fM (T ) be the characteristic element of the finitely generated torsion module M . This is the unique generator of the characteristic ideal of M  which is a product of a power of p and a distinguished polynomial, i.e., fM (T ) = pµ × gM (T ), where µ  0 and gM (T ) is a monic polynomial whose non-leading coefficients are divisible by p. Note that  = (M ) is the degree of fM (T ). Write
fM (T ) = c0 + c1T + · · · + cT 

and let rM  0 be the order of vanishing of fM (T ) at T = 0, i.e., the smallest index j such that cj = 0. The order of vanishing rM is related to the Mordell­Weil rank of the elliptic curve E, as the following lemma shows.

6

J. HATLEY, D. KUNDU, AND A. RAY

Lemma 3.3. Let E be an elliptic curve defined over an imaginary quadratic field K. Assume that the following conditions are satisfied
(1) M := Selp (E/K) is -cotorsion, (2) E(K)[p] = 0, (3) X(E/K)[p] is finite.
Then the order of vanishing rM is equal to rankZE(K). Further, the cohomology groups Hi(, M ) are finite if and only if E(K) is finite.

Proof. It follows from [52, Lemma 2.11] that

(3.1)

rM = corankZp M .

The natural map

 : Selp (E/K)  Selp (E/K)

is therefore injective. It follows from the Control Theorem (see [25, Theorem 1])

that  has finite cokernel. Therefore, rM is equal to the corank of Selp (E/K). From the short exact sequence,

0  E(K)  Qp/Zp  Selp (E/K)  X(E/K)[p]  0

we deduce that rM = rankZE(K). In particular, from (3.1) it follows that M  is finite if and only if E(K) is finite. By Lemma 3.1, H1(, M ) is finite precisely when M  is finite. This completes the proof of the lemma.

Let E/K be a rank 0 elliptic curve satisfying the conditions of Lemma 3.3. Then, the Euler characteristic of M = Selp (E/K) can be defined. In this case, set (, E[p]) := (, M ). Since rM = 0, it follows that the constant term c0 of fM (T ) is non-zero. As the following result shows, c0 is closely related to (, E[p]). Let a, b  Qp, we say that a  b if a = ub for a unit u  Z×p .

Lemma 3.4. Let M be a cofinitely generated and cotorsion -module for which the cohomology groups Hi(, M ) are finite. Then,

(, M )  c0,

where c0 is the constant term of the characteristic element fM (T ).
Proof. It follows from [52, Lemma 2.13] that if M  is another -module which is pseudo-isomorphic to M then the Euler characteristics match, i.e.
(, M ) = (, M ).

Denote by X the Pontryagin dual M  and assume without loss of generality that

X is isomorphic to a direct sum of cyclic -modules as follows







s

t

X -  /(pµi )   /(fj(T )) .

i=1

j=1

Note that for i = 0, 1 we have that #Hi(, M ) = #H1-i(, X).

Therefore, we arrive at the following relations

s

t

#H0(, M ) = #X/T X = pµi ×

fj (0)

-1 p

=

fM (0)

-1 p

,

i=1

j=1

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 7

and #H1(, M ) = # ker X -×-T X = 1.

Combining the above equalities, we find that

(, M )

=

#H0(, M ) #H1(, M )

=

fM (0)

-1 p



c0.

Remark 3.5. The Euler characteristic is a priori possibly a negative power of p. However, the above relation (, M )  c0 shows that it is indeed an integer given by a non-negative power of p.
3.2. We discuss the relationship between (, M ) and the vanishing of Iwasawa invariants.
Proposition 3.6. Let M be a cofinitely generated and cotorsion -module for which the cohomology groups Hi(, M ) are finite. Then, the following are equivalent
(1) (, M ) = 1, (2) fM (T ) = 1, (3) µ(M ) = 0 and (M ) = 0, (4) M has finite cardinality.
Proof. By Lemma 3.4, the constant coefficient c0 of fM (T ) is a unit in Zp if and only if (, M ) = 1. Recall that fM (T ) is the unique generator of the characteristic ideal of M  and is expressed as a power of p times a distinguished polynomial. Therefore, c0 is a unit if and only if fM (T ) = 1. This proves that (1) and (2) are equivalent.
Recall that µ(M ) is the power of p dividing fM (T ) and (M ) = deg fM (T ). Therefore, if µ(M ) = 0 and (M ) = 0, then fM (T )  Z×p . However, it must also be a distinguished polynomial. Hence, fM (T ) = 1. Conversely, it is clear that if fM (T ) = 1, then µ(M ) = 0 and (M ) = 0. As a result, (2) is equivalent to (3).
It remains to show that (2) is equivalent to (4). If fM (T ) = 1, then M is pseudo isomorphic to 0. Hence, M is finite. On the other hand, if M is finite, then any generator of the characteristic ideal of M must be a unit in . Since fM (T ) is defined to be a product of a power of p and a distinguished polynomial, it follows that fM (T ) = 1. Therefore, (2) is equivalent to (4).
4. Results for a fixed elliptic curve E and varying prime p 
Let K = Q( -d) be an imaginary quadratic field and E a fixed elliptic curve over Q without complex multiplication. Let p be a prime at which E has good ordinary reduction. Let Sp be the set of primes of K above p. The Iwasawa invariants µp(E/K) and p(E/K) are associated to the Galois module E[p] and depend on the prime p. In this section, we study the variation of the Iwasawa invariants µp(E/K) and p(E/K) as p varies.
4.1. First, we record certain well-known facts and conjectures. Let Q be a choice of algebraic closure of Q. For any integer N  1, define E[N ] := ker E(Q) -×-N E(Q) . If N |N , then consider the multiplication by N/N -map
N,N : E[N ]  E[N ].

8

J. HATLEY, D. KUNDU, AND A. RAY

The big Tate-module is defined as follows

T(E) := lim- E(Q)[N ],
N
where the inverse limit is taken with respect to the maps N,N, whenever N |N . It is easy to see that T(E) is non-canonically isomorphic to Z2, and admits a natural action of the absolute Galois group Gal(Q/Q). Identify the group of Zlinear automorphisms of T(E) with GL2(Z) and denote by

E : Gal(Q/Q)  GL2(Z)

the associated Galois representation. Serre's open image theorem (see [45, §4 The-
orem 3]) asserts that the image of E has finite index in GL2(Z). Consider the residual representation

E,p : Gal(Q/Q)  GL2(Z/pZ)

induced by Gal(Q/Q) on E[p]. This residual representation may be reducible,

i.e., contained in a conjugate of the Borel subgroup of upper triangular matrices

 0

in GL2(Z/pZ). This holds for instance if E(Q)[p] = 0. However, if

p  [GL2(Z^) : im E ], the residual representation E,p is irreducible. Further, since the index is finite, E,p is surjective for all but finitely many primes p.
Recall that the Selmer group Selp (E/K) was defined in §2. Our first line of
inquiry concerns conditions under which Selp (E/K) is cotorsion as a -module.
Consider the special case when E is defined over Q. Let N be the conductor of E. Write N = N +N -, where N + (resp. N -) is divisible by primes that split (resp. are inert) in K. If N - has an even number of prime divisors, then it is known by results of C. Cornut [16] and V. Vatsal [49] that Selp (E/K) could have positive rank over . On the other hand, when N - has an odd number of prime

divisors, the situation is more analogous to the cyclotomic Iwasawa theory of E.

Let E denote the reduced curve modulo p and set ap := 1 + p - #E(Fp).

Hypothesis 4.1. We refer to the following set of conditions as (CR).
(1) E,p : Gal(Q/Q)  GL2(Fp) is surjective. (2) If q is a prime with q|N - and q  ±1 mod p, then E,p is ramified at q. (3) N - is squarefree and the number of primes dividing N - is odd. (4) ap  ±1 mod p.

Then, it follows from work of Vatsal [49], M. Bertolini­H. Darmon [3], and Pollack­Weston [41] that under (CR), the dual Selmer group Selp (E/K) is a torsion module over the Iwasawa algebra  with µp(E/K) = 0. Note that the last assumption ap  ±1 mod p needs to be added to the hypotheses of Pollack and Weston, according to [30, Remark 1.4]. On the other hand, if Selp (E/K) is finite (i.e., the rankZE(K) = 0 and X(E/K)[p] is finite), then it follows from [23, Corollary 4.9] that Selp (E/K) is a torsion -module. However, under this hypothesis alone, it is not known that µp(E/K) = 0. Assume therefore, that E is not CM, it is defined over the rationals, and that N - is squarefree and divisible by
an odd number of primes. Note that for p suitably large, the (CR) conditions are all
satisfied provided E has ordinary reduction at p and ap  ±1 mod p. Therefore, their results give the following.

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 9

Theorem 4.2 (Vatsal, Bertolini­Darmon, Pollack­Weston). Let E/Q be an elliptic curve without complex multiplication. Assume that N - is squarefree and divisible by an odd number of primes. Consider the set of primes PE for which
(1) E has good ordinary reduction, (2) ap  ±1 mod p. Then for all but finitely many primes p  PE, the Selmer group Selp (E/K) is a -torsion module and µp(E/K) = 0.

It follows from the Hasse bound that a prime p  7 is contained in PE if and only if ap / {0, ±1}. We recall the conjecture of Lang and Trotter.

Conjecture 4.3 (Lang-Trotter). Let E/Q be an elliptic curve without complex

multiplication and let t be any integer. For x > 0, let E,t(x) be the number of

primes p  x such that ap(E) = t. Then, there exists a constant CE,t  0 such that



E,t(x)



CE,t

x log x

.

Denote by PEc (x) the set of primes p  x such that p / PE. The Lang-Trotter

conjecture predicts that



PEc

(x)



C

x log x

,

where, C = E,-1 + E,0 + E,1. Thus, the conjecture gives an exact order of growth for the number of primes at which µ = 0 is not known.

4.2. Next, we describe the variation of the -invariant, by invoking the Euler characteristic formula. Assume that E/Q is an elliptic curve such that the Mordell­Weil group E(K) and the Tate­Shafarevich group X(E/K) are finite. Equivalently, Selp (E/K) is finite and Selp (E/K) is cotorsion as a -module. Further, assume that N - is squarefree and divisible by an odd number of primes. By Lemma 3.3, the cohomology groups Hi(, Selp (E/K)) are finite and the Euler characteristic (, E[p]) := (, Selp (E/K)) is defined. By Proposition 3.6,
µp(E/K) = 0 and p(E/K) = 0  (, E[p]) = 1.

There is a formula for the Euler characteristic which may be interpreted as a p-
adic analogue of the Birch and Swinnerton-Dyer formula. The following discussion
applies to any elliptic curve E defined over K with good reduction at p. Denote by cv = cv(E) = [E(Kv) : E0(Kv)] the local Tamagawa factor at a finite prime v  p and c(vp) := |cv|p-1 be its p-part. Set  to be an invariant differential on E and v the N´eron differential at v. Denote by Reg(E/K) the regulator of E over K, i.e., the determinant of the canonical height pairing on E(K)/E(K)tors. Set DK to denote the absolute discriminant of K and r := rankZE(K). The Birch and Swinnerton-Dyer conjecture predicts that the order of vanishing of the Hasse­Weil
L-function L(E/K, s) at s = 1 is r. Further, it implies that X(E/K) is finite, and
on expanding L(E/K, s) at s = 1,

L(E/K, s) = ar(s - 1)r + ar+1(s - 1)r+1 + . . .

where the leading coefficient ar is given by

(4.1)

ar

=

#X(E/K) × Reg(E/K) × (E/K)

#E (K )tors

2

×

(DK

)

1 2

×

2

  ¯.
E(C)

10

J. HATLEY, D. KUNDU, AND A. RAY

Here, (E/K) denotes the product

(E/K) := cv
v

 v

.
v

As Lemma 3.4 shows, when r = 0, the Euler characteristic is related to the constant term of the characteristic element. Thus, the Iwasawa main conjecture predicts that it is related to the constant term of the p-adic L-function. Let kp be the residue
field of K at a prime p|p and E be the reduction of E at p. The following result is proved by extending the method in [13, chapter 3], in which the Euler characteristic formula for the cyclotomic Zp-extension is proved.

Theorem 4.4. Let E be an elliptic curve with good ordinary reduction at each prime above p in K. Assume that the following conditions are satisfied
(1) the Mordell­Weil group E(K) is finite, (2) X(E/K)[p] is finite. Then the Euler characteristic (, E[p]) is well-defined, and given by the formula

(4.2)

2

(, E[p])



#X(E/K)[p] × p|p #E(p) #E(K)[p] 2

·

c(vp)(E).

vSns \Sp

The set Sns is the set of primes which are finitely decomposed in K/K.

Proof. The result is due to J. van Order [48, Theorem 1.1], except that there is a slight inaccuracy in the Euler characteristic formula she provides. To prove Theorem 1.1 (in loc. cit.), the author requires Corollary 5.3 (in loc. cit ) which invokes an argument from [12, Lemma 3.3]. However, we note that this argument applies only for the GL2 extension and not for the anticyclotomic Zp-extension. In particular, when v is a prime of K not above p which is finitely decomposed in the anticyclotomic Zp-extension, the map
v : Jv(E/K)  Jv(E/K,v)

is surjective but not necessarily the zero map. Using the argument in [13, Lemma 3.4], one can show that ker v is finite of order c(vp). The same argument goes
through because this computation is purely local and for an -adic field (with
 = p), the cyclotomic and the anticyclotomic Zp-extensions are the same when
the latter is non-trivial. In particular, both give the maximal unramified Zp extension. Therefore, each prime v  Sns \ Sp contributes a factor of c(vp)(E) (instead of c(vp)(E) Lv(E, 1) p). The remainder of the proof of the (anticyclotomic) Euler characteristic formula can also be argued as in [13, Chapter 3] or [48].

We remark in passing that when rankZE(K) is positive, there is no known formula that generalizes (4.2) for the anticyclotomic Zp-extension. However, for the cyclotomic Zp-extension, the formula which applies in the higher rank setting is due to Perrin-Riou and Schneider, see [43, 44]. Note that in (4.2), #E(K)[p] = 1 when E,p : Gal(K/K)  GL2(Z/pZ) is irreducible, which is the case for all but a finite number of prime numbers p when E does not have complex multiplication.
At this point, we introduce some simplifying notation. Let p be a prime and K an imaginary quadratic field. Consider the various quantities in (4.2) and set
· Xp = Xp(E/K) := #X(E/K)[p].

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 11

· For p|p, set p = p(E/K) := #E(kp)[p], and p = p(E/K) := p|p p.
· For a finite prime v  p, set v = v(E/K) = c(vp) := |cv|-p 1, and for  = p,  = (E/K) := v| v.

The numbers Xp, p, and  are all of the form pN for some N  Z0. When

#E(K)[p] = 1, (4.2) simply becomes





(4.3)

(, E[p]) = 2p × Xp ×

v .

vSns \Sp

Recall that we have assumed the finiteness of the Tate­Shafarevich group X(E/K),
i.e., Xp = 1 for all but finitely many primes. Furthermore, for any prime v  p, c(vp) = 1 for all but finitely many primes p. However, it is possible for p = 1 for an infinite number of primes p. Such primes p for which p = 1 are known as anomalous. The following definition makes this notion precise.

Definition 4.5. Let E/Q be an elliptic curve. A prime p at which E has good
reduction and E(Fp)[p] = 0 is said to be a Q-anomalous prime. For K any number field and E/K an elliptic curve with good (ordinary) reduction at p, the prime p is called K-anomalous if E(kv)[p] = 0 for some prime v|p (with residue field kv).

Lemma 4.6. Suppose that K is an imaginary quadratic field and E/Q is an elliptic curve and p  7 be a prime. Set ap = 1+p-#E(Fp), there are two cases to consider.
(1) If p is ramified or split in K, then, E is K-anomalous if and only if ap = 1. (2) If p is inert in K, then, E is K-anomalous if and only if ap = ±1.

Proof. We consider the two cases separately. Case 1: First consider the case when p is ramified or split in K. In this case,
the residue field kv = Fp for each of the primes v|p of K. By the Hasse-bound, E is Q-anomalous if and only if #E(Fp) = p, i.e., ap = 1.
Case 2: On the other hand, suppose that p is inert in K. Then there is one prime v|p above p with kv = Fp2 . Let ,  be roots of X2 - apX + p. It follows from [46, Chapter 5, Theorem 2.3.1] that
#E(Fp2 ) = p2 + 1 - (2 + 2) = (p + 1)2 - a2p = (p + 1 - ap)(p + 1 + ap).
According to the Hasse-bound, p divides #E(Fp2 ) if and only if ap = ±1.

Let E(x) (resp. E,K (x)) be the number of primes p  x that are Q-anomalous

(resp. K-anomalous). The Lang-Trotter conjecture predicts that there are con-

stants 0  c  C such that for large enough values of x,



E (x) 



c

x log x

and 

c

x log x



E,K (x)



C

x log x

.

In this context, the best known unconditional bound follows from the result of V.

K. Murty (see [39])

E (x)



x(log log x)2 (log x)2

.

12

J. HATLEY, D. KUNDU, AND A. RAY

It is indeed possible for the constants c, C to be zero. In fact, there are curves for which the number of Q-anomalous primes is finite. Such curves are studied in greater detail in the next section.

Theorem 4.7. Let E/Q be an elliptic curve without complex multiplication and K be an imaginary quadratic field. Assume that rankZE(K) = 0 and X(E/K) is finite. Let M be the finite set of primes p such that
(1) E has good ordinary reduction at p, (2) E(K)[p] = 0, (3) Xp × vSns\Sp c(vp) = 1.
Let p / M be a prime such that E has good ordinary reduction at p. Then, the following assertions hold.
(1) If p is K-anomalous, then µp(E/K) > 0 or p(E/K) > 0 (or both). (2) If p is not K-anomalous, then Selp (E/K) = 0.

Proof. Assume throughout that E has good ordinary reduction at the prime p. Since the Selmer group Selp (E/K) is finite, it follows that Selp (E/K) is a
torsion -module, see [23, Corollary 4.9]. Furthermore, the Euler characteristic (, E[p]) is well defined and is given by the formula

(, E[p])  2p ×

Xp × vSns\Sp c(vp) #E(K)[p] 2

.

For p / M, we have that (, E[p]) = 2p.
Thus, the Euler characteristic (, E[p]) = 1 if and only if p is not K-anomalous. If p is K-anomalous, then Proposition 3.6 asserts that either µp(E/K) > 0
or p(E/K) > 0 (or both). On the other hand, if p is not K-anomalous, then, µp(E/K) = 0 and p(E/K) = 0. This implies that Selp (E/K) is finite. The result of Greenberg [24, Proposition 4.14] for the cyclotomic Zp-extension generalizes verbatim to our setting, to show that Selp (E/K) has no proper finite index submodules. Therefore, if it is finite, then it necessarily follows that Selp (E/K) = 0.

Corollary 4.8. Let E/Q be an elliptic curve and K be an imaginary quadratic field such that the conditions of Theorem 4.7 are satisfied. Let x > 0 and E(x) be the number of primes p  x satisfying the following conditions.

(1) E has good ordinary reduction at p, (2) p splits in K, (3) Selp (E/K) = 0.

Then,

E (x)



x(log log x)2 (log x)2

.

Proof. Theorem 4.7 asserts that if p is a prime for which the above conditions are satisfied, then p = 1, i.e., p is K-anomalous. Since p splits in K, we have that
p = 1 if and only if #E(Fp)[p] = 0, i.e., p is Q-anomalous. The result follows from the bound in [39] on the number of Q-anomalous primes p  x.

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 13

5. Ridgdill curves

The notion of a finitely anomalous elliptic curve is due to P. C. Ridgdill, see [42].

Definition 5.1. Let E/Q be an elliptic curve with finitely many Q-anomalous primes p, then we say E is Q-Ridgdill. Let K be an imaginary quadratic field.
If E has finitely many K-anomalous primes p, we say that E is K-Ridgdill.

Note that a K-Ridgdill curve is necessarily Q-Ridgdill. Indeed, if p splits or ramifies in K then the residue field is Fp and the assertion is obvious. When p is
inert in K, then the residue field is Fp2 ; one checks that if p|#E(Fp) then p|E(Fp2 ). The following is a corollary to Theorem 4.7.

Corollary 5.2. Let E/Q be an elliptic curve and K be an imaginary quadratic field so that the conditions of Theorem 4.7 are satisfied. Assume that E is Q-Ridgdill. Then, there are only finitely many primes p which split in K such that
(1) E has good ordinary reduction at p, (2) Selp (E/K) = 0.
Furthermore, if E is K-Ridgdill, then there are only finitely many primes p (split and inert in K) such that the above conditions are satisfied.

Let NE denote the conductor of E and N be some fixed positive integer. Ridgdill observes that if E is an elliptic curve such that the image of

E,N : Gal(Q/Q)  GL2(Z/N Z)
is contained in a subgroup H of GL2(Z/N Z) containing no element whose trace is 1, then all primes p  NEN are not anomalous. Hence, in this case, the elliptic curve E is finitely anomalous. The subgroups which do not contain any such element with trace 1 are classified, and elliptic curves whose mod-N representation is contained in these subgroups are classified.
It was first observed in [37, Lemma 8.18] that there are many examples of QRidgdill curves. We provide a (different) proof for the sake of completeness.

Proposition 5.3. Let E be an elliptic curve over Q such that E(Q)tors = 0. Then, E is Q-Ridgdill.

Proof. Let  be a prime such that E(Q)[] = 0 and let NE be the conductor of

E. Denote by  the mod- cyclotomic character. Since E(Q)[] = 0, the mod-

representation is of the form E, =

1 0 

. Let Frobp be the Frobenius at a

prime p  NE. We claim that p is not Q-anomalous. Indeed, we find that

1 + p - #E(Fp)  tr E(Frobp)  1 + (p) = 1 + p mod .

Therefore,  divides #E(Fp). Assume in addition to p  NE that p  7. It follows from the Hasse-bound that p|#E(Fp) if and only if #E(Fp) = p. Since |#E(Fp), we see that p is not K-anomalous. The only primes that can possibly be Q-anomalous are the primes dividing NE. Hence E is Q-Ridgdill.

In [38, Lemma A.5], B. Mazur­K. Rubin provided sufficient conditions for an elliptic curve to be K-Ridgdill. Here, we construct a different class of examples of K-Ridgdill curves.

14

J. HATLEY, D. KUNDU, AND A. RAY

Proposition5.4. Let E/Q be an elliptic curve with conductor NE and suppose that K = Q( -d) is an imaginary quadratic field. Assume that there is a prime  such that E(Q)[] = 0. Then E is K-Ridgdill in the following situations

(1)  = 2,



(2)  = 3 and K = Q( -3).

Furthermore, if either of the above conditions are satisfied and p  7 is a prime coprime to NEd, then, p is not K-anomalous.

Proof. Let p  7 be a prime which is coprime to NEd and assume that p is Kanomalous. Since p is unramified in K, there are only two cases to consider. Recall

that p is split in K if and only if

-d p

= 1.

Case 1 : First, consider the case when p is split in K. Let v|p be a prime of K.

In this case, the residue field kv of K at v is Fp. Let  denote the -adic cyclotomic character and  be its mod- reduction. Since E(Q)[] = 0, the argument from

the proof of Proposition 5.3 shows that  divides #E(Fp). Next, it follows from the Hasse bound that p|#E(Fp) if and only if #E(Fp) = p. This contradicts our earlier conclusion that |#E(Fp). Hence, p is not K-anomalous.
Case 2: Next, suppose p is inert in K and let v|p. The residue field kv = Fp2. We find that

1 + p2 - #E(Fp2 )  tr E(Frobv)  1 + (Frobv) = 1 + p2 mod .

Therefore,  divides #E(Fp2 ). Let ap = 1 + p - #E(Fp) and ,  be roots of X2 - apX + p. It follows from [46, Chapter 5, Theorem 2.3.1] that

#E(Fp2 ) = p2 + 1 - (2 + 2) = (p + 1)2 - a2p = (p + 1 - ap)(p + 1 + ap).

The same arguments (as in Case 1 ) show that  divides 1 + p - ap = #E(Fp).

Hence, #E(Fp) = p. By the Hasse-bound, we know that this implies p  #E(Fp) and consequently, p|p + 1 + ap. Another application of the Hasse bound shows that p = p + 1 + ap, i.e., ap = -1. Therefore p  -2 mod .
Suppose that  = 2. Since p is not even, it is not K-anomalous. Therefore, E is K-Ridgdill if E(Q)[2] = 0. Next consider the case when  = 3 and K = Q( -3).

We have that

-3 p

=

-1 p

3 p

=

(-1)

p-1 2

(-1)

p-1 2

3-1 2

p 3

=

p 3

=

-2 3

=

1 3

= 1.

However, we had assumed that p is inert in K. This shows that p is not Kanomalous. Therefore, E is K-Ridgdill.

6. Results for varying imaginary quadratic number field K: Vanishing of the µ-invariant

In this section, we fix an elliptic curve E defined over Q with conductor NE and an odd prime number p at which E has good ordinary reduction. Let d = p be a prime number and Kd := Q( -d). Denote by K d the anticyclotomic Zp-extension of Kd and recall that Selp (E/K d ) is the Selmer group over K d .

Definition 6.1. Let S be a subset of prime numbers. Define the density of S as

(S)

:=

lim
x

#{d

 x| (x)



S}

,

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 15

where (x) is the prime counting function.

As d varies over all prime numbers we study the following question

Question 6.2. What is the density of primes d such that Selp (E/K d ) is a torsion -module with µ-invariant equal to 0?

We do not make any assumption on the rank of E(Q) and prove estimates for how often Selp (E/K d ) satisfies the conditions (CR).
Theorem 6.3. Let E/Q be a fixed elliptic curve. Let p be odd prime number at which E has good ordinary reduction and set ap := 1 + p - #E(Fp). Additionally, assume that the following conditions are satisfied.
(i) The residual representation

E,p : Gal(Q/Q)  GL2(Fp)

is surjective.

(ii) There is a prime q dividing the conductor NE of E such that at least one of

the following conditions are satisfied

(a) q  ±1 mod p,

(b) ¯E,p is ramified at q. (iii) The conductor NE of E is squarefree, (iv) ap  ±1 mod p.

Let S be the set of primes d such that the conditions (CR) are satisfied for (E, p, Kd).

Let k be the number of primes q|NE such that both of the following conditions hold

(1) q  ±1 mod p,

(2) ¯E,p is unramified at q.

Then,

the

density

(S)

=

. 1
2k+1

In

particular,

the

proportion

of

primes

d

for

which

Selp (E/K d )

is

cotorsion

as

a

-module

with

µ-invariant

equal

to

zero

is

. 1
2k+1

Before commencing with the proof of the above result, we introduce some no-
tation. Let r1, . . . , rt be distinct prime numbers dividing NE. Denote this set of primes by (NE). Here, t = (NE) is the number of distinct prime factors of N . Enumerate this set as follows: for i  k, let ri be the primes for which both the conditions are satisfied

(1) ri  ±1 mod p, (2) ¯E,p is unramified at ri.

By assumption (ii) we have that k < (NE). Let d  NE be a prime number. Write

NE = NE+,dNE-,d, where split (resp. are inert) in

NKE+d,d=(rQes(p. -NdE-).,d

)

is

the

product

of

primes

dividing

ri

that

Let  be any subset of (NE ) and define  to be the set of primes d  NE such that the primes in  (resp. (NE) \ ) are inert (resp. split) in Kd. In other words,  consists of primes d such that the primes (NE) are unramified in Kd and NE-,d = q q. For x > 0, set (x) := #{d  x|d  }. Denote by  the density of , defined as follows



:=

()

=

lim
x

(x) (x)

.

The next result shows that the set of primes  is determined by residue classes modulo N . Let (Z/NEZ) denote the ring of units in Z/NEZ. Recall that (NE) =
i(ri - 1) is the cardinality of (Z/NE Z).

16

J. HATLEY, D. KUNDU, AND A. RAY

Lemma 6.4. There is a collection of residue classes r  (Z/NE Z) such that a prime d  NE is contained in  if and only if the reduction of -d modulo N is contained in r. Furthermore, the cardinality of r is given by

#r

=

(NE ) 2(NE )

.

Proof. The prime d  NE is contained in  if and only if -d is not a quadratic
residue modulo q for all primes q   and it is a quadratic residue modulo q for all primes q  (NE ) \ . The number of quadratic residues in (Z/qZ) is equal to the number of quadratic non-residues. For q   (resp. q / ) denote by rq  (Z/qZ) the set of quadratic non-residues (resp. residues). Define

r :=

rq 

(Z/qZ) = (Z/NEZ).

q(NE )

q(NE )

Note

that

d  

if

and

only

if

the

mod-N

reduction

-d¯ 

r.

Since

#rq

=

q-1 2

,

we have that

#r =

t

ri

-1 2

=

(NE 2(NE

)
)

.

i=1

We are now in a position to prove Theorem 6.3.

proof of Theorem 6.3. Recall that in order for (CR) to be satisfied, it is required

that NE-,d is a product of an odd number of primes and none of the primes ri for

i  k divide NE-,d. Let  be any subset of {rk+1, . . . , rt}. The set  consists

of the primes d such that NE-,d = q q. Let N be the collection of subsets

  {rk+1, . . . , rt} for which # is odd, and set S := N . The sets S and

S differ by a finite set of primes. Lemma 6.4 asserts that  is determined by

(NE ) 2(NE )

residue classes modulo

N.

Therefore, by Dirichlet's theorem, each residue

class

contributes

a

density

of

1 (NE

)

.

We

find

that



=

1 (NE) (NE ) 2(NE)

=

1 2(NE) .

Therefore, (S) =

. #N
2(NE )

It remains to calculate #N , i.e., the number of odd

subsets of {rk+1, . . . , r(NE)}. It follows from a standard exercise in elementary

combinatorics that #N = 2(NE)-k-1, see [47, Exercise 1.1.13]. The claim follows.

In fact, the set (S) can be computed explicitly in any specific example using mostly elementary methods. This is illustrated in the example below.
Example 6.5. Let E/Q be the curve with Cremona label 11a1, and let us take p = 7. In the notation of the theorem, we have
· N = 11 is squarefree · ¯E,p is surjective · ap(E) = -2  ±1 mod p · q = 11  ±1 mod p

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 17

Thus, the hypotheses of Theorem 6.3 are satisfied with k = 0, and so we conclude

that

(S)

=

1 2

.

In

particular,

since

N

=

11

is

prime,

we

have

S = {primes d | (E, p, Kd) satisfies (CR)}

= {primes d |11 is inert in Kd/Q}

=

primes d |

11 d

= -1

.

Some calculations with quadratic reciprocity and the Chinese Remainder Theorem show that

11 d

= -1  d  3, 13, 15, 17, 21, 23, 27, 29, 31, or 41

mod 44.

This description gives 10 possible congruence classes for d. We claim that this

agrees

with

our

calculation

(S) =

1 2

.

First

note

that

any

odd

prime

falls

into

an

odd congruence class modulo 44, cutting our space to 22 eligible congruence classes.

But a prime d cannot be congruent to 11 or 33 either, so the number of eligible

congruence classes for d is just 20, justifying our claim.

7. Results for varying imaginary quadratic number field K: the rank zero case

Let E/Q be a rank 0 elliptic curve of conductor NE without complex multiplica-

tion. We fix an odd prime d  NE be a prime number

number p and Kd =

at which Q( -d)

E has good ordinary reduction. be an imaginary quadratic field.

Let We

assume throughout that the Tate­Shafarevich group X(E/Kd) is finite.

Fix a pair (E, p) and let d vary over the primes coprime to NE. If the Mordell­ Weil rank of E(Kd) is zero, then Selp (E/Kd) is finite and the Euler characteristic d := (K d /Kd, E[p]) is defined. It satisfies the relation

d 

(pd)

2
×

X(pd) ×

 (d)
vSnds\Spd v

#E(Kd)[p] 2

,

where X(pd) = Xp(E/Kd), (vd) = v(E/Kd), and v(d) = c(vp)(E/Kd). Also, Snds is the set of primes of Kd that are finitely decomposed in K d and Spd consists of the primes of Kd above p. Since Selp (E/Kd) is finite in our setting, it follows from [23, Corollary 4.9] that the Selmer group Selp (E/K d ) is cotorsion as a -module. By Proposition 3.6, we know that d = 1 if and only if µ(pd) := µp(E/K d ) = 0 and (pd) := p(E/K d ) = 0. In this case, Selp (E/K d ) has finite cardinality and since it does not contain any proper finite index submodules, it must equal 0. As
d varies over all prime numbers we study the following question

Question 7.1. What is the density of primes d  NE such that rankZE(Kd) = 0 and the following equivalent conditions are satisfied.
(1) I(d) = 1 for each of the invariants
I(d)  {v(d), (pd), X(pd)},
(2) d = 1, (3) µ(pd) = 0, and (pd) = 0,

18

J. HATLEY, D. KUNDU, AND A. RAY

(4) Selp (E/K d ) = 0?

In this section, we analyze the variation of the invariants I(d) above as d ranges

over all primes. Denote by E,p(x), (resp. XE,p(x)) the number of primes d  x

such that the Tamagawa product E(d,)p :=

 (d)
vSnds\Spd v

(resp.

X(pd))

is

not

equal

to 1. We seek to understand the growth of the functions E,p(x) and XE,p(x) as

x  . Unlike the invariants v(d) and X(pd), the quantity p is a lot more well-

behaved. While there are many known results about Tamagawa products, there is

little known unconditionally regarding the function XE,p. However, we are able to provide numerical data with regards to the growth of this function.

Let us introduce the setting in which it is most convenient to apply this method

of analysis. Let Q be the cyclotomic Zp-extension of Q and Selp (E/Q) the pprimary Selmer group over Q. Since E(Q) is assumed to be finite, it follows from the work of V. Kolyvagin that that X(E/Q) is finite (see [31]). Thus, the Selmer

group Selp (E/Q) is finite and the associated Euler characteristic is defined. Let Q := Gal(Q/Q) and set

(Q, E[p]) :=  Q, Selp (E/Q) .

The Euler characteristic formula is given by (see [13, chapter 3]

(7.1)

(Q, E[p])



2p × Xp × #E(Q)[p


]


2

.

Here, p, Xp and  are as follows:
· p := #E(Fp)[p], · Xp := #X(E/Q)[p], ·  := c(p). The following conditions are known to be equivalent (see [32, Corollary 3.6])
(1) p = 1, Xp = 1, and  = 1 for all primes , (2) (Q, E[p]) = 1, (3) µ(E/Q) = 0 and (E/Q) = 0, (4) Selp (E/Q) = 0.
Arguments in loc. cit. show that it is reasonable to expect that the above conditions are satisfied for most elliptic curves of rank zero (when the prime p is reasonably large). We assume that these conditions are indeed satisfied.

7.1. Throughout, p  5 is fixed and suppressed in the notation. For a rational prime  = p, set (d) := v| v(d), where the product is taken for the primes v|. In this section, the goal is to study the variation of the Tamagawa numbers (d) as d varies over all primes. Recall the assumption that  = 1, i.e., p does not divide the Tamagawa number c. Also note that by [46, p. 448], c is divisible by p  5 precisely when the Kodaira type of E at  is In with p|n. Therefore, our assumption is equivalent to assuming that the Kodaira type of E at any prime  is not of the
type In for n divisible by p.

Theorem 7.2. Let E/Q be an elliptic curve with good ordinary reduction at a prime number p  5 and conductor NE. Let  = p be a prime such that |NE and  = 1. Then, the following assertions hold.
(1) If  = 2 then (d) = 1 for d = .

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 19
(2) If  = 2 then (d) = 1 for all primes d. Therefore, E,p(x)  (NE) for all values of x > 0.
Proof. Fix the prime , denote by Tbase the Kodaira symbol of E over Q. In [29], M. Kida studied the variation of the reduction type under a finite extension Kv/Q. For p  5, the Kodaira symbol of the base change E/Kv is determined by Tbase and the ramification index of Kv/Q, as we explain.
(1) First consider the case when  = 2. Let K := Kd as d varies over all primes. As we vary over all extensions Kv with v|, we read off the "new" Kodaira type Tnew from [29, Table 1, p. 556-7]. Recall that the ramification index of Kv/Q is either 1 (when unramified) or 2 (when totally ramified). Note that K/Q is a quadratic extension, hence if  ramifies in K, it must be tamely ramified. According to [29, Table 1, p. 556-7], upon base change from Q to Kv, the Tamagawa number cv can become divisible by by p in the following two cases: (a) If Tbase = In such that p|n. (b) If Tbase = In such that p|n and  is ramified in Kv. Our starting assumption was that  = 1. Equivalently, Tbase = In for p|n. Therefore, given an elliptic curve E with bad reduction at  = 2, p and Kodaira type In, we need to count the number of d's such that  ramifies in Kd. Since d is varies only over primes, there is exactly one such imaginary quadratic field, i.e., K = Q( -).
(2) Next, suppose that  = 2. If  is split in K = Kd, then Kv = Q, and as a result, (d) =  = 1. Hence, assume that  is either inert or ramified in K. When 2 is inert (hence unramified), [29, Table 1, p. 556-7] asserts that p|cv (for v|p) precisely when Tbase = In for some p|n. Our hypothesis rules out this case. When 2 ramifies (wildly), we refer to [29, Table 3, p. 559]. In this case, p|cv if and only if Tbase = In when p|n. However, our starting assumption guarantees that this does not happen. Therefore, given an elliptic curve E with bad reduction at  = 2 and Kodaira type not equal to In with p|n, we see that (d) = 1 for all primes d.
7.2. We fix a rank 0 elliptic curve E/Q and a prime p  5. Assume that the Selmer group Selp (E/Q) = 0. Varying over all primes d, we study how often does Selp (E/K d ) = 0. Throughout, we impose the following assumption.
Hypothesis 7.3. For each imaginary quadratic field Kd, the p-primary part of the Tate­Shafarevich group X(E/Kd) is finite.
We are only able to prove a partial result in this effect, which shows that the question is largely dependent on how often X(pd) = 1 as d varies over all primes.
Theorem 7.4. Let E/Q be an elliptic curve with conductor NE and assume the following.
(i) p  5. (ii) rankZE(Q) = 0. (iii) E(Q)[p] = 0. (iv) Write ap(E) := 1 + p - #E(Fp) and suppose that ap(E)  ±1 mod p. (v) The following equivalent conditions are satisfied:

20

J. HATLEY, D. KUNDU, AND A. RAY

(a) the µ and -invariants of Selp (E/Q) are zero, (b) Selp (E/Q) = 0. Let d  NE be a prime such that rankZE(Kd) = 0. Then, the following conditions are equivalent
(1) Selp (E/K d ) = 0, (2) X(E/Kd)[p] = 0.

Proof. Since rankZE(Q) = 0, it follows that X(E/Q) is finite and the Selmer group Selp (E/Q) has well-defined Euler characteristic (Q, E[p]). Since Selp (E/Q) = 0, it follows that (Q, E[p]) = 1. Therefore, according to (7.1) that Xp := #X(E/Q)[p] = 1 and  := c(p) = 1 for all primes  = p.
Recall that Selp (E/K d ) contains no proper finite-index -submodules; it is finite if and only if it is 0. Therefore, Proposition 3.6 asserts that Selp (E/K d ) = 0 if and only if its Euler characteristic d := (Kd , E[p]) is equal to 1. Since ap  ±1 mod p, it follows that p  #E(Fp2 ). According to Theorem 7.2, (d) = 1 for all primes . It follows from (4.2), that the following relation holds
d = #X(E/Kd)[p].
The result is now immediate.

Conjecturally, one can analytically determine whether X(E/Kd)[p] = 0 for any
specific example. More precisely [33], the Birch and Swinnerton-Dyer Conjecture gives a formula for #X(E/Kd) as in (4.1), the computation of which has been
implemented in Magma [9].
In Table 1, we present the results of this computation for a handful of elliptic
curves defined over Q with small, square-free conductor. The first column of the
table identifies an elliptic curve by its Cremona label. For each curve, we determined which primes 5  d  150 satisfied both (NE, d) = 1 and rankZE(Kd) = 0; this information is given in the second column of the table. For each such d, we used Magma to compute #X(E/Kd) as given by (4.1). The third column gives the number of d such that X(E/Kd)[p] = 0 for p = 2, and so on.
While this data is not enough to allow for any conjectures, we note that (assum-
ing BSD), the information in Table 1 and the conclusion of Theorem 7.4 suggest, for instance, that Selp (E/K d ) = 0 for E =11a1 and p  5.

8. Results for varying elliptic curves

In this section, we fix a prime p  5 and an imaginary quadratic field. Recall that K is the anticyclotomic Zp-extension of K and Q the cyclotomic Zpextension of Q. Set Q (resp. K ) to denote Gal(Q/Q) (resp. Gal(K/K)). We study the variation of Iwasawa invariants of the Selmer groups Selp (E/Q) and Selp (E/K) as E ranges over all elliptic curves (defined over Q) of rank zero (over K) with good ordinary reduction at the prime(s) above p. The results in this
section extend those in [32, §4]. Recall that any elliptic curve E/Q admits a unique Weierstrass equation

(8.1)

E : Y 2 = X3 + AX + B

where A, B are integers and gcd(A3, B2) is not divisible by any twelfth power. Since p  5, such an equation is minimal. We order elliptic curves by height and expect that similar results shall hold when they are ordered by conductor or

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 21

discriminant. Recall that the height of E satisfying the minimal equation (8.1) is given by H(E) := max |A|3 , B2 .
For x > 0, let E be the set of isomorphism classes of elliptic curves defined over Q, and E(x) the number of elliptic curves E defined over Q for which H(E)  x. If S is a subset of E, set S(x) = S  E(x). Recall the Euler characteristic formula for the cyclotomic Zp-extension from (7.1),

2

(Q, E[p])



#X(E/Q)[p] × #E(Fp) #E(Q)[p] 2

· c(p)(E/Q).


On the other hand, recall that the anticyclotomic Euler characteristic formula (4.2) states that

2

(K , E[p])



#X(E/K)[p] × p|p #E(p) #E(K)[p] 2

·

c(vp) (E /K ).

vSns \Sp

The key observation in this section is that to analyze the variation of the Euler characteristic (and hence µ and -invariants) of elliptic curves, it suffices to study the average behaviour of the following quantities for fixed p and varying E  E. We consider the following terms
· Xp(E/Q) := #X(E/Q)[p] and Xp(E/K) := #X(E/K)[p], · p(E/Q) :=  c(p)(E/Q) and p(E/K) := vSns\Sp c(vp)(E/K), · p(E/Q) := #E(Fp)[p], p(E/K) := p|p #E(kp)[p].

Definition 8.1. Let E1,F (x), E2,F (x), and E3,F (x) be the subset of elliptic curves in E(x) for which p divides Xp(E/F ), p(E/F ), and p(E/F ) respectively for F  {Q, K}.

Note that no assumptions are made on the rank of elliptic curves in E(x) or Ei,F (x).

Definition 8.2. For F  {Q, K}, let JF  E consist of the elliptic curves E with rankZE(F ) = 0 and with good ordinary reduction at the primes above p.

8.1. To motivate our results for the anticyclotomic Zp-extension K/K, we briefly recall similar analysis that has been over the cyclotomic Zp-extension of Q in [32, §4]. There are a few differences in notation, primarily because we only consider the
p-ordinary case here. However, the results in the p-supersingular case (over Q) are analogous and are contained in loc. cit.

Definition 8.3. Let ZQ  JQ be the subset of elliptic curves E for which the following equivalent conditions are satisfied.

(1) The Selmer group Selp (E/Q) has µ = 0 and  = 0, (2) The Selmer group Selp (E/Q) = 0, (3) The Euler characteristic (Q, E[p]) = 1.
Denote by ZQc its complement in JQ.

In

the

following

result,

we

give

an

upper

bound

for

lim

supx

#ZQc(x) #E (x)

depending

only on p. It is a direct consequence of the Euler characteristic formula (7.1).

22

J. HATLEY, D. KUNDU, AND A. RAY

Lemma 8.4. With respect to notation above, we have that

lim sup
x

#ZQc (x) #E (x)



3 i=1

lim sup
x

#Ei,Q(x) #E (x)

.

Proof. Since the Euler characteristic formula must be an integer, it follows from (7.1) that if Xp(E/Q), p(E/Q) and p(E/Q) are all 1, then, the Euler characteristic (Q, E[p]) = 1. By [32, Corollary 3.6], we know that
(Q, E[p]) = 1  Selp (E/Q) = 0,

and the result follows.

There are conjectural bounds due to Delaunay which predict that the quantity

lim supx

#E1,Q (x) #E (x)

becomes

really

small

as

p

becomes

large.

We

refer

the

reader

to

[18]

for

further

details.

In

[32],

explicit

bounds

are

obtained

for

lim supx

#Ei,Q (x) #E (x)

for i = 2, 3, which indicate that these quantities approach 0 quickly as p gets large.

Definition 8.5. For any prime , write ET (x) for the subset of E(x) consisting of elliptic curves with bad reduction at  and Kodaira type T .

The following result characterizes the density of EIn (x). Theorem 8.6. For any prime  = p and any integer n  1,

lim sup
x

#EIn (x) #E (x)



( - 1)2 n+2

.

Proof. The result follows from [17, Proposition 2.4] and [20, Lemma 1.1] (see also [17, remarks on p. 11]).

As a corollary, we obtain the following result.

Corollary 8.7. With notation as above,

(8.2)

lim sup
x

#E2,Q(x) #E (x)

=

=p

( - 1)2 2(p - 1)

<

=p

1 p

<

(p)

-

1,

where the sum is taken over primes .

Proof. By [46, p. 448], the Tamagawa number c(E) is divisible by p precisely when the Kodaira type of E/Q is of the form Im for some integer m  1 which is divisible by p. Therefore, one has the bound

lim sup
x

#E2,Q(x) #E (x)




lim sup
=p n=1 x

#EInp (x) #E (x)



=p

 n=1

( - 1)2 pn+2

=

(

- 1)2 2

·

p

1 -

1.

=p

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 23

Moreover,

(

- 1)2 2

·

1 p - 1

=

<

The result follows.

1

-

2 

+

1 2

1 p - 1

1

-

1 p

1 p - 1

=

1 p

.

Remark 8.8. We clarify that there is a minor inaccuracy in the formula in [32],
since there the sum is taken only for the Kodaira type Ip, when in fact it needs to be taken over all In where p|n. The above estimate (8.2) is the correct one.

For x > 0, denote by W(x) the set of Weierstrass equations for which the height is  x. For  = (a, b)  Fp × Fp with () := 4a3 + 27b2 non-zero, associate the elliptic curve E defined by the Weierstrass equation
E : Y 2 = X3 + aX + b.

Note that  is not uniquely determined by the isomorphism class of E. Denote by Sp the set of pairs  = (a, b)  Fp × Fp such that E contains a point of order p over Fp. Set d(p) := #Sp. Let W(x)  W(x) be the set of Weierstrass equations Y 2 = X3 + AX + B which reduce to E for some   Sp.

Theorem 8.9. With notation as above,

lim sup
x

#E3,Q(x) #E (x)



(10)

·

d(p) p2

.

Proof. See [32, Theorem 4.10].

Putting it all together, we obtain the following result.

Theorem 8.10. With notation as above,

lim sup
x

#ZQc (x) #E (x)

<

lim sup
x

#E1,Q(x) #E (x)

+

=p

1 p

+

(10)

·

d(p) p2

.

One

expects

that

the

first

term

E1,Q (x) E (x)

decreases

rapidly

as

p



,

as

is

explained

in the next section.

8.2. Let K be a fixed imaginary quadratic field and p  5 a fixed prime. Recall that K is the anticyclotomic Zp-extension of K. If E/Q is an elliptic curve for which rankZE(K) = 0 and X(E/K), is finite, the Selmer group Selp (E/K) is finite, and Selp (E/K) is cofinitely generated and cotorsion as a -module (see [23, Corollary 4.9]). We assume throughout that X(E/K) is finite for the elliptic curves considered.
Lemma 8.11. Let E/Q be an elliptic curve such that rankZE(K) = 0 and X(E/K) is finite, then the following conditions are equivalent.
(1) The Euler characteristic (K , E[p]) = 1. (2) The Selmer group Selp (E/K) has µ = 0 and  = 0. (3) The Selmer group Selp (E/K) has finite cardinality. (4) The Selmer group Selp (E/K) = 0.

24

J. HATLEY, D. KUNDU, AND A. RAY

Proof. The equivalence of conditions (1)-(3) follows from Proposition 3.6. Since the Selmer group Selp (E/K) does not contain any proper finite index submodules, it follows that it must equal 0. Hence, (3) is equivalent to (4).

Definition 8.12. Let ZK  JK be the subset of elliptic curves E/Q for which the equivalent conditions of Lemma 8.11 hold. Denote by ZKc its complement in JK .

It follows from the Euler characteristic formula (4.2) that

(8.3)

lim sup
x

#ZKc (x) #E (x)



3 i=1

lim sup
x

#Ei,K (x) #E (x)

.

We

prove

explicit

upper

bounds

for

the

quantities

lim supx

#Ei,K (x) #E (x)

for

i

=

2, 3.

We show these limits approach 0 as p  . After establishing these bounds,

we present Cohen­Lenstra heuristics for the variation of Tate­Shafarevich groups

which

give

us

a

good

idea

of

what

to

expect

for

lim supx

#E1,K (x) #E (x)

.

These

heuris-

tics also apply to Tate­Shafarevich groups over Q, thereby further improving on

the arguments in [32, §4].

We record the following well-known fact (see for example [10, pp.2132-2133]).

Fact 8.13. Let  = p be a prime. Then the primes of K above  are non-split in K if and only if  splits in K.

If v| and v  Sns\Sp, then the Kodaira type of E/Q is the same as that of E/Kv since Kv = Q. Hence, p divides cv(E) if and only if E/Q has Kodaira type Im, where p|m. Let sK be the set of primes  = p which split in K = Q( -d), i.e.,

 = p and

-d p

= 1. We make the following observation.

Lemma 8.14. With respect to prior notation,

lim sup
x

#E2,K (x) #E (x)




lim sup
sK n=1 x

#EInp (x) #E (x)

,

where EInp(x) is as in Definition 8.5.

Theorem 8.15. Let p  5 be a fixed prime. Let K be a fixed imaginary quadratic

field and sK the set of primes  = p that split in K. Then,

lim sup
x

#E2,K (x) #E (x)



sK

( - 1)2 2(p - 1)

<

sK

1 p

<

(p) - 1.

Proof. Combining Lemma 8.14 and Theorem 8.6, we obtain

lim sup
x

#E2,K (x) #E (x)

=

lim sup
x sK

n1

#EInp (x) #E (x)



( - 1)2 2(p - 1)

sK

<

1 p

sK

< (p) - 1.

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 25

Finally,

we

analyze

the

term

lim supx

#E3,K (x) #E (x)

.

There is a dichotomy that

arises depending on whether p is inert or non-inert in K. If p is non-inert in K,

the analysis is the same as in that in [32]. This is because in this case, the residue

field kv of K at any prime v|p is equal to Fp. However, if p is inert, there are some minor modifications since in this case, the residue field is Fp2 .

Lemma 8.16. Let E/Q be an elliptic curve and ap(E) := 1 + p - #E(Fp). Then, p
divides #E(Fp2) if and only if ap(E)  ±1 mod p, or equivalently, #E(Fp)  0, 2 mod p.

Proof. Arguing as in the proof of Lemma 4.6, we find that

#E(Fp2) = (p + 1 - ap)(p + 1 + ap), from which the result is immediate.

Denote by Tp the set of pairs  = (a, b)  Fp × Fp such that #E(Fp)  0, 2 mod p. Set
b(p) := #Tp if p is inert in K, #Sp otherwise.
The proof of the following result is identical to that of [32, Theorem 4.10].

Theorem 8.17. With notation as above,

lim sup
x

#E3,K (x) #E (x)



(10)

·

b(p) p2

.

Putting it all together, we obtain the following result.

Theorem 8.18. With notation as before,

lim sup
x

#ZKc (x) #E (x)

<

lim sup
x

#E1,K (x) #E (x)

+

sK

1 p

+

(10)

·

b(p) p2

.

In

the

next

section,

we

provide

heuristics

for

the

limits

lim supx

#E1,Q (x) #E (x)

and

lim supx

#E1,K (x) #E (x)

.

The approximate values of #Sp/p2 for the primes 7  p < 150, up to four

decimal places are noted in Table 2. One observes that they seem to be going to

0 as p gets large. Furthermore, explicit calculation indicates that #Tp = 2#Sp,

however it is not entirely clear to us why this is the case.

9. Cohen­Lenstra Heuristics for Tate­Shafarevich Groups
In [14], Cohen and Lenstra formulated heuristics for the variation of class groups of number fields. Delaunay extended their approach to formulate heuristics for Tate­Shafarevich groups for elliptic curves E/Q ordered by height, see [18]. These heuristics have been refined in [4] and this is the subject of much interest in arithmetic statistics of elliptic curves. In this section, we survey such heuristics and explain their consequences to our results in the previous section.
Let E denote the set of isomorphism classes of elliptic curves defined over Q with rank 0. For x > 0, set E (x) to be the subset of E consisting of E such that H(E)  x. Note that there are the following inclusions
JK  JQ  E  E.

26

J. HATLEY, D. KUNDU, AND A. RAY

Delaunay's heuristics apply to the set of elliptic curves E . It is reasonable to expect that the same heuristics should apply to JK or JQ, since the guiding principle is the same and independent of the extra conditions defining JF .
First we discuss the variation of X(E/Q) as E varies over E . For an elliptic curve E/Q, J. W. S. Cassels showed that there is a bilinear alternating pairing
X(E/Q) × X(E/Q)  Q/Z,

which is non-degenerate if X(E/Q) is finite. If E  E , i.e., rankZE(Q) = 0, then it is known that X(E/Q) is finite. This motivates the notion of a group of type-S.

Definition 9.1. Let G be a finite abelian group. We say that G is of type-S if there is a non-degenerate alternating pairing

 : G × G  Q/Z.

If G is a group of type-S, then the pairing  is unique. Two groups of type-S are isomorphic if there is an isomorphism which preserves the pairing. There is a neat description of such groups. If G is a group of type-S, it is easy to show that G  H × H for a finite abelian group. Conversely, if H is a finite abelian group and G  H × H, then there is a unique non-degenerate alternating pairing  : G × G  Q/Z. Given a finite abelian group G, set Gp to denote the p-torsion subgroup. The quantity rp(G) = dimFp (Gp) is known as the p-rank. Set Aut(G) to denote the group of automorphisms of G which preserve the pairing .
Let G denote the set of isomorphism classes of groups of type-S and consider a function F : G  C. There is a natural map

X:E G

which sends an elliptic curve E to its Tate­Shafarevich group. The following proportion is a measure of the function F  X on E on average

ME (F ) := lim
x

EE (x) F (X(E)) #E (x)

.

A priori it is not clear that this limit must exist. However, it is conjectured to exist in the cases of interest in this paper. We remark that the average in [18] is taken with respect to the conductor and not height It is expected that the same heuristics apply, regardless (see [4, footnote on p. 3]).
The key idea of Cohen and Lenstra is that class groups behave as random finite abelian groups G except that they have to be weighted by Aut(G) -1. The same should be true for Tate­Shafarevich groups of elliptic curves, where the average is taken over all groups of type-S. For n  Z1, let G (n) be the set of isomorphism classes of groups G  G with order equal to n. Following Delaunay [19, Definition 11], for   R1, define the following density associated to F , taken over G

MG (F, ) := lim
x

F (G)|G|
nx G (n) |Aut(G)| .
|G|
nx G (n) |Aut(G)|

This quantity is expected to be independent of  (as stated in loc. cit.) and a choice  = 1 is made. Write MG (F ) := MG (F, 1).

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 27

Heuristic 9.2 (Delaunay [19]). For all reasonable functions F : G  C, the limits ME (F ) and MG (F ) converge and
ME (F ) = MG (F ).

There is an analogous conjecture for elliptic curves E/Q of rank 1 and the heuristics in this setting are different. Since our results apply only to elliptic curves of rank 0, we do not further explain such heuristics here. We note that the distinction between rank 0 and 1 elliptic curves comes across clearly from the heuristics in [4].
Now we return our applications from the previous section. Consider the function

Fp-triv(G) :=

1 if Gp = 0, 0 otherwise.

On computing MG (Fp-triv), we have the following expectation.

Theorem 9.3 (Delaunay [18]). Assume that the Heuristic 9.2 is satisfied for the function F = Fp-triv. Then

lim
x

#{E



E

(x) | X(E/Q)[p] #E (x)

=

0}

=

f0(p),

where f0(p) is given by

f0(p) = 1 -
j=1

1

-

1 p2j-1

=

1 p

+

1 p3

-

1 p4

+

1 p5

-

1 p6

....

In particular, f0(2)  0.58, f0(3)  0.36 and f0(5)  0.21. These heuristics

cannot be checked via numerical computation since there are too many elliptic

curves and Tate­Shafarevich groups which appear for large heights. It is reasonable

to

expect

that

the

same

heuristics

should

apply

to

the

averages

lim

supx

#E1,Q (x) #E (x)

and

lim supx

#E1,K (x) #E (x)

.

First

note

that

lim sup
x

#E1,Q(x) #E (x)

=

lim sup
x

#{E



JQ(x) | X(E/Q)[p] #E (x)

=

0} .

The extra p-ordinary condition defining JQ as a subset of E should be independent of the heuristics for the variation of X(E/Q). However, since JQ is a subset of E , the above heuristics imply that

lim sup
x

#E1,Q(x) #E (x)



f0(p).

On the other hand,

lim sup
x

#E1,K (x) #E (x)

=

lim sup
x

#{E



JK (x) | X(E/K)[p] #E (x)

=

0} ,

and it is reasonable to expect that the groups X(E/K) should also obey the Cohen­

Lenstra

heuristics

over

JK .

Therefore,

we

expect

that

both

limits

limx

#E1,Q (x) #E (x)

and

limx

#E1,K (x) #E (x)

should exist and be  f0(p).

However, we are reluctant to

make this into a conjecture since these expectations cannot be verified numerically.

28

J. HATLEY, D. KUNDU, AND A. RAY

10. Tables

# disc. 2 3 5  7

# disc. 2 3 5  7

11a1 20 4 3 0 0

17a1 21 12 1 0 0

11a2 20 4 3 0 0

17a2 21 12 1 0 0

11a3 20 4 3 0 0

17a3 21 12 1 0 0

11a4 12 2 0 0 0

17a4 21 12 1 0 0

14a1 12 2 0 0 0

19a1 23 6 2 0 0

14a2 12 7 0 0 0

19a2 23 6 2 2 0

14a3 12 2 0 0 0

19a3 23 6 2 2 0

14a4 12 2 6 0 0

21a1 19 11 1 0 0

14a5 12 7 0 0 0

21a2 19 11 1 0 0

14a6 12 7 6 0 0

21a3 19 15 1 0 0

15a1 15 7 0 0 0

21a4 19 11 1 0 0

15a2 15 7 0 0 0

21a5 19 15 1 0 0

15a3 15 11 0 0 0

21a6 19 11 1 0 0

15a4 15 7 0 0 0

26a1 12

1 00 0

15a5 15 11 0 0 0

26a2 12

1 00 0

15a6 15 7 0 0 0

26a3 12 1 6 0 0

15a7 15 7 0 0 0

26b1 23 9 2 2 0

15a8 15 11 0 0 0

26b2 23 9 2 2 0

Table 1. Frequency of prime divisors of X(E/Kd) for varying

prime d

p #Sp/p2 p #Sp/p2 7 0.1224 71 0.0139 11 0.0826 73 0.0135 13 0.0710 79 0.0125 17 0.0554 83 0.0119 19 0.0499 89 0.0111 23 0.0416 97 0.0102 29 0.0333 101 0.0098 31 0.0312 103 0.0096 37 0.0263 107 0.0093 41 0.0238 109 0.0091 43 0.0227 113 0.0088 47 0.0208 127 0.0078 53 0.0185 131 0.0076 59 0.0167 137 0.0072 61 0.0161 139 0.0072 67 0.0147 149 0.0067 Table 2. Data for Sp for primes 7  p < 150.

STATISTICS FOR ANTICYCLOTOMIC IWASAWA INVARIANTS OF ELLIPTIC CURVES 29
References
[1] M. Adam and G. Malle. A class group heuristic based on the distribution of 1-eigenspaces in matrix groups. J. Number Theory, 149:225­235, 2015.
[2] M. Bertolini. Selmer groups and Heegner points in anticyclotomic Zp-extensions. Compos. Math., 99(2):153­182, 1995.
[3] M. Bertolini and H. Darmon. Iwasawa's main conjecture for elliptic curves over anticyclotomic Zp-extensions. Ann. Math., pages 1­64, 2005.
[4] M. Bhargava, D. M. Kane, H. W. Lenstra, B. Poonen, and E. Rains. Modeling the distribution of ranks, Selmer groups, and Shafarevich­Tate groups of elliptic curves. Cambridge J. Math., 3(3):275­321, 2015.
[5] M. Bhargava and A. Shankar. The average number of elements in the 4-Selmer groups of elliptic curves is 7. arXiv preprint arXiv:1312.7333, 2013.
[6] M. Bhargava and A. Shankar. The average size of the 5-Selmer group of elliptic curves is 6, and the average rank is less than 1. arXiv preprint arXiv:1312.7859, 2013.
[7] M. Bhargava and A. Shankar. Binary quartic forms having bounded invariants, and the boundedness of the average rank of elliptic curves. Ann. Math., pages 191­242, 2015.
[8] M. Bhargava and A. Shankar. Ternary cubic forms having bounded invariants, and the existence of a positive proportion of elliptic curves having rank 0. Ann. Math., pages 587­621, 2015.
[9] W. Bosma, J. Cannon, and C. Playoust. The Magma algebra system. I. The user language. J. Symbolic Comput., 24(3-4):235­265, 1997. Computational algebra and number theory (London, 1993).
[10] D. Brink. Prime decomposition in the anti-cyclotomic extension. Math. Comp., 76(260):2127­ 2138, 2007.
[11] F. Castella. p-adic heights of Heegner points and Beilinson-Flach elements. J. London Math. Soc., 6(1):1­23, 2017.
[12] J. Coates. Fragments of the GL2 Iwasawa theory of elliptic curves without complex multiplication. In Arithmetic theory of elliptic curves, pages 1­50. Springer, 1999.
[13] J. Coates and R. Sujatha. Galois cohomology of elliptic curves. Narosa, 2000. [14] H. Cohen and H. W. Lenstra. Heuristics on class groups of number fields. In Number Theory
Noordwijkerhout 1983, pages 33­62. Springer, 1984. [15] H. Cohen and J. Martinet. Heuristics on class groups: some good primes are not too good.
Mathematics of Computation, 63(207):329­334, 1994. [16] C. Cornut. Mazur's conjecture on higher Heegner points. Invent. Math., 148(3):495­523, 2002. [17] J. Cremona and M. Sadek. Local and global densities for Weierstrass models of elliptic curves.
arXiv preprint arXiv:2003.08454, 2020. [18] C. Delaunay. Heuristics on Tate-Shafarevitch groups of elliptic curves defined over Q. Exp.
Math., 10(2):191­196, 2001. [19] C. Delaunay. Heuristics on class groups and on Tate­Shafarevich groups: the magic of the
Cohen­Lenstra heuristics. Ranks of elliptic curves and random matrix theory, 341:323­340, 2007. [20] T. Ekedahl. An infinite version of the Chinese remainder theorem. Rikkyo Daigaku sugaku zasshi, 40(1):53­59, 1991. [21] E. Friedman and C. Lawrence. Washington, on the distribution of divisor class groups of curves over a finite field. Th´eorie des nombres, pages 227­239, 1989. [22] D. Garton. Random matrices, the Cohen­Lenstra heuristics, and roots of unity. Algebra & Number Theory, 9(1):149­171, 2015. [23] R. Greenberg. Introduction to Iwasawa theory for elliptic curves. Arithmetic algebraic geometry (Park City, UT, 1999). IAS/Park City Math. Ser, 9:407­464, 1999. [24] R. Greenberg. Iwasawa theory for elliptic curves. In Arithmetic theory of elliptic curves (Cetraro, 1997), volume 1716, pages 51­144. Springer, 1999. [25] R. Greenberg. Galois theory for the Selmer group of an abelian variety. Compos. Math., 136(3):255­297, 2003. [26] K. Iwasawa. On -extensions of algebraic number fields. Bull. Am. Math. Soc., 65(4):183­226, 1959. [27] K. Iwasawa. On the theory of cyclotomic fields. Ann. Math., pages 530­561, 1959.

30

J. HATLEY, D. KUNDU, AND A. RAY

[28] K. Kato. p-adic Hodge theory and values of zeta functions of modular forms. Ast´erisque, 295:117­290, 2004.
[29] M. Kida. Variation of the reduction type of elliptic curves under small base change with wild ramification. Central European J. Math., 1(4):510­560, 2003.
[30] C.-H. Kim, R. Pollack, and T. Weston. On the freeness of anticyclotomic Selmer groups of modular forms. Int. J. Number Theory, 13(06):1443­1455, 2017.
[31] V. A. Kolyvagin. Finiteness of and for a subclass of Weil curves. Mathematics of the USSRIzvestiya, 32(3):523, 1989.
[32] D. Kundu and A. Ray. Statistics for Iwasawa invariants of elliptic curves. Trans. Am. Math. Soc., accepted for publication (2021).
[33] T. LMFDB Collaboration. The L-functions and modular forms database. www.lmfdb.org/knowledge/show/ec.analytic_sha_order, 2021. [Online; accessed 2 June 2021].
[34] G. Malle. Cohen­Lenstra heuristic and roots of unity. J. Number Theory, 128(10):2823­2835, 2008.
[35] G. Malle. On the distribution of class groups of number fields. Exp. Math., 19(4):465­474, 2010.
[36] J. Martinet and H. Cohen. E´tude heuristique des groupes de classes des corps de nombres. J. reine. angew. Math., (404):39­76, 1990.
[37] B. Mazur. Rational points of abelian varieties with values in towers of number fields. Invent. Math., 18(3-4):183­266, 1972.
[38] B. Mazur and K. Rubin. Organizing the arithmetic of elliptic curves. Advances in Mathematics, 198(2):504­546, 2005.
[39] V. K. Murty. Modular forms and the Chebotarev density theorem II. London Mathematical Society Lecture Note Series, pages 287­308, 1997.
[40] J. Neukirch, A. Schmidt, and K. Wingberg. Cohomology of number fields, volume 323 of Graduate Texts in Mathematics. Springer, 2013.
[41] R. Pollack and T. Weston. On anticyclotomic µ-invariants of modular forms. Compos. Math., 147(5):1353­1381, 2011.
[42] P. C. Ridgdill. On the frequency of finitely anomalous elliptic curves. PhD thesis, University of Massachusetts Amherst, 2010.
[43] P. Schneider. p-adic height pairings I. Invent. Math., 69(3):401­409, 1982. [44] P. Schneider. p-adic height pairings II. Invent. Math., 79(2):329­374, 1985. [45] J.-P. Serre. Galois properties of finite order points of elliptic curves. Invent. Math., 15(4):259­
331, 1971. [46] J. H. Silverman. The arithmetic of elliptic curves, volume 106 of Graduate Texts in Mathe-
matics. Springer, 2009. [47] P. Sober´on. Problem-Solving methods in combinatorics. Springer, 2013. [48] J. van Order. On the dihedral Euler characteristics of Selmer groups of abelian varieties.
Arithmetic and Geometry, 420:458, 2015. [49] V. Vatsal. Uniform distribution of Heegner points. Invent. Math., 148(1):1­46, 2002. [50] V. Vatsal. Special values of anticyclotomic L-functions. Duke Math., 116(2):219­261, 2003. [51] L. C. Washington. Introduction to cyclotomic fields, volume 83 of Graduate Texts in Mathe-
matics. Springer, 1997. [52] S. L. Zerbes. Generalised Euler characteristics of Selmer groups. Proc. London Math. Soc.,
98(3):775­796, 2009.
(Hatley) Department of Mathematics, Union College, Bailey Hall 202, Schenectady, NY 12308, USA
Email address: hatleyj@union.edu
(Kundu) Department of Mathematics, University of British Columbia, Vancouver BC, Canada V6T 1Z2
Email address: dkundu@math.ubc.ca
(Ray) Department of Mathematics, University of British Columbia, Vancouver BC, Canada V6T 1Z2
Email address: anweshray@math.ubc.ca

