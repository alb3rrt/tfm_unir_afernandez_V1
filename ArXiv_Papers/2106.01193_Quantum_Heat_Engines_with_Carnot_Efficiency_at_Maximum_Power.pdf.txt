Quantum Heat Engines with Carnot Efficiency at Maximum Power
Mohit Lal Bera,1 Sergi Julià-Farré,1 Maciej Lewenstein,1, 2 and Manabendra Nath Bera3, 
1ICFO ­ Institut de Ciències Fotòniques, The Barcelona Institute of Science and Technology, ES-08860 Castelldefels, Spain 2ICREA, Pg. Lluis Companys 23, ES-08010 Barcelona, Spain
3Department of Physical Sciences, Indian Institute of Science Education and Research (IISER), Mohali, Punjab 140306, India
Conventional heat engines, be these classical or quantum, with higher power yield lesser efficiency and vice versa and respect various power-efficiency trade-off relations. Here we show that these relations are not fundamental. We introduce quantum heat engines that deliver maximum power with Carnot efficiency in the one-shot finite-size regime. These engines are composed of working systems with a finite number of quantum particles and are restricted to one-shot measurements. The engines operate in a one-step cycle by letting the working system simultaneously interact with hot and cold baths via semi-local thermal operations. By allowing quantum entanglement between its constituents and, thereby, a coherent transfer of heat from hot to cold baths, the engine implements the fastest possible reversible state transformation in each cycle, resulting in maximum power and Carnot efficiency. We propose a physically realizable engine using quantum optical systems.

arXiv:2106.01193v1 [quant-ph] 2 Jun 2021

I. INTRODUCTION
Since the beginning of the industrial revolution, heat engines have been playing pivotal roles in shaping modern technologies. One of the central laws of thermodynamics heat engines in the classical regime, that is, the second law, imposes a fundamental limit on maximum heat-to-work conversion efficiency in an engine, given by Carnot efficiency. This efficiency is only achieved when the engine operates in a cycle using reversible transformations, which requires it to run infinitely slowly. As a consequence, the engine's power - work extracted per unit time - becomes close to null. In general, the realistic engines operate in finite time to deliver a non-vanishing power, and then, the efficiency is compromised. The trade-off between efficiency and power is studied extensively in the past decades; see, for example, [1­3], in the context of finite-time classical engines.
In general the laws of classical thermodynamics cannot be applied in the quantum engines, where the working fluid is made up of few-level quantum systems, and the quantum effects cannot be ignored. There have been extensive studies to understand quantum thermodynamics, see for example [4­ 21]. It is revealed that a quantum system in contact with a thermal bath can produce fluctuating work. Consequently, a quantum engine, where a working fluid sequentially interacts with two baths, is expected to have fluctuations in both efficiency and power, see for example [22­47]. In particular, the quantum fluctuation and their effects in delimiting deterministic work and efficiency are studied in [25­30], and how these quantum effects may influence the power of an engine are explored in [31­36]. Further studies based on the geometry of work fluctuation and efficiency are made in [44] for microscopic heat engines. The fluctuation in power in finite-time heat engines is also considered in [35]. The inter-relation between power and efficiency in the presence of quantum fluctuation is studied in [37­46]. A universal trade-off between efficiency and power is introduced in [39]. A trade-off relation based on geometric arguments is derived in [43] for any
 mnbera@gmail.com

thermodynamically consistent microdynamics. As in classical engines, it is now commonly assumed that yielding maximum power at Carnot efficiency is impossible in a quantum engine. These studies have assumed engines with a working system interacting with the hot and cold baths at different stages of an engine cycle, where the working system is either composed of a statistically large number of particles or a few particles, allowing a large number of observations. The role of quantum fluctuations in delimiting efficiency or power or both becomes more prominent for the quantum engines operating in the one-shot finite-size regime, i.e., engines with a finite number of quantum particles constituting the working system and restricted to one-shot measurements or observations. So far, there are no comprehensive studies on that.
Here we introduced quantum heat engines operating in the one-shot finite-size regime and studied the power and efficiency of heat-to-work conversion. We show that these engines can simultaneously attain maximum efficiency, i.e., the Carnot efficiency, and maximum power in the one-shot finitesize regime. Therefore, there is no fundamental trade-off between power and efficiency that an engine has to respect in the quantum regime. Our approach is fundamentally different from the earlier ones in the sense that: (i) the engines are fully quantum as they operate in the one-shot finite-size regime and allow genuine entanglement between the baths and working system, (ii) the working system simultaneously interacts with the hot and cold baths via semi-local thermal operations, and (iii) the engines run in a one-step cycle. The framework relies on the resource theory recently developed to establish the thermodynamic laws in quantum heat engines [48]. The engines deliver maximum power, along with Carnot efficiency, purely because the engines allow a coherent transfer of heat from hot to cold baths by establishing quantum entanglement between the working system and the baths, thereby attaining maximum quantum speed for the reversible state transformation in each engine cycle. We have also introduced a physically realizable quantum heat engine based on a quantum-optical system.

2

II. ENGINE OPERATING IN ONE-STEP CYCLE

The engine, we consider, consists of two baths B1 and B1 with corresponding Hamiltonians HB1 and HB2 and inverse temperatures 1 and 2 respectively; a bipartite (working) system S 12 with non-interacting subsystems S 1 and S 2 and the Hamiltonian HS 12 = HS 1 + HS 2 ; a bipartite battery S WS12 with non-interacting subsystems S W1 and S W2 with the Hamiltonian HS W12 = HS W1 + HS W2 . Here the battery plays the role of a piston in a traditional engine that takes away work converted from heat. Throughout this work, we assume 1 < 2. All systems under consideration have Hamiltonians bounded from
below, with the lowest energy equal to zero. The baths are
considerably large as compared to the systems. That means
the energies of the working systems and the battery are tiny
compared to the baths, while the latter have the highest ener-
gies close to infinity. The properties of large baths are outlined
in Appendix.
The engine lets the baths interact with the working system
and the batteries via a global unitary evolution (U) where the
composite S 1S W1 semi-locally interacts with B1 and S 2S W2 with B2. As a result, a semi-local thermal operation (SLTO) is implemented on the system-battery composite S 12S W12 given by

Figure 1. One-step engine cycle. An engine consists of two baths B1 and B2 at inverse temperatures 1 and 2 (1 < 2), a working system S 12  S 1S 2 and a battery S W12  S W1 S W2 . In each one-step engine cycle, the composite S 1S W1 - S W2 S 2 semi-locally interact with the baths B1 - B2 and undergoes a transformation so that the working sub-systems S 1 and S 2 swaps their states along with Hamiltonians (as indicated by the arrows) and the battery sub-systems update their
states. As a result, there is an overall flow of heat from B1 to B2 and, in this process, part of that heat is converted into work and stored
in S W1 S W2 . At the end of each cycle, the state of S 1S 2 becomes identical to its initial state and is, again, reused in the next cycles.
See text for more details.

    S 12S W12 S 12

S W12

= Tr B1B2 U(B1  B2  S 12  S W12 )U , (1)

where the global unitary U satisfies

U, HB1 + HS 1 + HS W1 + HB2 + HS 2 + HS W2 = 0,

(2)

U, 1 (HB1 + HS 1 + HS W1 ) + 2 (HB2 + HS 2 + HS W2 ) = 0. (3)

Here the baths are in the equilibrium states denoted by Bx =

e-x HBx Tr [e-x HBx ]

for

x

=

1, 2,

and

S 12

is

any

state

of

S 12.

The

S W12

is the state of the battery S W12 , where the subsystems S W1 and

S W2 always remain in their energy eigenstates and store or

supply energy (in the form of work). The commutation rela-

tion (2) guarantees strict conservation of total energy of baths-

system-battery composite. Note, this ensures conservation of

all moments of energy and not just the average energy. The

relation (2), in turn, represents the quantum version of first

law for engines. The second commutation relation (3) sig-

nifies strict conservation weighted-energy and it also ensures

strict conservation of total entropy while there are exchanges

in energy among B1S 1S W1 and B2S 2S W2 composites (see Appendix).

In an engine operating in cycles, the system S 12 mediates the heat transfer from B1 to B2, while a part of that is converted into work and stored in the battery S W12 . At the end of each cycle, the S 12 should recover its initial state so it can be reused for the next cycle. But the battery gets excited to

a higher energy eigenstate to store work. Interestingly, the

engine executes this transformation in a one-step cycle (see

Figure 1) by implementing semi-local thermal operations on

S 12S W12 , as

S 12  iS W12 , HS 12 + HS W12  S 12  Sf W12 , HS 12 + HS W12 .

Consequently, the state of the working system transforms as

S as


12
HS 12

S =

and at the

12
HS 1

+

HS 2

same time  HS 12 =

the HS

Hamiltonian is modified 1 + HS 2 . Further, it sat-

isfies HS 2 ,

the cyclicity and HS 2 =

conditions S 12 HS 1 , where the

= US 1S 2 S 12 unitary US 1S 2

, HS 1 = swaps the

states of the subsystems S 1 and S 2. The battery undergoes the

transformation

i
S W12



f
S W12

without updating its Hamilto-

nian.

To understand how the above transformation executes the

(four-step) Carnot cycle in one-step, let us focus on the trans-

formation happening in the system, that is (S 12 , HS 12 )  (S 12 , HS 12 ). For this purpose, we ignore the battery as it only changes states without updating its Hamiltonians and

thereby stores or releases work. Consider, S 12 =    and HS 12 = H + H , where H and H are the Hamiltonians of the subsystems S 1 and S 2 respectively. Then the (one-step) en-
gine operation leads to

(  , H + H )  (  , H + H).

(4)

This involves two simultaneous sub-transformations. One is (, H)  (, H ) via a semi-local interaction with B1, which can be understood as the combination of an isothermal (, H)  (, H) and then an adiabatic (, H)  (, H ) transformations. The other sub-transformation (, H )  (, H) takes place in semi-local interaction with the bath
B2, which again can be understood as the combination of an isothermal (, H )  (, H ) and then an adiabatic

3
(, H )  (, H) transformations. Clearly, this mimics the situation of a Carnot engine where one working system initially in (, H) undergoes two isothermal (in interaction with two different baths) and two adiabatic transformations, but in one-step (see [48] for more details).

III. MAXIMUM POWER WITH CARNOT EFFICIENCY

Not only that the engines can execute the Carnot cycle in
one step, but also they are superior to conventional heat engines in efficiency and power. Most importantly, these engines can deliver maximum power with Carnot efficiency. Note, to attain maximum power and efficiency simultaneously, the engine has to undergo the fastest possible thermodynamically
reversible transformation in each cycle, which we are going
to demonstrate below.
We consider the working subsystems S 1 and S 2 are to be qubits with the Hamiltonians HS 1 = a|1 1|S 1 and HS 1 = a|1 1|S 2 respectively having identical energy spacing. We also assume, without loss of generality, that the battery subsysitEmeWmu1sm|1Sh1We|1aStWa-1ntoda-nwSdoWHr2kSacWro2en=qvueErbsWiitos2 |n1weiffi1th|ScWtihe2 nerceHyspapmeecritli(tvooennleiya-.nstTsehpHe)ScmWy1acxl=eis attained by implementing a thermodynamically reversible
state transformation in S 1S 2S W1 S W2 composite

|0, 1, 0, 0 S 1S 2S W1 S W2  |1, 0, 1, 1 , S 1S 2S W1 S W2

(5)

using a semi-local thermal operation [48], where the subsys-
tems S 1 and S 2 swap their states without changing the Hamiltonians, and the batteries S W1 and S W2 get excited. Here we denote |i, j, k, l S 1S 2S W1 S W2 = |i S 1  | j S 2  |k S W1  |l S W2 .
For simplicity, we may consider the working system and the
battery to be the parts of single system S  S 1S 2S W1 S W2 with the Hamiltonian HS = a0|0 0|S + a1|1 1|S , where a0 = a and a1 = a + EW1 + EW2 with the corresponding energy eigenstates |0 S = |0, 1, 0, 0 S 1S 2S W1 S W2 and |1 S = |1, 0, 1, 1 . S 1S 2S W1 S W2 Then, the engine becomes compact and has three constituents;
hot and cold baths (B1 and B2) and a two-level system (S ). The engine cycle starts with the initial state |0 S and ends with the final state |1 S of S (as shown in Figure 2). The corresponding global transformation, leading to this one-step
cycle, is

B1  B2  |0 0|S -U B1B2  |1 1|S ,

(6)

where B1B2 is final state of the baths. The unitary U strictly conserves energy of B1B2S composite and weighted-energy of B1B2 composite, i.e.,

U, HB1 + HB2 + HS = 0,

(7)

U, 1HB1 + 2HB2 = 0.

(8)

See Appendix for more details. Note, the semi-local nature of the evolution is clearly understood here as the system S is simultaneously interacting with both the baths via the unitary U.

Figure 2. A compact engine. An engine consists of two baths B1 and B2 at inverse temperatures 1 and 2 respectively, and a working system S . The system S simultaneously interacts with both the baths via a semi-local thermal operation. The engine operates in a one-step cycle by exciting the system S from lower energy to a higher energy eigenstate. See text for more details.

Now we show that the unitary U, that satisfies relations (7) and (8), leading to the transformation (6) indeed attains Carnot efficiency. Then we consider constructing a driving Hamiltonian, corresponding to the unitary U, that delivers maximum power with Carnot efficiency.
Since the initial (and final) state of S is an energy eigenstate, the global initial state of B1B2S can be expressed in the block-diagonal form with respect to total energies, as

B1  B2  |0 0|S =

[B1  B2 ]EB12  |0 0|S , (9)

EB12 +a0

with EB12 = EB1 + EB2 , where EB1 and EB2 are the energies corresponding to the baths B1 and B2 respectively, and

d1(EB1 )d2(EB2 )

[B1  B2 ]EB12 = p(EB12 )

|EB12 (i) EB12 (i)|,

i=1

where d1(EB1 ) and d2(EB2 ) represent the degeneracies corresponding to the bath energies EB1 and EB2 respectively and p(EB12 ) = e-1EB1 -2EB2 /ZB1 ZB2 . A strictly total energy conserving unitary also takes a block-diagonal form, U =
EB12+a0 U , EB12+a0 where the unitary UEB12+a0 operates only on the block with the total energy EB12 + a0 and implements a transformation

[B1  B2 ]EB12  |0 0|S  [B1  B2 ]EB12  |1 1|S , (10)
where EB12 = EB1 +EB2 . Note, EB12 +a0 = EB12 +a1 as required by the total energy conservation. The strict conservation of total weighted-energy of the baths ensures

1(EB1 - EB1 ) + 2(EB2 - EB2 ) = 1Q1 + 2Q2 = 0, (11)
where Q1 and Q2 are the heat flow out of the baths B1 and B2 respectively. The (11) is nothing but the Clausius equality. This in turn ensures the thermodynamic reversibility of the state transformation. Note, this condition also implies d1(EB1 )d2(EB2 ) = d1(EB1 )d2(EB2 ), where d1(EB1 ) and d2(EB2 ) are degeneracies in the energies corresponding to EB1 and EB2 of the baths B1 and B2 respectively (see Appendix for more details). It is an essential requirement for a unitary transformation where the rank and the spectra of the (un-normalized) state of each total energy block remain unchanged.

4

Similar transformations, as in Eq. (10), also take place in all
other total energy blocks due to the evolution by the unitary U.
As a result, the desired state transformation, given in Eq. (6),
is achieved and thereby completes the one-step engine cycle. The extracted work per cycle is given by Wext = a1 - a0 = Q1 + Q2 as a consequence of strict conservation of total energy. Hence, the heat-to-work conversion efficiency becomes maximum in the one-shot finite-size regime, given by



=

Wext Q1

=

1-

1 , 2

(12)

which is the Carnot efficiency, as expected for any reversible engine cycle.
Let us demonstrate how the global unitary U can be implemented using an interaction Hamiltonian

Hin =

d1(EB1 )d2(EB2 )

g

|EB12 (i), 1 EB12 (i), 0|B1B2S + h.c.,

EB12 +a0

i=1

where, |EB1 (i),

again, EB2 (i)

,

|EB12 (i) and g is

a

 |EB1 (i), EB2 (i) and |EB12 constant. The global unitary

(i)  is then

U(t) = e-itHin/ for any time t. Under this unitary, an initial

state |EB1 (i), EB2 (i), 0 B1B2S in the total energy block evolves to |(t) = U(t)|EB1 (i), EB2 (i), 0 B1B2S at time t, where

|(t) = cos(gt) |EB1 (i), EB2 (i), 0 B1B2S - i sin(gt) |EB1 (i), EB2 (i), 1 B1B2S , (13)

which is a genuinely entangled state of B1, B2, and S for gt z/2 with z  Z. The desired final state is attained at time  = /(2g). It is important to highlight that the above en-
gine evolution enables a coherent heat transfer from B1 to B2, which is fundamentally different from conventional engines,
which happens due to entanglement in the intermediate time.
Similar evolution takes place in every total energy block, and the overall transformation (6) is attained at time . With this, the engine extracts Wext work in  time. Thus, the power delivered by the engine, i.e., work extraction per unit time, is

P

=

Wext 

=

2Wext . 

(14)

Contrary to the traditional understanding, the reversible

(one-step) engine cycle via semi-local thermal operation re-

quires finite time. Not only that, as we argue below, the in-

teraction Hamiltonian Hin drives the evolution with the max-

imum attainable speed to result in the shortest possible trans-

formation time. The speed of evolution is defined by the dis-

tance traversed by a system per unit time in its quantum state

space [49]. For pure states, the distance is measured using

Fubini-Study

metric,

given

by

s

=

1 2

(1

-

|

|

|2)

for

any

two

states | and | . The speed of evolution of the state |(t) is

v = ds = Hin = g,

(15)

dt

where ds

=

1 2

(1

-

|

(t)|(t + dt)

|2) and energy uncertainty

Hin = (t)|Hi2n|(t) - (t)|Hin|(t) 2. Note, the speed of

Figure 3. Geodesic trajectory of evolution. Evolution of states on a quantum state space (the gray area). An initial state |(0) at time t = 0 is evolved to |(t) at time t = t. There are infinitely many paths connecting the states. One with the shortest path is called the geodesic path (solid (blue) line). Any other path (dotted (blue) line) is longer than the geodesic one.

evolution v is same for every total energy block and, hence, for the overall transformation. The uncertainty Hin is independent of time and has the maximum possible value, equals to g for any driving Hamiltonian bounded by the operator norm g. Furthermore, the interaction Hamiltonian Hin drives the evolution following a geodesic trajectory [49] connecting the initial and the final state which represents the shortest path (see Figure 3). The evolution following shortest path with maximum speed results in the minimum required time to complete the transformation in the one-step engine cycle. As a consequence, the power P in Eq. (14) is the maximum possible one.

IV. A QUANTUM OPTICS BASED HEAT ENGINE

Here we discuss a physically realizable quantum heat en-

gine transferring maximum power with Carnot efficiency fol-

lowing the theoretical framework presented above. We pro-

pose an engine composed of two thermal cavities and a three-

level working system (see Figure 4). The bath B1 is a singlemode optical cavity with a Hamiltonian HB1 = 1a1a1 =
n n1|n n|B1 , at inverse temperature 1. Here a1 and a1 are the creation and annihilation operators of the mode in B1 respectively, 1 represents the mode frequency, and n and |n
are the number of excitation and the corresponding number

state. Similarly, the bath B2 at inverse temperature 2 is an-

other optical cavity with a Hamiltonian HB1 = 2a2a2 =

m m2|m m|B2 . The system S is a three-level atom (in -

configuration) with the Hamiltonian HS =

3 i=1

Ei|i

i|S

with

E1 = 0. The overall Hamiltonian of the baths and the system

composite is then H0 = HB1 + HB2 + HS .

A semi-local thermal operation, leading to a one-step cycle,

is implemented by introducing an intensity-dependent cou-

pling between the bath modes and the atom by the interaction

Hamiltonian

HI = f1(N1)+ f2(N2) + g11(N1)(a131 + h.c.)

+ g22(N2)(a232 + h.c.),

(16)

5

Figure 4. An optical-cavity based quantum heat engine. (a) A
three-level quantum system S (i.e., working system) is placed in
three overlapping optical cavities. Thermal cavities with frequencies 1 and 2 at inverse temperatures 1 and 2 (1 < 2) represent the baths B1 and B2 respectively. The cavity with frequency 0 is in resonance with the transition between the ground state and the
first excited state of the system. (b) The three-level system S simul-
taneously interacts with baths B1 and B2 via two-mode amplitudedependent coupling. In each engine cycle, it absorbs a photon with energy 1 from B1 and emits a photon with 2 energy to the bath B2 and excites itself from energy E1 to E2. The system then emits a photon with energy 0 via stimulated emission in a cavity (green) in resonance with the transition. See text for more details.

with the number operator Nk = akak corresponds to the bath Bk for k = 1, 2, and i j = |i j|S (i j) is the transition operator from | j S to |i S for i, j = 1, 2, 3. The f1(N1) and f2(N2) are some intensity-dependent potentials in the cavity fields.
The state |3 S is coupled with |1 S and |2 S via intensitydependent dipole-couplings g1(N1) and g2(N2) respectively, where (N1) and (N2) are some functions of the number operators, and g1 and g2 are some constants. There is no direct coupling between |1 S and |2 S . The technical details of how the interaction Hamiltonian (16) may be realized are described
in Appendix. With the choice of (identical) detuning  = (E3 -Ek)/ -k
and the couplings

g2k 

k2

(Nk

)

=

fk(Nk)

=

g2k 

Nk-1

,

(17)

for k = 1, 2. The above formula should be fulfilled pos-

sibly exactly for large values of Nk, especially if we work

at relatively high temperatures. It has to be regularized, ob-

viously, for Nk = 0 to avoid the singularity. Nevertheless, with these choices, the three-level problem can be exactly

reduced to a two-level problem irrespective of whether the

detuning  is small or large, similar to what is shown in

[50, 51]. Then, the corresponding two-level Hamiltonian be-

comes HS

=

1 2

0(|2

2| - |1

1|), and the interaction Hamil-

tonian, after rotating-wave approximation, transforms to

HI = g(A1A212 + A1A221),

(18)

where Ak = akNk-1/2 and g = g1g2/ is a constant. Here 0  1-2, i.e., the pump mode with 1 and Stokes mode with 2
are in two-mode resonance with the states |1 S and |2 S . The 1 and 2 are chosen so that 11 = 22. Then, the unitary U(t) = exp[-itHI/ ] generated by HI strictly conserves total energy of baths and system, and total weighted-energy of the

baths alone, as [U(t), HS + HB1 + HB2 ] = 0 and [U(t), 1HB1 + 2HB2 ] = 0 respectively for all time t.
The initial state of the composite B1B2S can now be expressed in blocks classified by (n, m), as

B1  B2  |1 1|S =

pnm |n, m, 1 n, m, 1|B1B2S ,

n,m

with pnm = exp[-1nEB1 - 2mEB2 ]/ZB1 ZB2 , where ZB1 and ZB2 are the partition functions of the baths B1 and B2 respectively. Due to the constraints on strict total energy conser-
vation, the U(t) operates on each block (n, m) independently.
For a block (n, m), the initial state |n, m, 1 B1B2S evolves to |(t) = U(t)|n, m, 1 B1B2S at some time t, and it is given by

|(t) = cos(gt) |n, m, 1 B1B2S - i sin(gt) |n - 1, m + 1, 2 B1B2S , (19)

which is an entangle state. This is true for all blocks (n, m), except the blocks (0, m). Note, the time taken to evolve the
initial state to the desired final states are same for all blocks except (0, m), and that is  = /(2g). As a consequence, the joint initial state of B1B2S evolves to Bf 1B2S = U(t)(B1  B2  |0 0|S )U(t), and at time  = /(2g), the final state of the system S becomes,

Sf

=

Tr B1 B2

Bf 1 B2S

=

1 |1
ZB1

1|S +

1 1-
ZB1

|2 2|S  |2 2|S

for ZB1  , which is true for low inverse temperature 1 of bath B1, or |B1|  . In each cycle, the the system S undergoes the transformation |1 S  |2 S and thereby extracts 0 amount of work with the Carnot efficiency  = 1 - 1/2. The transformation takes place with the maximum quantum
speed following a geodesic trajectory and time requires for that is  = /(2g). Hence, the cycle delivers maximum power P = 2g0/. The work is extracted in the form of photons at 0 by placing the atom in a resonant cavity and letting the stimulated emission |2 S  |1 S (see Fig. 4).
It is worth mentioning that there have been several propo-
sitions of quantum heat engines based on optical cavity or
bosonic baths earlier, for example in [52, 53], where a quantum system interacts with two bosonic thermal baths at different temperatures. However, in contrast to the engines consid-
ered above, these engines only allow incoherent heat transfer
from hot to cold baths. They do not guarantee strict conserva-
tion of total energy in order to characterize the energetics cor-
rectly. Because of that, they cannot deliver maximum power with Carnot efficiency.

V. CONCLUSIONS
For finite-time classical engines, it is known that the maximum power at maximum heat-to-work conversion efficiency is impossible [1]. For quantum engines, where the working systems interacting with the baths are quantum mechanical, the situation is quite different because the quantum uncertainties present in the system further delimit the extractable

6

work in each cycle. For finite-time quantum heat engines considered earlier, there are various trade-off relations between power and efficiency [39, 43], and both of these quantities cannot be maximized simultaneously. So far, there are two kinds of quantum engines that have been considered in the literature. In the first kind, the working systems are often composed of a large number of quantum particles. In the second kind, the working system comprises few quantum particles but is allowed to be observed or measured repeatedly for an arbitrarily large number of times. However, the working system interacts with the hot and cold baths in different steps in both kinds. Hence the heat flow from the hot to the cold baths is not continuous; rather, it occurs in different steps or in an incoherent manner. And, possibly because of this feature of the engines, power and efficiency satisfy trade-off relations and cannot be maximized simultaneously.
The quantum engines considered here can deliver maximum power with maximum efficiency and are fundamentally different from conventional ones studied earlier. Firstly, the engine operates in the one-shot finite-size regime, where the working system is genuinely quantum in the sense that it is made up of a small number of quantum particles (i.e., of finite-size) and allows one or few observations or measurements (i.e., one-shot measurement). Secondly, the working system interacts with both hot and cold baths simultaneously via a semi-local thermal operation. These operations are powerful compared to the operations in traditional engines as they can implement a one-step engine cycle and create entanglement between the baths and the working system. Because of that, it enables a coherent flow of heat from hot to cold bath via the working system and results in maximum power with maximum efficiency. With this, our results have demonstrated that there, in principle, does not exist a fundamental trade-off relation between power and efficiency. We have also put forward an experimentally feasible quantum heat engine operating in the one-shot finite-size regime with a three-level atom as a working system and two thermal optical cavities as the baths. We have explicitly introduced an intensity-dependent interaction between the atom and cavities that executes the one-step engine cycle yielding maximum

power at Carnot efficiency.
In summary:
· We have introduced quantum heat engines that operate via one-step cycles in the one-shot finite-size regime and enable a coherent heat transfer from hot to cold baths by establishing genuine quantum entanglement between the working system and the baths.
· We have demonstrated that there is no fundamental trade-off relation between power and efficiency.
· We have shown a general protocol with which a quantum heat engine can deliver maximum power with Carnot efficiency in the one-shot finite-size regime.
· We have proposed a physically realizable model of such a quantum heat engine based on an atom-cavity system.
· Our work opens up avenues for an improved theoretical understanding of thermodynamics in the quantum regime and new possibilities for quantum-enabled technologies using heat engines.
Acknowledgments ­ M.L.B., S.J.-F., and M.L. thankfully acknowledge support from ERC AdG NOQIA, Agencia Estatal de Investigación ("Severo Ochoa" Center of Excellence CEX2019-000910-S, Plan National FIDEUA PID2019106901GB-I00/10.13039/501100011033, FPI), Fundació Privada Cellex, Fundació Mir-Puig, and from Generalitat de Catalunya (AGAUR Grant No. 2017 SGR 1341, CERCA program, QuantumCAT_U16-011424, co-funded by ERDF Operational Program of Catalonia 2014-2020), MINECOEU QUANTERA MAQS (funded by State Research Agency (AEI) PCI2019-111828-2/10.13039/501100011033), EU Horizon 2020 FET-OPEN OPTOLogic (Grant No 899794), and the National Science Centre, Poland-Symfonia Grant No. 2016/20/W/ST4/00314. M.N.B. gratefully acknowledges financial supports from SERB-DST (CRG/2019/002199), Government of India.

[1] F. L. Curzon and B. Ahlborn, "Efficiency of a carnot engine at maximum power output," American Journal of Physics 43, 22­24 (1975).
[2] R. S. Berry, V. Kazakov, S. Sieniutycz, Z. Szwast, and A. M. Tsirlin, Thermodynamic Optimization of Finite-Time Processes (Wiley, 2000).
[3] P. Salamon, J. D. Nulton, G. Siragusa, T. R. Andersen, and A. Limon, "Principles of control thermodynamics," Energy 26, 307 ­ 319 (2001).
[4] Felix Binder, Luis A. Correa, Christian Gogolin, Janet Anders, and Gerardo Adesso, Thermodynamics in the Quantum Regime, Vol. 195 (Springer International Publishing, 2018).
[5] C. Jarzynski, "Nonequilibrium equality for free energy differences," Phys. Rev. Lett. 78, 2690­2693 (1997).
[6] Gavin E. Crooks, "Entropy production fluctuation theorem and the nonequilibrium work relation for free energy differences,"

Phys. Rev. E 60, 2721­2726 (1999). [7] Michele Campisi, Peter Hänggi, and Peter Talkner, "Collo-
quium: Quantum fluctuation relations: Foundations and applications," Rev. Mod. Phys. 83, 771­791 (2011). [8] Álvaro M. Alhambra, Lluis Masanes, Jonathan Oppenheim, and Christopher Perry, "Fluctuating work: From quantum thermodynamical identities to a second law equality," Phys. Rev. X 6, 041017 (2016). [9] Johan Åberg, "Fully quantum fluctuation theorems," Phys. Rev. X 8, 011019 (2018). [10] Fernando G. S. L. Brandao, Michal Horodecki, Jonathan Oppenheim, Joseph M. Renes, and Robert W. Spekkens, "Resource theory of quantum states out of thermal equilibrium," Phys. Rev. Lett. 111, 250404 (2013). [11] Michal Horodecki and Jonathan Oppenheim, "Fundamental limitations for quantum and nanoscale thermodynamics," Nat.

7

Commun. 4, 2059 (2013). [12] Paul Skrzypczyk, Anthony J. Short, and Sandu Popescu, "Work
extraction and thermodynamics for individual quantum systems," Nat. Commun. 5, 4185 (2014). [13] Fernando G. S. L. Brandao, Michal Horodecki, Nelly Ng, Jonathan Oppenheim, and Stephanie Wehner, "The second laws of quantum thermodynamics," Proc. Natl. Acad. Sci. 112, 3275­3279 (2015). [14] Matteo Lostaglio, David Jennings, and Terry Rudolph, "Description of quantum coherence in thermodynamic processes requires constraints beyond free energy," Nat. Commun. 6, 6383 (2015). [15] Manabendra Nath Bera, Arnau Riera, Maciej Lewenstein, and Andreas Winter, "Generalized laws of thermodynamics in the presence of correlations," Nat. Commun. 8, 2180 (2017). [16] Gilad Gour, David Jennings, Francesco Buscemi, and Iman Duan, Runyao Marvian, "Quantum majorization and a complete set of entropic conditions for quantum thermodynamics," Nat. Commun. 9, 5352 (2018). [17] Markus P. Müller, "Correlating thermal machines and the second law at the nanoscale," Phys. Rev. X 8, 041051 (2018). [18] Carlo Sparaciari, Jonathan Oppenheim, and Tobias Fritz, "Resource theory for work and heat," Phys. Rev. A 96, 052112 (2017). [19] Manabendra Nath Bera, Arnau Riera, Maciej Lewenstein, Zahra Baghali Khanian, and Andreas Winter, "Thermodynamics as a Consequence of Information Conservation," Quantum 3, 121 (2019). [20] Raam Uzdin and Saar Rahav, "Global passivity in microscopic thermodynamics," Phys. Rev. X 8, 021064 (2018). [21] Zahra Baghali Khanian, Manabendra Nath Bera, Arnau Riera, Maciej Lewenstein, and Andreas Winter, "Resource theory of heat and work with non-commuting charges: yet another new foundation of thermodynamics," arXiv:2011.08020 (2020). [22] Ronnie Kosloff and Amikam Levy, "Quantum heat engines and refrigerators: Continuous devices," Annu. Rev. Phys. Chem. 65, 365­393 (2014). [23] Raam Uzdin, Amikam Levy, and Ronnie Kosloff, "Equivalence of quantum heat machines, and quantum-thermodynamic signatures," Phys. Rev. X 5, 031044 (2015). [24] Jan Klaers, Stefan Faelt, Atac Imamoglu, and Emre Togan, "Squeezed thermal reservoirs as a resource for a nanomechanical engine beyond the carnot limit," Phys. Rev. X 7, 031044 (2017). [25] J. Roßnagel, O. Abah, F. Schmidt-Kaler, K. Singer, and E. Lutz, "Nanoscale heat engine beyond the carnot limit," Phys. Rev. Lett. 112, 030602 (2014). [26] Gatien Verley, Massimiliano Esposito, Tim Willaert, and Christian Van den Broeck, "The unlikely carnot efficiency," Nat. Commun. 5, 4721 (2014). [27] Ken Funo and Masahito Ueda, "Work fluctuation-dissipation trade-off in heat engines," Phys. Rev. Lett. 115, 260601 (2015). [28] Nelly Huei Ying Ng, Mischa Prebin Woods, and Stephanie Wehner, "Surpassing the carnot efficiency by extracting imperfect work," New J. Phys. 19, 113005 (2017). [29] Mischa P. Woods, Nelly Huei Ying Ng, and Stephanie Wehner, "The maximum efficiency of nano heat engines depends on more than temperature," Quantum 3, 177 (2019). [30] Sreekanth K. Manikandan, Lennart Dabelow, Ralf Eichhorn, and Supriya Krishnamurthy, "Efficiency fluctuations in microscopic machines," Phys. Rev. Lett. 122, 140601 (2019). [31] Massimiliano Esposito, Ryoichi Kawai, Katja Lindenberg, and Christian Van den Broeck, "Quantum-dot carnot engine at maximum power," Phys. Rev. E 81, 041106 (2010).

[32] Marlan O. Scully, Kimberly R. Chapin, Konstantin E. Dorfman, Moochan Barnabas Kim, and Anatoly Svidzinsky, "Quantum heat engine power can be increased by noise-induced coherence," Proc. Natl. Acad. Sci. 108, 15097­15100 (2011).
[33] Michele Campisi and Rosario Fazio, "The power of a critical heat engine," Nat. Commun. 7, 11895 (2016).
[34] Kay Brandner, Michael Bauer, and Udo Seifert, "Universal coherence-induced power losses of quantum heat engines in linear response," Phys. Rev. Lett. 119, 170602 (2017).
[35] Tobias Denzler and Eric Lutz, "Power fluctuations in a finitetime quantum carnot engine," arXiv:2007.01034 (2020).
[36] O. Abah, J. Roßnagel, G. Jacob, S. Deffner, F. Schmidt-Kaler, K. Singer, and E. Lutz, "Single-ion heat engine at maximum power," Phys. Rev. Lett. 109, 203006 (2012).
[37] Massimiliano Esposito, Ryoichi Kawai, Katja Lindenberg, and Christian Van den Broeck, "Efficiency at maximum power of low-dissipation carnot engines," Phys. Rev. Lett. 105, 150603 (2010).
[38] Juncheng Guo, Junyi Wang, Yuan Wang, and Jincan Chen, "Universal efficiency bounds of weak-dissipative thermodynamic cycles at the maximum power output," Phys. Rev. E 87, 012133 (2013).
[39] Patrick Pietzonka and Udo Seifert, "Universal trade-off between power, efficiency, and constancy in steady-state heat engines," Phys. Rev. Lett. 120, 190602 (2018).
[40] Viktor Holubec and Artem Ryabov, "Cycling tames power fluctuations near optimum efficiency," Phys. Rev. Lett. 121, 120601 (2018).
[41] Konstantin E. Dorfman, Dazhi Xu, and Jianshu Cao, "Efficiency at maximum power of a laser quantum heat engine enhanced by noise-induced coherence," Phys. Rev. E 97, 042120 (2018).
[42] Paolo Abiuso and Martí Perarnau-Llobet, "Optimal cycles for low-dissipation heat engines," Phys. Rev. Lett. 124, 110606 (2020).
[43] Kay Brandner and Keiji Saito, "Thermodynamic geometry of microscopic heat engines," Phys. Rev. Lett. 124, 040602 (2020).
[44] Harry J. D. Miller and Mohammad Mehboudi, "Geometry of work fluctuations versus efficiency in microscopic thermal machines," Phys. Rev. Lett. 125, 260602 (2020).
[45] Varinder Singh, "Optimal operation of a three-level quantum heat engine and universal nature of efficiency," Phys. Rev. Research 2, 043187 (2020).
[46] Giuliano Benenti, Giulio Casati, and Jiao Wang, "Power, efficiency, and fluctuations in steady-state heat engines," Phys. Rev. E 102, 040103 (2020).
[47] Johannes Roßnagel, Samuel T. Dawkins, Karl N. Tolazzi, Obinna Abah, Eric Lutz, Ferdinand Schmidt-Kaler, and Kilian Singer, "A single-atom heat engine," Science 352, 325­329 (2016).
[48] Mohit Lal Bera, Maciej Lewenstein, and Manabendra Nath Bera, "Attaining Carnot efficiency with quantum and nanoscale heat engines," npj Quantum Information 7, 31 (2021).
[49] J. Anandan and Y. Aharonov, "Geometry of quantum evolution," Phys. Rev. Lett. 65, 1697­1700 (1990).
[50] Christopher C. Gerry and J. H. Eberly, "Dynamics of a raman coupled model interacting with two quantized cavity fields," Phys. Rev. A 42, 6805­6815 (1990).
[51] Ying Wu, "Effective raman theory for a three-level atom in the  configuration," Phys. Rev. A 54, 1586­1592 (1996).
[52] H. E. D. Scovil and E. O. Schulz-DuBois, "Three-level masers as heat engines," Phys. Rev. Lett. 2, 262­263 (1959).
[53] Arnab Ghosh, David Gelbwaser-Klimovsky, Wolfgang

8

Niedenzu, Alexander I. Lvovsky, Igor Mazets, Marlan O. Scully, and Gershon Kurizki, "Two-level masers as heatto-work converters," Proc. Natl. Acad. Sci. 115, 9941­9944

(2018).

Appendix A: Some useful properties of baths

Our formalism exploits useful properties of the baths that are considerably large compared to the working systems under

consideration. That is why a bath always remains in thermal equilibrium at a fixed temperature even after it interacts with a

system. A heat engine has two baths and a working body as components. Hence, a bath Bx with Hamiltonian HBx is expected to

remain

in the Gibb's state Bx

=

e-x HBx Tr [e-x HBx ]

always,

with inverse temperature

x.

Now

for two baths

B1

and

B2, with corresponding

Hamiltonians HB1 and HB2 respectively, the combined state can be expressed as

B12 = B1  B2 .

(A1)

In general, the baths and the working body have Hamiltonians bounded from below, having the lowest energy to be zero. But,

the

baths

may

have

considerably

large

energy,

i.e.,

E

ma Bx

x



.

Although

the

combined

baths

are

probabilistic

mixtures

of

all

energy states, there exists a set of total energies EB12 where the baths can be found with high probability. Mathematically, it

means

Tr [PEB12 B12 ] 1 - ,

(A2)

where PEB12 is a projector that spans over the space corresponding to the set EB12 and  > 0. With this, the properties of the combined baths are listed below (cf. [48]).

· For any energy EB12 = EB1 + EB2  EB12 withEB1 and EB2 are the energies of the baths B1 and B2 respectively, there is a peak around the mean value EB12 , as EB12  EB12 - O( EB12 ), . . . , EB12 + O( EB12 ) .

·

For EB1

any energy EB12 = + ES 1 = EB1 + ES 1

EB1 and

+ EB2 EB2 +

 ES

EB12 , ES 1 2 = EB2 +

ES

2

EB1 , and ES , where ES 2

1

EB1 , there exists a EB12 = EB1 + EB2  EB12 so that EB2 and ES 2 EB2 .

· For any energy EB1 + EB2  EB12 , the degeneracy gB(EB1 + EB2 ) scales exponentially with energy, and it satisfies the relation gB(EB1 + EB2 )  gB(EB1 + EB2 ) e , 1ES1 +2ES2 where EB1 = EB1 + ES 1 and EB2 = EB2 + ES 2 with ES 1 EB1 and ES 2 EB2 .

Appendix B: Reversible Engine Operation in a One-step Cycle

Here we reconsider the reversible engine operation, given in the main text (see Eq. (??)), that yields maximum power with
Carnot efficiency. We have assumed a bipartite working system S 12 with the Hamiltonian HS 12 = HS 1 + HS 2 where HS 1 = a|1 1|S 1 and HS 2 = a|1 1|S 2 . We have also assumed a bipartite battery S W12 with the Hamiltonian HS W12 = HS W1 + HS W2 , where HS W1 = EW1 |1 1|S W1 and HS W2 = EW2 |1 1|S W2 . The one-step cycle is executed by implementing a global unitary (U) operation on the baths-system-battery composite leading to the transformation

B1  B2  S 12  iS W12  B1 B2  S 12  Sf W12 ,

(B1)

where S 12 = |0 0|S 1  |1 1|S 2 and S 12 = |1 1|S 1  |0 0|S 2 are the initial and final states of the working system S 12, and

i
S W12

= |0

0|S W1

 |0

0|S W2

and Sf W12

= |1

1|S W1

 |1

1|S W2

are the initial and final states of the battery S W12 . Recall, the global

unitary U respects strict conservation of total energy and total weighted-energy. Therefore, we can study the transformation in

each total energy block separately. Consider a block of total energy E1 + E2, where E1 = ES 1 + EB1 is the sum of energies belonging to S 1 and B1, and similarly for E2 = ES 2 + EB2 . In this total energy block, the transformation becomes

[B1  B2  S 12 ]E1+E2  iS W12  [B1 B2  S 12 ]E1+E2  Sf W12 ,

(B2)

where E1 = ES 1 + EB1 and E2 = ES 2 + EB2 . The strict conservation of the total weighted-energy and the total energy ensure that

1E1 + 2E2 = 1(E1 + EW1 ) + 2(E2 + EW2 ), E1 + E2 = E1 + E2 + EW1 + EW2 ,

(B3) (B4)

where E1 = EB1 , E2 = EB2 + a, E1 = EB1 + a, and E2 = EB2 . Here we have assumed 1 < 2.

9

Note, similar transformations will follow in the other total weighted-energy blocks with identical initial and final battery
states. The reduced transformation on the system S 12, S 12  S 12 is reversible because all -free-entropies for pure system and battery states considered here are  independent [48]. As a consequence, free-entropy distances satisfy S d(S 12  S 12 ) = S d(S 12  S 12 ), where

S d(S 12  S 12 ) = 2a - 1a = 1EW1 + 2EW2 > 0.

(B5)

This relation guarantees that there is strict conservation of weighted-energy of the working system and the battery together. Therefore, conservation of total weighted-energy (B3) is reduced down to the strict conservation of the weighted-energy of the baths only, i.e.

1(EB1 - EB1 ) + 2(EB2 - EB2 ) = 1Q1 + 2Q2 = 0,

(B6)

where we have identified the heat as the change in energy of the bath B1 given by Q1 = EB1 - EB1 and similarly Q2 = EB2 - EB2 for bath B2. This is true for all energy blocks. The Eq. (B6) represents the Clausius equality for the cyclic process. The other total energy blocks will result in identical Clausius equality. The net extracted work in each (one-step) engine cycle is given by

Wext = EW1 + EW2 = Q1 + Q2 > 0,

(B7)

Here we have used the strict total energy conservation (B4). It is clear from Eqs. (B6) and (B7) that the heat-to-work conversion

is C

=

Wext Q1

=

1

-

1 2

,

which

is

exactly

the

Carnot

efficiency.

Nevertheless for reversible engine transformation, the global

unitary evolution strictly ensures total energy conservation of B1B2S 12S W12 and weighted-energy conservation of B1B2, and that

are mathematically expressed by the commutation relations U, HB1 + HB2 + HS = 0 and U, 1HB1 + 2HB2 = 0 respectively,

where HS = HS 1 + HS 2 + HS W1 + HS W2 is the Hamiltonian of the system S = S 12S W12 .

Appendix C: Conservation of weighted-energy implies conservation of entropy

In order to understand the relation between conservation of entropy and conservation of weighted-energy, we analyze the en-
gine process in terms of the transformations happening in micro-canonical ensembles. The baths are assumed to be considerably
large compared to the systems and the batteries. Say, for the energy EB1 , the degeneracy of the micro-canonical subspace of the bath B1 is g(EB1 ). Similarly, for the energy EB2 , the degeneracy of the micro-canonical subspace of the bath B2 is g(EB2 ). A change of energy Q1 in the bath B1 leads to a new macro-canonical subspace of energy EB1 + Q1, and it's degeneracy is given by g(EB1 )e-1Q1 (see Appendix A). Similarly, for a change in energy Q2 in the bath B2 results in new micro-canonical subspace with degeneracy g(EB2 )e-2Q2 . Since the transformation is driven by a unitary operation and the system S always remains in pure state, the total degeneracy for the total-energy block EB1 + EB2 of the baths B1B2 must remain unchanged, i.e.,

g(EB1 )g(EB2 ) = g(EB1 )e-1Q1 g(EB2 )e-2Q2 ,

(C1)

which demands the Clausius equality 1Q1 + 2Q2 = 0. Therefore, strict total weighted-energy conservation is essential to conserve (one-shot) entropy of the global system. The Clausius equality is not in general ensured by local thermal operations. Thus, the semi-local thermal operations cannot be implemented by using local thermal operations, in general.

Appendix D: Engineering intensity-dependence in Hamiltonian (16)

This section aims to show how the interaction Hamiltonian (16) can be realized with designed cavities or ion traps. We will focus here on the case of one cavity interacting with a two-level atom. Generalization to three-level systems and two different cavities coupled to the two different transitions is straightforward.
So, the starting point is a cavity (or trap) with a slight anharmonicity. That is described by the Hamiltonian of a harmonic oscillator, with frequency  and a small controllable anharmonicity V (x/x0),

Hcav

=

p2 2m

+

m2 x2 2

+ V (x/x0)

=

 aa + V

a + a  2

.

(D1)

where x0 = m . Assuming that  is much larger than any other relevant frequency, it makes sense to go to interaction picture with respect to the harmonic part of the Hamiltonian, and apply rotating wave approximation, i.e. neglect all rapidly oscillating terms and leave only diagonal terms in the Fock basis. The end result is

Hcav,I = f (N),

(D2)

10

where N = aa and f (n) = n|V(x)|n with N|n = n|n . Similarly, we assume that atom-cavity coupling originally has a general form

Hc = gb(x/x0)( + ),

(D3)

where b(x/x0) is the cavity mode function, which we take to be odd, i.e. b(-y) = -b(y). Assuming that the atom is close to the bare cavity resonance and, performing the same steps as before, we end up with the interaction Hamiltonian

Hc,I = g((N)a + h.c.),

(D4)

 where n - 1|b(x/x0)|n = (n - 1) n.
The intensity-dependent functions f (N) and (N) are related to the original functions V (x/x0) and b (x/x0). For general f (N) and (N), one needs to design the original functions. This can be done using Monte Carlo (MC) optimization procedures. To

this aim one defines a cost function

C[V, b] = || fact(·) - ftar(·)|| + ||act(·) - tar(·)||,

(D5)

where f, act,tar are the actual and target forms of the functions f (·) and (·), and || · || denotes any norm in the space of the functions f, . Judging from Eq. (17) it can be L2-norm for f (·) and Lq-norm with q > 2 for (·). Now the MC procedure runs as follows: i) we choose actual form of Vact(·) and bact(·); ii) we calculate fact(·), act(·) and C[Vact, bact]; iii) we modify slightly Vact(·) and bact and calculate the new value of C[Vact, bact]; iv) we accept the modification, if the new value of the error function is smaller than the previous one; v) we go to iii) and repeat this steps until convergence is achieved. MC optimization maybe
modifies to allow for small errors, if we treat the cost functions like and energy and minimize the corresponding free energy at
some arbitrary auxiliary temperature T .
The question of the convergence of the MC procedure, as well as the sensitivity and the role of errors in the realization of our
quantum engine is very interesting but clearly goes beyond the scope of present work. We will study it in a future publication.

Appendix E: Effective Hamiltonian of the quantum optics based quantum heat engine

We start by considering that our system S is described by the Hamiltonian of a  system and that each of the two transitions is coupled to a different bosonic mode. The Hamiltonian is divided into two parts H = H0 + H1, with

H0 = 1N1 + 2N2 + E1|1 1|S + E2|2 2|S + E3|3 3|S , H1 = f1(N1) + f2(N2) + g11(N1)(a^131 + h.c.) + g22(N2)(a^232 + h.c.).

(E1)

Here i j = |i j|S is the transition operator, and Nk = akak the number operator corresponding to the bath Bk. The system and bath energies are given by Ei and k ( = 1). The terms fk(Nk) represent intensity-dependent energy shifts of the baths, whereas
gk(Nk) also takes into account the intensity-dependence of the dipole interaction between the system and the baths. We now set E1 = 0 and move to the interaction picture with respect to H0 = 1N1 + 2N2 + E2|2 2|S + 1|3 3|S , imposing the resonant condition 1 = 2 + E2. This gives the interaction picture Hamiltonian

HI = |3 3| + f1(N1) + f2(N2) + g11(N1)(a^131 + h.c.) + g22(N2)(a^232 + h.c.),

(E2)

with  = E3 - 1. We express our quantum state in the interaction picture as:

| = |~ B|1 S + |~ B|2 S + |~ B|3 S ,

(E3)

where |~ B, |~ B, and |~ B are unnormalized states of the system composed by B1 and B2. This leads to the following form of the Schrödinger equation in components

i d |~ dt

B

=

f1(N1) + f2(N2) |~ B + g11(N1)a^1|~ B,

(E4)

i d |~ dt

B

=

f1(N1) + f2(N2) |~ B + g22(N2)a^2|~ B,

(E5)

i d |~ dt

B

=

f1(N1) + f2(N2) +  |~ B + g22(N2)a^2|~ B + g11(N1)a^1|~ B.

(E6)

Now we consider a large detuning , i.e.,

d dt

|~

B

0, and 

f1(N1) + f2(N2) , which allows us to express

|~

-1 

g11(N1)a^1|~ B + g22(N2)a^2|~ B

.

Introducing this result in the previous equations leads to

i d |~ dt

B

=

  f1(N1)

+

f2(N2)

-

g21 

12

 (N1)

|~

B

-

g1g2 

1 (N1 )a^ 1 a^ 2 2 (N2

)|~

B,

i d |~ dt

B

=

  f1(N1)

+

f2(N2)

-

g22 

22

 (N2)

|~

B

-

g1g2 

2

(N2

)a^ 2

a^ 1 1 (N1 )|~

B.

The latter are the same equations of motion generated by an effective interacting Hamiltonian given by

Heff

=

f1(N1) +

f2(N2) -

g21 

12

(N1

)

-

g22 

22

(N2

)

-

g1g2 

(1

(N1 )a^ 1

a^ 2 2 (N2 )21

+ h.c.).

For suitable functions that satisfy

fk(Nk)

=

g2k 

k2(Nk

),

we obtain the final effective Hamiltonian

Heff

=

- g1g2 

1 (N1 )a^ 1 a^ 2 2 (N2 )21

+

h.c..

11 (E7) (E8) (E9) (E10) (E11) (E12)

