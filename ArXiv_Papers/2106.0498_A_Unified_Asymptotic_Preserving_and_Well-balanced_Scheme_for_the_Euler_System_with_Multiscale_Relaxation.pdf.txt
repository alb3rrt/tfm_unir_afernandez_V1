arXiv:2106.00498v1 [math.NA] 1 Jun 2021

A UNIFIED ASYMPTOTIC PRESERVING AND WELL-BALANCED SCHEME FOR THE EULER SYSTEM WITH MULTISCALE RELAXATION
K. R. ARUN, M. KRISHNAN, AND S. SAMANTARAY
Abstract. The design and analysis of a unified asymptotic preserving (AP) and well-balanced scheme for the Euler Equations with gravitational and frictional source terms is presented in this paper. The asymptotic behaviour of the Euler system in the limit of zero Mach and Froude numbers, and large friction is characterised by an additional scaling parameter. Depending on the values of this parameter, the Euler system relaxes towards a hyperbolic or a parabolic limit equation. Standard Implicit-Explicit Runge-Kutta schemes are incapable of switching between these asymptotic regimes. We propose a time semi-discretisation to obtain a unified scheme which is AP for the two different limits. A further reformulation of the semi-implicit scheme can be recast as a fully-explicit method in which the mass update contains both hyperbolic and parabolic fluxes. A space-time fullydiscrete scheme is derived using a finite volume framework. A hydrostatic reconstruction strategy, an upwinding of the sources at the interfaces, and a careful choice of the central discretisation of the parabolic fluxes are used to achieve the well-balancing property for hydrostatic steady states. Results of several numerical case studies are presented to substantiate the theoretical claims and to verify the robustness of the scheme.
1. Introduction
Hyperbolic and kinetic equations with relaxation are ubiquitous in physical problems, such as in the theory of gases [13], non-equilibrium thermodynamics [14, 16], and linear and nonlinear waves [50], to name but a few. The main feature of relaxation problems is the occurrence of lower order terms in the governing equations, with respect to a small parameter  known as the relaxation parameter. The asymptotic limit   0 is often singular in the sense that the original governing equations of the problem approach a system of equations of a different mathematical and physical nature in the limit. A rigorous and systematic analysis of relaxation problems is due to Liu and collaborators [17, 37], which later lead to the development of the so-called relaxation schemes by Jin and Xin [32]. Depending on the particular scaling of the relaxation parameter , hyperbolic relaxation models can yield either hyperbolic or viscous conservation laws as their asymptotic limits. We refer the interested reader to, e.g. [2, 9, 38, 39] for a detailed analysis of relaxation systems. In [7], a new class of relaxation problems, termed as multiscale relaxation problems, is introduced wherein multiple scalings of the stiff terms are identified by various powers of the relaxation parameter  involving an exponent   [0, 1]. When   [0, 1), the asymptotic limit of the relaxation system is hyperbolic in nature, and the limit   0 is known as hyperbolic-to-hyperbolic relaxation. On the other hand,  = 1 gives a diffusion equation, and the corresponding limit is called hyperbolicto-parabolic relaxation. In short, unlike standard relaxation systems, the asymptotic limit of a multiscale relaxation problem is also characterised by the scaling parameter .
Date: June 2, 2021. 2010 Mathematics Subject Classification. Primary 35L45, 35L60, 35L65, 35L67; Secondary 65M06, 65M08. Key words and phrases. Compressible Euler system, Multiscale relaxation, Unified asymptotic preserving, Finite volume method, Hydrostatic steady states, Well-balancing. M. K. gratefully acknowledges the INSPIRE Fellowship from Department of Science and Technology, Government of India.
1

2

ARUN, KRISHNAN, AND SAMANTARAY

The numerical resolution of relaxation problems, or multiscale problems in general, poses a lot of difficulties. Standard explicit schemes work well in the macroscopic regime of the stiff relaxation parameter (  1) but in the microscopic regime (  0), these schemes encounter prohibitively expensive stability constraints. In addition, merely satisfying the stability constraints does not guarantee the accuracy of the scheme in the microscopic regime. It is well-known from literature, e.g. [26], that explicit time-stepping schemes suffer from a severe loss of accuracy in the stiff regime   0. Jin, in [27], introduced the notion of the so-called "Asymptotic Preserving (AP) schemes" in the context of kinetic models for transport in diffusive regimes, to tackle the multiscale nature of the problem and other associated difficulties. Formally, the basic idea behind an AP scheme can be explained in a general setting as follows. Let P denote a singularly perturbed problem with , the perturbation parameter. Suppose that in the limit as   0, the solution of P converges to the solution of a well-posed problem denoted by P0, called the singular limit or the limit problem. A numerical scheme for P, denoted by Ph with h being a discretisation parameter, is said to be asymptotic preserving if,
(i) as   0 the numerical scheme Ph converges to a numerical scheme P0h, which is a consistent discretisation of the limit system P0, and
(ii) the stability constraints on the discretisation parameter h are independent of .
Mathematically, the passage P  P0 can often be formulated as a singular limit of the governing equations; see e.g. [33] for the treatment of a singular limit in hydrodynamics. In such problems, the AP methodology turns out to be a natural choice for the numerical approximation, in the sense that it respects the singular limit at a discrete level, i.e. Ph  P0h. Furthermore, the AP framework automatically recognises the singular and non-singular regions in the flow as well as the transient regions where regime shifts take place. Therefore, using an AP discretisation for relaxation problems involving multiple scales is an effective method that drastically reduces the computational complexity while simultaneously enhancing the accuracy; see [28] for a detailed review.
During the past decade and a half, the Implicit-Explicit (IMEX) Runge-Kutta (RK) schemes for solving stiff systems of differential equations have gained a lot of attention; see [8, 12, 21, 29, 30, 31, 34, 36, 46] and the references therein. IMEX time-stepping schemes rely on a stiff/nonstiff splitting wherein they add a small amount of implicitness in comparison to a fully-implicit scheme. The compromise is usually very optimal since the need to invert large dense matrices for a fully-implicit scheme can be avoided, while also getting past the restrictive stability conditions of a fully-explicit scheme. Individually, hyperbolic-to-hyperbolic and hyperbolic-to-parabolic relaxation problems have been successfully tackled by the application of IMEX-RK schemes; see [12, 26, 30, 31, 34, 46]. In the case of multiscale relaxation problems, since the asymptotic limits are non-unique and dependent on , the design and analysis of IMEX AP schemes is a more complex and demanding task. First, the chosen discretisation should be AP for different asymptotic limits of the given relaxation system. Second, the restrictions on the discretisation parameters imposed by stability constraints may not be uniform as different limit systems are obtained corresponding to different values of . In [7], a unified AP IMEX-RK scheme is proposed and analysed for the hyperbolic and parabolic relaxation limits of a Jin-Xin-type relaxation system. More recently, in [1], a unified AP scheme has been developed in an IMEX linear multistep framework.
Another difficulty in the numerical approximation of hyperbolic balance laws containing source terms is the appearance of steady state solutions wherein flux gradients are exactly balanced by source terms. For example, in the case of the Euler equations of hydrodynamics, an equilibrium of interest is the hydrostatic state in which the pressure gradients are balanced by the gravitational force. The so-called well-balanced schemes are those schemes that can maintain such steady states exactly at the discrete level. Most of the practical problems of interest are small perturbations of

UNIFIED AP AND WELL-BALANCED SCHEME

3

steady states and therefore, the challenge for a well-balanced scheme is to resolve such perturbations up to machine precision. One can find various approaches to derive well-balanced schemes for hyperbolic balance laws in literature; see e.g. [4, 10, 18, 22, 23, 24, 25, 35, 43, 44, 51, 52, 53].
The goal of the present work is to design, analyse, and implement a unified AP and well-balanced scheme for the Euler equations of compressible flows with multiscale relaxation. Specifically, we consider the Euler system with an isentropic equation of state containing gravitational and frictional source terms. Under this setting, the pertinent non-dimensional parameters which characterise the multiscale nature of the Euler system are the Mach number, the Froude number, and a scaled friction coefficient. After a scaling of these numbers with , the pressure gradient term is O(2) whereas the gravity and friction terms scale as O(1+). In the diffusive regime ( = 1), the Euler system relaxes to a porous medium equation for the density with a Darcy-type pressure law. On the other hand, under the hyperbolic scaling, i.e. when   [0, 1), it relaxes to a linear advection equation for the density. Additionally, due to the presence of both gravity and friction terms, the Euler system admits nontrivial stationary solutions which necessitate the need to have a well-balanced numerical scheme.
In recent years, AP and well-balanced schemes for the Euler equations have been an active area of research. The most well-explored singular limit of the Euler equations is invariably the incompressible limit in which the compressible Euler system approaches its incompressible counterpart [33]. Various AP schemes have been proposed to approximate the incompressible limit; see, e.g. [3, 11, 20, 19, 42] and the references therein. Details of well-balancing of the sources in the context of the low Mach number limit of the Euler equations, or the low Froude number limit of the shallow water equations can be found, e.g. in [5, 6, 48]. In the presence of source terms, the solution in the asymptotic regime is often in a state of balance, and hence well-balancing is crucial for AP schemes applied to stiff systems of balance laws. In addition, since most of the practical problems of relevance are perturbations of some steady states, well-balancing is a key also for the transient regimes wherein  is small yet not an infinitesimal. In the present work, the AP property in a multiscale relaxation problem for the Euler equations is achieved by performing a semi-implicit time discretisation along the lines of [7]. A reformulation of the resulting time semi-discrete scheme allows us to recast it as an AP, fully-explicit method in which the density update contains both convection and diffusion terms. Subsequently, a space-time fully-discrete scheme is obtained in a finite volume framework. Well-balancing property for the hydrostatic steady state is accomplished through a novel approach wherein the hyperbolic convective fluxes are approximated by a Rusanovtype approximate Riemann solver combined with an equilibrium reconstruction [4, 10, 40, 41], and the parabolic fluxes, by a simple central differencing. The fully-discrete scheme is shown to be stable under a parabolic CFL condition which becomes less and less severe as   0 for   [0, 1); see also [7] for details.
The rest of this paper is organised as follows. In Section 2, we present an asymptotic analysis of the scaled Euler system with gravity and friction and highlight the two distinguished limit equations. In Section 3, we derive a semi-discrete in time and semi-implicit scheme and its AP fully-explicit reformulation. In Section 4, a space-time fully-discrete scheme is obtained using a finite volume framework. In order to maintain the steady states at the discrete level or in other words, to achieve the well-balancing property, the interface fluxes are calculated using a hydrostatic reconstruction technique and the source terms are appropriately upwinded. As the mass update is responsible to maintain the AP property of the scheme, a careful choice of the central discretisation for the parabolic mass fluxes is made in order to retain the AP property as well as the balance. An analysis of the scheme thus obtained is carried out to establish its consistency, well-balancing and AP properties. In Section 5, we present the results of numerical case studies carried out, which not

4

ARUN, KRISHNAN, AND SAMANTARAY

only substantiate the theoretical claims but also demonstrate the robustness of the new scheme. Finally, we close the paper in Section 6 with a few concluding remarks.

2. Multiscale Relaxation Limits of the Euler System

We consider the following one-dimensional compressible Euler equations with gravity and friction in dimensionless variables:

(2.1)

t + x(u) = 0,

(2.2)

t(u)

+

x(u2)

+

1 Ma2

xP

()

=

-

1

1

u µ¯

-

Fr2

x

.

Here the independent variables are the time t > 0 and space x  R, and the dependent variables

are the density  > 0 and the velocity u  R. The pressure is assumed to follow the Darcy's law P () = , where   1 is a constant. The function  represents the known gravitational potential.

The dimensionless numbers Ma, Fr and µ¯ represent the Mach number, the Froude number and the

scaled friction coefficient respectively. They are defined as

(2.3)

Ma := uref , Fr := uref , µ¯ := uref ,

cref

gxref

µxref

where uref , cref , and xref are a reference fluid speed, a reference sound speed, and a reference length respectively. The constant g is the gravitational constant and µ represents the friction coefficient.
Let us introduce an infinitesimal parameter   (0, 1] and scale the non-dimensional numbers via

(2.4)

Ma2  O(2), Fr2 = µ¯  O(1+).

Upon scaling, the compressible Euler equations (2.1)-(2.2) read

(2.5)

t + x(u) = 0,

(2.6)

t(u)

+

x(u2)

+

1 2

xP

()

=

1 - 1+

(u

-

x).

The system (2.5)-(2.6) relaxes to different asymptotic limits depending on the values of the scaling

parameter . In the following, we suppose that   (0) and u  u(0) as   0. When  = 1, as   0, the Euler system (2.5)-(2.6) relaxes to the equilibrium system

(2.7)

t(0) + x (0)u(0) = 0,

(2.8)

(0)u(0) = (0)x - xP (0) .

Eliminating the momentum (0)u(0) between (2.7) and (2.8) gives the following parabolic porous medium equation:

(2.9)

t(0) + x (0)x = xxP (0) .

Similarly, when   [0, 1), the momentum equation (2.6) relaxes to (0)u(0) = (0)x, and the mass equation converges to (2.7) again. Consequently, we obtain the hyperbolic transport equation

(2.10)

t(0) + x((0)x) = 0.

The asymptotic analysis carried out above for the compressible Euler equations (2.5)-(2.6) shows that the mass conservation equation incorporates the limiting momentum equation to give us two different limit equations, depending on the values of . In other words, when   0, the sole surviving dependent variable is the density (0), and the velocity u(0) can be be explicitly obtained once (0) is known. Based on this observation, we make the following definition of a reformulated and reduced limit equation which pertains to the limiting mass conservation equation in both of the cases considered above.

UNIFIED AP AND WELL-BALANCED SCHEME

5

Definition 2.1. The reformulated and reduced limit equation for the scaled compressible Euler equations (2.5)-(2.6) as   0 is defined as
(i) the parabolic porous medium equation (2.9) when  = 1; and (ii) the hyperbolic transport equation (2.10) when   [0, 1).

2.1. Hydrostatic Steady States. Hydrostatic steady states are particular stationary solutions of the Euler system (2.5)-(2.6) that satisfy

(2.11)

u = 0,

(2.12)

1

1

2 xP () = 1+ x.

In other words, the hydrostatic steady states correspond to vanishing velocities and the balancing of the pressure gradient and the gravitational force. The solutions to (2.11)-(2.12) are not unique, and they depend on the exponent  in the pressure law. Setting  = 1 in (2.12), and solving the resulting equations for  yields the following isothermal equilibrium solution:

(2.13)

ue = 0, e(x) = C exp -1(x) .

When  > 1, analogously, we obtain the following isentropic equilibrium:

(2.14)

1

ue = 0,

e(x) =

 - 1 -1(x) + C)

-1
.



Here C denotes a constant of integration. A multiscale relaxation framework was proposed in [7], where a time semi-discrete solver was
introduced which converges to an explicit RK discretisation of the correct asymptotic limit independently of the scaling parameter. This was achieved by using an implicit treatment of the mass flux and friction terms, combined with an explicit treatment of the momentum flux terms.Motivated by this approach, the primary goal of the present work is to develop a time semi-discretisation for the system (2.5)-(2.6), in order to get a unified AP scheme for the reformulated and reduced limit equation. In other words, the numerical scheme should yield a consistent discretisation of the parabolic limit (2.9) when  = 1 and that of the hyperbolic limit (2.10) when   [0, 1). Since most of the problems of interest involve perturbations of steady states such as (2.13) or (2.14), we want the proposed scheme to be well-balanced for the hydrostatic steady states in addition to being AP.

3. Time Semi-discrete Scheme

In this section, a time discretisation of the compressible Euler system (2.5)-(2.6) is proposed.
Subsequently, following the design of the scheme, we prove that the proposed time-discretisation relaxes to the correct asymptotic limit independent of the choice of the scaling used. Let 0 = t0 < t1 < · · · < tn < · · · be an increasing sequence of times and let f n denote an approximation to the value of a function f at time tn. Along the lines of [7], we design the following time semi-
discretisation for (2.5)-(2.6) in which only the momentum terms are implicit:

(3.1) (3.2)

n+1 = n - txqn+1,

qn+1 = qn - tx

qn2 n

-

t 2

xP (n)

-

t 1+

qn+1 - nx ,

where q = u. As the next step, we perform a reformulation of the above scheme so that the mass update (3.1) rewrites as a perturbation of a discretisation of the reduced limit equation for all values

6

ARUN, KRISHNAN, AND SAMANTARAY

of . To this end, we eliminate qn+1 between (3.1)-(3.2), and recast the resulting update formulae in the following incremental form:

n+1

=

n

-

1+ t 1+ + t

xqn

+

1+ t2 1+ + t xx

qn2 n

(3.3) (3.4)

+

1- t2 1+ + t

xxP

(n)

-

t2 1+ +

t x(nx),

qn+1

=

qn

-

1+ t 1+ + t x

qn2 n

-

1- t 1+ + t

x

P

(n)

-

t 1+ +

(qn t

-

nx)).

Remark 3.1. It can be easily seen that upon a Taylor expansion, the first derivative terms in the above update formulae (3.3)-(3.4) constitute a hyperbolic system whose flux function depends explicitly on  and t. The eigenvalues of its Jacobian matrix converge to the eigenvalues of the Euler system (2.5)-(2.6) as t  0 when  is fixed. On the other hand, for a fixed t, the eigenvalues remain bounded in the limit of   0. As a consequence, the stiffness in the stability condition can be overcome by using the semi-discrete scheme (3.3)-(3.4). It has to be noted that the presence of the second order terms in (3.3)-(3.4) would impose a stricter parabolic stability restriction in a space-time discretisation. However, it has been shown in [7] that the parabolic stability constraint does not degenerate in the stiff limit   0.

We designate the updates (3.3)-(3.4) as the reformulated time semi-discrete scheme. Note that the mass update (3.3) now contains both hyperbolic and parabolic terms which are essential to get consistency with the reduced limit equation for all values of . We state the AP property of the scheme as follows.

Theorem 3.2. The reformulated time semi-discrete scheme (3.3)-(3.4) is consistent with the Euler system (2.5)-(2.6) away from vacuum. Furthermore, it is asymptotically consistent with the reformulated and reduced limit equation given in Definition 2.1. In other words, as   0, the mass update (3.3) yields a consistent time semi-discretisation of
(i) the parabolic porous medium equation (2.9) for  = 1; and (ii) the hyperbolic transport equation (2.10) for   [0, 1).

Proof. The consistency with the Euler equations (2.5)-(2.6) follows by Taylor expanding the terms on the right hand side of (3.3)-(3.4).
Setting  = 1 in (3.3), and letting   0 we get

(3.5)

n(0+)1 = n(0) - tx n(0)x + txxP n(0) ,

which is a consistent semi-discrete approximation of the porous medium equation (2.9). Similarly, when   [0, 1), the limit   0 yields

(3.6)

n(0+)1 = n(0) - tx n(0)x ,

which is consistent with the transport equation (2.10).

4. Space-time Fully-discrete Scheme and Well-balancing
This section is devoted to the design and analysis of a fully-discrete version of the time semidiscrete scheme (3.3)-(3.4). Towards this end, we use a finite volume approach to approximate the spatial derivatives. In order to maintain discrete steady states, the interface fluxes in the momentum update are modified using a hydrostatic reconstruction technique. The source terms are appropriately upwinded to serve the task at hand; see also [40]. Since the mass update is

UNIFIED AP AND WELL-BALANCED SCHEME

7

reformulated by incorporating the updated momentum to achieve the AP property, it is essential to preserve the discrete steady state in a discretisation of the mass conservation as well. We make a prudent choice of a central discretisation to maintain the balance in the density update.
Let us recast the semi-discrete scheme (3.3)-(3.4) in the following compact form:

(4.1)

U n+1 - U n t

+ c1xF (U n)

=

c2xG(U n, xU n) + c1S(U n),

where the vector of conserved variables U , the hyperbolic flux F , the parabolic flux G and the

source term S are defined as

(4.2) (4.3)

U=

 q

,

F (U ) =

q

q2 

+

P () 2

,

G(U, xU ) =

x

q2 

+

xP () 2

-

x 1+

0

,

0

S(U ) =

-

q-x 1+

,

with

the

shorthands

c1

=

1+ 1+ +t

and

c2

=

c1t.

In order to get a fully-discrete scheme, we use a finite volume framework. The first step is to divide

the computational domain [a, b] into N cells Ci = [xi-1/2, xi+1/2] for 1  i  N . For simplicity, we assume that the cells Ci have an equal length x. The unknown Uin is an approximation to the average of U in the cell Ci at time tn, i.e.

(4.4)

Uin

=

1 x

xi+1/2
U (tn, x)dx.
xi-1/2

Integrating (4.1) over the cell Ci yields the following finite volume discretisation:

(4.5)

Uin+1 - Uin t

+

c1

Fin+1/2 - Fin-1/2 x

=

c2

Gin+1/2 - Gin-1/2 x

+ c1Sin,

where Fi+1/2 and Gi+1/2 are, respectively, approximations to the fluxes F and G at the interface xi+1/2, and Si is an approximation to the source term S in the cell Ci. It is well-known from literature that the usual approach of defining Fi+1/2 as F (Ui, Ui+1), where F is a consistent numerical flux of the homogenous Euler system, and a pointwise calculation of the source term as Si = S(Ui) produces large errors near non-constant steady states. In other words, such a choice does not lead

to a well-balanced scheme. Hence, it becomes crucial to incorporate changes in the numerical scheme

which helps to overcome this challenge.

The main idea behind using the so-called hydrostatic reconstruction method [4, 10] to maintain well-balancing involves designating Fi+1/2 as F (Ui-+1/2, Ui++1/2) instead of using F (Ui, Ui+1). Here, Ui±+1/2 are appropriate reconstructions of the conserved variable U at the interface xi+1/2, to be
made precise later. The method also involves upwinding of the sources at interfaces wherein the source term Si is discretised as Si-+1/2 + Si+-1/2 with the upwind contributions defined as

(4.6)

0

0

Si-+1/2 := P -i+1/2 -P (i) , Si+-1/2 := P (i)-P +i-1/2

.

x

x

We will show that concentrating the source terms at the interfaces in this manner preserves the

stationary solutions, provided the interface values Ui±+1/2 are defined in such a way so as to take into

account the source terms. The parabolic fluxes Gi+1/2 are defined as G(Ui, Ui+1) using a consistent

numerical

flux

function

G.

Lastly,

since

the

presence

of

the

expression

-q 1+ +t

in

the

source

term

S(U n), cf. (4.3), is a result of rearranging the implicit momentum equation (3.2) in order to write

8

ARUN, KRISHNAN, AND SAMANTARAY

it as an explicit scheme, we will not include it in the reconstruction step. Binding together all the strategies discussed thus far, the final scheme takes the form

(4.7)

Uin+1 - Uin t

F + c1

Uin+,-1/2, Uin+,+1/2 - F x

Uin-,-1/2, Uin-,+1/2

=

c2

G(Uin,

Uin+1) - G(Uin-1, x

Uin)

+ c1

Sin+,-1/2 + Sin-,+1/2

+ c1

0 -qin

.

Next, we draw our attention towards well-balancing for hydrostatic equilibrium solutions. To this end, let us consider the pair (Uin, i), where i is some consistent approximation of the potential  at the cell centres xi. Following [10], we define a discrete steady state as follows.

Definition 4.1. A sequence (Ui, i)iZ is said to be a discrete hydrostatic steady state of the Euler system if

(4.8)

qi = 0, D (i, i+1, i, i+1) = 0, for all i  Z,

where the finite difference operator D gives a consistent discretisation of the balance (2.12). The numerical scheme (4.7) is said to well-balanced if (Uin+1, i)iZ is a discrete steady state whenever (Uin, i)iZ is a discrete steady state.
For explicit finite volume schemes, the main ingredients for well-balancing are the hydrostatic reconstruction and the upwinding of the sources at the interfaces; see e.g. [40, 41] for an application of these strategies to the Euler system with gravity and friction. If (Uin, i) is a discrete steady state, the hydrostatic reconstruction technique ensures that all the velocity terms vanish in both the numerical flux function and the source term. Then the upwinding of the sources at the interfaces makes sure that the remaining terms correspond to the second identity in (4.8). As a result, the updated solution (Uin+1, i) boils down to a discrete steady state. Maintaining the hydrostatic balance in the current problem is much more complex and complicated in comparison to standard explicit time-stepping schemes. The occurrence of the parabolic flux terms and the term x(x) in the mass equation, cf. (3.3), arising from the reformulation necessitates the need to choose an appropriate discretisation for these terms in order to preserve the well-balancing property also in the mass equation. In the present work we use the hydrostatic reconstruction and the upwinding of the sources to achieve a balance between the hyperbolic flux terms and the source terms in the momentum equation. Once this balance is achieved, we warily devise a discretisation of the parabolic terms in the modified mass update to enforce and maintain the same balance.

4.1. Reconstruction of the Interface Values. In this subsection, we define the reconstructed values ±i+1/2 and u±i+1/2 of the primitive variables. We omit the superscript n for convenience since the scheme is now fully explicit and there is no confusion. In order to define the interface values,
we use the following stationary system:

(4.9)

x(u) = 0,

x

u2

+

1 2

P

()

1 = - 1+ (u - x).

We also define a function  via

(4.10)

P ()

() := e() +

=

 -1, for  > 1,

 -1

UNIFIED AP AND WELL-BALANCED SCHEME

9

where

e

denotes

the

internal

energy

function

given

by

e

()

:=

P () 2

for

the

isentropic

pressure

law.

In terms of the function , the stationary system (4.9) can be rewritten as

(4.11)

x(u) = 0,

u2 1

1

x 2 + 2 () = - 1+ (u - x),

after dividing the second equation in (4.9) by . Now integrating the equations in (4.11) over the

half-cell [xi, xi+1/2], and assuming that the velocity is constant, we get

(4.12)

u-i+1/2 = ui,

1 2

(-i+1/2

)

-

1 2 (i)

=

1 1+ (i+1/2

- i).

Taking i+1/2 = min(i, i+1), the final reconstructed interface values take the form

(4.13)

1-(-i+1/2) =

1-(i) + (min(i, i+1) - i) ,
+

1-(+i+1/2) =

1-(i+1) + (min(i, i+1) - i+1) .
+

Here the truncations [X]+ := max(0, X) are present to ensure the positivity of the reconstructed
density. For the isentropic gas law with  > 1, the function  is continuous and strictly increasing, and thus is invertible in [0, ). Hence, we can find the interface values ±i+1/2 by inverting the relations in (4.13). The reconstruction (4.13) is referred to as the E-reconstruction [40]. A similar

analysis can also be performed using (4.9) to get what is known as the P-reconstruction

(4.14)

1-P (-i+1/2) =

1-P (i) + ¯i+1/2(min(i, i+1) - i) ,
+

1-P (+i+1/2) =

1-P (i+1) + ¯i+1/2(min(i, i+1) - i+1) ,
+

where

we

fix

¯i+1/2

=

1 2

(i

+ i+1).

Note

that

unlike

,

the

function

P

is

an

invertible

function

for

 = 1 as well.

We assert that computing the hyperbolic fluxes using the above interpolated states and concen-

trating the source term at the interfaces will ensure the well-balancing of the momentum equation.

Before we attempt to prove this claim, we need to fix an appropriate discretisation for the mass

equation to ensure overall well-balancing for the resulting scheme.

4.2. Well-Balancing for the Mass Conservation Equation. In order to present the basic ideas behind the balance, we consider again the following modified mass equation of the time semi-discrete scheme which has both hyperbolic and parabolic flux terms:

(4.15)

n+1

=

n

-

1+ t 1+ + t

xqn

+

1+ t2 1+ + t xx

qn2 n

+

1- t2 1+ + t

xxP

(n

)

-

t2 1+ +

t x(nx).

Since a hydrostatic steady state demands the vanishing of velocity at all times, we notice that

the term xqn disappears when we use the equilibrium reconstruction combined with a consistent

numerical

flux

for

the

hyperbolic

terms.

Analogously,

the

second

order

term

xx

(

qn2 n

)

will

also

be

zero when we use a consistent discretisation. Hence, we now only need to preserve the balance

between the parabolic term xxP () and the hyperbolic term x(x) in the mass equation in

order to maintain the stationarity of .

10

ARUN, KRISHNAN, AND SAMANTARAY

This can be accomplished by noting the following discrete form of the equilibrium solution that was used earlier in the P-reconstruction:

(4.16)

1-P (i+1) - ¯i+1/2i+1 = 1-P (i) - ¯i+1/2i.

Therefore we believe that using a central discretisation for the parabolic flux and an averaged

upwind flux of the form

¯ni+1/2(i+1 - i) - ¯ni-1/2(i - i-1)

x2

for the term x(x) will ensure a balance between the two terms for a hydrostatic solution.

Remark 4.2. Note that, using the E-reconstruction to construct the balance can lead to the loss of the AP property for an isentropic Euler system. This is because it can lead to a wrong diffusion coefficient for the parabolic limit equation; see [41] for more details. Moreover, the P-reconstruction technique can be employed for  = 1 as well. Hence in all further mathematical and numerical analysis presented, we will only make use of the P-reconstruction technique.

Using the hydrostatic reconstruction for the hyperbolic fluxes and the numerical source term, and discretising the mass equation in the manner described above, the final scheme takes the form

(4.17) (4.18)

ni +1

=

ni

-

c1 F (Uin+,-1/2,

Uin+,+1/2) - F (Uin-,-1/2, Uin-,+1/2) x

+

c2

qin+1 2 ni+1

-

2qin 2 ni
x2

+

qin-1 2 ni-1

+

c2 P (ni+1)

-

2P (ni ) 2 x2

+

P (ni-1)

-

c2 ¯ni+1/2(i+1

-

i) - ¯ni-1/2(i 1+ x2

-

i-1) ,

qin+1

=

qin

-

c1

F

q

(Uin+,-1/2,

Uin+,+1/2

)-F x

q

(Uin-,-1/2,

Uin-,+1/2)

-

c1qin

+

c1

P

(ni+,-1/2) - P (ni-,+1/2) 2 x

,

where F = (F , F q)T is a consistent numerical flux of the homogeneous Euler system. In what follows, we establish the consistency, well-balancing and AP properties of the space-time fullydiscrete scheme (4.17)-(4.18).

Theorem 4.3. The fully-discrete scheme (4.17)-(4.18)
(i) is a consistent discretisation of the Euler system (2.5)-(2.6) away from vacuum, (ii) is well-balanced for the hydrostatic steady state in the sense of Definition 4.1, (iii) is AP for the reformulated and reduced limit equation as   0, independent of .

Proof. It is straightforward to show that the central discretisations of the parabolic fluxes and the term x(nx) are consistent. Hence, in order to prove (i), we need to show only the consistency of the hyperbolic numerical fluxes and the source term. To this end, we follow the approach of [47].
First, we show that

(4.19)

lim
Uin ,Uin+1 U,

x0

F (Uin+,-1/2,

Uin+,+1/2)

=

F

(U ).

As in [40], we use a Taylor expansion to see that

(4.20)

Uin+,-1/2 = Uin + O(x), Uin+,+1/2 = Uin+1 + O(x).

Hence, we have that

(4.21)

F (Uin+,-1/2, Uin+,+1/2) = F (Uin, Uin+1) + O(x).

Therefore, from the consistency of the numerical flux function F, in the limit, the consistency of F (Uin+,-1/2, Uin+,+1/2) also follows.

UNIFIED AP AND WELL-BALANCED SCHEME

11

Now we have to prove the consistency of the source term discretisation, i.e. the upwinding of the source term at the interfaces. This notion of consistency is defined as per [47] where we need to show that

(4.22)

lim
Uin,Uin+1U, x0

Sin+,-1/2 + Sin+,+1/2

-

qin 1+

= S(U ).

From the definition of the upwind contributions of the source term, cf. (4.6), we have that

(4.23)

Sin+,-1/2

+ Sin+,+1/2

=

1 2 x

0 P (ni+,-1/2) - P (ni ) + P (ni+1) - P (ni+,+1/2)

.

For the P-reconstruction, we can expand the above relation using a taylor expansion, omitting the

positivity preserving truncations (we assume the density to be away from vacuum) to yield

(4.24)

1-P (ni+,-1/2) - 1- P (ni+,+1/2) = 1- P (ni ) + ¯ni+1/2

xi - |xi| 2

x

- 1+P (ni+1) - ¯ni+1/2

- xi+1 + |xi+1| 2

x + O(x2).

Therefore, in the limit Uin, Uin+1  U, x  0, we have

(4.25)

P (ni+,-1/2) - P (ni+,+1/2) 2 x

=

x 1+

,

and the discretisation of the source terms is thus consistent. To prove (ii), let us assume that (Uin, i) be a discrete hydrostatic solution. We take this solution
in the following form:

(4.26)

uni = 0, 1-P (ni+1) - ¯ni+1/2ni+1 = 1-P (ni ) - ¯ni+1/2ni .

Note that the second equation in the above system defines the finite difference operator D introduced
in Definition 4.1. Using the expressions (4.14) for reconstructed states, it is evident that for a discrete stationary solution with zero velocity (4.26), we have that Uin+,-1/2 = Uin+,+1/2 = Uin+1/2, for all i. Therefore by the consistency of the numerical flux we have that

(4.27) F (Uin+,-1/2, Uin+,+1/2) - F (Uin-,-1/2, Uin-,+1/2) + Sin+,-1/2 + Sin-,+1/2 = F (Uin+1/2) - F (Uin-1/2) + Sin+1/2 + Sin-1/2
= 0.

Thus the hyperbolic flux term F and the source term balance each other for the stationary solution.

Now for the mass equation, the discretisation of the parabolic term c2xx

q2 

vanishes due to the

consistency of the numerical fluxes because of the fact that qin = 0 for all i. The discrete form of the

hydrostatic solution then ensures that the central discretisation of the parabolic term c2xxP () and

the potential term x(x) balance each other in the hydrostatic case, and therefore the scheme

preserves the well-balancing property.

12

ARUN, KRISHNAN, AND SAMANTARAY

Next, we prove (iii), the AP property which follows from the modified mass equation

(4.28)

ni +1

=

ni

-

c1 F (Uin+,-1/2,

Uin+,+1/2) - F (Uin-,-1/2, Uin-,+1/2) x

+

c1t

qin+1 2 ni+1

- 2qin2
ni
x2

+

qin-1 2 ni-1

+

1- t2 1+ + t

P (ni+1)

-

2P (ni ) x2

+

P (ni-1)

-

t2 1+ +

t

¯ni+1/2(ni+1

-

ni ) - ¯ni-1/2(ni x2

-

ni-1) .

We set  = 1 in (4.28) and take the limit   0. Noting that c1  0 we get

(4.29)

ni +1

=

ni

+

t P (ni+1)

-

2P (ni ) x2

+

P (ni-1)

-

t ¯ni+1/2(ni+1

-

ni ) - ¯ni-1/2(ni x2

-

ni-1) ,

which is an explicit discretisation of the porous medium equation. In an analogous manner, for

  [0, 1), we obtain

(4.30)

ni +1

=

ni

-

t ¯ni+1/2(ni+1

-

ni ) - ¯ni-1/2(ni x2

-

ni-1)

which is a consistent discretisation of the transport equation.

Thus, the fully discrete scheme (4.17)-(4.18) is well-balanced that relaxes to a consistent discreti-

sation of the asymptotic limit independent of .

5. Numerical Case Studies

In this section, we test the proposed scheme in order to study its unified AP and well-balancing

properties. We compare the scheme with both non well-balanced and non AP schemes, and verify

that our scheme performs better than them in the stiff as well as the non-stiff regimes. A Rusanov-

type approximate Riemann solver was used for the hyperbolic numerical flux function F. A CFL

condition of the form

(5.1)

x2 x t = CFL min 1- , |x|

is used to compute the time step. The exact value of CFL will be specified in each problem.

5.1. Unified Asymptotic Preserving Property. The goal of this test problem is to demonstrate the ability of the new scheme to compute the flow characteristics for a wide range of . We consider two extreme cases, namely  = 1 and  = 0.001 where the latter is to showcase the AP property in the limit   0. In order to understand the multiscale behaviour of the solver, we consider a simple Riemann problem, and therein we use the Sod initial data under a gravitational field with potential (x) = x as given in [49]. We use extrapolation boundary conditions and the computational domain is set to be [0, 1]. The initial data read

(5.2)

(1, 0),

if x < 0.5,

(, u) =

(0.125, 0), if x > 0.5.

The simulation is run until a final time of T = 0.2. Results are presented in Figures 1 and 2 for the non-stiff regime ( = 1) and the stiff regime ( = 0.001) respectively. To test the convergence of the scheme, for  = 1, we compare the numerical solution obtained on a coarse mesh (N = 100) with that on a fine mesh (N = 1000) for CFL = 0.45. It can be seen that the solution computed on a coarse mesh is in good agreement with that on a fine mesh. The test results contain a shock moving to the right followed by an expansion, which shows the efficacy of the scheme in resolving the fully compressible flow features.

UNIFIED AP AND WELL-BALANCED SCHEME

13

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0

T = 0.2

x = 0.01 x = 0.001

0.2

0.4

0.6

0.8

1

x

(a)

q

0.5 0.45
0.4 0.35
0.3 0.25
0.2 0.15
0.1 0.05
0 0

T = 0.2

x = 0.01 x = 0.001

0.2

0.4

0.6

0.8

1

x

(b)

Figure 1. 1D Sod problem: solution profiles of (A)  and (B) q at T = 0.2 in the non-stiff regime for  = 1.

0.7 0.68 0.66 0.64 0.62
0.6 0.58
0

T = 0.2

PM eqn Euler System

0.2

0.4

0.6

0.8

1

x

(a)

1.1 1
0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1
0

T = 0.2

Transport eqn Euler System

0.2

0.4

0.6

0.8

1

x

(b)

Figure 2. 1D Sod problem: solution profiles of  at T = 0.2 for  = 0.001 in the (A) parabolic and (B) hyperbolic relaxation regimes.

In the stiff regime, we consider both the hyperbolic and parabolic relaxations. When  = 0.001 by setting  = 1, the numerical solution obtained on a mesh with 100 cells with CFL = 0.45, is compared with that of a standard first order scheme for the porous medium equation (2.9) to demonstrate the parabolic relaxation. The resulting solution is in perfect agreement with that of the parabolic equation showing the correct asymptotic behaviour of the scheme. Similarly, to show the hyperbolic relaxation for   [0, 1), the scheme is tested for  = 0.1 and CFL = 0.45. The result shows good agreement with a first order upwind scheme applied to the transport equation (2.10).
5.2. Well-balancing Property. To numerically validate the well-balancing property of the scheme, we use initial data in both isothermal and isentropic hydrostatic equilibrium, taken from [49]. We also add a small perturbation to these equilibria to study their evolution via the scheme. Finally, we compute the solution for a large time to show the convergence of the numerical solution to the steady state, and to compare our results with that of a non well-balanced solver. The CFL number CFL was taken to be 0.45 in every case.

14

ARUN, KRISHNAN, AND SAMANTARAY

5.2.1. Isothermal Hydrostatic Solution. We solve the system which is initially in isothermal hydrostatic equilibrium for  = 1 corresponding to the following configuration:

(5.3)

(0, x)  e(x) = exp((x)), u(0, x)  ue(x) = 0.

The exact solution (e, ue), cf. (2.13), is interpolated onto the grid, and for different values of , the

L1

errors

are

calculated

for

three

different

gravitational

potentials

(x)

=

x,

x2 2

,

sin(2x)

for

grids

with 100 and 1000 cells upto a final time T = 2. It can be seen from Table 1 that the scheme exhibits

good precision in approximating the exact hydrostatic solution for the different potentials in both

the stiff and non-stiff regimes. Thus we conclude that the scheme maintains the well-balancing

property for isothermal hydrostatic solutions.

 x x2/2 sin(2x)

N 100 1000 100 1000 100 1000

 = 1.0 Error in  2.6815E-06 2.7018E-08 9.9540E-07 9.7002E-09 2.1751E-04 2.0620E-06

Error in q 4.1644E-06 4.1655E-08 8.6076E-07 8.4871E-09 4.3318E-06 6.2102E-08

 x x2/2 sin(2x)

N 100 1000 100 1000 100 1000

 = 0.1 Error in  1.4173E-06 1.4070E-08 8.9859E-07 8.7053E-09 2.2498E-04 2.1303E-06

Error in q 1.1110E-05 1.0878E-07 2.1290E-06 2.0610E-08 1.4161E-05 1.4130E-08

 x x2/2 sin(2x)

 = 0.01 N Error in  100 1.1902E-06 1000 1.1544E-08 100 8.8290E-07 1000 8.5468E-09 100 2.2599E-04 1000 2.1313E-06

Error in q 1.3049E-05 1.2975E-07 2.4434E-06 2.4053E-08 1.6097E-05 1.6134E-08

 x x2/2 sin(2x)

 = 0.001 N Error in  100 1.1705E-06 1000 1.1390E-08 100 8.8199E-07 1000 8.5282E-09 100 2.2606E-04 1000 2.1314E-06

Error in q 1.3170E-05 1.3172E-07 2.4605E-06 2.4367E-08 1.6197E-05 1.6336E-08

Table 1. Errors in the density  and the momentum q for different potentials and for a range of  using different mesh sizes in the isothermal test case.

Next, we want to study the efficacy of the scheme in simulating the evolution of small perturbations added to the initial equilibrium solution. To this end, we compare our solver with a non well-balanced scheme which also makes use of the unified AP time discretisation but without the equilibrium spatial reconstruction. The potential in this case is taken to be (x) = x and the initial density is given by

(5.4)

0(x) = exp((x)) +  exp(-100(x - 0.5)2).

The computational domain is [0, 1] and the boundary conditions are imposed by interpolating the equilibrium solution onto the ghost cells. The results are presented for two different amplitudes of perturbation  = 10-3, 10-5. In the non-stiff regime, as expected, the well-balanced scheme resolves the solution well when compared to the non well-balanced scheme, cf. Figure 3. However, we notice from Figure 4 that the non well-balanced scheme also produces results similar to that of the well-balanced scheme in the stiff regime. This behaviour can be explained by the fact that the parabolic porous medium equation (2.9) and the hyperbolic Euler system (2.5)-(2.6) share the same stationary state, and the AP property of the non well-balanced scheme then ensures that it also relaxes to a reasonable approximation of the same steady state as   0.
Finally we also study the long time behaviour of the scheme to corroborate its convergence to a steady state by simulating the isothermal hydrostatic solution until a large time T = 100. We

Perturbation Perturbation Perturbation

UNIFIED AP AND WELL-BALANCED SCHEME

15

10-3 3

2.5

2

1.5

1

0.5

0

0

0.2

T = 0.25

0.4

0.6

x

(a)

IP WB NWB

0.8

1

10-3 3

2.5

2

1.5

1

0.5

0

-0.5

0

0.2

T = 0.25

0.4

0.6

x

(b)

IP WB NWB

0.8

1

10-6 10

8

6

4

2

0

-2

0

0.2

T = 0.25

0.4

0.6

x

(c)

IP WB

0.8

1

Figure 3. Isothermal test: evolution in the density perturbation in the non-stiff
regime for  = 1. Comparison of well-balanced scheme with non-well balanced scheme for different values of . (A)  = 10-3 (B)  = 10-5. (C) Comparison of well-balanced scheme with initial perturbation for  = 10-5.

Perturbation Perturbation

10-3 1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.2

T = 0.25

0.4

0.6

x

(a)

IP WB NWB

0.8

1

10-4 10

9

8

7

6

5

4

3

2

1

0

0

0.2

T = 0.25

0.4

0.6

x

(b)

IP WB NWB

0.8

1

Figure 4. Isothermal test: evolution in the density perturbation in the stiff regime for  = 0.001 for (a)  = 10-3 (b)  = 10-5.

take the initial data (5.4) at equilibrium with a small perturbation with amplitude  = 10-3. The boundary conditions again the exact solution interpolated onto the grid for the domain [0, 1]. For  = 1, the momentum converges accurately for the well-balanced scheme but the non well-balanced scheme diverges away from the stationary solution, cf. Figure 5.
As was noted before, in the asymptotic regime, the non well-balanced AP scheme also exudes the well-balancing property, and hence it can be seen from Figure 8 that the results are comparable with that of the well balanced scheme when  = 0.001. The oscillations that can be seen for intermediate values of the stiffness parameter ( = 0.1, 0.01) in Figures 6-7 for the non well-balanced scheme can be attributed to the loss of accuracy for the IMEX scheme in this range of ; see e.g. [45] for related discussions. From the three above-mentioned test cases, it is evident that the scheme preserves the isothermal hydrostatic solution.

16

ARUN, KRISHNAN, AND SAMANTARAY

2.8 2.6 2.4 2.2
2 1.8 1.6 1.4 1.2
1 0

T = 100

IC WB NWB

0.2

0.4

0.6

0.8

1

x

(a)

q

7 10-3

6

5

4

3

2

1

0

-1

-2

-3

0

0.2

T = 100

0.4

0.6

x

(b)

IC WB NWB

0.8

1

Figure 5. Isothermal test: long time solution profiles when  = 1 for (A)  and (B) q.

2.8 2.6 2.4 2.2
2 1.8 1.6 1.4 1.2
1 0

T = 100

IC WB NWB

0.2

0.4

0.6

0.8

1

x

(a)

q

10 10-3 5

T = 100

IC WB NWB

0

-5

0

0.2

0.4

0.6

0.8

1

x

(b)

Figure 6. Isothermal test: long time solution profiles when  = 0.1 for (A)  and (B) q.

2.8 2.6 2.4 2.2
2 1.8 1.6 1.4 1.2
1 0

T = 100

IC WB NWB

0.2

0.4

0.6

0.8

1

x

(a)

q

5 10-3

4

3

2

1

0

-1

-2

-3

0

0.2

T = 100

0.4

0.6

x

(b)

IC WB NWB

0.8

1

Figure 7. Isothermal test: long time solution profiles when  = 0.01 for (A)  and (B) q.

UNIFIED AP AND WELL-BALANCED SCHEME

17

2.8 2.6 2.4 2.2
2 1.8 1.6 1.4 1.2
1 0

T = 100

IC WB NWB

0.2

0.4

0.6

0.8

1

x

(a)

q

8 10-5

6

4

2

0

-2

-4

-6

-8

0

0.2

T = 100

0.4

0.6

x

(b)

IC WB NWB

0.8

1

Figure 8. Isothermal test: long time solution profiles when  = 0.001 for (A)  and (B) q.

5.2.2. Isentropic Hydrostatic Solution. In this test case, we solve the system which is initially in isentropic hydrostatic equilibrium for  = 1. The initial data reads

(5.5)

1

-1

-1

(0, x)  e(x) = 1 +  (x)

, u(0, x)  ue(x) = 0.

The domain is [0, 1] and the boundary conditions are interpolation. We also take the specific heat ratio to be  = 1.4.
First, for a range of , we test the L1 error of the scheme for different potential functions and for different mesh sizes. The simulations are run for a final time of T = 2. Results are presented in Table 2. Similar to the isothermal hydrostatic test case, here too we observe good precision in preserving the steady state solution.

 x x2/2 sin(2x)

N 100 1000 100 1000 100 1000

=1 Error in  3.0399E-07 3.0717E-09 1.5297E-07 1.4429E-09 3.5858E-05 3.5668E-07

Error in q 7.6093E-07 7.4895E-09 1.8205E-07 1.7516E-09 1.6335E-06 3.4458E-09

 x x2/2 sin(2x)

N 100 1000 100 1000 100 1000

 = 0.1 Error in  8.8097E-08 8.9517E-10 1.3723E-07 1.2993E-09 3.6382E-05 3.5705E-07

Error in q 2.2017E-06 2.1593E-08 5.0076E-07 4.8594E-09 4.4131E-06 4.4168E-09

 x x2/2 sin(2x)

 = 0.01 N Error in  100 2.2198E-08 1000 2.0347E-10 100 1.3446E-07 1000 1.2895E-09 100 3.6564E-05 1000 3.5718E-07

Error in q 2.6719E-06 2.6542E-08 5.9381E-07 5.8580E-09 5.1607E-06 5.1886E-09

 x x2/2 sin(2x)

 = 0.001 N Error in  100 1.8445E-08 1000 1.6062E-10 100 1.3427E-07 1000 1.2840E-09 100 3.6580E-05 1000 3.5719E-07

Error in q 2.7065E-06 2.7060E-08 5.9992E-07 5.9572E-09 5.2108E-06 5.2778E-09

Table 2. Errors in the density  and the momentum q for different potentials and for a range of  using different mesh sizes in the isentropic test case.

18

ARUN, KRISHNAN, AND SAMANTARAY

Perturbation perturbation perturbation

10-3 1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.2

T = 0.25

0.4

0.6

x

(a)

IP WB NWB

0.8

1

4.5 10-4

4

3.5

3

2.5

2

1.5

1

0.5

0

0

0.2

T = 0.25

0.4

0.6

x

(b)

IP WB NWB

0.8

1

1 10-5

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.2

T = 0.25

0.4

0.6

x

(c)

IP WB

0.8

1

Figure 9. Isentropic test: evolution in the density perturbation in the non-stiff regime for  = 1. (a)  = 10-3 (b)  = 10-5; comparison of well-balanced scheme with non-well balanced (c)  = 10-5; comparison of well-balanced scheme with initial
perturbation.

Next, we test the efficacy of the scheme in simulating the evolution of small density perturbations added to the initial data, i.e.

1

(0, x) =

-1

1+

(x)

-1 + exp(-100(x - 0.5)2).



Simulations are performed upto a final time T = 0.25 on a mesh of 100 cells with interpolation boundary conditions for  = 10-3, 10-5. The results are presented in Figure 9 for the non-stiff regime. Evidently the well-balanced scheme is able to resolve the solution much better than the non well-balanced scheme for both high and low values of . In the stiff regime, the non well-balanced scheme's performance improves due to its AP property as is evident from Figure 10.
Thus in this subsection, we have shown that the scheme performs well in maintaining the steady states of the Euler system for both isothermal and isentropic equations of state with very good accuracy.

perturbation perturbation

1 10-3

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.2

T = 0.25

0.4

0.6

x

(a)

IP WB NWB

0.8

1

1 10-5

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.2

T = 0.25

0.4

0.6

x

(b)

IP WB NWB

0.8

1

Figure 10. Isentropic test: evolution in the density perturbation in the stiff regime for  = 0.001 for (a)  = 10-3 (b)  = 10-5.

UNIFIED AP AND WELL-BALANCED SCHEME

19

5.3. Sensitivity to Mesh Size. In this test, our aim is to study the dependence of the accuracy of the scheme on mesh sizes in the asymptotic regime ( = 0.001) by comparing it with a non AP scheme. For this purpose, the initial data as given in [15] which is a centered arch function and it reads

(5.6)

(1, 0), if - 0.2 < x < 0.2, (, u) =
(2, 0), otherwise,

in the domain [-0.5, 0.5] with periodic boundary conditions and CFL = 0.45. The test is carried out for both hyperbolic and parabolic relaxations. Figure 11a shows that the AP scheme's performance does not show any dependence on the mesh sizes, giving almost identical results for under-resolved (x = 0.01), resolved (x = 0.001), and over-resolved (x = 0.0001) meshes in the parabolic regime. However, the non AP scheme blows up for the under-resolved mesh (Figure 11b), but it shows results similar to the AP scheme for the resolved and over-resolved meshes as can be seen from Figure 11c. Similar conclusions can again be drawn in the case of hyperbolic relaxation. Results are presented in Figure 12. Even though a blowup is not observed for the non AP scheme, oscillations can be seen at the discontinuities on the under-resolved mesh.

1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1
1 -0.5

T = 0.01
0 x
(a)

x = 0.01 x = 0.001 x = 0.0001
0.5

107 6 4 2 0 -2 -4 -6 -0.5

T = 0.000084
0 x
(b)

x = 0.01 0.5

1.8 1.7 1.6 1.5 1.4 1.3 1.2 1.1
1 -0.5

T = 0.01

x = 0.001 x = 0.0001

0

0.5

x

(c)

Figure 11. Mesh sensitivity test: solution profile of  for different mesh sizes for  = 0.001 (A) AP scheme (B) non AP scheme, x = 0.01 (C) non AP scheme, x = 0.001, 0.0001.

6. Concluding Remarks
We have designed and analysed a unified AP scheme which captures both the hyperbolic and parabolic limits of the Euler system with gravity and friction. The time semi-discrete and semiimplicit scheme is based on the ideas presented in [7]. A reformulation of the semi-implicit scheme admits a fully-explicit formulation which is stable under a parabolic CFL condition. Though for the hyperbolic relaxation the time steps are dependent on , the CFL restriction does not degrade; rather it becomes less and less severe as   0. A fully-discrete scheme is obtained using a finite volume treatment which makes use of an equilibrium reconstruction of the interface values, source term upwinding and a gingerly choice of central discretisation for the mass update. Both the semi-discrete and space-time fully-discrete scheme are shown to be AP for both the hyperbolic and parabolic limit equations. Furthermore, the fully-discrete scheme is shown to well-balanced for hydrostatic steady states. The numerical case studies presented clearly demonstrate the AP and well-balancing properties of the developed scheme. They also showcase the superiority of the designed scheme over its non well-balanced and non AP counterparts. In conclusion, the aim of

20

ARUN, KRISHNAN, AND SAMANTARAY

2.2 2
1.8 1.6 1.4 1.2
1 0.8
-0.5

T = 0.01
0 x
(a)

x = 0.01 x = 0.001 x = 0.0001
0.5

T = 0.01

2.2

x = 0.01

x = 0.001

2

x = 0.0001

1.8

1.6

1.4

1.2

1

-0.4 -0.3 -0.2 -0.1 0 0.1 0.2 0.3 0.4 0.5 x
(b)

Figure 12. Mesh sensitivity test: solution profile of  for different mesh sizes for different mesh sizes when  = 0.001 (A) AP scheme (B) non AP scheme.

developing a unified AP and well-balanced scheme is achieved and is justified through the material presented in the paper.

References
[1] G. Albi, G. Dimarco, and L. Pareschi. Implicit-explicit multistep methods for hyperbolic systems with multiscale relaxation. SIAM J. Sci. Comput., 42(4):A2402­A2435, 2020.
[2] D. Aregba-Driollet and R. Natalini. Convergence of relaxation schemes for conservation laws. Appl. Anal., 61(12):163­193, 1996.
[3] K. R. Arun and S. Samantaray. Asymptotic preserving low Mach number accurate IMEX finite volume schemes for the isentropic Euler equations. J. Sci. Comput., 82(2):Art. 35, 32, 2020.
[4] E. Audusse, F. Bouchut, M.-O. Bristeau, R. Klein, and B. Perthame. A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows. SIAM J. Sci. Comput., 25(6):2050­2065, 2004.
[5] G. Bispen, K. R. Arun, M. Luka´cova´-Medvid'ova´, and S. Noelle. IMEX large time step finite volume methods for low Froude number shallow water flows. Commun. Comput. Phys., 16(2):307­347, 2014.
[6] G. Bispen, M. Luka´cova´-Medvidov´a, and L. Yelash. Asymptotic preserving IMEX finite volume schemes for low Mach number Euler equations with gravitation. J. Comput. Phys., 335:222­248, 2017.
[7] S. Boscarino, L. Pareschi, and G. Russo. A unified IMEX Runge-Kutta approach for hyperbolic systems with multiscale relaxation. SIAM J. Numer. Anal., 55(4):2085­2109, 2017.
[8] S. Boscarino and G. Russo. Flux-explicit IMEX Runge-Kutta schemes for hyperbolic to parabolic relaxation problems. SIAM J. Numer. Anal., 51(1):163­190, 2013.
[9] F. Bouchut. Construction of BGK models with a family of kinetic entropies for a given system of conservation laws. J. Statist. Phys., 95(1-2):113­170, 1999.
[10] F. Bouchut. Nonlinear stability of finite volume methods for hyperbolic conservation laws and well-balanced schemes for sources. Frontiers in Mathematics. Birkha¨user Verlag, Basel, 2004.
[11] F. Bouchut, E. Franck, and L. Navoret. A low cost semi-implicit low-Mach relaxation scheme for the full Euler equations. J. Sci. Comput., 83(1):Paper No. 24, 47, 2020.
[12] R. E. Caflisch, S. Jin, and G. Russo. Uniformly accurate schemes for hyperbolic systems with relaxation. SIAM J. Numer. Anal., 34(1):246­281, 1997.
[13] C. Cercignani. The Boltzmann equation and its applications, volume 67 of Applied Mathematical Sciences. Springer-Verlag, New York, 1988.
[14] C. Cercignani, R. Illner, and M. Pulvirenti. The mathematical theory of dilute gases, volume 106 of Applied Mathematical Sciences. Springer-Verlag, New York, 1994.
[15] C. Chalons, F. Coquel, E. Godlewski, P.-A. Raviart, and N. Seguin. Godunov-type schemes for hyperbolic systems with parameter-dependent source. The case of Euler system with friction. Math. Models Methods Appl. Sci., 20(11):2109­2166, 2010.

UNIFIED AP AND WELL-BALANCED SCHEME

21

[16] S. Chapman and T. G. Cowling. The Mathematical Theory of Non-uniform Gases. Cambridge University Press, Cambridge, 1939.
[17] G. Q. Chen, C. D. Levermore, and T.-P. Liu. Hyperbolic conservation laws with stiff relaxation terms and entropy. Comm. Pure Appl. Math., 47(6):787­830, 1994.
[18] A. Chinnayya, A.-Y. LeRoux, and N. Seguin. A well-balanced numerical scheme for the approximation of the shallow-water equations with topography: the resonance phenomenon. Int. J. Finite Vol., 1(1):33, 2004.
[19] P. Degond and M. Tang. All speed scheme for the low Mach number limit of the isentropic Euler equations. Commun. Comput. Phys., 10(1):1­31, 2011.
[20] G. Dimarco, R. Loub`ere, and M.-H. Vignal. Study of a new asymptotic preserving scheme for the Euler system in the low Mach number limit. SIAM J. Sci. Comput., 39(5):A2099­A2128, 2017.
[21] G. Dimarco and L. Pareschi. Exponential Runge-Kutta methods for stiff kinetic equations. SIAM J. Numer. Anal., 49(5):2057­2077, 2011.
[22] U. S. Fjordholm, S. Mishra, and E. Tadmor. Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography. J. Comput. Phys., 230(14):5587­5609, 2011.
[23] J. M. Gallardo, C. Par´es, and M. Castro. On a well-balanced high-order finite volume scheme for shallow water equations with topography and dry areas. J. Comput. Phys., 227(1):574­601, 2007.
[24] L. Gosse. A well-balanced flux-vector splitting scheme designed for hyperbolic systems of conservation laws with source terms. Comput. Math. Appl., 39(9-10):135­159, 2000.
[25] J. M. Greenberg and A. Y. Leroux. A well-balanced scheme for the numerical processing of source terms in hyperbolic equations. SIAM J. Numer. Anal., 33(1):1­16, 1996.
[26] S. Jin. Runge-Kutta methods for hyperbolic conservation laws with stiff relaxation terms. J. Comput. Phys., 122(1):51­67, 1995.
[27] S. Jin. Efficient asymptotic-preserving (AP) schemes for some multiscale kinetic equations. SIAM J. Sci. Comput., 21(2):441­454, 1999.
[28] S. Jin. Asymptotic preserving (AP) schemes for multiscale kinetic and hyperbolic equations: a review. Riv. Math. Univ. Parma (N.S.), 3(2):177­216, 2012.
[29] S. Jin and C. D. Levermore. Numerical schemes for hyperbolic conservation laws with stiff relaxation terms. J. Comput. Phys., 126(2):449­467, 1996.
[30] S. Jin, L. Pareschi, and G. Toscani. Diffusive relaxation schemes for multiscale discrete-velocity kinetic equations. SIAM J. Numer. Anal., 35(6):2405­2439, 1998.
[31] S. Jin, L. Pareschi, and G. Toscani. Uniformly accurate diffusive relaxation schemes for multiscale transport equations. SIAM J. Numer. Anal., 38(3):913­936, 2000.
[32] S. Jin and Z. P. Xin. The relaxation schemes for systems of conservation laws in arbitrary space dimensions. Comm. Pure Appl. Math., 48(3):235­276, 1995.
[33] S. Klainerman and A. Majda. Singular limits of quasilinear hyperbolic systems with large parameters and the incompressible limit of compressible fluids. Comm. Pure Appl. Math., 34(4):481­524, 1981.
[34] A. Klar. An asymptotic-induced scheme for nonstationary transport equations in the diffusive limit. SIAM J. Numer. Anal., 35(3):1073­1094, 1998.
[35] A. Kurganov and G. Petrova. A second-order well-balanced positivity preserving central-upwind scheme for the Saint-Venant system. Commun. Math. Sci., 5(1):133­160, 2007.
[36] M. Lemou and L. Mieussens. A new asymptotic preserving scheme based on micro-macro formulation for linear kinetic equations in the diffusion limit. SIAM J. Sci. Comput., 31(1):334­368, 2008.
[37] T.-P. Liu. Hyperbolic conservation laws with relaxation. Comm. Math. Phys., 108(1):153­175, 1987. [38] R. Natalini. Convergence to equilibrium for the relaxation approximations of conservation laws. Comm. Pure
Appl. Math., 49(8):795­823, 1996. [39] R. Natalini. Recent results on hyperbolic relaxation problems. In Analysis of systems of conservation laws
(Aachen, 1997), volume 99 of Chapman & Hall/CRC Monogr. Surv. Pure Appl. Math., pages 128­198. Chapman & Hall/CRC, Boca Raton, FL, 1999. [40] R. Natalini, M. Ribot, and M. Twarogowska. A well-balanced numerical scheme for a one dimensional quasilinear hyperbolic model of chemotaxis. Commun. Math. Sci., 12(1):13­39, 2014. [41] R. Natalini, M. Ribot, and M. Twarogowska. A numerical comparison between degenerate parabolic and quasilinear hyperbolic models of cell movements under chemotaxis. J. Sci. Comput., 63(3):654­677, 2015. [42] S. Noelle, G. Bispen, K. R. Arun, M. Luka´cova´-Medvidov´a, and C.-D. Munz. A weakly asymptotic preserving low Mach number scheme for the Euler equations of gas dynamics. SIAM J. Sci. Comput., 36(6):B989­B1024, 2014.

22

ARUN, KRISHNAN, AND SAMANTARAY

[43] S. Noelle, N. Pankratz, G. Puppo, and J. R. Natvig. Well-balanced finite volume schemes of arbitrary order of accuracy for shallow water flows. J. Comput. Phys., 213(2):474­499, 2006.
[44] S. Noelle, Y. Xing, and C.-W. Shu. High-order well-balanced finite volume WENO schemes for shallow water equation with moving water. J. Comput. Phys., 226(1):29­58, 2007.
[45] L. Pareschi and G. Russo. Implicit-explicit Runge-Kutta schemes for stiff systems of differential equations. In Recent trends in numerical analysis, volume 3 of Adv. Theory Comput. Math., pages 269­288. Nova Sci. Publ., Huntington, NY, 2001.
[46] L. Pareschi and G. Russo. Implicit-Explicit Runge-Kutta schemes and applications to hyperbolic systems with relaxation. J. Sci. Comput., 25(1-2):129­155, 2005.
[47] B. Perthame and C. Simeoni. Convergence of the upwind interface source method for hyperbolic conservation laws. In Hyperbolic problems: theory, numerics, applications, pages 61­78. Springer, Berlin, 2003.
[48] A. Thomann, G. Puppo, and C. Klingenberg. An all speed second order well-balanced IMEX relaxation scheme for the Euler equations with gravity. J. Comput. Phys., 420:109723, 25, 2020.
[49] D. Varma and P. Chandrashekar. A second-order, discretely well-balanced finite volume scheme for Euler equations with gravity. Comput. & Fluids, 181:292­313, 2019.
[50] G. B. Whitham. Linear and nonlinear waves. Wiley-Interscience [John Wiley & Sons], New York-London-Sydney, 1974. Pure and Applied Mathematics.
[51] Y. Xing and C.-W. Shu. High order finite difference WENO schemes with the exact conservation property for the shallow water equations. J. Comput. Phys., 208(1):206­227, 2005.
[52] Y. Xing and C.-W. Shu. High order well-balanced finite volume WENO schemes and discontinuous Galerkin methods for a class of hyperbolic systems with source terms. J. Comput. Phys., 214(2):567­598, 2006.
[53] K. Xu. A well-balanced gas-kinetic scheme for the shallow-water equations with source terms. J. Comput. Phys., 178(2):533­562, 2002.
School of Mathematics, Indian Institute of Science Education and Research Thiruvananthapuram, Thiruvananthapuram 695551, India
Email address: arun@iisertvm.ac.in
School of Mathematics, Indian Institute of Science Education and Research Thiruvananthapuram, Thiruvananthapuram 695551, India
Email address: meena9916@iisertvm.ac.in
Department of Physics, University of Notre Dame, Nieuwland Science Hall, Notre Dame, IN 46556, USA
Email address: ssamanta@nd.edu

