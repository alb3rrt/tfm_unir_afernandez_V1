arXiv:2106.00680v2 [math.CA] 9 Jun 2021

THE MEASURES WITH L2-BOUNDED RIESZ TRANSFORM AND THE PAINLEVÉ PROBLEM FOR LIPSCHITZ HARMONIC FUNCTIONS

XAVIER TOLSA

Abstract. This work provides a geometric characterization of the measures µ in Rn+1

with polynomial upper growth of degree n such that the n-dimensional Riesz transform

Rµ(x) = ´

x-y |x-y|n+1

dµ(y)

belongs

to

L2(µ).

More

precisely,

it

is

shown

that

Rµ

2 L2 (µ)

+

µ



^

^ 2,µ(x, r)2
0

µ(B(x, r)) rn

dr r

dµ(x) +

µ,

where

µ,2(x, r)2

=

inf L

1 rn

´
B(x,r)

dist(y,L) r

2
dµ(y), with the infimum taken over all

affine n-planes L  Rn+1. As a corollary, one obtains a characterization of the removable

sets for Lipschitz harmonic functions in terms of a metric-geometric potential and one

deduces that the class of removable sets for Lipschitz harmonic functions is invariant by

bilipschitz mappings.

Contents

1. Introduction

2

2. The modified dyadic lattice of David and Mattila and the dyadic martingale

decomposition

8

2.1. The David-Mattila lattice

8

2.2. The dyadic martingale decomposition and the additional properties from [DT] 10

3. The family hdk(Q) and the Main Proposition

12

3.1. P-doubling cubes and the family hdk(Q)

12

3.2. The energies E, EH , E, and the Main Proposition

13

4. The good dominating family GDF

16

5. The cubes with moderate decrement of Wolff energy and the associated

tractable trees

21

6. The layers Fhj and Lhj and the typical tractable trees

26

7. Lower estimates for the Riesz transform of the approximating measure  in a

typical tractable tree

32

8. Lower estimates for the Haar coefficients of Rµ for cubes near a typical

tractable tree

34

8.1. The operators RTReg , RT , and T R

34

2020 Mathematics Subject Classification. 42B20, 28A75, 49Q15. Supported by 2017-SGR-0395 (Catalonia), MTM-2016-77635-P (MINECO, Spain), and by the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme (grant agreement 101018680).
1

2

XAVIER TOLSA

8.2. Estimates for the P and QReg coefficients of some cubes from End and Reg 36

8.3. Transference of the lower estimates for R to T Rµ

46

9. The proof of Proposition 3.7

56

9.1. Estimate of T1

57

9.2. Estimate of T2

58

References

59

1. Introduction

Given a Radon measure µ in Rn+1, its (n-dimensional) Riesz transform at x  Rn+1 is

defined by

^ Rµ(x) =

|x

x-y - y|n+1

dµ(y),

whenever the integral makes sense. For f  L1loc(µ), one writes Rµf (x) = R(f µ)(x). Given  > 0, the -truncated Riesz transform of µ equals

Rµ(x)

=

^
|x-y|>

|x

x-y - y|n+1

dµ(y),

and the operator Rµ, is defined by Rµ,f (x) = R(f µ)(x). We say that Rµ is bounded in L2(µ) if the operators Rµ, are bounded uniformly in
L2(µ) uniformly on , and then we denote

Rµ L2(µ)L2(µ) = sup Rµ, L2(µ)L2(µ).
>0

We also write

Rµ(x) = sup |Rµ(x)|,
>0

pv

Rµ(x)

=

lim
>0

Rµ(x),

in case that the latter limit exists. Remark that, sometimes, abusing notation we will write

Rµ instead of pv Rµ.

This paper provides a full geometric description of the measures µ with no point masses such that Rµ is bounded in L2(µ). In the case n = 1, such description has already been
obtained (see [MV], [Lé], [To1]), relying on the connection between Menger curvature and

the Cauchy kernel found by Melnikov [Me]. In higher dimensions, a similar connection is

missing, and thus the obtention of analogous results presents major difficulties. In the case

when the measure µ is AD-regular (i.e., Ahlfors-David regular) that geometric description

is equivalent to the codimension 1 David-Semmes problem, solved by Nazarov, the author

of the current paper, and Volberg in [NToV1]. Recall that a measure µ is AD-regular (or

n-AD-regular) if there exists a constant C > 0 such that

C-1 rn  µ(B(x, r))  C rn for all x  supp µ and 0 < r  diam(supp µ).

One of the main motivations for the description of the measures µ such that Rµ is bounded in L2(µ) is the characterization of the removable singularities for Lipschitz harmonic functions. Also, one may expect other applications regarding the study of harmonic and elliptic measures. Indeed, in some of the recent advances on this topic, the connection between harmonic measure, the Riesz transform, and rectifiability has played an essential role (see [AHM+], [AMT], and [AMTV], for example).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

3

Next we need to introduce additional notation. For a ball B  Rn+1, we consider its n-dimensional density (with respect to µ):

µ(B)

=

µ(B) r(B)n

,

and its 2,µ coefficient:

2,µ(B)

=

inf
L

1^ r(B)n B

dist(x, L) r(B)

2
dµ(x)

1/2
,

where the infimum is taken over all n-planes L  Rn+1 and r(B) stands for the radius of B. For B = B(x, r) we may also write µ(x, r) and 2,µ(x, r) instead of µ(B) and 2,µ(B). The coefficients 2,µ were introduced by David and Semmes in their fundamental works [DS1], [DS2] on uniform rectifiability. They can be considered as L2 variants of some analogous coefficients considered previously by Peter Jones in his celebrated travelling salesman theorem [Jo].
The first main result of this paper is the following.

Theorem 1.1. Let µ be a Radon measure in Rn+1 satisfying the polynomial growth condition

(1.1)

µ(B(x, r))  0 rn for all x  supp µ and all r > 0

and such that Rµ(x) <  µ-a.e. Then

(1.2)

^

^
0

2,µ(x,

r)2

µ(x,

r)

dr r

dµ(x)



C

(

pv Rµ

2 L2 (µ)

+

02

µ

,

where C is an absolute constant.

Let us remark that the growth condition (1.1) and the assumption that Rµ(x) <  µ-a.e. imply the existence of principal values pv Rµ(x) µ-a.e., by [NToV2], and so

pv Rµ L2(µ) is well defined. A converse to the estimate (1.2) also holds: if µ satisfies the growth condition (1.1),

then

(1.3)

pv Rµ

2 L2 (µ)

C

^

^
0

2,µ(x,

r)2

µ(x,

r)

dr r

dµ(x)

+

C

02

µ,

where C is an absolute constant. This was shown in [AT] in the case n = 1, and in [Gi] in

full generality.

From (1.3), Theorem 1.1, and a direct application of the T 1 theorem for non-doubling

measures ([NTrV1], [NTrV2]) one deduces the following.

Theorem 1.2. Let µ be a Radon measure in Rn+1 with no point masses. Then Rµ is bounded in L2(µ) if and only if it satisfies the polynomial growth condition

(1.4)

µ(B(x, r))  C rn for all x  supp µ and all r > 0

and

(1.5)

^
B

^ r(B)
0

2,µ(x,

r)2

µ(x,

r)

dr r

dµ(x)



C2

µ(B)

for any ball B  Rn+1.

Further, the optimal constant C is comparable to Rµ L2(µ)L2(µ).

4

XAVIER TOLSA

In the case n = 1 the preceding results are already known. They were proven in [AT],
relying on the corona decomposition involving the curvature of µ from [To3]. Further, for
arbitrary n > 1, Theorems 1.1 and 1.2 were proven recently by Dbrowski and the author
[DT] for a special class of measures µ with an appropriate Wolff type energy satisfying
some scale invariant estimates. In fact, the proof of Theorems 1.1 and 1.2 in full generality
in the current paper relies heavily on the results from [DT]. It is also known that if one assumes that there exists a sufficiently large class of L2(µ)
bounded singular integral operators with an odd Calderón-Zygmund kernel, then the condition (1.5) holds, in any codimension (i.e., assuming that, instead of Rn+1, the ambient space is Rd, with d  n). This was proved in [JNT].
Observe that, when µ is n-AD-regular, µ(x, r)  1 for all x  supp µ and 0 < r  diam(supp µ), and so the condition (1.5) is equivalent to the uniform n-rectifiability of µ, by [DS1]. So one deduces that the L2(µ) boundedness of Rµ implies the uniform nrectifiability of µ and then one recovers the solution of the David-Semmes problem from [NToV1]. Recall that a measure µ in Rd is called uniformly n-rectifiable (UR) if it is
n-AD-regular and there exist constants , M > 0 such that for all x  supp µ and all 0 < r  diam(supp µ) there is a Lipschitz mapping g from the ball Bn(0, r)  Rn to Rd with Lip(g)  M such that
µ(B(x, r)  g(Bn(0, r)))   rn.
It is worth comparing Theorem 1.2 with a related result obtained in [JNRT] in connection with the fractional Riesz transform Rs associated with the kernel x/|x|s+1 for s  (n, n+1). The precise result, which involves the s-dimensional density µs (x, r) = µ(B(x, r))r-s, is the following.

Theorem ([JNRT]). Let µ be a Radon measure in Rn+1 with no point masses and let s  (n, n + 1). Then Rsµ is bounded in L2(µ) if and only if

(1.6)

^
B

^ r(B)
0

µs (x,

r)2

dr r

dµ(x)



C2

µ(B)

for any ball B  Rn+1.

Further, the optimal constant C is comparable to Rsµ L2(µ)L2(µ).

In the preceding theorem one does not need to ask any growth condition analogous
to (1.4) (with n interchanged with s) because this condition is already implied by (1.6). Observe that in (1.6) the density µs (x, r) replaces 2,µ(x, r)2 in (1.5), which scales similarly to s(x, r) when n = s. On the other hand, the proof of the last theorem in [JNRT] makes
an extensive use of blowup techniques, which essentially rely on the fact that any measure µ satisfying the growth condition µ(B(x, r))  rs for all x  Rn+1, r > 0, and such that Rsµ = 0 in a suitable BM O(µ) sense, must be the zero measure (see [JN1], [JN2]). In the
codimension 1 case, one might expect that if µ satisfies (1.4) and Rµ = 0 in the BM O(µ) sense, then µ = cHn|L for some n-plane L. However, this is still an open problem. If this were known to be true, probably in the present paper (and in [DT]) we could use blowup
arguments analogous to the ones in [JNRT].
As shown in [AT], the finiteness of the double integral on the left hand side of (1.2) is
equivalent to the existence of a suitable corona decomposition for µ satisfying an appropri-
ate packing condition. This condition is stable by bilipschitz maps (see also [Gi] for more
details). So we get the following corollary.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

5

Corollary 1.3. Let µ be a Radon measure in Rn+1 with no point masses. Let  : Rn+1  Rn+1 be a bilipschitz map. Let  = #µ be the image measure of µ by . If Rµ is bounded in L2(µ), then R is bounded in L2(). Further,
R L2()L2()  C Rµ L2(µ)L2(µ),
where C depends only on the bilipschitz constant of .

Remark that, up to now, the preceding result was not known even for the case of invertible affine maps such as the one defined by
(x1, . . . , xn+1) = (2x1, x2, . . . , xn+1). As shown in [Gi], the conditions (1.4) and (1.5) imply the L2(µ) boundedness of any singular integral operator of the form
^ Tµf (x) = K(x - y) f (y) dµ(y),

where K is an odd kernel such that

(1.7)

|j K (x)|

1 |x|n+j

for all x = 0 and 0  j  2

(remark that Tµ is said to be bounded in L2(µ) is the truncated operators Tµ,, defined analogously to Rµ,, are bounded in L2(µ) uniformly on  > 0). Then we deduce the following.

Corollary 1.4. Let µ be a Radon measure in Rn+1 with no point masses. Let Tµ be a singular integral operator associated with an odd kernel K satisfying (1.7). If Rµ is bounded in L2(µ), then Tµ is also bounded in L2(µ). Further,

Tµ L2(µ)L2(µ)  C Rµ L2(µ)L2(µ), where C depends just on n and the implicit constants in (1.7).

Lipschitz We turn now to the applications of the results above to Lipschitz harmonic functions and Lipschitz harmonic capacity. Given a compact set E  Rn+1, one says that E is removable for Lipschitz harmonic functions if for any open set   E, any function f :   R which is Lipschitz in  and harmonic in  \ E can be extended in a harmonic way to the whole . To study this problem and some related questions on approximation by Lipschitz harmonic functions it is useful to introduce the Lipschitz harmonic capacity  (see [Pa] and [MP]). This is defined by
(E) = sup | f, 1 |,
where the supremum is taken over all Lipschitz functions f : Rn+1  R which are harmonic in Rn+1 \ E and satisfy f   1, with f understood in the sense of distributions. It turns out that E is removable for Lipschitz harmonic functions if and only if (E) = 0.
Extending previous results for analytic capacity from [To2], Volberg showed in [Vo] that
(E)  sup µ(E),
where the supremum is taken over all measures µ satisfying the polynomial growth condition (1.4) with constant C = 1 and such that Rµ L2(µ)L2(µ)  1. Combining this result with Theorem 1.2, we obtain:

6

XAVIER TOLSA

Corollary 1.5. Let E  Rn+1 be compact. Then

(E)  µ(E),

where the supremum is taken over all Radon measures µ such that µ(B(x, r))  rn for all x  supp µ and all r > 0

and

^

^
0

2,µ(x,

r)2

µ(x,

r)

dr r

dµ(x)



µ(E).

To derive this corollary, remark that if µ satisfies the conditions above, by Chebyshev one
deduces that there is a big piece F  E  supp µ, with µ(F )  µ(E), such that the measure µ = µ|F satisfies (1.5), and so Rµ is bounded in L2(µ). Hence (E) µ(F )  µ(E). The converse direction of the corollary is a straightforward consequence of the aforementioned
theorem of Volberg and Theorem 1.2.
As explained above, the conditions on the measure µ in Corollary 1.5 are stable by bilipschitz maps. So we deduce that if  : Rn+1  Rn+1 is bilipschitz, then

(E)  ((E)) for any compact set E  Rn+1,

with the implicit constant just depending on the bilipschitz constant of  and the ambient dimension.
Another suggestive characterization of the capacity (E) can be given in terms of the following potential, which we call the Jones-Wolff potential of µ:

Uµ(x) = sup µ(x, r) +
r>0

^
0

2,µ(x,

r)2

µ(x,

r)

dr r

1/2
.

Corollary 1.6. Let E  Rn+1 be compact. Then

(E)  sup{µ(E) : Uµ(x)  1 x  E}.

An immediate consequence of this result is that E is non-removable for Lipschitz harmonic functions if and only if it supports a non-zero measure such that Uµ(x)  1 for all x  E.
The characterization of the capacity  and of removable sets for Lipschitz harmonic functions in terms of a metric-geometric potential such as Uµ should be considered as an analogue of the characterization of analytic capacity and of removable sets for bounded analytic functions in terms of curvature of measures [To2]. So one can think of the results stated in Corollaries 1.5 and 1.6 as possible solutions of the Painlevé problem for Lipschitz harmonic functions.

Next we describe the main ideas involved in the proof of Theorem 1.1. As explained above, the proof relies on the results obtained in [DT]. More precisely, for a Radon measure  we consider the Wolff type energy

^^  E() =
0

(B(x, r))

rn-

3 8

2

dr r

^^ d(x) =



r

3 4

0

(B(x, r)2

dr r

d(x).

As in [DT], given the Radon measure µ, we consider a suitably modified version of the David-Mattila lattice Dµ associated with µ. Then for a given P-doubling cube Q  Dµ, we

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

7

let E(4Q) be an appropriate discrete version of E(µ|4Q) (Q)-3/4. We say that a P-doubling cube Q has high energy, and we write Q  HE, if

E(4Q)  M02 (Q)2 µ(Q),

where M0  1 is some fixed constant, (Q) is another discrete version of µ(2BQ), and BQ is a ball concentric with Q, containing Q, with radius comparable to (Q) (for the precise definitions of P-doubling cubes, (Q), and E(4Q) see Section 3). In [DT, Main
Theorem 3.4] it is shown that

^

^
0

2,µ(x,

r)2

µ(x,

r)

dr r

dµ(x)



C

Rµ

2 L2 (µ)

+

02

µ

+

E(4Q) ,

QHE

So to prove Theorem 1.1 it suffices to show that

(1.8)

E(4Q)  C

Rµ

2 L2 (µ)

+

02

µ

.

QHE

This is the task we perform in this paper (see Main Proposition 3.7). To prove (1.8) we introduce in Section 3 a related energy E which is more appropriate
for the stopping time conditions and the bootstrapping argument involved in the proof of (1.8). The objective is then to show that the family DB of P-doubling cubes Q such that

E(9Q)  M0 (Q)2 µ(Q)

satisfies a Carleson type estimate analogous to (1.8). The first step is the construction of a family (called GDF) of cubes Q which, in a sense, contain many stopping cubes whose density is much larger than the density (Q). The selection of this family, in Section 4, is one of the key steps for the proof proof of Theorem 1.1. In Section 5 we associate a family of "tractable trees" of cubes with each cube from GDF, by arguments somewhat similar to others appearing in [DT], although here we need to consider different and additional stopping conditions. In the tractable trees the density of µ oscillates in such a way that one can bound from below the Haar coefficients of Rµ for the cubes which belong to that tree or are close to that tree. For each tractable tree T , this is shown by a variational argument applied to a measure  that approximates the measure µ at the level of some regularized stopping cubes of T . This argument provides a lower estimate for R Lp(), essentially in the same way as in [DT], and so we refer to the appropriate lemma from [DT] when this is required in Section 7.
To complete the estimates from below for the Haar coefficients of Rµ near the tree T , in Section 8 we transfer the lower estimates obtained for R Lp() to Rµ. This is another of the delicate key points of the proof of Theorem 1.2. It requires much more precise estimates than other related arguments appearing in [DT] or [JNRT], mainly because the presence of cubes from DB (or HE) in the tree T originates "error terms" in the transference of those estimates which are difficult to control. Most important, we can only quantify the presence of cubes from DB in most of the trees T by a bootstrapping argument which gives rather weak bounds.

In the whole paper we denote by C or c some constants that may depend on the dimension and perhaps other fixed parameters. Their values may change at different occurrences. On the contrary, constants with subscripts, like C0, retain their values. For a, b  0, we write a b if there is C > 0 such that a  Cb. We write a  b to mean a b a.

8

XAVIER TOLSA

2. The modified dyadic lattice of David and Mattila and the dyadic martingale decomposition

2.1. The David-Mattila lattice. We recall now the properties of the dyadic lattice of cubes with small boundaries of David-Mattila associated with a Radon measure µ. This lattice has been constructed in [DM, Theorem 3.2]. Later on we will state some additional useful properties of Dµ that are obtained by modifying its construction as in [DT].

Lemma 2.1 (David, Mattila). Let µ be a compactly supported Radon measure in Rd.
Consider two constants C0 > 1 and A0 > 5000 C0 and denote E = supp µ. Then there exists a sequence of partitions of E into Borel subsets Q, Q  Dµ,k, with the following properties:

· For each integer k  0, E is the disjoint union of the "cubes" Q, Q  Dµ,k, and if k < l, Q  Dµ,l, and R  Dµ,k, then either Q  R =  or else Q  R.

· The general position of the cubes Q can be described as follows. For each k  0 and each cube Q  Dµ,k, there is a ball B(Q) = B(xQ, r(Q)) such that

xQ  E,

A-0 k  r(Q)  C0 A-0 k,

E  B(Q)  Q  E  28 B(Q) = E  B(xQ, 28r(Q)),

and the balls 5B(Q), Q  Dµ,k, are disjoint.

· The cubes Q  Dµ,k have small boundaries. That is, for each Q  Dµ,k and each integer l  0, set

Nlext(Q) = {x  E \ Q : dist(x, Q) < A0-k-l},

and Then

Nlint(Q) = {x  Q : dist(x, E \ Q) < A0-k-l}, Nl(Q) = Nlext(Q)  Nlint(Q).

(2.1)

µ(Nl(Q))  (C-1C0-3d-1A0)-l µ(90B(Q)).

· Denote by Dµdb,k the family of cubes Q  Dµ,k for which

(2.2)

µ(100B(Q))  C0 µ(B(Q)).

We have that r(Q) = A-0 k when Q  Dµ,k \ Dµdb,k and (2.3)
µ(100B(Q))  C0-l µ(100l+1B(Q)) for all l  1 with 100l  C0 and Q  Dµ,k \ Dµdb,k.

Remark 2.2. The constants C0 and A0 are chosen so that A0 = C0C(d),
where C(d) depends just on d and C0 is big enough.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

9

We use the notation Dµ = k0 Dµ,k. Observe that the families Dµ,k are only defined for k  0. So the diameter of the cubes from Dµ are uniformly bounded from above. For Q  Dµ,k, we set (Q) = 56 C0 A-0 k and we call it the side length of Q. Notice that

C0-1(Q)  diam(28B(Q))  (Q).

Observe that r(Q)  diam(Q)  (Q). Also we call xQ the center of Q, and the cube Q  Dµ,k-1 such that Q  Q the parent of Q. We denote the family of cubes from Dµ,k+1 which are contained in Q by Ch(Q), and we call their elements children or sons of Q. We
set BQ = 28B(Q) = B(xQ, 28 r(Q)), so that

E



1 28

BQ



Q



BQ



B(xQ,

(Q)/2).

For a given   (0, 1), let A0 be big enough so that the constant C-1C0-3d-1A0 in (2.1) satisfies
C-1C0-3d-1A0 > A0 > 10.
Then we deduce that, for all 0 <   1,

(2.4) µ {x  Q : dist(x, E \ Q)   (Q)} + µ x  3.5BQ \ Q : dist(x, Q)   (Q)}  c  µ(3.5BQ).

We denote Dµdb = k0 Dµdb,k. Note that, in particular, from (2.2) it follows that

(2.5)

µ(3BQ)  µ(100B(Q))  C0 µ(Q) if Q  Dµdb.

For this reason we will call the cubes from Dµdb doubling. Given Q  Dµ, we denote by
Dµ(Q) the family of cubes from Dµ which are contained in Q. Analogously, we write Dµdb(Q) = Dµdb  D(Q).

As shown in [DM, Lemma 5.28], every cube R  Dµ can be covered µ-a.e. by a family of doubling cubes:

Lemma 2.3. Let R  Dµ. Suppose that the constants A0 and C0 in Lemma 2.1 are chosen suitably. Then there exists a family of doubling cubes {Qi}iI  Dµdb, with Qi  R for all
i, such that their union covers µ-almost all R.

The following result is proved in [DM, Lemma 5.31].

Lemma 2.4. Let R  Dµ and let Q  R be a cube such that all the intermediate cubes S, Q S R are non-doubling (i.e. belong to Dµ \ Dµdb). Suppose that the constants A0 and
C0 in Lemma 2.1 are chosen suitably. Then

(2.6)

µ(100B(Q))  A-0 10d(J(Q)-J(R)-1)µ(100B(R)).

Given a ball B  Rn+1, we consider its n-dimensional density:

µ(B)

=

µ(B) r(B)n

.

We will also write µ(x, r) instead of µ(B(x, r)). From the preceding lemma we deduce:

10

XAVIER TOLSA

Lemma 2.5. Let Q, R  Dµ be as in Lemma 2.4. Then µ(100B(Q))  (C0A0)n+1 A-0 9d(J(Q)-J(R)-1) µ(100B(R))
and µ(100B(S))  c µ(100B(R)),
SDµ:QSR
with c depending on C0 and A0.
For the easy proof, see [To4, Lemma 4.4], for example.

2.2. The dyadic martingale decomposition and the additional properties from [DT]. For f  L2(µ) and Q  Dµ we denote

(2.7)

Qf =

mµ,S(f )S - mµ,Q(f )Q,

SCh(Q)

where mµ,S(f ) stands for the average of f on S with respect to µ. Then we have the orthogonal expansion, for any cube R  Dµ,

R f - mµ,R(f ) =

Qf,

QDµ(R)

in the L2(µ)-sense, so that

R

f

- mµ,R(f )

2 L2 (µ)

=

Qf

2 L2

(µ)

.

QDµ(R)

In several places in this paper we will have to estimate terms such as R(2BQ\Qµ) L2(µ|Q), and so we will need to deal with integrals such as

^
2BQ \Q

^
Q

|x

1 -

y|n

dµ(y)

2
dµ(x).

We will describe now how this integral can be estimated in terms of the energy E(9Q) when using the enhanced David-Mattila lattice from [DT].
We need some additional notation. Given Q  Dµ and  > 1, we let Q be the union of cubes P from the same generation as Q such that dist(xQ, P )   (Q). Notice that

(2.8)

Q



B(xQ,

(

+

1 2

)(Q)).

Also, we let and

Dµ(Q) = {P  Dµ : P  Q, (P )  (Q)},

Dµ,k(Q) = {P  Dµ : P  Q, (P ) = A-0 k(Q)},

Dµk(Q) = Dµ,j (Q).
jk

Next we set

(2.9)

Dµint(Q) = P  Dµ(Q) : 2BP  (supp µ \ Q) = 

and

(2.10)

Dµext(Q) = P  Dµ : (P )  (Q), P  Rn+1 \ Q, 2BP  Q =  .

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

11

Also,

(2.11)

Dµ(Q) = Dµint(Q)  Dµext(Q),

and Dµ,k(Q) = {P  Dµ : P  Q, (P ) = A-0 k(Q)}.
We need the following auxiliary result, whose proof follows from a straightforward calculation (see [DT, Lemma 2.7]).

Lemma 2.6. Let µ be a compactly supported Radon measure in Rd and Q  Dµ. For any   (0, 1), we have

(2.12)

^
2BQ \Q

^
Q

|x

1 - y|n

dµ(y)

2

^

dµ(x) +

Q

2

^
2BQ \Q

|x

1 - y|n

dµ(y)

dµ(x)

,A0

(Q) (P )


µ(2BP )2 µ(P ).

P Dµ(Q)

The following result is proven in [DT, Lemma 2.9].

Lemma 2.7. Let µ be a compactly supported Radon measure in Rd. Assume that µ has
polynomial growth of degree n and let   (0, 1). The lattice Dµ from Lemma 2.1 can be constructed so that the following holds for all all Q  Dµ:

(2.13)

P Dµ(Q)

(Q) (P )

1-
2 µ(2BP )2 µ(P )  C()
P Dµ:P 9Q

(P ) (Q)


µ(2BP )2µ(P ).

Remark that saying that µ has polynomial growth of degree n means that (1.1) holds
for some arbitrary constant 0. In the lemma this assumption is just used to ensure that the sums above are finite. Further, the constant C() does not depend on the polynomial
growth constant 0. By combining Lemmas 2.6 and 2.7, we obtain

Lemma 2.8. Let µ be a compactly supported Radon measure in Rd. Assume that µ has
n-polynomial growth and let   (0, 1). The lattice Dµ from Lemma 2.1 can be constructed so that the following holds for all Q  Dµ:

^
2BQ \Q

^
Q

|x

1 - y|n

dµ(y)

2

^

dµ(x)+

Q

2

^
2BQ\Q

|x

1 - y|n

dµ(y)

dµ(x)

 C()

(P ) (Q)


µ(2BP )2µ(P ).

P Dµ:P 2Q

12

XAVIER TOLSA

3. The family hdk(Q) and the Main Proposition

3.1. P-doubling cubes and the family hdk(Q). In the rest of the paper we assume

that µ is a compactly supported Radon measure with polynomial growth of degree n such

that Rµ(x) <  µ-a.e. We assume that Dµ is a David-Mattila dyadic lattice satisfying

the properties described in the preceding section, in particular, the ones in Lemmas 2.1

and 2.8, with  = 9/10. By rescaling, we assume that Dµ,k is defined for all k  k0, with A-0 k0  diam(supp µ), and we also suppose that there is a unique cube in Dµ,k0 which coincides with the whole supp µ. Further, from now on, we allow all the constants C and

all implicit constants in the relationship " " to depend on the parameters C0, A0 of the

dyadic lattice of David-Mattila.

We denote

P(Q) =

(Q) (R)n+1

µ(2BR).

RDµ :RQ

We say that a cube Q is P-doubling, and we write Q  DµP , if

P (Q)



Cd

µ(2BQ (Q)n

)

,

for Cd = 4An0 . Notice that

P(Q) C0

(Q) (R)

µ(2BR).

RDµ:RQ

and thus Q being P-doubling implies that

(Q) (R)

µ(2BR)



Cd

µ(2BQ)

RDµ:RQ

for some constant Cd depending on Cd. Conversely, P-doubling with another constant Cd depending on

the Cd .

latter

condition

implies

that

Q

is

As shown in [DT, Lemma 3.1], from the properties of the David-Mattila lattice, it

follows:

Lemma 3.1. Suppose that C0 and A0 to be chosen suitably. If Q is P-doubling, then Q  Dµ,db.

Notice that, by the preceding lemma, if Q is P-doubling, then

(Q)n+1 (R)n+1

µ(2BR)

Cd µ(Q).

RDµ :RQ

For technical reasons that will be more evident below, it is appropriate to consider a discrete version of the density µ. Given   1 and Q  Dµ, we let

(Q) = Ak0n

if

µ(2BQ) (Q)n



[Ak0n, A0(k+1)n).

Clearly, (Q)  µ(2BQ). Notice also that if (Q) = Ak0 and P is a son of Q, then

µ(2BP ) (P )n



µ(2BQ) (P )n

=

An0

µ(2BQ) (Q)n

.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

13

Thus,

(3.1)

(P )  An0 (Q) for any son P of Q.

Given Q  Dµ and k  1, we denote by hdk(Q) the family of maximal cubes P  Dµ satisfying

(3.2)

(P ) < (Q), (P )  Ak0n(Q).

The following result is proved in [DT, Lemma 3.3] (see also [RT, Lemma 2.1]).

Lemma 3.2. Let Q0, Q1, . . . , Qm be a family of cubes from Dµ such that Qj is son of Qj-1 for 1  j  m. Suppose that Qj is not P-doubling for 1  j  m. Then

(3.3)

µ(BQm ) (Qm)n



A-0 m/2 P(Q0)

and (3.4)

P(Qm)  2A-0 m/2 P(Q0).

We also have:

Lemma 3.3. Let Q  Dµ be P-doubling. Then, for k  4, every P  hdk(Q)  Dµ(9Q) is also P-doubling and moreover (P ) = An0k(Q).

This is proven in [DT, Lemma 3.2]. From this result it follows immediately that

(3.5)

(P )  An0k(Q) for all P  hdk(Q)  Dµ(9Q) and all k  1.

3.2. The energies E, EH , E, and the Main Proposition. For given   1 and Q  Dµ, we consider the energy

E(Q) =

(P )

3/4
(P )2 µ(P ).

(Q)

P Dµ(Q)

We also denote

EH (Q) =
k0 P hdk(Q)Dµ(Q)

(P ) (Q)

3/4
(P )2 µ(P )

and

E(Q) = sup
k1 P hdk(Q)Dµ(Q)

(P ) (Q)

1/2
(P )2 µ(P ).

Lemma 3.4. For every Q  Dµ we have E(9Q) EH (9Q) E(9Q).

14

XAVIER TOLSA

Proof. For a given R  hdk(Q), we denote by TreeH (R) the family of cubes from Dµ that are contained in R and are not contained in any cube from hdk+1(Q). Using that
(P ) (R) for all P  TreeH (R) (remember that we do not keep track of the implicit constants depending on A0), we get

E(9Q) =
k0 Rhdk(Q)Dµ(9Q) P TreeH (R)

(P ) (Q)

3/4
(P )2 µ(P )

(R)2

k0 Rhdk(Q)Dµ(9Q)

P TreeH (R)

(P ) (Q)

3/4
µ(P )

k0 Rhdk(Q)Dµ(9Q)

(R) (Q)

3/4
(R)2 µ(R) = EH (9Q).

To show EH (9Q) E(9Q), denote

mk (Q)

=

1 (Q)

max{(P )

:

P



hdk(Q)  Dµ(9Q)}.

Then we have

EH (9Q) =
k0 P hdk(Q)Dµ(9Q)

(P ) (Q)

3/4
(P )2 µ(P )

 mk(Q)1/4

k0

P hdk(Q)Dµ(9Q)

(P ) (Q)

1/2
(P )2 µ(P )

To estimate mk(Q), observe that if P  hdk(Q)  Dµ(9Q) and k  4, then

Ak0n µ(2BQ)  µ(2BP )

(Q)n (P )n

µ(2BQ).

Hence, (P ) A-0 k (Q), and thus, since this also holds in the case 1  k  3,

(3.6)

mk(Q) A-0 k

for all k  1.

Consequently,

EH (9Q)

A0-k/4

k0

P hdk(Q)Dµ(9Q)

(P ) (Q)

A0-k/4E(9Q)  E(9Q).

k0

1/2
µ(2BP )2 µ(P )

Remark 3.5. For the record, notice that, given Q  DµP and

(3.7)

mk (Q)

=

1 (Q)

max{(P )

:

P



hdk(Q)  Dµ(9Q)},

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

15

as shown in (3.6), it turns out that

(3.8)

mk(Q)  C1A-0 k.

Given M  1 (we will choose M > A20n  1), we say that Q  Dµ is M -dominated from below if there exists some k  1 such that

(3.9)

P hdk(Q)Dµ(9Q)

(P ) (Q)

1/2
(P )2 µ(P ) > M 2 (Q)2 µ(9Q),

or in other words,

(3.10)

E(9Q) > M 2 (Q)2 µ(9Q),

We denote by DB(M ) the family of cubes from DµP that are M -dominated from below. Notice that the cubes from DB(M ) are assumed to be P-doubling.

Recall that in [DT, Theorem 3.4], the following result has been obtained:

Theorem 3.6. Let µ be a Radon measure in Rn+1 with polynomial growth of degree n with constant 0. For any choice of M > 1, let

HE(M ) = {Q  DµP : E(4Q)  M 2 (Q)2 µ(Q)}.

Then we have

(3.11)

2,µ(2BQ)2 (Q) µ(Q)  C

Rµ

2 L2 (µ)

+

02

µ

+

E(4Q) ,

QDµ

QHE(M )

with C depending on M .

In the theorem above we wrote Rµ instead of pv Rµ. From now on we will follow this notation. In the present paper we will obtain the next result.

Main Proposition 3.7. Suppose that µ has polynomial growth of degree n with constant 0 and Rµ(x) <  µ-a.e. Let M0 = Ak00n, where k0 is some big enough absolute constant depending just on n. Then

E(9Q)  C

Rµ

2 L2 (µ)

+

02

µ

,

QDB(M0 )

where C depends just on n and the parameters of the dyadic lattice Dµ.

Notice that if Q  HE(M ), by Lemma 3.4, then

M 2 (Q)2 µ(Q)  E(4Q) EH (4Q)  E(9Q).

Hence, Q  DB(M ) for some M  depending on M . So, by combining Propositions 3.6 and 3.7 and choosing M and M0 appropriately, we deduce that

2,µ(2BQ)2 (Q) µ(Q)  C

Rµ

2 L2 (µ)

+

02

µ

,

QDµ

which implies Theorem 1.1. The rest of the paper is devoted to the proof of Main Proposition 3.7.

16

XAVIER TOLSA

4. The good dominating family GDF

Let

(4.1)

M  Ak00n =: M0 for some k0  4.

For each Q  DB(M ) we choose the minimal k(Q, M )  N such that (3.9) holds with k = k(Q, M ).

Lemma 4.1. Assume k0 big enough in (4.1). For each Q  DB(M ), we have

k(Q, M )

>

8n 8n

- -

1 2

k0

+

4

.

Proof. This follows from the fact that for j  0,

P hdj (Q)Dµ(9Q)

(P ) (Q)

1/2
(P )2µ(P )  CA20nj (Q)2 mj(Q)1/2

µ(P )

P hdj (Q)Dµ(9Q)



C1A02nj

-

j 2

(Q)2µ(9Q),

where

we

used

(3.5)

and

we

applied

(3.8)

to

estimate

mj (Q).

Then,

for

0



j



8n-1 8n-2

k0 +4,

we have

P hdj (Q)Dµ(9Q)

(P ) (Q)

1/2

(P

)2µ(P

)



C1A(02n-

1 2

)(

8n-1 8n-2

k0+4)

(Q)2µ(9Q)

=

C1M02

A-0

k0 4

+8n-2

(Q)2µ(9Q).

So, for k0 big enough, the right hand side above is smaller than M 2 (Q)2µ(9Q), which

ensures

that

k(Q, M )

>

8n-1 8n-2

k0

+

4.

Let

k

=

8n 8n

- -

1 2

k0,

so that k(Q, M ) > k for each Q  DB(M ), by the preceding lemma. Assuming k0 to be a multiple of 8n - 2, it follows that k is natural number. Notice also that k is the mean of k0 and 4nk0/(4n - 1), so that, if we let

 = Ak0n,

4n

we

have

that



is

the

geometric

mean

of

M0

and

M 4n-1
0

,

that

is

(4.2)



=

M01/2

2n
M 4n-1
0

8n-1

=

M 8n-2
0

> M0.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

17

Observe that, for Q  DB(M ), taking into account that k(Q, M ) - k > 4,

(4.3)

M 2 (Q)2 µ(9Q) 
P hdk(Q,M)(Q)Dµ(9Q)

(P ) (Q)

1/2
(P )2 µ(P )

=
Shdk(Q,M)-k (Q)Dµ(9Q) P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P )

 2

(S)2

Shdk(Q,M)-k (Q)Dµ(9Q)

P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
µ(P ).

Given Q  DB(M ) and S  hdk(Q,M)-k(Q)  Dµ(9Q), we write S  G(Q, M ) if

(4.4)

µ(S)  22
P hdk(Q,M)(Q):P S

(P ) (S)

1/2
µ(P ).

We also denote B(Q, M ) = hdk(Q,M)-k(Q)  Dµ(9Q) \ G(Q, M ). Given  > 0, for Q  DB(M ) and S  G(Q, M ), we denote

big(S) = {P  hdk(Q,M) : P  S, (P )   (S)}.

Lemma 4.2. If  > 0 satisfies

(4.5)





c0 4

=:

0()

for some small absolute constant c0  (0, 1), then, for each Q  DB(M ) we have

M 2(Q)2 µ(Q)

-

1 2n

SG(Q,M )

(S) 1/2 (Q)

(P )2µ(P ).

P big(S)

Also, each S  G(Q, M ) satisfies

(S)2

µ(S)



4-

1 2n

µ(P )2 µ(P ).

P big(S)

18

XAVIER TOLSA

Proof. Arguing as in (4.3), by the definition of B(Q, M ) we get

M 2 µ(2Q)2 µ(9Q) 
SG(Q,M ) P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P )

+ 2

(S)2

SB(Q,M )

P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
µ(P )


SG(Q,M ) P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P )

+

1 2

(S)2

(S) (Q)

1/2
µ(S).

SB(Q,M )

Using that B(Q, M )  hdk(Q,M)-k(Q)  Dµ(9Q) and that, by the definition of k(Q, M ),

we get

Shdk(Q,M)-k (Q)Dµ(9Q)

(S) (Q)

1/2
(S)2µ(S)  M 2 (Q)2 µ(9Q),

M 2 (Q)2 µ(9Q)  2
SG(Q,M ) P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P ).

Next, for S  G(Q, M ), we split

P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P ) =

··· +

··· .

P big(S)

P hdk(Q,M)(Q)\big(S):P S

We estimate the last sum:

P hdk(Q,M)(Q)\big(S):P S

(P ) (Q)

1/2
(P )2 µ(P )  1/2

(S) 1/2 (Q)

(P )2 µ(P )

P hdk(Q,M)(Q):P S

 1/2

(S) (Q)

1/2
2 (S)2 µ(S)

 c10/2

(S) (Q)

1/2
(S)2 µ(S),

taking into account the choice of  for the last estimate. By (4.4), since S  G(Q, M ), we

have

(4.6)

(S)

1/2
(S)2 µ(S)  22

(Q)

(S)

1/2
(S)2

(Q)

P hdk(Q,M)(Q):P S

(P )

1/2
µ(P )

(S)

2
P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P )

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

19

Hence, for c0 small enough,

P hdk(Q,M)(Q)\big(S):P S

(P ) (Q)

1/2

(P )2

µ(P )



1 2

P hdk(Q,M)(Q):P S

Consequently, for every S  G(Q, M ),

(P ) (Q)

1/2
(P )2 µ(P ).

(4.7)
P hdk(Q,M)(Q):P S

(P ) (Q)

1/2
(P )2 µ(P )  2

P big(S):P S

(P ) (Q)

1/2
(P )2 µ(P ).

From the conditions P  S and (P ) =  (S) we also get

(P )



(S)

(S)n (P )n

=

-1 (P )

(S)n (P )n

.

Thus,

(4.8)

(P )  -1/n(S).

Then we derive

M2

(Q)2

µ(Q)



4-

1 2n

SG(Q,M )

(S) 1/2 (Q)

(P )2 µ(P ),

P big(S)

which proves the first statement of the lemma. Concerning the second statement, notice that by (4.6), (4.7), and (4.8), we have

(S)2 µ(S)  2
P hdk(Q,M)(Q):P S

(P )

1/2
(P )2 µ(P )

(S)

4

P big(S)



4-

1 2n

(P ) (S)

1/2
(P )2 µ(P )

(P )2 µ(P ).

P big(S)

We denote

DB := DB(M0) =

DB(M ) \ DB(2M ) .

M M0

Remark that the last identity holds because of the polynomial growth of µ. For each

Q  DB, choose M (Q) such that Q  DB(M (Q)) \ DB(2M (Q)) We denote by GDF (which stands for "good dominating family") the family of the cubes S  DµP belonging to G(Q, M (Q)) for some Q  DB. In particular, by the preceding lemma, the cubes S  GDF satisfy the property that there exists a family IS  DµP (S) such that

(4.9)

(P ) =  (S) and (P )  0 (S) for all P  IS

20

XAVIER TOLSA

(with 0 = 0() as in (4.5)), and

(4.10)

µ(S)



42-

1 2n

µ(P ).

For a family I  Dµ, we denote

P IS

(I) = (P )2 µ(P ),

P I

and for p  1,

p(I) = (P )p µ(P ),

P I

so that (I) = 2(I). Observe that, for S  GDF,

(4.11)

(IS) = 2(S)2

µ(P )



1



1 2n

(S

),

4

P IS

by (4.10).

Lemma 4.3. We have

E(9Q)
QDB

-

1 2n

(IS ).

SGDF

Proof. For each Q  DB, choose M = M (Q) such that Q  DB(M ) \ DB(2M ). By the definition of E(9Q), we have
E(9Q) M (Q)2 (Q)2 µ(Q).
Then, by Lemma 4.2 we get

E(9Q)
QDB

-

1 2n

QDB SG(Q,M (Q))

(S) 1/2 (Q)

(P )2µ(P )

P big(S)

-

1 2n

QDµP SGDF:S9Q

(S) (Q)

1/2
(IS )

=

-

1 2n

(IS )

SGDF

QDµP :9QS

(S) 1/2 (Q)

-

1 2n

(IS ).

SGDF

Lemma 4.4. Let 0  (0, 1). Let S, P, P   Dµ be such that P  P   S. Suppose that (P )   (S) and (P )  0 µ(S).

Then we have

c1(P )  (0 -1)1/n(P )  (0 -1)1/n(S).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

21

Proof. This is an immediate consequence of the following:

(P )

(P )n (P )n



(P )



c (S)



c0-1(P ).

Remark 4.5. Let (4.12)



=

0()

=

c0 4

.

By the preceding lemma, if (0-1)1/n < c1, or equivalently,

(4.13)

0 < c1-4n,

then, for any S  GDF and P  IS, there does not exist any cube P   Dµ satisfying

P  P   S and (P )  0 (S).

Another easy (but important) property of the family GDF is stated in the next lemma.
Lemma 4.6. Let S1, S2  GDF be such that S2 S1 and (S1) = (S2). Then there exist Q  DB and Q  Dµ such that Q  9Q, (Q) = (Q) and S1  Q  S2, with S2  G(Q, M (Q)) for some M (Q)  M0.
Proof. This is due to the fact that, by definition, there exists Q  DB such that S2  G(Q, M ) for some M = M (Q)  M0. So S2  hdk(Q,M)-k(Q) and S2  9Q. Then (Q)  (S1), because otherwise S2  hdk(Q,M)-k(Q) since S2 would not be maximal among the cubes S contained in 9Q such that (S)  A0(k(Q,M)-k)n (Q) (as S1 is also contained in 9Q and (S1) = A0(k(Q,M)-k)n (Q)). The fact that (S1)  (Q)  (S2) implies the existence of a cube Q such as the one in the lemma.

5. The cubes with moderate decrement of Wolff energy and the associated tractable trees

Given R  DµP, we denote

HD(R) = hdk(R).

Also, we take 0  c1-4n, so that (4.13) holds. We let LD(R) be the family of cubes Q  Dµ which are maximal and satisfy

(Q) < (R) and (Q)  0 (R).

We denote by NDB(R) (which stands for "near DB") the family of cubes Q which do not belong to LD(R)  HD(R) and satisfy the following:

· (Q) <  (R), with  = c0 -4 as in (4.12), and · there exists another cube Q  DB of the same generation as Q such that Q  20Q.

We let Bad(R) be the family of maximal cubes from LD(R)  HD(R)  NDB(R) (not necessarily contained in R) and we denote

Stop(R) = Bad(R)  Dµ(R).

22

XAVIER TOLSA

Lemma 5.1. For any cube R  GDF, we have IR  HD(R) \ NDB(R)  Stop(R), and

thus

(HD(R)



Stop(R)

\

NDB(R))



1 4

1 2n

(R).

Remark that IR is the family of cubes defined in (4.9).

Proof. Recall that, by (4.11),

(IR)



1 4

1 2n

(R).

By the choice of 0 and Remark 4.5, there does not exist any Q  LD(R) which contains

any cube from IR. Also, the cubes from Q  IR satisfy (Q)  (R) and so there does exist any cube Q  NDB(R) such that Q  Q  R. So IR  HD(R)  Stop(R) \ NDB(R).

The last statement in the lemma follows from (4.10).

We say that a cube R  DµP has moderate decrement of Wolff energy, and we write R  MDW, if
(HD(R)  Stop(R) \ NDB(R))  B-1 (R),

where

B

=

1 100n

.

In particular, by Lemma 5.1, GDF  MDW. In this section we will show how to associate to each R  MDW a suitable family of tractable trees (to be defined later).
Now we introduce the enlarged cubes ej(R). Given j  0 and R  Dµ,k, we let

ej(R) = R  Q,

where the last union runs over the cubes Q  Dµ,k+1 such that

(5.1)

dist(xR, Q)

<

(R) 2

+

2j(Q).

Notice that, since diam(Q)  (Q),

(5.2)

supp µ  B

xR,

1 2

(R)

+

2j(Q)

 ej(R)  B

xR,

1 2

(R)

+

(2j

+

1)(Q)

.

Also, we have

(5.3)

ej(R)  2R

for

0



j



3 4

A0,

since, for any Q  Dµ,k+1 satisfying (5.1), its parent satisfies Q

dist(xR, Q)

<

(R) 2

+

2jA-0 1(Q)



2(R).

For R  MDW, we let

Stop(ej(R)) = Bad(R)  Dµ(ej(R)),
where Dµ(ej(R)) stands for the subfamily of the cubes from Dµ which are contained in ej(R) and have side length ta most (R).

Lemma 5.2. For any R  MDW there exists some j, with 10  j  A0/4 such that (5.4) (HD(R)  Stop(ej(R)) \ NDB(R))  B1/4(HD(R)  Stop(ej-10(R)) \ NDB(R)), assuming A0 big enough (possibly depending on n).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

23

Proof. To shorten notation, here we write HD(R) = HD(R) \ NDB(R). Given R  MDW,
suppose that such j does not exist. Let j0 be the largest integer which is multiple of 10 and smaller that A0/4. Then we get

(HD(R)  Stop(ej0 (R)))  B1/4(HD(R)  Stop(ej0-10(R)))

 ... 

B

1 4

j0 10

-1(HD(R)



Stop(R))



B

j0 40

-

5 4

(R).

By (5.3), we have ej0(R)  2R and thus

(HD(R)  Stop(ej0(R))) 

2(R)2µ(Q)  2(R)2µ(2R).

QHD(R)Stop(ej0 (R))

Since R is P-doubling so from Dµdb, denoting by R the parent of R, we derive

(5.5)

µ(2R)



µ(2BR)



(R)n+1 (R)

P (R)



Cd

An0 +1µ(2BR )



C0

Cd

An0 +1 µ(R).

So we deduce that

B

j0 40

-

5 4

(R)



C0

Cd

An0 +1

2(R),

or equivalently, recalling the choice of B and Cd,

1
 100n

j0 40

-

5 4

-2  4C0 A20n+1.

Since   An0 and j0  A0, it is clear that this inequality is violated if A0 is big enough.

Given R  MDW, let j  10 be minimal such that (5.4) holds. We denote h(R) = j -10. We write

e(R) = eh(R),

e(R) = eh(R)+1, e(R) = eh(R)+2, e(k)(R) = eh(R)+k(R),

for k  1. We let

B(e(R)) = B

xR

,

(

1 2

+ 2A-0 1h(R))(R)

,

B(e(R)) = B

xR

,

(

1 2

+ 2A-0 1(h(R) + 1))(R)

,

B(e(R)) = B

xR

,

(

1 2

+ 2A-0 1(h(R) + 2))(R)

,

B(e(k)(R)) = B

xR

,

(

1 2

+ 2A-0 1(h(R) + k))(R)

.

By construction we have

B(e(R))  supp µ  e(R),

and analogously replacing e(R) by e(R) or e(R). Remark also that

e(R)  B(e(R)) and dist(e(R), B(e(R)))  A-0 1(R),

and, analogously,

e(R)  B(e(R)) and dist(e(R), B(e(R)))  A-0 1(R).

24

XAVIER TOLSA

Lemma 5.3. For each R  MDW we have

B(e(R))  (1 + 8A-0 1) B(e(R))  B(e(6)(R)),

and more generally, for k  2 such that h(R) + k - 2  A0/2,

B(e(k)(R))  (1 + 8A-0 1) B(e(k-2)(R))  B(e(k+4)(R)).

Also,

B(e(10)(R))  B

xR,

3 2

(R)

.

This lemma is proven exactly in the same way as [DT, Lemma 4.4] and so we omit the proof.

Next we need to define some families of cubes that can be considered as "generalized trees". First we introduce some additional notation regarding the stopping cubes. For R  MDW we write Stop(e(R)) = Stop(eh(R)+1(R)). Also, we denote
HD1(R) = Stop(R)  HD(R) \ NDB(R),

HD1(e(R)) = Stop(e(R))  HD(R) \ NDB(R),

and HD1(e(R)) = Stop(e(R))  HD(R) \ NDB(R).

Also, we set and

HD2(e(R)) =

(Stop(Q)  HD(Q) \ NDB(Q))

QHD1 (e (R))

(5.6)

Stop2(e(R)) = Stop(e(R)) \ HD1(e(R)) 

Stop(Q).

QHD1 (e (R))

Given R  MDW, we let TStop(e(R)) be the family of cubes made up of R and all the cubes of the next generations which are contained in e(R) but are not strictly contained in any cube from Stop2(e(R)).
We define now the family of negligible cubes. We say that a cube Q  TStop(e(R)) is negligible for TStop(e(R)), and we write Q  Neg(e(R)) if if there does not exist any cube from TStop(e(R)) that contains Q and is P-doubling.

Lemma 5.4. Let R  MDW. If Q  Neg(e(R)), then Q  e(R) \ R, Q is not contained in any cube from HD1(e(R)), and

(5.7)

(Q) 02 (R).

This lemma is proven in the same way as [DT, Lemma 4.5] and so we omit the proof.

The cubes from Stop2(e(R)) need not be P-doubling. This may cause some problems for some of the estimates involving the Riesz transform localized around the trees TStop(e(R)) that will be required later. For this reason, we need to consider enlarged versions of them. For R  MDW, we let End(e(R)) be family made up of the following cubes:
· the cubes from Stop2(e(R))  Neg(e(R)), · the cubes that are contained in any cube from Stop2(e(R)) \ Neg(e(R)), which are
P-doubling, and moreover are maximal.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

25

Notice that all the cubes from End(e(R)) are P-doubling, with the possible exception of the ones from Neg(e(R)). We let T (e(R)) be the family of cubes that are contained in e(R) and are not strictly contained in any cube from End(e(R)).
Given R  MDW, we say that T (e(R)) is tractable (or that R is tractable) if
(HD2(e(R)))  B (HD1(e(R))).

In this case we write R  Trc.

Our next objective consists in showing how we can associate a family of tractable trees to any R  GDF, so that, roughly speaking, we can reduce the estimate of (DB) to estimating the Haar coefficients of Rµ from below on such family of tractable cubes. First we need the following lemma.

Lemma 5.5. Let R  MDW be such that T (e(R)) is not tractable. Then there exists a family GH(R)  HD1(e(R))  MDW satisfying:

(a) The balls B(e(Q)), with Q  GH(R) are pairwise disjoint. (b) For every Q  GH(R), (HD1(e(Q)))  (HD1(Q))  B1/2(Q). (c)

B 1/4

(HD1(e(Q))) (HD2(e(R))).

QGH(R)

This lemma is proven in the same way as [DT, Lemma 4.6] and so we omit the proof again.
Remark that the property (c) and the fact that R  Trc yield

(5.8)

(HD1(e(Q))) B3/4 (HD1(e(R))),
QGH(R)

which will be suitable for iteration in the arguments below.

Given R  GDF, we will construct now a subfamily of cubes from DµP generated by R, which we will denote by Gen(R), by iterating the construction of Lemma 5.5. We follow
the next algorithm. Given R  GDF, we denote

Gen0(R) = {R}.

If R  Trc, we set Gen1(R) = , and otherwise

Gen1(R) = GH(R),

where GH(R) is defined in Lemma 5.5. For j  2, we set

Genj(R) =

GH(Q),

QGenj-1(R)\Trc

where GH(Q) is defined in Lemma 5.5. For j  0, we also set

Trcj(R) = Genj(R)  Trc,

and

Gen(R) = Genj(R), Trc(R) = Trcj(R).

j0

j0

26

XAVIER TOLSA

From the construction above, we get the following lemma, which is proven in the same way as [DT, Lemma 4.7] and so we omit the proof.

Lemma 5.6. For R  GDF, we have

Q  B(e(R)).
QGen(R)Trc(R)

Also,

(5.9)

(HD1(e(R)))  B-j/2

(HD1(e(Q))).

j0

QTrcj (R)

6. The layers Fhj and Lhj and the typical tractable trees

We denote

Fj = R  GDF : (R) = An0j ,

so that

GDF = Fj.

jZ

Next we split Fj into layers Fhj , h  1, which are defined as follows: F1j is the family

of maximal cubes from Fj, and by induction Fhj is the family of maximal cubes from

Fj \

h-1 k=1

Fhj -1

.

So

we

have

the

splitting

GDF =

Fhj .

jZ h1

Our next objective is to choose a suitable subfamily Lhj  Fhj , for each j, h. By Theorem 9.31 from [To5], there is a family J0  Fhj such that1
1) no ball B(e(4)(Q)), with Q  J0, is contained in any other ball B(e(4)(Q)), with Q  Fhj , Q = Q,
2) the balls B(e(4)(Q)), with Q  J0, have finite superposition, and 3) every ball B(e(4)(Q)), with Q  Fhj is contained in some ball (1 + 8A-0 1) B(e(4)(R)),
with R  J0. Consequently,

B(e(4)(Q)) 

(1 + 8A-0 1) B(e(4)(R)).

QFhj

RJ0

From the finite superposition property 2), by rather standard arguments which are analogous to the ones in the proof of Besicovitch's covering theorem in [Ma, Theorem 2.7], say, one deduces that J0 can be split into m0 subfamilies J1, . . . , Jm0 such that, for each k, the balls {B(e(4)(Q)) : Q  Jk} are pairwise disjoint, with m0  C(A0).

1Actually the property 1) is not stated in that theorem, however this can be obtained by preselecting a subfamily of maximal balls from Fhj with respect to inclusion and then applying the theorem to the
maximal subfamily.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

27

By the condition 3), we get

(HD1(Q)) = 2A02nj

µ(P )

QFhj

QFhj P HD1(Q)

 2A20nj

µ(P ).

RJ0

QFhj :

P HD1(Q)

B(e(4)(Q))(1+8A-0 1)B(e(4)(R))

Observe that, for R  J0 and Q  Fhj such that B(e(4)(Q))  (1 + 8A-0 1) B(e(4)(R)), any cube P  HD1(Q) is contained in some cube from HD1(e(10)(R)) since supp µ  (1 + 8A-0 1)B(e(4)(R))  e(10)(R), by Lemma 5.3. Using also that the cubes from Fhj are disjoint and Lemma 5.2, we deduce that

(HD1(Q))  2A20nj

µ(P )

QFhj

RJ0 P HD1(e(10)(R))

=

(HD1(e(10)(R)))  B1/4

(HD1(e(R))).

RJ0

RJ0

Next we choose Lhj = Jk to be the family such that

(HD1(e(Q)))
QJk

is maximal among J1, . . . , Jm0 , so that

(HD1(Q))  m0 B1/4

(HD1(e(Q))).

QFhj

QLhj

So we have:

Lemma 6.1. The family Lhj satisfies:
(i) no ball B(e(4)(Q)), with Q  Lhj , is contained in any other ball B(e(4)(Q)), with Q  Fhj , Q = Q,
(ii) the balls B(e(4)(Q)), with Q  Lhj , are pairwise disjoint, and (iii)

(HD1(Q))  m0 B1/4

(HD1(e(Q))).

QFhj

QLhj

We denote

Lj = Lhj ,
h1

L = L(GDF) = Lj =

Lhj .

jZ

jZ h1

28

XAVIER TOLSA

By Lemma 6.1 (iii), we have

(6.1)

(HD1(R)) =

(HD1(R))

RGDF

jZ, h0 RFhj

 m0 B1/4

(HD1(e(R))) = m0 B1/4

(HD1(e(R))).

jZ, h0 RLhj

RL(GDF)

Our next objective consists of proving the next lemma, which is the main technical achievement in this section. Although the statement looks similar to [DT, Lemma 5.2], the proof is very different. The cubes from the NDB( · ) play an important role in the arguments. In fact, the main reason for the introduction of the stopping condition involving the family NDB( · ) in Section 5 is that it allows to prove the next lemma.

Lemma 6.2. There exists some constant C2 such that, for all P  Dµ and all k  0,
# R  L(GDF) :  Q  Trck(R) such that P  T (e(Q))  C2 (log )2.
Proof. First notice that if R  L(GDF) and Q  Trck(R) are such that P  T (e(Q)) \ Neg(e(Q)), then there exists some P-doubling cube that contains P and belongs to TStop(e(Q)), by the definition of the family Neg(e(Q)). We denote by P be the smallest one. This satisfies
0 (Q) (P )  2 (Q),
or equivalently, k(R)  [-2(P ), C0-1(P )]. Hence, if (R) = An0j, it follows that
-C log   j + c k log  - c log (P )  C| log 0| = C log .
Thus, R belongs at most to C log  families Lj such that there exists Q  Trck(R) such that P  T (e(Q)) \ Neg(e(Q))
Suppose now that there exists Q  Trck(R) such that P  Neg(e(Q))  T (e(Q)). In this case, by Lemma 5.4, (P ) 0-2 (Q). Hence, there are at most C | log 0|  log  cubes Q such that P  T (e(Q))  Neg(e(Q)), which in turn implies that again there are at most C log  families Lj such that there exists Q  Trck(R) satisfying P  T (e(Q))  Neg(e(Q)).
By the previous discussion, to prove the lemma, it is enough to show that, for each j  Z, P  Dµ, k  0,

(6.2)

#Lj(P, k)  C3 log ,

where

Lj(P, k) = R  Lj :  Q  Trck(R) such that P  T (e(Q)) .

To prove (6.2), let R0 be a cube in Lj(P, k) with maximal side length, and let h0 be such that R0  Lhj 0(P, k)  Lj (P, k)  Lhj 0.

Claim 6.3. Let R1 be another cube from Lj(P, k), and let h1 be such that R1  Lhj 1(P, k). Then h1  h0.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

29

Proof. Suppose that h1 < h0. Let R0h1 be the cube that contains R0 and belongs to Fhj 1. Observe that, by Lemma 5.6,

P



B(e(R0))

 B(e(R1))



B (xR0 ,

3 2

(R0

))



B

(xR1

,

3 2

(R1)).

Since (R0)  (R1), we infer that

B(xR1 ,

3 2

(R1))



B(xR0 ,

9 2

(R0)).

As

xR0



B(xhR10 ,

1 2

(R0h1

))

and

(R0)



A-0 1(R0h1),

we

deduce

that

B (xR0 ,

9 2

(R0))



B(xhR10 ,

1 2

(R0h1

)

+

9 2

(R0))



B(xhR10 ,

1 2

(R0h1

)

+

9 2

A-0 1

(R0h1

))



B(xhR10 ,

(

1 2

+

8A-0 1)(R0h1 ))



B (e(4) (R0h1 )),

where the lat inclusion follows from the definition of B(e(4)(R0h1)). Then we deduce that

B(e(4)(R1))



B (xR1 ,

3 2

(R1

))



B(e(4)(R0h1 )),

which contradicts the property (i) of the family Lhj 1 in Lemma 6.1, because R1 = R0h1.

Claim 6.4. Let R1 be another cube from Lj(P, k), and let h1 be such that R1  Lhj 1(P, k). Then

(6.3)

h1  h0 + C log .

Proof. Suppose that h1 > h0 + 1. This implies that there are cubes {R1h}h0+1hh1-1 such that R1h  Fhj , with

R1h0+1  R1h0+2  . . .  R1h1-1 R1h1 = R1.
Observe now that (R1h0+1)  (R0). Otherwise, there exists some cube R1h0  Fhj 0 that contains R1h0+1 with
(R1h0)  A0 (R1h0+1)  A0 (R0), Since P  B(e(R0))  B(e(R1)), arguing as in the previous claim, we deduce that B(e(4)(R0))  B(e(4)(R1h0)), which contradicts again the property (i) of the family Lhj 0, as above. So we have

(R1h)  (R1h0+1)  (R0) for h  h0 + 1.

By the construction of Trck(R0), there exists a sequence of cubes S0 = R0, S1, S2, . . . , Sk = Q such that
Si+1  GH(Si) for i = 0, . . . , k - 1,
and P  T (e(Sk)). In case that P is contained in some Q  HD1(e(Q)) = HD1(e(Sk)), we write Sk+1 = Q, and we let k~ := k + 1. Otherwise, we let k~ := k. In any case, obviously we have (Si+1) < (Si) for all i. So, for each h with h0 + 1  h  h1 there is some i = i(h) such that

(6.4)

(Si) > (R1h)  (Si+1),

with 0  i  k~, where we understand that Sk~+1 = P . We claim that either i 1 or i = k, with the implicit constant depending on n. Indeed, in the case i < k, let T  Dµ be such

30

XAVIER TOLSA

that T  Si+1 and (T ) = (R1h). Notice that, since 2R1h  2T =  (because both R1h and 2T contain P ) and (R1h) = (T ), we have

(6.5)

P(T )  P(R1h)  (R1h) = (R0).

On the other hand,

(6.6)

(T )  0 (Si)

because otherwise either T  LD(Si) or it is contained in some cube from LD(Si)NDB(Si). In any case, this would imply that Si+1 does not belong to HD1(e(Si)). Thus, from (6.5) and (6.6) we derive that

(R0) 0 (Si) = 0 i (R0).
Hence i 0-1, which yields i n 1 if i < k, as claimed. The preceding discussion implies that, in order to prove (6.3), it suffices to show that,
for each fixed i = 0, . . . , k~, there are at most C log  cubes R1h satisfying (6.4). To this end, suppose first that i < k~. It is easy to check that there is at most one cube R1h satisfying (6.4) such that

(6.7)

(R1h)   (Si).

Indeed, if otherwise R1h and R1h are such that

(6.8)

 (Si)  (R1h) > (R1h) > (Si+1),

then, by Lemma 4.6, there exist Ta  DB and Tb  Dµ such that Tb  9Ta, (Ta) = (Tb)

and R1h Tb R1h. Now, let Tc  Dµ be such that Tc  Si+1 and (Tc) = (Ta).

Since Ta  DB, we infer that Tc  NDB(Si), taking into account that 2Tb  2Tc = ,

Tb  9Ta, and (Tc) >  (Si). This is a contradiction, because this would imply that

either Tc  Stop(e(Si)) or Tc is contained in some cube from Stop(e(Si)), which ensures

that Si+1  GH(Si) (notice that we are using the fact that i < k~). So (6.7) holds. Clearly

this implies that there are at most C| log |  log  cubes R1h satisfying (6.4). In the case i = k~, the same argument as above shows that if R1h and R1h satisfy (6.8),

then the cube Tc in the Tc  Stop(e(Sk~)) or Tc by the definition of the

fipasrmeccoilenydtiaEninngdep(deair(naRgs)ro)ampahendcbueLbleoemngfmrsoamto3.SN2t,DoipBf((ewSe(k~S)dk~ae)ng).aoitnAe.sbSyaoTcaomgnastiehnqeueemitnh-cteehr,

descendant of Tc which contains P , it follows that

(Tm) A-0 m/2 P(Tc)  A-0 m/2 P(Tb)  A-0 m/2 P(R1h ) for all m  1. The last inequality follows from the fact that we can assume that R1h  G(Ta, M ), for some M  M0, by Lemma 4.6. Since any cube R1h with h > h is contained in a cube 2Tm with (Tm)  (R1h) for some m  h - h - 1, we deduce that

(R1h )

(2Tm) (Tm-1) A-0 (m-1)/2 P(R1h ) A0-(h-h)/2 P(R1h )  A0-(h-h)/2 (R1h ).

Since (R1h) = (R1h), we get |h - h| 1. Consequently, in the case i = k~ there are again at most C| log |  log  cubes R1h satisfying (6.4).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

31

To prove the lemma, notice that each family Lhj (P, k) consists of a single cube, at most. Indeed, if R  Lhj (P, k), then P  B(e(R)). Thus if R, R  Lhj (P, k), then B(e(R))  B(e(R)) = , which cannot happen if R = R. From this fact and the preceding claims,
we infer that #Lj(P, k)  C log , so that (6.2) holds.

For R  L(GDF), Q  Trck(R), we write P  T (e(Q)) if there exists some P   T (e(Q)) such that

(6.9)

A-0 2(P )  (P )  A20 (P ) and 20P   20P = .

We say that T (e(Q)) is a typical tractable tree, and we write Q  Ty if

(6.10)

E(9P )



 -1 3n

(HD1(e(Q))).

P DB:P T (e(Q))

Lemma 6.5. We have

E(9Q)
QDB



-1 2n

(log

)2

B -k/2

(HD1(e(Q))).

RL(GDF) k0

QTrck (R)Ty

Proof. By Lemmas 4.3 and 5.1, we have

E(9Q)
QDB

-

1 2n

(HD1(R)).

RGDF

Also, by (6.1) and Lemma 5.6,

(HD1(R))  m0 B1/4

(HD1(e(R)))

RGDF

RL(GDF)

 m0 B1/4

B -k/2

(HD1(e(Q))).

RL(GDF) k0

QTrck (R)

Therefore,

(6.11)

E(9Q)

m0

B 1/4

-

1 2n

B -k/2

(HD1(e(Q)))

QDB

RL(GDF) k0

QTrck (R)

=

m0

B 1/4

-

1 2n

B -k/2

(HD1(e(Q)))

RL(GDF) k0

QTy

+

m0

B 1/4

-

1 2n

B -k/2

(HD1(e(Q)))

RL(GDF) k0

QTrck (R)\Ty

=: S1 + S2.

By definition, for Q  Trck(R) \ Ty, we have

(HD1(e(Q)))



1 3n

E(9P ).

P DB:P T (e(R))

32

XAVIER TOLSA

Hence, the term S2 in (6.11) does not exceed

m0

B 1/4

-

1 2n



1 3n

B -k/2

E(9P )

RL(GDF) k0

QTrck(R)\Ty P DB:P T (e(Q))

m0

B 1/4

-

1 6n

E(9P ) B-k/2 #A(P, k),

P DB

k0

where

A(P, k) = R  L(GDF) : P  T (e(Q)) for some Q  Trck(R) .

From the definition (6.9) and Lemma 6.2, it follows that

(6.12)

#A(P, k) 

# R  L(GDF) :  Q  Trck(R) such that P   T (e(Q))

P Dµ:20P 20P = A-0 2(P )(P )A20(P )

(log )2 (log )2.

P Dµ:20P 20P = A-0 2(P )(P )A20(P )

Therefore, the term S2 in (6.11) satisfies

S2

m0

B 1/4

-

1 6n

(log

)2

E(9P )

B -k/2

m0

B 1/4

-

1 6n

(log

)2

E(9P ).

P DB

k0

P DB

Assuming

that

B





1 2n

,

say,

we

deduce

that2

S2



1 2

E(9P )

P DB

if  is big enough. So we get

E(9Q)  2S1,
QDB

which proves the lemma.

7. Lower estimates for the Riesz transform of the approximating measure  in a typical tractable tree
In this section, for a given R  MDW such that T (e(R)) is tractable, we will define a suitable measure  that approximates µ at the level of the cubes from T (e(R)) and we will get a lower bound for R Lp(). In the next section we will transfer these estimates to Rµ.

2Here we are assuming replace the measure µ by

that another

P DB E(9P ) < . To approximating measure

ensure that of the form

this holds, if µ =   µ,

necessary where 

we is a

may C

bump function supported on B(0, ), with  1 = 1. Then we prove Proposition 3.7 for µ with bounds

independent of , and finally we let   .

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

33

Let R be a fixed cube from MDW  Trc. Recall that the family T (e(R)) was constructed by stopping time conditions involving the families LD( · ), HD( · ), and NDB( · ). Next we need to define some regularized family of stopping cubes. First we consider the function

dR(x)

=

inf
QT (e(R))

dist(x, Q) + (Q) .

Given 0 < 0  (R), we denote

(7.1)

dR,0 (x) = max 0, dR(x) .

Notice that both dR and dR,0 are 1-Lipschitz. For each x  e(R) we take the largest cube Qx  Dµ such that x  Qx and

(7.2)

(Qx)



1 60

inf
yQx

dR,0

(y

).

We consider the collection of the different cubes Qx, x  e(R), and we denote it by Reg(e(R)) (this stands for "regularized cubes"). Observe that the cubes from Reg are disjoint by construction, and they cover e(R).

The constant 0 is just an auxiliary parameter that prevents (Qx) from vanishing. Eventually 0 will be taken extremely small. In particular, we assume 0 small enough so that

(7.3)

µ

Q



1 2

µ

Q.

QHD1 (e(R)):(Q)0

QHD1 (e(R))

We let TReg(e(R)) be the family of cubes made up of R and all the cubes of the next generations which are contained in e(R) but are not strictly contained in any cube from Reg(e(R)).

Lemma 7.1. The cubes from Reg(e(R)) are pairwise disjoint and satisfy the following properties:
(a) If P  Reg(e(R)) and x  B(xP , 50(P )), then 10 (P )  dR,0(x)  c (P ), where c is some constant depending only on n.
(b) There exists some absolute constant c > 0 such that if P, P   Reg(e(R)) satisfy B(xP , 50(P ))  B(xP , 50(P )) = , then c-1(P )  (P )  c (P ).
(c) For each P  Reg(e(R)), there are at most N cubes P   Reg(e(R)) such that
B(xP , 50(P ))  B(xP , 50(P )) = ,
where N is some absolute constant.
The proof of this lemma is standard. See for example [To4, Lemma 6.6].

Next we introduce a measure  which approximates µ|e(R) at the level of the cubes from

Reg(e(R)). We let



=

QReg(e(R))

µ(Q)

Ln+1|

1 2

B(Q)

Ln+1(

1 2

B

(Q))

.

Then we have:

34

XAVIER TOLSA

Lemma 7.2. Let R  MDW  Trc and let  be as above. Assume  > 0 big enough and let c2  (0, 1) be small enough (depending at most on the parameters of the David-Mattila lattice). Then there is a subset VR  supp  satisfying
(7.4) dist(Q, supp µ \ e(R)) (R) for all Q  Reg(e(R)) such that BQ  VR = 

such that

^
VR

(|R(x)|

-

c2 2

(HD1))+

p

d(x)

-pn p(HD1(e(R))),

for any p  (1, 2], where p = p/(p - 1) and the implicit constant depends on p.

Recall that, for I  Dµ, p(I) = (P )p µ(P ).
P I
In the lemma R(x) is well defined by an absolutely convergent integral for all x  Rn+1 because  is absolutely continuous with respect to Lebesgue measure in Rn+1 and it has a bounded density function, since the cubes from the family Reg have side length bounded away from 0, thanks to the parameter 0.
The proof Lemma 7.2 is the same as the one in [DT, Lemma 6.14] and so we omit it here. Remark that the construction of the tractable tree T (e(R)) in that work does not involve the stopping condition NDB( · ). However, the reader can check that this type of cubes do not play any role in the proof of [DT, Lemma 6.14], and exactly the same verbatim arguments are valid here.
The proof of the previous lemma is one main key points in the [DT]. The arguments to prove this are partially inspired by related results from [ENV], [RT], and [JNRT].

8. Lower estimates for the Haar coefficients of Rµ for cubes near a typical tractable tree
In all this section we assume that R  MDW is such that R  Trc  Ty, i.e., T (e(R)) is tractable and typical, and we consider the measure  constructed in Section 7. Roughly speaking, our objective is to transfer the lower estimate we obtained for R in Lemma 7.2 to the Haar coefficients of Rµ for cubes close to T (e(R)). Recall that Rµ(x) exists µ-a.e. as a principal value under the assumptions of Proposition 3.7.
8.1. The operators RTReg, RT , and T R. To simplify notation, in this section we will write
End = End(e(R)), Reg = Reg(e(R)), T = T (e(R)), and TReg = TReg(e(R)).
We need to consider an enlarged version of the generalized tree T , due to some technical difficulties that arise because the cubes from Neg := Neg(e(R))  End are not P-doubling. To this end, denote by RegNeg the family of the cubes from Reg which are contained in some cube from Neg. Let DNeg be the subfamily of the cubes P  RegNeg for which there exists some P-doubling cube S  TReg that contains P . By the definition of Neg, such cube S should be contained in the cube from Q  Neg such that P  Q. We also denote by MNeg the family of maximal P-doubling cubes which belong to TReg and are contained in some cube from Neg, so that, in particular, any cube from DNeg is contained in another from MNeg.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

35

We define End = (End \ Neg)  MNeg,
and we let T = T (e(R)) be the family of cubes that belong to TReg but are not strictly contained in any cube from End. Further, we write

(8.1)

Z = Z(e(R)) = e(R) \

Q and Z = Z(e(R)) = e(R) \

Q

QEnd

QEnd

Then we denote

RTReg µ(x) =

Q(x) R(2R\2Qµ)(x),

QReg

RT µ(x) =

Q(x) R(2R\2Qµ)(x),

QEnd

and

T Rµ(x) =

Q(x) mµ,Q(Rµ) - mµ,2R(Rµ) + Z (x) Rµ(x) - mµ,2R(Rµ) .

QEnd

Remark that the cubes from Reg have the advantage over the cubes from End that their size changes smoothly so that, for example, neighboring cubes have comparable side
lengths. However, they need not be P-doubling or doubling, unlike the cubes from End. In particular, it is not clear how to estimate their energy E in terms of the condition DB (recall that the cubes from DB are asked to be P-doubling).
For Q  Dµ, we define

QReg(Q) =

(P ) D(P, Q)n+1

µ(P

),

P Reg

where

D(P, Q) = (P ) + dist(P, Q) + (Q).

The coefficient QReg(Q) will be used to bound some "error terms" in our transference arguments. We will see later how they can be estimated in terms of the coefficients P(Q). Notice that, unlike P(Q), the coefficients QReg(Q) depend on the family Reg.
The next three lemmas are proven in the same way as Lemmas 7.1, 7.2, and 7.3 from [DT].

Lemma

8.1.

For

any

Q



Reg

such

that

(Q 

1 2

B(Q))



VR

=



and

x



Q,

y



1 2

B(Q),

RTReg µ(x) - R(y) (R) + P(Q) + QReg(Q).

Lemma 8.2. For any Q  End and x, y  Q,

RT µ(x) - T Rµ(y)

P(R) +

E (4R) µ(R)

1/2
+ P(Q) +

E (2Q) µ(Q)

1/2
.

36

XAVIER TOLSA

Lemma 8.3. Let 1 < p  2. For any Q  End such that 0  (Q),,

^

RT µ - RTReg µ p dµ

E

(2Q)p/2

µ(Q)1-

p 2

.

Q

8.2. Estimates for the P and QReg coefficients of some cubes from End and Reg. We will transfer the lower estimate obtained for the Lp() norm of R in Lemma 7.2 to RT µ, RTRegµ, and T Rµ by means of Lemmas 8.1, 8.2, and 8.3. To this end, we will need
careful estimates for the P and QReg coefficients of cubes from End and Reg. This is the task we will perform in this section.

Given R  MDW, recall that HD1(e(R)) = HD(R)  Stop(e(R)). To shorten notation, we will write HD1 = HD1(e(R)) in this section. Notice also that, by (5.6), we have

(8.2)

End = LD1  NDB1  LD2  NDB2  HD2  MNeg,

where we introduced the following notations:

· LD1 is the subfamily of End of those maximal P-doubling cubes which are contained both in e(R) and in some cube from LD(R)  Stop1(e(R)) \ Neg.
· NDB1 is the subfamily of End of those maximal P-doubling cubes which are contained both in e(R) and in some cube from NDB(R)  Stop1(e(R)) \ Neg.
· LD2 is the subfamily of End of those maximal P-doubling cubes which are contained in some cube Q  LD(Q)  Stop(Q) \ Neg for some Q  HD1.
· NDB2 is the subfamily of End of those maximal P-doubling cubes which are contained in some cube Q  NDB(Q)  Stop(Q) for some Q  HD1.
· HD2 = QHD1 (HD(Q)  Stop(Q)).
Remark that the splitting in (8.2) is disjoint. Indeed, notice that, by the definition of MNeg, the cubes from NDB2  HD2 do not belong to MNeg, since they are strictly contained in some cube from HD1, which is P-doubling, in particular.
For i = 1, 2, we also denote by RegLDi the subfamily of the cubes from Reg which are contained in some cube from LDi, and we define RegNDBi , RegHD2 , RegNeg, and RegMNeg analogously.3 We let RegOt be the "other" cubes from Reg: the ones which are not contained in any cube from End (which, in particular, have side length comparable to 0). Also, we let RegDB be the subfamily of the cubes from Reg which are contained in some cube from
End  DB. Notice that we have the splitting

(8.3)

Reg = RegLD1  RegNDB1  RegLD2  RegNDB2  RegHD2  RegNeg  RegOt.

The families above may intersect the family RegDB. Given a family I  Dµ and 1 < p  2, we denote

Pp (I) = P(Q)p µ(Q),
QI

Qp (I) = QReg(Q)p µ(Q).
QI

We also write P (I) = P2 (I), Q(I) = Q2 (I).

3Notice that DNeg = RegMNeg .

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

37

Lemma 8.4. For any Q  End, P(Reg  Dµ(Q)) P(Q)2 µ(Q) + E(2Q).
This is proven in the same way as Lemma 7.4 from [DT].

Lemma 8.5. We have:

(i) If Q  LD1, then P(Q) (ii) If Q  LD2, then P(Q)

1
0n+1

n
 n+1

(R).

1
0n+1

1+

n n+1

(R).

(iii) If Q  NDB1, then P(Q)  (R).

(iv) If Q  NDB2  HD2, then P(Q) 2 (R).

(v) If Q  Neg  MNeg, then P(Q)

(Q) (R)

1/3
(R).

Proof. The statement (i) is proven as in Lemma 3.2 (c) in [RT]. The statement (ii) follows
in the same way as (i), replacing (R) by (R). The statement (iii) is due to the fact that, by the stopping conditions, the cubes Q 
Stop1(e(R)) satisfy P(Q)  P(R)   (R). Then it just remains to notice that if Q is a maximal doubling cube contained in Q, from Lemma 3.2 it follows that P(Q) P(Q).
The property (iv) for the cubes in NDB2 follows by arguments analogous to the ones for (iii), taking into account that such cubes are maximal doubling cubes contained in cubes from Stop(R), for some R  HD1 with P(R)  (R) =  (R).4 On the other hand the cubes Q  HD2 satisfy (Q) = 2 (R) and are P-doubling by construction.
Finally, we turn our attention to (v). By the definitions of Neg and MNeg and Lemma 3.2, for all S  Dµ such that Q  S  R, we have

(S)

(S) (R)

1/2
P (R).

Thus,

P (Q)



(Q) (R)

P (R)

+

(Q) (S)

(S)

S:QSR

(Q) (R)

(R)

+

(Q) (S)

(S) (R)

1/2
(R)

S:QSR

(Q) (R)

(R)

+

(Q) (R)

1/2
(R)

S:QSR

(Q) (R)

(R)

+

log

(R) (Q)

(Q) (R)

1/2
(R)

(Q) (R)

1/3
(R).

4This arugment shows that, in fact, P(Q) 2(R) for all Q  T (e(R)).

38

XAVIER TOLSA

Remark 8.6. We will assume that

0  -(n+2)2 .

With this choice,

1
it follows easily that 0n+1

1+

n n+1



1
0n+2 ,

so that by the

preceding

lemma

1
P(Q) 0n+2 (R) for all Q  LD1  LD2.

Lemma 8.7. Suppose that R  Trc  Ty. Then

(8.4)

P (End)  (End) B (HD1),

(8.5) (8.6)

P (RegDB)

E(9Q) 

E(9Q)

QEndDB

QDB:QT

 -1 3n

(HD1),

P (End



DB)



(End



DB)



M0-2

 -1 3n

(HD1),

(8.7)

P (RegNDB1 ) + P (RegNDB2 )

E(9Q)
QNDB1NDB2

 -1 3n

(HD1),

(8.8)

P (RegLD1  RegLD2 )

Also, for 1 < p  2,

E(9Q)
QLD1 LD2

B

M02

2
0n+2

+

 -1 3n

(HD1).

(8.9)

Pp (RegLD1 \ RegDB) + Pp (RegLD2)

p
B 2 0n+2

-p
+  6n

p(HD1),

(8.10) (8.11)

Pp (RegHD2 ) Pp (HD2)  p(HD2) B p-2 p(HD1),

Pp (RegNDB2)

-p
 6n p(HD1).

Proof. To prove (8.4), notice first that P (End)  (End) because the cubes from End are P-doubling. Also, by (8.2) we have

P (End) = P (LD1) + P (LD2) + P (NDB1) + P (NDB2) + P (HD2) + P (MNeg).

By Lemma 8.5 and the subsequent remark, we have

(8.12)

2

2

P (LD1) + P (LD2) 0n+2 (R)2 µ(R) = 0n+2 (R).

Again by Lemma 8.5, we have P(Q) (R) for all Q  MNeg and thus5

P (MNeg) (R).

5We will obtain better estimates for P (MNeg) below.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

39

Also, since T is a tractable tree, we have

(R)  B (HD1) and P(HD2)  (HD2) B (HD1).

Regarding the family NDB1  NDB2, denote

StopNDB = Stop1(e(R))  NDB(R) 

Stop(S)  NDB(S) ,

SHD1

so that the cubes from P  NDB1 NDB2 are maximal P-doubling cubes contained in some
cube from StopNDB. By Lemma 3.2, if P  NDB1  NDB2 is contained in Q  StopNDB, then P(P ) P(Q). Also, by the definition of NDB( · ), there exists Q = Q(Q)  DB such that (Q) = (Q) and Q  20Q. In particular, this implies that Q  T (e(R)) and that P(Q)  P(Q)  (Q), and by the definition of DB,

(8.13) Thus,

E(9Q) M02 (Q).

(8.14)

P (NDB1  NDB2) =

P(P )2 µ(P )

QStopNDB P EndDµ(Q)

P(Q)2 µ(Q) 

(Q(Q))

QStopNDB

QStopNDB

1 M02

QStopNDB

E(9Q(Q))

1 M02

QDB:QT

E(9Q),

where in the last estimate we took into account that for each Q there is a bounded number of cubes Q  StopNDB such that Q = Q(Q) (possibly depending on n and A0). Since T
is a typical tree, by the definition in (6.10), we have

(8.15)

E(9Q)



 -1 3n

(HD1).

QDB:QT

So we have

(8.16)

P (NDB1  NDB2)

M0-2

-1 3n

(HD1).

Gathering the estimates above, the estimate (8.4) follows.

To prove (8.5), we apply Lemma 8.4 and the fact that T is a typical tree again:

P (RegDB) =

P (RegDB  Dµ(Q))

QEndDB

P(Q)2 µ(Q) + E(9Q)

E(9Q)

QEndDB

QEndDB

Notice that, by the construction of the family Reg, for each Q  MNeg there exists some cube Q  T such that

(8.17)

(Q)  (Q)  A20 (S) and 20Q  20Q = .

40

XAVIER TOLSA

Hence, Q  T (see (6.9)), and so

E(9Q) =

E(9Q) +

E(9Q)

QEndDB

QEndDB

QMNeg DB

E(9S)



 -1 3n

(HD1),

SDB:ST

taking into account that T is a typical tree, which completes the proof of (8.5). Notice also that (8.6) follows from (8.5) and the fact that the cubes from DB satisfy (8.13).

Next we turn our attention to (8.7). By Lemma 8.4 we have

P (RegNDB1  RegNDB2 )

E(9Q)
QNDB1NDB2



E(9Q) +

E(9Q).

QEndDB

Q(NDB1 NDB2 )\DB

By

(8.5),

the

first

term

on

the

right

hand

side

above

does

not

exceed

C



-1 3n

(HD1).

Concerning the second term, we use the fact for the cubes Q  DB, we have E(9Q)

M02 (Q) together with (8.16). Then we get

E(9Q)
Q(NDB1 NDB2 )\DB

M02 (NDB1  NDB2)

 -1 3n

(HD1).

Regarding the estimate (8.8), by (8.12) and Lemma 8.4, we obtain

P ((RegLD1  RegLD2 ) \ RegDB)

E(9Q) M02 P (LD1  LD2)

Q(LD1 LD2 )\DB

2

2

M02 0n+2 (R)  B M02 0n+2 (HD1).

Together with (8.5), this yields (8.8). To get (8.9), we apply Hölder's inequality in the preceding estimate:

Pp ((RegLD1



RegLD2 )

\

RegDB)



(P ((RegLD1



RegLD2 )

\

p
RegDB)) 2

µ(e

(R))1-

p 2

(B

M02

2
0n+2

(HD1

))

p 2

µ(R)1-

p 2

.

Observe now that, writing HDi = QHDi Q,

(8.18)

µ(H D1 )

=

2

1 (R)2

(HD1)



B

2

1 (R)2

(R)

=

1 B 2

µ(R).

Thus, using also that M0  ,

(8.19)

Pp ((RegLD1  RegLD2 ) \ RegDB)

(B

M02

2
0n+2

(HD1

))

p 2

(B

2

µ(H

D1

))1-

p 2

p
 B 2 0n+2 p(HD1).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

41

On the other hand, if we let RegDB2 be the subfamily of the cubes from RegDB which are contained in some cube from HD1, by Hölder's inequality, Lemma 8.4, and (8.15), we get

Pp (RegDB2 )

P

(RegDB2

)

p 2

µ(H

D1

)1-

p 2

p

E(9Q)

2

µ(H

D1

)1-

p 2

QDB:QT

 -1 3n

(HD1)

p 2

µ(H

D1

)1-

p 2

-p
=  6n p(HD1).

Gathering (8.19) and the last estimate, we get (8.9). To prove (8.10), recall that (Q)  2 (R) for all Q  T . This implies that also
P(Q) 2 (R) for all Q  Reg, by Lemma 3.2. Consequently,

Pp (RegHD2 ) 2p (R)p µ(HD2) = p(HD2)  Pp (HD2). On the other hand, since R  Trc,

p(HD2) = (HD2)p-2 (HD2)  B (HD2)p-2 (HD1)

=

B

(HD2)p-2 (HD1)p-2

p(HD1)

=

B

p-2

p(HD1),

which completes the proof of (8.10).

Finally, observe that (8.11) follows (8.7) using Hölder's inequality and the fact that the

cubes from RegNDB2 are contained in cubes from HD1:

Pp

(RegNDB2

)



P (RegNDB2 )

p 2

µ(H D1 )1-

p 2



-1 3n

(HD1)

p 2

µ(H

D1

)1-

p 2

-p
=  6n p(HD1).

For the record, notice that (8.14) also shows that the family StopNDB defined just above (8.13) satisfies

P (StopNDB) =

P(Q)2 µ(Q)

QStopNDB

1 M02

QDB:QT

E(9Q),

which together with (8.15) yields

(8.20)

P (StopNDB)

M0-2



-1 3n

(HD1).

Lemma 8.8. Suppose that R  Trc  Ty. Then

(8.21)

P (MNeg) P (Neg)

0

B

5

+

B

-3

+

M0-2



-1 3n

(HD1),

and

(8.22) P (RegNeg) P (Neg) +

E(9Q)

QMNeg

0

B

7

+

B

-1

+

 -1 3n

(HD1).

Proof. By Lemma 5.4, the cubes from Neg belong either to LD(R) or to NDB(R). Thus, if we denote
NegLD = Neg  LD(R)  Stop(e(R)), NegNDB = Neg  NDB(R)  Stop(e(R)),

42

XAVIER TOLSA

it is clear that

Neg = NegLD  NegNDB. We can split RegNeg in an analogous way:

RegNeg = RegNegLD  RegNegNDB .

Recall that the cubes from Neg are not P-doubling and that P(Q)

(Q) (R)

1/3
(R) for

all Q  Neg.

To estimate P (NegLD), we split NegLD into two subfamilies I and J so that the cubes from I have side length at least -5(R), opposite to the ones from J . We have

P (I) = P(Q)2 µ(Q) (R)2 µ(Q)

QI

QI

(R)2 (Q) (Q)n 0(R)3 (Q)n.

QI

QI

Using

now

that

the

balls

1 2

B

(Q),

with

Q



I,

are

disjoint

and

that

(Q)



-5(R),

we

get

(Q)n 

5 (Q)n+1 (R)

QI

QI

5

(R)n+1 (R)

=

5

(R)n.

Therefore,

P (I) 0 5 (R)3 (R)n  0 5 (R) 0 B 5 (HD1).

In connection with the family J , we have

P (J ) = P(Q)2 µ(Q)
QJ

(R)2

(Q) (R)

2/3
µ(Q)

QJ

 -10/3 (R)2

µ(Q)  -3 (R)  B -3 (HD1).

QJ

Hence, P (NegLD) 0 B 5 + B -3 (HD1).
To estimate P(NegNDB) we just take into account that NegNDB  StopNDB, and then by (8.20) we have

P (NegNDB)  P (StopNDB)

M0-2



-1 3n

(HD1).

Gathering the estimates obtained for P (NegLD) and P (NegNDB) we get

P (Neg)

0

B

5

+

B

-3

+

M0-2



-1 3n

(HD1),

as wished. The fact that P (MNeg) satisfies P  Q  Neg, then P(P ) contained in Q.

P(Neg) follows from the fact that if P  MNeg P(Q) because P is a maximal P-doubling cube

Next we deal with (8.22). We split

P (RegNeg) = P (RegMNeg ) + P (RegNeg \ RegMNeg ).

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

43

Notice that, for all P  RegNeg \ RegMNeg such that P  Q  Neg, by Lemma 3.2, P(P ) P(Q). Then it follows that

P (RegNeg \ RegMNeg ) P (Neg). To estimate P (RegMNeg), we apply Lemma 8.4:

(8.23)

P (RegMNeg ) =

P (RegMNeg  Dµ(S))

S MNeg

E(9S)
S MNeg



E(9S) +

E(9S).

SMNeg\DB

SDBEnd

By the definition of DB and the fact that (S) P(Q) whenever S  Q  Neg, we derive

E(9S)
SMNeg\DB
On the other hand, by (8.5),

M02

(S)

S MNeg \DB

M02 P (Neg).

E(9S)



 -1 3n

(HD1).

SDBEnd

Therefore,

P (RegMNeg )

M02

P (Neg)

+

 -1 3n

(HD1).

Gathering the estimates above, and taking into account that M0 <  (by (4.2)), we deduce

P (RegNeg)

M02

P (Neg)

+

 -1 3n

(HD1)

0

B

M02

5

+

B

-3

M02

+

 -1 3n

(HD1)

+

 -1 3n

(HD1)



0

B

7

+

B

-1

+

 -1 3n

(HD1).

Next lemma deals with Pp (RegOt). Lemma 8.9. For 1  p  2, we have

(8.24)

lim sup Pp (RegOt(0))
00

Consequently, if µ(Z)  Z µ(R), then

(8.25)

lim sup Pp (RegOt(0))
0 0

2p (R)p µ(Z). B 4 Z p(HD1).

Above we wrote RegOt(0) to recall the dependence of the family RegOt on the parameter 0 in (7.1).

Proof. If x  Q  End with (Q)  0, then

dR,0 (x)  max(0, (Q)) = (Q)

44

XAVIER TOLSA

(recall that dR,0 is defined in (7.1)), and thus x is contained in some cube Q  Reg with (Q)  (Q), by the definition of the family Reg. So Q  Q and then Q  Reg \ RegOt. Therefore,

(8.26)

P  e(R) \

Q,

and so

P RegOt

QEnd:(Q)>0

(8.27)

lim sup µ

P  µ e(R) \

Q = µ(Z).

0 0

P RegOt(0)

QEnd

To complete the proof of (8.24) it just remains to notice that, using the fact that P(P ) 2 (R) for all P  Reg, we have

Pp (RegOt(0))

2p (R)p µ

P.

P RegOt(0)

Regarding the second statement of the lemma recall that, as in (8.18), µ(HD1) 

1 B 2

µ(R),

which

implies

that

µ(Z)  B 2 Z µ(HD1).

Plugging this estimate into (8.24), we get

lim sup Pp (RegOt(0)) B 2+p Z (HD1)p µ(HD1)  B 4 Z p(HD1).
0 0

Remark 8.10. By Lemma 8.7, for p  (1, 2), if   B  1 and 0  -1, we have
Pp (RegLD1 \ RegDB) + Pp (RegLD2 \ RegDB) + Pp (RegHD2 ) + Pp (RegNDB2 )  p(HD1).
Analogously, by Lemma 8.9, if Z  (B4)-1 and 0 is small enough,
Pp (RegOt)  p(HD1). To transfer the lower estimates for the Lp() norm of R in Lemma 7.2 to RT µ, RTRegµ, and T Rµ, it would be useful to have estimates for Pp (RegNDB1), Pp (RegDB), and Pp (Neg) analogous to the ones above. However, we have not been able to get them. This fact originates some technical difficulties, which will be solved in the next lemmas.

Remark 8.11. By Lemma 8.7, for 1 < p  2, and 0 small enough we have

Pp (RegLD1 \ RegDB) + Pp (RegLD2 ) + Pp (RegNDB2)

1
B 2 0n+2

+

 -1 6n

p(HD1).

Also, by Lemma 8.9, for 0 small enough, if µ(Z)  Z µ(R),

Pp (RegOt(0)) B 4 Z p(HD1).

From now on we will assume that 0 small enough so that this holds,. Remember also that

we chose

B

=

1 100n

.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

45

We assume also 0 and Z small enough so that

(8.28)

B

2

1
0n+2

+

B

4

Z

+

B

7

0





-1 3n

.

In this way, we have

(8.29) Pp (RegLD1 \ RegDB) + Pp (RegLD2 ) + Pp (RegNDB2 ) + Pp (RegOt)

 -1 6n

p(HD1),

under the assumption that µ(Z)  Z µ(R). Also, from (8.22), it follows that

(8.30)

P (RegNeg)

0

B

7

+

B

-1

+

 -1 3n

(HD1)

 -1 3n

(HD1).

Lemma 8.12. Suppose that R  Trc  Ty and that µ(Z)  Z µ(R). We have

For

p0

=

2

-

1 18n

,

we

have

P (Reg) B (HD1).

Pp0 (Reg)

 -1 25n

p0 (HD1 ).

Proof. By (8.29) and (8.10), for 1 < p  2,

Pp (RegLD1 \ RegDB) + Pp (RegLD2 ) + Pp (RegNDB2 ) + Pp (RegHD2) + Pp (RegOt)

 -1 6n

+

B

p-2

p(HD1).

Also, by (8.5), (8.7), and (8.30),

P (RegDB)+P (RegNDB1 )+P (RegNeg)

0

B

7+B

-1+

-1 3n

(HD1)

 -1 3n

(HD1),

by the assumptions on 0, , and B in Remarks 8.6 and 8.11. Choosing p = 2 above and adding the preceding estimates, we get the first statement in the lemma.

To get the second inequality in the lemma, we apply by Hölder's inequality and (8.18)

in the last estimate, and we get

(8.31)

Pp (RegDB) + Pp (RegNDB1) + Pp (RegNeg)

 -1 3n

(HD1)

p 2

µ(R)1-

p 2

 -1 3n

(HD1)

p 2

B 2µ(HD1)

1-

p 2

-1
  6n

3

1-

p 2

p(HD1).

For

p

=

2

-

1 18n

,

we

have

3

1-

p 2

=

1 12n

,

and thus (8.32) Also,

Pp (RegDB) + Pp (RegNDB1 ) + Pp (RegNeg)

-1
 12n p(HD1).

B p-2

=

1 100n

 -1 18n

=  -41 900n

<

 -1 25n

,

and thus

Pp (RegLD1 \ RegDB) + Pp (RegLD2 ) + Pp (RegNDB2 ) + Pp (RegHD2) + Pp (RegOt)

 -1 25n

p(HD1).

Gathering the estimates above, the lemma follows.

46

XAVIER TOLSA

Remark that in order to transfer the lower estimates for R to Rµ we will need to take
p very close to 1 below, in particular with p < p0. Next lemma shows how one can estimate the QReg coefficients in terms of the P coeffi-
cients. This is proven in [DT, Lemma 7.12].

Lemma 8.13. For all p  (1, ), Qp (Reg) Pp (Reg).

8.3. Transference of the lower estimates for R to T Rµ. Denote

F = e(R) \

Q.

QRegHD2

By the splitting (8.3), it is clear that F coincides with the union of the cubes in the family

RegF := RegLD1  RegLD2  RegNDB1  RegNDB2  RegNeg  RegOt.

We also write

F =

1 2

B(Q),

QRegF

so that the measure µ|F is well approximated by |F , in a sense. Recall that in Lemma 7.2 we showed that

^
VR

(|R(x)|

-

c2 2

(HD1))+

p

d(x)

-pn p(HD1(e(R))),

for any p  (1, 2], with c2 be as in Lemma 7.2. We will show below that a similar lower

estimate holds if we restrict the integral on the left side to HD2. The first step is the next

lemma.

We

let

VR

be

the

union

of

the

balls

1 2

B

(Q),

with

Q  Reg,

that

intersect

VR.

Lemma 8.14. Suppose that R  Trc  Ty and also that µ(Z)  Z µ(R) and

T Rµ

2 L2 (µ)

 -1 (HD1).

Then,

for

p0

=

2

-

1 18n

,

assuming

Z



-72n

and

0

small

enough,

^
F VR

(|R|

-

c2 4

(HD1))+

p0

d

 -1 25n

p0 (HD1).

Remark that the proof of this lemma takes advantage of the good estimates we have obtained for Pp0(Reg) in Lemma 8.12. Later on we will show that an analogous estimate holds for all p  (1, p0) (see Lemma 8.15 below).

Proof. Denote

Fa =

Q,

QEnd\HD2

Fb =

Q,

QRegNeg \RegMNeg

FOt =

Q,

QRegOt

so that F = Fa  Fb  FOt. Write also

Enda = LD1  LD2  NDB1  NDB2  MNeg

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

47

and

Rega = RegLD1  RegLD2  RegNDB1  RegNDB2  RegMNeg ,

so that

Fa =

Q=

Q.

QEnda

QRega

We also consider

Fa, =

1 2

B(Q),

QRega

Fb, =

1 2

B(Q),

QRegNeg \RegMNeg

FOt, =

1 2

B(Q),

QRegOt

so that these sets approximate Fa, Fb, FOt at the level of the family Reg, in a sense. Moreover, we have F = Fa,  Fb,  FOt,.
We split

^
F VR

(|R|-

c2 4

(HD1))+

p0

d

=

^
Fa, VR

^
. . .+
Fb, VR

^
. . .+
FOt, VR

...

=:

Ia+Ib+IOt,

where ". . ." stands for

(|R|

-

c2 4

(HD1

))+

p0

d.

Estimates for Ib. We claim that Ib = 0. Indeed, given Q  RegNeg \ RegMNeg, notice that all the cubes S such that Q  S  R satisfy

(S)

(S) (R)

1/2
(R),

and so, for any x  Q,

|R(x)|

(4BS )

µ (C BS )

S:QSR

S:QSR

(S) (R)

1/2
(R) + (R)

S:QSR

(R).

Hence,

for



big

enough,

(|R(x)|

-

c2 4

(HD1

))+

=

0,

which

proves

our

claim.

Estimates

for

Ia.

By

Lemma

8.1,

for

all

Q



Rega

such

that

1 2

B

(Q)



VR,

all

x



1 2

B(Q),

and all y  Q,

|R(x)|  |RTRegµ(y)| + C(R) + CP(Q) + CQReg(Q).

Thus,

for



big

enough,

since

C (R)

=

-1(HD1)

<

c2 8

(HD1

),

(|R(x)|

-

c2 4

(HD1))+



(|RTReg µ(y)|

-

c2 8

(HD1))+

+

C P (Q)

+

C QReg (Q).

Consequently,

(8.33)

Ia

^
QRega Q

(|RTReg µ(y)|

-

c2 8

(HD1))+

p0 dµ(y) +

(P(Q)p0 + QReg(Q)p0 ) µ(Q)

QRega

^
SEnda S

(|RTReg µ|

-

c2 8

(HD1))+

p0

dµ

+

Pp0 (Reg),

48

XAVIER TOLSA

where, in the last inequality, we used the fact that all the cubes from Rega are contained in some cube S  Enda and we applied Lemma 8.13.
For each S  Enda, by the triangle inequality and the fact that ( · )+ is a 1-Lipschitz
function, we get

^
S

(|RTReg µ|

-

c2 8

(HD1))+

p0

dµ

^
S

(|RT

µ|

-

c2 8

(HD1

))+

p0

dµ

^

+

RT µ - RTReg µ p0 dµ

S

By

Lemma

8.3,

the

last

integral

does

not

exceed

C

E

(2S

)

p0 2

µ(S

)1-

p0 2

,

and

thus

we

deduce

that

(8.34) Ia

^
SEnda S

(|RT

µ|

-

c2 8

(HD1))+

p0

dµ +

E

(2S

)

p0 2

µ(S

)1-

p0 2

+ Pp0 (Reg).

SEnda

Next we apply Lemma 8.2, which ensures that for any S  Enda  End and all x  S,

(8.35)

|RT µ(x)|  |T Rµ(x)| + C

E (4R) µ(R)

1/2
+C

E (2S ) µ(S)

1/2
.

8n-1

In

case

that

R



DB,

recalling

that



=

M 8n-2
0



M0

by

(4.2),

for



big

enough

we

obtain

(8.36)

C

E (4R) µ(R)

1/2



C

M0

(R)



c2 8

(HD1

).

In case that R  DB, since R  Ty, we have

E (4R)

E(9Q)



 -1 3n

(HD1),

QDB:QT

and so we also get

(8.37)

C

E (4R) µ(R)

1/2
C

 -1 3n

(HD1)

µ(R)

1/2



C

 -1 6n

(HD1)



c2 8

(HD1).

Thus, in any case,

(|RT

µ(x)|

-

c2 8

(HD1))+



|T

Rµ(x)|

+

C

E (2S ) µ(S)

1/2
.

Plugging this estimate into (8.34), we get

(8.38)

Ia

^ |T Rµ|p0 dµ +

E

(2S

)

p0 2

µ(S

)1-

p0 2

+ Pp0(Reg).

SEnda S

SEnda

We deal with each term on the right hand side of the preceding inequality separately. First, by Hölder's inequality and the assumptions in the lemma, we have

^ |T Rµ|p0 dµ

T Rµ

p0 L2 (µ)

µ(R)1-

p0 2



-

p0 2

(HD1)

p0 2

µ(R)1-

p0 2

.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

49

Regarding the second term in (8.38), by Hölder's inequality again,

E

(2S

)

p0 2

µ(S

)1-

p0 2



SEnda

E (2S )
SEnda
E (2S )
SEnda

p0 2
µ(S)

SEnda

p0

2

µ(R)1-

p0 2

.

1-

p0 2

We estimate the first factor on the right hand side using (8.7), (8.8), and (8.22):

E (2S )
SEnda

p0 2


E(9S) +

E(9S) +

p0 2
E(9S)

SNDB1NDB2

S LD1 LD2

S MNeg

B-1

+



-1 3n

2
+ B M02 0n+2

+

B 70

p0 2

(HD1)

p0 2



 -1 6n

(HD1)

p0 2

,

by the assumption (8.28) on 0. In connection with the last summand on the right hand side of (8.38), by Lemma 8.12 we have

Pp0 (Reg)

 -1 25n

p0 (HD1 ).

Therefore,

Ia

-1
 6n

(HD1)

p0 2

µ(R)1-

p0 2

-1
+  25n

p0 (HD1).

From (8.18) we derive that µ(HD1)  -3 µ(R), and then

(8.39)

 -1 6n

(HD1

)

p0 2

µ(R)1-

p0 2



 -1 6n

3

1-

p0 2

p0 (HD1)

=

 -1 12n

p0 (HD1)



 -1 25n

p0 (HD1).

So we get

(8.40)

Ia

 -1 25n

p0 (HD1).

Estimate of IOt. By the same arguments as in (8.33), just replacing Rega by RegOt, we obtain

IOt

^
QRegOt Q

(|RTReg

µ(y)|

-

c2 8

(HD1))+

p0 dµ(y) +

(P(Q)p0 + QReg(Q)p0 ) µ(Q).

QRegOt

Thus, using again Lemmas 8.13 and 8.12, we get

(8.41)

IOt

^
QRegOt Q

(|RTReg µ(y)|

-

c2 8

(HD1))+

p0

dµ(y)

+

 -1 25n

p0 (HD1 )

=:

IOt

+

 -1 25n

p0 (HD1 ).

50

XAVIER TOLSA

To estimate the integral IOt on the right hand side, we split

^
IOt =
QRegOt\Neg(e(R)) Q

(|RTReg µ(x)|

-

c2 8

(HD1))+

p0 dµ(x)

^
+
QRegOtNeg(e(R)) Q

(|RTReg µ(x)|

-

c2 8

(HD1))+

p0 dµ(x)

= IOt,1 + IOt,2.

Notice that, by definition we have RegOt  T . Recall that Neg = Neg(e(R))  End and thus we may have RegOt  Neg(e(R)) = . In this case, we have RegOt  Neg(e(R))  TStop(e(R)) (because Neg(e(R))  TStop(e(R)) by construction).
The same argument used to show that Ib = 0 shows that

IOt,2 = 0.

To estimate IOt,1, denote by MOt the family of maximal P-doubling cubes which are contained in some cube from RegOt \ Neg(e(R)) and let

We claim that

NOt =

Q\

P.

QRegOt \Neg(e (R))

P MOt

(8.42)

MOt  T and NOt  Z.

To check this, for a given P  MOt with P  Q  RegOt \ Neg(e(R)), suppose there exists S  End such that S  P . As P is a contained in some Q  RegOt \ Neg(e(R)), we have S  Neg. Further, S Q because Q  RegOt implies that Q  S. Since S is P-doubling, we deduce that P = S, by the maximality of P as P-doubling cube contained in Q. An
analogous argument shows that NOt  Z. By Hölder's inequality and (8.27), for 0 small enough we have

IOt  

^
QRegOt Q

(|RTReg µ(x)|

-

c2 8

(HD1))+

2 dµ(x)

p0 2

1-

p0 2

µ(Q)

QRegOt

^

^

RTReg µ 2 dµ +

RTReg µ 2 dµ

p0 2

1-

p0 2

µ(Z) + o(0)

,

P MOt P

NOt

with o(0)  0 as 0  0. Denote

RMOt µ(x) =

P (x) R(2R\2P µ)(x)

P MOt

and

MOtRµ(x) =

P (x) mµ,P (Rµ) - mµ,2R(Rµ) + Z(x) Rµ(x) - mµ,2R(Rµ) .

P MOt

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

51

Notice that, for x  P  MOt and Q  RegOt \ Neg(e(R)) such that Q  P , since there are no P-doubling cubes P  such that P P   Q,

RMOtµ(x) - RTReg µ(x) = |R(2Q\2P µ)(x)|

(P ) P(Q)  (HD1).

P :P P Q

Almost the same argument shows also that, for x  NOt,

R(2Rµ)(x) - RTReg µ(x)  (HD1).

Remark also that

^

^

R(2Rµ) 2 dµ  R(2Rµ) 2 dµ.

NOt

Z

So we deduce that, for 0 small enough,

p0

IOt

^

^ RMOt µ 2 dµ +

R(2Rµ) 2 dµ + 2 (HD1)2 µ(R)

2

Z µ(R)

1-

p0 2

.

P MOt P

Z

Almost the same arguments as in Lemma 8.2 show that for x  P  MOt,

RMOt µ(x) - MOt Rµ(x)

P(R) +

E (4R) µ(R)

1/2
+ P(P ) +

E(2P ) µ(P )

1/2

and that, for x  Z,

R(2Rµ)(x) - MOtRµ(x)

P(R) +

E (4R) µ(R)

1/2
.

Therefore, by (8.36) and (8.37) and taking into account that P(P )  (HD1) for P  MOt, we deduce

^

IOt

|MOtRµ|2 dµ +

p0

E(2P ) + 2 (HD1)2 µ(R)

2

Z µ(R)

1-

p0 2

.

P MOt

By the orthogonality of the functions QRµ, Q  Dµ, the assumptions in the lemma, and (8.42), it is clear that

^

|MOtRµ|2 dµ 

T Rµ

2 L2 (µ)

 -1 (HD1).

On the other hand, since the tree T is typical,

E(2P ) 

E(2P ) +

E(2P )



M02

(MOt)

+

 -1 3n

(HD1)

P MOt

P MOt\DB

P T DB



2

(HD1)2

µ(R)

+

 -1 3n

(HD1)

2 (HD1)2 µ(R).

Thus, using also (8.18),

IOt

 -p0 2

(HD1

)

p0 2

µ(R)1-

p0 2

+

Z1-

p0 2

p0

(HD1)p0 µ(R)

(B

2

1-
)

p0 2

 -p0 2

p0

(HD1)

+

1Z-

p0 2

B 2+p0

p0 (HD1 ).

By the choice of p0, , and B and the assumption Z  -72n, we have

IOt

 -1 2

p0 (HD1 )

+

 -1 25n

p0 (HD1)

 -1 25n

p0 (HD1).

52

XAVIER TOLSA

Together with (8.41), this yields

IOt

 -1 25n

p0 (HD1).

Gathering the estimates obtained for Ia and IOt, the lemma follows.

Lemma 8.15. Suppose that R  Trc  Ty and also that µ(Z)  Z µ(R) and

T Rµ

2 L2 (µ)

 -1 (HD1).

Assume also that Z  -72n and 0 is small enough. Then



x



VR

:

|R(x)|

>

c2 2

(HD1

)

 -1 25n

µ(H D1 ).

Also, for any p  (1, p0),

^
F VR

(|R|

-

c2 2

(HD1

))+

p d

 -1 25n

p(HD1).

Proof. Denote

A=

x



VR

:

|R(x)|

>

c2 2

(HD1)

.

By the definition of F we can split

(A)  (A  F) + 

1 2

B(Q)

.

QHD2

Notice first that

(8.43)



1 2

B(Q)

QHD2

=

1 (HD2)2

(HD2)



2

B (HD1)2

(HD1)



-1

µ(H D1 ).

On the other hand, for x  A we have

(|R(x)|

-

c2 4

(HD1))+



c2 4

(HD1).

So, by Chebyshev and Lemma 8.14,

(A  F)

1^ (HD1)p0 FVR

(|R|

-

c2 4

(HD1))+

p0

d

 -1 25n

p0 (HD1 )

(HD1)p0

=

 -1 25n

µ(H D1 ),

which, together with (8.43), proves the first assertion of the lemma.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

53

For the second statement in the lemma we use Hölder and Lemma 8.14 again:

^
F VR

(|R|

-

c2 2

(HD1))+

p

d

=

^
AF

(|R|

-

c2 2

(HD1))+

p

d

p



^
AF

(|R| -

c2 4

(HD1))+

p0 d

p0

(A



F )1-

p p0

 -1 25n

p0 (HD1)

p p0

 -1 25n

µ(H D1 )

1-

p p0

=

 -1 25n

p(HD1).

Observe that, given R  MDW  Trc  Ty, from Lemmas 7.2 and 8.15, under the assumptions in those lemmas, we derive that

(8.44)

^
VR H D2

(|R(x)|-

c2 2

(HD1))+

p

d(x)



c-pn

p(HD1)

-

C



-1 25n

p(HD1)



-pn

p(HD1),

for

p



(1, p0],

assuming

that

n

and

p

are

chosen

so

that

pn



1 25n

.

This

is

the

main

ingredient for the proof of the next lemma, which is the main result of this section.

Lemma 8.16. Let R  MDW  Trc  Ty. Let  > 0 be big enough and suppose that Z  -72n. Then one of the following alternatives holds:
(a) µ(Z) > Z µ(R), or

(b)

T Rµ

2 L2 (µ)

> -1 (HD1).

Proof. Suppose that none of the alternatives holds. Then, by Lemmas 7.2 and 8.15, as in (8.44), we have

(8.45)

^ IHD2 :=
VR H D2

(|R(x)|

-

c2 2

(HD1))+

p d(x)

-pn p(HD1),

for all p  (1, p0], assuming that 0 is chosen small enough and that

(8.46)

pn



1 50n

.

The appropriate values of n and p will be chosen at the end of the proof. By arguments analogous to the ones we used to estimate the integral Ia in the proof
of Lemma 8.14 we will "transfer" the estimate for R in (8.45) to T Rµ, so that we will obtain a lower estimate for T Rµ L2(µ) which will contradict the assumption that (b) does not hold. Although some of the estimates below are very similar to the ones to obtain

the inequality (8.38) in the proof of Lemma 8.14, we will include the full details here for

the reader's convenience. On the other hand, an important differences between the proof

of that lemma and the current proof is that in Lemma 8.14 we took advantage of the fact

that p0 is close to 2, and the estimates there would not work for the family RegHD2, while in the arguments below it is essential the fact that we are taking p close to 1 and the

estimates work fine for the family RegHD2, while they would fail for the family Rega.

54

XAVIER TOLSA

By

Lemma

8.1,

for

all

Q



RegHD2

such

that

1 2

B

(Q)



VR,

all

x



1 2

B

(Q),

and

all

y  Q,

|R(x)|  |RTRegµ(y)| + C(R) + CP(Q) + CQReg(Q).

Thus,

for



big

enough,

since

(R)

=

-1(HD1)

<

c2 4

(HD1),

(|R(x)|

-

c2 2

(HD1))+



(|RTReg µ(y)|

-

c2 4

(HD1))+

+

C P (Q)

+

C QReg (Q).

Therefore,

IHD2

^
QRegHD2 Q

(|RTReg

µ(y)|

-

c2 4

(HD1))+

p dµ(y) +

(P(Q)p + QReg(Q)p) µ(Q).

QRegHD2

By (8.10) and Lemma 8.13, we have

(P(Q)p + QReg(Q)p) µ(Q) = Pp (RegHD2) + Qp (RegHD2 )

QRegHD2

p(HD2)

+

Q(Reg)

p 2

µ(H

D2

)1-

p 2

B

p-2

p(HD1)

+

P

(Reg)

p 2

µ(H

D2

)1-

p 2

.

Also, recalling that (HD2)  B (HD1), we get µ(HD2)  B -2 µ(HD1). Then, by Lemma 8.12, we obtain

P

(Reg)

p 2

µ(H

D2

)1-

p 2



p
B (HD1) 2

B -2 µ(HD1)

1-

p 2

= B p-2 p(HD1).

So, since any cube from RegHD2 is contained in some cube S  HD2:

IHD2

^
SHD2 S

(|RTReg µ(y)|

-

c2 4

(HD1))+

p

dµ(y)

+

B p-2

p(HD1).

For each S  HD2, by the triangle inequality and the fact that ( · )+ is a 1-Lipschitz function, we obtain

^
S

(|RTReg µ|

-

c2 4

(HD1))+

p

dµ

^
S

(|RT

µ|

-

c2 4

(HD1))+

p dµ

^

+

RT µ - RTReg µ p dµ

S

By

Lemma

8.3,

the

last

integral

does

not

exceed

C

E

(2S

)

p 2

µ(S

)1-

p 2

,

and

thus

(8.47) IHD2

^
SHD2 S

(|RT

µ|

-

c2 4

(HD1))+

p

dµ

+

E

(2S

)

p 2

µ(S

)1-

p 2

+

B

p-2

p(HD1).

SHD2

Next we apply Lemma 8.2, which implies that for any S  HD2 and all x  S,

(8.48)

|RT µ(x)|  |T Rµ(x)| + C

E (4R) µ(R)

1/2
+C

E (2S ) µ(S)

1/2
.

8n-1

In

case

that

R



DB,

recalling

that



=

M 8n-2
0



M0

by

(4.2),

for



big

enough

we

obtain

C

E (4R) µ(R)

1/2



C

M0

(R)



c2 4

(HD1

),

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

55

If R  DB, then we use the fact that R  Ty, which ensures that

E (4R)

E(9P )



 -1 3n

(HD1),

P T :P DB

and so we also get

C

E (4R)

1/2
C

µ(R)

 -1 3n

(HD1)

µ(R)

1/2



C

 -1 6n

(HD1)



c2 4

(HD1

).

Hence, in any case we have

(|RT

µ(x)|

-

c2 4

(HD1))+



|T

Rµ(x)|

+

C

E (2S ) µ(S)

1/2
.

Plugging this estimate into (8.47), we get

(8.49)

IHD2

^

|T Rµ|p dµ +

p
E(2S) 2

µ(S

)1-

p 2

+

B

p-2

p(HD1).

H D2

SHD2

Next we will estimate each term on the right hand side. First, by Hölder's inequality,

we have

^ |T Rµ|p dµ
H D2


T Rµ

p L2 (µ)

µ(H

D2)1-

p 2

T Rµ

p L2 (µ)

(B-2µ(H

D1))1-

p 2



T Rµ

p L2

(µ)

(-1

µ(H

D1

))1-

p 2

.

Regarding the second term in (8.49), by Hölder's inequality again,

(8.50)

p
E(2S) 2

µ(S

)1-

p 2



E (2S )

SHD2

SHD2

We estimate now the first factor on the right hand side:

p

2

µ(H

D2

)1-

p 2

.

E(2S) 

E(2S) +

E (2S )

SHD2

S HD2 \DB

ST :SDB

M02

(S)

+

 -1 3n

(HD1)

S HD2 \DB



M02

(HD2)

+

 -1 3n

(HD1)



B

M02

(HD1)

+

 -1 3n

(HD1)

B M02 (HD1).

Hence, plugging this estimate into (8.50) and using that µ(HD2)  B -2µ(HD1),

p
E(2S) 2

µ(S

)1-

p 2

B M02 (HD1)

p 2

B -2µ(HD1)

1-

p 2

= M0p B p-2 p(HD1).

SHD2

Altogether, we deduce that

IHD2

T Rµ

p L2 (µ)

(-1µ(H

D1))1-

p 2

+ M0p B p-2 p(HD1).

Recalling the lower estimate for IHD2 in (8.45), we obtain

(8.51)

T Rµ

p L2 (µ)

(-1µ(H

D1))1-

p 2

 c -pn p(HD1) - C M0p B p-2 p(HD1).

56

XAVIER TOLSA

Recall now that

M0

=

1-

1 8n-1

 .

Notice that for p close enough to 1, we have M0p B p-2  1, so that the last term on the

right hand side of (8.51) is much smaller than the first one, assuming n close enough to

0. To be more precise, let us take

p

=

1

+

1 4(8n -

1)

.

A

straightforward

calculation

gives

M0p

p-2

=

-

1 2(8n-1)

-

1 4(8n-1)2

,

so

that

B M0p p-2



1 100n

-

1 2(8n-1)



 . -

1 4(8n-1)

Then we choose n so that, besides (8.46), it satisfies

n



1 8(8n -

1)

(p

-

1)

=

1 32(8n -

1)2 ,

and we derive

T Rµ

p L2 (µ)

(-1µ(H

D1))1-

p 2

which is equivalent to

-pn p(HD1),

T Rµ

2 L2(µ)

-pn

1-

p 2

p(HD1

)

µ(H

D1

)

p 2

-1

p 2

=

-

2n p-1

+

p 2

-1

(HD1)



-1

(HD1).

This contradicts the assumption that the alternative (b) in the lemma does not hold.

9. The proof of Proposition 3.7

We have to show that

E(9Q)  C

Rµ

2 L2 (µ)

+

02

µ

,

QDB

with C possibly depending on  and other parameters. Recall that by Lemma 6.5, we have

E(9Q)



-1 2n

(log

)2

B -k/2

(HD1(e(Q))).

QDB

RL(GDF) k0

QTrck (R)Ty

Also, by Lemma 6.2, it turns out that, for all P  Dµ and all k  0,

# R  L(GDF) :  Q  Trck(R) such that P  T (e(Q))  C2 (log )2.

Observe now that, by Lemma 8.16, for each Q  Trck(R)  Ty, either (HD1(e(Q))) 02 µ(Q)  02 -Z1 µ(Z(Q)),

where Z(Q) is the set Z appearing in Lemma 6.5 (replacing R by Q there), or

(HD1(e(Q)))  

T (e(Q))Rµ

2 L2

(µ)

.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

57

Therefore,

(9.1)

E(9Q) 

B -k/2

T (e(Q))Rµ

2 L2 (µ)

QDB

RL(GDF) k0

QTrck (R)Ty

+

B -k/2

02 -Z1 µ(Z(Q))

RL(GDF) k0

QTrck (R)Ty

=: T1 + T2.

9.1. Estimate of T1. Recall that

T (e(Q))Rµ(x) =

P (x) mµ,P (Rµ) - mµ,2Q(Rµ)

P End(e(Q))

+ Z(Q)(x) Rµ(x) - mµ,2R(Rµ) .

For Q  MDW, we write S  Q if S  Dµ is a maximal cube contained in e(Q). Then we denote

QRµ = (mµ,S(Rµ) - mµ,2Q(Rµ) S.
SQ

Then, it is easy to check that

T (e(Q))Rµ =

P Rµ + QRµ G(Q),

P T (e(Q))\End(e(Q))

where

G(Q) =

P  Z(Q)

P End(e(Q))

(see [DT, Section 8.1] for the full details). It is also immediate to check that, for a fixed Q, all the functions appearing on the right hand side are mutually orthogonal in L2(µ).
Arguing as in (8.17), one sees that the cubes P  T (e(Q)) satisfy P  T (e(Q)). So we
get

T (e(Q))Rµ

2 L2 (µ)

=

P Rµ

2 L2 (µ)

+

QRµ

2 L2 (µ)

P T (e(Q))\End(e(Q))



P Rµ

2 L2 (µ)

+

QRµ

2 L2 (µ)

.

P T (e(Q))

Therefore,

T1 

B -k/2

P Rµ

2 L2 (µ)

RL(GDF) k0

QTrck(R)Ty P T (e(Q))

+

B -k/2

RL(GDF) k0
=: T1,1 + T1,2.

QTrck (R)Ty

QRµ

2 L2 (µ)

58

XAVIER TOLSA

By Fubini, regarding the term T1,1, we have

T1,1 

P Rµ

2 L2 (µ)

B-k/2 #A(P, k),

P Dµ

k0

where

A(P, k) = R  L(GDF) :  Q  Trck(R) such that P  T (e(Q)) .

As shown in (6.12), it holds

#A(P, k) (log )2.

Hence,

T1,1 

P Rµ

2 L2 (µ)

P Dµ

Concerning T1,2, we argue analogously:



Rµ

2 L2

(µ)

.

T1,2 

QRµ

2 L2 (µ)

B-k/2 #A(Q, k),

QDµP

k0

where Since

A(Q, k) = R  L(GDF) : Q  Trck(R) . #A(Q, k)  #A(Q, k) (log )2,

we deduce that

T1,2 

QRµ

2 L2

(µ)

.

QMDW

By Lemma 8.1 from [DT],6 the right hand side above is also bounded by C

Rµ

2 L2

(µ)

.

So

we have,

T1



Rµ

2 L2

(µ)

.

9.2. Estimate of T2. We have

T2 =

B -k/2

02 -Z1 µ(Z(Q))

RL(GDF) k0

QTrck (R)Ty

^

=

B -k/2

02 -Z1 dµ

RL(GDF) k0

QTrck(R)Ty Z(Q)

^ = 02 -Z1

B -k/2

Z(Q) dµ.

RL(GDF) k0

QTrck (R)Ty

By Fubini, we have

where

B -k/2

Z(Q)  B-k/2 #D(x, k),

RL(GDF) k0

QTrck (R)Ty

k0

D(x, k) = R  L(GDF) :  Q  Trck(R) such that x  Z(Q) .

6In fact, the family MDW in [DT] is not the same as the one in the current paper because in [DT] MDW is a subfamily of roots of a corona decomposition of Dµ. However, the reader can check that the proof of Lemma 8.1 from [DT] works verbatim in our situation too.

THE RIESZ TRANSFORMS AND THE PAINLEVÉ PROBLEM

59

Observe now that, given j  1, if we let Dj(x, k) = R  L(GDF) :  Q Trck(R) such that T (e(Q)) contains every P  Dµ such that x  P and (P )  A-0 j ,
then we have D(x, k) = Dj(x, k),
j1
and moreover Dj(x, k)  Dj+1(x, k) for all j. From Lemma 6.2 we deduce that #Dj(x, k)  C (log )2 for all j  1.
Thus, #D(x, k)  C (log )2 too. Consequently,

B -k/2

Z (Q)

RL(GDF) k0

QTrck (R)Ty

 1,

and so T2  -Z102 µ .
Together with the estimate we obtained for T1, this yields

E(9Q)



Rµ

2 L2 (µ)

+

-Z 1 02

µ,

QDB

which concludes the proof of Proposition 3.7.

References

[AHM+] J. Azzam, S. Hofmann, J.M. Martell, S. Mayboroda, M. Mourgoglou, X. Tolsa, and A. Volberg.

Rectifiability of harmonic measure. Geom. Funct. Anal. (GAFA), 26(3) (2016), 703­728.

[AMT] J. Azzam, M. Mourgoglou and X. Tolsa. Mutual absolute continuity of interior and exterior

harmonic measure implies rectifiability. Comm. Pure Appl. Math. Vol. LXX (2017), 2121­2163.

[AMTV] J. Azzam, M. Mourgoglou, X. Tolsa and A. Volberg. On a two-phase problem for harmonic

measure in general domains. Amer. J. Math. 141(5) (2019), 1259­1279.

[AT] J. Azzam and X. Tolsa. Characterization of n-rectifiability in terms of Jones' square function:

[DT]

Part II. Geom. Funct. Anal. 25 (2015), no. 5, 1371­1412. D. Dbrowski and X. Tolsa. The measures with L2-bounded Riesz transform satisfying a subcrit-

ical Wolff-type energy condition. Preprint (2021).

[DM] G. David and P. Mattila. Removable sets for Lipschitz harmonic functions in the plane. Rev.

Mat. Iberoamericana 16(1) (2000), 137­215.

[DS1] G. David and S. Semmes. Singular integrals and rectifiable sets in Rn: Beyond Lipschitz graphs,

Astérisque No. 193 (1991).

[DS2] G. David and S. Semmes. Analysis of and on uniformly rectifiable sets, Mathematical Surveys

and Monographs, 38. American Mathematical Society, Providence, RI, (1993).

[ENV] [Gi]

V. Eiderman, F. Nazarov and A. Volberg. The s-Riesz transform of an s-dimensional measure in R2 is unbounded for 1 < s < 2. J. Anal. Math. 122 (2014), 1­23. D. Girela-Sarrión. Geometric conditions for the L2-boundedness of singular integral operators

with odd kernels with respect to measures with polynomial growth in Rd. J. Anal. Math. 137

(2019), no. 1, 339­372.

[JN1] B. Jaye and F. Nazarov. Reflectionless measures for Calderón-Zygmund operators I: general

theory. J. Anal. Math. 135 (2018), no. 2, 599­638.

[JN2] B. Jaye and F. Nazarov. Reflectionless measures for Calderón-Zygmund operators II: Wolff po-

tentials and rectifiability. J. Eur. Math. Soc. (JEMS) 21 (2019), no. 2, 549­583.

60

XAVIER TOLSA

[JNRT] B. Jaye, F. Nazarov, and M.C. Reguera, and X. Tolsa. The Riesz transform of codimension

smaller than one and the Wolff energy. Mem. Amer. Math. Soc. 266 (2020), no. 1293.

[JNT] B. Jaye, F. Nazarov, and X. Tolsa. The measures with an associated square function operator bounded in L2. Adv. Math. 339 (2018), 60­112.

[Jo]

P.W. Jones. Rectifiable sets and the travelling salesman problem. Invent. Math. 102 (1990), 1­15.

[Lé]

J.C. Léger. Menger curvature and rectifiability. Ann. of Math. 149 (1999), 831­869.

[Ma] P. Mattila. Geometry of sets and measures in Euclidean spaces, Cambridge Stud. Adv. Math.

44, Cambridge Univ. Press, Cambridge, 1995.

[Me]

M.S. Melnikov. Analytic capacity: discrete approach and curvature of a measure. Sbornik: Math-

[MV]

ematics 186(6) (1995), 827­846. M.S. Melnikov and J. Verdera. A geometric proof of the L2 boundedness of the Cauchy integral

on Lipschitz graphs. Internat. Math. Res. Notices (1995), 325­331.

[MP] P. Mattila and P. V. Paramonov. On geometric properties of harmonic Lip1 capacity. Pacific J.

Math. 171(2) (1995), 469­491.

[NToV1] F. Nazarov, X. Tolsa and A. Volberg. On the uniform rectifiability of AD-regular measures with

bounded Riesz transform operator: the case of codimension 1. Acta Math. 213 (2014), no. 2,

237­321.

[NToV2] F. Nazarov, X. Tolsa and A. Volberg. The Riesz transform, rectifiability, and removability for

Lipschitz harmonic functions. Publ. Mat. 58 (2014), 517­532.

[NTrV1] F. Nazarov, S. Treil, and A. Volberg. Cauchy integral and Calderón­Zygmund operators on

nonhomogeneous spaces. Internat. Math. Res. Notices 15 (1997), 703­726.

[NTrV2] F. Nazarov, S. Treil, and A. Volberg. The T b-theorem on non-homogeneous spaces. Acta Math.

190 (2) (2003).

[Pa]

P.V. Paramonov. Harmonic approximations in the C1-norm. Mat. Sb. 181 (1990), no. 10, 1341­

1365.

[RT] M.C. Reguera and X. Tolsa. Riesz transforms of non-integer homogeneity on uniformly discon-

[To1]

nected sets. Trans. Amer. Math. Soc. 368 (2016), no. 10, 7045­7095. X. Tolsa. L2-boundedness of the Cauchy integral operator for continuous measures. Duke Math.

J. 98(2) (1999), 269-304.

[To2] X. Tolsa. Painlevé's problem and the semiadditivity of analytic capacity, Acta Math. 190:1 (2003),

105­149.

[To3] X. Tolsa. Bilipschitz maps, analytic capacity, and the Cauchy integral. Ann. of Math. 162:3

(2005), 1241­1302.

[To4] X. Tolsa. Rectifiable measures, square functions involving densities, and the Cauchy transform.

Mem. Amer. Math. Soc. 245 (2016), no. 1158, 1­130.

[To5] X. Tolsa. Analytic capacity, the Cauchy transform, and non-homogeneous Calderón-Zygmund

theory. Progress in Mathematics, vol. 307, Birkhäuser/Springer, Cham, 2014.

[Vo]

A. Volberg, Calderón­Zygmund capacities and operators on nonhomogeneous spaces. CBMS Re-

gional Conf. Ser. in Math. 100, Amer. Math. Soc., Providence, 2003.

Xavier Tolsa, ICREA, Passeig Lluís Companys 23 08010 Barcelona, Catalonia;, Universitat Autònoma de Barcelona, 08193 Bellaterra, Catalonia; and Centre de Recerca Matemàtica, 08193 Bellaterra, Catalonia.
Xavier Tolsa, ICREA, Passeig Lluís Companys 23 08010 Barcelona, Catalonia; Universitat Autònoma de Barcelona and Centre de Recerca Matemàtica, 08193 Bellaterra, Catalonia.

