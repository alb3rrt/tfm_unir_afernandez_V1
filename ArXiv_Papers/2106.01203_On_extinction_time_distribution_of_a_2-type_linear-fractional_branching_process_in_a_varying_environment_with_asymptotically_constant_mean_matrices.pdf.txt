On extinction time distribution of a 2-type linear-fractional branching process in a varying environment with asymptotically constant mean matrices

arXiv:2106.01203v1 [math.PR] 2 Jun 2021

Hua-Ming WANG

Abstract
In this paper we study a 2-type linear-fractional branching process in varying environment with asymptotically constant mean matrices. Let  be the extinction time and for k  1 let Mk be the mean matrix of offspring distribution of individuals of the (k - 1)-th generation. Under certain conditions, we show that P ( = n) and P ( > n) are asymptotically equivalent to some functions of products of spectral radii of the mean matrices. This paper complements a former result [arXiv: 2007.07840] which requires in addition a condition k  1, det(Mk) < - for some  > 0. Such a condition excludes a large class of mean matrices. As byproducts, we also get some results on asymptotics of products of nonhomogeneous matrices which have their own interests.
Keywords: Branching process in varying environment, extinction time, product of nonhomogeneous matrices, spectral radius, continued fraction.
MSC 2020: 60J80, 60J10, 15B48

1 Introduction

1.1 Background and motivation. It is known that many new phenomena, which homogeneous Galton-Watson processes do not possess, arise when considering the branching processes in varying environments (BPVE hereafter). Thus BPVE has been extensively studied by many authors. For details of the single-type case, we refer the reader to [1], [6], [7], [10], [11], [12], [15] and references therein.
Compared with the single-type case, the situation of the multitype setting is less satisfying. The convergence of the normalized population size and criteria for almost sure extinction can be found in [2], [3], [9] and a recent article [4]. We notice also that in [4], Dolgopyat et al. gave also the asymptotics of the survival probabilities. Their proof relies on a generalization of the Perron-Frobenius theorem suitable for studying the product of nonhomogeneous nonnegative matrices. Let  be the extinction time and Mk be the mean matrix of offspring distribution of individuals of the (k - 1)-th generation. They showed that

(1)

1 C

n

-1 1 · · · -n 1

-1
< P ( > n) < C

n

-1 1 · · · -n 1

-1
,

k=1

k=1

Email:hmking@ahnu.edu.cn; School of Mathematics and Statistics, Anhui Normal University, Wuhu, 241003, China

1

2

WANG

where 0 < C <  is a certain constant and for k  1, k is a number associated to the generalized Perron-Frobenius theorem and depends on the mean matrices Mn, n  k of the branching process, see [4, Proposition 2.1 and Lemma 2.2]. Although (1) provides a lower and an upper bound for the survival probability, it does not give the asymptotical equivalence of the survival probability and furthermore, those number k, k  1 are hard to compute explicitly. For this consideration, Wang and Yao [18] considered a 2-type linear-fractional branching process with asymptotically constant mean matrices. Instead of those number k, they used the spectral radii of the mean matrices of the offspring distributions, which can be explicitly computed. For this special setting, they give not only the asymptotical equivalence of P ( > n) but also that of P ( = n). But, they need a condition

(2)

k  1, Mk(12)Mk(21) > Mk(11)Mk(22) + 

for some  > 0, which excludes a large class of mean matrices. They added such a restriction because their proof depends on some result on the asymptotical equivalence between the elements of products of positive matrices and the products of spectral radii of those matrices, which was studied in [17], and some delicate analysis of the tails and the critical tails of positive continued fractions. Without (2), one has to deal with product of matrices with some negative elements and also continued fractions with negative coefficients.
In this paper, by generalizing the result of product of matrices in [17] and analyzing the tails and approximants of continued fractions with negative coefficients, we remove the assumption (2) to characterize asymptotics of the tail probability and the probability that the extinction time equals n as n  .
1.2 Model and main results. Suppose that Mk, k  1 is a sequence of nonnegative 2-by-2 matrices and k = (k(1), k(2)), k  1 is a sequence of nonnegative row vectors. To avoid the degenerate case, we require that k  1, all elements of MkMk+1 are strictly positive and k = 0. For s = (s1, s2)t  [0, 1]2 and k  1, let

fk(s)

=

(fk(1)(s),

fk(2) (s))t

=

1

-

Mk(1 - s) 1 + k(1 - s)

which is known as the probability generating function of a linear-fractional distribution. Here and in what follows, vt denotes the transpose of a vector v and 1 = (e1 + e2)t = (1, 1)t, with e1 = (1, 0), e2 = (0, 1).
Suppose that Zn = (Zn,1, Zn,2), n  0 is a stochastic process such that

E sZn Z0, ..., Zn-1 = [fn(s)]Zn-1 , n  1,

where [fn(s)]Zn-1 :=

fn(1)(s) Zn,1

fn(2)(s)

Zn,2
.

We

call

the

process

Zn, n



0

a

two-type linear-fractional branching process in a varying environment. Matrices

Mk, k  1 are usually referred to as the mean matrices of the branching process. Denote by

 = min{n : Zn = 0}

the extinction time of {Zn} which we concern. Throughout, we assume bk, dk > 0, ak, k  0, ak + k > 0, k  1 and put

(3)

Mk :=

ak bk dk k

, k := e1Mk, k  1.

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

3

We introduce the following conditions on the number ak, bk, dk, k, k  1. (B1) Suppose that b, d > 0, a,   0 are some numbers such that a +  > 0, ak  a, bk  b, dk  d, k   as k   and assume further that

|ak - ak-1| + |bk - bk-1| + |dk - dk-1| + |k - k-1| < .
k=2

Suppose now condition (B1) holds and for k  1, set

(4)

Ak :=

a~k ~bk d~k 0

with

a~k

=

ak

+

bk k+1 bk+1

,

~bk

=

bk, d~k

=

dk

-

ak k bk

.

Letting k =

10 k/bk 1

, k  1, then for n  k  1, we have

n

n

(5)

Ak = -k 1Mkk+1 and e1 Mi1 = e1 Ai(1, 1 - n+1/bn+1)t.

i=k

i=k

For linear-fractional setting, the distribution of  can be formulated explicitly

by Mk, see (70) and (71) below. However, the elements of

compute and evaluate whereas those of

n i=k

Ai

are

workable

n i=k

Mi

are

hard

to

because they have

some correspondence with continued fractions due to the special structure of the

matrices Ai, i  1. Therefore, instead of Mk, we will work with Ak below.

We need in addition the following conditions which are mutually exclusive.

(B2)a k0 > 0, such that

a~k ~bk

=

, a~k+1
~bk+1

d~k ~bk

=

, d~k+1
~bk+1

k  k0 and

lim
k

d~k+2/~bk+2 - d~k+1/~bk+1

d~k+1/~bk+1 - d~k/~bk

exists.

(B2)b

k0

>

0,

such

that

a~k ~bk

=

, a~k+1
~bk+1

d~k ~bk

=

, d~k+1
~bk+1

k  k0 and

lim
k

a~k+2/~bk+2 - a~k+1/~bk+1

a~k+1/~bk+1 - a~k/~bk

exists.

(B2)c k0 > 0, such that

a~k ~bk

=

, a~k+1
~bk+1

d~k ~bk

=

, d~k+1
~bk+1

k  k0 and



:=

lim
k

d~k+1/~bk+1 a~k+1/~bk+1

- d~k/~bk - a~k/~bk

=

-(a + ) ±

(a + )2 + 4(bd - a) 2b

exists as a finite or infinite number. In addition, if  is finite, assume further

that

limk

a~k+2 /~bk+2 -a~k+1 /~bk+1 a~k+1 /~bk+1 -a~k /~bk

exists.

limk

d~k+2 /~bk+2 -d~k+1 /~bk+1 d~k+1/~bk+1-d~k /~bk

exists.

Otherwise, if  = , assume further that

The conditions (B2)a, (B2)b and (B2)c look a bit complicated. But they are not

so difficult to fulfilled. We refer the reader to [18, Lemma 1] for examples for which

(B1) and one of (B2)a, (B2)b and (B2)c hold.

Note that under condition (B1), we have

lim
k

Mk

=

M

:=

ab d

,

lim
k

Ak

= A :=

a+ b d - a/b 0

4

WANG

whose eigenvalues are

(6)

 := (M ) = (A) = a +  +

(a

+

)2 2

+

4(bd

-

a)

,

(7)

1 := 1(M ) = 1(A) = a +  -

(a

+

)2 2

+

4(bd

-

a)

.

It is clear that |1| < . In the literature, (B) := sup{|| :  is an eigenvalue of B} is usually referred to as the spectral radius of a matrix B. In what follows, we always denote by (B) the spectral radius of a matrix B and when we simply write  and 1, their values will be always those defined in (6) and (7) respectively.
In the rest of the paper, f (n)  g(n) means limn f (n)/g(n) = 1, f (n) = o(g(n)) means limn f (n)/g(n) = 0 and unless otherwise specified, c and C are some universal strictly positive constants, which may change from line to line. We always assume that empty product equals identity and empty sum equals 0. The convention -1 = i will also be adopted.

Now we are ready to state the main result.

Theorem 1. Suppose that condition (B1) and one of the conditions (B2)a, (B2)b and (B2)c hold. Assume further that |1| < 1, bd = a and i > 0, i > 0, i = 1, 2 are proper constants. Then for i  {1, 2}

(8)

P ( > n|Z0 = ei) 

i

n+1 k=1

(M1)-1

·

·

·

(Mk-1

)-1

as

n  .

Furthermore,

if

1

=

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd-a -b

, then for i  {1, 2}

(9)

P ( = n|Z0 = ei) 

i(M1)-1 · · · (Mn)-1

n+1 k=1

(M1)-1

·

·

·

(Mk-1)-1

2,

as n  ;

otherwise,

if

1

=

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd-a -b

, then for i  {1, 2},

(10) P ( = n|Z0 = ei) = o

(M1)-1 · · · (Mn)-1

n+1 k=1

(M1)-1

·

·

·

(Mk-1

)-1

2

, as n  .

Remark 1. By some elementary computation, one can show that if bd > a, then

1

=

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd-a -b

if and only if  = b + 1, see [18] for

details.

The proof of Theorem 1 relies on the asymptotics of the product of nonhomo-
geneous matrices Ak, k  1, which have their own interests. See the two theorems below.

Theorem 2. Suppose that condition (B1) and one of the conditions (B2)a, (B2)b and (B2)c hold. Then for i, j  {1, 2} and k  1, there exists a number c(k, i, j) = 0 such that

(11)

lim
m

eiAk · · · Ametj (Ak) · · · (Am)

=

c(k, i,

j).

Remark 2. In [17], similarly result is proved if for each k  1, all elements of Ak are nonnegative, see Theorem 1 therein. But now, under condition (B1), d~k might be negative. So, though the basic idea is somewhat the same, the proof of Theorem 2
differs on a large extent from the one of Theorem 1 in [17].

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

5

Theorem 3. Suppose that condition (B1) and one of the conditions (B2)a, (B2)b and (B2)c hold. If bd = a, then

(12)

n+1

n+1

e1Ak · · · Anet1  c (Ak) · · · (An), as n  .

k=1

k=1

Remark 3. Although we have shown in Theorem 2 that for each k  1, c(k) = 0

such that e1Ak · · · Anet1  c(k)(Ak) · · · (An) as n  , it is not an easy task to

prove Theorem 3, because that the constants c(k), k  1 involved there are mutually

different and moreover every summand in

n+1 k=1

e1Ak

· · · Anet1

depends

on

n.

1.3 Outline of the paper. The remainder of the paper is organized as follows. In Section 2, we give some preliminary results of continued fractions and also some facts on products of the matrices Mk and Ak. Section 3 and Section 4 are devoted to proving Theorem 2 and Theorem 3 respectively. Finally, in Section 5, based on Theorem 2 and Theorem 3, we finish the proof of Theorem 1.

2 Preliminary results

Products of 2-by-2 matrices are closely related to continued fractions and therefore continued fractions are important tools to prove Theorem 1. To begin with, we introduce some basics of continued fractions.

2.1 Continued fractions and their tails

Let k, k, k  1 be certain real numbers. For 1  k  n, We denote by

(13)

k,n



k k

+

k+1 k+1

+···+

n n

:=

k

+

k

k+1

k+1+.

.

. +

nn

the (n - k + 1)-th approximant of a continued fraction

(14)

k

:=

k k

+

k+1 k+1

+

k+2 k+2

+··· .

We

call

k, k



1

in

(14)

the

tails

and

hk

:=

k k-1

+

k-1 k-2

+···+

2 1

,

k



2

the

critical

tails

of the continued fraction

1 1

+

2 2

+···

respectively.

We remark that in the literature, the

n-th

tail

of

a

continued

fraction

1 2 1 + 2 +···

is

usually

denoted

by

f (n)

=

n+1 n+2 n+1 + n+2 +···

and the critical tails are also slightly different from hn, n  1 above.

If limn k,n exists, we say that the continued fraction k is convergent and its

value is defined as limn k,n. The lemma below will be use times and again.

Lemma 1. If limn n =  = 0, limn n = , and 2 + 4  0, then for any k  1, limn k,n exists and furthermore

lim
k

hk

=

lim
k

k

=

 2

1 + 4/2 - 1 .

The proof Lemma 1 can be found in many references, we refer the reader to [13], see discussion between (4.1) and (4.2) on page 81 therein.

6

WANG

2.2 Some facts on matrices Ak and Mk
By assumptions on the numbers ak, bk, dk and k, we have

Ak · · · An = -k 1Mk · · · Mnn+1, n  k  1,

(15)

e1Ak · · · Anet1 = e1Mk · · · Mn(1, n+1/bn+1)t > 0, n > k  1,

(16)

e1Ak · · · Anet2 = e1Mk · · · Mnet2 > 0, n > k  1,

(17)

e2Ak · · · Anet1 = (-k/bk, 1)Mk · · · Mn(1, n+1/bn+1)t, n  k  1.

Note that the conditions of Theorem 1 can not ensure k :=

ak

+

bk k+1 bk+1

2
+

4(bkdk - akk) > 0 for each k  1. Therefore, the matrix Ak may possess complex

eigenvalues. However, since limk k = (a - )2 + 4bd > 0, there exists a number

N1 > 0 such that k > 0, k  N1, and thus

(18) (Ak) =

a~2k + 4~bkd~k + a~k 2

=

1 2

ak

+

bk k+1 bk+1

+

ak

+

bk k+1 bk+1

2
+ 4(bkdk - akk)

, k  N1.

Furthermore, if bd = a, then limn d~n = d - a/b = 0. Thus, if bd < a, then

 > 0 and N2 > 0, such that d~n < -, n  N2 and consequently e2Ak · · · Anet1 < 0, n  k  N2 and e2Ak · · · Anet2 < 0, n > k  N2;

otherwise, if bd > a, then

 > 0 and N2 > 0, such that d~n > , n  N2 and consequently e2Ak · · · Anet1 > 0, n  k  N2 and e2Ak · · · Anet2 > 0, n > k  N2.

3

Asymptotics of elements of

m j=k

Aj

The main task of this section is to prove Theorem 2. The proof is based on the

spectral radius estimation derived in [8] and some analysis of the fluctuations of the

tails and critical tails of continued fractions.

3.1

Lower

and

upper

bounds

for

e1 Ak ···Am et1 (Ak )···(Am )

The main result of this subsection is the following lemma.

Lemma 2. Suppose that condition (B1) holds. Then N0 > 0 such that for each

k



N0,

Ck-1

<

e1 Ak ···Am et1 (Ak )···(Am )

<

Ck, m



k,

where

Ck

>

0

is

a

proper

number.

Lemma 2 is a direct consequence of the following four auxiliary lemmas.

Lemma 3. Suppose the condition (B1) is satisfied. Then with N1 the one in (18), for each k  N1,  Ck > 0 and Bk > 0 such that

n

n

n+1 j-1

n+1 j-1

(Aj)  Ck (Mj) and

(Ai)-1  Bk

(Mi)-1, as n  .

j=k

j=k

j=k i=k

j=k i=k

For the proof of Lemma 3, we refer the reader to [18].

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

7

Lemma 4. Suppose that condition (B1) holds. Then there exist constants 0 <  <



<



such

that

for

m



k



1,





(Mk ···Mm ) (Mk )···(Mm )



.

Proof. For vectors v =

v1 v2

and u =

u1 u2

, set

v := u

v1/u1 v2/u2

,

v

:= min

u min

v1 u1

,

v2 u2

,

v

:= max

u max

v1 u1

,

v2 u2

.

Let vn be a right eigenvector of An corresponding to the largest eigenvalue (An). Then we can choose vn to be vn = ((An) - n, dn)t . For m  k  1, write

k,m := k,m :=

vk

· · · vm+1

vm

,

vk-1 max

vm max vk max

vk

· · · vm+1

vm

.

vk-1 min

vm min vk min

Applying [8, Theorem 1, page 228], for k  1, we have

k,m



(Mk · · · Mm) (Mk) · · · (Mm)



k,m.

It remains to show that both k-,m1 and k,m, m  k  1 are uniformly bounded away from . To this end, set n = (vn/vn-1)max - 1, n  2. Then by condition (B1), for n  2, we have

|n|  max

(Mn) (Mn-1)

- -

n n-1

-

1

,

dn dn-1

-1



(Mn) (Mn-1)

- -

n n-1

-

1

+

dn dn-1

-

1

 c(|(Mn) - (Mn-1)| + |dn - dn-1| + |n - n-1|)

 c(|an - an-1| + |bn - bn-1| + |dn - dn-1| + |n - n-1|) < ,

which implies

 n=2

log(1

+

|n|)

<

.

As

a

consequence,

k,m  max

(Mm) (Mk )

- -

m k

,

dm d


(1 + |n|) < 
n=2

for some number  <  independent of k and m.

Since k-,m1 =

vk-1

···

vk max

vm

vk , a similar argument also yields

vm+1 max vm max

that k-,m1 , m  k  1 are uniformly bounded away from . Consequently, Lemma 4

is proved.

Lemma 5. Suppose that condition (B1) holds and for k  1, let k be the one in

(14)

with

n

=

a~n ~bn

,

n

=

d~n ~bn

,

n



1.

Then

N3

>

0

such

that

(19)

lim
m

(Ak · · · Am) e1Ak · · · Amet1

=

1+

b-1k

>

c

>

0, k



N3.

Proof. For m  k  1, write Ak,m := Ak · · · Am = Noticing that

Ak,m(11) Ak,m(12) Ak,m(21) Ak,m(22)

.

Ak,m =

a~k ~bk d~k 0

···

a~m ~bm d~m 0

= ~bk · · · ~bm

k 1 k 0

···

m 1 m 0

,

8

WANG

thus we get

Ak,m+1(22) Ak,m+1(12)

=

Ak,m(21) Ak,m(11)

,

and by forward and backward induction we have

(20) (21)

Ak,m(21) Ak,m(11)

=

k k

+

k+1 k+1

m-1 + ···+ m-1

+

m m

=: k,m,

Ak,m(12) Ak,m(11)

=

1 m

+

m m-1

+

m-1 m-2

k+2 + ···+ k+1

+

k+1 k

=: hm,k,

Ak,m(22) Ak,m(21)

=

1 m

+

m m-1

+

m-1 m-2

k+3 + ···+ k+2

+

k+2 k+1

.

Since k  (a + )/b and k  (bd - a)/b2 as n  , applying Lemma 1 we get

(22)

lim
m

Ak,m(21) Ak,m(11)

=

lim
k

Ak,m(22) Ak,m(12)

=

k,

(23)

lim
m

Ak,m(12) Ak,m(11)

=

lim
k

Ak,m(22) Ak,m(21)

=

b-1,

(24)

lim
m

k

=

-

1 b

.

We are ready to prove (19). Write

(25)

Pk,m = Ak,m(12)Ak,m(21) - Ak,m(11)Ak,m(22).

If (Ak,m(11) + Ak,m(22))2 + 4Pk,m  0, then

(26)

(Ak,m)

=

Ak,m(11)

+ Ak,m(22) 2

+

(Ak,m(11)

+

Ak,m(22))2 2

+

4Pk,m

;

otherwise, if If (Ak,m(11) + Ak,m(22))2 + 4Pk,m < 0, then

(Ak,m)

=

1 2

(Ak,m(11) + Ak,m(22))2 + |(Ak,m(11) + Ak,m(22))2 + 4Pk,m|.

Note that m  k  1, Ak,m(11) > 0 and by (22)-(24), we have

(27)

lim (1
k

+

b-1 k )

=

1

-

1 

>

0,

lim
m

(Ak,m(11)

+ Ak,m(22))2 (Ak,m(11))2

+

4Pk,m

=

1 + b-1k 2 .

Therefore there exists N3 > 0, such that for each k > N3, we have 1 + b-1k > 0, and for m large enough the eigenvalues of Ak,m are real so that (26) holds. Thus, taking (22)-(24) into account, for k  N3, we get

lim
m

(Ak · · · Am) e1Ak · · · Amet1

=

lim
m

(Ak,m) Ak,m(11)

= 1/2(1 + b-1k + |1 + b-1k|) = 1 + b-1k > c > 0,

which proves (19). The lemma is proved.

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

9

Lemma

6.

For

k

 1,

set

k

=:

1+b-1 k

1+b-1k +b-1

k bk

-

 b

. Then, N4 > 0 such that

(28)

lim
n

(Ak (Mk

· · · An) · · · Mn)

=

k

>

c

>

0, k



N4.

Proof. Write Ak,n = Ak · · · An, let Pk,n be the one in (25) and set

Qk,n = Ak,n(11) + Ak,n(22) + Ak,n(12)

k bk

-

n+1 bn+1

.

Since Mk · · · Mn = kAk,n-n+11, then

(Mk

···

Mn)

=

1 2

Qk,n +

Q2k,n + 4Pk,n .

Using (22) and (23), we get

(29)

lim
n

(Mk · · · Mn) Ak,n(11)

=

1

+

b-1k

+

b-1

k bk

-

 b

.

Let N3 be the one in Lemma 5. Using (27) and the fact limk k/bk  /b, we have limk k = 1. Hence, N4 > N3 such that for k > N4, k > 1/2. As a result, (29) together with (19) implies that (28) is true.

3.2 Fluctuations of tails and critical tails of continued fractions

For k  1, let

(30) Set also

fk

=

~bkd~-k 1 a~kd~-k 1

+

~bk-1d~-k-11 a~k-1d~-k-11

+···+

~b1d~-1 1 a~1d~-1 1

,

k

=

~b-k 1d~-k+11 a~k~b-k 1d~-k+11

+

~b-k+11d~-k+12 a~k+1~b-k+11d~-k+12

+··· .

(31)

fk = fk - ~bk+1(Ak+1)-1, k = k - (Ak)-1, k  1, kf = ~bkd-k 1 - ~bk+1(Ak+1)-1(a~kd-k 1 + ~bk(Ak)-1), k  2, k = ~b-k 1d~-k+11 - (Ak)-1(a~k~b-k 1d~-k+11 + (Ak+1)-1), k  1.

Suppose that condition (B1) holds. Then applying Lemma 1, we have

fk  b-1, k  -1 and hence fk  0, k  0 as k  .

The following lemma, which can be proved by some arguments similar to the proofs of [17, Lemma 4] and [18, Lemma 12], studies the fluctuations of both fk and k, k  1.
Lemma 7. Suppose that condition (B1) and one of the conditions (B2)a, (B2)b and (B2)c hold. Then there exists some number q with |q|  1 such that

lim
k

kf+1/kf

=

lim
k

k+1/k

=

q,

lim
k

k+1 k

= q,

lim
k

fk+1 fk

=q

or

a

- 2

bd

.

10

WANG

3.3 Proof of Theorem 2.

For

mk

 1 we write

xk,m

:=

e1 Ak ···Am et1 (Ak )···(Am )

for

simplicity.

In

view

of

(22)

and (23),

to prove (11), it suffices to show that xk,m  c(k) as m   for some 0 < c(k) < .

To begin with, we show first that for fixed j  1, xj,m, m  j are uniformly

bounded away from 0 and infinity. Indeed, using again the notation Am,n = Am · · · An,

in view of (20) and (21), for m  n  j  1,

xj,m

=

e1Aj · · · Amet1 (Aj) · · · (Am)

=

Aj,n(11)

n i=j

(Ai)

An+1,m(11)

m i=n+1

(Ai)

+

Aj,n(12) An+1,m(21)

n i=j

(Ai)

m i=n+1

(Ai)

=

Aj,n(11) An+1,m(11)

n i=j

(Ai)

m i=n+1

(Ai)

1

+

Aj,n(12) Aj,n(11)

An+1,m(21) An+1,m(11)

= xj,nxn+1,m(1 + hn,j n+1,m).

Let i, i  1 be those in Lemma 5. Then by (22)-(24) we get

lim (1
m

+

hn,j n+1,m)

=

1

+

hn,j n+1,

lim (1
n

+

hn,j n+1)

=

1-

1 



(0, 2).

Thus, we can find a number N > N0 such that 0 < c < 1 + hn,jn+1 < 2 - c, n  N, where N0 is the one in Lemma 2.
Now fix k > N. There is a number N5 > k such that for m > N5,
C-1 < 1/2(1 + hk,jk+1) < 1 + hk,jk+1,m < 2(1 + hk,jk+1) < C.

Then

(32)

C-1xj,kxk+1,m < xj,m < Cxj,kxk+1,m, m > N5, j  1.

But by Lemma 2, we have Ck-+11 < xk+1,m < Ck+1, m  k+1, with Ck+1 > 0 certain constant. Let k+1 = max{xk+1,m, k + 1  m  N5} and set Cj,k = (Cxj,k(k+1  Ck+1))  maxjmN5 xj,m, where C is the constant in (32). Then we have

(33)

Cj-,k1 < xj,m < Cj,k, m  j  1.

With (33) and Lemma 7 in hands, the rest of the proof of Theorem 2 is more or less similar to the one of Theorem 1 in [17], but there are some differences in details. For convenience of the reader, we provide a complete proof here.
Next, we prove only x1,m  c as m   for some 0 < c < , since for k  2 the convergence of xk,m as m   can be proved similarly. For simplicity, we write x1,m as xm and taking (33) into account, we keep always in mind that

(34)

xm

=

e1A1 · · · Amet1 (A1) · · · (Am)

and

m



1, c3



xm



c4,

where 0 < c3  c4 <  are proper constants.

For

n



1,

writing

fn

=

e1 e1

A1 A1

···An ···An

et2 et1

,

then

(35)

fn

=

~bne1A1 · · · An-1et1 e1A1 · · · An-1(a~net1 + d~net2)

=

a~n

+

~bn d~n

fn-1

.

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

11

Iterating (35), we find that fn, n  1 coincide with the ones defined in (30). Therefore, letting fn, n  1 be the ones in (31), an application of Lemma 7 yields that for some number q with |q|  1,

(36)

lim
m

fm+1 fm

=

q

or

a

- 2

bd

.

It

is

easy

to

check

that

0

<

|a-bd| 2

<

1

since

a

-

bd

=

0.

Case

1:

Suppose

|q|

<

1.

Then

0

:=

max{|q|,

|a-bd| 2

}

<

1.

Fix

0

<



<

0.

By

(36), there exists some m0 > 0 such that

fm+1 fm

  for all m > m0. Hence

(37)





|fm| =

|fm - ~bm+1(Am+1)-1| < .

m=2

m=2

Taking (18) into account, for m  1 we have

(38)

xm+1

-

xm

=

a~m+1

-

(Am+1)

+

d~m+1

e1 A1 ···Am et2 e1 A1 ···Am et1

(A1 )···(Am+1 )

e1 A1 ···Am et1

= (Am+1)-1xm(a~m+1 - (Am+1) + d~m+1fm)

= (Am+1)-1xmd~m+1(fm - ~bm+1(Am+1)-1)

= (Am+1)-1xmd~m+1fm.

Since (Am), m  1 are uniformly bounded away from 0 and , then by (34), we have for some constant 0 < c5 < ,

(39)

|xm+1 - xm|  c5|fm|, m  1.

Taking (34), (37) and (39) together, we conclude that for some constant 0 < c < ,

limm xm = c.

Case

2:

Suppose

q

=1

and

limm

fm+1 fm

=

a-bd 2

.

Since

|a-bd| 2

<

1,

the

proof

goes exactly the same as Case 1.

Case

3:

Suppose

q

=1

and

limm

fm+1 fm

= q.

Then

there

exists

some

number

m1 > 0 such that fm = fm - ~bm+1(Am+1)-1, m  m1 are all strictly positive or

strictly negative, and consequently

(40)

a~m+1 + d~m+1fm a~m+1 + d~m+1~bm+1(Am+1)-1

<

1(or

> 1),

for all m  m1.

But

(41)

xm+1 xm

=

1 (Am+1 )

=

1 (Am+1 )

a~m+1

+

d~m+1

e1A1 e1A1

· ·

· ·

· ·

Amet2 Amet1

a~m+1 + d~m+1fm

=

a~m+1

a~m+1 + d~m+1fm + d~m+1~bm+1(Am+1)-1

.

Thus, by (40),

xm+1 xm

<

1(or

> 1) for all m  m1, that is, xm, m  m1 is monotone

in m. As a consequence, it follows from (34) that for some constant 0 < c < 

limm xm = c.

12

WANG

Case 4.

Suppose

that

q

=

-1

and

limm

fm+1 fm

=

a-bd 2

.

In this case, the proof

is the same as Case 2.

Case 5.

Suppose

that

q

=

-1

and

limm

fm+1 fm

= -1. Combining (38) with

(41), we have

xm+1 - xm xm - xm-1

=

(Am)

a~m + d~mfm-1 d~m+1

(Am+1) a~m + d~m~bm(Am)-1 d~m

fm fm-1



-1,

as m  . So there exists some number m2 > 0 such that

xm+1 - xm xm - xm-1

<

0

for all m > m2.

Since fm = fm-~bm+1(Am+1)-1  0 as m  , then by (38), we have xm+1-xm  0 as m  . We thus come to the conclusion that xm+1 - xm converges to 0 in an alternating manner as m  . Therefore,



c

:=

lim
m

xm

=

x1

+

(xm+1 - xm)

m=1

exists and by (34), we must have 0 < c < . Theorem 2 is proved.

4 Product of matrices and continued fractions

Based on Theorem 2, the purpose of this section is to finish the proof of Theorem 3. Our method is some delicate analysis on continued fractions and their approximants.

4.1 Product of matrices expressed in terms of the approximants of continued fractions

Our approach to prove (12) is to express e1Ak · · · Anet1 in terms of the approximants of some continued fractions. For 1  k  n, set

(42)

yk,n

:=

e1Ak · · · Anet1

and

k,n

:=

yk+1,n yk,n

.

Noting that the empty product equals identity, thus yn+1,n = 1. Therefore,

(43) (44)

k-,1n · · · n-,1n = yk,n = e1Ak · · · Anet1,

n+1

n+1

e1Ak · · · Anet1 =

k-,1n · · · n-,1n =

k=1

k=1

n+1 k=1

1,n

1,n · ·

· ·

· · k-1,n n,n

.

Lemma 8. For 1  k  n, k,n defined in (42) coincides with the one in (13) with k = ~b-k 1d~-k+11 and k = a~k~b-k 1d~-k+11.

Proof.

Clearly,

n,n

=

1 yn,n

=

1 a~n

=

. ~b-n 1d~-n+1 1
a~n~b-n 1d~-n+1 1

For

1k

< n,

note

that

(45)

k,n

=

yk+1,n yk,n

=

e1Ak+1 · · · Anet1 e1Ak · · · Anet1

=

e1Ak+1 · · · Anet1 (a~ke1 + ~bke2)Ak+1 · · · Anet1

=

a~k

1

+

~bk

e2 Ak+1 ···An et1 e1 Ak+1 ···An et1

=

a~k

1

+

~bk

d~k+1

e1 e1

Ak+2···An Ak+1···An

et1 et1

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

13

=

~b-k 1d~-k+11 a~k~b-k 1d~-k+11 + k+1,n

.

Thus, the lemma can be proved by iterating (45).

In the remainder of this section, we always assume that all conditions of Theorem 3 hold and k, k,n, n  k  1 are those defined in (13) and (14) with k = ~b-k 1d~-k+11 and k = a~k~b-k 1d~-k+11. Then we have

lim
k

k

=:



= (bd - a)-1

=

0

and

lim
k

k

=: 

=

a+ bd - a

=

0.

Consequently, it follows from Lemma 1 that

(46)

lim
n

k,n

=

k,

lim
k

k

=:



=

 2

1 + 4/2 - 1 = -1 > 0.

Moreover, by (15) and (42) we have

(47)

k > 0, k,n > 0, n  k  1.

In view of (43) and (44), the following proposition is crucial to prove Theorem 3.

Proposition 1. As n  , we have

(48) (49)
(50)

1,n · · · n,n  c(A1)-1 · · · (An)-1,

1,n · · · n,n  c1 · · · n,

n+1

n+1

1,n · · · k-1,n  c 1 · · · k-1.

k=1

k=1

Proof. To begin with, taking (15) and (43) into consideration, applying Theorem 2, we obtain (48). Since bd = a and limk d~k = b-1(bd - a) = 0, there exist k0 > 0 and  > 0 such that

(51)

either d~k  -, k  k0 or d~k  , k  k0.

In view of (46) and (47), if we can show that for some k0 > 0, k0,n · · · n,n 

ck0 · · · n and

n+1 k=k0

k0,n

·

·

·

k-1,n



c

n+1 k=k0

k0

·

·

·

k-1

as

n



,

then

(49)

and

(50) are also true. Therefore, instead of (51), we assume  > 0 such that either

d~k  -, k  1 or d~k  , k  1. If d~k  , k  1, then Proposition 1 has been

proved in [18], see Lemma 10 therein. Thus we need only to deal with the case

(52)

 > 0 such that d~k  -, k  1.

To prove (49) and (50), we need the following two lemmas, whose proof will be postponed to the end of this subsection.

Lemma 9. Suppose that (52) holds and fix k  1. Then k,n, n  k is monotone increasing in n and thus k,n < k, n  k.

Lemma 10. Suppose that (52) holds. Then 0 < r < 1 and k1 > 0 such that

k,n -k k+1,n -k+1



r, n

>

k

>

k1,

and

consequently

k - k,n  rn-k(n - n,n), n  k > k1.

14

WANG

With Lemma 9 and Lemma 10 in hands, we show next that

(53)

c

>

0

such

that

c

<

1,n · · · n,n 1 · · · n

<

1, n



1.

Indeed, applying Lemma 9, we get

(54)

1,n2,n · · · n,n < 12 · · · n, n  1.

For a lower bound, notice that k,n > 0, n  k > 1 and n,n = a~-n 1  (a + )-1 as n  . Then by (46), (47) and Lemma 9, we have

(55)

c-1 < n < c and c-1 < n - n,n < c, n  1,

for some number c > 0. Therefore, letting r be the one in Lemma 10, there is a number k2 > 0 such that

1-

(n - n,n)rk2 infk1 k

> 0, n

 1.

With k1 the number in Lemma 10, applying Lemma 10, we have for n large enough,

k1+1,n · · · n,n k1+1 · · · n

=

(k1+1,n - k1+1) k1+2,n · · · n,n

k1+1

k1+2 · · · n

+

k1+2,n · · · n,n k1+2 · · · n

 1 - (n - n,n)rn-k1-1 k1+2,n · · · n,n ,

k1+1

k1+2 · · · n

which

implies

limn

k1 +1,n ···n,n k1+1···n



limn

. k1 +2,n ···n,n
k1+2···n

Using

the

same

tricky

times and again, we get

lim
n

k1+1,n · · · n,n k1+1 · · · n

>

lim
n

n-k2,n n-k2

· ·

· ·

· ·

n,n n

.

Consequently,

since

limn k,n

=

k

and

limn

n-k2 ,n ···n,n n-k2 ···n

=

c

for

some

number

c > 0, we have

(56)

lim
n

1,n · · · n,n 1 · · · n

=

lim
n

k1+1,n · · · n,n k1+1 · · · n



lim
n

n-k2,n · · · n,n n-k2 · · · n

=

c

>

0.

Taking (54) and (56) together, we finish the proof of (53). Now, we are ready to prove (49). In view of (48), it suffices to show

(57)

1 · · · n  (A1)-1 · · · (An)-1, as n  .

To

this

end,

write

xn

=

(A1

1 )-1

···n ···(An

)-1

,

n



1.

Then

taking

(48)

and

(53)

together,

we get

(58)

C-1 < xn < C, n  1.

With (58) in hand, using Lemma 7 and mimicking the proof of the convergence of xk in the proof of Theorem 2, we can show that limn xn = c for some number c > 0. Consequently, (57) is proved and so is (49).
Finally, we turn to prove (50). For the case  < 1, the proof is the same as the one in [18, Lemma 10]. Thus we need only to prove the case   1. Suppose now   1. In

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

15

order to prove (50), it suffices to show limn is equivalent to

n k=1

1,n

··nk·=k1,n-1···nkk=1

1

···k

= 0 which

(59)

lim
n

n-k1 j=1
n-k1 j=1

k1+j k=k1+1

k,n

k1+j k=k1+1

k

=

1

since limk k,n = k > 0, where k1 is the number in Lemma 10. To prove (59), on one hand, note that by Lemma 9 we have k,n < k, n  k  1 which implies

(60)

n-k1 k1+j

n-k1 k1+j

k,n <

k, n  k1.

j=1 k=k1+1

j=1 k=k1+1

On the other hand, taking the lemmas 9 and 10 into account, we have for n  k1

n-k1 k1+j

n-k1 k1+j

n-k1 k1+j

k,n = k1+1

k,n + (k1+1,n - k1+1)

k,n

j=1 k=k1+1

j=1 k=k1+2

j=1 k=k1+2

n-k1 k1+j

n-k1 k1+j

 k1+1 + k1+1

k,n + (n,n - n)rn-(k1+1)

k.

j=2 k=k1+2

j=2 k=k1+1

Iterating the above inequality, we get

(61)

n-k1 k1+j

n-k1 k1+j

k,n >

k

j=1 k=k1+1

j=1 k=k1+1

n-(k1+1)  k1+i 

n-k1

+ (n,n - n)



k rn-(k1+i+1)

k1 +j
k

i=0

k=k1+1

j=i+1 k=k1+i+2

=: (I) + (II).

It follows from (55) that the absolute value of the second term (II) equals to

(62)

(n

-

n-(k1 +1)
n,n)
i=0

rn-(k1+i+1) k1+i+1





k1+i+1

n-k1

k1 +j



k

k=k1+1

j=i+1 k=k1+i+2

k

n-(k1 +1)





k1+i+1

n-k1

c

rn-(k1+i+1) 

k

k1 +j
k.

i=0

k=k1+1

j=i+1 k=k1+i+2

Clearly, for any 0  i  n - (k1 + 1),

(63)

k1 +i+1 k=k1+1

k

n-k1 j=1

n-k1 j=i+1

k1+j k=k1+i+2

k

k1 +j k=k1

+1

k

1

and an application of [18, Lemma 8] yields that

(64)

lim
n

n-i k=k1+1

k

n-k1 j=1

k1+j k=k1+1

k

= 0, i  1,

since k > 0, k  1 and limk k = -1  1.

16

WANG

Let  > 0 be an arbitrary number and fix k3 such that rk3 < . Then using (63) and (64), we have from (62) that

lim
n

|(II)|

n-k1 j=1

k1 +j k=k1+1

k

n-(k1+1)-k3

 c lim

rn-(k1+i+1)

n

i=0

n-(k1+1)

+ c lim

rn-(k1+i+1)

n

i=n-k1-k3

k1+i+1 k=k1+1

k

n-k1 j=1

n-k1 j=i+1

k1+j k=k1+i+2

k

k1+j k=k1+1

k

n-(k1 +1)-k3

= c lim

rn-(k1+i+1) = crk3 /(1 - r)

n

i=0

 c/(1 - r).

Since  > 0 is arbitrary, limn implies that

|(II)|

n-k1 j=1

k1+j k=k1

+1

k

= 0, which together with (61)

(65)

lim
n

n-k1 j=1
n-k1 j=1

k1+j k=k1+1

k,n

k1+j k=k1+1

k

=

1.

Putting (60) and (65) together, we can infer that (59) is true and thus Proposition 1 is proved.

To end this subsection, we give the proof of Lemma 9 and Lemma 10.
Proof of Lemma 9. We see from (15) and (42) that k,n > 0 for all n  k  1. Since k  1, a~k > 0, ~bk > 0 and d~k < - < 0 for some  > 0, we always have k < 0, k < 0, k  1. Now fix k  1 and for n  k, write

(66)

Ck,n = nCk,n-1 + nCk,n-2, Dk,n = nDk,n-1 + nDk,n-2

with initial values

(67)

Ck-2 = Dk-1 = 1, Ck-1 = Dk-2 = 0.

Then by Euler-Minding formula (see [14], (1.2.14) on page 7) we obtain

k,n

=

Ck,n Dk,n

=

n
-
j=k

j i=k

(-i

)

Dk,j Dk,j-1

which leads to (68)

k,n+1

-

k,n

=

-

ni=+k1(-j ) Dk,n+1Dk,n

,

n



k.

By induction, we have from (66) and (67) that

Dk,n Dk,n-1 Ck,n Ck,n-1

=

k 1 k 0

···

=

n

-1

~bid~i+1

a~k ~bkd~k+1 10

i=k

n 1 n 0

···

a~n ~bnd~n+1 10

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

17

=

n

-1

~bid~i+1

i=k

10 0 d~-k 1

Ak · · · An

10 0 d~n+1

where for the third equality we use the facts

a~i ~bid~i+1 10

=

a~i ~bi 10

Ai =

a~i ~bi d~i 0

=

10 0 d~i

10 0 d~i+1
a~i ~bi 10

, , i  1.

As a consequence, taking (15) and (16) into account we get

(69)

Dk,n-1 Dk,n

=

d~n+1

e1Ak e1Ak

· ·

· ·

· ·

Ane2 Ane1

<

0, n



k.

Putting (68) and (69) together, we conclude that

k,n+1 - k,n > 0, n  k  1,

that is to say, k,n, n  k is monotone increasing in n. Lemma 9 is proved.

Proof of Lemma 10. Taking Lemma 9 into account, since k,n > 0, n  k  1, then by some easy computation, we have from (13) and (14) that

0

<

k,n - k k+1,n - k+1

=

-

k

k,n + k+1

<

- k

k + k+1

.



But

- k
k +k+1



-

 +

=

+2+4
- 2+4

<

1

as

k



.

As

a

result,

for

some

proper

number

0

<

r

<

1,

k1

>

0

such

that

- k
k +k+1

<

r, k

>

k1,

which

finishes

the

proof of the lemma.

4.2 Proof of Theorem 3

Theorem 3 is a direct consequence of Proposition 1. In fact, it follows from (44) and Proposition 1 that

n+1
e1Ak · · · Anet1 =
k=1

n+1 k=1

1,n

·

·

·

k-1,n

1,n · · · n,n



c

n+1 k=1

1

(A1)-1 · ·

· ·

· · k-1 (An)-1

,

as n  .

But by (48) and (49), we obtain

1 · · · n  c(A1)-1 · · · (An)-1, as n  

which implies that

n+1

n+1

1 · · · k-1  c (A1)-1 · · · (Ak-1)-1, as n  .

k=1

k=1

As a result, we have

n+1
e1Ak · · · Anet1  c
k=1

n+1 k=1

(A1)-1

·

·

·

(Ak-1)-1

(A1)-1 · · · (An)-1

=

n+1
c (Ak) · · · (An)
k=1

as n  . Thus Theorem 3 is proved.

18

WANG

5 Proof of Theorem 1

For n  0 and s = (s1, s2)t  [0, 1]2, let

Fn(i)(s)  E(sZn |Z0 = ei) := E(sZ1 n,1 sZ2 n,2 |Z0 = ei), i = 1, 2

and set Fn(s) = (Fn(1)(s), Fn(2)(s))t. It follows by induction (see Dyakonova [5, Lemma 1]) that for n  0,

Fn(s) = f1(f2(· · · fn(s) · · · )) = 1 - 1 +

n k=1

Mk

(1

-

s)

n k=1

k

n i=k+1

Mi(1

-

s)

which leads to

Fn(0) = 1 - 1 +

n

k=1

n k=1

k

Mk 1
n i=k+1

Mi1

.

For the asymptotics of P ( > n|Z0 = e1) and P ( = n|Z0 = e1), we refer the reader to [18]. Here we treat only P ( > n|Z0 = e2) and P ( = n|Z0 = e2). Taking (3) intro account, for n  1 we have

(70)

P ( > n|Z0 = e2) = 1 - Fn(2)(0) =

e2
n+1 k=1

n k=1
e1

Mk 1

n i=k

Mi1

,

and consequently

(71)

P ( = n|Z0 = e2) =

e2
n k=1

n-1 k=1

Mk 1

e1

n-1 i=k

Mi1

-

e2
n+1 k=1

n k=1
e1

Mk 1

n i=k

Mi

1

.

With matrices Ai, i  1 the ones defined in (4), using (5), by some very careful computation, we have from (70) and (71) that

(72) (73)

P (

>

n|Z0

=

e2)

=

(1/b1, 1)

n+1 k=1

e1

n k=1 n i=k

Ak(1, n+1)t Ai(1, n+1)t

,

P ( = n|Z0 = e2) =

1

n+1 k=1

e1

n i=k

Ai(1,

n+1

)t

e1

n-1 k=1

Ak

et1

n k=1

e1

n-1 i=k

Ai

(1,

n )t

×

1 b1

Gn-1,1

+

e2 e1

n-1 k=1 n-1 k=1

Ak et1 Ak et1

Gn-1,2

where

for

n



1,

n



1

-

n bn

,

(74)

Gn-1,1  e1 - e1

n-1 k=1

Ak

(1,

n

)t

n+1 k=1

e1

n i=k

Ai(1,

n+1 )t

e1

n-1 k=1

Ak

et1

n k=1

Ak

(1,

n+1

)t

n k=1

e1

n-1 i=k

Ai

(1,

n

)t

e1

n-1 k=1

Ak

et1

and

(75)

Gn-1,2  e2 - e2

n-1 k=1

Ak

(1,

n

)t

n+1 k=1

e1

n i=k

Ai(1,

n+1 )t

e1

n-1 k=1

Ak

et1

n k=1

Ak

(1,

n+1)t

n k=1

e1

e1

n-1 k=1

Aket1

n-1 i=k

Ai(1,

n

)t

.

Gn,1 and Gn,2 defined in (74) and (75) look very complicated. Next lemma shows that they converge to the same limit.

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

19

Lemma 11. Suppose that condition (B1) holds and |1| < 1. Then, there exists a number G  0 such that

(76)

lim
n

Gn,2

=

G

=

lim
n

Gn,1.

Moreover,

G

=

0

if

and

only

if

1

=

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd-a -b

.

Proof. The proof of the second equality in (76) can be found in [18], so we check here only the first one. To this end, set

fn



e2 e2

n k=1

Ak

et2

n k=1

Ak

et1

and

Hn



n

n

e1 Ai(fnet1 - et2), n  1.

k=1 i=k

Clearly, we have f1 = 0, H1 = -~b1 = -b1 and by some subtle computation,

(77)

Gn-1,2 = 1 + (~bnnn+1 + a~nn - d~n)Hn-1 + (~bnnn+1 + a~nn - d~n + n)fn-1.

Note that

(78)

fn

=

e2A1 · · · Anet2 e2A1 · · · Anet1

=

~bne2A1 · · · An-1et1 e2A1 · · · An-1(a~net1 + d~net2)

=

a~n

+

~bn d~nfn-1

,

which leads to

d~nfnfn-1 = ~bn - a~nfn, n  2.

Consequently, for n  2,

(79)

n

n

Hn = e1 Ai(fnet1 - et2)

k=1 i=k

n-1 n-1
= a~nfn - ~bn + e1 Ai((a~nfn - ~bn)et1 + d~nfnet2)

k=1 i=k

n-1 n-1
= -d~nfnfn-1 - d~nfn e1 Ai(fn-1et1 - et2)

k=1 i=k

= -d~nfnfn-1 - d~nfnHn-1.

Since f1 = 0 and H1 = -b1, iterating (79), we get

(80)

n-1
Hn = (-1)nb1d~2f2 · · · d~nfn + (-1)n-kfkd~k+1fk+1 · · · d~nfn, n  2
k=1

and iterating (78), we get

fn

=

~bnd~-n 1 a~nd~-n 1

+

~bn-1d~-n-1 1 a~n-1d~-n-1 1

+···+

~b2d~-2 1 a~2d~-2 1

,

n



2.

Noticing that limn ~bnd~-n 1 = b2(bd - a)-1 = 0 and limn a~nd~n-1 = b(a + )(bd - a)-1, thus applying Lemma 1, we get

(81)

lim
n

fn

=

-

b1 bd - a

20

WANG

and thus limn d~nfn = -1. Since |1| < 1, we conclude from (80) that

(82)

lim
n

Hn

=

- (bd

-

b21 a)(1

-

1) .

Letting n   in (77), owing to (81) and (82), we get

lim
n

Gn-1,2

=

G

:=

(b

-

)21

-

(b - )(a + b + 1)1 (bd - a)(1 - 1)

+

bd

- a .

Consequently, the first equality in (76) is true. Moreover, since |1| < 1, then by the definition of G, it is easy to see that

G

=

0

if

and

only

if

1

=

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd 

- -

a b

.

What's left for us to do is to check the nonnegativity of the number G. For this purpose, applying (76) and taking (15)-(17) and Theorem 2 into account, we have

(83)

lim
n

1 b1

Gn-1,1

+

e2 e1

n-1 k=1 n-1 k=1

Ak Ak

et1 et1

Gn-1,2

= G lim
n

1 b1

+

e2 e1

n-1 k=1

Ak

et1

n-1 k=1

Ak

et1

= GL

exists, where using again (15)-(17) and Theorem 2, we see that

L : = lim
n

1 b1

+

e2 e1

n-1 k=1

Ak

et1

n-1 k=1

Ak

et1

= lim e2 n e1

n-1 k=1

Mk

(1,

n

/bn)t

n-1 k=1

Mk

(1,

n

/bn)t

= lim e2
n

n-1 k=1

Mk

(1,

n/bn)t

e1

n-1 k=1

Ak

et1



lim
n

d1dn-1e1

n-2 k=2

Mk

et2

e1

n-1 k=1

Ak

et1

=

lim
n

d1dn-1e1

n-2 k=2

Ak et2

e1

n-1 k=1

Ak

et1

> 0.

But e1

in view of (73),

n-1 k=1

Ak

et1

=

e1

skni=-n11ceMk(nk1=, 1ke+11/bink=-+k11)At i>(1,0, nw)te

=

n k=1

e1

must have

n-1 i=k

Mi1

>

0

and

GL  0 and conse-

quently, G  0. The lemma is proved.

Next we continue with the proof of Theorem 1. For n  1, write

Sn :=

n+1 k=1

(A1

)-1

(A1)-1 · ·

· ·

· · (Ak-1)-1 (An)-1

.

We need in addition the following lemma.

Lemma 12. Under the conditions of Theorem 1, we have

n

(84)

e1 Anet1  c(A1) · · · (An),

i=1

n

(85)

e1 Anet2  c(A1) · · · (An),

i=1

BRANCHING PROCESSES IN VARYING ENVIRONMENTS

21

n

(86)

(1/b1, 1) Ak(1, n+1)t  c(A1) · · · (An),

k=1

as n   and for some number 0 < 1, 2 < ,

(87)

lim
n

n+1 k=1

e1

n i=k

Ai(1,

n+1

)t

Sn

= 1

and

lim
n

Sn-1 Sn

= 2.

Proof. Applying Theorem 2, since e1

n i=1

Aneti

>

0,

i



{1,

2}

by

(15)

and

(16),

we

get (84) and (85). Also, we infer from Theorem 2 that

lim
n

(1/b1, 1)

n k=1

(A1) · · ·

Ak(1, n+1)t (An)

exists. But using (85), we have

lim
n

(1/b1

, 1)

n k=1

(A1) · · ·

Ak(1, n+1)t (An)

=

lim
n

e2

n k=1

(A1) ·

Mk(1, 1)t · · (An)



lim
n

d1e1 (A1)

n k=2

Mk

et2

· · · (An)

=

lim
n

d1e1 (A1)

n k=2

Ak

et2

· · · (An)

>

0.

So (86) is proved true. Finally, with Theorem 3 in hand, the proof of (87) is similar to the one of [18, Lemma 4] and we will not repeat it here.

Now we are ready to finish the proof of Theorem 1. Note that from (73) and the lemmas 3 and 12, we have

P (

=

n|Z0

=

e2)



c

(A1)

··· Sn2

(An)

Sn Sn-1

1 b1

Gn-1,1

+

e2 e1

n-1 k=1 n-1 k=1

Ak Ak

et1 et1

Gn-1,2

c

(M1)-1 · · · (Mn)-1

n+1 k=1

(M1

)-1

·

·

·

(Mk-1)-1

2

1 b1

Gn-1,1

+

e2 e1

n-1 k=1 n-1 k=1

Ak Ak

et1 et1

Gn-1,2

.

Then it follows from (83) that

lim
n

P (

=

n|Z0

=

e2)

n+1 k=1

(M1

)-1

·

·

(M1)-1 · · · (Mn)-1

·

(Mk-1)-1

2
= GL  0,

where L > 0 is a proper constant. But by Lemma 11, G > 0 if and only if 1 =

1 2

a+b+1-

(a

+

b

+

1)2

+

4

bd-a -b

. We thus conclude that (9) and (10) hold.

Finally, we turn to prove (8). Note that by (72), (86) and (87), we obtain

P (

>

n|Z0

=

e2)



c (A1)

· · · (An) Sn

=

n+1 k=1

c (A1)-1

·

·

·

(Ak-1)-1

,

as n  . As a result, applying Lemma 3, we get (8). Theorem 1 is proved.

Acknowledgements: This project is partially supported by National Natu-
ral Science Foundation of China (Grant No. 12071003).

22

WANG

References
[1] Bhattacharya, N. and Perlman, M. (2017). Time inhomogeneous branching processes conditioned on non-extinction. arXiv: 1703.00337.
[2] Biggins, J. D., Cohn, H. and Nerman, O. (1999). Multi-type branching in varying environment. Stochastic Process. Appl. 83, 357-400.
[3] Cohn, H. and Wang, Q. (2003). Multitype branching limit behavior. Ann. Appl. Probab. 13, 490-500.
[4] Dolgopyat, D., Hebbar, P., Koralov, L. and Perlman, M. (2018). Multi-type branching processes with time-dependent branching rates. J. Appl. Probab. 55, 701-727.
[5] Dyakonova, E. E. (1999). Asymptotic behaviour of the probability of nonextinction for a multi-type branching process in a random environment. Discrete Math. Appl. 9, 119-136.
[6] Fujimagari, T. (1980). On the extinction time distribution of a branching process in varying environments. Adv. in Appl. Probab. 12, 350-366.
[7] Jagers, P. (1974). Galton-Watson processes in varying environment. J. Appl. Probab. 11, 174-178.
[8] Johnson, C. R. and Bru, R. (1990). The spectral radius of a product of nonnegative matrices. Linear Algebra Appl. 141, 227-240.
[9] Jones, O. D. (1997). On the convergence of multitype branching processes with varying environments. Ann. Appl. Probab. 7, 772-801.
[10] Kersting, G. (2020). A unifying approach to branching processes in a varying environment. J. Appl. Probab. 57, 196-220.
[11] Kersting, G. and Vatutin, V. (2017). Discrete time branching processes in random environment. John Wiley & Sons, Inc., USA.
[12] Lindvall, T. (1974). Almost sure convergence of branching processes in varying and random environments. Ann. Probab. 2, 344-346.
[13] Lorentzen, L. (1995). Computation of limit periodic continued fractions. A survey. Numer. Algorithms 10, 69-111.
[14] Lorentzen, L. and Waadeland, H. (2008). Continued fractions. 2nd. Ed., Volume 1: convergence theory. Atlantis Press, Paris.
[15] Macphee, I. M. and Schuh, H. J. (1983). A Galton-Watson branching process in varying environments with essentially constant means and two rates of growth. Aust. N. Z. J. Stat. 25, 329-338.
[16] Sun, H. Y. and Wang, H. M. (2020). On a maximum of nearest-neighbor random walk with asymptotically zero drift on lattice of positive half line. arXiv: 2004.12422.
[17] Sun, H. Y. and Wang, H. M. (2020). Asymptotics of product of nonnegative 2-by-2 matrices with applications to random walks with asymptotically zero drifts. arXiv: 2004.13440.
[18] Wang, H. M. and Yao, H. (2021). Two-type linear fractional branching processes in varying environments with asymptotically constant mean matrices. arXiv: 2007.07840.

