arXiv:2106.00575v1 [math.PR] 1 Jun 2021

Branching Brownian motion in an expanding ball and application to the mild obstacle problem
Mehmet O¨ z
Department of Natural and Mathematical Sciences, Faculty of Engineering, O¨zyegin University, Istanbul, Turkey
Abstract We first consider a d-dimensional branching Brownian motion (BBM) evolving in an expanding ball, where the particles are killed at the boundary of the ball, and the expansion is subdiffusive in time. We study the large-time asymptotic behavior of the mass inside the ball, and obtain a large-deviation (LD) result as time tends to infinity on the probability that the mass is aytpically small. Then, we consider the problem of BBM among mild Poissonian obstacles, where a random `trap field' in Rd is created via a Poisson point process. The trap field consists of balls of fixed radius centered at the atoms of the Poisson point process. The mild obstacle rule is that when a particle is inside a trap, it branches at a lower rate, which is allowed to be zero, whereas when outside the trap field it branches at the normal rate. As an application of our LD result on the mass of BBM inside expanding balls, we prove upper bounds on the LD probabilities for the mass of BBM among mild obstacles, which we then use along with the Borel-Cantelli lemma to prove the corresponding strong law of large numbers. Our results are quenched, that is, they hold in almost every environment with respect to the Poisson point process. Keywords: Branching Brownian motion, killing boundary, large deviations, strong law of large numbers, Poissonian traps, mild obstacles, random environment
2010 MSC: 60J80, 60K37, 60F15, 60F10
1. Introduction
In this work, we first study a branching Brownian motion (BBM) in an expanding ball of fixed center, where the radius of the ball is increasing subdiffusively in time. We suppose that the boundary of the ball is killing in the sense that once a particle of the BBM hits the boundary, it is instantly killed. On this model, in Theorem 1, we obtain a large-deviation result, giving the large-time asymptotic behavior of the probability that the number of particles, i.e., the mass, of the BBM is atypically small in the expanding ball.
Then, we consider the model of BBM among mild Poissonian obstacles. We study the growth of mass of a BBM evolving in a random environment in Rd, which is composed of randomly located spherical traps of fixed radius with centers given by a Poisson point process (PPP). The mild obstacle rule is that when a particle is inside the traps, it branches at a lower rate, which is allowed to be zero, than usual, that is, when it is not in a trap. The mild obstacle problem for BBM was proposed by Engl¨ander in [6], and on a set of full measure with respect to the PPP, a kind
Email address: mehmet.oz@ozyegin.edu.tr (Mehmet O¨ z) URL: https://faculty.ozyegin.edu.tr/mehmetoz/ (Mehmet O¨ z)
1

BBM in expanding ball and among mild obstacles

2

of weak law of large numbers (WLLN) was obtained (see [6, Thm. 1]) for the mass of the process as well as a result on its spatial spread (see [6, Thm. 2]). In Theorem 2, by estimating successive large-deviation probabilities, we improve the WLLN in [6] to the strong law of large numbers (SLLN). We also include the possibility of no branching inside the traps, which was not covered in [6]. An essential ingredient in the proof of Theorem 2 turns out be Theorem 1, that is, the lower tail asymptotics for the mass of BBM in expanding balls. In the mild obstacle problem, a suitable time-dependent clearing (see Definiton 1) in the random environment in Rd serves as the expanding ball of Theorem 1.
1.1. Formulation of the problems
We now describe the two sources of randomness in the models, and formulate the problems in a precise way.
1. Branching Brownian motion in an expanding ball: Let Z = (Zt)t0 be a strictly dyadic d-dimensional BBM with branching rate  > 0, where t represents time. Strictly dyadic means that every time a particle branches it gives precisely two offspring. The process can be described as follows. It starts with a single particle, which performs a Brownian motion (BM) in Rd for a random lifetime, at the end of which it dies and simultaneously gives birth to two offspring. Similarly, starting from the position where their parent dies, each offspring particle repeats the same procedure as their parent independently of others and the parent, and the process evolves through time in this way. All particle lifetimes are exponentially distributed with constant parameter  > 0. For each t  0, Zt can be viewed as a finite discrete measure on Rd, which is supported at the positions of the particles at time t. For t  0, we use |Zt| to denote the total mass of Z at time t, and occasionally use Nt := |Zt|. Also, for a Borel set A  Rd and t  0, we write Zt(A) to denote the mass of Z that fall inside A at time t.
We also define a BBM with killing at a boundary. For a Borel set A  Rd, denote by A the boundary of A. Consider a family of Borel sets B = (Bt)t0, which we may view as a single timedependent Borel set. Let ZB = (ZtBt)t0 be the BBM with killing at B, that is, a standard BBM with particles killed instantly upon hitting the boundary of B. The process ZB can be obtained from Z as follows. For each t  0, start with Zt, and delete from it any particle whose ancestral line up to t has exited Bt to obtain ZtBt. This means, ZtBt consists of particles of Zt whose ancestral lines up to t have been confined to Bt over the time period [0, t], and therefore it can be viewed as a finite discrete measure in Bt.
We denote by  the sample space for the BBM, and use Px and Ex, respectively, to denote the law and corresponding expectation of a BBM starting with a single particle at x  Rd. By an abuse of notation, we use Px and Ex also for the BBM with killing at a boundary. For simplicity, we set P = P0. Also, we sometimes use
nt := |ZtBt |
to denote the mass at time t of a BBM with killing at B. Consider a radius function r : R+  R+ with limt r(t) = , which is subdiffusively increas-
ing, that is, r(t) = o( t) as t  . For t > 0, let Bt := B(0, r(t)), and pt be the probability of confinement to Bt of a standard BM (starting from the origin) over [0, t]. In the first part of the current work, for a suitably decreasing function  : R+  R+ with limt (t) = 0, we find the asymptotic behavior as t   of the LD probability
P ZtBt < tptet ,

BBM in expanding ball and among mild obstacles

3

where we have set t = (t) for convenience. It is easy to show that E[nt] = ptet; therefore, since limt (t) = 0, for large t, tptet is atypically small for the mass of a BBM with killing at B.
2. Trap field and mild obstacle problem for BBM: The setting of random obstacles in Rd is formed as follows. Let  be a Poisson point process (PPP) in Rd with constant intensity

 > 0, and (, P) be the corresponding probability space with expectation E. By a trap associated to a point x  Rd, we mean a closed ball of fixed radius a > 0 centered at x, and by a trap field,

we mean the random set

K = K() :=

B¯(xi, a),

xi supp()

where B¯(x, a) denotes the closed ball of radius a centered at x  Rd. In the second part of the current work, the BBM is assumed to live in Rd, to which K is
attached. For   , we refer to Rd with K() attached simply as the random environment , and use P  to denote the conditional law of the BBM in the random environment . The mild obstacle problem for BBM has the following rule: when a particle of BBM is in Kc, it branches at rate , whereas when in K, it branches at a lower rate ¯ with 0  ¯ < . That is, under the law P , the

BBM has a spatially dependent branching rate

 = (x, ) :=  ½Kc()(x) + ¯ ½K()(x).

We emphasize that here we allow the possibility of complete suppression of branching in K, that is, ¯ = 0, which was not considered in [6]. Our focus is on the total mass of BBM among mild obstacles. We first find upper bounds that are valid for large t on the LD probabilities that the mass is atypically small and atypically large. Then, via Borel-Cantelli arguments, we obtain the corresponding SLLN. The result is valid in almost every environment ; hence, it is called a quenched SLLN.

1.2. History
The study of branching diffusions in restricted domains with absorbing boundaries goes back to Sevast'yanov [18], who studied the survival of such systems in bounded domains in Rd. In [11], Kesten studied a BBM with negative drift in one dimension starting with a single particle at position x > 0 in the presence of absorption at the origin. He obtained a survival criterion depending on the drift of the process, and an asymptotic result on the number of particles in a given interval. Later, various further results were obtained on the one-dimensional model with absorption at a one-sided barrier. In [14], considering a BBM starting with a single particle at the origin and with a strong enough negative drift so as to make extinction almost sure, Neveu studied the process (Zx)x0 formed by the total mass that is frozen upon exiting ((-, -x), x  0). Berestycki et al. followed up on Kesten's model of BBM with absorption at the origin, and in [1] and [2] studied, respectively, the survival probability of the BBM near the critical drift as a function of x > 0, and the genealogy of the process. In [8], on the same model, Harris et al. studied the one-sided FKPP travelling-wave equation, and obtained several results on the asymptotic speed of the rightmost particle, the almost sure exponential growth rate of particles having different speeds, and the asymptotic probability of presence of the BBM in the subcritical speed area. Then, in [13], Maillard improved on Neveu's work in the case where the process goes extinct almost surely, and obtained precise asymptotics on the number of absorbed particles at the linear one-sided barrier. More recently in [9], Harris et al. studied a BBM with drift in a fixed-size interval, that is, a two-sided barriered version of Kesten's model, and obtained a survival criterion involving a critical width for the interval, and also the asymptotics of the near-critical survival probability. The one-dimensional model involving a BBM with drift and a fixed barrier is equivalent to the model involving a BBM with no drift and a linearly

BBM in expanding ball and among mild obstacles

4

moving barrier. The first part of the current work gives a large-deviation result in the downward direction on the population size of a BBM in a subdiffusively expanding (time-dependent) ball in d dimensions with killing boundary.
The second part of the current work is about a BBM among mild obstacles in Rd. The study of branching diffusions among random obstacles in Rd goes back to Engl¨ander [3], who studied a BBM among hard Poissonian obstacles in the case of a uniform field, and obtained the asymptotic probability of survival for the system as t   in d  2. In the hard obstacle model, the process is killed instantly when a particle hits the traps. In search for an extension to d = 1, Engl¨ander and den Hollander [4] then studied the more interesting case where the trap intensity was radially decaying in a particular way in d  2, and yielding uniform intensity in d = 1, so as to give rise to a phase transition in the survival probability and the optimal survival strategy of the system. In both [3] and [4], the branching rule was taken as strictly dyadic, and the main result was the exponential asymptotic decay rate of the annealed survival probability as t  ; in addition, in [4], several optimal survival strategies were proved. For a BBM with a generic branching law, denote by p0 the probability that a particle gives no offspring at the end of its lifetime. In [15], the work in [3] was extended to a BBM with a generic branching law, including the case where p0 > 0. Likewise in [16], the work in [4] on the radially decaying trap field was extended to a BBM with a generic branching law, with the possibility of p0 > 0. Recently in [17], conditioning the BBM on the event of survival from hard Poissonian obstacles, O¨ z and Engl¨ander proved several optimal survival strategies in the annealed environment, with particular emphasis on the population size.
We refer the reader to [5] for a survey, and to [7] for a detailed treatment on the topic of BBM among random obstacles, and to [12] for a related problem where a critical BBM that is killed at a small rate inside the traps (such traps are called soft obstacles) is studied. We repeat that the mild obstacle model studied in the current work was proposed by Engl¨ander in [6], and it is the partial aim of this work to improve the WLLN therein for the population size of the BBM to the SLLN.
Notation: We use c, c0, c1, . . . as generic positive constants, whose values may change from line to line. If we wish to emphasize the dependence of c on a parameter p, then we write c(p). We denote by f : A  B a function f from a set A to a set B. For two functions f, g : R+  R+, we write g(t) = o(f (t)) if g(t)/f (t)  0 as t  . Also, for a generic function g : R+  R+, we occasionally set gt = g(t) for notational convenience. We use N as the set of positive integers. For x  Rd, we use |x| to denote its Euclidean norm; also, for a generic finite set S, we use |S| to denote its cardinality. We use B(x, a) to denote the open ball of radius a > 0 centered at x  Rd. For an
event A, we use Ac to denote its complement, and ½A its indicator function.
We denote by X = (X(t))t0 a generic standard Brownian motion (BM) in d-dimensions, and use Px and Ex, respectively, as the law of X started at position x  Rd, and the corresponding expectation.
Outline: The rest of the paper is organized as follows. In Section 2, we present our main results. Section 3 contains several introductory results, which serve as preparation for the proofs of Theorem 1 and Theorem 2. In Section 4 and Section 5, we present, respectively, the proofs of Theorem 1 and Theorem 2.
2. Main Results
The first main result gives the large-time asymptotic behavior of the probability that the mass of BBM inside a subdiffusively expanding ball B = (Bt)t0 with killing at the boundary of the ball, is atypically small. A subdiffusive expansion means that the ball is expanding slower than the rate at which a typical BM moves away from the origin, which means for large t it would be a `rare

BBM in expanding ball and among mild obstacles

5

event' for the BM to be confined in Bt. For a generic standard Brownian motion X = (X(t))t0 and a Borel set A  Rd, define A = inf{s  0 : X(s) / A} to be the first exit time of X out of A.

Theorem as t  

1 (LD for mass of and r(t) = o( t).

BBM Also,

in let

an expanding  : R+  R+

ball). Let r : R+  R+ be such that r(t)   be defined by (t) = e-r(t), where  > 0 is a

constant. For t > 0, set Bt = B(0, r(t)), pt = P0(Bt  t), and nt = |ZtBt|.

If 0 <   /2, then

lim
t

1 r(t)

log

P

nt < tptet

= -,

(1)

and if  > /2, then

-( 

2)



lim inf
t

1 r(t)

log

P

nt < tptet

(2)



lim sup
t

1 r(t)

log

P

nt < tptet

-

/2,

(3)

where we use a  b to denote the minimum of the numbers a and b.

Remark 1. The reason we call P (nt < tptet) with t = e-r(t) a large-deviation (LD) probability is that with this choice of t, both P (nt < tptet) and P (nt = 0) decay as e-cr(t) to the leading

order for large t, where the values of the constant c > 0 may differ.

Indeed, start with

P (nt < tptet)  P (nt = 0).

One way to realize {nt = 0} is to completely suppress the branching and move the initial particle

out of Bt := B(0, r(t)) over [0, kr(t)], where k > 0 is a constant. The probability of realizing this

joint strategy is

exp

-kr(t)

-

r(t) 2k

(1

+

o(1))

,

(4)

where the second term in the exponent comes from Proposition A along with Brownian scaling. To minimize the absolute value of the exponent in (4), set kr(t) = r(t)/(2k), which yields k = 1/( 2). With this choice of k, we arrive at

P (nt = 0)  exp - 2r(t)(1 + o(1)) .

(5)

Remark 2. In Theorem 1, we have only considered  with t = e-r(t) for the following reason. It can be shown that if t  0 as t  , then for all large t, P (nt < tptet)  t for some 0 <  < 1 (see the proof of the lower bound of Theorem 1 in Section 4). Hence, when t is decaying sufficiently slowly so as to satisy (log t)/r(t)  0 as t  , due to (1) and (3), the event {nt < tptet} would not be an LD event.

Our second main result is a quenched SLLN for the total mass of BBM among mild Poissonian

obstacles in Rd. Recall that (, P) is the probability space for the PPP that creates the random

environment, and Nt := |Zt|. We now introduce further notation. Let d,r be the principal Dirichlet

eigenvalue

of

-

1 2



on

B(0, r) in

d

dimensions.

Write

d

:= d,1,

and

let

d

be

the

volume

of

the

d-dimensional unit ball. For d  1 and  > 0, define the constant

c(d, ) := d

d d

-2/d
.

(6)

BBM in expanding ball and among mild obstacles

6

Theorem 2 (Quenched SLLN for BBM among mild obstacles). On a set of full P-measure,

lim (log t)2/d log Nt -  = -c(d, v) P -a.s.

(7)

t

t

Remark 3. Note that the branching rate ¯ in the trap field K does not appear in the formula. Remark 4. It was shown in [6] that on a set of full P-measure,

E[Nt] = exp

t

-

c(d,

v)

(log

t t)2/d

(1

+

o(1))

.

(8)

Theorem 2 is called a SLLN for BBM among mild obstacles, because it says that with P -probability one, the total mass of BBM among mild obstacles grows as its expectation as t  . The reason why it is called a quenched SLLN is that it holds on a set of full P-measure.

3. Preparations
In this section, we present introductory results that serve as preparations for the proofs of the main theorems. The first two results are standard in the theory of Brownian motion. Proposition A is on the large-time asymptotic probability of atypically large Brownian displacements. For a proof, see for example [16, Lemma 5].
Proposition A (Linear Brownian displacements). For k > 0,

P0

sup |X(s)| > kt
0st

= exp

-

k2t 2

(1

+

o(1))

.

The following is a standard result on the large-time Brownian confinement in balls, and for instance can be deduced from [7, Prop. 1.6], along with the scaling d,r = d/r2. Recall that A = inf{s  0 : X(s) / A} denotes the first exit time of X out of A.
Proposition B (Brownian confinement in small balls). For t > 0, let Bt = B(0, r(t)), where r : R+  R+ is such that r(t)   as t   and r(t) = o( t). Then, as t  ,

P0 (Bt  t) = exp

-

dt r2(t)

(1

+

o(1))

.

The following result is well-known in the theory of branching processes. For a proof, see for example [10, Sect. 8.11].

Proposition C (Distribution of mass in branching systems). For a strictly dyadic continuous-time

branching process N = (Nt)t0 with constant branching rate  > 0, the probability distribution at

time t is given by

P (Nt = k) = e-t(1 - e-t)k-1, k  1,

from which it follows that

P (Nt > k) = (1 - e-t)k.

(9)

We now focus on the model of Poissonian traps in Rd. Recall that a random environment in Rd

is created via a PPP, called , with

K :=

B¯(xi, a)

xi supp()

BBM in expanding ball and among mild obstacles

7

being the trap field attached to Rd.
Definition 1. A clearing in the random environment  is a trap-free region in Rd, that is, A  Rd is a clearing if A  Kc. By a clearing of radius r, we mean a ball of radius r which is a clearing.
The following result is Lemma 4.5.2 in [19].

Proposition D. Let

R0 = R0(d, ) :=

d d

1/d
=

d c(d, )

.

(10)

Then, on a set of full P-measure, there exists 0 > 0 such that for each   0 the cube (-, )d contains a clearing of radius

R := R0(log )1/d - (log log )2,  > 1.

(11)

We now prove a somewhat stronger version of Proposition D, which will be needed in the proof of the lower bound of Theorem 2 (see Section 5). For a Borel set B and x  Rd, we define their
sum in the sense of sum of sets as x + B := {x + y : y  B}.

Lemma 1 (Almost sure clearings). Let n  N and a  R+ be fixed, and for  > 0 let x1, . . . , xn be any set of n points in Rd. Define the cubes Cj, = xj + (-, )d, 1  j  n. Then, on a set of full P-measure, there exists 0 > 0 such that for each   0, each of C1,, C2,, . . . , Cn, contains a clearing of radius R + a, where R is as in (11).
Proof. Let x1, x2, . . . be a sequence of points in Rd, and Cj, := xj + (-, )d for j = 1, 2, . . . For k  0, let A,k be the event that there is a clearing of radius R + k in each C1,, C2,, . . . , C(2)n,. Also, for k  0, define

E,k = {(-, )d contains a clearing of radius R + k}.

Due to the homogeneity of the PPP, it is clear that for all x  Rd and k > 0,

P x + (-, )d contains a clearing of radius R + k = P(E,k).

Then, the union bound gives

P(Ac,k)  (2)n P(Ec,k).

(12)

We now estimate P(Ec,k). Partition (-, )d into smaller cubes of side length 2(R + k). Then, a

ball of radius R + k can be inscribed in each smaller cube, and we can bound P(Ec,k) from above

as

P(Ec,k) 

1 - e-d(R+k)d /(R+k)d  exp

-

 R + k

d
e- d (R +k)d

,

(13)

where we have used the estimate 1 + x  ex. Let

 :=

 R + k

d
e-d(R+k)d .

BBM in expanding ball and among mild obstacles

8

Then,

using

(11),

and

that

log/(R

+

k)



log

 2(R +k)

,

we

obtain

log   d log  - d log[2(R0(log )1/d - (log log )2 + k)] - d[R0(log )1/d - (log log )2 + k]d

= d log  - d log[2(R0(log )1/d - (log log )2 + k)] - dR0d log 

1

-

(log log )2 - R0(log )1/d

k

d

 d log  - d log 2 - d log[R0(log )1/d - (log log )2 + k]

-

d

log



+

d2 R0

(log

)1-1/d [(log

log

)2

-

k]

-

d3 2R02

(log

)1-2/d [(log

log

)2

-

k]2



1 2R0

(log

log

)2

(14)

for all large , where we have used in the first inequality that R0d = d/(d), and that (1 - x)n  1 - xn + (xn)2/2 for x  0. It follows from (13) and (14) that for a given k > 0, for all large ,

P(Ec,k)  e-  e- exp[(log log )2/(2R0)].

Take  = 2m with m  N. Then, for all large m, e-(2m)  exp

log m
-m 2R0

, which along with (12)

and (14) implies


P Ac2m,k
m=1



 c(m0) +

(2m+1)n exp

m=m0

log m
-m 2R0



< c(m0) +

(2n)m+1 e-m2 < ,

m=m0

where c(m0) is a constant that depends on m0. Applying Borel-Cantelli lemma to the cubes (-2m, 2m)d, we conclude that with P-probability one, only finitely many Ac2m,k occur. That is, P(0) = 1, where

0 = { : m0 m  m0, each C1,2m , . . . , C(2m+1)n,2m has a clearing of radius R(2m) + k}. (15)

Let 0  0, and m0 be as in (15). If we choose k  a, then to complete the proof, it suffices to show that in the environment 0 for each m  m0 and 2m    2m+1, each C1,, . . . , Cn, contains a clearing of radius R + a. Let   2m0 so that 2m    2m+1 for some m  m0. Fix this integer m. Observe that

R(2m+1) - R(2m)  R0(log 2)1/d (m + 1)1/d - m1/d  R0 log 2.

Choose k = R0 log 2 + a (so far the choice of k > 0 was arbitrary). Then, since R is increasing in  for large , we have

R + a  R(2m+1) + a  R(2m) + R0 log 2 + a = R(2m) + k.

(16)

Furthermore,

n  (2m+1)n .

(17)

Then, setting 0 = 2m0 , (15), (16) and (17) imply that for   0, each of C1,, . . . , Cn, contains a clearing of radius R + a. This completes the proof since the choice of 0  0 was arbitrary and P(0) = 1.

BBM in expanding ball and among mild obstacles

9

4. Proof of Theorem 1
 Recall that by assumption r : R+  R+ satisfies r(t)   as t   and r(t) = o( t). Also, we set Bt = B(0, r(t)) for t  0. Throughout this section, we will use that the law of |ZtBt| is the same as the law of number of particles of Z which are present at t and whose ancestral lines over
[0, t] have been confined to Bt.

4.1. Proof of the lower bound

Suppose that

t = e-r(t), where  > 0.

Consider the joint strategy of suppressing the branching over [0, f (t)], and then letting the BBM evolve `normally' in the remaining interval [f (t), t]. To be precise, recall that nt := |ZtBt|, A denotes the first exit time out of A, and pt := P0(Bt  t); and let f : R+  R+ satisfy f (t) = o(t). For
t > 0 define the events At = {Nf(t) = 1}, Et = {nt < tptet}.

Estimate

P (Et)  P (Et  At) = P (Et | At)P (At).

(18)

We will show that P (Etc | At) tends to a constant smaller than one as t   for suitable f . Let (Y1(s))0s1 be the path of the initial particle, where 1 denotes the particle's lifetime. Conditional on At, it is clear that 1  f (t), and that nt = 0 if Y1(z) / Bt for some 0  z  f (t). Next, for t > 0 define
Dt = {Y1(z)  Bt  0  z  f (t)}.

Then,

E [nt | At] = E [nt½Dt | At] + E ½ nt Dtc | At = E [nt | At, Dt] P (Dt | At),

(19)

where the second term on the right-hand side vanishes. Write

E [nt | At, Dt] = E [nt | At, Dt, Y1(f (t)) = y] P (Y1(f (t))  dy | At, Dt).

(20)

Bt

Define

p(t)(x, s, dy) := Px(X(s)  dy | X(z)  Bt  0  z  s) and pts,x := Px(Bt  s).

(21)

Applying the Markov property of a standard BM at time s with 0 < s < t gives

pt = pts,0 ptt-s,y p(t)(0, s, dy).
Bt

(22)

Furthermore, it follows from (19) and (20) that

E [nt | At] = ptf(t),0 E [nt | At, Dt, Y1(f (t)) = y] p(t)(0, f (t), dy).

(23)

Bt

Now apply the Markov property of BBM at time f (t), and use the many-to-one lemma (see for instance [7, Lemma 1.6]) to obtain

E [nt | At, Dt, Y1(f (t)) = y] = ptt-f(t),y e(t-f(t)), y  Bt.

(24)

BBM in expanding ball and among mild obstacles

10

Using (22) with s therein replaced by f (t), it then follows from (22), (23) and (24) that

E [nt | At] = e(t-f(t))ptf(t),0 = e(t-f(t))pt.

ptt-f(t),y p(t)(0, f (t), dy)
Bt

Then, by the Markov inequality,

P (Etc

|

At)



E nt At tptet

= t-1e-f(t).

(25)

Choose f (t) = -(1/) log((1 - )t), where 0 <  < 1. With this choice of f , (25) implies that P (Et | At)  . Then, noting that P (At) = e-f(t), it follows from (18) that

P (Et)  e-f(t) = (1 - )t = e-r(t)(1+o(1)).

This, along with (5), proves (2), and the lower bound in (1).

4.2. Proof of the upper bound
For the proof of the upper bound, we follow a method that is based on Chebyshev's inequality, similar to the proof of [6, Thm. 1]. Let g : R+  R+ satisfy g(t)  0 as t  . Later, we will choose gt := g(t) in a precise way. For t  0, let Nt = |Zt| as before, and estimate

P ( · ) = P · Nt > etgt + P Nt  etgt .

(26)

We first bound the second term on the right-hand side of (26) from above. It follows from (9) that P (Nt  k) = 1 - (1 - e-t)k  ke-t for k  1. Set k = etgt to obtain

P Nt  etgt = P Nt  etgt  etgte-t  gt.

(27)

Next, for t > 0 define

Pt( · ) = P ( · | Nt > etgt),

and let Et be the corresponding expectation. We now bound the first term on the right-hand side of (26) from above. Let Nt denote the set of particles of Z that are alive at time t. For u  Nt, let (Yu(s))0st denote the ancestral line up to t of particle u. By the ancestral line up to t of a particle present at time t, we mean the continuous trajectory traversed up to t by the particle, concatenated
with the trajectories of all its ancestors including the one traversed by the initial particle. Note
that (Yu(s))0st is identically distributed as a Brownian path (X(s))0st for each u  Nt. Let us pick randomly, independent of their genealogy and position, etgt particles from Nt. Note that this is possible under Pt( · ). Denote this collection of particles by Mt, set Mt := |Mt|, and define

n^t =

½Au ,

uMt

where Au = {Yu(s)  Bt  0  s  t}. Observe that n^t counts, out of Mt, the particles whose ancestral lines are confined to Bt over [0, t]. Since the collection Mt is chosen independently of the motion process, each particle u in Mt has an ancestral line (Yu(s))0st that is Brownian. Then, since the branching and motion mechanisms are independent of each other, the many-to-one lemma

BBM in expanding ball and among mild obstacles

11

implies that for t > 0,

Et[n^t] = ptMt = ptetgt,

(28)

where pt is as before the probability of confinement of a standard BM to Bt over [0, t]. It is clear that n^t  nt. At this point, choose g such that gt  t for all t > 0. Then, using Chebyshev's inequality, it follows from (26), (27), and (28) that

P (nt < tptet)  Pt n^t < tptet + gt

 Pt |n^t - Et[n^t]| > (gt - t)ptet + gt



(gt

Vart(n^t) - t)2p2t e2t

+ gt,

(29)

where Vart denotes the variance associated to Pt. In the rest of the proof, we estimate Vart(n^t). Let P be the probability under which the pair (i, j) is chosen uniformly at random among the
Mt(Mt - 1) possible pairs in Mt, and let E be the corresponding expectation. Also, for a generic Brownian motion X, let Var denote its variance, and let A = {X(s)  Bt  0  s  t}. Then,

Vart(n^t) = Vart

½Au

uMt

= MtVar (½A) +

Covt ½Ai, ½Aj

1i=j Mt

= Mt(pt - p2t ) + Mt(Mt - 1)

1i=jMt Covt ½Ai , ½Aj
Mt(Mt - 1)

 gtet(pt - p2t ) + gtet(gtet - 1) (E  Pt)(Ai  Aj) - p2t .

(30)

Let Q(t) be the distribution of the splitting time of the most recent common ancestor of ith and jth particles under E  Pt. Applying the Markov property at this splitting time, we obtain

t

(E  Pt)(Ai  Aj ) = pt

ptt-s,x p(t)(0, s, dx) Q(t)(ds),

(31)

0 Bt

where p(t)(x, s, dy) and pts,x are as defined in (21). Set pts = pts,0. Then, it follows from (22) and

(31) that

(E  Pt)(Ai  Aj) = p2t

t 0

1 pts

Q(t)(ds).

(32)

For t > 0 define

Jt :=

t 0

1 pts

Q(t)(ds).

Then, by (30) and (32), we have

Vart(n^t)  gtptet + gt2p2t e2t(Jt - 1).

(33)

It is clear that Jt - 1  0. Next, we bound Jt - 1 from above. Recall that r(t) is a distance scale. For k > 0, we will use kr(t) as a time scale. Note that for
large t it is atypical for a BM starting at the origin to escape Bt = B(0, r(t)) over [0, kr(t)]. For

BBM in expanding ball and among mild obstacles

12

large t, split Jt up as

Jt =

kr(t) 0

1 pts

Q(t)(ds)

+

t kr(t)

1 pts

Q(t)(ds),

and define

Jt(1) :=

kr(t) 0

1 pts

Q(t)(ds),

Jt(2) :=

t kr(t)

1 pts

Q(t)(ds).

We first bound Jt(1) - 1 from above. Observe that pts is nonincreasing in s, and estimate

Jt(1) =

kr(t) 0

1 pts

Q(t)(ds)



1 ptkr(t)

.

(34)

From Proposition A,

1 - ptkr(t) = exp

-

r(t) 2k

(1

+

o(1))

.

(35)

It then follows from (34) and (35) that

Jt(1)

-

1



1

exp

-

r(t) 2k

(1

+

o(1))

- exp

-

r(t) 2k

(1

+

o(1))

= exp

-

r(t) 2k

(1

+

o(1))

.

(36)

To bound Jt(2) from above, we will use the following fact on the distribution Q(t) from [6, Prop. 5]: Q(t) is absolutely continuous with respect to the Lebesgue measure, which we denote by ds, and its density function, which we denote by g(t), satisfies
 C > 0, s0 > 0 such that  s  s0, g(t)(s)  Cse-s.  Since r(t) = o( t) by assumption, this implies that for all large t we have r(t)  t, which implies 1/pts  1/prs(t). Here, prs(t) = P0(Br(t)  s) with Br(t) = B(0, r(r(t))) in accordance with previous notation. Then, since r(t)   as t  , for all large t and for kr(t)  s  t,

1 pts



1 prs(t)

= exp

ds r2(r(t))

(1

+

o(1))

 exp

2ds r2(r(t))

,

where we have used Proposition B. Then, we continue with

Jt(2) =

t kr(t)

1 pts

Q(t)(ds)



t
exp
kr(t)

2ds r2(r(t))

C se-sds

C


s exp
kr(t)

-



-

2d r2(r(t))

s ds

 exp [-kr(t)(1 + o(1))] ,

(37)

where we have used integration by parts. From (36) and (37), we have

Jt - 1 = Jt(1) - 1 + Jt(2)  exp

-

r(t) 2k

(1

+

o(1))

+ exp [-kr(t)(1 + o(1))] .

(38)

BBM in expanding ball and among mild obstacles

13

To optimize the smallest absolute exponent on the right-hand side of (38), choose k so that

kr(t)

=

r(t) 2k

.

This

yields

k

=

1 2

.

With

this

choice

of

k,

we

have

Jt - 1  exp - /2 r(t)(1 + o(1)) .

It then follows from (29) and (33) that

P (nt

<

tptet)



(gt

gt - t)2

pt

e-t

+

(gt

gt2 - t)2

 e- /2

r(t)(1+o(1))

+

gt.

(39)

By assumption, t = e-r(t) with  > 0. Choose gt = 2t. Then, we can continue (39) with

P (nt

<

tptet)



2 tpt

e-t

+

 4e- /2 r(t)(1+o(1))

+

gt.

(40)

 Using Proposition B, and the assumptions that r(t)   and r(t) = o( t) as t  , we have

tpt

=

e-r(t)-

d t r 2 (t)

(1+o(1))

=

exp[o(t)].

Then, using that gt = 2t = 2e-r(t), it follows from (40) that

P (nt < tptet) 

e- r(t)(1+o(1)) , e- /2 r(t)(1+o(1)),

0 <   /2,  > /2.

This completes the proof of (3) and the upper bound of (1).

5. Proof of Theorem 2

5.1. Proof of the upper bound
The following upper bound was proved in [6, Section 6.1] via a first moment argument, using (8) and the Markov inequality. On a set of full P-measure, say 0, for any  > 0,

P

(log t)2/d

log Nt t

-



+ c(d, v) > 

 exp -t(log t)-2/d + o t(log t)-2/d

.

(41)

To pass from (41) to the upper bound of the corresponding SLLN, we use a standard Borel-Cantelli argument. Recall that  is the sample space for the BBM. For t > 0, define

Yt := (log t)2/d

log Nt t

-



,

and let

0 := {   :   > 0  t0 = t0() such that  t  t0, Yt  -c(d, v) + }.

Let   0. We will show that P (0) = 1. For n  N, define

An := {Yn > -c(d, v) + }.

BBM in expanding ball and among mild obstacles

14

By (41), there exists n0  N such that for all n  n0, P (An)  e-c()n(log n)-2/d . Then,







P (An) = c +

P (An)  c +

e-c()n(log n)-2/d < .

n=1

n=n0

n=n0

By the Borel-Cantelli lemma, it follows that P (An occurs i.o.) = 0, where i.o. stands for infinitely often. Choosing  = 1/k, this implies that for each k  1, we have

P (k) = 1, k := {   :  n0 = n0() such that  n  n0, Yn  -c(d, v) + 1/k}.

Since P (k) = 1 for each k  1, we have P (0) = P (k1k) = 1. Hence, on a set of full

P-measure,

lim sup (log t)(2/d)
t

log Nt t

-



 -c(d, v)

P -a.s.

5.2. Proof of the lower bound Let  > 0. We will find an upper bound for

P

(log t)2/d

log Nt t

-



+ c(d, v) < -

= P

Nt < exp t



-

c(d, v) +  (log t)2/d

(42)

that is valid for large t on a set of full P-measure, and then use this upper bound along with the Borel-Cantelli lemma to pass to the corresponding SLLN.
The proof is split into four parts for better readability. The first three parts are based on a bootstrap argument, where in part one, we find an upper bound on P (Nt < et) for 0 <  < , and then use this upper bound in parts two and three to find a similar upper bound on (42). We mainly follow the proof strategy given in [6]. We significantly improve the first and third parts of the corresponding proof in [6] in order to extend the WLLN therein to SLLN, where the extra work is due to finding rates of decay to zero for the relevant probabilities as t   as opposed to merely showing that they tend to zero.
In the first part of the proof, we use probabilistic arguments alone, including Theorem 1, in contrast to the partial differential equations (PDE) approach used in [6]. The main challenge is due to the possibility of ¯ = 0 (no branching inside the traps), which makes it difficult to show that even in the presence of mild obstacles the system produces exponentially many particles with `high' probability. We emphasize that the case ¯ = 0 was not covered in [6], and the PDE approach used therein exploits the condition ¯ > 0. The second part of the proof is similar to that in [6]; here, with minor further work, we find the rate of convergence to zero of the probability of the relevant unlikely event. The third part of the proof is an application of Theorem 1, where we argue that with `high' probability sufficiently many particles are produced in a certain expanding clearing in Rd, which exists in almost every environment. The fourth part of the proof uses a Borel-Cantelli argument along with the upper bound on (42) from part three to obtain the lower bound of the SLLN in (7).
Part 1: Upper bound on exponentially few total mass In the first part of the proof, we will find an upper bound for

P (Nt < et) with 0 <  < ,

that is valid for large t on a set of full P-measure. The argument will be based on the following lemma of independent interest, which is on the hitting probability of a standard BM to clearings

BBM in expanding ball and among mild obstacles

15

of a certain size. Recall that X = (X(t))t0 denotes a standard BM in d dimensions, and Px is the law of X started at position x  Rd. Also, recall the definition of R0 from (10). Lemma 2 (Hitting probability of BM to large clearings). Let r : R+  R+ be such that

r(t)

=

R0 3

1 6d

1/d
(log t)1/d,

t > 1.

(43)

For    and t > 0, define

t = {x  Rd : B(x, r(t))  Kc()}.

Let Px be the conditional law of X started at position x  Rd in the random environment . Then,

there exists 1   with P(1) = 1 such that for every   1, there exists t0 = t0() such that

for all t  t0,







P0 

X(s)  t =   e-t1/3 .

0st

Proof. Introduce a time scale h(t), and two different space scales (t) and r(t), as follows. Let h, , r : R+  R+ satisfy:

(a) limt h(t) =  and h(t) = o(t),

(b) limt (t) = , (t) = o( h(t)) and n(t) = t/h(t) for some n  2, n  N,

(c)

r(t) =

R0 3

(log

(t))1/d

for t > t0,

where t0 is large enough. Later, we will choose h(t) and (t), and hence r(t), in a precise way so that r(t) will be as in (43). For notational convenience1, suppose that t/h(t) is an integer. Split [0, t] into t/h(t) pieces as
[0, h(t)], [h(t), 2h(t)], . . . , [t - h(t), t].

Let x1, . . . , xt/h(t) be any set of t/h(t) points in Rd. For j = 1, 2, . . . , t/h(t), define the intervals Ij,t and the balls Bj,t, respectively, as

Ij,t = [(j - 1)h(t), jh(t)], Bj,t = B(xj, (t)).

The balls (Bj,t : 1  j  t/h(t)) need not be disjoint. First, we establish a suitable almost-sure environment in Rd with sufficient concentration of
`large' clearings. Let 1   consist of environments  with the property that there exists t0 = t0() such that for all t  t0 there exists a clearing of radius 2r(t) inside each Bj,t, 1  j  t/h(t). By assumption, t/h(t) = n(t) for some n  2. Also, it follows from (11) and (c) that 2r(t)  R(t) for all large t. Then, since (t)   as t  , Lemma 1 implies that P(1) = 1.
We call x  Rd a good point for    at time t if B(x, r(t)) is a clearing (see Definition 1) in
the random environment . That is,

t = {x  Rd : B(x, r(t))  Kc()} is the set of good points associated to the pair (, t). Now choose

xj = X((j - 1)h(t)), 1  j  t/h(t),

1We would like to avoid the floor function in notation.

BBM in expanding ball and among mild obstacles

16

and define 1 as above. We know that P(1) = 1. In what follows, we will use 1 as the almost-
sure, i.e., quenched, environment for the BBM. We now estimate the conditional probability that X does not hit t up to a large time t given that   1.
Let   1, and choose t large enough so that t  t0(), where t0() is as above. Then, for each
1  j  t/h(t), Bj,t = B(xj, (t)) contains a clearing of radius 2r(t), hence a ball of radius r(t), say Bj,t, that is entirely contained in t . That is, Bj,t  t  Bj,t. For f  C[0, t] and 0  a < b  t, let f[a,b] = {f (s) : a  s  b}. Then, for t > 1, define the events

Ej,t = {XIj,t  t = } for 1  j  t/h(t),

t/h(t)

Et :=

Ej,t.

j=1

In words, Et is the event that X does not hit a good point associated to (, t) over [0, t], i.e., Et = {(0stX(s))  t = } .

Next, for t > 1, define the sets t and the events Ft as

t := {j  N : j  t/h(t), X exits Bj,t over Ij,t}, Ft := {|t|  t/(2h(t))}.

Equivalently, Ft is the event that the number of intervals Ij,t where X is confined to Bj,t over Ij,t is greater than or equal to t/(2h(t)) out of a total of t/h(t) intervals. Recall that (t) is the radius of the ball Bj,t andh(t) is the length of the time interval Ij,t. Then, since a BM typically moves a distance of order s over a time period of length s and since (t) = o( h(t)), Ft is an unlikely event for large t. Set P = P0 . We estimate P(Et) as

P(Et)  P(Ft) + P(Et | Ftc).

(44)

Let q0(t) be the probability that X stays inside Bj,t over the period Ij,t, and q1(t) be the probability that it doesn't hit Bj,t conditional on exiting Bj,t over Ij,t. Recall that xj = X((j - 1)h(t)) by choice, and Bj,t  Bj,t is a ball of radius r(t). If X is conditioned to exit Bj,t = B(xj, (t)) over Ij,t = [(j - 1)h(t), jh(t)], over this same period it must also exit B(xj, r(t)), where r(t) is the distance between xj and the center of Bj,t. Therefore, since the Brownian exit distribution out of a ball centered at the starting point has rotational invariance (even under the conditioning),
by comparing the surface area of the r(t)-ball that intersects Bj,t to the total surface area of the r(t)-ball, and since r(t)  (t) for each t > 1, we obtain

q1(t)



1

-

d rd-1(t) d-1(t)

for all t > 1,

where d is a constant that only depends on the dimension d. Then, apply the Markov property of the Brownian path (X(s))0st at times h(t), 2h(t), . . . , t - h(t) to continue the estimate in (44) as

t 2h(t)
P(Ft) =
j=0

t/h(t) j

(1

-

q0(t))j

(q0

(t))

t h(t)

-j



t

t

2 h(t) (q0(t)) 2h(t) ,

(45)

and

P(Et | Ftc) 

1

-

d rd-1(t) d-1(t)

t 2h(t)
 exp

-d

r(t) (t)

d-1 t 2h(t)

,

(46)

BBM in expanding ball and among mild obstacles

17

where we have used the estimate 1 + x  ex in passing to the last inequality. Then, from (44), (45),

and (46),

P (Et )



t

t

2 h(t) (q0(t)) 2h(t)

+ exp

-d

r(t) (t)

d-1 t 2h(t)

.

(47)

From Proposition B, we have

q0(t) = exp

-

d h(t) 2(t)

(1

+

o(1))

,

t  .

We now choose h(t), (t), and r(t) in a suitable way so as to keep P(Et) sufficiently small in view of (47), while respecting the previously stated requirements (a)-(c):

 h(t) = t,

(t) = t1/(6d),

r(t)

=

R0 3

1 6d

1/d
(log t)1/d,

t > 1.

With these choices, since q0(t)  0 as t  , it follows from (47) that for all large t,

P(Et)  exp

-t1/2

+ exp

-

d 2

c(R0,

d)(log t)(d-1)/dt1/2 t(d-1)/(6d)

 exp -t1/2 + exp -t1/2-(d-1)/(6d)(1 + o(1))  exp -t1/3 ,

where the last inequality follows since

1 3

<

1 2

-

d-1 6d

.

Hence, we reach the following conclusion.

There exists 1   with P(1) = 1 such that    1,  t0 = t0() such that  t  t0,

P ((0stX(s))  t = )  e-t1/3 .

Next, we use Lemma 2 to complete the first part of the proof of the upper bound of Theorem 2. Recall that 0   < . Choose  such that 0 <  < 1 - /. Split the interval [0, t] into two
pieces as [0, t] and [t, t]. We argue that with `high' probability, the BBM hits a good point, say z0  Rd, associated to (, t) over [0, t], and then the sub-BBM emanating from the particle that hits z0 produces at least et particles over [t, t] inside B(z0, r(t)).
Let Y1 = (Y1(s))s0 be a randomly2 chosen ancestral line of the BBM in the random environment . Note that even under P , since branching and motion mechanisms are independent of each other,
(Y1(s))s0 is identically distributed as a standard Brownian motion. The range (accumulated support) of Z is the process defined by

R(t) =

supp(Z (s)).

(48)

0st

Since Y1 is an ancestral line of Z, we have 0stY1(s)  R(t) for each t  0. Then, since Y1 is

2One can choose an ancestral line randomly as follows: start with the path of the initial particle from t = 0 until it branches, and when it branches, pick one of the two offspring with probability 1/2, and concatenate the previously traced path to the path of the chosen offspring until it, too, branches; repeat indefinitely the procedure of picking an offspring particle with probability 1/2 upon branching and concatenating its path to the previously traced path.

BBM in expanding ball and among mild obstacles

18

Brownian, Lemma 2 implies that for 0 <  < 1, on a set of full P-measure, say 2, for all large t,

P (R(t)  t = )  e-1/3t1/3 .

(49)

Observe that {R(t)  t = } is the event that Z doesn't hit a good point associated to (, t) over [0, t].
Now let  =  () = inf{s > 0 : R(s)  t = } be the first hitting time of Z to t. Let Y2 be the ancestral line of Z that first hits t, and let z0 = Y2( ). Conditional on  < t, apply the strong Markov property at time  , and then apply Theorem 1 to the growth inside B(z0, r(t)) of
the sub-BBM initiated by Y2 at time  . Note that Bt := B(z0, r(t)) is a clearing in the random environment  by definition of  , z0 and t.
In detail, for u  0, let Z[Bt,+u] denote the mass at time  + u of the sub-BBM initiated at position z0 and time  by Y2 with killing at Bt. Let s := (1 - )t, r^ : R+  R+ be such that

r^(s)

=

R0 3

1 6d

1/d

log

s 1-

1/d

for large s, and Bs := B(0, r^(s)). Observe the equality of events {  t} = {R(t)  t = }, and that t -   (1 - )t conditional on   t, and r^(s) = r(t). Then, on 2 with P(2) = 1, applying the strong Markov property at  =  (), and taking s = exp[- /2 r^(s)] for instance,
Theorem 1 implies that for all large t,

P  Nt < et R(t)  t =   P 

Z[Bt,t]

<

 e- /2

r^(s)

e-

d s (r^(s))2

(1+o(1)) e s

 P

Z[Bt, +(1-)t]

<

 e- /2

r^(s)

e-

d s (r^(s))2

(1+o(1)) e s

=P

ZsBs

<

 e- /2

r^(s)

e-

d s (r^(s))2

(1+o(1)) e s

 = e- /2 r^(s)(1+o(1)),

(50)

where, in the first inequality, we have used that t < (1 - )t = s due to the choice  < 1 - /, and in the first equality we have used that Bt is a clearing in  followed by translation invariance. Then, in view of r^(s) = r(t) and the definition of r(t) from (43), we reach the following conclusion via (49) and (50): on 2   with P(2) = 1,

P  Nt < et  e-c(log t)1/d(1+o(1)),

(51)

where c = c(d, , , ) > 0. (The dependence of c on  is through R0, which appears in the definition of r(t); see (10) and (43).) This gives a quenched upper bound on the probability that Nt = |Zt| is exponentially few, and completes the first part of the proof of the lower bound of Theorem 2.
Part 2: Time scales within [0, t] and moving a particle into a large clearing This part of the proof is not new; it is essentially taken from [6] with minor improvements, where
we also estimate the rate of decay to zero as t   of the probabilities of the relevant unlikely events as opposed to merely showing that they tend to zero. Introduce two different time scales, (t) and m(t), where (t) = o(m(t)) and m(t) = o(t), and split the interval [0, t] into [0, (t)], [(t), m(t)] and [m(t), t]. More precisely, let , m : R+  R+ be two functions satisfying (t) < m(t) < t for all t > 0, and

BBM in expanding ball and among mild obstacles

19

(i) limt (t) = ,

(ii)

limt

log t log((t))

= 1,

(iii) (t) = o(m(t)),

(iv) m(t) = o(2(t)),

(v) m(t) = o(t(log t)-2/d).

For concreteness, we fix the following choices of  and m that satisfy (i)-(v): let (t) and m(t) be arbitrarily defined with (t) < m(t) < t for t  (0, e], and

(t) = t1-1/(log log t), m(t) = t1-1/(2 log log t), for t > e.

Firstly, using Part 1 of the proof, we prepare the setting at time (t). Fix   (0, ), and define I(t) = e(t).

Recall the definition of R(t) from (48), and for t > 0, let

Mt := inf{r  0 : R(t)  B(0, r)}.

Next, for t > 0, define the families of events

Gt := {N(t)  I(t)}, Ht := {M(t)  2 +  (t)}.

Recall that we write Zt(B) to denote the mass of Z that fall inside B at time t, and define further the family of events
Ft := Z(t) B(0, 2 +  (t))  I(t) .
Since limt (t) = , by (51), on a set of full P-measure, which we had called 2,

P (Gct ) = P  N(t) < e(t)  e-c(log (t))1/d(1+o(1))

(52)

with c = c(d, , , ) > 0. Next, we establish some control on the spatial spread of the BBM at time
(t). Observe that Mt/t is a measure of the spread of Z over [0, t]. As before, let Nt denote the set of particles of Z that are alive at time t, and for u  Nt, let (Yu(s))0st denote the ancestral line up to t of particle u. Note that Nt = |Nt|. Then, using the union bound, for  > 0,

P (Mt > t) = P u  Nt : sup |Yu(s)| > t  E[Nt] P0 sup |X(s)| > t .

(53)

0st

0st

Here, as before, we use P for the law of free3 BBM with branching rate  everywhere. It is a standard result that E[Nt] = exp(t) (one can deduce this, for example, from Proposition C), and we know from Proposition A that P0 sup0st |X(s)| > t = exp[-2t/2(1 + o(1))]. Moreover, the following stochastic domination is clear: for all B  Rd Borel, all k  N, and t  0,

P (Zt(B) < k)  P (Zt(B) < k) for each   .

(54)

Then, taking B =

 B(0, 2

+  (t))

c

and

k

=

1

in

(54),

and



=

 2

+

in

(53),

and

replacing

3Here, free means in Rd without obstacles.

BBM in expanding ball and among mild obstacles

20

t by (t) in both (53) and (54), it follows that on , for any  > 0,

P (Htc) = P  M(t) >

2 +  (t)



e-

(t) 2

(1+o(1))

.

(55)

Since Gt  Ht  Ft, we have P (Ftc)  P (Gct ) + P (Htc), which, in view of (52) and (55) implies

that on 2,

P (Ftc)  e-c(log (t))1/d(1+o(1)),

c = c(d, , , ) > 0.

(56)

This means, on a set of full P-measure, with `high' P -probability, there are at least I(t) particles in B(0, 2 +  (t)) at time (t) for large t.

Next, we prepare the setting at time m(t). Recall (11) and define

R(t) = R(t) = R0[log (t)]1/d - [log log (t)]2, for t > ee.

(57)

Since limt (t) = , Lemma 1 implies that on a set of full P-measure, say 3, there is a clearing B(x0, R(t) + 1) such that |x0|  (t) for all large t. Let   2  3. Conditional on the event Ft, the distance between x0 and each of the at least I(t) many particles in B(0, 2 +  (t)) at time (t) is at most

(1 + 2 + )(t). 
A Brownian particle present at time (t) in B(0, 2 +  (t)) moves to B(x0, 1) over [(t), m(t)]
with probability at least

qt = exp

-

[(1

 + 2 2[m(t)

+ -

)(t)]2 (t)]

(1

+

o(1))

,

which follows from (iii) and (iv), along with the Brownian transition density. Apply the Markov
property of the BBM at time (t), and neglect possible branching of particles over [(t), m(t)] for an upper bound on the probability of Ctc, where

Ct := {Zm(t)(B(x0, 1)) > 0}.

(58)

Observe that conditional on the event Ft, the event Ct is realized if one of the sub-BBMs initiated by each of the at least I(t) many particles present in B(0, 2 +  (t)) at time (t) contributes a

particle to B(x0, 1) at time m(t). Therefore, by the independence of particles present at time (t),

we have

P (Ctc | Ft)  (1 - qt)I(t) = e-qtI(t),

(59)

where

we

have

used

the

estimate

1+x



ex.

Since

(iii)

implies

that

2(t) m(t)

=

o((t)),

we

have

qte(t) = exp[(t)(1 + o(1))].

Then, it follows from (59) that for all large t,

P (Ctc | Ft)  exp -e(t)(1+o(1))  e-t2 ,

(60)

where we have used that by choice, (t) = t1-1/(log log t). Note that (60) is superexponentially small in t. Thus far, the value of   (0, ) was arbitrary. For the rest of the argument, the exact value of  has no importance; therefore let us now fix it as  = /2. Then, it follows from (56), (60), and

BBM in expanding ball and among mild obstacles

21

assumption (ii) that on 0 := 2  3 with P(0) = 1,

P (Ctc)  P (Ctc | Ft) + P (Ftc)  e-c(log t)1/d(1+o(1)),

c = c(d, , ) > 0.

(61)

This means, on a set of full P-measure, with `high' P -probability, there is at least one particle of Z inside B(x0, 1) at time m(t) for large t, where |x0|  (t). Let us generically call this particle v, and denote by y0 := Xv(m(t)) its position at time m(t).

Part 3: BBM in the large expanding clearing
Let   0, and recall that B(x0, R(t) + 1) is a clearing in . In this part of the proof, we will work under the law P ( · | Ct), where Ct was defined in (58). Conditional on the event Ct, we show that Bt = B(y0, R(t)) is a large enough expanding clearing in  in which the BBM can produce sufficiently many particles. In particular, we study the evolution of the sub-BBM initiated by v
at time m(t) over the period [m(t), t] within the expanding clearing Bt. Denote this sub-BBM by Z. We will use Px for the law of a BBM started with a single particle at x  Rd in the random environment . For t > 0 and  > 0, define

At, :=

Nt < exp t



-

c(d, v) +  (log t)2/d

.

(62)

Recall that our goal (see (42)) is to find a suitable upper bound on P (At,).
Define R : R+  R+ such that R(t - m(t)) = R(t) for all large t. (By the choice of m(t), t - m(t) is increasing on t  t0 for some t0 > 0. Therefore, t1 - m(t1) = t2 - m(t2) implies that t1 = t2 for t1  t2  t0). Next, let s := t - m(t), Bs := B(y0, R(s)) and

ps := Py0 (Bs  s) = P0(B(0,R(s))  s),

where, as before, Px denotes the law of a standard BM started at x  Rd. By the Markov property of Z applied at time m(t), Z is a BBM started with a single particle at y0. Noting that Bs is a clearing in  for all large s, and taking s = exp[- /2 R(s)], Theorem 1 implies that





P  |Zs| < e- /2 R(s)pses Ct  Py0 ZsBs < e- /2 R(s)pses

= exp - /2 R(s)(1 + o(1)) .

(63)

By Proposition B, (57), and since R(s) = R(t) and c(d, v) = d/R02,

ps = exp

- ds (1 + o(1)) R2(s)

= exp

-

c(d, v)(t - m(t)) (log (t))2/d

(1

+

o(1))

.

(64)

For two functions f, g : R+  R+, use f (t)  g(t) to express that limt f (t)/g(t) = 1. Then, it follows from assumptions (ii) and (v) that

t - m(t) (log (t))2/d



(log

t t)2/d

,

by which, we can continue (64) with

ps = exp

-

c(d, v)t (log t)2/d

(1

+

o(1))

.

(65)

BBM in expanding ball and among mild obstacles

22

Furthermore, using that s = t - m(t), we have for any  > 0,

exp t



-

c(d, v) +  (log t)2/d

= exp

s

+

m(t)

-

(c(d, v) + )t (log t)2/d

  e- /2 R(s)pses

for all large t, where we have used (65), assumption (v), and that R(s) = R(t) = o(t(log t)-2/d) in
passing to the inequality. It is clear that Nt  |Zt-m(t)| = |Zs|. Then, it follows from (63) that for all large t,

P

Nt < exp t



-

c(d, v) +  (log t)2/d


Ct  P  |Zs| < e- 2R(s)pses Ct  exp - 2R(s)(1 + o(1)) .

Finally, using assumption (ii), (57) along with R(s) = R(t), and (61), we reach the following conclusion. On 0, which is a set of full P-measure, for any  > 0,

P

Nt < exp t



-

c(d, v) +  (log t)2/d

 exp -c(log t)1/d(1 + o(1)) ,

(66)

where c = c(d, , ) > 0. In the next part of the proof, we will exploit the fact that the right-hand side of (66) does not depend on .
Part 4: Borel-Cantelli argument We will show that on a set of full P-measure, for any  > 0,

lim inf (log t)2/d
t

log Nt t

-



 - [c(d, v) + ]

P -a.s.

(67)

Recall the definition of At, from (62). It follows from (66) that there exists c = c(d, , )/2, independent of , such that on 0, for all large t,

P  At,/2  e-c(log t)1/d .

(68)

Define the function f : N  R+ by

f (k) = exp

2 c

d
(log k)d

.

(69)

Take   0. By the choice of f (k) and (68), there exist constants c0 > 0 and k0 > 0 such that


P
k=1

Af (k),/2

 c0 +



e-c(log f (k))1/d = c0 +



1 k2

<

.

k=k0

k=k0

Then, by the Borel-Cantelli lemma, on a set of full P -measure, only finitely many events Af(k),/2 occur. That is, for each   0 there exists 0   such that

P (0) = 1,

0 =

   :  k0()  k  k0 Nf(k)  exp f (k)



-

c(d, v) + /2 (log f (k))2/d

. (70)

BBM in expanding ball and among mild obstacles

23

To prove (67), it suffices to show that for each   0,

Ns  exp

s



-

c(d, v) +  (log s)2/d

, f (k) < s < f (k + 1)

(71)

for all large k. Indeed, (70) and (71) would together imply (67) on 0. Observe that Ns is P almost surely increasing in s, and the right-hand side of (71) is also increasing in s for all large s. Therefore, to prove (71), it suffices to show that for all large k,

Nf(k)  exp f (k + 1)



-

c(d, v) +  (log f (k + 1))2/d

.

(72)

Next, we control f (k + 1) - f (k). Using (69), it can be shown that as k  ,

f (k + 1) - f (k)  d

2 c

d

f

(k)

(log

k)d-1 k

,

(73)

and that if we set t = f (k), then

k = exp

c 2

(log

t)1/d

.

(74)

Then, setting g(t) = f (k + 1) - f (k), it follows from (73) and (74) that

g(t)  d

2 c

d

t

(c/2)d-1(log t)(d-1)/d

exp

c 2

(log

t)1/d

.

(75)

Using (57) and (75), it can be shown that

This implies that for all large k,

lim
t

g(t)R2(t) t

=

0.

f (k

+

1)

-

f (k)



f (k) 2[log f (k)]2/d

,

which further implies that

f (k)

-

c(d, v) + /2 [log f (k)]2/d

f (k)



f (k

+

1)

-

c(d, v) +  [log f (k + 1)]2/d

f (k

+

1)

(76)

since f (z)/[log f (z)]2/d is increasing for large z. As (76) implies (72) on 0, this proves (67), and hence completes the proof of the lower bound of Theorem 2.

References
[1] J. Berestycki, N. Berestycki and J. Schweinsberg. Survival of near-critical branching Brownian motion. J. Stat. Phys. 143 (5) (2011) 833 ­ 854.
[2] J. Berestycki, N. Berestycki, and J. Schweinsberg. The genealogy of branching brownian motion with absorption. Ann. Probab. 41 (2) (2013) 527 ­ 618.

BBM in expanding ball and among mild obstacles

24

[3] J. Engl¨ander. On the volume of the supercritical super-Brownian sausage conditioned on survival. Stoch. Proc. Appl. 88 (2) (2000) 225 ­ 243.
[4] J. Engl¨ander and F. den Hollander. Survival asymptotics for branching Brownian motion in a Poissonian trap field. Markov Process. Related Fields 9 (3) (2003) 363­389.
[5] J. Engl¨ander. Branching diffusions, superdiffusions and random media. Probab. Surv. 4 (2007) 303 ­ 364.
[6] J. Engl¨ander. Quenched law of large numbers for branching Brownian motion in a random medium. Ann. Inst. H. Poincar´e Probab. Statis. 44 (3) (2008) 490 ­ 518.
[7] J. Engl¨ander. Spatial Branching in Random Environments and with Interaction. World Scientific, Singapore, 2014.
[8] J. W. Harris, S. C. Harris and A. E. Kyprianou Further probabilistic analysis of the FisherKolmogorov-Petrovskii-Piscounov equation: One sided travelling-waves. Ann. Inst. H. Poincar´e Probab. Statis. 42 (1) (2006) 125 ­ 145.
[9] S. C. Harris, M. Hesse and A. E. Kyprianou. Branching brownian motion in a strip: survival near criticality. Ann. Probab. 44 (1) (2016) 235 ­ 275.
[10] S. Karlin and M. Taylor. A First Course in Stochastic Processes. Academic Press, New YorkLondon, 1975.
[11] H. Kesten. Branching Brownian motion with absorption. Stoch. Proc. Appl. 7 (1) (1978) 9 ­ 47.
[12] J. -F. Le Gall and A. V´eber. Escape Probabilities for Branching Brownian Motion Among Soft Obstacles. J. Theor. Probab. 25 (2012) 505 ­ 535.
[13] P. Maillard. The number of absorbed individuals in branching Brownian motion with a barrier. Ann. Inst. H. Poincar´e Probab. Statis. 49 (2) (2013) 428 ­ 455.
[14] J. Neveu. Multiplicative martingales for spatial branching processes. In Seminar on Stochastic Processes, 1987 (Princeton, NJ, 1987), volume 15 of Progress in Probabiliy and Statistics, 223 ­ 242. Birkhh¨auser Boston, Boston, MA, 1988.
[15] M. O¨ z. Survival of branching Brownian motion in a uniform trap field. Stat. Probab. Lett. 110 (9) (2016) 211 -- 216.
[16] M. O¨ z, M. C¸ aglar and J. Engl¨ander. Conditional speed of branching Brownian motion, skeleton decomposition and application to random obstacles. Ann. Inst. H. Poincar´e Probab. Statis. 53 (2) (2017) 842 ­ 864.
[17] M. O¨ z and J. Engl¨ander. Optimal survival strategy for branching Brownian motion in a Poissonian trap field. Ann. Inst. H. Poincar´e Probab. Statis. 55 (4) (2019) 1890 ­ 1915.
[18] B. A. Sevast'yanov. Branching stochastic processes for particles diffusing in a bounded domain with absorbing boundaries. Theor. Probab. Appl. 3 (2) (1958) 121 ­ 136.
[19] A.-S. Sznitman. Brownian Motion, Obstacles and Random Media. Springer-Verlag, BerlinHeidelberg, 1998.

