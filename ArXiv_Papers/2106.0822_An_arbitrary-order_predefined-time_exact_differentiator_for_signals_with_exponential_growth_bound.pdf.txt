An arbitrary-order predefined-time exact differentiator for signals with exponential growth bound

arXiv:2106.00822v1 [math.OC] 1 Jun 2021

David Go´mez-Guti´errez a,b, Rodrigo Aldana-Lo´pez c, Richard Seeber d, Marco Tulio Angulo e, Leonid Fridman f
aIntel Tecnolog´ia de M´exico, Intel Labs, Multi-agent autonomous systems lab, Jalisco, Mexico. bTecnologico de Monterrey, Escuela de Ingenier´ia y Ciencias, Jalisco, Mexico.
cUniversity of Zaragoza, Departamento de Informatica e Ingenieria de Sistemas (DIIS), Zaragoza, Spain. dGraz University of Technology, Institute of Automation and Control, Christian Doppler Laboratory for Model Based Control
of Complex Test Bed Systems, Graz, Austria. eCONACyT - Institute of Mathematics, Universidad Nacional Autonoma de M´exico, Juriquilla, Mexico.
f Universidad Nacional Autonoma de M´exico, Engineering Faculty, Ciudad Universitaria, Mexico

Abstract
Constructing differentiation algorithms with a fixed-time convergence and a predefined Upper Bound on their Settling Time (UBST ), i.e., predefined-time differentiators, is attracting attention for solving estimation and control problems under time constraints. However, existing methods are limited to signals having an n-th Lipschitz derivative. Here, we introduce a general methodology to design n-th order predefined-time differentiators for a broader class of signals: for signals, whose (n + 1)th derivative is bounded by a function with bounded logarithmic derivative, i.e., whose (n + 1)-th derivative grows at most exponentially. Our approach is based on a class of time-varying gains known as Time-Base Generators (TBG). The only assumption to construct the differentiator is that the class of signals to be differentiated n-times have a (n + 1)-th derivative bounded by a known function with a known bound for its (n + 1)-th logarithmic derivative. We show how our methodology achieves an UBST equal to the predefined time, better transient responses with smaller error peaks than autonomous predefinedtime differentiators, and a TBG gain that is bounded at the settling time instant.
Key words: Fixed-time stability, predefined-time, unknown input observers, online differentiators

1 Introduction
The arbitrary-order exact differentiator problem is a relevant problem in control theory, that has recently received a great deal of attention (Levant, 1998, 2003; Levant and Livne, 2020; Sanchez et al., 2016; Reichhartinger and Spurgeon, 2018; Reichhartinger et al., 2017), as it can be applied to a wide range of control problems (Frid-
This paper was not presented at any IFAC meeting. Corresponding author: D. Go´mez-Guti´errez.
Email addresses: david.gomez.g@ieee.org (David Go´mez-Guti´errez), rodrigo.aldana.lopez@gmail.com (Rodrigo Aldana-Lo´pez), richard.seeber@tugraz.at (Richard Seeber), mangulo@im.unam.mx (Marco Tulio Angulo), lfridman@unam.mx (Leonid Fridman).

man et al., 2008, 2011; R´ios and Teel, 2018; R´ios et al., 2015; Alwi et al., 2011; Ferreira De Loza et al., 2015; Shtessel et al., 2014; Imine et al., 2011).
Differentiator algorithms where the user can prescribe the desired upper bound for the convergence time, i.e., predefined-time differentiators, are crucial for control systems under time constraints. For instance, predefining the desired convergence time is of paramount importance in fault-detection to ensure that during the observer's convergence, the system's trajectory does not leave a given compact set, where the controller can be switched on based on theoretically exact knowledge of the states.
However, in (Levant, 2003; Levant and Livne, 2020), the knowledge of the set of possible initial conditions is

Preprint submitted to Automatica

3 June 2021

required to set a priori the upper bound for the convergence (Cruz-Zavala and Moreno, 2019). To remove such restriction, fixed-time stability has been investigated, where there exists an Upper Bound of the Settling Time (UBST ) that is valid for all initial conditions. Nonetheless, often the the fixed-time stability property is asserted using homogeneity theory (Andrieu et al., 2008) without explicit computation of the UBST (Angulo et al., 2013).
Predefined-time first-order differentiators have been proposed in (Cruz-Zavala et al., 2011; Seeber et al., 2020). However, these approaches yield a very conservative UBST. Satisfying the time constraints in such a conservative manner typically leads to differentiator errors are that are larger than necessary. An alternative approach, based on a class of time-varying gains, known as time-base generators (TBG) (Morasso et al., 1997), was proposed in (Holloway and Krstic, 2019) for polynomial signals of n-th order, where the convergence is obtained precisely at the user-defined time, but with a TBG gain that tends to infinity at the settling time instant, which makes this application challenging under scenarios with measurement noise and/or limited numerical precision.
The above methods have been developed under the assumption that the n-th derivative is Lipschitz. This is a reasonable assumption for state estimation problems of chaotic systems with state-dependent disturbances (G´omez-Guti´errez et al., 2017), since the evolution, converges toward an invariant bounded set; it does not hold, however, in unstable systems' estimation problems with state-dependent disturbances (Fridman et al., 2011). However, since the states of an unstable linear or Lipschitz nonlinear system cannot grow faster than exponentially (Bejarano et al., 2011; Rodrigues and Oliveira, 2018), assuming disturbances with bounded logarithmic derivative has shown to reasonable in the unknown input state estimation problem (Oliveira et al., 2017; Rodrigues and Oliveira, 2018). Finite-time differentiators for signals, whose (n + 1)-th derivative has a time-varying bound with bounded logarithmic derivative, have been proposed in (Levant and Livne, 2012, 2018; Moreno, 2018; Barbot et al., 2020). However, a predefined-time differentiator for such class of signals has not been proposed in the literature.
To fill the above gaps, here we "redesign" the differentiator from Levant and Livne (2018), by using TBG gains, to obtain a new exact differentiator, for such class of signals, where the desired UBST is set a priori as one parameter of the algorithm. Moreover, unlike (M´enard et al., 2017; Cruz-Zavala et al., 2011; Seeber et al., 2020), our approach yield an arbitrarily tight UBST, and unlike (Holloway and Krstic, 2019) exact convergence is obtained with a bounded TBG gain at the settling time instant.

Compared to our previous results also based on a TBG gain: (Aldana-L´opez et al., 2020), which was limited to signals having a Lipschitz n-th derivative, and (R. Aldana-L´opez et al., 2020) which is limited to the firstorder differentiation case. In both papers, a single type of TBG gains was used. Here, we present the arbitraryorder case and we extend the class of functions that can be differentiated as well as the class of TBG gains used. We will show numerically that these two features allow us to obtain better transient behavior and improved behavior under noisy measurements compared with our previous result.
Notation: R is the set of real numbers, R¯ = R  {-, }, R+ = {x  R : x  0} and R¯ + = R+  {}. For x  R, x  = |x|sign(x), if  = 0 and x  = sign(x) if  = 0. For a function  : I  J , its reciprocal ( )-1,   I, is such that ( )-1( ) = 1 and its inverse function -1(t), t  J , is such that (-1(t)) = t. For functions ,  : R  R,   (t) denotes the composition ((t)). Given a matrix A, AT represents its transpose. Given a vector v  Rn×1,
v = vT v. U := [uij ]  R(n+1)×(n+1), where uij = 1 if j = i + 1 and uij = 0, otherwise. D := diag(0, . . . , n). B := [0, . . . , 0, 1]T  R(n+1).
The rest of the manuscript is organized as follows: In Section 2, we introduce the problem statement and some preliminaries. In Section 3 we present the main result. In Section 4, we discuss the main features of our approach and contrast against state-of-the-art algorithms. Finally, in Section 5, we present the conclusions and the future work. The proofs are collected in the Appendix.

2 Problem statement and preliminaries

2.1 Problem statement

Definition 1 Let L : R+  R+ be a function and M > 0 be a positive constant satisfying

1 dL(t)

 M for all t  0,

(1)

L(t) dt

i.e., a function with logarithmic derivative bounded by M . The set of admissible signals Y((Ln,+M1)) is the set of n times differentiable signals y(t)  R satisfying

y(n+1)(t)  L(t), for all t  0.

Problem 2 Let y  Y((Ln,+M1)) and consider a user-defined time Tc > 0. The problem consists in accurately obtaining, from measuring y(t) and the knowledge of L(t), the
functions y(i)(t), i = 0, · · · , n, for all time t  Tc.

2

Solving this problem enables the application to control
problems with time constraints. Given a desired conver-
gence time, to solve Problem 2, we propose to design functions H : R × R+  Rn+1, together with the (differentiator) algorithm:

z = -H(e0, t; Tc) + U z,

(2)

where z(t) = [z0(t), · · · , zn(t)]T , e0 = z0(t) - y(t) and U is defined in the Notation. Here, the function H(e0, t; Tc) is continuous in e0 except at e0 = 0, and continuous in t almost everywhere. The solutions of (2) are understood
in the sense of Filippov (1988).

Consider the differentiation errors ei(t) = zi(t) - y(i)(t) for i = 0, . . . , n. To analyze the convergence of the differentiators, we analyze the stability of the origin of the differentiation error dynamics given by

e = -H(e0, t; Tc) + U e - By(n+1)(t),

(3)

where e(t) = [e0(t), · · · , en(t)]T , |y(n+1)(t)|  L(t), and U and B are matrices defined in the Notation.

Assume that H(e0, t; Tc) is designed ensuring that the origin of (3) is asymptotically stable and, perhaps except at sets of measure zero, (3) has the properties of existence and uniqueness of solutions in forward-time on the interval [0, ) (Filippov, 1988). Moreover, assume that the origin is the unique equilibrium point of (3). For the system in Eq. (3), its settling-time function T (e(0)) for the initial state e(0)  Rn+1 is defined as:

T (e(0)) = inf   0 :

y



Y((Ln,+M1)),

lim
t

e(t;

e(0),

y)

=

0

,

where e(t; e(0), y) is the solution of (3) for t  0, with signal y(t) and initial condition e(0).

We say that the origin of system (3) is finite-time stable
if it is asymptotically stable (Khalil and Grizzle, 2002) and for every initial state e(0)  Rn, the settling-time function T (e(0)) is finite. We say that the origin of sys-
tem (3) is fixed-time stable if it is asymptotically sta-
ble (Khalil and Grizzle, 2002) and there exists Tmax <  such that T (e(0))  Tmax, for all e(0)  Rn. The quantity Tmax is called an Upper Bound of the Settling Time (UBST ) of the system (3).

With the above definitions, a differentiator is said to be exact if the origin of its error dynamic is globally finitetime stable. Algorithm (2) is a predefined-time exact differentiator if the origin of its differentiation error dynamic (3) is fixed-time stable with a predefined UBST.

2.2 Levant's differentiators with time-varying gains

Theorem 3 ((Levant and Livne, 2018)) Let y  Y((Ln,+M1)) and consider the algorithm:

z = - (e0, t; M, L(t)) + U z,

(4)

where

(e0, t; M, L(t)) := 0(e0, t; M, L(t)), · · · ,
T
n(e0, t; M, L(t))

and the functions {i}ni=0 are defined recursively as
0(w; M, L(t)) := 0(w; M, L(t))
and i(w; M, L(t)) := i(i-1(w; M, L(t)); M, L(t)) for i = 0, . . . , n, with

1

n-i

i(w; M, L(t)) := n-iL(t) n-i+1 w n-i+1 +µn-iM w,

wherein i and µi are constant parameters. Then, there exist positive constants i, µi (i = 0, . . . , n) such that the algorithm of Eq. (4) is an exact differentiator in Y((Ln,+M1)) or, in other words, such that the origin of the system

e = - (e0, t; M, L(t)) + U e - By(n+1)(t), (5)

where ei = zi(t) - y(i)(t), i = 0, . . . , n, (i.e., system (3) with H(w, t; Tc) = (w, t; M, L(t)), is finite-time stable.

Notice that, if we relax the condition (1) to: M is such that there exist t such that t0  t <  and

1 dL(t) L(t) dt

 M, for all t  t, then the finite-time

stability of (5) is maintained.

3 Main result

To solve Problem 2 we take the correction function (e0, t; ·, ·) of the finite-time differentiator (4) from Levant and Livne (2018) to "redesign" it together with a TBG gain to obtain a new correction function H(e0, t; Tc) such that Eq. (2) is a predefined-time differentiator and the desired UBST of the error dynamics (3) is given by the parameter Tc.

To introduce our main result consider the following assumption on the functions  that will be used to construct the TBG gain.

Assumption 4 The function  : R+  R¯ + \ {0} is

such that:

 0

(z)dz

=

1;

( )

<

,

for

all



>

0;

it

3

is either non-increasing or locally Lipschitz on R+ \ {0};

and

(z)-1

d(z) dz

is

uniformly

bounded

with

respect

to

time and satisfies

lim (z)-1 d(z) = -c

(6)

z

dz

for some finite constant c  0.

Notice that  is a probability density function. An es-

sential part of our approach is the TBG gain (t) de-

fined as inverse

(t) := function

d(t) dt

,

where



as -1( ) :=

is defined by

Tc

 0

()d

means of its . As we will

show, the TBG gain is related to the time-scale trans-

formation



= (t) because

d dt

= (t).

Theorem 5 Consider the class of signals Y((Ln,+M1)). Let Tc > 0 be a user-defined time, (·) and c  0 satisfy Assumption 4, and define M > (n + 1)c and Q(c) :=
(U - cD)nB; · · · ; (U - cD)B; B , where B, D and U
are defined in the Notation section. Furthermore, let  e0; ·, · be the error correction function of Levant's differentiator recalled in Theorem 3, with parameters i and µi as in that theorem.

Then, using the algorithm (2) with H(w, t; Tc) as

H(e0, t; Tc) = (t) Q(c) e0; M, L(t)(t)-(n+1) + (U - cD)n+1Be0

for t  [0, Tc), and H(e0, t; Tc) = (e0, t; M, L(t)), otherwise, solves Problem 2, , i.e., the origin of the differentiation error dynamics (3) is fixed-time stable with a predefined UBST given by Tc, where (t) = diag((t), · · · , (t)n+1) and (t) as described above. Additionally, if L(t) is such that the settling-time function of (5) satisfies

sup T (e(0)) = ,

(7)

e(0)Rn+1

then, Tc is the least UBST of (3).

Remark 6 Note that (7) is usually satisfied, unless L(t) is chosen in a special way to achieve fixed-time convergence of the original differentiator, such as in Moreno (2017).

PROOF. The proof can be found in Appendix A.2.

Examples of time-varying gains for predefined-time convergence are given in Table 1.

(z)

c

(i)

-1(Tc - z)-1



(ii)

 2

sec(

z 2Tc

)2

0

(iii)

 Tc

tan(

z Tc

+

 2

- )

1

(iv)

z+ (Tc -z)

 1+

Table 1

Examples of time-varying gains for predefined-time conver-

gence.

Above,

, 

>

0,

and





(0,

 2

).

Remark 7 It is straightforward to extend our method-
ology to filtering differentiators (Levant and Livne,
2020; Carvajal-Rubio et al., 2020). Specifically, let H(w, t; Tc) = [h0(w, t; Tc), · · · , hn(w, t; Tc)]T be selected as in Theorem 5 for signals in Y((Ln,+M1)). Then, the algorithm

w i = - hi-1(w1, t; Tc) + wi+1,

for i = 1, . . . , nf - 1,

w i = - hi-1(w1, t; Tc) + (z0 - y),

for i = nf ,

zi-nf -1 = - hi-1(w1, t; Tc) + zi-nf ,

(8)

for i = nf + 1, . . . , nd + nf ,

znd = - hn(w1, t; Tc),
with n = nd+nf , is a predefined-time exact differentiator but now for signals in Y((Ln,dM+1)). However, in this case, we obtain that, for all t  Tc and every initial condition: wi(t) = 0, i = 1, . . . , nf , and zi(t) = y(i)(t) for all i = 0, . . . , nd. For nf = 0, w1(t) is defined as w1(t) = z0(t)- y(t). The filtering properties of this algorithm can be very useful in the presence of noise (Levant and Livne, 2020).

4 Discussion on the contribution
In this section we highlight the contribution together with numerical examples to support our claims. The simulations below were created in OpenModelica using the Euler integration method with a step of 2 × 10-4. For the sake of simplicity we use the sequence
{i, µi}ni=0 = (1.1, 2), (1.5, 3), (2, 4), (3, 7), (5, 9), . . .
as suggested in (Levant and Livne, 2018).
4.1 Comparison with arbitrary order exact differentiators for polynomial signals of n-th order
Notice that predefined-time higher-order exact differentiators are only provided in (M´enard et al., 2017; Holloway and Krstic, 2019), but only for polynomial signals

4

of n-th order. Whereas the UBST in (M´enard et al., 2017) is very conservative, the convergence in the algorithm given in (Holloway and Krstic, 2019), occurs precisely at the predefined-time.

Remark 8 The TBG gain of Table 1-(i) was also used in (Holloway and Krstic, 2019) with  = 1. However, notice that in such algorithm, for every nonzero e(0),

lim (t) = .
tT (e(0))

This drawback also appear in the controllers based on TBG gains (Song et al., 2017; Chitour et al., 2020; Pal et al., 2020).

Nonetheless, in our approach, although limtTc (t) = , the TBG gain is bounded at the settling time T (e(0)), i.e., for any initial condition e(0)  Rn+1, (T (e(0))) < . Thus, in practice different methods can be used to
maintain the TBG gain bounded for all time. A simple approach is to choose a constant T  < Tc and to do the switching in H(e0, t; Tc) at T  instead that at Tc. With such workaround, the differentiation error of our
algorithm is still finite-time convergent. Moreover, there
exists a neighbourhood of initial conditions around the
origin, whose settling time is bounded by Tc. The size of such neighbourhood can be set arbitrarily large with a
suitable selection of the  and M parameters.

The above workaround was suggested in (Holloway and Krstic, 2019). However, with such workaround an exact differentiator is no longer obtained with the algorithm in Holloway and Krstic (2019) (recall that convergence occurs precisely at Tc).

Example 9 Consider the second-order differentiator

problem. To contrast with (Holloway and Krstic, 2019)

consider

the

quadratic

polynomial

y(t)

=

1 2

t2

+

t

+

1,

and

notice that the algorithm in (Holloway and Krstic, 2019)

is given by Eq. (2) with hi(e0, t; Tc) = gi(e0, t; Tc)e0, and

g0(e0, t; Tc) =l1 + Tc(t)

p11(m + Tc

3)

-

p21

g1(e0, t; Tc) =l2 + Tc2(t)2

p21(m + Tc

4)

-

p31

- p21Tc(t)g0(e0, t; Tc)

g2(e0,

t;

Tc)

=l3

+

Tc3(t)3

p31(m + Tc

5)

- p31Tc2(t)2g0(e0, t; Tc)

- p32Tc(t)g1(e0, t; Tc)

where

p11

=

1, p21

=

-

2(m+3) Tc

,

p31

=

(m+3)(m+4) Tc2

,

p32

=

-

m+3 Tc

,

m

is

a

design

parameter,

here

chosen

to

be

m

=

1, and [l1, l2, l3] = [6, 11, 6]. Moreover, (t) is given in

e(T )

z0(0) = z1(0) = z2(0)
Fig. 1. Magnitude of the error at T  = 0.9  Tc for different initial conditions for the algorithm in (Holloway and Krstic, 2019) using the workaround described in Remark 8 to maintain bounded gains.
Table 1-(i) with  = 1. And consider the workaround discussed in Remark 8 to maintain a bounded TBG gain. For illustration purposes we choose (t)  10. Thus, T  = 0.9. Notice that, zero differentiation error is no longer obtained. In fact, the magnitude e(T ) grows linearly with the initial condition, as shown in Fig. 1.
For our algorithm consider (t) given by Table 1-(i) with  = 1, L = 0.1exp(-5t), M = 0.5, and M = 20, whose convergence is shown in the second row of Fig. 2. Notice that, under the same workaround, even for an initial condition satisfying z0(0) = z1(0) = z2(0) = 10000 zero differentiation error before Tc is still obtained. A significant advantage in contrast with the algorithm in (Holloway and Krstic, 2019).

4.2 Comparison with autonomous first-order differentiator

As mentioned in the introduction, predefined-time autonomous exact differentiators for signals whose n-th derivative is Lipschitz have only been proposed in the literature for the case where n = 1 in (Cruz-Zavala et al., 2011; Seeber et al., 2020). In the next example we compare against the algorithm in (Seeber et al., 2020).

Example 10 Let y(t) = 0.75cos(t) + 0.0025sin(10t) + t with L(t) = L = 1. For comparison, consider the algorithm in (Seeber et al., 2020), i.e., algorithm (2) with hi(w, t; Tc) = kii(w; Tc), i = 1, 2, where

1(w; Tc) =

w

1 2

+ k32

w

3 2

2(w; Tc) = w 0 + 4k32w + 3k34 w 2,

(9)



where k1 = 4

L,

k2

=

2L

and

k3

=

9.8 .
Tc L

The

conver-

gence of (9), under different initial conditions is shown

in the first row of Fig. 3, where can be observed that the

convergence occurs before 0.25s. Now consider our algo-

rithm with (t) given in Table 1-(i) with  = 1, L = 1,

M = 0.1 and M = 3.2. The convergence is observed in

the second row of Fig. 3. Also consider our algorithm with

(t) given in Table 1-(iv) with  = 1,  = 0.1 L = 1,

5

Ours- Table 1-(i)

z0(0) = z1(0) = z2(0) = 1e1

z0(0) = z1(0) = z2(0) = 1e2

z0(0) = z1(0) = z2(0) = 1e4

z0 (t) z1 (t) z2 (t) y(t) y (t) y¨(t)
time

time

time

Fig. 2. Simulation of Example 9, with desired UBST given by Tc = 1.

z0(0) = z1(0) = 1e1

z0(0) = z1(0) = 1e2

z0(0) = z1(0) = 1e4

zz10

(t) (t)

y(t)

y (t)

(Seeber et al., 2020)

Ours- Table 1-(i)

z0 (t) z1 (t) y(t)
y (t)

Ours- Table 1-(iv)

time

time

time

z0 (t) z1 (t) y(t)
y (t)

Fig. 3. Simulation of Example 10, with desired UBST given by Tc = 1. In the first row the algorithm in (Seeber et al., 2020). In the second row, our algorithm with (t) given in Table 1-(i) with  = 1, and L = 1, M = 0.1 and M = 3. In the third row, our algorithm with (t) given in Table 1-(iv) with  = 1,  = 0.1, and L = 1, M = 0.1 and M = 3.

M = 0.1 and M = 3.2. The convergence is observed in the third row of Fig. 3.
It can be verified in Fig. 3 that in our algorithm the slack between the least UBST and the desired one given by Tc is significantly reduced. In addition, the trajectory of the error, the integral of the magnitude of the error correction term H(e0, t; Tc) is shown in the second column of Fig. 4. Notice that in the second row of Fig. 4 that with our approach, the quality of the transient is significantly improved. Moreover, notice in the third row of Fig. 4 that having the degree of freedom to select different classes of TBG gains results in allowing to further reduce the maximum error.

4.3 Robustness to Noisy measurements
Although we show simulations under noise, a formal analysis of our algorithm's filtering properties is considered future work. Notice that after Tc, the results in (Levant and Livne, 2018) can be applied. In the next example, we show numerically the robustness to noise and the precision obtained before Tc.
Consider the redesign method proposed in (AldanaL´opez et al., 2020) using as a base differentiator the algorithm from Seeber et al. (2020). We highlight that, although the TBG gain remains bounded, in the resulting algorithm, the part associated with the homogeneous approximation at the origin (for details on

6

z0(0) = z1(0) = 1e1

z0(0) = z1(0) = 1e1

H(e0, ; Tc) d

(Seeber et al., 2020)

e0 (t) e1 (t)

t 0

H(e0, ; Tc) d

t 0

(Seeber et al., 2020) (Aldana-L´opez et al., 2020) Ours

Ours- Table 1-(iv) Ours- Table 1-(i)

e0 (t) e1 (t)

t 0

H(e0, ; Tc) d

time

e0 (t) e1 (t)

t 0

H(e0, ; Tc) d

time

Fig. 4. Simulation for Example 10, with desired UBST given

by Tc = 1. In the first column: the error signals. In the second

column: the integral of the magnitude of the error correction

term

t t0

H(e0, ; Tc) d.

homogeneous approximation see (Andrieu et al., 2008)),
including the discontinuous part, is multiplied by the
growing TBG gain. On the contrary, notice that in our
approach, the TBG gain is cancel out in term with lowest homogeneity degree in the functions {i}ni=0. As we show in the next example this feature provides better
filtering properties compared to (Aldana-L´opez et al.,
2020). In Addition, we compare against the autonomous
differentiator from Seeber et al. (2020).

Example 11 Let y(t) = 0.75cos(t) + 0.0025sin(10t) + t

with L(t) = L = 1. Consider the differentiator in Seeber

et al. (2020), described in Example 10 with Tc = 1; The

differentiator in (Aldana-L´opez et al., 2020, Example 2)

with Tf = Tc = 1 and  = 3, for the sake of comparison

we set the parameter  in (Aldana-L´opez et al., 2020) to

 = 1, but we switch from the redesigned differentiator to

Levant's differentiator at t = Tc(1 - exp(-Tf ))  0.95

which is an UBST for it. Now, consider our algorithm

with (t) given in Table 1-(i) with  = 3, and let L = 1,

M = 0.1 and M = 3.2. To maintain the TBG bounded

we use the workaround in Remark 8 with T  = 0.95.

Consider a initial condition z0(0) = z1(0) = 10 for each

algorithm. In Fig. 5 we show the integral of the magnitude

of the error correction term

t t0

H(e0, ; Tc) d for each

differentiator, where we can verify that our algorithm

is the one with the lowest value. In Fig. 6, we show a

benchmark under a Gaussian noise with zero mean and

standard deviation , where it can be verified that our

time

Fig. 5. The integral of the magnitude of the error correction

term

t t0

H(e0, ; Tc) d for Example 11.

algorithm has a significant better behavior under noise.

4.4 Comparison for high-order predefined-time exact differentiators

To our best knowledge the only arbitrary-order predefined-time exact differentiator that has been proposed in the literature is our previous work (AldanaL´opez et al., 2020), which is only applied to signals whose (n + 1)-th derivative is bounded by a known constant. We show in the next example that this restriction is not presented in this paper.

Example 12 Consider the differentiator algorithm (2)

with n = 2 and let y(t) = 2 sin

1 2

t2

, which satisfies

|.y..(t)|  L(t)



with L(t) =

1 + 4t6 + 36t2,

1 L(t)

dL(t) dt

 M = 3.5.

Consider our algorithm with (t) given in Table 1-(iii)

with  = 0.01,  = 6 and M = 8. The convergence of

this algorithm for different initial conditions is shown in

the first row of Fig. 7, where Tc = 5. To maintain the (t) bounded, we select T  = 4.5.

Now consider the filtering differentiator (8) with nf = 1 and nd = 1, it is easy to verify that y satisfies

|y¨(t)|  L(t)



with L(t) =

4 + 4t4,

1 L(t)

dL(t) dt

 M = 3.5. Consider

our algorithm with (t) given in Table 1-(iii) with  =

0.01,  = 6 and M = 8; and let the function y(t) be

affected by a white Gaussian noise signal (t) with zero

mean and standard deviation  = 0.5. To maintain the

(t) bounded, we select T  = 4.5. The convergence of this

algorithm for different initial conditions is shown in the

second row of Fig. 7.

7

 = 0.01
(Seeber et al., 2020) (Aldana-L´opez et al., 2020) Ours y(t) + (t)

 = 0.1

 = 0.5

z0 (t)

(Seeber et al., 2020) (Aldana-L´opez et al., 2020)
Ours y (t)

z1 (t)

time

time

time

Fig. 6. Simulation for Example 11 under a Gaussian noise with zero mean and standard deviation , for different values of the standard deviation.

z0(t) = z1(0) = z2(0) = 1e1
z0 (t) z1 (t) z2 (t) y(t) y (t) y¨(t)

z0(t) = z1(0) = z2(0) = 1e2

z0(t) = z1(0) = z2(0) = 1e4

nf = 0, without Noise

w1(0) = z0(0) = z1(0) = 1e1 z0 (t) z1 (t) y(t) + (t) y(t) y (t)

w1(0) = z0(0) = z1(0) = 1e2

w1(0) = z0(0) = z1(0) = 1e4

nf = 1, with Noise

time

time

time

Fig. 7. Simulation of Example 12, with desired UBST given by Tc = 5. In the first row, our algorithm (2) with n = 2. In the second row, our algorithm (8) with nf = 1, nd = 1 and the signal y affected by a white Gaussian noise signal (t) with zero mean and standard deviation  = 0.5.

5 Conclusion
This paper introduced a predefined-time arbitrary-order exact differentiation algorithm for signals whose (n + 1)th derivative has an exponential growth bound. It was shown that by suitable design of the parameters, the achieved Upper Bound of the Settling Time (UBST) is equal to the predefined time.
For the narrower class of signals having a Lipschitz continuous n-th derivative, we show that, compared to autonomous differentiator algorithms, in our approach, the maximum differentiation error is several orders of magnitude lower. Compared to other differentiators based on TBG gains, simulations show that in our approach, zero differentiation error is obtained before the time moment when the singularity in the TBG gain occurs. We show in numerical examples that our has better filtering

properties than state-of-the-art predefined-time differentiators.
As future work we consider the discretization of our algorithm. Discretization of differentiators is an active area of research (Livne and Levant, 2014; CarvajalRubio et al., 2019; Barbot et al., 2020; Wetzlinger et al., 2019). Of particular interest is consistent discretization maintaining the convergence properties (Koch and Reichhartinger, 2019; Polyakov et al., 2019; Jim´enezRodr´iguez et al., 2020).
A Appendix
A.1 Preliminaries on time-scale transformations
The trajectories corresponding to the system solutions of (3) are interpreted, in the sense of differential geome-

8

try (Ku¨hnel, 2015), as regular parametrized curves (Pic´o et al., 2013). Since we apply regular parameter transformations over the time variable, this reparametrization is referred to as time-scale transformation.

Definition 13 (Regular parametrized curve (Ku¨hnel,

2015, Definition 2.1)) A regular parametrized curve,

with parameter t, is a C1(I) immersion c : I  R, de-

fined

on

a

real

interval

I



R.

This

means

that

dc dt

=

0

holds everywhere.

Definition 14 (Regular curve (Ku¨hnel, 2015, Pg. 8))

A regular curve is an equivalence class of regular

parametrized curves, where the equivalence relation is

given by regular (orientation preserving) parameter

transformations , where  : I  I is C1(I), bijec-

tive

and

d dt

>

0.

Therefore,

if

c

:

I



R

is

a

regular

parametrized curve and  : I  I is a regular pa-

rameter transformation, then c and c   : I  R are

considered to be equivalent.

Lemma 15 (Aldana-L´opez et al., 2019) Let (·) sat-

isfy Assumption 4 and let (t) be such -1( ) :=

Tc

 0

()d.

Then,

t

=

-1( )

is

a

parameter

trans-

formation (time-scaling).

A.2 Proofs of the Main Result

Before giving a proof for the main result, consider the following auxiliary result.

Lemma 16 Let := [ 0, . . . , n]T and let (·) and (·, ·, ·) satisfy the conditions of Theorem 5 and let

( ) be a disturbance satisfying |( )|  L( ), and M

such

that

 

>

0,

1 L( )

dL( ) d

 M for all  >  .

Then, the origin of the system

d d = -( 0; M, L( )) + U + B( )
+ ( )-1 d( ) + c Q(c)-1DQ(c) d

(A.1)

is globally finite-time stable.

PROOF. Rewriting system (A.1) using the coordi-

nates

( )

=

( ) L( )

yields

d

1 dL( )

d = -(0; M, 1) - L( ) d  + U 

( ) +B +

( )-1 d( ) + c Q(c)-1DQ(c)

L( )

d

Consider first the nominal (unperturbed) part

d

1 dL( )

( )

d = -(0; M, 1) - L( )

d

 + U + B . L( )

Due

to

|

1 L(

)

dL( d

)

|



M

and

|

( ) L( )

|



1,

its

trajectories

are solutions of the time-invariant inclusion

d d  -(0; M, 1) + U  + [-M, M] + B[-1, 1].
(A.2) According to Theorem 3, this inclusion is finite-time stable. Furthermore, it follows from (Levant and Livne, 2018, Lemma 2) that it is also uniformly exponentially stable, because the constants Qn, Tn in that lemma do not depend on the initial time instant nor on the initial state. Hence, according to (Clarke et al., 1998) there exists a smooth, strong Lyapunov function V1 : Rn+1  R+. Using standard arguments, see (Khalil and Grizzle, 2002, Lemma 9.1), convergence of all trajectories of the perturbed system (A.1) to the origin is hence guaranteed, because the perturbation is linear in and its coefficient is eventually bounded by a sufficiently small constant due to Eq. (6).

To show that also finite-time stability is maintained, consider the homogeneous approximation at the origin of the time-invariant inclusion (A.2) that is obtained by setting M = 0. Being a special case of (A.2), this system is still finite-time stable in addition to having homogeneity degree minus one with respect to the weights (n+1, . . . , 1). It is straightforward to verify that the matrix Q(c) and consequently also the matrix Q(c)-1DQ(c) are lower-triangular by construction. Hence, the lowestdegree homogeneous approximation of the perturbation term Q(c)-1DQ(c) has a degree of at least zero. Finitetime stability is then concluded by applying (Bhat and Bernstein, 2005, Theorem 7.4) and noting that that theorem (and its proof) stay valid also in the time-varying case, as long as the lowest-degree homogeneous approximation (with degree minus one) is time invariant and the time-varying part is uniformly bounded with respect to time.

PROOF.

[Proof of

Theorem

5] Let ei(t) = zi -

di y (t) dti

,

0, . . . , n . The proof is divided in two parts. First we will

show that e0(t) = 0, i = 0, . . . , n, for t  [t^, Tc) for some

time t^. Afterwards, we show that the condition ei(t) = 0,

i = 0, . . . , n is maintained for all t > Tc.

Let := [ 0, . . . , n]T ; e := [e0, . . . , en]T , and define

A(c) := -Q-1(U - D)n+1B[1, 0, . . . , 0].

Then, the dynamic for the differentiation error can be

9

written as:
e = -(t)Q(c)  e0; M, L((t)) - A(c)e + U e - By(n+1)(t)

With the coordinate change = (t)Q(c)-1(t)-1e, and considering that

d(t)-i

(t)i

=

-i(t)-1

d(t) ,

dt

dt

(t)-1U (t) = (t)U and Q(c)-1(t)-1B = (t)-nB. Then, the dynamic of the variable, is given by

 = (t)

Q(c)-1[U

-

(t)-2

d(t) D]Q(c)

dt

- ( 0; M, L((t)))

+ A(c) - (t)-(n+1)By(n+1)(t) , (A.3)

Now, consider the time-scaling given in Lemma 15 and notice that L( ) := L(-1( ))( )-(n+1), where

( )

=

1 ( )-1 Tc

=

(t)|t=-1( )

and L(-1( )) = L(t)|t=-1(). Notice that,

1 dL( )  M ( )-1 - (n + 1)( )-1 d( ) .

L( ) d

d

Thus, if M > (n + 1)c, there exists   such that

1 dL( ) L( ) d

 M, since ( )-1 tends to zero and

(

)-1

d( d

)

tends

to

c

for





.

Then,

d d

=

d dt dt d

t=-1( ) . Since

dt d

t=-1( ) = (t)-1,

for t  [0, Tc), then the dynamics of (A.3) in the  -time

is given by

d = Q(c)-1[U + ( )-1 d( ) + c - c D]Q(c)

d

d

- ( 0; M, L( )) + A(c) - B( ),

Since, Q(c)U = (U - cD)Q(c) + Q(c)A(c), then Q(c)-1[U - cD]Q(c) = U - A(c), and

d d = -( 0; M, L( )) + U + B( )
+ ( )-1 d( ) + c Q(c)-1DQ(c) , d

(A.4)

which according to Lemma 16, system (A.4) is finitetime stable and has a settling time function T ( (0)). Using Lemma 15, we can conclude that the settling-time function of (3) is

T ( (0))

T (e(0)) = lim ( ) = Tc

 T ( (0))

0

()d(.A.5)

Thus,

sup T (e(0))  Tc.
e(0)Rn+1

(A.6)

Then, ei(t) = 0, i = 1, . . . , n for t  [t^, Tc), where t^ = Tc 1 - exp(-T ( (0))) . Moreover, it follows

from (A.5), that the equality in (A.6) holds when supe(0)Rn+1 T (e(0)) = .

The second part of the proof follows trivially from The-
orem 3, because, for all t  Tc, the differentiation error dynamics is given by system (5).

References
R. Aldana-Lo´pez, D. Go´mez-Guti´errez, E. Jim´enezRodr´iguez, J. D. Sa´nchez-Torres, and M. Defoort. On the design of new classes of fixed-time stable systems with predefined upper bound for the settling time. arXiv preprint arXiv:1901.02782 v2, 2019.
R. Aldana-Lo´pez, D. Go´mez-Guti´errez, M. T. Angulo, M. Defoort, and R. Seeber. Designing predefined-time differentiators with bounded time-varying gains. Submitted to IEEE Transactions on Automatic Control, 2020.
H. Alwi, C. Edwards, and C. P. Tan. Fault Detection and Fault-Tolerant Control Using Sliding Modes. Advances in industrial control, 2011.
V. Andrieu, L. Praly, and A. Astolfi. Homogeneous approximation, recursive observer design, and output feedback. SIAM Journal on Control and Optimization, 47(4):1814­ 1850, 1 2008. ISSN 03630129.
M. T. Angulo, J. A. Moreno, and L. Fridman. Robust exact uniformly convergent arbitrary order differentiator. Automatica, 49(8):2489­2495, 2013. ISSN 00051098.
J. P. Barbot, A. Levant, M. Livne, and D. Lunz. Discrete differentiators based on sliding modes. Automatica, 112: 108633, 2 2020. ISSN 00051098.
F. J. Bejarano, A. Pisano, and E. Usai. Finite-time converging jump observer for switched linear systems with unknown inputs. Nonlinear Analysis: Hybrid Systems, 5 (2):174­188, 5 2011. ISSN 1751570X.
S. P. Bhat and D. S. Bernstein. Geometric homogeneity with applications to finite-time stability. Mathematics of Control, Signals, and Systems, 17(2):101­127, 6 2005. ISSN 09324194.
J. E. Carvajal-Rubio, A. G. Loukianov, J. D. Sanchez-Torres, and M. Defoort. On the discretization of a class of homogeneous differentiators. In International Conference on Electrical Engineering, Computing Science and Automatic Control, CCE 2019. IEEE, 9 2019. ISBN 9781728148403.
J. E. Carvajal-Rubio, J. D. Sa´nchez-Torres, M. Defoort, and A. G. Loukianov. On the Discretization of Robust Exact

10

Filtering Differentiators. In 21st IFAC World Congress 2020 - 1st Virtual IFAC World Congress (IFAC-V 2020), 2020. Y. Chitour, R. Ushirobira, and H. Bouhemou. Stabilization for a perturbed chain of integrators in prescribed time. SIAM Journal on Control and Optimization, 58(2):1022­ 1048, 4 2020. ISSN 03630129. F. H. Clarke, Y. S. Ledyaev, and R. J. Stern. Asymptotic Stability and Smooth Lyapunov Functions. Journal of Differential Equations, 149(1):69­114, 10 1998. ISSN 00220396. E. Cruz-Zavala and J. A. Moreno. Levant's arbitrary-order exact differentiator: A Lyapunov approach. IEEE Transactions on Automatic Control, 64(7):3034­3039, 2019. ISSN 15582523. E. Cruz-Zavala, J. A. Moreno, and L. M. Fridman. Uniform robust exact differentiator. IEEE Transactions on Automatic Control, 56(11):2727­2733, 11 2011. ISSN 00189286. A. Ferreira De Loza, J. Cieslak, D. Henry, A. Zolghadri, and L. M. Fridman. Output tracking of systems subjected to perturbations and a class of actuator faults based on HOSM observation and identification. Automatica, 59: 200­205, 9 2015. ISSN 00051098. A. F. Filippov. Differential equations with discontinuous righthand sides. Dordrecht: Kluwer Academic Publishers, 1988. L. Fridman, Y. Shtessel, C. Edwards, and X. G. Yan. Higherorder sliding-mode observer for state estimation and input reconstruction in nonlinear systems. International Journal of Robust and Nonlinear Control, 18(4-5):399­412, 3 2008. ISSN 10498923. L. Fridman, J. Davila, and A. Levant. High-order slidingmode observation for linear systems with unknown inputs. Nonlinear Analysis: Hybrid Systems, 5(2):189­205, 5 2011. ISSN 1751570X. D. Go´mez-Guti´errez, C. R. Va´zquez, S. C elikovsky´, A. Ram´irez-Trevin~o, and B. Castillo-Toledo. On the distinguishability and observer design for single-input singleoutput continuous-time switched affine systems under bounded disturbances with application to chaos-based modulation. European Journal of Control, 34:49­58, 3 2017. ISSN 09473580. J. Holloway and M. Krstic. Prescribed-time observers for linear systems in observer canonical form. IEEE Transactions on Automatic Control, 64(9):3905­3912, 2019. ISSN 15582523. H. Imine, L. Fridman, H. Shraim, and M. Djemai. Observation and identification via HOSM-observers. Lecture Notes in Control and Information Sciences, 414:5­24, 2011. E. Jim´enez-Rodr´iguez, R. Aldana-Lo´pez, J. D. Sa´nchezTorres, D. Go´mez-Guti´errez, and A. G. Loukianov. Consistent Discretization of a Class of Predefined-Time Stable Systems. In IFAC World Congress, 2020. H. K. Khalil and J. W. Grizzle. Nonlinear systems, volume 3. Prentice hall Upper Saddle River, 2002. S. Koch and M. Reichhartinger. Discrete-time equivalents of the super-twisting algorithm. Automatica, 107:190­199, 9 2019. ISSN 00051098. W. Ku¨hnel. Differential geometry, volume 77. American Mathematical Soc., 2015. A. Levant. Robust Exact Differentiation via Sliding Mode Technique. Automatica, 34(3):379­384, 3 1998. ISSN 00051098. A. Levant. Higher-order sliding modes, differentiation and output-feedback control. International journal of Control,

76(9-10):924­941, 2003. A. Levant and M. Livne. Exact differentiation of signals
with unbounded higher derivatives. IEEE Transactions on Automatic Control, 57(4):1076­1080, 4 2012. ISSN 00189286. A. Levant and M. Livne. Globally convergent differentiators with variable gains. International Journal of Control, 91 (9):1994­2008, 9 2018. ISSN 13665820. A. Levant and M. Livne. Robust exact filtering differentiators. European Journal of Control, 55:33­44, 8 2020. ISSN 09473580. M. Livne and A. Levant. Proper discretization of homogeneous differentiators. Automatica, 50(8):2007­2014, 8 2014. ISSN 00051098. T. M´enard, E. Moulay, and W. Perruquetti. Fixed-time observer with simple gains for uncertain systems. Automatica, 81:438­446, 2017. ISSN 00051098. P. Morasso, V. Sanguineti, and G. Spada. A computational theory of targeting movements based on force fields and topology representing networks. Neurocomputing, 15(3-4): 411­434, 6 1997. ISSN 09252312. J. A. Moreno. Levant's Arbitrary Order Differentiator with Varying Gain. IFAC-PapersOnLine, 50(1):1705­1710, 7 2017. ISSN 24058963. J. A. Moreno. Exact differentiator with varying gains. International Journal of Control, 91(9):1983­1993, 9 2018. ISSN 13665820. T. R. Oliveira, A. Estrada, and L. M. Fridman. Global and exact HOSM differentiator with dynamic gains for outputfeedback sliding mode control. Automatica, 81:156­163, 7 2017. ISSN 00051098. A. K. Pal, S. Kamal, S. K. Nagar, B. Bandyopadhyay, and L. Fridman. Design of controllers with arbitrary convergence time. Automatica, 112, 2 2020. ISSN 00051098. J. Pico´, E. Pico´-Marco, A. Vignoni, and H. De Battista. Stability preserving maps for finite-time convergence: Supertwisting sliding-mode algorithm. Automatica, 49(2):534­ 539, 2013. ISSN 00051098. A. Polyakov, D. Efimov, and B. Brogliato. Consistent discretization of finite-time and fixed-time stable systems. SIAM Journal on Control and Optimization, 57(1):78­103, 1 2019. ISSN 03630129. R. Aldana-Lo´pez, D. Go´mez-Guti´errez, M. A. Trujillo, M. Navarro-Guti´errez, J. Ruiz-Leo´n, and H. M. Becerra. A predefined-time first-order exact differentiator based on time-varying gains. Submitted to International Journal of Robust and Nonlinear Control, 2020. M. Reichhartinger and S. Spurgeon. An arbitrary-order differentiator design paradigm with adaptive gains. International Journal of Control, 91(9):2028­2042, 9 2018. ISSN 13665820. M. Reichhartinger, S. K. Spurgeon, M. Forstinger, and M. Wipfler. A Robust Exact Differentiator Toolbox for Matlab®/Simulink®. IFAC-PapersOnLine, 50(1):1711­ 1716, 7 2017. ISSN 24058963. H. R´ios and A. R. Teel. A hybrid fixed-time observer for state estimation of linear systems. Automatica, 87:103­ 112, 1 2018. ISSN 00051098. H. R´ios, S. Kamal, L. Fridman, and A. Zolghadri. Fault tolerant control allocation via continuous integral slidingmodes: A HOSM-Observer approach. Automatica, 51:318­ 325, 1 2015. ISSN 00051098. V. H. P. Rodrigues and T. R. Oliveira. Global adaptive HOSM differentiators via monitoring functions and hy-

11

brid state-norm observers for output feedback. International Journal of Control, 91(9):2060­2072, 9 2018. ISSN 13665820. T. Sanchez, J. A. Moreno, and F. A. Ortiz-Ricardez. Construction of a Smooth Lyapunov Function for the Robust and Exact Second-Order Differentiator. Mathematical Problems in Engineering, 2016, 2016. ISSN 15635147. R. Seeber, H. Haimovich, M. Horn, L. Fridman, and H. De Battista. Exact differentiators with assigned global convergence time bound. arXiv preprint arXiv: 2005.12366, 5 2020. Y. Shtessel, C. Edwards, L. Fridman, and A. Levant. Observation and Identification via HOSM Observers. pages 251­290. Birkha¨user, New York, NY, 2014. Y. Song, Y. Wang, J. Holloway, and M. Krstic. Time-varying feedback for regulation of normal-form nonlinear systems in prescribed finite time. Automatica, 83:243­251, 9 2017. ISSN 0005-1098. M. Wetzlinger, M. Reichhartinger, M. Horn, L. Fridman, and J. A. Moreno. Semi-implicit Discretization of the Uniform Robust Exact Differentiator. In Proceedings of the IEEE Conference on Decision and Control, volume 2019-Decem, pages 5995­6000. Institute of Electrical and Electronics Engineers Inc., 12 2019. ISBN 9781728113982.
12

