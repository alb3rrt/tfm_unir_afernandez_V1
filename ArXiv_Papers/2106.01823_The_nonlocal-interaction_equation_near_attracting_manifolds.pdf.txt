THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS
FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

arXiv:2106.01823v1 [math.AP] 3 Jun 2021

ABSTRACT. We study the approximation of the nonlocal-interaction equation restricted to a compact manifold M embedded in Rd, and more generally compact sets with positive reach (i.e. prox-regular sets). We show that the equation on M can be approximated by the classical nonlocal-interaction equation on Rd by adding an external potential which strongly attracts to M. The proof relies on the Sandier­Serfaty approach [23,24] to the -convergence of gradient flows. As a by-product, we recover well-posedness for the
nonlocal-interaction equation on M, which was shown [10]. We also provide an another approximation to the interaction equation on M, based on iterating approximately solving an interaction equation on Rd and projecting to M. We show convergence of this scheme, together with an estimate on the rate of convergence.
Finally, we conduct numerical experiments, for both the attractive-potential-based and the projection-based
approaches, that highlight the effects of the geometry on the dynamics.

1 Introduction

We consider a continuum first-order model for the nonlocal-interaction of agents constrained to move within a compact manifold M embedded in Euclidean space Rd. While the locations of the agents are restricted to M the interaction forces act in the ambient space.
Although for simplicity we shall often call M a manifold, our setup actually allows for arbitrary sets with positive reach which include manifolds with boundaries and with outside corners. When M has full dimension, what we are studying is in fact an aggregation model with no-flux boundary conditions. The interaction is modeled via a smooth pairwise potential which can feature distinct regimes of repulsion and attraction, depending on the Euclidean distance that separates any pair of agents. The setting in which we consider our solutions and equations is that of gradient flows (curves of maximal slope) in the spaces of probability measures endowed with Wasserstein metric. We base our work on the theory developed in [4, 23, 24].
Let us describe further our problem and motivate it by reviewing recent relevant works. We then present our notation, assumptions and main results.

1.1 Description of the problem and motivation

The nonlocal-interaction equation on a compact manifold M embedded in Rd that we study is given by

(1)

t + div(u) = 0,

on M,

u = PM(-W  ),

where W : Rd  R is an interaction potential and PM is the generalization of the projection on the tangent space of M, defined precisely in (7). Here, the unknown   P(M) is a Borel probability measure supported on M. When M is d-dimensional, this problem is the interaction equation on M with
no-flux boundary conditions.
Note that the gradient and convolution operators are Euclidean, i.e., with respect to the ambient space Rd, and not intrinsic to M. In particular, the convolution in (1) is given by

(2)

W  (x) = W (x - y) d(y) for all x  M.

M

Date: June 4, 2021. 1

2

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

This is an important point to bear in mind as it means that (1) is a mixed formulation, where any two point masses on M "see" each other and interact according to the Euclidean distance while their motion
is restricted to the manifold (via the projection operator). This mixed formulation (1) has already been studied in [10, 25]. In [25] the authors observe that, when M is d-dimensional and has C2 boundary, this
formulation is the gradient flow of the interaction energy

(3)

E() =

1 2

M

M W (x - y) d(y) d(x)

if   P(M),



otherwise,

on the space P(M) endowed with Wasserstein metric. In particular the steepest descent vector, denoted here -gradE() at a given configuration   P (M), satisfies

(4)

-grad E() = PM(-W  ).

We remark that adding a mobility matrix A in (1), which models the space heterogeneity, can be done without difficulty, changing (4) into -grad E() = PM(-AW  ); see [25]. In [25], the tangent vectors of the gradient flow formulation for the energy E are vectors in Rd equipped with the associated
Riemannian inner product. Note that, in a similar fashion, although without restriction to a subset, a Fokker­Planck equation in Rd with the mobility being the inverse of the metric tensor of a Riemannian
manifold was studied in [19].
In [10] the authors extend the study of the well-posedness of this formulation to more general subsets of Rd. One main difficulty with this extension is to use an appropriate notion of projection of vector fields on M. When M is a smooth d-dimensional manifold as in [25], the projection of a vector v  Rd at a point x  M is the identity when x  int(M) or x  M and v points into M, i.e., v belongs to the inward sector TxinM of TxM at x, and is the projection of v to TxM  TxinM when x  M and v does not point into M. Note that when x  int(M) we actually have TxinM = TxM and TxinM is thus a linear vector space; in general, for any x  M, we have TxinM  TxM. If we want to consider domains that are either lower-dimensional or present boundaries with corners, the set of tangent vectors "pointing into M" (the inward sector) used to define the projection on a smooth manifold needs to be updated. To this end, the authors in [10] extend the theory to prox-regular, or positive-reach, subsets of Rd for which
inward tangent vectors are elements of Clarke tangent cones; see definitions in Section 1.2. Prox-regular
sets extend significantly the variety of domains that can be studied; indeed, these include sets with outside
corners and cusps in their boundaries. They can also be of dimension strictly less than d. A prox-regular
set is a set with a tubular neighborhood whose every point has a unique closest point on the boundary of
the set, i.e., a unique projection on the boundary. The radius of the largest such tubular neighborhood is
called the reach of the set. Prox-regular sets are therefore also referred to as sets with positive reach. Note that convex sets are sets of infinite reach. Since we shall often refer to the reach of M in the following,
we prefer here to use the terminology "positive-reach" over "prox-regular".

1.1.1 Dynamics on M as a limit of dynamics on Rd with confining potential. One goal of our paper,
which we achieve in Section 2, is to show that solutions to the problem in (1) on the set of positive reach M can be approximated by solutions to the following problem on all of Rd:

(5)

t + div(u) = 0,

u

=

-W





-

1 

d2M,

on Rd,

as

the

parameter



goes

to

0,

where

dM

is

the

distance

to

the

set

M.

The

term

1 

d2M

plays

herethe

role

of a confinement potential, making it expensive for the particles to lie at distances greater than  away

from M.

A similar problem has been analyzed in [2], where the authors consider local diffusion and a confinement

potential in addition to the nonlocal-interaction potential, and thus study a nonlinear, nonlocal Fokker­ Planck equation on M with no-flux boundary conditions. Although their interaction potentials are allowed

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

3

to be less regular than ours, the sets they consider have to be d-dimensional and connected, which is not
our case. In this context, the authors show that the weak formulation for the Fokker­Planck equation on M can be approximated by the weak formulation on Rd obtained by continuously extending the confinement potential from M to all of Rd in such a way that the potential blows up outside of a tubular neighborhood of M as this neighborhood shrinks to M. Furthermore, their diffusion term needs to be nonzero since their convergence analysis is based on L2 estimates, which differs from our gradient flow
approach allowing us to consider nonlocal interaction on its own. Indeed, by regarding our solutions as
curves of maximal slope for the respective energies (3) and

1 E() = 2

Rd

W (x - y) d(y) d(x) + 1

Rd



d2M(x) d(x)
Rd

for all   P(Rd),

we are able to use the Sandier­Serfaty result [23, 24] for the -convergence of gradient flows to show the

convergence of our approximating model (5) to the model on M given in (1).

1.1.2 Dynamics on M as a limit of an iterative propagattion­projection scheme. An alternative
approach to considering (5) in order to approximate solutions to (1) is using the flow map of the solution to the classical interaction equation on Rd, i.e.,

(6)

tµ + div(µu) = 0, u = -W  µ,

on Rd.

We recall that this flow map is defined as the map  : [0, ) × Rd  Rd such that, for all x0  Rd, we

have

d dt

t(x0)

=

u(t(x0),

t),

0(x0) = x0.

Then, the solution µ to (6) is given by

µ(t) = (t)#0 for all t 0,

that is, the solution µ is the pushforward of the initial condition 0  P(Rd) through the flow map ; see [4]. (Note that here, because of the nonlocality of the interaction velocity field, the flow map may

depend on the solution itself so that the previous equation may in fact be an implicit formulation of the

solution; we refer the reader to [5, 7] for the existence and uniqueness of explicit pushforward solutions to the interaction equation on Rd.)
We define the approximation scheme by: for n 0 and small enough time step  > 0

0 = 0, n+1 = (M)#(( )#n )
where M is the projection to M. The prox-regularity of M and choosing  small enough ensures that the projection is unique. By interpolating we build a curve of probability measures supported on M which we show converges to a solution to (1) as the size of the time step size vanishes. Our second goal in this paper is to show such convergence, which we do in Section 3.
Let us also remark that there is an interesting problem related to (1) where one studies the fully intrinsic version, where agents on M interact according to the intrinsic metric of M rather than the ambient Euclidean space and therefore "see" each other along the manifold. In [13­15], the well-posedness theory and long-time behavior (giving rise to asymptotic consensus), as well as numerical experiments, for the fully intrinsic model on the hemisphere, the hyperboloid and the special orthogonal group are carried out. There, the authors consider the case where the gradient and convolution operators are all defined with respect to the manifold M; in particular, (2) is replaced by

W g (x) = W (dg(x, y)) d(y) for all x  M,
M

4

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

where dg is the intrinsic, or geodesic, metric on M. There, the obstacles are the lack of convexity of d2g on subsets of M that are not geodesically convex and the difficulty to compare vectors in different tangent spaces in order to prove Lipschitz continuity of the velocity field for the resolution of the characteristic equations solved by flow maps. We also refer the reader to [1, 17, 18] and the references therein for second-order swarming models on the sphere and the hyperboloid.

1.2 Notation and assumptions
The functional context in which we study solutions to (1) and (5) is that of probability measures. We denote by P(Rd) the set of Borel probability measures on Rd and P2(Rd) the subset of P(Rd) of measures with finite second moment. We endow P2(Rd) with the (quadratic) Wasserstein distance denoted by d2: for all 0, 1  P2(Rd) we define

d2(0, 1) = inf
(0,1)

|x - y|2 d(x, y),
Rd×Rd

where (0, 1) is the set of transport plans from 0 to 1. That is, (0, 1) is the set of Borel probability measures on Rd × Rd with first marginal 0 and second marginal 1.
Let M  Rd satisfy the following assumption:
Assumption 1.1. M is a compact subset of Rd with positive reach, denoted M.
For instance, M can be a manifold with C2 boundary; it can also be a lower-dimensional object, such as a circle in R2 or even a manifold with outside corners as a rectangular sheet in R3. We write P(M) the subset of P(Rd) of measures supported in M; since M is compact we actually have P(M)  P2(Rd).
For all x  M, the projection operator PM(x), used in (1), maps the vectors in Rd to "tangent" vectors to M. For v  Rd it is defined by

(7)

PM(x)(v)

=

{w



TxinM

|

|v - w|

=

inf |v
uTxin M

- u|},

where TxinM is the Clarke tangent cone of M at x, whose definition is

TxinM = v  Rd |  (tn)n  0+,  M  (xn)n  x,  Rd  (vn)n  v, s.t.  k, xk + tkvk  M .

So PM(x) is the projection on the Clarke tangent cone at x. Because this tangent cone is always a closed and convex subset of Rd, the projection in (7) is always a singleton, so that PM(x) : Rd  TxinM. Using this projection in (1), we ensure that particles moving according to (1) do not leave M. We notice, as expected, that when M is a C1 manifold without boundary the Clarke tangent cone coincides with the
classical linear tangent space, in which case the above projection can be rewritten as

PM(x)(v) =

v

if v  TxM,

TxM(v) otherwise,

where TxM : Rd  TxM is the projection on TxM, since in this case TxinM = TxM. For any given functional F : P(Rd)  (-, ] we write dom(F ) its domain, i.e., dom(F ) = {µ 
P(Rd) | F (µ) < }, and we say that F is proper if dom(F ) = . We define the interaction energy E : P2(Rd)  (-, ] for all   P2(Rd) by

(8)

E() =

1 2

M W  (x) d(x)

if   P(M),



otherwise,

where W : Rd  R is an interaction kernel verifying the assumption below:

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

5

Assumption 1.2. W is of class C2, is symmetric, semiconvex, bounded from below, and has at-mostquadratic growth at infinity.

Because W is continuous and M is compact, the domain of E satisfies dom(E) = P(M). We also define, for all  > 0, the -interaction energy E : P2(Rd)  (-, ] by

(9)

1 E() = 2

W  (x) d(x) + 1

Rd



d2M(x) d(x)
Rd

for all   P2(Rd),

where dM(x) denotes the distance of any point x  Rd to M. As already mentioned above, the -

dependent part of this energy plays the role of a confinement potential. Because W has at-most-quadratic growth at infinity and Rd d2M(x) d(x) <  for all   P2(Rd), we have dom(E) = P2(Rd). Note that the condition on the at-most-quadratic growth at infinity on W is not restrictive our case, since our

interest lies in what happens within the compact set M or within bounded regions containing M.

We study (1) and its approximation (5) as the gradient flows for the respective energies (8) and (9). We

refer the reader to [4] for an extensive theory of gradient flows, and only introduce the definitions we shall need here in order to prove our main results. We write AC2([0, ); P2(Rd)) the set of 2-absolutely continuous curves from [0, ) to P2(Rd), that is, we write   AC2([0, ); P2(Rd)) if there exists a function m  L2(0, ) such that

t

d2((s), (t))

m(r) dr for all 0 s t.

s

Given F : P2(Rd)  (-, ] proper, a function g : P2(Rd)  [0, ] is said to be a strong upper gradient for F if for every   AC2([0, ); P2(Rd)) the map g   is Borel measurable and

|F ((t)) - F ((s))|

t
g(( ))| |( ) d for all 0  s  t,
s

where | | is the metric derivative of , that is,

|

|(t)

=

lim
h0

d2((t), (t |h|

+

h))

for all t

0,

and a curve   AC2([0, ); P2(Rd)) is a curve of maximal slope for F with respect to its strong upper gradient g if and only if t  F (t) is nonincreasing and

F ((t)) - F ((s)) + 1

t
g(( ))2 + | |( )2 d

0 for all 0  s  t.

2s

Also, the local slope of F is defined as

 

lim

sup

(F

()

-

F

(µ))+

|F |() = µ

d2(, µ)



for all   dom(F ), otherwise,

where the subscript + denotes the positive part. It can be checked that strong upper gradients for the
interaction energies E and E, for any  > 0, are given by their respective local slopes |E| and |E|, which are also semiconvex and narrowly lower semicontinuous thanks to our assumptions on the interaction kernel W ; see [4]. Recall that the narrow topology on P(Rd) is given by the following definition: we say that a sequence (n)n  P(Rd) converges narrowly to some   P(Rd) if

f (x) dn(x)  f (x) d(x) as n   for all f : Rd  R continuous and bounded.

Rd

Rd

Following the Sandier­Serfaty theory, we consider gradient flows as curves of maximal slopes with respect

to local slopes. Accordingly, we have the following definition:

6

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

Definition 1.3 (gradient flow). We say that a curve in AC2([0, ); P2(Rd)) is a gradient flow for E (respectively, E) if it is a curve of maximal slope with respect to |E| (respectively, |E|). For convenience, we shall sometimes refer to gradient flows for E as -gradient flows.
1.3 Main results
The first main result establishes that the gradient flow of E, i.e., (5), converges as   0 to the gradient flow of E, i.e., (1).
Theorem 1.4 (-gradient flow scheme). ConsiderM satisfying Assumption 1.1 and a potential W satisfying Assumption 1.2. Let 0  P(M). For  > 0, let   AC2([0, ); P2(Rd)) be an -gradient flow such that (0) = 0 for some 0  P2(Rd). Assume that d2(0, 0)  0 and lim sup E(0) E(0) as   0. Then there exists   AC2([0, ); P2(Rd)) such that (0) = 0, (t)  P(M) and d2((t), (t))  0 as   0 for all t 0, and such that  is a gradient flow for E.
Theorem 1.4 contains a compactness part, in which we prove that any -gradient flow has a limit, and a convergence part, where we prove that this limit is indeed a gradient flow for E. We prove the convergence part of the main result using the Sandier­Serfaty approach, which we recall in Theorem 2.4. We note that while each of the energies E is semiconvex, the semiconvexity diverges to - as   0, so the convergence does not follow directly from stability of gradient flows. On the other hand, -gradient flows exist thanks to the semiconvexity and quadratic growth at infinity of the interaction potential W (cf. [12, Corollary 3.2] for instance). Hence the above theorem ensures the existence of gradient flows for the energy in E given in (3). This fact was already proved in [10] via a more classical tool, namely differential inclusion theory. For completeness here, we recall a stability result from [10] in Proposition 2.9, which proves uniqueness.

The second question we answer is whether one can use the full-space equation (6) to approximate the projected version (1). We show this is indeed the case: Theorem 1.5 (projected gradient flow scheme). ConsiderM satisfying Assumption 1.1 and a potential W satisfying Assumption 1.2. Let 0  P(M). For all t 0, let t : Rd  Rd be the flow map associated to the Rd nonlocal-interaction equation (6) and let   AC2([0, ), P(M)) be the gradient flow for E, i.e. the solution of (1), with initial condition (0) = 0. Define, for any positive integer n and time step  > 0 small enough,
0 = 0, n+1 = (M)#(( )#n ),
where r < M and M : Mr  M is the projection on the set M from the r-neighborhood Mr := {x  Rd | dM(x) < r} of M. Define the interpolation

 (0) = 0,  (t) = (M)#((t-n )#n ) for all t  (n, (n + 1) ].
Then, for all t 0 we have d2( (t), (t))  0 as   0. The proof of Theorem 1.5 is based on an estimate of the rate of convergence of the approximating
sequence ( ) to the solution  to (1), which turns out to be linear in the time step size  . Furthermore, what is meant by any time step size "small enough" will be made clear in the proof.
In the following, we present the proofs of Theorems 1.4 and 1.5 in Sections 2 and 3, respectively, and our numerical experiments in Section 4. Our code is fully accessible on our GitHub repository [21].

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

7

2 -gradient flow scheme (proof of Theorem 1.4)

2.1 -convergence

Before giving the core of the proof of Theorem 1.4, we show the -convergence of the -energy E towards E as   0. This result is used throughout the paper.
Lemma 2.1. The sequence (E) -converges to E with respect to the narrow topology as   0.

Proof. We first show the liminf inequality and then the limsup inequality.
Step 1: liminf inequality. Let   P2(Rd) and () be a sequence in P2(Rd) such that   narrowly as   0. We want to show

lim inf
0

E()

E().

Suppose first that supp()  M. We have E()

1 2

Rd W  (x) d(x), by the continuity and

boundedness from below of W and the Portmanteau theorem (cf. [6, Theorem 2.1]),

lim inf
0

W  (x) d(x)
Rd

W  (x) d(x) = W  (x) d(x).

Rd

M

Hence,

lim inf
0

E()

1 W  (x) d(x) = E(). 2M

Suppose now that supp()  M. We have E() continuity and boundedness from below of d2M, we

1 
have,

Rd
by

dM(x)2 d(x) the Portmanteau

because W theorem,

0. Also, by

lim inf
0

dM(x)2 d(x)
Rd

dM(x)2 d(x) > 0,
Rd

which

yields

1 

Rd dM(x)2 d(x)   as   0, and so

lim
0

E()

=



=

E

().

Step 2: limsup inequality. Let   P2(Rd). We want to show that there exists (), a sequence in P2(Rd), such that   narrowly as   0 and
lim sup E() E().
0
Choose the constant sequence () given by  =  for all  > 0. Suppose first that supp()  M. Then Rd dM(x)2 d(x) = 0 for all  > 0. Therefore E() = E() which trivially implies the limsup inequality. Suppose now that supp()  M. As for the liminf inequality we conclude that

lim
0

E()

=



=

E

().

As an interesting corollary of the -convergence we have the following.

Lemma 2.2. For all  > 0 there exists a minimizer  of E. Moreover,  converges in Wasserstein metric, along a subsequence, to some   P(M), which is a minimizer of E.

Proof. Let us first prove the existence of  for all  > 0. Let  > 0 and let (n )n  P2(Rd) be a minimizing sequence for E. Because E E is proper, we then know there exists A > 0, independent of n, such that E(n ) A for all n  N large enough. Choose any such n. Note that by the definition of dM we have dM(x) + LM |x|, so that dM(x)2 |x|2 - 2LM|x| for all x  Rd, where LM is the diameter of M. Therefore, by the nonnegativity of W and Jensen's inequality,

A

E(n )

1 

|x|2 dn (x) - 2LM |x| dn (x)

Rd

Rd

8

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

1 

|x|2 dn (x) - 2LM
Rd

|x|2 dn (x)
Rd

1 

|x|2 dn (x) - 2LM
Rd

2 - 4L2M . 

This shows that the second moment of n is uniformly bounded in n. By Prokhorov's theorem we deduce the existence of   P2(Rd) such that, up to a subsequence, n  narrowly as n  . By narrow lower semicontinuity of E (since W and dM are continuous and bounded from below; see again the Portmanteau theorem) we therefore get that  is a minimizer of E.
Let us now prove the existence of  so that   narrowly as   0. Pick µ  P(M). By the -convergence of (E) and the minimality of () we know there exists (µ)  P2(Rd) such that µ µ narrowly as   0 and

lim sup E() lim sup E(µ) E(µ) < .

0

0

Therefore, there exists A0 > 0, independent of , such that E() A0 for all  > 0 small enough. Choose any such . By a similar argument as above, assuming without loss of generality that  < 1, we

have
2

A0 E()

|x|2 d(x) - 2LM - 4L2M,
Rd

from which we get the existence of M0 > 0 such that

(10)

|x|2 d(t, x) M0 for all t 0.

Rd

This shows that the second moment of  is bounded from above uniformly in . By Prokhorov's theorem we deduce the existence of   P2(Rd) such that   as   0 along a subsequence. By narrow

-convergence, we obtain

E()

lim inf
0

E ( )

lim sup E()
0

lim sup E(µ)
0

E(µ) < .

Hence   dom(E) = P(M) and  is a minimizer of E. Finally, by (10) and [4, Proposition 7.1.5], we also conclude that d2(, )  0.

2.2 Compactness

We give here the proof of the compactness part of Theorem 1.4. Lemma 2.3. Let () and 0 be as in Theorem 1.4. Then there is   AC2([0, ); P2(Rd)) such that (0) = 0, (t)  P(M) for all t 0 and, along a subsequence,

d2((t), (t))  0 for all t 0 as   0.

We remark that once we show the remainder of Theorem 1.4 we will know that  is a solution to an initial-value problem for (5). Since then, by Proposition 2.9, the solutions are unique, we will conclude that in fact d2((t), (t))  0 as   0 in Lemma 2.3, not just along a subsequence.

Proof of Lemma 2.3. Since lim sup E(0) E(0) <  as   0 there exists a constant A0 > 0, independent of  and t, such that E(0) A0 for all  > 0 small enough. Choose any such . By decreasing monotonicity of the energy E along  (because  is a curve of maximal slope for E with respect to the strong upper gradient |E|), this implies

E((t)) A0 for all t 0.

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

9

By a similar argument to that given in the proof of Lemma 2.2, letting again  < 1, we have

2

A0 E((t))

|x|2 d(t, x) - 2LM - 4L2M,
Rd

where we recall that LM is the diameter of M. This proves there exists M0 > 0, independent of  and t, such that

(11)

|x|2 d(t, x) M0 for all t 0.

Rd

Now, by the evolution variational inequality [4, Theorem 5.3(iii)] thanks to the semiconvexity of W , we

have, for all 0  t,

d22((t), ( ))

t
2 (E(( )) - E((s))) ds
 t
2 (E(0) - E((t))) ds

2E(0)(t -  ) 2A0(t -  ),

where we used that E 0; by swapping t and  when 0 t <  , we get d22((t), ( )) 2A0|t -  | for all t,  0.

This, together with (11), Prokhorov's theorem and the Arzela`­Ascoli theorem as given in [4, Proposition 3.3.1], implies that there exists   C([0, ]; P2(Rd)) such that, up to a subsequence, (t) (t) narrowly as   0 for all t 0. By (11) and [4, Proposition 7.1.5] it follows that, in fact, d2((t), (t))  0 as   0 for all t 0. To show that (0) = 0 we simply use the triangle inequality:

d2((0), 0) d2((0), 0) + d2(0, 0) = d2((0), (0)) + d2(0, 0)  0 as   0.

By the narrow -convergence of (E) we deduce that

 > A0

lim inf
0

E((t))

E((t)) for all t

0,

which shows that (t)  dom(E) = P(M) for all t 0. We finally need to show that  is actually a curve in AC2([0, ); P2(Rd)). This part is based
on [11, Theorem 5.6]; see also [9, Lemma 4.3]. Fix any t 0. We have

t
||(s)2 ds = E(0) - E((t)) A0.
0

Then, up to a subsequence, lim0

t 0

||(s)2

ds

=

C for some t-independent C

0. Therefore

|| is bounded in L2([0, t]) and so, up to a further subsequence, it is L2-weakly convergent to some

v  L2([0, t]). It is then also L1-weakly convergent to v, so that

t

t

lim
0



||(s) ds =

v(s) ds


for all 0



t.

We also know that, by definition of the metric derivative and  being 2-absolutely continuous,

d2(( ), (t))

t
||(s) ds.


Then, by the narrow lower semicontinuity of d2 (see [3, Proposition 2.5]), sending   0 yields

t

(12)

d2(( ), (t))

v(s) ds,



which implies that   AC2([0, ); P2(Rd)).

10

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

2.3 Convergence

We now present the proof of the convergence part of Theorem 1.4. Let us recall the result by Sandier­ Serfaty on which we base our proof:

Theorem 2.4 (Sandier­Serfaty). For all  > 0, let   AC2([0, ); P2(Rd)) be an -gradient flow such that (0) = 0 for some 0  P2(Rd). Assume that d2((t), (t))  0 as   0 for all t 0 for some   AC2([0, ); P2(Rd)) such that 0 := (0)  P(M) and lim sup E(0) E(0) as   0. Furthermore, suppose that the following conditions hold for all t 0:

t

(C1) lim inf
0

||d2 (s)2 ds
0

t
| |d2(s)2 ds.
0

(C2)

lim inf
0

E((t))

E((t)).

(C3)

lim inf
0

|E|((t))

|E|((t)).

Then  is a gradient flow for E starting from 0, and


 

||

---
0

|

|

in L2([0, )),



(13)

E((t))

---
0

E((t))

for all t

0,

  

|E|()

---
0

|E|()

in L2([0, )).

In our case, Condition (C1) follows directly from the above argument. Indeed, writing  and v as in the proof of Lemma 2.3, by (12) and [4, Theorem 1.1.2] we have ||(s) v(s) for almost every s 0. Then, by the weak lower semicontinuity of the L2-norm, we get

t

lim inf
0

||(s)2 ds
0

t
v(s)2 ds
0

t
| |(s)2 ds,
0

which is (C1). Condition (C2) is a direct consequence of the -convergence of (E) to E given in Lemma 2.1. Thus, we are only left with proving Condition (C3), which we do in the remainder of this section.

Proof of Condition (C3). Let () and  be as in Theorem 1.4. For clarity in this proof we will often omit time dependence so that, for example, we will write  and  in place of (t) and (t), respectively.
Let us introduce some notation we shall use throughout the proof. For any µ  P(Rd) and any Borel set A  Rd we write µ|A the restriction of µ to A. We define, for all i  {1, 2} and j, k  {1, 2, 3}, the projections
i : (Rd)2  Rd, (x1, x2)  xi,
~j : (Rd)3  Rd, (x1, x2, x3)  xj,
~jk : (Rd)3  (Rd)2, (x1, x2, x3)  (xj, xk).
We use the two identity maps id : Rd  Rd, x  x, and id2 : Rd  (Rd)2, x  (x, x). We fix r  (0, M) and write Mr the r-neighborhood of M, i.e.,
Mr = {x  Rd | dM(x) < r}.

We write M : Mr  M
the projection on M restricted to Mr, which is well-defined for r is smaller than the reach M of M. Without losing generality we may suppose r is such that p := (Mr) > 0 for all  > 0; note that p  1 as   0.
For every  > 0 let us write ^  P2(Rd) the projection of  defined as
^ = (M)#,

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

11

where   P2(Rd) stands for (|Mr )/p. We clearly have supp(^)  M and so ^  dom(E). Then, by definition, for all  > 0 we have

|E|(^) =

lim sup
^

(E(^) - E())+ . d2(^, )

supp()M

Because |E| is d2-lower semicontinuous [4, Corollary 2.4.10] and since d2(^, )  0 as   0, we get

lim inf
0

|E

|(^)

|E|().

Therefore, Condition (C3) is a direct consequence of

(14)

lim inf
0

|

E|()

lim inf
0

|

E|(^).

Proving (14) will therefore conclude the proof of Condition (C3). The proof of the following lemma includes all the main ideas to achieve this; it shows (14) in the simpler case where supp()  Mr for all  > 0, which we later relax.
Lemma 2.5. Let () be as in Theorem 1.4, and suppose moreover that supp()  Mr for all  > 0. Then (14) holds.

Proof. Note that, given  > 0, there exists a sequence (n)n such that n  P(M) for all n  N, d2(^, n)  0 as n   and

(15)

|E|(^)

=

lim
n

(E(^) - E(n))+ d2(^, n)

.

We want to construct (µn )n  P2(Rd) such that d2(, µn )  0 as n   and

(16)

lim inf
0

lim
n

(E() - E(µn ))+ d2(, µn )

lim inf
0

lim
n

(E(^) - E(n))+ d2(^, n)

.

Indeed, by the definition of |E|(), this directly implies the desired result (14). Note that, because supp()  Mr, we have p = 1,  =  and ^ = (M)#.

Step 1: constructing (µn )n. Fix  > 0 and n  N in this step. Let us write n  P(Rd × Rd × Rd) a plan with supp(n)  Mr × M × M such that

(17)

(~12)#n = (id, M)# and (~23)#n = n,

where n is the optimal transport plan between ^ and n, where we recall n is defined in (15). Here the notation (id, M) stands for the map defined by (id, M)(x) = (x, M(x)) for all x  Mr. The existence of the "compound" plan n is justified by [4, Lemma 5.3.2]. In particular, (~12)#n is the optimal transport plan between  and ^. For all Borel sets X, Y  Rd, we then define n  P(Rd × Rd) by

(18)

n(X × Y ) =

(~1, )#n if X, Y  Mr

0

otherwise,

where  : Rd × M × M  Rd is given by (x, p, q) = x + q - p for all (x, p, q)  Rd × M × M. We now choose
µn = (2)#n. We have (1)#n = , so that n is a transport plan between  and µn . Figure 1 illustrates this construction.

12

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

x·

n  n 

 #

y·



·p

^

µn

q·

n

M

FIGURE 1. Construction of µn .

Step 2: checking d2(, µn )  0 as n  . Let  > 0. For all n  N, because n is a transport plan between  and µn , (17) and (18) imply

d22(, µn )

|x - y|2 dn(x, y) =

|x - y|2 d(~1, )#n(x, y)

Rd×Rd

Mr ×Mr

=

|~1(x, p, q) - (x, p, q)|2 dn(x, p, q)

Mr ×M×M

=

|x - (x + q - p)|2 dn(x, p, q)

Mr ×M×M

=

|p - q|2 dn(x, p, q) =

|p - q|2 d(~23)#n(p, q)

Mr ×M×M

M×M

=

|p - q|2 dn(p, q) = d22(^, n).

M×M

We therefore have, for all n  N,

(19)

d2(, µn ) d2(^, n).

Since d2(^, n)  0 as n  , we have that d2(, µn )  0 as well.

Step 3: getting (16). Let n  N. Note that, setting  = Mr × M × M and d = dM,

d(x)2 - d(y)2 dn(x, y) =

d(x)2 - d(y)2 d(~1, )#n(x, y)

Rd×Rd

Mr ×Mr

= d(x)2 - d(x + q - p)2 dn(x, p, q)


THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

13

= d(x)2 - |x + q - p - M(x + q - p)|2 dn(x, p, q)


d(x)2 - |x + q - p - q|2 dn(x, p, q)


= d(x)2 - |x - p|2 dn(x, p, q)


=

d(x)2 d(x) -

|x - p|2 d(id, M)#(x, p)

Mr

Mr ×M

=

d(x)2 d(x) -

|x - M(x)|2 d(x)

Mr

Mr

which leads to E() - E(µn )
Using (18) we get

=

d(x)2 d(x) -

d(x)2 d(x) = 0,

Mr

Mr

1 2

(W (x - u) - W (y - v)) dn(u, v) dn(x, y).
Mr ×Mr

E() - E(µn )

1 2



(W (x - u) - W (x + q - p - u - t + s)) dn(u, s, t) dn(x, p, q).


Because W is of class C2, the integrand above verifies

W (x - u) - W (x + q - p - u - t + s) W (x - u) · (p - q - (s - t)) - A(|p - q|2 + |s - t|2),

where A > 0 is a constant depending on the gradient of W . We also have that

W (x - u) · (p - q - (s - t)) W (p - s) · (p - q - (s - t)) - B(|x - p| + |u - s|)(|p - q| + |s - t|),

where B > 0 is a constant depending on the Hessian of W . Thus,

E() - E(µn )

1 2



W (p - s) · (p - q - (s - t)) dn(u, s, t) dn(x, p, q)


-B 2



(|x - p| + |u - s|)(|p - q| + |s - t|) dn(u, s, t) dn(x, p, q)


-

A 2

d22(^,

n).

Now, since both supp(^) and supp(n) are contained in M,

E(^)

-

E(n)

=

1 2

M×M

(W (p - s) - W (q - t)) dn(s, t) dn(p, q)
M×M

1 =
2



(W (p - s) - W (q - t)) dn(u, s, t) dn(x, p, q)


The integrand above satisfies

W (p - s) - W (q - t) W (p - s) · (p - s - (q - t)) + C(|p - q|2 + |s - t|2),

where C > 0 is a constant depending on the gradient of W . Thus,

E(^) - E(n) Therefore,

1 2





W

(p

-

s)

·

(p

-

q

-

(s

-

t))

dn(u,

s,

t)

dn(x,

p,

q)

+

C 2

d22(^,

n).

E() - E(µn ) E(^) - E(n) - Dd22(^, n)

14

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

-B 2



(|x - p| + |u - s|)(|p - q| + |s - t|) dn(u, s, t) dn(x, p, q),


where

D

=

1 2

(A

+

C ).

Furthermore,

by

the

Cauchy­Schwarz

inequality

and

(17),

(|x - p| + |u - s|) · (|p - q| + |s - t|) dn(u, s, t) dn(x, p, q)


= |x - p||p - q| dn(x, p, q) + |u - s||s - t| dn(u, s, t)





+

|x - p||s - t| dn(u, s, t) dn(x, p, q)



+

|u - s||p - q| dn(u, s, t) dn(x, p, q)



= 2 |x - p||p - q| dn(x, p, q)


+2

|x - p||s - t| dn(u, s, t) dn(x, p, q)



2

|x - p|2 dn(x, p, q)

|p - q|2 dn(x, p, q)





+2

|x - p|2 dn(x, p, q)

|s - t|2 dn(u, s, t)





=4

|x - p|2 d(id, M)#(x, p)

Mr ×M

= 4d2(^, )d2(^, n).

|p - q|2 dn(p, q)
M×M

Hence

(20)

E() - E(µn ) E(^) - E(n) - 2Bd2(^, )d2(^, n) - Dpd22(^, n).

Finally, using (19) and (20) we yield

lim
n

(E() - E(µn ))+ d2(^, µn )

lim
n

E(^) - E(n) - 2Bd2(^, )d2(^, n) - Dd22(^, n) + d2(^, n)

lim
n

(E(^) - E(n))+ d2(^, n)

-

Dd2(^,

n)

- 2Bd2(^, )

=

lim
n

(E(^) - E(n))+ d2(^, n)

-

2Bd2(^, ).

Thus, since d2(^, )  0 as   0, we obtain (16).

We now relax the support assumption of Lemma 2.5. Lemma 2.6. Let () be as in Theorem 1.4. Then (14) holds.
Proof. We follow the same strategy as in the proof of Lemma 2.5, the only difference being that we have to account for the "extra" mass (Rd \ Mr). It is still enough to prove (16), although now p  (0, 1] and ^ = (M)#, where we recall that  = (|Mr )/p.

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

15

Step 1: constructing (µn )n. Fix  > 0 and n  N in this step. Let us write n  P(Rd × Rd × Rd) a plan with supp(n)  Mr × M × M such that
(~12)#n = (id, M)# and (~23)#n = n, where n is the optimal transport plan between ^ and n. The existence of the "compound" plan n is justified by [4, Lemma 5.3.2]. In particular, (~12)#n is the optimal transport plan between  and ^. For all Borel sets X, Y  Rd, we then define n  P(Rd × Rd) by

(21)

n(X × Y ) =

(~1, )#n if X, Y  Mr

0

otherwise,

where  : Rd × M × M  Rd is given by (x, p, q) = x + q - p for all (x, p, q)  Rd × M × M. We now define n  P(Rd × Rd) by

(22)

n = pn + (id2)#(|Rd \ Mr ),

and choose

µn = (2)#n.

We have (1)#n = p + |Rd Note that the definition of n

\ Mr = , so that n is a transport plan between  and µn . in (22) is where the main difference with the proof of Lemma

2.5

lies. Indeed, to account for the mass outside of Mr we have added the term (id2)#(|Rd \ Mr ), which

describes the fact that we do not project, or even move, the mass in Rd \ Mr since it is negligible as

  0.

Step 2: checking d2(, µn )  0 as n  . Let  > 0. Very similarly as in Step 2 of the proof of Lemma 2.5, we get

d22(, µn )

|x - y|2 dn(x, y)
Rd×Rd

= p

|x - y|2 dn(x, y) +
Rd×Rd

Rd×Rd |x - y|2 d(id2)#(|Rd \ Mr )(x, y)

= p

|p - q|2 d(~23)#n(p, q) = p

|p - q|2 dn(p, q) = pd22(^, n).

M×M

M×M

We therefore have, for all n  N, (23)

d2(, µn )

 pd2(^,

n).

Since d2(^, n)  0 as n  , we have that d2(, µn )  0 as well.

Step 3: getting (16). Let n  N. Again, setting  = Mr × M × M and d = dM, and following the proof of Lemma 2.5, yields

1 p

Rd×Rd

d(x)2 - d(y)2

dn(x, y) =

Mr ×Mr

d(x)2 - d(y)2

dn(x, y)

=

d(x)2 d(x) -

|x - p|2 d(id, M)#(x, p)

Mr

Mr ×M

=

d(x)2 d(x) -

|x - M(x)|2 d(x)

Mr

Mr

=

d(x)2 d(x) -

d(x)2 d(x) = 0,

Mr

Mr

16

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

which leads to

E() - E(µn )

1 2

(W (x - u) - W (y - v)) dn(u, v) dn(x, y),
Mr ×Mr

that is, by (22),

E() - E(µn )

p2 2

(W (x - u) - W (y - v)) dn(u, v) dn(x, y)
Mr ×Mr

Using (21) we get

E() - E(µn )

p2 2



(W (x - u) - W (x + q - p - u - t + s)) dn(u, s, t) dn(x, p, q)


Still following the proof of Lemma 2.5, we obtain

E() - E(µn )

p2 (E(^) - E(n)) - Dp2d22(^, n)

- Bp2 2



(|x - p| + |u - s|)(|p - q| + |s - t|) dn(u, s, t) dn(x, p, q),


and

(24) E() - E(µn ) p2 (E(^) - E(n)) - 2Bp2d2(^, )d2(^, n) - Dp2d22(^, n),

where the constants B and D are defined as in the proof of Lemma 2.5. Finally, using (23) and (24) we yield

lim
n

(E() - E(µn ))+ d2(^, µn )

lim
n

p2 (E(^) - E(n)) - 2Bp2dp2d(^2(,^,)dn2)(^, n) - Dp2d22(^, n) +

p3/2

lim
n

(E(^) - E(n))+ d2(^, n)

-

Dd2(^, n)

- 2Bp3/2d2(^, )

=

p3/2

lim
n

(E(^) - E(n))+ d2(^, n)

-

2Bp3/2d2(^, ).

Thus, by p  1 and d2(^, )  0 as   0, we obtain (16), which ends the proof.

Remark 2.7. The convergence given in Theorem 1.4 and the second line in (13) imply

1 2

Rd

W



(t, x) d(t, x)

+

1 

Rd

dM(x)2

d(t, x)

---
0

1 2

W  (t, x) d(t, x).
M

By continuity and boundedness from below of W , Rd W  (t, x) d(t, x)  M W  (t, x) d(t, x) as   0, and thus

dM(x)2 d(t, x) = o() as   0,
Rd
which gives the "rate of attraction" to M as   0.

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

17

2.4 Stability

Theorem 1.4 shows, by approximation via the gradient flow for E, that the gradient flow for E has a solution. It does not, however, prove uniqueness of such a solution. It turns out that a Wasserstein stability estimate holds on M, as shown by Proposition 2.9 below. This ensures the uniqueness of the solution to

the gradient flow for E, and therefore yields the well-posedness of the Wasserstein gradient flow for E.

We omit the proof of the stability result as it follows the exact same steps as those found in the proof

of [10, Proposition 3.1 and Theorem 1.6] with the additional help of the lemma below whose proof can

be found in [22, Proposition 3.1]. Before stating the lemma and stability result, we recall the notion of
proximal normal cone of M at a point x  M: the proximal normal cone of M at x is the set NxM
given by NxM = {v  Rd |    (0, ), dM(x + v) = |v|},
that is, NxM is the set of vectors v  Rd so that there exists  > 0 such that x is a closest point to x + v on M.

Lemma 2.8. Let x, y  M. For every v  NxM there holds

y - x, v where we recall M > 0 is the reach of M.

|y - x|2|v| ,
2M

Proposition 2.9 (stability estimate). Denote by W 0 a semiconvexity constant of W . Let 1 and 2 be two gradient flows for E (which we know exist by Theorem 1.4) starting from 01  P(M) and 02  P(M), respectively. Then, for all t 0,

d2(1(t), 2(t))

e

-W +

W L(M) M

td2(01, 02).

3 Projected gradient flow scheme (proof of Theorem 1.5)

We consider µ and  solutions to the classical full-space nonlocal-interaction equation and the gradient flow for E, respectively, that is,

(25)

tµ + div(µv) = 0,

and

t + div(u) = 0,

v = -W  µ,

u = PM(-W  ).

Note that for any x  M, the projections on TxM and TxinM satisfy TxM(v) - TxinM(v)  NxM for all v  Rd, where we recall that NxM is the proximal normal cone of M at x. To simplify the notation in this section, we shall use Px for TxinM and PxT for TxM.
For all t 0, let t : Rd  Rd be the flow map associated to the classical full-space nonlocalinteraction equation and let t : M  M be that associated to the gradient flow for E. Then, the solutions to (25) starting from some 0  P(M) are given by

µ(t) = (t)#0 and (t) = (t)#0.

Fixing r  (0, M) we write Mr the r-neighborhood of M, i.e., Mr = {x  Rd | dM(x) < r}, so that the projection M : Mr  M on M is well-defined. Let us take a time step size  > 0 small enough such that supp((t)#)  Mr for all   P(M) and t  [0,  ]. Such a time step exists since W  C2(Rd) and M is compact; indeed, this ensures that their exists a constant C > 0 such that for
all   P(M) there holds W   L(Mr) W L(Mr) C. We can then define the sequence (n )n  P(M) as follows: for any integer n 0,

0 = 0, n+1 = (M)#(( )#n ).

18

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

We define the interpolation  : [0, )  P(M) by

 (0) = 0,  (t) = (M)#((t-n )#n ) for all t  (n, (n + 1) ].

In particular, we have

 (t) = (M)#((t)#0) = (M)#µ(t) for all t  [0,  ].

We now show that  is a good approximation of , that is, d2( (t), (t))  0 as   0 for all t 0,

which indeed provides the proof of Theorem 1.5.

Let R > 0 be such that Mr - Mr := {x - y | x, y  Mr}  BR, where BR is the open ball centered

at 0 with radius R. Let Mv = W L(BR). In all of the arguments that follow we further restrict 

such that

 M .

8Mv

Writing h : [0,  ]  R the function defined by h(t) = d2( (t), (t)) for all t  [0,  ], we seek, for a

fixed t  [0,  ], to estimate

h2(t) := d22( (t), (t)) = |M(t(x)) - t(x)|2 d0(x).
Rd

Let us take the right-derivative of h2. For any x  Rd we write y = t(x) and z = t(x). Then,

1 d+h2 (t) =
2 dt

(M(y) - z) PM(y)(-W  µt(y)) - Pz(-W  t(z))
Rd

d0(x)

(M(y) - z)
Rd

PM(y)(-W  µt(y)) - PTM(y)(-W  µt(y))

d0(x)

+

(M(y) - z)
Rd

PTM(y)(-W  µt(y)) - PzT(-W  t(z))

d0(x)

+ (M(y) - z) PzT(-W  t(z)) - Pz(-W  t(z)) d0(x) ,
Rd
using Lemma 2.8 to estimate the first and third terms we continue the computation:

1 2M

|M(y) - z|2(|W  µt(y)| + |W  t(z)|) d0(x)
Rd

+

(M(y) - z)
Rd

PTM(y)(-W  µt(y)) - PTM(y)(-W  t(z))

d0(x)

+

(M(y) - z)
Rd

PTM(y)(-W  t(z)) - PzT(-W  t(z))

using Proposition 6.2 in [20] to estimate the third term we further have:

W L(BR) M

|M(y) - z|2 d0(x)
Rd

d0(x) ,

+ |M(y) - z|

W (t(x) - t(s)) - W (t(x) - t(s)) d0(s) d0(x)

Rd

Rd



+

W

L (BR )

Rd

|M(y)

-

z|

2 M

dM(M(y),

z)

d0(x),

using [16, Proposition 2] and |M(y) - z| |M(y) - y| + |y - z| 2Mv

1 2

M

we

finally

get:

W L(BR) h2(t) M

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

19

+ D2W L(BR) |M(y) - z| |t(x) - t(x)|-|t(s) - t(s)| d0(s) d0(x)

Rd

Rd

5 +
M

W

L (BR )

|M(y) - z|2 d0(x)
Rd

6

W L(BR) h2(t) + 4 M

D2W

L (BR )

W

L(BR) h(t)t.

Therefore,

d+h (t)
dt

6

W L(BR) h(t) + 4 M

D2W

L (BR )

W

L(BR) t =: ah(t) + bt,

and thus

d+ (h(t)e-at) bte-at bt. dt

Using that h(0) = 0 we obtain that for all t  [0,  ]

d2( (t), (t)) = h(t)

1 bt2eat = 2 2

D2W

L (BR )

W

6 W L(M)t

L(BR)t2e

M

,

confirming that the local error of the proposed scheme is what one would expect for a first-order scheme.

Combining this local error estimate of the scheme with the stability estimates of Lemma 2.9 we obtain,

for all t 0,

d2( (t), (t))

6 W L(M)

e

M

t,

where

t =

2

D2W L(BR) W L(BR)

-W +

W L(M) M

e -W +

W L(M) M

t
-1

.

4 Numerics

We present in this section some experiments illustrating the dynamics of particles following the -gradient flow and projected gradient flow schemes, whose convergence results have been given in Sections 2 and 3, respectively. We consider here very simple interaction potentials and highlight how the geometry of the domain can have decisive influence on the dynamics. For the code we used, we refer the reader to our GitHub repository [21]. Before discussing the experiments, we present the numerical setting.

4.1 Numerical schemes

Our discretization is based on the fact that the gradient flow solutions of (1) and (5) for initial data which

are discrete measures become systems of ODEs. On the other hand, one can approximate in Wasserstein

(as well as -Wasserstein) distance any desired initial measure by discrete measures. The stability

estimate of Proposition 2.9 ensures that the particle approximations to (1) approximate well the solutions

over time.

We consider particle solutions with N particles, xi : [0, )  Rd, i  {1, . . . , N }. All particles have

same

mass

1 N

.

The

initial

condition

(x01,

...

,

x0N )

belongs

to

(Rd)N .

We

moreover

write

µ0N

=

1 N

N

x0i

and

1N

µN (t) = N

xi(t),

i=1

i=1

for the empirical measures associated to the particles.

20

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

4.1.1 -gradient flow scheme. Recalling that the underlying energy E is given in (9) and plugging the empirical measures µN into it, we yield the following discrete energy:

1N E,N (x1, . . . , xN ) = 2N 2

N

W (xi

-

xj )

+

1 N

N

dM(xi)2.

i=1 j=1

i=1

The gradient flow (5) reduces to the ODE system, for all i  {1, . . . , N },

(26)

xi(t) = -N iE,N (x1(t), . . . , xN (t)), xi(0) = x0i .

The fact that this ODE system converges to the gradient flow for E as N   is well-known; see for
instance [8, Theorem 3.1]. We finally discretize (26) in time via a forward Euler scheme: take a time step size  > 0 and for all n  N0 denote by xni the approximation of xi(t) for all t  (n, (n + 1) ] and apply

(27)

xni +1 = xni -  N iE,N (xn1 , . . . , xnN ).

As a stopping criterion for our simulations we either stop once a fixed final time is reached or stop as soon as at time step n + 1 we find

(28)

|E,N (xn1+1, . . . , xnN+1)| < tol,

for a tolerance tol > 0.

4.1.2 Projected gradient flow scheme. The classical interaction energy

1 E() =

W (x - y) d(y) d(x)

2 Rd Rd

for all   P(Rd),

for  = µN has the form

1N EN (x1, . . . , xN ) = 2N 2

N
W (xi - xj).

i=1 j=1

The resulting discretization we choose is the following "splitting" scheme: for all i  {1, . . . , N },


 

yi(t)

=

-N

iEN

(x1(t),

.

.

.

,

xN

(t)),

(29)

xi(t) = M(yi(t)),

 

xi(0)

=

x0i ,

where we recall that M is the projection on M from an r-neighborhood of M for some r < M. Again, we discretize (29) in time via a forward Euler scheme as described above, which for all n  N0 yields

(30)

yin+1 = yin -  N iEN (xn1 , . . . , xnN ), xni +1 = M(yin+1).

Because in this case there is no reason to think that the gradient of EN should achieve 0 asymptotically in the dynamics given by (30), we use an alternative stopping criterion to that in (28). Instead, we stop our simulation as soon as at time step n + 1 we find

(31)

|E,N (xn1+1, . . . , xnN+1) - E,N (xn1 , . . . , xnN )| < tol.



For both the -gradient flow and projected gradient flow schemes, whenever we do not know an explicit formula for the distance dM(x) of a point x  Rd to M, we numerically approximate it by initially
sampling the boundary of the set M, linearly interpolating between these sampling points, and then

computing the distance from the point x and this linear interpolation of the boundary; from this we

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

21

also deduce an approximation of the projection M(x). Also, again for both the -gradient flow and projected gradient flow schemes, for each simulation we choose our initial time step size via a backtracking linesearch and then keep it constant through the rest of the simulation. Other approaches can of course be easily tested, for example using an adaptive time step size.

4.2 Experiments

Here we report on several experiments we conducted in one and two dimensions. We generally observed that the projected scheme (cf. Section 4.1.2 is more robust and converges faster than the -scheme (cf. Section 4.1.1). For this reason we shall mostly focus on the former in the following simulations.

4.2.1 1D domain. We consider the gradient flow (5) approximated by (27), where the domain is the

union of an interval and a point: M = [-1, 1]  {1.5}. The initial data are N = 100 particles arranged

as a random sample of the interval [-1.75, 1.75]. The potential is the attractive potential W (x) = x2 and

the attraction parameter is  = 0.1. Our tolerance for convergence is tol = 10-9 (cf. (28)). The dynamics

shown

on

Figure

2

displays

two

time

scales.

On

the

time

scale

1 

=

10

the

particles

converge

to

within

roughly  of the domain. After that, the dynamics first gathers the points in the interval [-1, 1] together

and

then

gets

them

as

close

to

the

mass

near

x

=

1.5

as

the

domain

penalty

1 

allows.

5

4

3

t

2

1

0

1.5

1.0

0.5

0x.0

0.5

1.0

1.5

FIGURE 2. Dynamics of (5) approximated by (27) with domain M = [-1, 1]  {1.5} for an attractive potential.

4.2.2 Disc in 2D. We now approximate the gradient flow (1) using the discretization (30). The domain

is M = B(0, 1), whose boundary is represented in light gray in Figure 3. We consider two different

potentials:

W (x)

=

1 1+10|x|2

and W (x)

=

1 1+|x|2

,

the

first

decaying

on a shorter length

scale than

the

second. In both cases we initialize the dynamics with N = 196 points placed on a random perturbation of

a uniform rectangular grid within the domain; see blue dots on Figure 3. The states after time t = 200

are shown as red dots on Figure 3. Two time scales are again observed. Initially the majority of points

converges quickly to the boundary. On the slower time scale the points on the boundary migrate to assume

nearly uniform distribution. The slow time scale of the motion on the boundary currently prevents us from

saying if the final configuration on the right has a uniform distribution on the boundary.

4.2.3 Bean with repulsive potential. Here we consider the dynamics given by (30) on a bean-shaped domain with smooth boundary depicted in light gray in Figure 4. The parametrization of the boundary is in fact given by
p(x) = ±0.4 1 - x2(1.1 - cos(3x)) for all x  [-1, 1].

22

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

1.0

1.0

0.5

0.5

y

0.0

y

0.0

0.5

0.5

1.0

1.0

1.5

1.0

0.5

0x.0

0.5

1.0

1.5

1.5

1.0

0.5

0x.0

0.5

1.0

1.5

(a) shorter range potential W (x) =

1 1+10|x|2

.

(b) longer range potential W (x)

=

1 1+|x|2

.

FIGURE 3. Dynamics of (1) approximated by (30) with domain M = B(0, 1) for repulsive potentials with varying length scales.

We

consider

the

repulsive

potential

W (x)

=

1 1+|x|2

with

distinct

randomly

perturbed

uniform

rectangular

grids of N = 196 points as initial distributions. If needed, these grids are projected to our manifold

to ensure that the initial data are within our domain. Our tolerance for convergence is taken to be tol = 2 · 10-10 (cf. (31)). While the geometries of the final states, shown as red dots on Figure 4, are

not that dissimilar, the masses of the points are considerably different, resulting in significantly different

energies. We conclude that the configuration on the right is a local minimizer. We noticed that the

dynamics from varying initial states would often converge to different local minimizers. Let us clarify

that by local minimizers we mean that there are no lower energy states with respect to local perturbations

of points. Furthermore we believe that these are also -Wasserstein local minimizers. In our view the

asymmetry of the domain has similar effect to introducing energy barriers and increases the complexity of

the energy landscape. It is an interesting theoretical question to understand and predict the features of the

energy landscape based on the geometry of the domain, which we shall leave to further investigation.

y

0.50

0.50

0.25

0.25

0.00

y

0.00

0.25

0.25

0.50

0.50

1.0

0.5

0x.0

0.5

1.0

(a) symmetric configuration with final energy E196 = 0.260.

1.0

0.5

0x.0

0.5

1.0

(b) asymmetric configuration with final energy E196 = 0.273.

FIGURE 4. Dynamics of (1) approximated by (30) with a bean-shaped domain for a repulsive potential.

THE NONLOCAL-INTERACTION EQUATION NEAR ATTRACTING MANIFOLDS

23

4.2.4 Bean boundary with attractive potential. In our final example we consider the domain to be the

boundary of the bean-shaped domain from the previous example, on which the dynamics is again given by

(30). Here the initial particles are obtained by projecting a randomly perturbed uniform rectangular grid to

the

boundary

of

the

bean.

We

consider

the

attractive

potential

W (x)

=

-

1 1+|x|2

and

stop

the

simulation

at t = 28. While the global minimizer of this energy is achieved when all of the mass is concentrated at a

single point, we observe on Figure 5 that, due to the nonconvexity of the shape, the dynamics has local

minimizers. Such states have a very small basin of attraction, resulting in a metastable-like behavior of

the dynamics as illustrated on the right picture of Figure 5. Moreover, we observed that there is a likely

local minimizer with three masses (one being on the right-most point of the domain).

y

0.50

0.25

0.00

0.25

0.50

1.0

0.5

0x.0

0.5

1.0

(a) initial (blue dots) and final (red dots) particle positions.

0.2 0.4
x 0.6 0.8
1.0

25 20
15 t
10 5 0
0.4 0.2
0.2 0.0 y
0.4

(b) particle trajectories.

FIGURE 5. Dynamics of (1) approximated by (30) with domain the boundary of a bean shape for a repulsive potential.

Acknowledgements
DS is grateful to NSF for support via grant DMS 1814991. DS and FSP are grateful to the Center for Nonlinear Analysis of CMU for its support.
References
[1] H. Ahn, S.-Y. Ha, H. Park, and W. Shim. Emergent behaviors of Cucker­Smale flocks on the hyperboloid. Preprint, 2020. [2] L. Alasio, M. Bruna, and J. A. Carrillo. The role of a strong confining potential in a nonlinear Fokker-Planck equation.
Nonlinear Analysis, 2020. [3] L. Ambrosio and N. Gigli. A user's guide to optimal transport. In Modelling and Optimisation of Flows on Networks,
volume 2062 of Lecture Notes in Math., pages 1­155. Springer, Heidelberg, 2013. [4] L. Ambrosio, N. Gigli, and G. Savare´. Gradient Flows in Metric Spaces and in the Space of Probability Measures. Lectures
in Mathematics ETH Zu¨rich. Birkha¨user Verlag, Basel, 2008. [5] A. L. Bertozzi, T. Laurent, and J. Rosado. Lp theory for the multidimensional aggregation equation. Communications on
Pure and Applied Mathematics, 64(1):45­83, 2011. [6] P. Billingsley. Convergence of Probability Measures. Wiley Series in Probability and Statistics. JOHN WILEY & SONS,
INC, New York, 1999. [7] J. Canizo, J. Carrillo, and J. Rosado. A well-posedness theory in measures for some kinetic models of collective motion.
Mathematical Models and Methods in Applied Sciences, 21:515­539, 2009. [8] J. A. Carrillo, Y.-P. Choi, and M. Hauray. The derivation of swarming models: Mean-field limit and Wasserstein distances,
pages 1­46. Springer Vienna, Vienna, 2014. [9] J. A. Carrillo, F. S. Patacchini, P. Sternberg, and G. Wolansky. Convergence of a particle method for diffusive gradient
flows in one dimension. SIAM J. Math. Analysis, 48:3708­3741, 2016.

24

FRANCESCO S. PATACCHINI AND DEJAN SLEPC EV

[10] J. A. Carrillo, D. Slepcev, and L. Wu. Nonlocal interaction equations on uniformly prox-regular sets. Discrete Contin. Dyn. Syst. Ser. A, 36(3):1209­1247, 2016.
[11] K. Craig and I. Topaloglu. Convergence of regularized nonlocal interaction energies. SIAM J. Math. Anal., 48(1):34­60, 2016.
[12] S. Daneri and G. Savare´. Lecture notes on gradient flows and optimal transport. 2010. [13] R. C. Fetecau, S.-Y. Ha, and H. Park. An intrinsic aggregation model on the special orthogonal group SO(3): well-posedness
and collective behaviours. ArXiv preprint, 2020. [14] R. C. Fetecau, H. Park, and F. S. Patacchini. Well-posedness and asymptotic behaviour of an aggregation modelwith
intrinsic interactions on sphere and other manifolds. Preprint, 2020. [15] R. C. Fetecau and B. Zhang. Self-organization on Riemannian manifolds. J. Geom. Mech., 11(3):397­426, 2019. [16] N. Garc´ia Trillos, M. Gerlach, M. Hein, and D. Slepcev. Error estimates for spectral convergence of the graph Laplacian on
random geometric graphs toward the Laplace-Beltrami operator. Found. Comput. Math., 20(4):827­887, 2020. [17] S.-Y. Ha and D. Kim. A second-order particle swarm model on a sphere and emergent dynamics. SIAM J. Appl. Dyn. Syst.,
18(1):80­116, 2019. [18] S.-Y. Ha, D. Kim, J. Lee, and S. E. Noh. Particle and kinetic models for swarming particles on a sphere and stability
properties. J. Stat. Phys., 174:622­655, 2019. [19] S. Lisini. Nonlinear diffusion equations with variable coefficients as gradient flows in Wasserstein spaces. ESAIM: Control
Optim. Calc. Var., 15:712­740, 2009. [20] P. Niyogi, S. Smale, and S. Weinberger. Finding the homology of submanifolds with high confidence from random samples.
Discrete Comput. Geom., 39(1-3):419­441, 2008. [21] F. S. Patacchini and D. Slepcev. GitHub repository for present paper with open source code. https://github.com/
francesco-patacchini/interaction-equation-attracting-manifolds. [22] J. Rataj and L. Zaj´icek. On the structure of sets with positive reach. Math. Nachr., 290(11-12):1806­1829, 2017. [23] E. Sandier and S. Serfaty. Gamma-convergence of gradient flows with applications to Ginzburg-Landau. Comm. Pure Appl.
Math., 57(12):1627­1672, 2004. [24] S. Serfaty. Gamma-convergence of gradient flows on Hilbert and metric spaces and applications. Discrete Contin. Dyn.
Syst., 31(4):1427­1451, 2011. [25] L. Wu and D. Slepcev. Nonlocal interaction equations in environments with heterogeneities and boundaries. Comm. Partial
Differential Equations, 40(7):1241­1281, 2015.
FRANCESCO S. PATACCHINI ­ IFP ENERGIES NOUVELLES, 1 ET 4 AVENUE DE BOIS-PRE´ AU, 92852 RUEIL-MALMAISON, FRANCE; DEPARTMENT OF MATHEMATICAL SCIENCES, CARNEGIE MELLON UNIVERSITY, PITTSBURGH, PA 15213, USA
DEJAN SLEPC EV ­ DEPARTMENT OF MATHEMATICAL SCIENCES, CARNEGIE MELLON UNIVERSITY, PITTSBURGH, PA 15213, USA
Email address: francesco.patacchini@ifpen.fr Email address: slepcev@math.cmu.edu

