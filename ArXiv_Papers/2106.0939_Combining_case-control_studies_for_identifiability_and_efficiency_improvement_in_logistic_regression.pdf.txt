arXiv:2106.00939v1 [stat.ME] 2 Jun 2021

Combining case-control studies for identifiability and efficiency improvement in logistic regression
Wenlu Tang, Yuanyuan Lin, Linlin Dai and Kani Chen
Abstract: Can two separate case-control studies, one about Hepatitis disease and the other about Fibrosis, for example, be combined together? It would be hugely beneficial if two or more separately conducted case-control studies, even for entirely irrelevant purposes, can be merged together with a unified analysis that produce better statistical properties, e.g., more accurate estimation of parameters. In this paper, we show that, when using the popular logistic regression model, the combined/integrative analysis produces more accurate estimation of the slope parameters than the single case-control study. It is known that, in a single logistic case-control study, the intercept is not identifiable, contrary to prospective studies. In combined case-control studies, however, the intercepts are proved to be identifiable under mild conditions. The resulting maximum likelihood estimates of the intercepts and slopes are proved to be consistent and asymptotically normal, with asymptotic variances achieving the semiparametric efficiency lower bound.
Keywords: Combining case-control studies, logistic regression, maximum likelihood estimation, semiparametric efficiency.
1Wenlu Tang (E-mail: wenlu.tang@polyu.edu.hk) is Research Assistant Professor, Department of Applied Mathematics, The Hong Kong Polytechnic University, Hong Kong, China. Yuanyuan Lin (E-mail: ylin@sta.cuhk.edu.hk) is Associate Professor, Department of Statistics, The Chinese University of Hong Kong, Hong Kong, China. Linlin Dai (E-mail: ldaiab@swufe.edu.cn) is Assistant Professor, Center of Statistical Research, School of Statistics, Southwestern University of Finance and Economics, Chengdu, Sichuan, China. Kani Chen (E-mail: makchen@ust.hk) is Professor, Hong Kong University of Science and Technology, Clear Water Bay, Kowloon, Hong Kong.

1 Introduction

Logistic regression (Cox, 1958) is probably the most fundamental statistical tool to model

categorical dependent variable. Let Y be a categorical response variable and let X be an

observable d-dimensional vector of covariates. Without loss of generality, we focus on binary

response typically coded as 0/1. A binary logistic regression model assumes

P (Y

= 1|X

= x) = 1 - P (Y

= 0|X

= x) =

1

e+  x + e+x

,

(1)

where   Rd is the slope parameter and   R is the intercept. The logistic regression is

often regarded as a special case of the generalized linear models, which has been extremely

popular in biomedical science for the study of the effect of certain exposure to possible

disease or hazards. The response is thus often binary, e.g, Y = 0 represents the controls

(non-disease) and Y = 1 represents the cases (disease), or there may be more than two

categories of Y . In prospective studies, a sample of subjects or individuals is followed and

their respective Y are recorded. For model (1) under prospective studies, the samples are

simple random sampling from the underlying population. Thus ,  can be consistently

estimated by the maximum likelihood estimation (MLE). However, many diseases are often

fairly rare such that P (Y = 0|X = x) is close to 1. Large studies may produce very few

diseased cases and thus very little information about the disease of interest.

Case-control study is a primary tool for the study of existing factors related to rare disease incidence, by taking samples separately from the case population and the control population, when the case population and the control population are clearly separated, e.g, through disease registry records. In econometrics, people are interested in the relationship of the covariates and the choices made by individual, e.g, the choice of transportation from Shanghai to Hong Kong. It would be easier and cheaper to take samples of individuals from the Hong Kong international airport, West Kowloon High-speed Train Station and Hung Hom train station, which is a choice-based sampling data (Manski and McFadden, 1981), than to take a single sample from the entire population. Generally speaking, according to Lawless(1997), sampling schemes that depend on the value of the outcome/response are called response-selective to response-biased sampling, among which case-control sampling is the most typical one; see Manski and Lerman (1977), Prentice and Pyke (1979), Cosslet (1981), Scott and Wild (1986, 1997), Manski (1993), Chen and Lo (1999), Chen (2001), Fithian and Hastie (2014), Liu et al. (2014) and Chen et al. (2017) etc. Another popular sampling design in epidemiology is the case-cohort sampling. The estimation and inference of case-cohort data with Cox's proportional hazards model, transformation models and other

1

semiparametric models are studied by Prentice (1986), Lu and Tsiatis (2006), Cai and Zeng (2004, 2007), Liu et al. (2010), Zeng and Lin (2014), Ni et al. (2016), Tao, Zeng and Lin (2017), etc. Unified estimations for semiparametric linear transformation models, the accelerated failure time model and quantile regression under general biased sampling schemes were studied by Kim, Lu, Sit and Ying (2013), Kim, Sit and Ying (2016) and Xu et al. (2017). In fact, earlier work on nonparametric inference were developed for recovering the distribution function in two-sample problem in the presence of selection bias under known selection bias weight function; see Vardi (1982, 1985), Qin (1993) and Qin and Zhang (1997). When the population case percentage is known, large sample theory of the nonparametric maximum likelihood estimate for semiparametric biased sampling data was established by Gilbert (2000). A comprehensive discussion on biased sampling and associated parameter problems can be found in Qin (2017).
For logistic regression under case-control sampling, a remarkable result is that, the prospective estimating equation derived from the MLE is valid for a consistent estimate of the slope parameter, except the intercept term (Prentice and Pyke, 1979). The beauty of this method is its simplicity and ease of inference. We first point out that for model (1) under a single case-control study as in the literature, the intercept  and f (·) are not identifiable, where f (·) is the probability density function of the covariate X in the population. The rationale behind is that, with a single case-control study, the score function of  lies in the linear space spanned by the score function of f (·). This is discussed in details in Remark 2 in section 2.1. As a result, contrary to prospective studies, the intercept cannot be consistently estimated in a single case-control study. Nonetheless, a consistent estimate of the intercept is important in many machine learning problems such as image classification or pattern recognition, and it is crucial for better understanding of the incidence of the disease, when prior knowledge of the event/disease is not available or not reliable. Despite some nice theory on the estimation of  is developed under various circumstances, no specific construction of consistent estimation of  in case-control logistic regression is available in the literature. Moreover, the consistent estimate for  in single case-control study is not semiparametric efficient.
In this paper, we propose an efficient estimation for the intercepts and slope parameters of the logistic regression models under multiple/distributed case-control studies. With K case-control studies of different purposes from the same population or collected from K heterogeneous subpopulations, the data can be pooled together for integrative analysis. The intercepts and slope parameters in the logistic regression models can vary across different
2

studies/subpopulations. By combining K case-control studies, surprisingly, the intercepts become identifiable under mild conditions (see Proposition 1 in section 2.1), as the score function of each intercept term no longer lies in the linear space spanned by the score of f (·) (see section 2.2 for detailed discussions); most importantly, the resulting estimates of the slope parameters are proved to be semiparametric efficient, with asymptotic variance smaller than the counterparts in single case-control study (see Remark 4 in section 2.2 and Remark 5 in section 2.4). The proposed estimation is based on the maximisation of the nonparametric likelihood function of the integrative data. The resulting estimates for the intercepts and slope parameters are shown to be consistent, asymptotically normal and asymptotically efficient. An iterative algorithm is employed to compute the maximum likelihood estimates numerically.

2 Theory and Methods

Without loss of generality, we focus on binary outcome. Suppose that there are K independent studies that might be of different purposes, or there are K heterogeneous subpopulations. For k = 1, . . . , K, the d-dimenisonal explanatory variables X and the binary response Yk satisfy

P (Yk = 1|X = x) = (k + kx)  k(, x),

k = 1, . . . , K,

(2)

where (x) = ex/(1 + ex) and  = (1, . . . , K, 1, . . . , K) of dimension p = K + Kd. Let f (·) and F (·) be the density function and the cumulative distribution of X respectively. We assume that f (·) and F (·) are the same for k = 1, . . . , K in model (2).

For each k = 1, . . . , K, let fk1(·) be the density function of the case population, i.e, the

conditional distribution of X given Yk = 1, and fk0(·) be that of the control population, i.e,

the conditional distribution of X given Yk = 0. Suppose that the k-th case-control study is

conducted by taking a random sample of nk1 cases from its case population, and a random

sample of nk0 controls from its control population, denoted by Dk = {(yik, xik)}ni=k1. Note that

nk1 and nk0 are pre-specified in case-control studies. Let nk = nk1 + nk0 and N =

K k=1

nk .

Thus, the pooled data are D = {Dk, k = 1, . . . , K} consisting of K case-control studies.

Under model (2), by the Bayes' formula, for k = 1, · · · , K,

fk1(x)

=

k

(, x)f ck()

(x)

,

fk0(x)

=

{1

-

k(, x)}f 1 - ck()

(x)

,

(3)

3

where ck() =

+ -

k(,

x)f (x)dx

is

the

population

percentage

of

cases

for

the

k-th

study

or

the k-th subpopulation. For notational simplicity, we simply write ck() as ck, k = 1, . . . , K.

Let k,0 and k,0 be the true values of k and k, k = 1, . . . , K, respectively.

2.1 Identifiability

Throughout the paper, parameters including f (·) are not identifiable if two different choices have the same resulting distribution of random variables. In classical logistic regression model (1) under single case-control study (Scott and Wild, 1986), that is K = 1 in model (2), for any two values x and x0 in the support of X, the logarithmic odds ratio (OR) is

log{OR(x)} = log

f (x|Y = 1)/f (x0|Y = 1) f (x|Y = 0)/f (x0|Y = 0)

= (x - x0),

(4)

where f (·|Y = 1) is f1(·), the conditional density of X in the case population defined earlier. Heuristically, independent samples from the case population and control distribution are observed separately in case-control studies, making  identifiable according to (4); but  is not involved in (4) and thus it is not identifiable under single case-control study.

With multiple/distributed case-control studies, however, the data can be pooled together for unified analysis. Under regularity conditions (C1)-(C3) given in section 2.4, the idea of combining data enables us to consistently estimate the intercepts. We discuss the identifiability of  under multiple case-control studies in the following proposition.

Proposition 1
(a) The slope parameters k, k = 1, ..., K, are always identifiable. (b) For some k  K, if k = 0, then k is identifiable if and only if f (·) is identifiable.
As a result, f (·) is identifiable if and only if one of the k is identifiable. (c) If 1 = ... = K and 1 = 2 = . . . = K, then all k are not identifiable. (d) Assume f is continuous, and k are not all same. Then, those k with k = 0 are not
identifiable and those with k = 0 are not identifiable.
Part(a) is consistent with the results in Prentice and Pyke (1979). Part(b) tells the relationship between the identifiability of the intercepts and f (·). Part(c) has an important
4

implication that when each separate study/subpopulation shares the same/common intercept and slope parameters, the intercept is still not identifiable despite the data combining. In other words, when a single case-control study is sub-divided into multiple smaller studies, combining those smaller case-control studies cannot make the intercept identifiable. Part(d) implies that those sub-models with k = 0, their respective k is always not identifiable, regardless of the identifiability of f (·). For the rest of this paper, we assume that  = (1, . . . , K, 1, . . . , K) is identifiable.

2.2 The Score Functions and Maximum Likelihood Estimation

We next introduce our proposed maximum likelihood estimation. The likelihood function of {, f (·)} under K case-control studies is

K nk

L(, f ; D) =

fk1(xik)yik fk0(xik)(1-yik)

(5)

k=1 i=1

and the log-likelihood function is

K

K nk

l(, f ; D) = - nk1 log ck() + nk0 log{1 - ck()} +

log f (xik)

k=1

k=1 i=1

K nk

+

yik log k(, xik) + (1 - yik) log{1 - k(, xik)} .

(6)

k=1 i=1

According to the profile-likelihood method in Zeng and Lin (2006, 2007), the nonparamet-

ric component f (·) in (6) can be profiled over its observed values. To avoid uninteresting

discussions, we assume there is no tie in the realizations of X. With slight abuse of no-

tation, we still use xik, i = 1, . . . , nk, k = 1, . . . , K to denote the realizations. We define the estimator of F (·) as a step function with jumps only at the distinct observed values

xik, i = 1, . . . , nk, k = 1, . . . , K, that is F {xik}  pik for i = 1, . . . , nk, k = 1, . . . , K and

0 otherwise, where pik  0 is the jump size of F (·) at xik satisfying

K k=1

nk i=1

pik

=

1

and c~t() =

K k=1

nk i=1

t(,

xik

)pik



c~t, t

=

1, . . . , K.

Write

p



{pik, k

=

1, . . . , K,

i

=

1, . . . , nk}. The log-likelihood function after discretization is

K

K nk

~l(, p; D) = -

nt1 log c~t + nt0 log(1 - c~t) +

log pik

t=1

k=1 i=1

K nk

+

yik log k(, xik) + (1 - yik) log{1 - k(, xik)} ,

(7)

k=1 i=1

5

subject to

K nk

pik = 1, pik  0, i = 1, . . . , nk, k = 1, . . . , K,

k=1 i=1

K nk

t(, xik)pik = c~t, t = 1, . . . , K.

(8)

k=1 i=1

Our proposed maximum likelihood estimator for  and pik, denoted by ^ and p^ik, is defined as the maximizer of ~ln(, p; D) under the constraints in (8). Thus, the nonparametric maximum likelihood estimator (NPMLE) for F (x) is given by F^n(x) = xikx p^ik.

Remark 1 Let vec(A) be the vectorization of matrix A of order m × n, namely,

vec(A) = [a1,1, . . . , a1,n, . . . , am,1, . . . , am,n],

where ai,j is the (i, j)-th element in A. The score function of , denoted by S, is

S

(S1 , . . . , SK , S1, . . . , SK )

=

l(, f ; D) 

K
=-
t=1

nt1 - nt0 ct 1 - ct

K nk
t(, xik){1 - t(, xik)}f (xik)
k=1 i=1

et vec(et xik )

K nt

+

{yit - t(, xit)}

t=1 i=1

et vec(etxit )

,

(9)

where et is a K-vector with the t-th element being 1 and other elements being 0. And the score function of f , denoted by Sf [g1], is the partial derivative of l(, f ; D) along the direction (, f = f + g1) with  being a small constant, such that f  0 and

g1  G  g  BV [Rd] : g(x)dx = 0 .

Here, BV [D] is a class of functions on domain D with bounded total variation. Then,

K nk
Sf [g1] =
k=1 i=1

K
-
t=1

nt1 ct

t(,

xik )

+

nt0 {1 1 - ct

-

t(,

xik )}

+1 f (xik)

g1 (xik ).

Given the observations xik, i = 1, . . . , nk, k = 1, . . . , K, the log-likelihood l(, f ; D) can be approximated by ~l(, p; D); and the score function of pik, i = 1, . . . , nk, k = 1, . . . , K, based on the profile likelihood ~l(, p; D) is

K
Sf(pik)  -
t=1

nt1 c~t

t(,

xik )

+

nt0 1 - c~t

{1

-

t(,

xik )}

+

1 pik

.

(10)

6

Moreover, the linear space spanned by Sf(pik), i = 1, . . . , nk, k = 1, . . . , K, is a N -dimensional surface on Sf (Bickel et al. 1993). As a result, the linear space spanned by Sf contains the linear space spanned by Sf.

n

Sf(pi)pi{yi - (, xi)} = S

i=1

n
=

-

n1 c~

(,

xi)

+

n0 1-

c~(1

-

(,

xi))

i=1

pi{yi - (, xi)} + {yi - (, xi)} ,

where the equality holds by invoking (9). This observation reveals that S and Sf are on the same space when K = 1; in other words, S is on the linear space spanned by Sf when K = 1. As a result, the intercept and the population percentage of cases are not identifiable

in single case-control logistic regression.

Remark 2 When K  2, we focus on K = 2 without loss of generality.

· When 1 = 2, 1 = 0 and 2 = 0, the score functions of 1 and 2 are

S1 = -

n11 c1

-

n10 1 - c1

n1

n1

(1 + 1xi1){1 - (1 + 1xi1)} + n11 - (1 + 1xi1),

i=1

i=1

(11)

S2 = -

n21 c2

-

n20 1 - c2

n2

n2

(2 + 2xi2){1 - (2 + 2xi2)} + n21 - (2 + 2xi2)

i=1

i=1

respectively. Similar to Remark 1, direct calculations yield that the surface of the score function Sf is

2
Sf (pik) = -
t=1

nt1 c~t

(t

+

t xik )

+

nt0 1 - c~t

(1

-

(t

+

t xik ))

+

1 pik

.

Apparently, the score functions of 1 and 2 are not on any spanned linear space of Sf when 1 = 2, 1 = 0 and 2 = 0. This fact offers insights that the intercepts 1, 2 can be identifiable by combining the two case-control studies, when 1 and 2 are different and nonzero. Thus, 1, 2, 1, 2 and f (·) in model (2) can be consistently estimated by the proposed maximum likelihood estimation.

· When 1 = 0 and 2 = 0, the score function of 1 is (11) and that of 2 is

S2 = -

n21 - n20 c2 1 - c2

(2){1 - (2)} + n21 - n2(2),

7

indicating that S2 is in the linear space spanned by Sf , but S1 is not. In other words, 2 is unidentifiable but 1 is identifiable. This is consistent with Proposition (1d) in section 2.1.

· Lastly, for the special case that 1 = 0 and 2 = 0, the score functions of 1 and 2 are

S1 = - S2 = -

n11 c1

-

n10 1 - c1

n21 c2

-

n20 1 - c2

(1){1 - (1)} + n11 - n1(1), (2){1 - (2)} + n21 - n2(2)

respectively. It is clear that S1 and S2 are on the spanned linear space of Sf . As a result, 1 and 2 are unidentifiable when 1 = 0 and 2 = 0.

Remark 3 We need to emphasize that, k in model (2) can be always separately estimated by the celebrated estimation in Scott and Wild (1986) or Qin (2017, pages 210-212) with the k-th case-control study, k = 1, . . . , K, though k is unidentifiable. In contrast to the classical separate estimation in the literature, our proposed method based on the integrative data is able to identify the intercepts and give more efficient estimation of k, k = 1, . . . , K, which achieves the semiparametric efficiency lower bound, as evidenced in the simulation studies.

2.3 An Iterative Algorithm

Direct maximization of (7) is challenging and potentially unstable as the second constrain in

(8) is intractable. To circumvent the difficulty, we first plug in c~t =

K k=1

nk i=1

t(,

xik

)pik

,

t = 1, . . . , K into (7), and consider to maximize a Lagrange function by incorporating the

first constraint of (8) as follows

K

K nk

K nk

K nk

-

nt1 log

t(, xik)pik + nt0 log{1 -

t(, xik)pik} +

log pik

t=1

k=1 i=1

k=1 i=1

k=1 i=1

K nk

K nk

+

[yik log k(, xik) + (1 - yik) log{1 - k(, xik)}] -  1 -

pik , (12)

k=1 i=1

k=1 i=1

where  > 0 is the Lagrange multiplier. Taking first derivative of (12) with respect to pik and , we obtain

~l(, p; D) = 1 - K

pik

pik

t=1

nt1 c~t

t(,

xik )

+

nt0 1 - c~t

{1

-

t(,

xik )}

-  = 0,

(13)

8

and

~l(, p; D) 

=-

K

t=1

nt1 c~t

-

nt0 1 - c~t

K nk
t(, xik){1 - t(, xik)}pik
k=1 i=1

K nk

+

{yik - k(, xik)}

k=1 i=1

ek vec(ek xik )

= 0.

et vec(et xik )

(14)

Next, multiplying pik on both sides of (13), one can easily verify that  = 0 because of

N=

K t=1

nt.

Consequently,

pik =

1

.

K t=1

nt1 c~t

t

(,

xik )

+

nt0 1-c~t

{1

-

t(,

xik )}

(15)

We now devise an iterative algorithm to maximize (12). Set the initial value of the parameter p as p0, where p(0)  {p(ik0), k = 1, . . . , K, i = 1, . . . , nk}. For the j-step, given p(j), we update (j) by solving

K
-
t=1

nt1 c^t(, p(j))

-

1

-

nt0 c^t(,

p(j))

K nk
t(, xik){1 - t(, xik)}p(ikj)
k=1 i=1

K nk

+

{yik - t(, xik)}

k=1 i=1

ek vec(ek xik )

=0

et vec(et xik )
(16)

for , where c^t(, p(j)) =

K k=1

nt i=1

t(,

xik

)p(ikj).

Notice

that

the

objective

function

in

(12)

is convex in , thus the solution to (16) is unique. Subsequently, given ((j), p(j)), we update

p(j+1) according to the recursive formula

p^(ikj+1) = 1

K t=1

c^t

nt1 ((j), p(j))

t((j),

xik )

+

1

-

nt0 c^t((j),

p(j)) {1

-

t((j),

xik)}

.

(17)

We iterate between (16) and (17) until convergence. Denote the resulting estimator for 

and p by ^ and p^. Thus, F^n(x) 

K k=1

nk i=1

p^ik

I

(xik



x).

Moreover, the population

percentage of cases c~t is estimated by

K k=1

nk i=1

t(^,

xik )p^ik ,

t

=

1,

.

.

.

,

K.

The iterative algorithm is summarized as follows:

Algorithm 1 The iterated algorithm for computing the MLEs Set an initial value p(0).
repeat Step 1. Given p(j), compute (j) by solving (16) with the lgfbs package in R. Step 2. Given ((j), p(j)), update p(j+1) according to (17).
until |(j+1) - (j)|  1 and |p(j+1) - p(j)|  2.

9

Here 1 and 2 in the stopping criterions are set to be n-6 in our numerical studies.

2.4 Asymptotic properties

Let 0  (1,0, . . . , K,0, 1,0, . . . , K,0) and F0 be the true values of  and F . Let G = {g 

BV [Rd] : variation.

|g| 1}. And N

Here BV [D] (F^n - F0) can

is be

the set treated

of as

functions on domain a linear functional in

D with L(G),

bounded the space

total of all

bounded linear functionals on G. The following regularity conditions are imposed:

(C1) The density f0 is continuous with bounded support. (C2) If P (Xu = 0) = 1 for some constant vector u, then u = 0. (C3) The true parameter 0  B0, where B0 is a compact set.

Conditions (C1)-(C2) are regularity conditions to ensure the identifiability of the param-
eters. The continuously distributed condition of X is imposed for technical convenience.
It can be weaken to accommodate discrete predictors, as long as it is satisfied that there exist at least three different values x1, x2, x3 in the support of X such that k,0x1, k,0x2 and k,0x3 are also different for those nonzero k,0, k = 0, . . . , K. Condition (C3) assumes that 0 is an interior point of a compact set. We next present the asymptotic properties in three theorems.

Theorem 1 (Consistency of ^ and F^n) Assume conditions (C1)-(C3) hold. Then, if nk/N  k for some constant k, as nk   for all k = 1, . . . , K,
|^ - 0|  0 and sup |F^n(x) - F0(x)|  0
xRd
almost surely.

Theorem Then, if nk

2 (Asymptotic normality of ^ /N  k for some constant k

and F^n ) , as nk 

Suppose  for al

that conditions l k = 1, . . . , K,

(CN1()-^(-C30),

hold. F^n -

F0) converges weakly to The limiting covariance

amzaetrroix-moef anNG(a^u-ssia0n)

process attains

in the metric space the semiparametric

RKd+K × efficiency

L(G). bound.

10

Theorem 3 (Covariance matrix of ^ and F^n) For any (v, g1)  V × G, where V = {v  RKd+K : |v|  1}, the asymptotic covariance matrix for

 N

v(^

-

0)

+

 N

g1(X)d{F^n(X) - F0(X)}

X

can be estimated by (v, g1)In-1(v, g1), where N In is the negative Hessian matrix of the

log-likelihood ~l(, 0, the covariance

pm;aDtr)ixwoitfhrNes(pe^c-t t0o)

(, p) and g1 = (g1(x11), . . . , g1(xnK)). By taking g1 = can be estimated by the upper left (Kd+K)×(Kd+K)

matrix of In-1.

Theorem 1 and Theorem 2 indicate that maximizing the profile log-likelihood (7) over (, p) leads to consistent, asymptotically normal and semiparametric efficient estimate for  under mild conditions. Theorem 3 provides a simple and easy-to-implement variance estimation.

Remark 4 Our proposed estimator is semiparametric efficient under K case-control studies
by Theorem 2. To have more insights into the efficiency gain, we consider model (2) with
K = 2, and focus on the estimation of the parameter 1  (1, 1) of the first study as a toy example. Three estimators of 1 are considered: the maximum likelihood estimator for single case-control study with known f (·), denoted by ^1(1) = (1(1), 1(1)); the maximum likelihood estimator for single case-control study with unknown f (·) (Scott and Wild, 1986), denoted by ^1(2) = (1(2), 1(2)); our proposed estimator by combining two case-control studies, denoted by ^1(3) = (1(3), 1(3)).

When f (·) is known in a single case-control study, the score function of 1 is

S(1)(1)  {y - (1 + 1x)}

1 x

-E

{y - (1 + 1x)}

1 x

|y

.

When f (·) is unknown in a single case-control study, according to Remark 2, the score of 1, (1 + 1x) - E{(1 + 1x)|y}, is on the linear space spanned by Sf . Write k  (k + kx)x - E{(k + kx)x|y}, k = 1, 2. Then, the score function of 1
S(2)(1)  1 - E1 - [H(x) - E{H(x)|y}],

where H(·)  G is the projection of 1 - E1 onto the linear space spanned by Sf that minimizes Var{S(2)(1)}. Apparently, Var{S(1)(1)} is always larger than Var{S(2)(1)}. Nonetheless, by combining the two case-control studies, the score function of 1 becomes

S(3)(1) {1 - E(1|y)} - [g(x) - E{g(x)|y} + b2{2 - E(2|y)}] ,

11

where b2 is some constant and g(·)  G such that Var{S(3)(1)} is minimized and nonnegative definite.

Theoretically speaking, the maximum likelihood estimator ^1(1) for single case-control study with known f (·) is most efficient for estimating 1, thus combining another case-control study
cannot improve efficiency. However, when f (·) is unknown, combining case-control studies
would lead to efficiency improvement in the estimation of 1. For instance, when the sample
size of the second case-control study to be combined is much larger than that of the first one, our proposed estimator ^1(3) can be nearly as efficient as ^1(1) asymptotically, implying ^1(3) is more efficient than ^1(2) for estimating the slope parameter 1. In other words, it can be shown that,

lim
r1 /r2 0

1 r1

Var{S(1)(1)}

=

lim
r1 /r2 0

1 r1

Var{S(3)(1)},

where rk = nk/N , k = 1, 2.

3 Empirical results

Finite-sample studies are carried out to examine the performance of our proposed method under different scenarios. We consider binary outcome and generate independent data from the following models

P (Yk

=

1|Xk

=

x)

=

1 1 + e-(k+kx)



(k

+ kx),

k = 1, 2, . . . , K,

where k  Rd, k = 1, . . . , K. The d-vector predictor X follows the same distribution F (·) across K logistic regression models. Thus, the true population percentage of cases in the k-th subpopulation can be calculated via pk  P (Yk = 1) = (k + kx)dF (x), k = 1, ..., K. The case-control sampling are then conducted by taking samples separately from the case population and the control population from each subpopulation respectively. Let qk = nk1/nk, k = 1, ..., K, be the case proportion in the k-th case-control study.

3.1 Simulated data: verifying identifiability conditions
We investigate the identifiability of K intercepts under various settings. In cases (a1)­(a4), X1 and X2 are independent standard normal random variables. For simplicity, set n1 = n2, n11 = n10 and n21 = n20. The pooled sample size N = n1 + n2 = 500. The following
12

scenarios (a1)­(a6) are tried for K = 2 and d = 2. The results of each case are based on 1000 replications.
(a1) (1 = 2, 1 = 0, 2 = 0) Set 1 = (2, 2, 3), 2 = (-1, 3, 2); then, p1  0.691 and p2  0.402;
(a2) (1 = 2, 1 = 0, 2 = 0) Set 1 = (2, 2, 3), 2 = (2, 3, -1); then, p1  0.691 and p2  0.710;
(a3) (1 = 2, 1 = 0, 2 = 0) Set 1 = (2, 2, 3), 2 = (1, 0, 0); then, p1  0.691 and p2  0.731;
(a4) (1 = 2, 1 = 2 = 0) Set 1 = (2, 2, 3), 2 = (-1, 2, 3); then, p1  0.691 and p2  0.402;
(a5) (1 = 2, 1 = 2 = 0) Set 1 = (2, 0, 0), 2 = (-1, 0, 0); then, p1  0.881 and p2  0.269;
(a6) (1 = 2, 1 = 2 = 0) Set 1 = 2 = (2, 3, 2); then, p1 = p2  0.691.
In Table 1 and 2, we present the bias of the estimates of the regression parameters and pk, the empirical standard errors (SE), the average of the estimated standard errors (ESE) and the 95% coverage probabilities (CP) with our proposed method. It is seen that for all cases,  is always identifiable. For the identifiability of the intercepts, when the slope parameters are different across two models, 1 and 2 are both identifiable for Cases (a1)­(a2) in Table 1. We have to emphasise that in Case (a3), 1 is identifiable but 2 is not identifiable with the proposed method. On the other hand, in the case that the two subpopulations share the same , 1 and 2 are identifiable in Case (a4), but 1 and 2 are not identifiable in Cases (a5)­(a6). In addition, the results in Table 1 and 2 show that the proposed pooled case-control studies method produces accurate estimation for the population percentages of cases and controls. All observations here are consistent with the discussions in section 2.1.
3.2 Simulated data: comparing three different methods
In the second part, we conduct simulations to examine the efficiency gain in estimating the slope parameters with our proposed method by comparing the variance of three estimators: the maximum likelihood estimator for single case-control study with known f (·) denoted by ^(1), the maximum likelihood estimator for single case-control study with unknown f (·) (Scott and Wild, 1986) denoted by ^(2) and our proposed estimator denoted by ^(3). The settings of cases (b1)­(b4) are given in Table 3. For the convenience of comparison, we set
13

the dimension of  to be one in all cases in this subsection. The results of cases (b1)­(b4) summarized in Tables 4­5 are based on 1000 replications.
By comparing the ESEs of i in Tables 4­5, one can observe that ^(1) is most efficient and ^(2) is least efficient among the three estimators, which confirms our theory. Significant efficiency gain in estimating the slope parameter with our proposed method are observed when some rk is getting close to 0, as in the second case-control study in Cases (b2) and (b3). Furthermore, as shown in Table 4 Case (b3), ^2(1) is nearly as efficient as ^2(3) and the estimated standard errors of ^2(1) are significantly smaller, when the sample sizes of the other two case-control studies are large enough. On the other hand, when the number of case-control studies increases, it can be seen from Cases (b1) and (b4) in Table 5 that ^i(3) is more efficient than ^i(2). Lastly, we observe that when the proportion of cases qi in single case-control study sample is close to 1 or 0 and |pi - qi| is large, as in the 1st, 2nd, 4th and 5th case-control studies in Case (b4), combining several case-control studies can balance the proportions between cases and controls, and thus leads to more efficient estimation for i.
3.3 Hepatitis C infection dataset
The proposed method is applied to real-life data from a published study on liver fibrosis and cirrhosis in patients with chronic hepatitis C infection, which is available at https:// archive.ics.uci.edu/ml/datasets/HCV+data (Lichtinghagen et al. 2013). It is known that progressive fibrosis is a major cause of morbidity and mortality in chronic liver disease. Factors having high correlations with fibrosis stages in chronic liver disease are included in this study.
Following the data pre-processing procedure in Hoffmann et al. (2018), 589 patients are selected aged between 23 to 77. They have been divided into 4 categories already: the healthy ones, the Hepatitis, the Fibrosis and the Cirrhosis, with sample size 533, 20, 12 and 24 respectively. Among the 12 predictors (age, sex and 10 other measurands), according to Hoffmann et al. (2018), 6 predictors including ALB, BIL, CHE, GGT, AST, ALT are used in the decision tree for clustering and performs well. Hence, we fit model (2) with the 6 factors. To illustrate the idea of combining case-control studies, we randomly partition the 533 healthy samples into three subsets with size 177, 177 and 179 respectively, and obtain 3 case-control studies on Hepatitis, Fibrosis and Cirrhosis as the mixture of the healthy subgroup (controls) with each diseased groups (cases) respectively. Especially, the casecontrol study on Hepatitis consists of 177 controls and 20 Hepatitis cases; the case-control
14

study on Fibrosis consists of 177 controls and 12 Fibrosis cases; the case-control studies on Cirrhosis consists of 179 controls and 24 Cirrhosis cases.
We apply our combining case-control studies method to fit model (2) with 6 predictors and K = 3. We repeat our proposed method by randomly splitting the healthy group for 50 times. For comparison, the odds ratio method by Prentice and Pyke (1979) is applied to each case-control study. The results are presented in Table 6, from which one can see that each factor contributes to the severity of the disease. By combining the three case-control studies, our proposed estimator gives stable and more efficient estimates compared with the classical odds ratio estimator.
Supplementary material
The supplementary material contains lemmas and technical proofs for the main theorems.
References
Bickel, P. J., Klaassen, C. A. J., Ritov, Y. and Wellner, J. A., (1993). Efficient and Adaptive Estimation for Semiparametric Models. Johns Hopkins University Press, Baltimore. Chen, K. and Lo, S. H. (1999). Case-cohort and case-control analysis with Cox's model. Biometrika 8, 755-764. Chen, K. (2001). Parametric models for response-biased sampling. J. R. Statist. Soc. B. 63, 775-789. Chen, K., Lin, Y., Yao, Y. and Zhou, C. (2017). Regression analysis with response-selective sampling. Statist. Sinica 27, 1699-1714. Cox, D. (1958). The regression analysis of binary sequences (with discussion). J. R. Statist. Soc. B. 20, 215-242. Fithian, W. and Hastie, T. (2014). Local case-control sampling: Efficient subsampling in imbalanced data sets. Ann. Statist. 42, 1693-1724.
15

Hoffmann, G., Bietenbeck, A., Lichtinghagen, R. and Klawonn, F. (2018). Using machine learning techniques to generate laboratory diagnostic pathways a case study. J. Lab. Precis. Med. 3, 1-10.
Kim, J. P., Lu, W., Sit, T. and Ying, Z. (2013). A unified approach to semiparametric transformation models under general biased sampling schemes. J. Am. Statist. Assoc. 108, 217-227.
Kim, J. P., Sit, T. and Ying, Z. (2016). Accelerated failure time model under general biased sampling scheme. Biostatistics 17, 576-588.
Lichtinghagen, R., Pietsch, D., Bantel, H., Manns, M., Brand, K. and Bahr, M. (2013). The Enhanced Liver Fibrosis (ELF) score: Normal values, influence factors and proposed cut-off values. J. Hepatology. 59, 336-342.
Liu, M., Lu, W. and Tseng, C. H. (2010). Cox regression in nested case-control studies with auxiliary covariates. Biometrics 66, 374-381.
Liu, X., Jiang, H. and Zhou, Y. (2014). Local empirical likelihood inference for varying coefficient density-ratio models based on case-control data. J. Am. Statist. Assoc. 109, 635-646.
Lu, W. and Tsiatis, A. A. (2006). Semiparametric transformation models for the casecohort study. Biometrika 93, 207-214.
Manski, C. F. and Lerman, S. R. (1977). The estimation of choice probabilities from choice based samples. Econometrica 45, 1977-1988.
Manski, C. F. and McFadden, D. (1981). Structural analysis of discrete data with econometric applications. Cambridge: The MIT Press.
Manski, C. F. (1993). Identification of Endogenous Social Effects: The Reflection Problem. The Review of Economic Studies 60, 531-542.
Ni, A., Cai, J. and Zeng, D. (2016). Variable selection for case-cohort studies with failure time outcome. Biometrika 103, 547-562.
Prentice, R. L. and Pyke, R. (1979). Logistic disease incidence models and case-control studies. Biometrika 66, 403-411.
16

Prentice, R. L. (1986). A case-cohort design for epidemiologic cohort studies and disease prevention trials. Biometrika 73, 1-11.
Qin, J. and Zhang, B. (1997). A goodness-of-fit test for logistic regression models based on case-control data. Biometrika 84, 609-618.
Qin, J. (1993). Empirical likelihood in biased sample problems. Ann. Statist. 21, 11821196.
Qin, J. (2017). Biased sampling, over-identified parameter problems and beyond. Springer, New York.
Scott, A. J. and Wild, C. J. (1986). Fitting logistic models under case-control or choice based sampling. J. R. Statist. Soc. B. 48, 170-182.
Scott, A. J. and Wild, C. J. (1997). Fitting regression models to case-control data by maximum likelihood. Biometrika 84, 57-71.
Tao, R., Zeng, D. and Lin, D. Y. (2017). Efficient semiparametric inference under twophase sampling, with applications to genetic association studies. J. Am. Statist. Assoc. 112, 1468-1476.
Vardi, Y. (1982). Nonparametric Estimation in the Presence of Length Bias. Ann. Statist. 10, 616-620.
Vardi, Y. (1985). Empirical distributions in selection bias models. Ann. Statist. 13, 178203.
Xu, G., Sit, T., Wang, L. and Huang, C. Y. (2017). Estimation and inference of quantile regression for survival data under biased sampling. J. Am. Statist. Assoc. 112, 1571-1586.
Zeng, D., Yin, G. and Ibrahim, J. G. (2006). Semiparametric transformation models for survival data with a cure fraction. J. Am. Statist. Assoc., 101, 670-684.
Zeng, D. and Lin, D. Y. (2007). Semiparametric transformation models with random effects for recurrent events. J. Am. Statist. Assoc. 102, 167-179.
Zeng, D. and Lin, D. Y. (2014). Efficient estimation of semiparametric transformation models for two-phase cohort studies. J. Am. Statist. Assoc. 109, 371-383.
17

Table 1: Estimation results for 1 = 2 and N = 500.

Par.

Case (a1)

True Bias SE ESE CP

1

2 0.060 0.472 0.467 0.958

11

2 0.065 0.329 0.320 0.946

12

3 0.111 0.433 0.423 0.961

2

-1 -0.039 0.430 0.442 0.963

21

3 0.108 0.447 0.424 0.951

22

2 0.075 0.331 0.322 0.954

p1 0.691 -0.004 0.082 p2 0.402 -0.001 0.086

Case (a2)
True Bias SE ESE CP
2 0.040 0.373 0.367 0.943 2 0.067 0.343 0.321 0.938 3 0.106 0.445 0.423 0.950 2 0.035 0.369 0.362 0.943 3 0.110 0.412 0.402 0.956 -1 -0.033 0.236 0.228 0.946
0.691 -0.002 0.049 0.710 -0.003 0.050

Case (a3)

True

Bias SE ESE CP

2 -0.159 0.371 0.391 0.941

2 0.096 0.329 0.326 0.964

3 0.150 0.431 0.429 0.957

1 -16.605 7.738

* 1.000

0 0.073 0.146 0.115 0.844

0 0.106 0.130 0.120 0.848

0.691 -0.046 0.049 0.731 -0.661 0.157

Notes: "Par." stands for parameter; "True" means the true value of the parameter; the symbol * means the value is greater than 104.

Table 2: Estimation results for 1 = 2 and N = 500.

Par.

Case (a4)

True Bias SE ESE CP

1

2 0.073 0.487 0.498 0.959

11

2 0.071 0.341 0.321 0.946

12

3 0.111 0.445 0.423 0.947

2

-1 -0.022 0.464 0.477 0.957

21

2 0.058 0.319 0.319 0.959

22

3 0.090 0.430 0.420 0.947

p1 0.691 0.000 0.088 p2 0.402 0.003 0.094

Case (a5)

True Bias SE ESE CP

2 -8.343 10.358

* 0.983

0 0.004 0.149 0.125 0.915

0 -0.000 0.154 0.125 0.905

-1 -6.033 18.097

* 1.000

0 0.004 0.146 0.125 0.924

0 0.004 0.148 0.125 0.920

0.881 -0.608 0.250 0.269 0.010 0.254

Case (a6)
True Bias SE ESE CP
2 -1.872 2.704 2.016 0.798 3 0.130 0.478 0.427 0.933 2 0.096 0.362 0.323 0.931 2 -1.828 2.301 1.917 0.795 3 0.121 0.451 0.425 0.956 2 0.092 0.341 0.322 0.946
0.691 -0.320 0.274 0.691 -0.322 0.272

Notes: "Par." stands for parameter; "True" means the true value of the parameter; The symbol * means the value is greater than 104.

18

Table 3: Simulation settings for Cases (b1)­(b4).

Case K N CC Study i i i ni0 ni1 ni

ri

qi

pi

(b1) 2 830

1 -3 2 500 10 510 0.615 0.020 0.130 2 -2 3 20 300 320 0.277 0.938 0.283

(b2) 3 1020

1 -3 2 -2 3 -1

2 500 10 510 0.500 0.020 0.130 3 20 300 320 0.314 0.938 0.283 1 100 90 190 0.186 0.474 0.303

(b3) 3 7320

1 -3 2 -2 3 -1

2 5000 100 5100 0.697 0.020 0.130 3 20 300 320 0.043 0.938 0.283 1 1000 900 1900 0.260 0.474 0.303

(b4) 5 1480

1 -3 2 2 -2 3 3 -1 1 412 5 4 -5

500 10 20 300 100 90 200 20 200 40

510 0.345 0.020 0.130 320 0.216 0.938 0.283 190 0.128 0.474 0.303 220 0.149 0.091 0.648 240 0.162 0.167 0.774

Notes: CC study i represents the i-th case control study.

Table 4: Estimation results for Cases (b2)-(b3).

Case Par. True

(b2) 1 -3

1

2

2 -2

2

3

3 -1

3

1

(b3) 1 -3

1

2

2 -2

2

3

3 -1

3

1

^(3) (Combining multiple CC)

Bias SE ESE CP

-0.135 0.096 0.063 0.082 0.106 0.032

1.530 0.501 0.604 0.467 1.071 0.192

1.510 0.484 0.601 0.440 1.282 0.194

0.939 0.961 0.938 0.957 0.977 0.967

-0.043 0.008
-0.025 0.064
-0.021 0.007

0.498 0.143 0.302 0.381 0.417 0.060

0.494 0.148 0.306 0.368 0.407 0.060

0.956 0.957 0.955 0.946 0.974 0.953

^(2) (single CC with unknown f )

Bias SE ESE CP

-2.149 0.098 3.659 0.150 0.721 0.030

0.581 0.498 0.220 0.619 0.078 0.193

0.655 0.500 0.308 0.570 0.165 0.194

0.000 0.985 0.000 0.966 0.000 0.965

-2.018 0.007 3.642 0.121 0.725 0.007

0.161 0.144 0.202 0.579 0.024 0.060

0.195 0.150 0.305 0.562 0.052 0.060

0.000 0.956 0.000 0.959 0.000 0.955

^(1) (single CC with known f )

Bias SE ESE CP

-0.212 0.087
-0.011 0.040
-0.015 0.031

1.574 0.449 0.204 0.358 0.432 0.192

0.705 0.430 0.199 0.344 0.442 0.197

0.933 0.944 0.940 0.937 0.954 0.951

-0.006 0.005
-0.017 0.062 0.001 0.007

0.215 0.133 0.200 0.357 0.133 0.060

0.219 0.134 0.199 0.341 0.135 0.060

0.951 0.949 0.946 0.943 0.959 0.943

Notes: "Par." stands for parameter; "True" means the true value of the parameter.

19

Table 5: Estimation results for cases (b1) and (b4).

Case Par. True

(b1) 1 -3

1

2

2 -2

2

3

(b4) 1 -3

1

2

2 -2

2

3

3 -1

3

1

4

1

4

2

5

4

5 -5

^(3) (Combining multiple CC)

Bias SE ESE CP

-0.242 0.121 0.100 0.164

1.694 0.500 0.789 0.520

1.915 0.489 0.832 0.487

0.943 0.957 0.946 0.962

-0.217 0.119 0.006 0.071
-0.093 0.034
-0.037 0.159 0.048
-0.105

1.281 0.501 0.491 0.411 0.985 0.188 0.347 0.333 0.518 0.728

1.218 0.482 0.476 0.412 1.359 0.193 0.387 0.357 0.512 0.744

0.932 0.962 0.934 0.969 0.969 0.972 0.965 0.973 0.950 0.963

^(2) (single CC with unknown f )

Bias SE ESE CP

-2.180 0.117 3.651 0.151

0.595 0.510 0.213 0.589

0.663 0.502 0.307 0.569

0.000 0.974 0.000 0.969

-2.163 0.112 3.657 0.163 0.717 0.033
-2.935 0.165
-2.778 -0.215

0.618 0.528 0.202 0.581 0.077 0.188 0.164 0.420 0.490 0.976

0.660 0.503 0.307 0.571 0.166 0.194 0.288 0.433 0.518 0.926

0.000 0.965 0.000 0.976 0.000 0.970 0.000 0.977 0.012 0.963

^(1) (single CC with known f )

Bias SE ESE CP

-0.247 0.085
-0.009 0.070

1.701 0.461 0.203 0.358

0.708 0.430 0.199 0.342

0.924 0.941 0.942 0.928

-0.089 0.090 0.005 0.055
-0.052 0.034
-0.043 0.132 0.038
-0.080

0.744 0.453 0.200 0.338 0.443 0.188 0.272 0.318 0.387 0.668

0.711 0.431 0.199 0.345 0.437 0.194 0.298 0.317 0.392 0.666

0.942 0.934 0.946 0.949 0.943 0.955 0.974 0.917 0.958 0.946

Notes: "Par." stands for parameter; "True" means the true value of the parameter.

Table 6: The factors contribution to severity of Hepatitis C.

Intercept ALB BIL CHE GGT AST ALT

Heptitis

CC -2.2853 -0.0018 0.1279 -0.08036 0.0833 0.1824 0.2812

ESE 0.9956 0.0377 0.0635 0.0541 0.0433 0.0798 0.3352

OR

- 1.0562 0.9828 0.2034 1.0469 3.0837 -3.3217

ESE

- 0.3447 0.2808 0.1875 0.3986 0.6535 0.2302

Fibrosis

Estimate ESE OR ESE

-1.5776 -0.0238 0.0757 0.6873 0.0329 0.0428
- 1.3201 1.5949 - 1.8341 1.2701

-0.1153 0.0311 0.1938 0.0622 0.0255 0.0858 0.8936 0.8637 0.4984 1.6885 1.0885 1.5637

0.4932 0.2356 -1.0698 1.1433

Cirrhosis

Estimate ESE OR ESE

-0.7060 -0.4429 0.4713 0.3067 0.1996 0.2076
- -0.9545 1.2938 - 1.2729 1.8339

-0.5456 0.3599 0.4597 0.4110 0.2416 0.1607 0.2015 0.2641 0.07654 0.3382 1.9898 -21.5351 1.2588 2.9500 2.5459 3.9564

Notes: "CC" stands for the proposed method by combining case-control studies; "ESE" represents the estimated standard errors for the parameter estimate; "OR" stands for the odds ratio estimator by Prentice and Pyke (1979).

20

