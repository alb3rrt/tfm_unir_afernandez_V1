Symmetry-preserving enforcement of low-dissipation method based on boundary variation diminishing principle
Hiro Wakimuraa,, Shinichi Takagia, Feng Xiaoa,
aDepartment of Mechanical Engineering, Tokyo Institute of Technology, 2-12-1 Ookayama, Meguro-ku, Tokyo, 152-8550, Japan

arXiv:2106.01872v1 [math.NA] 3 Jun 2021

Abstract
A class of high-order shock-capturing schemes, PnTm-BVD (Deng et al., J. Comp. Phys., 386:323349, 2019; Comput. & Fluids, 200:104433, 2020.) schemes, have been devised to solve the Euler equations with substantially reduced numerical dissipation, which enable high-resolution simulations to resolve flow structures of wider range scales. In such simulations with low dissipation, errors of round-off level might grow and contaminate the numerical solutions. A typical example of such problems is the loss of symmetry in the numerical solutions for physical problems of symmetric configurations even if the schemes are mathematically in line with the symmetry rules. In this study, the mechanisms of symmetry-breaking in a finite volume framework with the P4T2-BVD reconstruction scheme are thoroughly examined. Particular attention has been paid to remove the possible causes due to the lack of associativity in floating-point arithmetic which is associated with round-off errors. Modifications and new techniques are proposed to completely remove the possible causes for symmetry breaking in different components of the P4T2-BVD finite volume solver. Benchmark tests that have symmetric solution structures are used to verify the proposed methods. The numerical results demonstrate the perfect symmetric solution structures.
Keywords: Compressible flow, Symmetry-preserving, Finite volume method, Low-dissipation, Boundary variation diminishing, High-order scheme.

1. Introduction
The most pronounced feature of compressible flow is that both smooth and discontinuous flow structures, such as vortices, acoustic waves, turbulence, shock waves, and contact surfaces, evolve simultaneously in the computational domain of interest. It remains a big challenge to design numerical schemes that capture both discontinuous and smooth solutions of wide-range scales. The finite volume method based on the Godunov scheme [1] is the most widely-used mainstream numerical framework for compressible flows because of its rigorous conservativeness at the discrete level, which is crucial to correctly capture the nonlinear discontinuous solutions. Tremendous efforts have been made to develop high-resolution schemes for spatial reconstruction in the finite volume framework during the past decades. In general, spatial reconstructions using high-order polynomials are needed to reduce numerical dissipation so as to resolve wide-range scale flow structures, however, as stated in Godunov's theorem [1], any linear scheme with a polynomial equal to or higher than 1st-order tends to generate numerical oscillations in the vicinity of the

Corresponding author Email addresses: wakimura.h.aa@m.titech.ac.jp, ijsp090724@gmail.com (Hiro Wakimura), xiao.f.aa@m.titech.ac.jp (Feng Xiao)

Preprint submitted to Elsevier

June 4, 2021

discontinuities. Hence, a large class of reconstruction schemes have been extensively explored based on the so-called nonlinear limiting projection. An ideal high-resolution shock-capturing scheme is expected to be able to effectively suppress spurious oscillations while retaining high order and reducing excessive numerical dissipation or viscosity to adequately resolve flow structures of small scales.
TVD (Total Variation Diminishing) schemes [2] including MUSCL (Monotone Upstream-centered Schemes for Conservation Law) scheme [3] maintains monotonicity by introducing the slope limiter, which suppresses the numerical oscillations near the discontinuities while retrieving nearly 2nd-order accuracy for smooth solutions. Although the numerical dissipation of the TVD schemes is rather smaller than that of the 1st-order Godunov scheme, excessive numerical dissipation is still too large to make them attractive in applications where vortices and turbulence are of great importance. Progress has been made to use high-order polynomials with nonlinear limiting projection. Being the most representative schemes, ENO (Essentially Non-Oscillatory) scheme [4, 5] and WENO (Weighted Essentially Non-Oscillatory) scheme [6, 7] were proposed. These schemes achieved high convergence order (higher than 2nd-order) while suppressing numerical oscillation by adaptively selecting or weighting the smooth sub-stencils. Successive researches were carried out to devise variants of the smooth indicator [8, 9, 10, 11, 12, 13, 14, 15, 16, 17] to suppress the numerical dissipation near the discontinuities. Nevertheless, the numerical dissipation of these schemes remains non-negligible and tends to smear out the fluid structures such as contact discontinuities and small-scale vortices. Moreover, the nonlinear limiting projection, which degrades the degree of reconstruction function near a discontinuity, can hardly recover the low-dissipation property of the original linear scheme using the unlimited polynomial with constant coefficients.
Based on the observation that the dissipation term in the approximate Riemann solvers can be effectively reduced by minimizing the difference between the reconstructed left- and right-side values at cell boundaries (referred to as BV (boundary variation)), a new class of reconstruction schemes so-called BVD (Boundary Variation Diminishing) schemes have been proposed in [18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28]. The first BVD scheme [18], so-called WENO-THINCBVD scheme, switches the reconstruction function to WENO scheme for smooth solutions and THINC (Tangent of Hyperbola for INterface Capturing) for discontinuous solutions. The THINC scheme was originally developed for capturing moving interfaces [29, 30, 31] and thus more suitable for representing the discontinuous solutions of a step-jump shape. As the THINC can more accurately mimic a discontinuous solution within a mesh cell, it effectively reduces the BV of the reconstructed values across cell boundaries, which enables the BVD criterion to choose the THINC function in presence of a discontinuity. Meanwhile, the polynomial-based WENO interpolation leads to smaller BV values for smooth solutions, so the BVD scheme will select the WENO scheme as the reconstruction function. As a result, the WENO-THINC-BVD scheme significantly reduces the numerical dissipation and shows superiority in resolving both smooth and discontinuous solutions. As a high-resolution shock-capturing scheme without using the conventional nonlinear limiting projection, the P4T2-BVD (polynomial of 4-degree and THINC function of 2-level reconstruction based on BVD algorithm) scheme was proposed in [23], which combines the unlimited polynomial of the four degree and THINC schemes, THINC(s) and THINC(l) with different steepness parameters. The P4T2-BVD scheme uses a 2-stage BVD algorithm to select the reconstruction function under the BVD principle, and greatly improves numerical solutions regarding numerical dissipation. The numerical results of the P4T2-BVD scheme can resolve both smooth and discontinuous solutions with superior fidelity compared to other existing shockcapturing schemes that use the nonlinear limiters to the polynomial interpolants in the presence of discontinuities. It is also demonstrated in [25] that higher-order BVD schemes, PnTm-BVD
2

(polynomial of n-degree and THINC function of m-level reconstruction based on BVD algorithm) schemes, can be designed by using high-order unlimited polynomials and THINC functions with multi-stage BVD algorithms. It is noted that the BVD principle is general and can be applied to design low dissipation schemes using other candidate functions for reconstruction [32] or other numerical framework [33]. With substantially reduced numerical dissipation, the BVD schemes can effectively preserve small-scale flow structures from being dampened out.
As discussed above, shock-capturing schemes evolve to meet the requirement from applications where numerical dissipation has to be substantially reduced. In practice, numerical dissipation can be reduced by either designing numerical methods of less dissipation error or refining computational grids for simulations. Modern computer hardwares facilitate the use of advanced high-order schemes with fine mesh resolution, which enables us to produce simulation results with extremely low numerical dissipation. With less numerical dissipation, flow structures of small scale remain unattenuated, so do perturbations stemming from floating-point arithmetic errors that are unavoidable in numerical processing. As a result, the numerical solution may lose spatial symmetry even started from a symmetrical setup. It is commonly observed that highresolution simulations with fine meshes usually lead to undesirable asymmetrical numerical results [34, 35, 36, 37, 13, 38, 39, 40, 33, 41, 42, 26] in application problems that possess physical symmetry in solution structures, such as the Rayleigh-Taylor instability (RTI) and the symmetric implosion benchmark problems. The symmetry-breaking results might not be visible in simulations with significant numerical dissipation, and have not been seen as a serious problem in the past.
Remacle et al. [35] initially reported that the symmetry error is caused by the rounding error of floating-point arithmetic, which grows asymmetrically with time evolution. Don et al. suggested a numerically stable form of the smooth indicator in the WENO framework [43, 44]. In this scheme, the symmetry error was effectively reduced compared to the original 7th- and 9th-order WENO schemes, but the cause of the symmetry error has not been completely eliminated. Wang et al. [45] preserved the symmetry property by replacing the two values of solutions at symmetrically placed cells with their average value. Fleischmann et al. [46] attribute the cause of asymmetric rounding errors to the lack of associativity in summations or multiplications for more than two components and carefully analyzed the solution procedure of some WENO/TENO schemes. It is shown that by adjusting the orders of summations and multiplications throughout the calculation procedure, the symmetry errors can be completely eliminated in the high-resolution simulations that implement WENO-like schemes on fine meshes. To our knowledge, [46] is the first work that implements the WENO-type schemes to ensure exact symmetry property in numerical solutions.
In this paper, we propose symmetry-preserving P4T2-BVD scheme which belongs to another sort of high-order reconstruction approach different from the WENO-type schemes dealt with in [46]. As the original THINC scheme may generate the symmetry error, a new formulation of symmetry-preserving THINC scheme is presented. Moreover, we thoroughly examined the possible causes in the numerical formulations for different components of the numerical solver, including the transformation between conservative and characteristic variables, spatial reconstruction and approximate Riemann solver. We clarified some important issues which have not been specified in [46] or other existing literature. Countermeasures are proposed to exactly ensure the spatial symmetry in numerical solutions to physical benchmarks of symmetrical configurations. Not limited to the BVD method, the symmetry-preserving techniques introduced in this paper are efficient and easy to be embedded into the finite volume framework. Essentially, the present symmetrypreserving techniques modify the operations that might generate different machine errors without compromising the performances of the original schemes.
The rest of this paper are organized as follows. In section 2, the inviscid Euler equations
3

are briefly reviewed as the governing equations. In section 3, the calculation procedure of P4T2BVD scheme is briefly explained. In section 4, we thoroughly examine the mechanisms of the symmetry-error generation in the finite volume framework using P4T2-BVD reconstruction and propose symmetry-preserving techniques to eliminate the possible causes for symmetry-breaking. Numerical results of benchmark tests which have symmetry properties are shown in section 5 for verification. Conclusion is given in section 6 to end this paper.

2. Governing equations

We consider inviscid compressible flow, and use the following 2D Euler equations as the gov-

erning equations.

U t

+

F(U) x

+

G(U) y

=

0,

(1)

where U is the vector of conservative variable, and F and G are the vectors of flux functions in xand y-directions respectively. The components of these vectors are given explicitly as below,



 u 

 v 

U

=

u

v

 

,

F(U)

=

  

u2 + uv

p

  

,

G(U)

=

  

vu v2 +

p

  

,

(2)

E

(E + p)u

(E + p)v

where  is the density, u and v are the x- and y-components of the velocity, E is the total energy

per unit volume, and p the static pressure.

The Euler equations (1) are closed by adding the equation of state (EOS) of the ideal gas as

follows,

p = ( - 1)

E

-

1 2



u2 + v2

,

(3)

where  is the specific heat ratio, and  = 1.4 is used in the present work unless specifically noted. In the numerical formulation presented in this work, the spatial reconstructions are imple-
mented in terms of characteristic variables, and the arrangement of arithmetic operations of transformation among conservative variables and characteristic variables is crucial to maintain the symmetry in numerical solutions. Thus, we provide explicitly the details of the transformation relations,

Wx = Lx · U and U = Rx · Wx,

(4)

Wy = Ly · U and U = Ry · Wy,

(5)

where Wx and Wy are characteristic variables used for reconstructions in x- and y-directions, and denoted respectively by

w(u-c)

w(v-c)

Wx

=

 w(u)  w(u+c)

,

Wy

=

 w(v)  w(v+c)

.

(6)

w(u)

w(v)

Here, c =

p 

is

the

sound

speed,

and

symbol

""

is

used

to

distinguish

the

components

corre-

sponding to the two eigenvalues u and v. The left eigen matrices and the right eigen matrices in

4

x- and y-directions are written as

Lx

=

l(u-c)  l(u)   l(u+c)

=

1
2
 1 2

b1

+

u c

1 - b1

b1

-

u c

-

1 2

1 c

+

b2u

b2u

1 2

1 c

-

b2u

-

1 2

b2v

1 2

b2



b2v

-

1 2

b2v

-b2

1 2

b2

 

=

lx1

lx2

lx3

lx4

,

l(u)

-v

0

10

Ly

=

l(v-c) 

 l(v) 



l(v+c)

 

=

1
2
 1 2

b1

+

v c

1 - b1

b1

-

v c

-

1 2

b2

u

b2u

-

1 2

b2

u

-

1 2

1 c

+

b2v

b2v

1 2

1 c

-

b2v

1 2

b2



-b2

1 2

b2

 

=

ly1

ly2

ly3

ly4

,

(7)

l(v)

-u

1

0

0

1

1

1 0

Rx =

r(u-c)

r(u)

r(u+c)

r(u)

=

  

u-c v

u v

u+c v

0 1

=

rx1

rx2

rx3

rx4 ,

H - uc

u2 +v2 2

H + uc

v

(8)

1

1

1 0

Ry = r(v-c)

r(v)

r(v+c)

r(v)

=

  

v

u -

c

u v

u v+c

1 0

=

ry1

ry2

ry3

ry4 ,

H - vc

u2+v2 2

H + vc u

where b1 =

, u2+v2 -1 2 c2

b2 =

-1 c2

,

and

the

enthalpy

H

=

E+p 

.

It is noted that the eigen vectors

in (7) and (8) are written in the natural order. However, the arrangement of eigenvectors in the

eigen matrices affects the symmetry property in numerical solution, which will be discussed later.

3. Numerical methods

For the sake of simplicity, we use the 1D scalar hyperbolic conservation law as the model equation to describe numerical schemes, which is cast in the general form as,

q t

+

f (q) x

=

0,

(9)

where q(x, t) is the solution of the conservative variable and f (q) is the flux function. The characteristic speed a = f (q)/q is a real number because of the hyperbolicity of Eq. (9).

3.1. Finite volume method

We divide the computational domain into N non-overlapping cells, i = [xi-1/2, xi+1/2], i =

1, 2, ..., N , and assume that the cell size x = xi+1/2 - xi-1/2 is uniform over the computational domain for brevity.

For a standard finite volume method, the volume-integrated average of the solution in cell i

is defined as,

q¯i(t)



1 x

xi+1/2
q(x, t)dx.
xi-1/2

(10)

The solution q¯i(t) for each cell i is updated by the semi-discrete version of Eq. (9) as

dq¯i dt

=

-

1 x

f^i+

1 2

-

f^i-

1 2

,

(11)

5

where

f^i+

1 2

is

the

numerical

flux

at

cell

boundary

xi+

1 2

.

In a Godunov finite volume method,

numerical

flux

f^i+

1 2

is

calculated

by

an

approximate

Riemann

solver,

f^i+

1 2

= f Riemann

qiL+

1 2

,

qiR+

1 2

,

(12)

where qiL+1/2 and qiR+1/2 stand for the left-side and right-side values of solution q at the cell boundary xi+1/2 computed from spatial reconstructions. Although various approximate Riemann solvers have been proposed in different forms, we present them in a canonical form that consists of a central scheme and a dissipation (or viscosity) term,

f Riemann

qiL+

1 2

,

qiR+

1 2

=

1 2

f

qL

i+

1 2

+f

qR

i+

1 2

-

1 2

ai+

1 2

qR

i+

1 2

-

qiL+

1 2

.

(13)

Given a Riemann solver, the spatial reconstruction scheme that calculates the boundary values qiL+1/2 and qiR+1/2 over the left- and right-biased stencils plays the key role to determine the solution quality of numerical results. In next subsection, we focus on the numerical scheme, so-called the
P4T2-BVD scheme, for spatial reconstruction.

3.2. The P4T2-BVD scheme

BVD principle [18] has been proposed as a general guideline for spatial reconstruction with

reduced numerical dissipation. In the canonical form of the Riemann flux shown in Eq. (13),

the second term on the right-hand side can be interpreted as numerical viscosity/dissipation. It

is observed that the difference of the reconstructed values at cell boundary, so-called boundary

variation (BV),

B

Vi+

1 2

=

qR

i+

1 2

-

qiL+

1 2

,

(14)

is in proportion to numerical dissipation. The BVD principle suggests that spatial reconstruction

should be devised so that the value of BVi+1/2 is minimized. In BVD schemes, the BVD principle is used as a criterion to select a reconstruction function from multiple candidate functions. Some

practical BVD selection algorithms have been proposed so far to design variants of BVD schemes

[18, 21, 20, 22]. High-fidelity schemes which have superior properties in suppressing both numerical

oscillation and dissipation can be designed by using BVD algorithms and properly chosen candidate

interpolation functions.

Being a representative BVD scheme, the P4T2-BVD scheme [23, 25], makes use of the unlimited 4th-degree polynomial and two THINC functions of different steepness parameters, namely

THINC(s) and THINC(l) . The selection of the reconstruction function is performed by comparing the values of the total BV (T BV ) [22] of the reconstructed values in a 2-stage algorithm. It

is demonstrated that the P4T2-BVD scheme can effectively remove numerical oscillations without using the conventional nonlinear limiting projections which are widely used in other high-resolution

shock capturing schemes. For completeness, we describe the P4T2-BVD scheme in this subsection.

3.2.1. Candidate interpolant 1: 4th-degree polynomial scheme

In the P4T2-BVD scheme, the physical quantity q is reconstructed by the linear 4th-degree polynomial as one of the candidate interpolation functions. The reconstruction function Q(x) for

target cell i is written as

4

QPi 4(x) = ak(x - xi)k.

(15)

k=0

6

The superscript " P4 " stands for the 4th-degree polynomial. The unknown coefficients ak(k = 0, 1, 2, 3, 4) are determined from the following constraint conditions,

1 x

xj+

1 2

QPi 4(x)dx

=

q¯j

xj-

1 2

(j = i, i ± 1, i ± 2),

(16)

which require the volume average of the reconstruction function QPi 4 on cell j in the neighbors of the target cell i to be equal to the corresponding cell average of the solution q¯j. Consequently,
the reconstructed boundary values can be obtained by

qL,P4

i+

1 2

=

QPi 4

qR,P4

i-

1 2

=

QPi 4

xi+

1 2

xi-

1 2

=

1 60

(2q¯i-2

- 13q¯i-1

+

47q¯i

+

27q¯i+1

-

3q¯i+2),

=

1 60

(2q¯i+2

-

13q¯i+1

+

47q¯i

+

27q¯i-1

-

3q¯i-2).

(17)

For smooth solutions, the 4th-degree polynomial reconstruction results in a 5th-order convergence rate and provides a optimal approximation for smooth solution, which however tends to generate spurious oscillation due to the Gibbs phenomenon near discontinuous solutions. To suppress the oscillation, the 4th-degree polynomial is replaced by the THINC function that is more suitable to approximate a discontinuous solution through the BVD selection algorithm.

3.2.2. Candidate interpolant 2: THINC scheme
THINC scheme was developed for capturing moving interfaces or free boundaries in multiphase flows [29, 30, 47, 48, 31]. Thanks to its monotonicity and capability to mimic the step-like profile, the THINC reconstruction is also well suited for computing compressible flows including discontinuous solutions with appealing stability and high resolution [22, 23, 25, 24, 26, 27]. In the THINC scheme, the physical quantity q is reconstructed by a hyperbolic tangent function as

QTi (x)

=

q¯min

+

q¯ 2

(1

+



tanh

(

(Xi

-

di)))

(18)

where

q¯min = min(q¯i-1, q¯i+1), q¯ = |q¯i+1 - q¯i-1|,

 = sgn(q¯i+1 - q¯i-1),

Xi =

x

-

xi-

1 2

.

xi+

1 2

-

xi-

1 2

A superscript " T " stands for the THINC scheme. Since the THINC function (18) is a monotonic

function, it can be applied only if the monotonicity condition (q¯i - q¯i-1)(q¯i+1 - q¯i) > 0 is satisfied. Or otherwise, the THINC function degrades to a piecewise constant reconstruction in practice, i.e.

QTi (x) = q¯i. Given the steepness parameter , the only unknown parameter in (18) is the jump location

(the center of the jump transition layer) di. We determine di from the condition that the volume

integrated average of the reconstruction function QTi over the target cell i is equal to the solution

q¯i, which is written as

1 x

xi+

1 2

QTi (x)dx

=

q¯i.

xi-

1 2

(19)

Then, di can be calculated by

di

=

1 2

ln

1- 1+

A A

,

(20)

7

where

A

=

exp(i)/ cosh()-1 tanh()

,

and

the

parameter

i,

which

implies

the

location

of

the

discontinuity,

is expressed as

i = 

2

q¯i

- q¯min +  q¯ + 

-1

.

(21)

The small number  = 10-20 is introduced to prevent arithmetic failure. Although we can obtain the boundary values of THINC scheme by calculating di from (20) numerically and substituting it into function (18), we directly compute the boundary values by the following formulae for computational efficiency,

qL,T

i+

1 2

= QTi

xi+

1 2

=

q¯min

+

q¯ 2

1

+



tanh() + A 1 + A tanh()

,

qR,T

i-

1 2

= QTi

xi-

1 2

=

q¯min

+

q¯ 2

(1

+

A)

.

(22)

The performance of THINC scheme depends on the value of the steepness parameter  as discussed in [22, 24]. When  is set to 1.6, the reconstruction function becomes closer to a step-like profile and the discontinuous solution can be resolved within about four mesh cells [30]. On the other hand, the THINC scheme with  = 1.1 leads to a smooth interpolation and has almost the same feature as the MUSCL scheme with the van Leer slope limiter [49], which has been demonstrated by the ADR (approximate dispersion relation) analysis [50, 22] and numerical results. We denote the THINC scheme with  = 1.1 by THINC(s) and that with  = 1.6 by THINC(l). In the P4T2-BVD scheme, THINC(s) is used to suppress numerical oscillation near the discontinuities, and THINC(l) is used to reduce the numerical dissipation in the vicinity of discontinuous solutions.

3.2.3. 2-stage BVD algorithm As mentioned above, the selection of the reconstruction function is conducted via a 2-stage
BVD algorithm. I.e., in the 1st stage, either the 4th-degree polynomial or THINC(s) is selected (we denote the selected function as QIi ), and in the 2nd stage, either the function selected in the 1st stage (QIi ) or THINC(l) is selected as the final reconstruction function.
We summarize the solution procedure of the 2-stage BVD algorithm for target cell i as follows.
(I) The 1st stage

(I-I) Set the 4th-degree polynomial QPi 4 as the basic reconstruction function by

QIi = QPi 4 .

(23)

(I-II) Calculate the values of T BVi from the reconstruction of 4th-degree polynomial and THINC(s) as

T BViP4 =

q - q L,P4

i-

1 2

R,P4

i-

1 2

+

q - q L,P4

i+

1 2

R,P4

i+

1 2

,

T BViTs =

q - q L,Ts

i-

1 2

R,Ts

i-

1 2

+

q - q L,Ts

i+

1 2

R,Ts

i+

1 2

.

(24)

(I-III) Change the reconstruction functions for cells i-1, i, i+1 to THINC(s) according to the following BVD algorithm,

QIj = QTj s (j = i - 1, i, i + 1), if T BViTs < T BViP4.

(25)

8

(II) The 2nd stage

(II-I) Calculate the values of T BVi from the reconstruction of the function selected in the 1st stage and THINC(l) as

T BViI =

qL,I

i-

1 2

-

qR,I

i-

1 2

+

qL,I

i+

1 2

-

qR,I

i+

1 2

,

T BViTl =

q - q L,Tl

i-

1 2

R,Tl

i-

1 2

+

q - q L,Tl

i+

1 2

R,Tl

i+

1 2

.

(II-II) Determine the final reconstruction function for the target cell i by

(26)

Qi =

QTi l , QIi ,

if T BViTl < T BViI , otherwise.

(27)

In the 1st stage, the reconstruction functions in the neighboring cells of a discontinuity are replaced by THINC(s) to suppress numerical oscillations. In the 2nd stage, the reconstruction function in a cell containing the discontinuity is switched to THINC(l) to reduce numerical dissipation. In both stages, the BVD principle that minimizes the reconstructed BV values is implemented, which not only effectively reduces numerical dissipation but also gives a reliable criterion to distinguish smooth and discontinuous solutions.
Shown in [23], the 2-stage BVD algorithm maintains the 5th-order convergence rate for smooth solutions, while suppresses spurious oscillations and gets stable numerical results for discontinuous solutions even without using the nonlinear limiting projection as those in the WENO-type high-resolution schemes. It is demonstrated that the P4T2-BVD scheme can retrieve the linear 4th-degree polynomial as the basic reconstruction function for smooth solutions, and is able to reproduce high-fidelity numerical results for both smooth and discontinuous solutions with superior solution quality in comparison with other existing high-order nonlinear shock-capturing schemes.

4. Symmetry-preserving techniques

Even though numerical schemes are formulated to be mathematically exact, the causes of the

breaking-symmetry might still stem from the mismatched rounding errors in the calculation of the

physical quantities at symmetric positions [35, 46]. For example, the associativities of summation

and multiplication for more than two components are generally lost in floating-point arithmetic as

following,

(a + b) + c = a + (b + c),

(28)

(a × b) × c = a × (b × c).

(29)

Thus, if the same formulae are computed with different orders of summation or multiplication, the numerical results might be different. Hence, the symmetricity in numerical solution is not automatically guaranteed, even the scheme is mathematically symmetric. In other words, the symmetry property cannot be completely preserved unless all processes of digit operations at symmetric positions are identical. In this section, we thoroughly examine and solve all possible symmetry-breaking elements in the numerical solution procedure of the P4T2-BVD scheme, including the transformation between conservative variables and characteristic variables, the spatial reconstruction, and the Riemann solver.

9

4.1. The symmetry configurations in 2D simulations
In this work, we consider three typical symmetrical configurations for Cartesian grid or structured grids in two dimensions, i.e. x- or y-axis symmetry and diagonal symmetry, as illustrated in Fig. 1. The square and the dashed line in Fig. 1 show the computational domain and symme-


 




 

-axis symmetry

-axis symmetry

diagonal symmetry

Figure 1: The three typical symmetry properties in 2D simulations.

try axis respectively. Marks A and B indicate the symmetric positions. Note that another type of diagonal symmetry property (the symmetry with respect to the diagonal line cutting through Quadrants 2 and 4), which is not shown in Fig. 1, is automatically preserved if the three symmetry properties shown in Fig. 1 are preserved. In 2D problems, preserving the three properties is the necessary and sufficient condition for eliminating the symmetry errors.
The relationships of values of primitive variables , u, v, p at the positions A and B in each symmetry configuration are specified as follows,

A = B, uA = uB, vA = -vB, pA = pB (x-axis symmetry),

(30)

A = B, uA = -uB, vA = vB, pA = pB (y-axis symmetry),

(31)

A = B, uA = vB, vA = uB, pA = pB (diagonal symmetry),

(32)

which are referred to as the symmetry rules. The causes of the symmetry errors are investigated based on relationships (30), (31) and (32).
Below, we use breve accent mark "  " to highlight the symmetry-preserving formulations to distinguish them from the original ones.

4.2. Local characteristic decomposition
The reconstruction of the high-order schemes including the P4T2-BVD scheme is usually performed in terms of the characteristic variables W¯ rather than the conservative variables U¯ . So, the conservative variables need to be locally projected to the characteristic variables, and then the cell boundary values of reconstructed characteristic variables need to be projected back to conservative or primitive variables for use in Riemann solvers. The transformations between the conservative variables and characteristic variables are conducted by (4) and (5).

10

All the components in eigenvectors/matrices are calculated by density-based Roe averages of the reconstructed values at cell boundary, which reads, as an example in x-direction,

qRoe

i+

1 2

=

 q L L

i+

1 2

i+

1 2

+

L

i+

1 2

+

Ri+

1 2

qiR+

1 2

,

R

i+

1 2

(33)

where q represents the physical quantity to be averaged, i.e., u, v, or H. Other formulations of the Roe average have been reported to affect the symmetry properties in [46].
The numerical formulations using the eigenvectors/matrices to transform conservative variables and characteristic variables might, unfortunately, cause symmetry errors unless special manipulations are applied.
First, let us consider the symmetry with respect to y-axis. In this case, the symmetry property is relevant only to the numerical formulations in x-direction, so we examine the projection in x-direction.
The characteristic variables W¯ x at symmetric positions A and B in the middle panel of Fig. 1 are obtained by W¯ xA = LxA · U¯ and W¯ xB = LxB · U¯ respectively. We write explicitly W¯ xA and W¯ xB using the symmetry relationship with respect to y-axis Eq. (31) as follows,

w¯(u-c)

1
2

b1

+

u c



-

1 2

1 c

+ b2u



-

1 2

b2

v



1 2

b2



 w¯(u)  w¯(u+c)

=

 

1

2

1 - b1

b1

-

u c

  

¯A

+

 

1

2

b2u

1 c

-

b2u

  

¯uA

+

 b2v 

-

1 2

b2

v

¯vA

+

-b2

 

1 2

b2

 

E¯A,

w¯(u) A

-v

A

0

A

1

A

0A

w¯(u-c)
 w¯(u)  w¯(u+c)

1
2

b1

+

u c



=

 

1

2

1 - b1

b1

-

u c

  

-

1 2

1 c

+ b2u



¯B

+

 

1

2

b2u

1 c

-

b2u

  

-

1 2

b2v

¯uB

+

 b2v 

-

1 2

b2v



1 2

b2



¯vB

+

-b2

 

1 2

b2

 

E¯B

w¯(u) B

-v

B

0

B

1

B

0B

1
2

b1

-

u c



-

1 2

1 c

- b2u



-

1 2

b2

v



1 2

b2



=

 

1

2

1 - b1

b1

+

u c

  

¯A

+

 

1

2

-b2u

1 c

+

b2u

  

(-¯u)A

+

 b2v 

-

1 2

b2

v

¯vA

+

-b2

 

1 2

b2

 

E¯A

-v

A

0

A

1

A

0A

w¯(u+c)

=

 w¯(u)  w¯(u-c)

.

(34)

w¯(u) A

It is observed from this expressions that the values of w¯(u-c) and w¯(u+c) are interchanged while the values of w¯(u) and w¯(u) maintain the same at the symmetric positions A and B. In other words, the symmetry of w¯(u-c) and w¯(u+c) are broken although the conservative variables U¯ are exactly symmetrical. The distributions of the characteristic variables W¯ x are illustrated in Fig. 2. It is seen that the cell boundary values of w(u-c) and w(u+c) obtained by reconstruction are not
the same about symmetric line x = xi+1/2. Nevertheless, the symmetry in conservative variables
can be recovered if we retrieve the conservative variables at position A and B by UA = RxA · WxA
and UB = RxB · WxB respectively.

11

Symmetry line
  vwxyz

¡¤¢¥£ ¦§ ¨©  ! "%#&$'() (Asymmetry)

031425

6789

@CADBE

FIGPHQ

(Symmetry)

RUSVTWXY `abcde figphqrs twuxvy (Asymmetry)

   d ehfigjk

(Symmetry)

lmn

o

pqr stu

-side

-side

Figure 2: The distributions of the characteristic variables W¯ x. The variables boxed by squares and the variables boxed by ellipses on the two sides of the symmetry line x = xi+1/2 interchange their positions.

Recall that

  1 

1

1

0

u v

=

  

u

- v

c

  

wA(u-c)

+

 



u v

  

wA(u)

+

 



u+c v

  

wA(u+c)

+

0 1

wA(u),

EA

H - uc A

u2+v2

2

A

H + uc A

vA

(35)

It is straightforward to prove the following relationship with symmetry rule (31),

  1 

1

1

0

u v

=

  

u-c v

  

wB(u-c)

+

 



u v

  

wB(u)

+

 



u+c v

  

wB(u+c)

+

0 1

wB(u)

EB

H - uc B

u2+v2

2

B

H + uc B

vB

1

1

1

0

=

-(u +

 

v

c) 


wA(u+c)

+

 



-u v

  

wA(u)

+

-(u -

 

v

c) 


wA(u-c)

+

0 1

wA(u)

H + uc A

u2 +v2

2

A

H - uc A

vA



=

-u

 

v

 

,

(36)

EA

which states that the projection between conservative variables and characteristic variables does not break the symmetry in theory if there is no any numerical error involved.
However, Eq. (36) does not necessarily hold in numerical processing due to the floatingpoint arithmetic operation, which might consequently lead to asymmetry in numerical solution. As shown before in (28) and (29), the floating-point arithmetic does not ensure the rigorous associativity of algebraic operations because of the round-off error. As an example, we examine

12

the calculation procedures of A and B,

A = (wA(u-c) + wA(u)) + wA(u+c),

 



a

b

c

B = (wB(u-c) + wB(u)) + wB(u+c)

 



c

b

a

= (wA(u+c) + wA(u)) + wA(u-c)

 



c

b

a

= A.

(37)

Here, the terms labeled with the same letter have the same values. It observed that they might arrive at different values because of using different orders of summations. This observation applies also to other conservative variables, u, v and E, and eventually results in the symmetry errors.
A remedy to this problem can be regrouping and rearranging the order of the operations in the transformation calculation. I.e., sum up first the variables corresponding to the eigenvalues (u - c) and (u + c) in x-direction and (v - c) and (v + c) in y-direction first as follows,

U = r(u-c)w(u-c) + r(u+c)w(u+c) + r(u)w(u) + r(u)w(u) (x-direction), U = r(v-c)w(v-c) + r(v+c)w(v+c) + r(v)w(v) + r(v)w(v) (y-direction).

(38)

Implementing this method requires to modify the calculation procedure for matrix-vector product. Alternatively, the same can be achieved by rearranging the order of the eigenvalues and eigenvectors in matrices L and R. To this end, we take (u - c) and (u + c) as the first two eigenvalues, and rearrange the eigenvectors to formulate the so-called "symmetry-preserving eigenvectors matrices", L and R as follows,

 l(u-c)

 l(v-c)

L x

=

  

l(u+c)



 

,

L y

=

  

l(v+c)



 

,

 

l(u)

 

 

l(v)

 

l(u)

l(v)

(39)

R x = r(u-c) r(u+c) r(u) r(u) ,

R y = r(v-c) r(v+c) r(v) r(v) ,

where the boxed eigen vectors are placed at the first two positions to make sure that the summation of them is computed first.
Hence, the symmetry property regarding x- and y-axis can be preserved by either adjusting the order of the summation of matrix-vector product as shown in (38) or re-arranging the eigen matrices as (39).
We now analyse the diagonal symmetry shown in the right panel of Fig.1. Consider two symmetric points A and B, we write the characteristic variables W¯ xA at point A as W¯ xA = LxA ·U¯

w¯(u-c)  w¯(u)  w¯(u+c)

1
2

b1

+

u c



=

 

1

2

1 - b1

b1

-

u c

  

-

1 2

1 c

+ b2u



¯A

+

 

1

2

b2u

1 c

-

b2u

  

-

1 2

b2

v

¯uA

+

 b2v 

-

1 2

b2

v



1 2

b2



¯vA

+

-b2

 

1 2

b2

 

E¯A.

w¯(u) A

-v

A

0

A

1

A

0A

(40)

13

Using the symmetry rule (32), we can get the characteristic variables W¯ yB = LyB · U¯ at point B as,

w¯(v-c)

1
2

b1

+

v c



-

1 2

b2

u

-

1 2

1 c

+

b2v





1 2

b2



 w¯(v)  w¯(v+c)

=

 1 2

1 - b1

b1

-

v c

  

¯B

+

 b2u 

-

1 2

b2

u

¯uB

+

 

1

2

b2v

1 c

-

b2v

  

¯vB

+

-b2

 

1 2

b2

 

E¯B

w¯(v) B

-u

B

1

B

0

B

0B

1
2

b1

+

u c



-

1 2

b2v

-

1 2

1 c

+ b2u





1 2

b2



=

 

1

2

1 - b1

b1

-

u c

  

¯A

+

 b2v 

-

1 2

b2v

¯v

A

+

 

1

2

b2u

1 c

-

b2u

  

¯uA

+

-b2

 

1 2

b2

 

E¯A

-v

A

1

A

0

A

0A

w¯(u-c)

=

 w¯(u)  w¯(u+c)

.

(41)

w¯(u) A

It indicates that the symmetry property of the characteristic variables, W¯ xA = W¯ yB, is mathematically true. However, this symmetry is not guaranteed due to the loss of summation associativity in floating-point arithmetic. We follow the technique introduced in [46] and add the brackets to adjust the sequence of the summation,

W¯ x = lx1¯ + lx2¯u + lx3¯v + lx4E¯,

(42)

W¯ y = ly1¯ + ly2¯u + ly3¯v + ly4E¯,

(43)

where lxm and lym, m = 1, 2, 3, 4, are the column vectors of Lx and Ly respectively in (7). It is noted that the transformation from the reconstructed characteristic variables to the conservative variables, i.e. U = RxA · WxA and U = RyB · WyB in x- and y-directions respectively, don't break the symmetry property. We prove it in the appendix.
To conclude this subsection regarding the transformation between conservative variables and characteristic variables, we state the two crucial points to enforce the solution symmetry, 1) to add a bracket and modify the summation order as (38) or arrange the eigenvectors matrices as (39) to ensure the axis-symmetry property, and 2) to add a bracket to (42) and (43) for diagonal symmetry-preserving.
4.3. Reconstruction
In order to avoid the symmetry errors in the reconstruction step, it is necessary to perform the reconstruction symmetrically at the level of the floating-point arithmetic. Specifically, the reconstructed values at cell boundaries have to exactly follow the symmetric rules (30)-(32) at the symmetric positions.
We summarize the required relations of reconstructed variables for different types of symmetry in table 1. It is found that the stencils and the sequences of calculations for the physical quantities are the same at the diagonally symmetric positions. Thus, the reconstructions do not break the diagonal symmetry because the formulations used for reconstructions in x- and y-directions are identical as implemented in this work. However, the reconstructed cell boundary values at (xor y-) axis-symmetric positions do not automatically guarantee the symmetric rules, and special attention must be paid to ensure the exact symmetry in numerical solutions. In present work,

14

conservative and
primitive variables
characteristic variables

x-axis symmetry
A = B uA = uB vA = -vB EA = EB
uA = uB vA = -vB pA = pB wA(u-c) = wB(u-c) wA(u) = wB(u) wA(u+c) = wB(u+c) wA(u) = wB(u) wA(v-c) = wB(v+c) wA(v) = wB(v) wA(v+c) = wB(v-c) wA(v) = wB(v)

y-axis symmetry
A = B uA = -uB vA = vB
EA = EB uA = -uB vA = vB pA = pB wA(u-c) = wB(u+c) wA(u) = wB(u) wA(u+c) = wB(u-c) wA(u) = wB(u) wA(v-c) = wB(v-c) wA(v) = wB(v) wA(v+c) = wB(v+c) wA(v) = wB(v)

diagonal symmetry
A = B uA = vB vA = uB EA = EB
uA = vB vA = uB pA = pB wA(u-c) = wB(v-c) wA(u) = wB(v) wA(u+c) = wB(v+c) wA(u) = wB(v) wA(v-c) = wB(u-c) wA(v) = wB(u) wA(v+c) = wB(u+c) wA(v) = wB(u)

Table 1: Summary of the symmetry relationships of the conservative, primitive and characteristic variables.

we propose conditions to conduct symmetric reconstructions that are derived by leveraging two special reconstruction techniques, stencil-flipping (SF) reconstruction and sign-inversion (SI) reconstruction.

4.3.1. Symmetry enforcement using SF and SI reconstructions
Without losing generality, consider a spatial reconstruction for variable q(x) in x-direction, we denote the piecewise reconstruction function Qi(x) for cell i by Qi({q¯j}, x), where {q¯j} stands for the union of the cell-average values in the neighboring cells {j}, j = i - il, · · · , i - 1, i, i + 1, · · · , i + ir.
The SF reconstruction function for i is defined by flipping the stencil as

QSi F (x)  Qi({q¯j}, x),

(44)

where the order of cells {j} is reversed as, j = i - ir, · · · , i - 1, i, i + 1, · · · , i + il.

The SI reconstruction function for i is defined as a reconstruction for the cell-average values

with opposite sign,

QSi I (x)  Qi({-q¯j}, x).

(45)

Given the SF function defined in (44), the symmetric reconstruction in x-direction, regarding the y-axis symmetry, requires the following relations to be satisfied,

Qi

(xi+

1 2

)

=

QSi F

(xi-

1 2

)

and

Qi

(xi-

1 2

)

=

QSi

F

(xi+

1 2

),

(46)

which applies to the reconstructions of all variables. The SI reconstruction needs to fulfill the following relation as an additional requisite to ensure
the exact symmetry with respect to axis for the THINC function discussed later,

Qi

(xi+

1 2

)

=

-QSi

I

(xi+

1 2

)

and

Qi

(xi-

1 2

)

=

-QSi

I

(xi-

1 2

).

15

(47)

We also note that for reconstructions of the conservative or primitive variables u or u, which has opposite signs at the symmetric positions about y-axis, condition (47) is required for symmetry. It applies analogously to the reconstruction in y-direction for the symmetry about x-axis as well.
It is found that the numerical formulations for reconstructions are not automatically in line with conditions (46) and (47), and hence might cause the symmetry-breaking in numerical solutions. Next, we examine specifically the reconstruction functions used in the P4T2-BVD method.

4.3.2. Symmetry property of 4th-degree polynomial function
The cell-boundary values of the 4th-degree polynomial reconstruction are computed as linear combinations of q¯j (j = i, i ± 1, i ± 2), i.e. the summation of five values. As discussed above, due to the invalid associativity of summation in the floating-point arithmetic, the orders of the summations might cause symmetry-breaking. Summing up the values in a natural order with the cell index gradually increased, leads to the following formulae to calculate cell-boundary values, which unfortunately does not preserve the symmetry,

qL,P4

i+

1 2

=

1 60

(2q¯i-2


-

13q¯i-1


+ 47q¯i + 27q¯i+1  

- 3q¯i+2),


a

b

c

d

e

qR,P4

i-

1 2

=

1

60

(-3q¯i-2 

+

27q¯i-1


+ 47q¯i 

- 13q¯i+1 

+ 2q¯i+2), 

e

d

c

b

a

(48)

where we label the five terms from "a" to "e". It is clear that (48) does not meet the symmetric

condition (46). Applying (46) leads to another arrangement of the terms that matches position of

the terms of the same label, which equivalently to flipping the stencil, i.e. q¯i-2 and q¯i+2, q¯i-1 and

q¯i+1

are

interchanged

respectively.

Hence,

the

order

of

the

summation

of

qR,P4

i-

1 2

are

adjusted

to

that

of

qL,P4

i+

1 2

as

follows,

qiL+,P124

=

1 60

(2q¯i-2


- 13q¯i-1


+ 47q¯i 

+ 27q¯i+1


- 3q¯i+2),


a

b

c

d

e

qiR-,P124

=

1 60

(2q¯i+2


-

13q¯i+1


+ 47q¯i + 27q¯i-1  

- 3q¯i-2),


a

b

c

d

e

(49)

which exactly preserves the symmetry in numerical solutions. In sense of eliminating symmetry errors in summation operation, the following formulae are effective as well by explicitly adding brackets to group the values of the cells symmetric about i.

qiL+,P214

=

1 60

((2q¯i-2


- 3q¯i+2) + (-13q¯i-1





+ 27q¯i+1) + 47q¯i),





a

e

b

d

c

qiR-,P214

=

1 60

((-3q¯i-2


+

2q¯i+2)


+

(27q¯i-1


-

13q¯i+1)


+

47q¯i).


e

a

d

b

c

(50)

It is noted that the SI reconstruction does not make anything different regarding symmetry property in the 4th-degree polynomial reconstruction because (47) always holds no matter if q¯j (j = i, i ± 1, i ± 2) are changed to opposite sign or not. This conclusion applies to all linear schemes that use polynomials with constant coefficients for reconstruction.

16

4.3.3. A new formulation of THINC function for symmetry-preserving
Here, we propose a new formulation of the THINC function to completely remove the symmetry errors. This formulation is devised to fulfill conditions (46) and (47). Instead of (18), the new THINC function is written as

 { |}~

baseline
 ¹º»

 





1

0   1

 
2

  

¥©¦§¨ ¤

´¸µ¶·



¯°

ª« 0 ³ ®

¡¢£
bas¼½e¾¿liÀnÁÇeÂÃÄÅÆ ±² ¬

original scaling

symmetric scaling

Figure 3: The descriptions of the scaling of original THINC and symmetric THINC function.

QTi (x) = qa + qd tanh  Xi - di ,

(51)

where

qa =

q¯i+1 + q¯i-1 , 2

qd

=

q¯i+1 - q¯i-1 , 2

Xi

=

Xi

-

1 2

=

x-

xi+

1 2

+

xi-

1 2

xi+

1 2

-

xi-

1 2

/2 .

Same as the original THINC scheme, function (51) is applied only if the monotonicity condition
(q¯i - q¯i-1)(q¯i+1 - q¯i) > 10-20 is satisfied. Otherwise, the THINC function degrades to a piecewise constant function, i.e. QTi (x) = q¯i. The jump location (center of the transition layer) di is obtained by the following condition, same as the original THINC scheme,

1 x

xi+

1 2

QTi (x)dx

=

q¯i.

xi-

1 2

(52)

Thus, di can be derived as

di

=

1 2

ln

1 1

- +

T2/T1 T2/T1

,

(53)

where

T1 = tanh

 2

, T2 = tanh

i 2

,

i

=

q¯i

- qd

qa

.

Eventually, we get the symmetry-preserving formulae to compute the cell boundary values as

qiL+,T12 = QTi qiR-,T12 = QTi

xi+

1 2

xi-

1 2

=

qa

+

qd

T1 + T2/T1 1 + T2

,

=

qa

-

qd

T1 - T2/T1 1 - T2

.

(54)

17

Remark 1. It is straightforwardly provable that (54) satisfy conditions (46) and (47), and thus ensures the symmetry in reconstruction.

Remark 2. As shown in Fig. 3, the reference point of the local coordinate Xi (represented in blue) is shifted to the center of cell i, and the constant term in the THINC function (represented as the baseline in orange) is changed from q¯min to the average of values of the neighboring cells (q¯i-1 + q¯i+1)/2. These modifications enforce condition (46).
Remark 3. The formula to obtain i is different from the original i in Eq. (21) for symmetry property, where the small number  is removed. Actually,  in Eq. (21) is not necessary for avoiding zero-division which is already ruled out by condition (q¯i - q¯i-1)(q¯i+1 - q¯i) > 10-20. It can be straightforwardly shown that inclusion of  will violate condition (47), and thus break the symmetry in numerical solutions.
It is also noted that i can be written in another form as

i

=

-

q¯i-1 - q¯i+1

2q¯i -

+ q¯i+1 q¯i-1

,

(55)

which can be viewed as an approximation to the ratio of the second derivative and the first derivative of physical quantity q. However, this form of i might cause the symmetry error due to the lack of associativity of summation of the numerator in (55), i.e. (q¯i-1 - 2q¯i) + q¯i+1 = (q¯i+1 - 2q¯i) + q¯i-1.
Remark 4. A more conventionally used alternative to (54) is to calculate di from (53) first, and then substitute it into the reconstruction function (51) to obtain the boundary values. However, this option does not ensure (46) and (47), as for a logarithm function the following equality does not always hold

ln (a) = - ln

1 a

.

(56)

In general, numerical processing of particular functions does follow the mathematical commutativity.
It should be noted that (54) is not the only scheme that preserves symmetry in the THINC reconstruction though, it is a reasonable choice with simplicity and efficiency.

4.4. HLLC Riemann solver
Another important component is the approximate Riemann solver. In this subsection, we examine symmetry-breaking causes of the HLLC Riemann solver [51, 52] used in the P4T2-BVD method for Euler equations.
HLLC Riemann solver is the modification of HLL Riemann solver [53] to restore the contact wave. The numerical flux of the HLLC Riemann solver is expressed as

FL, if 0  sL,





FHLLC

=

FL, FR,

if sL  0  s, if s  0  sR,

(57)





FR, if sR  0,

where the asterisk () means the intermediate region between the left and right waves of speeds sL and sR respectively. The middle contact wave moves at speed s, and divides the intermediate

18

region further into two parts. From the Rankine-Hugoniot condition, the flux function and the conservative variable in the intermediate region can be obtained by

FK = FK + sK(UK - UK),



K



UK

=

sK - uK sK - s


 EK

+ (s

K s - uK) K s

+

pK sK -uK

, 

(58) (59)

with K = L or R. The intermediate wave speed s is calculated as

s

=

pR

-

pL + LuL(sL - uL) - RuR(sR L(sL - uL) - R(sR - uR)

-

uR) .

(60)

Here, the wave speeds sL and sR are obtained by the pressure-based wave speed estimation [51],

sL = uL - cLqL,

(61)

sR = uR + cRqR,

(62)

where

1,

if p  pK ,





qK =
 

1

+

+ 2

1

p pK

-1

,

otherwise,

(63)

with K = L or R. The pressure in intermediate region is approximated by PVRS method [52] as follows,

p = max

0,

1 2

(pL

+

pR)

-

1 2

(uR

-

uL)¯c¯

,

(64)

where

¯ =

1 2

(L

+

R),

c¯ =

1 2

(cL

+

cR).

(65)

There are three symmetry-breaking spots in the numerical formulation of HLLC Riemann solver.
The first is in the flux function for transporting the transverse momentum component, which may break the diagonal symmetry. When HLLC solver is implemented dimension-wisely, the following formulae of flux functions may cause symmetry error,

 u 

 v 

F

=

  

u2 + uv

p

 

,



G

=

 



uv v2 + p

 

,



(66)

(E + p)u

(E + p)v

where the terms to advect the transverse momentums are boxed. Because the values of u and v are interchanged in dimension-wise calculations, (66) might
break the diagonal symmetry relationship due to the lack of the associativity of multiplication in

19

numerical processing shown in Eq. (29). More specifically, the third component of F does not match the second component of G as the multiplications are arranged in different sequences,

F3

=

(


×

u)


×

v


=

(


×

u)


×

v


=

G2

ab

c

ac

b

(67)

where the variable labeled by the same letter needs to be placed in the same order. Hence, the order of the multiplication in (67) should be matched as Eq. (2) or use the following form,

 u 

 v 

F

=

  

u2 + vu

p

 

,



G

=

 



uv v2 + p

 

.



(68)

(E + p)u

(E + p)v

The second point concerns the choice of the final numerical flux in Eq. (57). When s = 0, choosing either FL or FR will break the symmetry because they are not numerically identical due to the rounding error. This problem can be solved by adding the case of s = 0 separately as
follows,

FL,

if 0  sL,



FL,

if sL  0 < s,



F HLLC

=

 (FL

+

FR)/2,

if s = 0,

(69)

FR,  FR,

if s < 0  sR, if sR  0.

It is noted that the following formulation proposed in [54, 46] is effective to resolve this problem.

F HLLC

=

1

+

sgn(s) 2

FL + s- UL - UL

+

1

-

sgn(s) 2

FR + s+

UR - UR

,

(70)

where s- = min(sL, 0) and s+ = max(sR, 0). The third possible cause of symmetry-breaking is the formula to calculate the speed of the
intermediate wave s shown in (60). Since the numerator of s is composed of the summation of four terms, the order of the summation affects the symmetry property. A symmetry-preserving version of s has been proposed in [46] as

pR - pL + LuL(sL - uL) - RuR(sR - uR)

s =

L(sL - uL) - R(sR - uR)

.

(71)

The modification is adding a bracket to the original formula. Our numerical experiments show that the symmetry errors in HLLC Riemann solver can be
eliminated by modifying the formulations to fix the three possible causes analyzed above. Before end this section, we summarize the symmetry-preserving techniques for the P4T2-BVD
finite volume solver as follows.

i) Change the order of summation in the transformation from the characteristic variables to the conservative variables, using (38) or (39);

20

ii) Add a bracket between the terms of ¯u and ¯v in the transformation from conservative variables to the characteristic variables using (42) and (43);
iii) Replace the formulae to compute the left-side and right-side values at cell boundaries in the P4T2-BVD scheme with the following symmetry-preserving formulae:
iii-i) for the 4th-degree polynomial function use (49) or (50), iii-ii) for the THINC function use (54);
iv) Modify the formulae in HLLC Riemann solver that break symmetry property:
iv-i) rearrange the order of multiplication in the advection flux for the transverse momentum component as in (68),
iv-ii) use Eq. (70) to calculate numerical fluxes, iv-iii) use Eq. (71) to compute the speed of intermediate wave s.

5. Numerical results
To verify the symmetry-preserving techniques introduced in section 4, we have simulated some benchmark tests that have symmetric solution structures in space and are sensitive to any possible causes for symmetry breaking. The results demonstrate that the proposed techniques are effective for preserving both axis and diagonal symmetry properties. The 2D inviscid Euler equations are solved with relatively high mesh resolutions so that the asymmetric disturbances caused by floating-point arithmetic may grow and eventually contaminate the numerical solution.
The reconstruction is conducted by the P4T2-BVD scheme in terms of the characteristic variables. Symmetrized HLLC Riemann solver explained in subsection 4.4 is used to compute the numerical fluxes. Time evolution is performed by third-order SSP Runge-Kutta method [55]. The CFL number is set to 0.6 for all benchmark tests. The calculations have been done on Intel Xeon CPU E5-2687W 0 @ 3.10 GHz in a multi-threaded fashion on CentOS 6.10 operating system. GCC compiler version 4.4.6 was used without any special optimization options in compile commands.

5.1. 2D Riemann problems In 2D Riemann problems, the computational domain is divided into four areas and each area is
given constant values of physical quantities initially. In some cases, Kelvin-Helmholtz instabilities are produced along the contact discontinuities dividing the domain. The development of the vortices is usually used as the measure to evaluate the numerical dissipation of a scheme. We choose configurations 3 and 12 from the 2D Riemann problem test set [56], which have diagonal symmetry in solution structures.
The initial conditions of config. 3 and 12 are as follows,

(1.5, 0, 0, 1.5),

x > 0.3 - , y > 0.3 - ,





(0.5323, 1.206, 0, 0.3),

x < 0.3 - , y > 0.3 + ,

Config. 3: (0, u0, v0, p0) = (0.138, 1.206, 1.206, 0.029), x < 0.3 + , y < 0.3 + ,

(72)



(0.5323, 0, 1.206, 0.3),

x > 0.3 + , y < 0.3 - ,

(0.5313, 0, 0, 0.4), x > -, y > -,





(1, 0.7276, 0, 1), x < -, y > ,

Config. 12: (0, u0, v0, p0) = (0.8, 0, 0, 1),

x < , y < ,

(73)



(1, 0, 0.7276, 1), x > , y < -,

21

where the small number  = 10-15 is introduced to avoid symmetry errors in the initial conditions. The boundary condition is set to zero-gradient for all boundaries. The computational domain is [-0.5, 0.5] × [-0.5, 0.5] and partitioned by a 1000 × 1000 grid for config. 3 and a 4000 × 4000 grid for config. 12. The numerical results of the density at time t = 0.8 of config. 3 are shown in Fig. 4 and at time t = 0.25 of config. 12 are shown in Fig. 5.

Figure 4: Numerical solutions of density for config. 3 of 2D Riemann problems (blue=0.135 to red=1.75). Left panel is for the original scheme and right panel is for the symmetry-preserving scheme.

It is observed from the left panels in Figs. 4 and 5 that the results of the original P4T2BVD scheme cannot preserve the diagonal symmetry property, especially in the vortex structures along slip lines. On the contrary, the symmetry property is perfectly preserved by the symmetrypreserving techniques introduced in this paper, as shown in the right panels of Figs. 4 and 5. These results indicate that the proposed techniques are valid to preserve the diagonal symmetry.

5.2. Rayleigh-Taylor instability
The Rayleigh-Taylor instability (RTI) is a typical benchmark test that has axis-symmetricity in solution structure. In the past, RTI has been extensively used to assess numerical methods for Euler equations [57, 43, 17], and most existing schemes result in asymmetric solutions in highresolution simulations, where lower numerical dissipation allows asymmetric rounding errors to develop and be visible in numerical solution.
The initial condition is set by placing a heavy fluid above a light fluid under gravity with a velocity perturbation on the interface between the two fluids, as specified below,

(0, u0, v0, p0) =

(2, 0, v0(x), 2y + 1), (1, 0, v0(x), y + 1.5),

if y < 0.5, otherwise,

(74)

where v0(x) is the initial value of the velocity in y-direction perturbed in x-direction to trigger the mixing between heavy and light fluids. Conventionally, v0(x) is given by

v0(x) = -0.025c cos (8x).

(75)

22

Figure 5: Numerical solutions of density for config. 12 of 2D Riemann problems (blue=0.55 to red=1.7). Left panels show the results from the original scheme and right panels are for the symmetry-preserving scheme. The bottom figures show the zoomed region of [-0.2, 0.1] × [-0.2, 0.1].
23

However, as pointed out by Fleischmann et al. [46], v0(x) in (75) is not symmetric due to the fact that cos ( - ) = cos ( + ) in the floating-point arithmetic. Fleischmann et al. [46] proposed the following symmetry-preserving formulation for specifying v0(x),

v0(x) =

-0.025c cos (8x), -0.025c cos (0.25 - 8x),

if x < 0.125, otherwise.

(76)

Reflective boundary condition is imposed at the left and right boundaries and the top and

bottom boundaries are fixed as (, u, v, p)top = (1, 0, 0, 2.5) and (, u, v, p)bottom = (2, 0, 0, 1) re-

spectively.

The computational domain is [0, 0.25] × [0, 1].

The specific heat ratio is  =

5 3

.

The

numerical results of the density at time t = 1.95 are shown in Figs. 6 and 7.

Figure 6: Numerical solutions of density for Rayleigh-Taylor instability (blue=0.85 to red=2.25) with the mesh resolution of 1024 × 4096. Left panel is the result of the original scheme and right panel is that of the symmetrypreserving scheme.
Fig. 6 shows that the y-axis asymmetric flow structure calculated by the original scheme is improved, and perfect symmetry is reproduced by the symmetry-preserving techniques even in
24

Figure 7: Left panel is the numerical solutions of density for Rayleigh-Taylor instability calculated by symmetrypreserving scheme (blue=0.85 and red=2.25) and right panel shows which reconstruction function is selected by the BVD algorithm for each characteristic variable (purple=4th-degree polynomial, light blue=THINC(s), yellow=THINC(l)). Mesh resolution is 128 × 512.
25

this low-dissipation simulation on a high-resolution mesh. This result indicates that the proposed methods are effective for preserving axis symmetry.
We further examine the symmetric property in the BVD algorithm to select the reconstruction function. Fig. 7 shows which candidate function is selected in the BVD algorithm as the final interpolant for reconstruction. Mesh cells are marked with different colors according to which reconstruction function is used. I.e. purple indicates a cell where the 4th-degree polynomial is used, light blue for a cell using THINC(s), and yellow for THINC(l). It can be seen that THINC(l) is selected in the cells in the vicinity of strong discontinuous solutions while THINC(s) is chosen for the cells where the solution is between smooth and discontinuous. The selection of reconstruction function in the BVD algorithm is completely symmetric for all characteristic variables except w(u-c) and w(u+c). As shown in Fig. 2 and table 1, w(u-c) and w(u+c) have their values interchanged with symmetric positions in the y-axis symmetry. Consistently, Figs. 6 and 7 shows that the left and right halves of the selected function of w(u-c) are swapped with the right and left halves of w(u+c) inversely. It completely agrees with the y-axis symmetry of the characteristic variables analyzed in section 4.

5.3. Implosion test
This test demonstrates an implosion phenomenon where a diamond-shaped low-pressure region is crushed by the surrounding high-pressure [36]. The implosion test has been used to verify the performance of the numerical codes for astrophysical simulation [58, 59]. Since the diagonal jets are sensitive to numerical disturbances, the solution tends to easily deviate from the diagonal direction if the code contains any symmetry error. It is a very challenging benchmark test to evaluate both axis and diagonal symmetry-preserving properties of numerical methods.
The initial conditions are set as follows,

(0.125, 0, 0, 0.14), |y + x| < 0.15 + , |y - x| < 0.15 + ,

(0, u0, v0, p0) = (1, 0, 0, 1),

otherwise,

(77)

where  = 10-10 is introduced in order to avoid asymmetricity in initial condition. The reflective boundary condition is imposed on all boundaries of computational domain which is a square area specified by [-0.3, 0.3] × [-0.3, 0.3]. The numerical results of the density and the pressure at time t = 2.5 are shown in Fig. 8.
It can be seen that the trajectories of the jets in the results of the original scheme are distorted because of the symmetry errors. By adopting the proposed techniques, both axis and diagonal symmetric properties are perfectly preserved.

6. Conclusion
In this study, the mechanisms of symmetry-breaking in a finite volume framework with P4T2BVD reconstruction scheme are thoroughly examined. As the high-resolution simulations using high-order numerical schemes on fine computational grids might amplify the symmetry errors of round-off level which break the symmetric solution structures, attention has been paid to remove the possible causes due to the lack of associativity in floating-point arithmetic.
The reasons for symmetry-breaking exist in different components of the numerical solver for Euler equations. They are mainly attributed to 1) the sequence of arithmetic operations in transformation calculations between conservative and characteristic variables, 2) the arrangement of

26

Figure 8: Numerical solutions for implosion test with resolution 1600 × 1600. Left panels are the results of the original scheme and right panels are for the symmetry-preserving scheme. The density (blue=0.41 to red=1.07) is on the top, and the pressure (blue=0.74 to red=1.1) is on the bottom.
27

the stencil for spatial reconstruction, 3) the commutative operations with nonlinear functions, and 4) the asymmetricity associated with the "if" logic operation.
Numerical modifications and numerical techniques are proposed to completely remove the possible causes for symmetry breaking in the P4T2-BVD finite volume solver. Benchmark tests which have symmetric solution structures are used to verify the methods proposed in this paper. The numerical results demonstrate that the numerical solver can perfectly reproduce the symmetric solution structures in all tests.

Acknowledgment
This work was supported in part by the fund from JSPS (Japan Society for the Promotion of Science) under Grant Nos. 18H01366 and 19H05613.

Appendix A. The diagonal symmetricity in the transformation from characteristic variables to conservative variables

The transformations of the reconstructed characteristic variables W to the conservative variables U at the diagonally symmetric positions are computed by UA = RxA · WxA and UB = RyB · WyB in x- and y-directions respectively. For point A, we have

  1 

1

1

0

u v

=

  

u

- v

c

  

wA(u-c)

+

 



u v

  

wA(u)

+

 



u+c v

  

wA(u+c)

+

0 1

wA(u).

EA

H - uc A

u2 +v2

2

A

H + uc A

vA

(A.1)

Using the diagonal symmetry rule given in (32) and table 1, we get the transformation formulae at point B as follows,

  1 

1

1

0

u v

=

  

v

u -c

  

wB(v-c)

+

 



u v

  

wB(v)

+

 



u v+c

  

wB(v+c)

+

1 0

wB(v)

EB

H - vc B

u2+v2

2

B

H + vc B

uB

1

1

1

0

=

  

v u-c

  

wA(u-c)

+

 



v u

  

wA(u)

+

 



v u+c

  

wA(u+c)

+

1 0

wA(u)

H - uc A

v2 +u2

2

A

H + uc A

vA



=

v u

.

(A.2)

EA

It is observed that all terms are computed in the same order when applying the transformation dimension-wisely in x- and y-directions. So, no any modification at this stage is required to enhance the symmetry in numerical solution.

28

References
[1] S. K. Godunov, A difference method for numerical calculation of discontinuous solutions of the equations of hydrodynamics, Math. Sb. 47 (1959) 271­306.
[2] A. Harten, High Resolution Schemes for Hyperbolic Conservation Laws, International Journal for Numerical Methods in Fluids 23 (1983) 309­323.
[3] B. Van Leer, Towards the ultimate conservative difference scheme. IV. A new approach to numerical convection, Journal of Computational Physics 23 (1977) 276­299.
[4] A. Harten, B. Engquist, S. Osher, S. R. Chakravarthy, Uniformly High Order Accurte Essentially Non-Oscillatory Schemes III, Journal of Computational Physics 71 (1987) 231­323.
[5] C.-W. Shu, S. Osher, Efficient Implementation of Essentially Non-oscillatory Shock-Capturing Schemes, Journal of Computational Physics 77 (1988) 439­471.
[6] X.-D. Liu, S. Osher, T. Chan, Weighted Essentially Non-oscillatory Schemes, Journal of Computational Physics 115 (1994) 200­212.
[7] G.-S. Jiang, C.-W. Shu, Efficient implementation of weighted ENO schemes, Journal of Computational Physics 126 (1996) 202­228.
[8] A. K. Henrick, T. D. Aslam, J. M. Powers, Mapped weighted essentially non-oscillatory schemes: Achieving optimal order near critical points, Journal of Computational Physics 207 (2005) 542­567.
[9] R. Borges, M. Carmona, B. Costa, W. S. Don, An improved weighted essentially nonoscillatory scheme for hyperbolic conservation laws, Journal of Computational Physics 227 (2008) 3191­3211.
[10] Y. Ha, C. Ho Kim, Y. Ju Lee, J. Yoon, An improved weighted essentially non-oscillatory scheme with a new smoothness indicator, Journal of Computational Physics 232 (2013) 68­ 86.
[11] P. Fan, Y. Shen, B. Tian, C. Yang, A new smoothness indicator for improving the weighted essentially non-oscillatory scheme, Journal of Computational Physics 269 (2014) 329­354.
[12] C. H. Kim, Y. Ha, J. Yoon, Modified Non-linear Weights for Fifth-Order Weighted Essentially Non-oscillatory Schemes, Journal of Scientific Computing 67 (2016) 299­323.
[13] L. Fu, X. Y. Hu, N. A. Adams, A family of high-order targeted ENO schemes for compressiblefluid simulations, Journal of Computational Physics 305 (2016) 333­359.
[14] F. Acker, R. B. Borges, B. Costa, An improved WENO-Z scheme, Journal of Computational Physics 313 (2016) 726­753.
[15] L. Fu, X. Y. Hu, N. A. Adams, Targeted ENO schemes with tailored resolution property for hyperbolic conservation laws, Journal of Computational Physics 349 (2017) 97­121.
[16] S. Rathan, G. Naga Raju, A modified fifth-order WENO scheme for hyperbolic conservation laws, Computers and Mathematics with Applications 75 (2018) 1531­1549.
29

[17] L. Fu, X. Y. Hu, N. A. Adams, A new class of adaptive high-order targeted ENO schemes for hyperbolic conservation laws, Journal of Computational Physics 374 (2018) 724­751.
[18] Z. Sun, S. Inaba, F. Xiao, Boundary Variation Diminishing (BVD) reconstruction: A new approach to improve Godunov schemes, Journal of Computational Physics 322 (2016) 309­ 325.
[19] X. Deng, B. Xie, F. Xiao, A finite volume multi-moment method with boundary variation diminishing principle for Euler equation on three-dimensional hybrid unstructured grids, Computers and Fluids 153 (2017) 85­101.
[20] B. Xie, X. Deng, Z. Sun, F. Xiao, A hybrid pressure­density-based Mach uniform algorithm for 2D Euler equations on unstructured grids by using multi-moment finite volume method, Journal of Computational Physics 335 (2017) 637­663.
[21] X. Deng, S. Inaba, B. Xie, K. M. Shyue, F. Xiao, High fidelity discontinuity-resolving reconstruction for compressible multiphase flows with moving interfaces, Journal of Computational Physics 371 (2018) 945­966.
[22] X. Deng, B. Xie, R. Loub`ere, Y. Shimizu, F. Xiao, Limiter-free discontinuity-capturing scheme for compressible gas dynamics with reactive fronts, Computers and Fluids 171 (2018) 1­14.
[23] X. Deng, Y. Shimizu, F. Xiao, A fifth-order shock capturing scheme with two-stage boundary variation diminishing algorithm, Journal of Computational Physics 386 (2019) 323­349.
[24] S. Tann, X. Deng, Y. Shimizu, R. Loub`ere, F. Xiao, Solution property preserving reconstruction for finite volume scheme: a boundary variation diminishing+multidimensional optimal order detection framework, International Journal for Numerical Methods in Fluids 92 (2019) 603­634.
[25] X. Deng, Y. Shimizu, B. Xie, F. Xiao, Constructing higher order discontinuity-capturing schemes with upwind-biased interpolations and boundary variation diminishing algorithm, Computers and Fluids 200 (2020) 104433.
[26] S. Tann, X. Deng, R. Loub`ere, F. Xiao, Solution property preserving reconstruction BVD+MOOD scheme for compressible euler equations with source terms and detonations, Computers and Fluids 206 (2020) 104594.
[27] L. Cheng, X. Deng, B. Xie, Y. Jiang, F. Xiao, Low-dissipation BVD schemes for single and multi-phase compressible flows on unstructured grids, Journal of Computational Physics 428 (2021) 110088.
[28] Z.-H. Jiang, X. Deng, F. Xiao, C. Yan, J. Yu, S. Lou, Hybrid discontinuous galerkin/finite volume method with subcell resolution for shocked flows, AIAA Journal (2021) 1­18.
[29] F. Xiao, Y. Honma, T. Kono, A simple algebraic interface capturing scheme using hyperbolic tangent function, International Journal for Numerical Methods in Fluids 48 (2005) 1023­1040.
[30] F. Xiao, S. Ii, C. Chen, Revisit to the THINC scheme: A simple algebraic VOF algorithm, Journal of Computational Physics 230 (2011) 7086­7092.
30

[31] B. Xie, F. Xiao, Toward efficient and accurate interface capturing on arbitrary hybrid unstructured grids: The THINC method with quadratic surface representation and Gaussian quadrature, Journal of Computational Physics 349 (2017) 415­440.
[32] A. S. Chamarthi, S. H. Frankel, High-order central-upwind shock capturing scheme using a boundary variation diminishing (bvd) algorithm, Journal of Computational Physics 427 (2021) 110067.
[33] Y. Ruan, X. Zhang, B. Tian, Z. He, A flux split based finite-difference two-stage boundary variation diminishing scheme with application to the Euler equations, Computers and Fluids 213 (2020) 104725.
[34] J. Shi, Y. T. Zhang, C. W. Shu, Resolution of high order WENO schemes for complicated flow structures, Journal of Computational Physics 186 (2003) 690­696.
[35] J. F. Remacle, J. E. Flaherty, M. S. Shephard, An adaptive discontinuous Galerkin technique with an orthogonal basis applied to compressible flow problems, SIAM Review 45 (2003) 53­72.
[36] R. Liska, B. Wendroff, Comparison of several difference schemes on 1D and 2D test problems for the Euler equations, SIAM Journal on Scientific Computing 25 (2003) 995­1017.
[37] Y. Ha, C. L. Gardner, A. Gelb, C. W. Shu, Numerical simulation of high mach number astrophysical jets with radiative cooling, Journal of Scientific Computing 24 (2005) 597­612.
[38] G. Zhao, M. Sun, S. Xie, H. Wang, Numerical dissipation control in an adaptive WCNS with a new smoothness indicator, Applied Mathematics and Computation 330 (2018) 239­253.
[39] H. Zhang, G. Wang, F. Zhang, A multi-resolution weighted compact nonlinear scheme for hyperbolic conservation laws, International Journal of Computational Fluid Dynamics 34 (2020) 187­203.
[40] L. Li, H. B. Wang, G. Y. Zhao, M. B. Sun, D. P. Xiong, T. Tang, An Efficient Low-Dissipation Hybrid Central/WENO Scheme for Compressible Flows, International Journal of Computational Fluid Dynamics 34 (2020) 705­730.
[41] J. Peng, S. Liu, S. Li, K. Zhang, Y. Shen, An efficient targeted ENO scheme with local adaptive dissipation for compressible flow simulation, Journal of Computational Physics 425 (2021) 109902.
[42] Y. Li, L. Fu, N. A. Adams, A low-dissipation shock-capturing framework with flexible nonlinear dissipation control, Journal of Computational Physics 428 (2021) 109960.
[43] W. S. Don, P. Li, K. Y. Wong, Z. Gao, Improved symmetry property of high order weighted essentially non-oscillatory finite difference schemes for hyperbolic conservation laws, Advances in Applied Mathematics and Mechanics 10 (2018) 1418­1439.
[44] W. S. Don, D. M. Li, Z. Gao, B. S. Wang, A Characteristic-wise Alternative WENO-Z Finite Difference Scheme for Solving the Compressible Multicomponent Non-reactive Flows in the Overestimated Quasi-conservative Form, Journal of Scientific Computing 82 (2020) 1­24.
31

[45] B. S. Wang, W. S. Don, N. K. Garg, A. Kurganov, Fifth-order A-WENO finite-difference schemes based on a new adaptive diffusion central numerical flux, SIAM Journal on Scientific Computing 42 (2020) A3932­A3956.
[46] N. Fleischmann, S. Adami, N. A. Adams, Numerical symmetry-preserving techniques for low-dissipation shock-capturing schemes, Computers and Fluids 189 (2019) 94­107.
[47] S. Ii, B. Xie, F. Xiao, An interface capturing method with a continuous function: The thinc method on unstructured triangular and tetrahedral meshes, Journal of Computational Physics 259 (2014) 260­269.
[48] B. Xie, S. Ii, F. Xiao, An efficient and accurate algebraic interface capturing method for unstructured grids in 2 and 3 dimensions: The thinc method with quadratic surface representation, International Journal for Numerical Methods in Fluids 76 (2014) 1025­1042.
[49] B. Van Leer, Towards the Ultimate Conservative Difference Scheme. V. A Second-Order Sequel to Godunov's Method, Journal of Computational Physics 32 (1979) 101­136.
[50] S. Pirozzoli, On the spectral properties of shock-capturing schemes, Journal of Computational Physics 219 (2006) 489­497.
[51] E. F. Toro, M. Spruce, W. Speares, Restoration of the contact surface in the HLL-Riemann solver, Shock Waves 4 (1994) 25­34.
[52] E. F. Toro, Riemann Solvers and Numerical Methods for Fluid Dynamics, Elsevier B.V., 2009.
[53] A. Harten, P. D. Lax, B. van Leer, On Upstream Differencing and Godunov-Type Schemes for Hyperbolic Conservation Laws, SIAM Review 25 (1983) 35­61.
[54] E. Johnsen, T. Colonius, Implementation of WENO schemes in compressible multicomponent flow problems, Journal of Computational Physics 219 (2006) 715­732.
[55] S. Gottlieb, On High Order Strong Stability Preserving Runge-Kutta and Multi Step Time Discretizations, Journal of Scientific Computing 25 (2005) 105­128.
[56] A. Kurganov, E. Tadmor, Solution of two-dimensional Riemann problems for gas dynamics without Riemann problem solvers, Numerical Methods for Partial Differential Equations 18 (2002) 584­608.
[57] Z. Xu, C. W. Shu, Anti-diffusive flux corrections for high order finite difference WENO schemes, Journal of Computational Physics 205 (2005) 458­485.
[58] R. S. Sutherland, A new computational fluid dynamics code I: Fyris Alpha, Astrophysics and Space Science 327 (2010) 173­206.
[59] E. E. Schneider, B. E. Robertson, Cholla: A new massively parallel hydrodynamics code for astrophysical simulation, Astrophysical Journal, Supplement Series 217 (2015) 24.
32

