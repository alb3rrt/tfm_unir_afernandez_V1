arXiv:2106.01314v1 [astro-ph.CO] 2 Jun 2021

Prepared for submission to JCAP
Testing the predictions of axisymmetric distribution functions of galactic dark matter with hydrodynamical simulations
Mihael Petac,a Julien Lavalle,a Arturo Núñez-Castiñeyra,b,c Emmanuel Nezrib
aLaboratoire Univers et Particules de Montpellier (LUPM), Université de Montpellier (UMR-5299) & CNRS, Place Eugène Bataillon, F-34095 Montpellier Cedex 05, France bAix Marseille Univ, CNRS, CNES, Laboratoire d'Astrophysique de Marseille (LAM), 38 rue F. JoliotCurie, 13388 Marseille Cedex 13, France cUniversité de Paris and Université Paris Saclay, CEA, CNRS, AIM, F-91190 Gif-sur-Yvette, France E-mail: petac@lupm.in2p3.fr, lavalle@in2p3.fr, arturo.nunez@lam.fr, emmanuel.nezri@lam.fr
Abstract. Signal predictions for galactic dark matter (DM) searches often rely on assumptions on
the DM phase-space distribution function (DF) in halos. This applies to both particle (e.g. p-wave suppressed or Sommerfeld-enhanced annihilation, scattering off atoms, etc.) and macroscopic DM candidates (e.g. microlensing of primordial black holes). As experiments and observations improve in precision, better assessing theoretical uncertainties becomes pressing in the prospect of deriving reliable constraints on DM candidates or trustworthy hints for detection. Most reliable predictions of DFs in halos are based on solving the steady-state collisionless Boltzmann equation (e.g. Eddingtonlike inversions, action-angle methods, etc.) consistently with observational constraints. One can do so starting from maximal symmetries and a minimal set of degrees of freedom, and then increasing complexity. Key issues are then whether adding complexity, which is computationally costy, improves predictions, and if so where to stop. Clues can be obtained by making predictions for zoomed-in hydrodynamical cosmological simulations in which one can access the true (coarse-grained) phase-space information. Here, we test an axisymmetric extension of the Eddington inversion to predict the full DM DF from its density profile and the total gravitational potential of the system. This permits to go beyond spherical symmetry, and is a priori well suited for spiral galaxies. We show that axisymmetry does not necessarily improve over spherical symmetry because the (observationally unconstrained) angular momentum of the DM halo is not generically aligned with the baryonic one. Theoretical errors are similar to those of the Eddington inversion though, at the 10-20% level for velocity-dependent predictions related to particle DM searches in spiral galaxies. We extensively describe the approach and comment on the results.
Keywords: dark matter, dark matter searches, galactic dynamics, structure formation

Contents

1 Introduction

1

2 Phase-space structure of DM haloes

3

2.1 Eddington inversion

4

2.2 Axisymmetric inversion method

4

3 Simulations

5

3.1 Simulation setup

6

3.2 Parametric fits of the galactic components

6

3.2.1 Baryonic gravitational potential

7

3.2.2 DM density profile

9

4 Comparison of the predictions of inversion methods with the simulations

11

4.1 Velocity distributions

11

4.1.1 Direct comparison

12

4.1.2 Similarity in terms of the relative entropy

14

4.2 Velocity moments

16

4.3 Velocity anisotropy

17

5 Implications for DM searches

19

5.1 Direct detection

19

5.2 Indirect detection

22

6 Summary and conclusions

24

A Dependence of the DM velocity moments on the assumptions regarding the DM

density profile

27

B Systematic uncertainties associated with the choice of principal axis

28

C Results for Halo B and Halo C

30

C.1 Baryonic gravitational potential

30

C.2 Mass profiles

31

C.3 Velocity distributions

32

C.4 Velocity moments

35

C.5 Velocity anisotropy

37

C.6 DM searches

37

Contents

1 Introduction
Many searches for dark matter (DM) candidates target processes or phenomena that depend on the DM velocity distribution. This is, for instance, the case for thermally produced cold DM (CDM) candidates [1­7], like weakly-interacting massive particle (WIMP) DM [8­11], either in searches based on direct detection techniques [12­14] or related to the capture of WIMPs in astrophysical bodies [15­ 18], or searches based on indirect detection techniques [19­21], which may also be sensitive to velocitydependent processes like p-wave-suppressed [22­26] or Sommerfeld-enhanced annihilation [24, 27, 28]. In the former situation, making predictions requires information on the local velocity distribution at

­1­

the relevant position, while in the latter, one needs to access the velocity distribution function all over the targeted DM halo. There are actually many other DM candidates' signatures for which the velocity distribution matters, for instance, to make detailed predictions of the microlensing event rate induced by primordial-black-hole (PBH) DM [29­31]. All this generically demands for both theoretical and observational ways to infer the velocity distribution of DM in haloes, for which uncertainties should ideally be controlled.
Since there is no firmly established reliable tracer of the DM velocity distribution function in virialised structures (though see some attempts in [32, 33]), one usually has to predict or constrain it by relying on dynamical consistency, and therefore on solutions to the steady-state collisionless Boltzmann equation applied to gravitational systems. This actually characterizes a minor part of a vast research program dedicated to the understanding of galactic dynamics [34]. In this context, although many past studies have often assumed Gaussian (Maxwellian) velocity distributions based on the isothermal approximation [15, 35] (which provide rough order-of-magnitude estimates), it is well established that predictions in this framework do not reliably compare with the phase-space content of DM structures [34, 36, 37]. Maxwellian template functions can still be used to fit velocity distributions in cosmological simulations of galaxies, with adjustable free parameters not grounded from first principles, but this procedure cannot be considered as a physical prediction per se [38, 39]. However, the increasing precision of experimental or observational data relevant to DM searches within the Milky Way or in its neighborhood [40] presses for theoretical improvement. In particular, the advent of the Gaia mission [41] and its impressive catalog of the Milky Way and its neighbors' stars [42­44] provides us with an unprecedented sample of stars as viewed in phase-space coordinates, which allows us to more strongly constrain the Milky Way DM content and its overall gravitational potential (see e.g. [45­53] for a series of works showing the growing impact of kinematic data). Yet, many theoretical inference methods are based upon assumptions that are themselves not systematically tested, and that could induce uncontrolled theoretical errors. The subject of this paper is precisely to estimate the theoretical errors associated with some inference proposals.
A tractable self-consistent theoretical approach is based on the Eddington inversion method [34, 54­59], which allows one to translate a constrained DM density profile and a constrained overall gravitational potential (comprising all components of the system, including baryons), into a prediction for the DM phase-space distribution function (PSDF) at each point of the system. This method relies on the assumption of maximal symmetry, i.e. spherical symmetry and an isotropic velocity field. Although it does not apply to arbitrary combinations of DM and baryonic configurations (see [59] for a detailed review), it was recently tested against cosmological simulations and shown to be surprisingly reliable given the strong assumptions made [37]. Theoretical errors were estimated at the 10-20% level along most of the radial evolution of the positive or negative nth moments of the velocity and relative velocity distributions, v±n and vr±enl . These moments are those relevant in the predictions of velocity-dependent DM signals. This makes this approach rather powerful because poorly demanding in terms of computational time, while reasonably precise.
The Eddington inversion can actually be extended to anisotropic velocity fields [50, 59­63], still under the assumption of spherical symmetry. Other theoretically much finer approaches rely on actionangle methods, which somewhat represents the state-of-the-art developments in the interpretation of kinematic data [64­66]. Still, action-angle methods do not, for the moment, show a decisive improvement over Eddington-like approaches. Moreover, distribution functions for the actions are difficult to derive from first principle and are either rather empirical or based on some calibration procedures [67, 68]. In this paper, we propose to test an extension of the Eddington inversion that allows not only to account for an anisotropic velocity field, but also to deal with axisymmetric systems. Adding more degrees of freedom and going beyond spherical symmetry may somewhat capture more information when applied to axisymmetric systems like spiral galaxies, or systems potentially exhibiting significant oblateness or prolateness. This improved method, based on an inversion similar to the Eddington inversion, was originally proposed in [69]. It was then further developed and applied to DM searches in [70]. More recently, it was used in a thorough analysis of the Milky Way's kinematic data to get
­2­

constraints on the DM halo and to make predictions for direct DM searches [53]. In this paper, we want to test the reliability of this improved inversion itself with a study similar to the one performed in [37], by comparing predictions for the velocity distribution derived from knowledge of the matter content of cosmological simulations with the velocity distributions directly measured in the same simulations. We will use zoom-in cosmological simulations of Milky Way analogs presented in Refs. [71] and [72].
The paper is organised as follows. In Sec. 2 we first introduce the inversion methods designed for computing the equilibrium PSDFs of collisionless self-gravitating systems. In Sec. 3 we present the deployed set of hydrodynamical simulations and provide the details regarding their analysis. Sec. 4 contains our main results concerning the accuracy of the inversion methods in predicting the velocity distribution of DM. In Sec. 5 we asses the corresponding uncertainties in the predictions for the astrophysical factors that enter direct and indirect DM searches. We conclude in Sec. 6.

2 Phase-space structure of DM haloes

The structure of DM haloes can be conveniently described in terms of the PSDF, f , which is proportional to the number of single species particles, N , in a given volume of the six-dimensional positionvelocity space:

m · dN = f (r, v) d3r d3v

(2.1)

where r and v denote the corresponding position and velocity vectors, while m is the mass of individual particle. In the past, crude estimates of f were often justified by poor observational constraints and the lack of highly accurate experimental searches for signals associated with DM particles. Therefore, the phase-space structure of DM haloes was often approximated by factorizing f (r, v) into the spatial DM density distribution, (r), and Maxwell-Boltzmann (MB) velocity distribution, PMB(v):

f (r, v) = (r) · PMB(v) .

(2.2)

While the above approximation usually leads to the correct order-of-magnitude estimates for the astrophysical factors that enter the interpretation of DM searches, such a simplifying assumption suffers from a number of drawbacks. To begin with, it is not clear how to appropriately choose the velocity dispersion associated with the MB distribution and several different choices have been suggested throughout the literature ­ for their comparison see, e.g., [37, 59]. Beside the ambiguity in the associated velocity dispersion, the MB velocity distribution predicts non-zero probability for particles with velocities well beyond the typical escape velocity, vesc, of galaxies. To address this issue, a sharp truncation of PMB(v) beyond vesc has often been used, however, this still leads to spurious results for probes that are particularly sensitive to the high-velocity tail of the distribution. Finally, even if correct velocity dispersion and escape velocity are chosen, the ansatz from Eq. (2.2) represents a stationary solution of the Boltzmann equation only if the associated DM density profile is the one of the singular isothermal sphere, i.e. (r)  r-2, and there is no additional contributions to the total gravitational potential of the system. However, the presence of baryons together with various astronomical observations, as well as cosmological simulations, which provide strong evidence that the DM density slope is shallower in the centres of galaxies and steeper in the outskirts, generically imply a deviation from the simple Maxwellian velocity distribution.
The above-described shortcomings of models based on the MB velocity distribution, as well as the availability of increasingly precise observations that can be used to constrain the dynamical structure of galaxies, motivate us to go beyond the simplest approximations. In the following we will describe two alternative models that are by construction equilibrium solutions to the Boltzmann equation, but differ in the assumed level of symmetry. Firstly, we will take a closer look at the spherically symmetric Eddington inversion and briefly mention its anisotropic generalizations. This will be followed by a short review of the axisymmetric inversion method, that has been applied in the context of DM only recently, but offers a more accurate approach for modelling the phase-space distribution of DM in disc galaxies, which are characterised by their axisymmetric morphology.

­3­

2.1 Eddington inversion
It has long been recognised that it is possible to obtain explicit solutions of the collisionless Boltzmann equation for self-gravitating systems with maximal symmetry. More precisely, Eddington showed that for a collection of collisionless particles with a given radial density profile, (r), embedded in a spherical gravitational potential, (r), 1 an unique spherically symmetric and isotropic PSDF can be computed as follows [54]:

1

E d d2

f (E) =  · 82

0

 E

-

·

d2

.

(2.3)

In the above expression, E  (r) - v2/2 is the relative energy that fully parametrizes the class of PSDFs describing such systems. While the Eddington inversion allows one to obtain a DM phasespace distribution consistent with the presence of several galactic components that enter the total gravitational potential, it is limited to spherically symmetric configurations. Furthermore, in its original formulation it is restricted to ergodic, and hence isotropic, distribution functions. There exist several generalizations to anisotropic systems, in which case the PSDF additionally depends on the magnitude of angular momentum, |L|, i.e. f  f (E, |L|). However, the existing extensions rely on relatively strong assumptions regarding the velocity anisotropy profile ­ the latter is either assumed to be a constant [34], have the Osipkov-Merritt form [60, 61] or a combination thereof [62, 63, 74]). Furthermore, the anisotropy profile has to be specified a priori, but is in practice impossible to constrain from the existing observations. An additional problem of such anisotropic generalizations of the Eddington approach is the fact that they often lead to unphysical solutions, as was recently investigated in [59]. Therefore for the purpose of this work, we focus only on the original Eddington's formulation of the inversion method.

2.2 Axisymmetric inversion method
By assuming that the system under consideration is axisymmetric, the corresponding PSDF can be written as a function of two integrals of motion, namely f = f (E, Lz), where E is the aforementioned relative energy and Lz is the specific angular momentum around the axis of symmetry, i.e. Lz  Rv, where {R, , z} denote to the standard set of cylindrical coordinates. In this case, a generalization of the Eddington inversion formula can be obtained, allowing one to compute f (E, Lz) for an arbitrary axisymmetric density-potential pair. In particular, we will adopt the numerical approach developed by Hunter & Qian [69, 75], that relies on theoretical foundations previously laid out by LyndenBell [76]. Until recently, the method was applied only to stellar systems, while it was for the first time systematically studied in the context of DM in [70]. We refer the reader to the above references for the proof of the method and detailed discussions regarding its numerical implementation. 2 In the remainder of this section, we will provide a short review of the method.
Under the assumptions stated above, the PSDF can be decomposed in two parts, f+ that is even in Lz and f- that is odd:

f (E, Lz) = f+(E, |Lz|) + f-(E, Lz) ,

(2.4)

The even part contains all the information regarding the density distribution, while the odd part describes the rotational properties of the considered system. Hunter & Qian [69, 75] showed that the Lz-even part of PSDF can be computed by providing an analytic continuation of the density-potential
1Throughout this work (r) denotes the relative gravitational potential that is defined as (r)  -(r) + 0, where (r) is the standard gravitational potential and 0 a constant such that (r) vanishes at the boundary of the system. In the following we focus on isolated systems for which 0 = 0. On the other hand, for truncated objects Eq. (2.3), as well as Eq. (2.5) and Eq. (2.7), contain additional boundary term ­ for more detailed discussion see, e.g., [59, 73].
2In this work we evaluate the axisymmetric PSDF using our numerical implementation, which is publicly available at https://github.com/mpetac/AIM

­4­

pair in the complex plane and evaluating the following contour integral:

1

f+(E, |Lz|)

=

 42i 2

d d2(R2, )

 C(E)  - E

d2

=

.

R2=

L2z 2(-E

)

(2.5)

In the above expression C(E) refers to a path which tightly wraps around the real axis between the value of the potential at spatial infinity and a value corresponding to a circular orbit with relative energy E. Additionally,  is considered as a function of the radial coordinate and the total gravitational potential, which is in principle always possible for monotonic (R2, z2). However, in the great majority of practical situations one cannot express the density profile as an explicit function of the total gravitational potential and one is forced to perform the derivative implicitly, using the z-coordinate:

d2(R2, ) d2(R2, z2) d(R2, z2) -2

d2 = d(z2)2

dz2

d(R2, z2) d2(R2, z2) d(R2, z2) -3

- dz2

d(z2)2

dz2

,

(2.6)

and evaluate it at z2 such that (R2, z2) = . Values of z2 fulfilling the latter equality typically need to be found via numerical minimization routines. The Lz-odd part of PSDF can be computed analogously, using the following expression:

f-(E, Lz)

=

sign(Lz ) 82i

d C(E)  - E

d2 (v¯)

d2

=

R2=

L2z 2(-E )

.

(2.7)

It is important to note that, in order to evaluate f- one needs to specify also the rotation profile, v¯(R2, z2), which is in the case of DM haloes essentially unconstrained by the observations 3. However, as will be discussed in Sec. 4.1, numerical simulations show that v¯ is typically much smaller than the velocity dispersion in the azimuthal direction and hence f- provides only a subdominant contribution
to f . For this reason, as well as possible issues with obtaining physical solutions, we will in the following consider only the v¯(R2, z2) = 0 case.

3 Simulations
Within the past decades, we have witnessed rapid improvements in the capabilities of simulating the formation and evolution of galaxies. While the initial studies were exclusively focused on the gravitational dynamic of collisionless DM particles, subsequent works began including baryonic physics with ever-increasing accuracy. This gave rise to the so-called hydrodynamical simulations, which treat gas as a fluid, while the corresponding sub-grid physics is handled by a number of prescriptions that are carefully calibrated against various observational constraints.
Today, sophisticated algorithms coupled with modern computational capabilities allow us to simulate galaxies with unprecedented realism and address questions which were until recently inaccessible to existing methods. These improvements are of great importance also for studies of the DM phasespace distribution within spiral galaxies, which we address in this work. In order to adequately resolve the full six-dimensional distribution of DM in the position-velocity space, one needs to track millions of individual particles that self-consistently evolve in the presence of baryons. Despite the aforementioned improvements, a satisfying resolution can only be reached by performing dedicated simulations focused on a single object, commonly referred to as zoom-in simulations. The aim of this work is to carry out a detailed comparison of the DM phase-space distribution as predicted by the inversion
3There have been several studies that find correlations between the spin parameter and the environment, as well as merger history, of individual DM haloes [77­81]. However, such information can be used only to provide indirect constraint on v¯, since the spin parameter is related merely to the total angular momentum of the halo.

­5­

methods, described in the previous section, with the results of the high-resolution zoom-in simulations. In particular, we first extract the quantities that can be, at least in principle, inferred from astronomical observations and, subsequently, obtain the corresponding phase-space distribution of DM using the Eddington and axisymmetric inversion methods. Finally, the predicted DM phase-space distributions can be compared with the ones directly extracted from the simulated objects. This allows us to assess the systematic uncertainties induced by the assumptions upon which the inversion methods are built, namely the hypothesis of dynamical equilibrium and the symmetries of the system.
In the following, we first give a brief description of the deployed set of hydrodynamical simulations. Subsequently, we provide a detailed discussion regarding our approach of extracting the baryonic gravitational potentials and the DM density profiles of the simulated objects, as they represent the crucial ingredients for reconstructing the corresponding PSDFs via the inversion methods.
3.1 Simulation setup
We perform the outlined comparison of the inversion methods with the simulations on three distinct hydrodynamical runs (the same as used in [37]), which tracked the formation and evolution of individual spiral galaxies. All three runs were performed using the Eulerian hydrodynamical adaptive mesh code RAMSES [82], while their initial conditions were randomly generated using the MUSIC package [83] for a similar set of fiducial cosmological parameters. Furthermore, all three simulations used the same prescriptions for the sub-grid baryonic physics, though with one of the run with improved spatial resolution, hence a slightly different tuning of the subgrid control parameters [37].
Our main benchmark simulation is dubbed "Mochima" and has been originally introduced in [72], where it served as the control run for comparing different implementations of baryonic physics. It possesses slightly higher resolution than the other two runs, which we refer to as "Halo B" and "Halo C", that have been presented and thoroughly studied in [71]. As previously mentioned, all three simulations rely on identical baryonic prescriptions. For gas they use the conventional cooling, ultraviolet background and self-shielding recipes, while the star formation is modelled using the Schmidt law with adapted density threshold and efficiency. The supernova (SN) feedback is implemented according to the "delayed cooling" prescription, which relies on non-thermal injection of energy  10 Myr after the birth of star particles, generated with a Chabrier initial mass function, with the energy of 1051 erg per SN event. Further details regarding the implementation of baryonic physics in Mochima and Halo B & C can be found in [72] and [71], respectively.
Within the Mochima simulation, the galaxy lies at the centre of 36 Mpc cosmological box with an approximate resolution (estimated by the minimal cell size) of lsm  35 pc. The masses of individual DM and star particles are MDM = 1.95 · 105M and M = 1.57 · 104M , respectively. On the other hand, Halo B and Halo C both implement a 20 Mpc cosmological box with approximate resolution of lsm  150 pc, while the masses of individual DM and star particles are MDM = 2.31 · 105M and M = 2.87 · 104M , respectively. Apart from the resolution, the galactic DM halo found in the Mochima simulation notably differs from the ones in Halo B and Halo C by having a steep central cusp, while the other two runs exhibit cores. This is presumably due to a weaker SN feedback [37], which is a consequence of tuning the free parameters of the delayed cooling prescription to the values appropriate for the higher resolution of the Mochima simulation [72, 84]. On the other hand, all three runs exhibit a contraction of the DM halo around the disc scale length in comparison with the corresponding DM-only simulations. Apart from the above properties, all three hydrodynamical runs resulted in DM haloes that are to a good approximation spherically symmetric and close to dynamical equilibrium ­ for quantitative analysis see [72]. Finally, it is worth noting that in the case of Halo B there is a significant, O(1 kpc), displacement between the centres of baryons and the gravitational potential [71, 72].
3.2 Parametric fits of the galactic components
The predictive power of inversion methods crucially depends on accurate measurements of the relevant input quantities. As explained in Sec. 2, these consist of the total gravitational potential of the system,
­6­

, and density distribution of DM, , but possibly also other physical quantities, such as DM's velocity anisotropy in the case of anisotropic generalizations of Eddington approach or DM's rotational profile in the case of axisymmetric inversion method. In practice, accurate determinations of  and  are limited by observational uncertainties, however, since the main purpose of this work is to assess the systematic uncertainties that arise due to the modelling assumptions of the inversion methods, we neglect the observational errors and fit the gravitational potential and DM density profile directly to the particle grids produced by the simulations. From the observational perspective, the situation is even worse for the orbital anisotropy and rotational profile of the DM halo ­ these can not be observed through the existing probes and hence represent irreducible sources of systematic uncertainties. While we have chosen not to study anisotropic generalizations of the Eddington approach due to the several associated issues mentioned in Sec. 2.1, we have explicitly checked that rotational profiles of the DM haloes provide a negligible correction with respect to the non-rotating case. Therefore, we restrain from performing an extensive study of the systematics which arise from unobservable anisotropy and rotational profiles.
In the following we specify the assumed parametric forms for the physical quantities that enter Eddington and axisymmetric inversion methods, as well as describe how they were extracted from the simulations. For the purpose of this work, we decompose the total gravitational potential into baryonic and DM component. As the latter is in one-to-one correspondence with the DM density distribution, we first turn our attention to the gravitational potential sourced by the baryons only, and subsequently address the DM density distribution.

3.2.1 Baryonic gravitational potential
The distribution of baryons within galaxies can be modelled in a number of different ways, which do not necessarily lead to equivalent results. For example, stellar and gas components are often treated separately since they can be constrained by different sets of observations. Moreover, the stars can be further subdivided in distinct classes, depending on their spatial distribution, kinematical properties and/or spectra. For each of these constituents special observationally-motivated density distributions have been suggested throughout the literature, e.g. truncated triaxial distributions for the bulge and various double exponential distributions for different disc components (for comprehensive overview see, e.g., [34]), whose gravitational potentials typically have to be computed through numerical quadrature. However, for the purpose of obtaining the phase-space distribution of DM through the inversion methods, one is interested only in the overall baryonic gravitational potential. Therefore, we in this work resort to a simpler approach, where the total baryonic potential is approximated by a combination of two analytic functions ­ these greatly reduce the computational cost of performing the inversions and have a well-defined continuation in the complex plane, which is required by the axisymmetric method. In particular, to accommodate the central bulge we adopt a spherical Hernquist potential [85]:

H(R, z)

=

 GMH R2 + z2 + aH

,

while the disc is approximated by a single Miyamoto-Nagai [86] (MN) component:

(3.1)

MN(R, z) =

GMMN

.

2

R2 + aMN + z2 + b2MN

(3.2)

Even though the above model is much simpler than separately inferring the density distributions of multiple disc components, we in the following demonstrate that it performs very well in fitting the over all baryonic gravitational potential. For the purpose of Eddington inversion, however, the above axisymmetric ansatz needs to be converted to a spherically symmetric approximation, sph(r). We achieve this by demanding that the corresponding rotation curve, which is typically the most

­7­

constraining observation regarding the galactic potential, remains unchanged:

sph(r)  H(R, z) + MN(R, z)

.

r

R

R

R=r

z=0

(3.3)

The first step in our analysis is to match the aforementioned sum of Hernquist and MN potentials

to the baryonic gravitational potential inferred from the simulations. The latter is computed as a sum of Keplerian potentials of the individual baryonic particles: 4

sim(r)

=

G
k  stars,gas

mk |r - rk|

,

(3.4)

where G is the gravitational constant, while mk and rk are the mass and position vector of the kth gas cell or stellar particle. However, the above expression does not automatically lead to an axisymmetric
potential, which is required by the adopted parametrization. Therefore, sim(r) has to be averaged over the azimuthal angle, , to obtain the average axisymmetric potential ¯ sim(R, z), while for the purpose of fitting we also compute the corresponding standard deviation ¯ (R, z). In particular, they are obtained by evaluating sim(r) in N = 100 points, corresponding to a randomly chosen values of  at a given pair (R, z) of coordinates:

¯ sim(R, z)

=

1 N

N i=1

sim(r(R, z, i)) ,

2¯ (R, z)

=

1 N -

1

N i=1

sim(r(R, z, i)) - ¯ sim(R, z) 2 .

(3.5)

The fitting of the parametric functions is performed over a grid of 400 points, denoted as P, where R and z are logarithmically spaced in the interval R, z  [0.1 kpc, 20 kpc], while we explicitly

checked that varying these choices does not substantially change our results. We proceed by minimizing the following 2 test statistics with respect to the free parameters   {MH, aH, MMN, aMN, bMN}:

2() =
i  P

H(Ri, zi | MH, aH) + MN(Ri, zi | MMN, aMN, bMN) - ¯ sim(Ri, zi)

2
.

¯ (Ri,zi)

(3.6)

The resulting best-fit parameters, min, for the baryonic gravitational potentials of the three simulated
objects studied in this work are reported in Tab. 1. We assess the goodness of the fits by computing the corresponding reduced chi-squared, 2red  2(min)/(N - P ), where (N - P ) is the difference between the number of points used in the fit and the number free parameters. For all the studied objects it amounts to 2red 1, which indicates excellent agreement between our parametrization and the values extracted from the simulations. This can also be appreciated from the relative difference

between our best-fit models and the azimuthally averaged baryonic gravitational potential, which is

shown left-hand panel in Fig. 1 for Mochima, while the corresponding plots for Halo B and Halo C can

be found in Fig. 14 of Appendix C. From the figures it can be observed that our ansatz for the baryonic

potential leads to relative differences of less than 10% over the entire considered R-z range in all three

simulated objects. In the case of the spherical gravitational potential, the residuals are notably larger

at z 2 kpc and the relative difference can exceed 20%, as can be seen from the corresponding plot

in the right-hand side panel of Fig. 1. While this could be improved by performing an independent fit

for the spherical model, the approach of approximating it through Eq. (3.3) ensures that the galactic

gravitational potential is consistent with the associated rotation curve, which typically provides the

strongest observational constraint on a galactic mass model. Furthermore, as we show in Appendix A

by comparing our results with those of [37], where the baryonic gravitational potential was derived

directly from the enclosed baryonic mass, these different choices can induce at most a few percent

difference in the inferred moments of the DM velocity distribution.

4We explicitly checked that the method is numerically stable, namely that the result does not change upon removing the particle with the smallest |r - rk|.

­8­

Simulation Mochima Halo B Halo C

MH [M ] 1.9 · 1010 2.1 · 109 4.6 · 1010

aH [kpc] 0.61 0.41 3.4

MMN [M ] 5.7 · 1010 1.3 · 1011 8.3 · 1010

aMN [kpc] 15 4.4 3.1

bMN [kpc] 0 1.3
0.55

Table 1. The best-fit parameters for the baryonic gravitational potential obtained for the three simulated objects studied in this work.

Figure 1. Relative difference between our best-fit and the azimuthally-averaged baryonic gravitational potential for the Mochima simulation. In the left-hand side panel we show the results for the axisymmetric parametrization, while the corresponding spherical solution (obtained according to Eq. (3.3)) is shown in the right-hand side panel.

3.2.2 DM density profile

The other key quantity for obtaining the phase-space distribution of DM through the inversion methods is the DM density profile, which at the same time also determines the DM's contribution to the total gravitational potential. Throughout the literature, there exist several different parametric density profiles that have been motivated either by numerical simulations or observations. The amount of resolved substructure in high-resolution simulations makes it inconceivable to fully capture the DM distribution of individual objects, however, it is still possible to obtain reasonably good approximations using simple parametric forms. In this work, we limit ourselves to the commonly used cuspy NavarroFrank-White (NFW) [87] and cored Burkert (BUR) [88] density profiles:

NFW(r)

=

s r/rs (1 + r/rs)2

,

BUR(r)

=

s (1 + r/rs) (1 + r2/rs2)

,

(3.7) (3.8)

which depend only on two free parameters, namely the characteristic density, s, and radius, rs. The choice of these two profiles is additionally motivated by the fact that they allow for closed analytical expressions for the corresponding gravitational potentials, which greatly reduces the computational cost of performing the phase-space inversions. As we will show at the end of this section, the NFW profile turns out to be a reasonable approximation for the DM halo found within the Mochima simulation, while Halo B and Halo C exhibit cores that are significantly better fit by the Burkert profile. We have explicitly checked that allowing for spheroidal shape of the halo (i.e. substituting r  R2 + z2/q2 in the above formulas, with q controlling the flattening of the density profile) does not lead to significant improvements in the fits ­ for Mochima and Halo C we find q  1, while Halo B prefers somewhat flattened halo, however, this is primarily due to a smearing effect related to a significant displacement between the centres of DM and baryons [71]. To further improve the fits, one could, for example, consider the Zhao parameterization [89], where the DM density slopes at different parts of the profile are

­9­

Simulation Mochima Halo B Halo C

Profile NFW Burkert Burkert

log10 s [M /pc3] 7.26 7.82 7.81

rs [kpc] 11.5 5.67 5.94

Table 2. The appropriate (NFW or Burkert) density profiles and their corresponding best-fit values of the parameters for the three objects studied in this work.

allowed to vary freely. These generalized profiles were actually used in tests of the Eddington inversion on the same simulations in [37]. While such a parametrization leads to noticeable improvements in the goodness of the fit, especially in the case of Mochima due to particularly steep central cusp, obtaining the corresponding PSDF is much more computationally demanding since the associated gravitational potential needs to be evaluated numerically. Furthermore, we found that Zhao's family of density profiles can often lead to non-physical solutions within the scope of axisymmetric inversion method. On the other hand, allowing for more flexible parametrization does not significantly affect the resulting moments of the DM velocity distribution, which are of primary interest for DM searches ­ see Appendix A for the comparison of our results with those of [37].
To obtain the best-fit parameters of the NFW and Burkert density profiles we rely on the corresponding expressions for the enclosed DM mass:

MNFW(r) = 4srs3 log

r 1+
rs

r -
r + rs

,

MBUR(r) = srs3 log

r2

r2

1+ rs

· 1 + rs2

r - 2 arctan
rs

.

(3.9) (3.10)

The reason for fitting the enclosed DM mass, instead of the DM density profiles directly, is the fact that extracting M (r) from the simulations is much more numerically stable. In particular, inferring the DM density distribution is highly susceptible to computational artefacts related to the finite resolution, while the DM mass enclosed within radius r can be reliably computed by simply summing over the mass of individual DM particles that are located within a sphere of the same radius, S(r):

Msim(r) =

Mi .

iS (r)

(3.11)

After computing Msim(r) in Nr = 100 evenly distributed radial points in the range r  [1 kpc, 100 kpc], the following loss function is minimised with respect to the free parameters,  = {s, rs}:

Nr
L() =
i=1

MNFW/BUR(ri| ) - 1

2
.

Msim(ri)

(3.12)

As already mentioned above, the DM halo found in Mochima simulation exhibits a central cusp and is, therefore, better fit by an NFW density profile. The latter performs well at r 5 kpc, where the relative difference in the enclosed DM mass does not exceed 10%. On the other hand, in the inner few kpc the fit leads to an increasing deficit of DM, which implies that the simulated halo has a significantly steeper central cusp. This can be clearly seen in Fig. 2, where we show the true and best-fit NFW mass profiles, as well as their relative difference. For comparison we also include the DM mass profile corresponding to the Zhao parametrization obtained in [37], which performs notably better with residuals at the percent level at all radii. In case of Halo B and Halo C, for which the analogous plots can be found in Fig. 15 of Appendix C, the cored Burket profile provides a decent match, with relative errors of less than 10% over most of the considered radial range. We report the best-fit parameters for all three simulations in Tab. 2.

­ 10 ­

Figure 2. Upper panel shows the mass profile extracted from Mochima simulation and the corresponding NFW and gNFW fits, while the lower panel shows their relative difference, as a function of radius.
4 Comparison of the predictions of inversion methods with the simulations
In the following we explore the level of agreement between the predictions of the inversion methods and the actual phase-space distribution of DM within the simulations. Since the inversion methods relie on the DM density profile as an input, all the relevant predictions are fully encoded within the positiondependent velocity distribution of DM. Throughout this section, we will take a closer look at the latter, as well as various related quantities, such as the DM velocity moments and orbital anisotropy. In doing so, our main goal is to highlight the key differences that arise between the Eddington and axisymmetric inversion and assess the associated systematic uncertainties by comparing the resulting predictions to the values extracted directly from the simulations. In the discussion of our results, we will primarily focus on the Mochima simulation, which offers the highest resolution among the available runs, while we will also briefly comment on our findings for Halo B and Halo C, for which the corresponding plots can be found in Appendix C.
Before entering a detailed comparison of the predictions of the inversion methods with the simulations, we briefly summarize the results obtained in our fits of baryonic gravitational potentials and DM density profiles. The DM halo found in the Mochima simulation has a cuspy density profile with a best-fit NFW scale radius of rs = 11.5 kpc. On the other hand, Halo B and Halo C favour a Burkert DM density profile with a core radius of  6 kpc. Further differences can be observed in the obtained fits of the baryonic gravitational potentials. Mochima and Halo C feature a relatively massive bulge, which is, however, in the case of the latter not as dense due to the unusually large scale length, aH = 3.4 kpc. We find the least pronounced disc component in the case of Mochima, as it has the lowest mass, MMN = 5.7 · 1010 M , and particularly large scale length, aMN = 15 kpc. Halo C possesses slightly more massive disc, but with a considerably smaller disc scale length, which is shorter than the one of the accompanying bulge component, i.e. aMN = 3.1 kpc aH. On the other hand, for Halo B we find the least massive bulge and the most massive disc component, with MMN = 1.3 · 1011 M and aMN = 4.4 kpc. Even though the disc in Halo B features somewhat larger scale height, bMN = 1.3 kpc, we non-the-less expect that the axisymmetric inversion will bring the most significant improvements over the Eddington method for this simulation due to the most pronounced disc component.
4.1 Velocity distributions
The most direct comparison between the predictions of the inversion methods and the simulations can be performed by examining the probability distribution for DM velocity at different positions
­ 11 ­

within the DM halo. Due to the symmetry assumptions, the Eddington approach leads to identical velocity distribution over the entire spherical shell associated with some galactocentric radius r, while the axisymmetric inversion method distinguishes among different positions along the meridional (R^z^) plane. Furthermore, the original Eddington's formulation, where the phase-space distribution can be expressed as a function of only the relative energy, necessarily results in an isotropic velocity distribution, whereas the two-integral method leads to distinct predictions for the velocity distributions along the azimuthal direction and the meridional plane ­ i.e., f (E, Lz) explicitly depends on v through Lz, while E depends only on the velocity magnitude. On the other hand, the simulations are not restricted by any symmetry assumptions and, in principle, further distinct components of the velocity distribution as well as their dependence on the three-dimensional position vector could be studied. However, in order to perform a direct comparison with the predictions of the inversion methods, as well as maintain sufficient number of particles to adequately sample the velocity distributions, we in this work restrict our attention to the probability density functions for the velocity magnitude, P (v), (also referred to as the speed distribution), meridional velocity, PM(vM) and azimuthal velocity, P(v). All of these were extracted from the simulations by binning the velocities of particles that fall within a torus, centred at a given pair of {R, z} coordinates, with radius (R, z) = min +  · R2 + z2. For each simulation min and  were chosen such that each torus contained at least 1000 particles, while we explicitly checked that varying these hyper-parameters does not significantly affect our results.
In the following we first perform a qualitative comparison of the predictions under different symmetry assumptions by inspecting the aforementioned velocity distributions at several galactocentric distances. This is followed by a quantitative comparison based on relative entropy measure and the moments of velocity distribution, as well as the resulting orbital anisotropy, over the entire DM halo.
4.1.1 Direct comparison
In the following we present the comparison of velocity distributions predicted by the axisymmetric and Eddington inversion methods with the ones extracted from Mochima simulation at three different radial distances along the galactic plane. As can be observed from the corresponding plots ­ shown in Figures 3, 4 and 5, for speed, meridional and azimuthal velocity distribution, respectively ­ the inversion methods provide fairly good approximations to the true velocity distributions. However, some further comments are in place to emphasize the key differences between the Eddington and axisymmetric inversion methods. To begin with, it should be noted that the axisymmetric approach in the presence of flattened gravitational potential (which in our case arises due to the baryonic disc, but could also be sourced by a flattened DM halo) results in kinematically warmer particles along the meridional plane, while the velocity dispersion along the azimuthal direction is decreased. This leads to shifts in the peaks of the speed distributions, shown in Fig. 3, to slightly larger velocities, which indeed provides a better match with the speed distributions observed in the simulation. The indicated trend is most evident in the plot corresponding to R = 3 kpc, where the contribution of baryonic disc to the total gravitational potential is the most significant, while it slowly diminishes with increasing R. On the other hand, it is quite surprising to see that the predictions for the meridional velocity distribution, shown in Fig. 4, do not show the same improvement. While the most probable meridional velocity in the simulation seems to be in better agreement with the predictions of Eddington inversion, one can observe a significant excess of power in the true PM(vM) at larger velocities. The axisymmetric inversion method generally shows the correct trend, i.e. slightly increased probability density for high vM, the match in the actual shape of the high-velocity tails of the distributions is rather poor. Further unexpected discrepancies are observed in the azimuthal velocity distribution, P(v), shown in Fig. 5. As can be seen from the plots, the performance of the inversion methods strongly depends on the radial distance. At R = 3 kpc both of the methods predict P(v) reasonably well, at R = 9 kpc the Eddington prediction performs better due to the aforementioned larger spread in the azimuthal velocity distribution, while at R = 26 kpc the axisymmetric inversion method provides the best match due its significantly more peaked distribution. As a final remark, the plots of P(v) also clearly show that accounting for the halo rotation provides only a small correction to the predicted velocity distribution.
­ 12 ­

While non-vanishing v¯ is present within the simulation, leading to slightly asymmetric P(v) with respect to v¯ = 0, it is evident that correctly predicting the width of the distribution remains the primary challenge of the inversion methods.
Figure 3. Comparison of the speed distribution extracted from the Mochima simulation with the corresponding predictions of the axisymmetric and Eddington inversion methods at three different radial distances along the galactic plane.
Figure 4. Comparison of the meridional velocity distribution extracted from the Mochima simulation with the corresponding predictions of the axisymmetric and Eddington inversion methods at three different radial distances along the galactic plane.
In the case of Halo B and Halo C, for which the analogous plots can be found in Figures 16 and 17 of Appendix C, we find larger discrepancies between the predictions of inversion methods and the true velocity distributions, as well as bigger differences between the spherical and axisymmetric models themselves. This can be most clearly seen at R = 3 kpc, where the speed and meridional velocity distributions of Halo B are much better approximated by the axisymmetric inversion, while in the case of Halo C the Eddington method performs better. At larger radii, where the differences between the two methods become smaller, we observe similar trends as in the case of Mochima simulation, namely the axisymmetric inversion generally leads to slightly more accurate predictions for the speed distribution, while the Eddington approach performs better in predicting the meridional velocity distribution. On the other hand, the azimuthal velocity distribution tends to be better approximated by the Eddington prediction at small R and axisymmetric inversion method at large R in both simulations .
Since the Eddington inversion is only a subclass of solutions allowed by the more general axisymmetric method, one would naively expect that the latter should always provide a more accurate description of the studied system. However, as it is evident from the above results, this is not always
­ 13 ­

Figure 5. Comparison of the azimuthal velocity distribution extracted from the Mochima simulation with the corresponding predictions of the axisymmetric and Eddington inversion methods at three different radial distances along the galactic plane.

the case. The apparent inconsistency can be resolved by noting that the simulated objects are only approximately axisymmetric and that the net angular momentum of the DM halo is not necessarily normal to the galactic plane. Such departures from the assumptions of the axisymmetric model can lead to less accurate predictions for the components of the velocity distribution, or in certain cases even the speed distribution, than the simpler spherically symmetric approach. Upon more careful inspection of Halo C, we indeed find a 53 misalignment between the angular momentum of the DM halo and the normal vector of the disc plane, which explains the poor accuracy of the axisymmetric method when contrasted with the predictions of the Eddinton inversion. On the other hand, in the case of Mochima and Halo B the misalignment is less significant,  20, and, hence, the axisymmetric method manages to provide more accurate results for the speed distribution, but not for the meridional and azimuthal components. However, as we demonstrate in Appendix B, when the angular momentum of the DM halo is chosen as the principal axis of the system, the axisymmetric inversion leads to equally or more accurate predictions than the Eddington inversion even for the individual components of the velocity distribution. Nevertheless, we for the remainder of this work adapt the coordinate system in which the z-axis is perpendicular to the baryonic disc, since in practice the orientation of halo's angular momentum is not accessible through the existing observations.

4.1.2 Similarity in terms of the relative entropy

The above discussion highlights the key qualitative differences between the velocity distributions extracted from the simulations and the corresponding predictions of the two inversion methods. By simple visual inspection it is possible to appreciate the improvements in the predictions for the speed distribution introduced by the axisymmetric approach, whereas the situation is much less clear for PM(vM) and P(v). Moreover, one would ideally like to assess the match between the predictions and the simulations over the entire radial range, instead of inspecting it only at several hand-picked values of R. For these reasons, we resort to the relative entropy, also known as Kullback-Leibler divergence DKL [90], which is commonly used as a metric for quantifying the similarity between two probability distributions. Given an observed discrete (i.e. binned) probability distribution P and the corresponding theoretical prediction Q, the value of DKL can be computed as follows:

P (x)

DKL(P |Q) 

P (x) log Q(x)

xX

(4.1)

where X spans the common probability space ­ according to the standard convention, we set the terms for which P (x) = 0 to zero, while we limit X to a range of values where Q(x) = 0. As can be appreciated from Eq. (4.1), the relative entropy vanishes if the two probability distributions are exactly equal, i.e.

­ 14 ­

DKL(P |Q = P ) = 0, while it takes increasing positive values with increasing difference between the compared probability distribution. 5
In Fig. 6 we show the obtained values of DKL for the speed distribution, as well as its meridional and azimuthal components, as a function of radial distance R along the galactic plane of the Mochima simulation. The plots confirm our qualitative observations based on the visual inspection of the velocity distributions. In particular, the speed distribution predicted by the axisymmetric inversion method is notably closer to the one extracted from the simulation over most of the considered radial range. On the other hand, the meridional velocity distribution seems to be more accurately approximated by the Eddington inversion, however, at several values of R the predictions of the two methods come very close and occasionally the axisymmetric method leads to an even better match. This agrees with our qualitative observations from the previous section, where we noted that the Eddington approach tends to predict more accurately the most probable velocity, while the axisymmetric method better accounts for the abundance of high-velocity particles. Regarding the azimuthal velocity distribution, the relative entropy shows that the two methods perform roughly the same up to R  5 kpc, where the Eddington prediction becomes more accurate. This remains true up to R  15 kpc, beyond which the axisymmetric inversion leads to a better agreement with the simulation. Additionally, from Fig. 6 we can see a clear trend that the predictions of inversion methods are the most accurate around R  25 kpc, with slowly degrading performance towards the center and large fluctuations at greater R. The latter is caused by the presence of numerous DM substructures in the outskirts of the halo, while the increasing differences in the inner parts might be implying that a more elaborate modelling is required to fully capture the intricate interplay between DM and baryons. Finally, we note that the predictions of the axisymmetric method can be substantially improved by choosing the principal axis of the system to be aligned with the angular momentum of the DM halo ­ for comparison see Fig. 13 of Appendix B.
Figure 6. Relative entropy between the true velocity distributions and the predictions of axiymmetric and Eddington inversion methods as a function of the radial distance along the galactic plane.
The analogous results for the relative entropy profiles of Halo B and Halo C, shown in Figures 18 and 19 of Appendix C, again conform with our qualitative findings from the previous section. Most notably, the axisymmetric method performs significantly better than the Eddington inversion in the central part of Halo B, which was expected due to the particularly massive baryonic disc. The opposite
5Strictly speaking, the latter is true only if the domains of P and Q overlap. However, in the context of comparing the predicted velocity distributions with the simulations, this is always the case. A mismatch in the domains can only arise if the velocity distributions have different escape velocities. However, since the latter are determined by the fits of DM density profile and the baryonic gravitational potential or possible truncation of the object (and not the inversion methods per se), they are not particularly important for assessing the accuracy of the predictions of inversion methods, especially since the dominant contribution towards DKL arises from the bulk of the distribution.
­ 15 ­

is true in the inner few kpc of Halo C, where due to the aforementioned misalignment between the galacitc disc and the angular momentum of the DM halo the Eddington inversion provides more accurate results. At R 5 kpc the predictions for the speed distributions in Halo B and Halo C improve for both inversion methods, although they are still somewhat less accurate than what we found in the case of Mochima simulation. At intermediate distances the meridional and azimuthal velocity distributions tend to be more accurately predicted by the Eddington inversion, which is again related to the departures from the assumed axial symmetry. At large distances the predictions of the two models become very similar, however, their agreement with the velocity distributions observed in the simulations degrades, which is linked to the presence of significant DM substructures in the outskirts of the halo.
4.2 Velocity moments
The above comparison of the predicted vs. "measured" velocity distributions allows us to test the predictive power of the inversion methods at the most fundamental level. However, for practical purposes one is often interested only in the moments of the speed distribution that typically enter the interpretation of results of DM searches. Furthermore, the velocity moments can also provide us with additional insights regarding the accuracy of the inversion methods' predictions, since positive and negative moments are particularly sensitive to the high and low velocity tails of the distribution, respectively, which were not of great importance for the discussion in the previous section.
Motivated by the above considerations, we show in the left-hand side panel of Fig. 7 the first two negative and positive moments of the speed distributions along the galactic plane for the Mochima simulation. In the right-hand side panel of the same figure we show the corresponding relative differences between the two inversion methods and the simulation for easier assessment of the (dis)agreement. The first thing to notice is the fact that both inversion methods lead to velocity moments that provide rather good match to the ones extracted from the simulation. The relative error in the first and second moments is smaller than 7% and 15%, respectively, at all R, with the exception of v-2 which can differ up to 40%. In general, for negative moments the inversion methods have a bias towards larger values at R 20 kpc and smaller values at R 30 kpc. On the contrary, positive moments are somewhat under predicted at R 30kpc, while they on average agree with the simulation beyond that radius. However, it should be noted that at large radii the moments extracted from the simulation strongly fluctuate, which is most likely related to the presence of DM substructures. The other important observation is that the axisymmetric method tends to provide more accurate predictions only in the range of 2 kpc R 10 kpc. At first glance this is perhaps surprising, given the fact that according to the relative entropy metric the axisymmetric method performs better over the entire radial range. However, it should be noted that velocity moments are particularly sensitive to the tails of the velocity distribution, while for DKL the position of the peak is significantly more important. Similarly, due to the sensitivity to different tails of the speed distribution, the positive and negative moments exhibit different behaviours. In particular, the improvement provided by the axisymmetric method is much more significant for positive moments, as could be expected from our discussion of the shape of the speed distribution in the previous section.
Analogous results regarding the moments of speed distribution for Halo B and Halo C are shown in Figures 20 and 21 of Appendix C. From there it can be immediately observed that the predictions for these two simulations are less accurate and larger errors arise in the inner few kpc within the scope of Eddington method for Halo B and axisymmetric method for Halo C. These trends could have again been anticipated from our observations at the level of velocity distributions. At R 5 kpc the relative errors become much smaller and both of the inversion methods predict the velocity moments with accuracy better than 20%, up to the values of R where fluctuations due to DM substructure become significant. The general trends are similar to those of the Mochima simulation, namely the negative (positive) moments are over (under) predicted in the inner parts of the haloes and vice-versa in the outskirts. On the other hand, the improvement of the axisymmetric method over the Eddington inversion is less clear, as it depends on the particular halo and velocity moment that is being considered.
­ 16 ­

Figure 7. Values of the first two positive and negative moments of the speed distribution as a function of the radial distance along the galactic plane for the Mochima simulation. The left-hand side panels shows the values extracted directly from the simulation as well as the corresponding predictions of the inversion methods, while the right-hand side panels show the relative differences between the predictions and the true values.
4.3 Velocity anisotropy Finally, we turn our attention to the orbital anisotropy of the DM haloes. While this quantity is not directly observable and can lead to notable effects only in the scope of direct detection experiments, it is still interesting from the theoretical point of view. As briefly mentioned in Sec. 2.1, there exist anisotropic generalizations of the Eddington inversion method, in which orbital anisotropy has to be specified beforehand. However, as thoroughly investigated in [59], such models often lead to nonphysical solutions and, hence, we chose not to include them in our analysis. On the other hand, in the context of axisymmetric inversion method, the orbital anisotropy is a prediction of the model and is primarily determined by the total gravitational potential and DM density distribution ­ while in
­ 17 ­

principle the orbital anisotropy is also sensitive to the unobservable rotational velocity of the DM halo, it turns out that for realistic rotation velocities its contribution is negligible. To benchmark the agreement between the predictions of the inversion methods and the simulations, we address in the following the velocity anisotropy along the galactic plane, which can be defined as: 6

R^ (R)



1 2

-

2(R, z) 2M 2 (R, z)

z=0

(4.2)

where (R, z) and M(R, z) are the velocity dispersions along the azimuthal direction and meridional plane, respectively. This choice is motivated by the fact that the orbital anisotropy of axisymmetric
model is maximal along the galactic plane, while it vanishes along the z-axis. As a side note, by
recalling that the rotational properties of the halo are fully encoded in the Lz-odd part of the PSDF, defined in Eq. (2.7), it is easy to verify that the contribution of halo rotation to R^ enters only through 2 = v2 - v 2 and, hence, is suppressed by v¯2/ v2 .
In Fig. 8 we show the orbital anisotropy along the disc plane for the two inversion methods, as well
as R^(R) extracted from Mochima simulation. While in the Eddington case R^(R) = 0 by construction, the axisymmetric method agrees reasonably well with the simulation in the inner  10 kpc, where it
predicts increasing positive values of R^. However, in the outskirts the predicted anisotropy diminishes much faster than what is observed in the simulation. Since the baryonic disc becomes sub-dominant
beyond its scale length, the axisymmetric model slowly approaches the spherically symmetric, and
hence isotropic, configuration. On the other hand, within the simulation R^ keeps on growing up to  100 kpc, and only after that begins to decline. This implies that our models are not able to fully
capture the dynamical properties of the DM halo. In the case of the axisymmetric method it would
be possible to accommodate this trend by enforcing an oblate DM halo (i.e. by setting q > 1 in the
spheroidal generalization of the NFW density profile, mentioned in Sec. 3.2.2). However, during the
fitting procedure we have found no evidence for oblateness of the halo and hence we interpret this as
a hint that a more general approach, such as action-angle modelling, could be required to faithfully
reproduce the observed velocity anisotropy.

Figure 8. Velocity anisotropy along the galactic plane as a function of the radial distance obtained from the Mochima simulation and the corresponding predictions of the inversion methods.
In comparison with the Mochima simulation, the matching between the measured and predicted R^(R) is notably worse for Halo B and Halo C, as can be seen from the corresponding plots shown in Fig. 22 of Appendix C. While the predictions of the axisymmetric inversion method are similar to
6Note the difference in the definition with the respect the standard definition of velocity anisotropy, (r)  1 - T(r)/(2r(r)) where T(r) and r(r) are the tangential and radial velocity dispersions, which was conceived in the context of the spherically symmetric models. The two definitions coincide only within the galactic plane.
­ 18 ­

the case of Mochima, i.e. R^(R) rises in the inner part, peaks around the disc's scale length and then slowly falls towards zero, the orbital anisotropies obtained from the simulations show different trends.
In the case of Halo B, R^(R) is much lower than predicted by the axisymmetric model for R 20 kpc, while it sharply rises beyond that radius, peaks near 100 kpc and than rapidly declines. For Halo C the
orbital anisotropy grows more gradually, which is in somewhat better agreement with the prediction
of the axisymmetric method, but it does not seem to decrease significantly even beyond its peak at
R  100 kpc.

5 Implications for DM searches

One of the key motivations for developing accurate phase-space models for the distribution of DM within galaxies comes from numerous experimental searches for hypothetical particle candidates. In the past, efforts have been primarily focused on WIMPs [6­11], which can be efficiently searched for through probes that rely on vast quantities of DM within the Milky Way or other nearby galaxies. Such endeavours can be broadly categorised as direct and indirect searches, where the former aim to detect nuclear recoils due to the scattering of the Galactic DM with target atoms in highly sensitive laboratory experiments, while the latter focus on detecting emissions associated with DM annihilations (or decays) in nearby regions with high DM densities, such as the centres of the Milky Way or its satellite galaxies. Due to the absence of tangible signals, significant efforts have been put into diversifying the search strategies to probe a broader range of theoretically motivated DM candidates ­ to mention some, these include axion-like particles, non-thermally produced massive particles (e.g., super-WIMPs or FIMPs), various extensions of the Higgs sector or even primordial black holes (for a comprehensive review see, e.g., [91, 92]). Despite the staggering diversity of theoretical models, many of them can be strongly constrained by the existing direct and indirect detection experiments or other astrophysical probes, which likewise require accurate knowledge of the DM distribution within galaxies.
In the following we will explore the systematic uncertainties which arise in direct and indirect DM searches as a consequence of the modelling assumptions regarding the DM phase-space distribution. In particular, we focus on the so-called astrophysical factors that enter the interpretation of direct detection experiments, as well as the velocity boost factors that are needed for accurately predicting the velocity-dependent annihilation rates in indirect searches.

5.1 Direct detection
Direct detection (DD) experiments provide a unique probe for investigating possible interactions between dark and ordinary matter at low energies. By using large exposures of selected target materials they are capable of setting strong limits on the scattering rate of atomic nuclei of the Galactic DM particles. Due to their high sensitivities, it is crucial to have accurate predictions for the expected DM signals, but also robust methods of rejecting various backgrounds, which both require accurate models for the distribution of DM within the Milky Way. This will become even more important for the next-generation detectors, as they are excepted to become sensitive to new types of backgrounds, such as solar and atmospheric neutrinos, as well as observational signatures, e.g. directional distribution of the events. In order to correctly interpret their results, accurate models for the DM signatures ­ e.g., the energy spectrum, yearly variations or spatial distribution of the expected events, which all crucially depend on the local velocity distribution of DM ­ will become paramount.
For a DM candidate with a given differential DM-nucleus cross-section, d/dEr, the expected differential recoil rate per target nucleus can be computed as [12­14]:

dR 

=

·

dEr mAm

|v|>vmin

d3v

PLAB(v)

·

v

·

d dEr

with vmin =

mAEr 2µ2A

,

µA

=

mAm mA + m

,

(5.1)

­ 19 ­

where Er is the nuclear recoil energy, mA/ the target nucleus/DM mass,  the local DM density and PLAB(v) the local velocity distribution of DM particles in the detector's (LAB) frame. To perform the mapping from Galactic rest frame to the LAB frame one needs to correctly account for the local circular velocity, Sun's peculiar motion an Earth's circular velocity around the Sun. However, since in the simulations there is no clear analogue of the solar system, we simplify the mapping by accounting only for the dominant contribution which comes from the local circular velocity, vcirc(R ), assuming that the detector is located at solar galactocentric distance R = 8.1 kpc. 7 In this case, the LAB velocity distribution can be related to the DM speed distribution, P (v), as follows:

PLAB(v) = d3v P (v ) ·  v - |v - vcirc| .

(5.2)

On the other hand, in simulations we first select all DM particles that lie within a torus centred at (R, z) = (R , 0) with radius  = 0.5 kpc, which provides us with a sample of more than 5000 particles. Subsequently, we subtract vcirc from the individual particle velocities and obtain PLAB(v) by binning them according to their velocity magnitudes.
For spin-independent (SI) interactions obeying isospin symmetry, which correspond to coherent DM scattering with all the nucleons in the target atoms, the differential cross-section can be expressed as:

d dEr

=

mAnSI 2µ2Av2

A2F

2 (Er )

,

(5.3)

where nSI is the SI DM-nucleon cross-section at zero momentum transfer, A the mass number of the target nucleus and F (Er) a nuclear form factor. As can been seen from the above expression, the SI differential cross-section introduces an additional factor of v-2 within the integral of Eq. (5.1), which also appears in the case of spin-dependent (SD) interactions, however, this is not always true for more general scattering operators. Nonetheless, on can factorize Eq. (5.1) into a term determined by the specific particle physics model under consideration and an astrophysical factor, which is the convolution of the process's velocity dependence with the DM's velocity distribution. For SI and SD case the relevant integral takes the following form:

g(vmin) 

d3v PLAB(v) .

|v|>vmin

v

(5.4)

However, it is often desired to go beyond the simplest scattering operators, since there are many other ways in which DM can couple to the nucleons. In order to address the wide range of possibilities, a fully general set of non-relativistic effective scattering operators has been assembled ­ for their systematic treatment see [93­96]. For many phenomenologically interesting models the leading order contribution to the differential cross-section can be velocity independent, hence, it is useful to additionally define:

h(vmin) 

d3v PLAB(v) · v .

|v|>vmin

(5.5)

It turns out that the above functions, g(vmin) and h(vmin), cover the velocity dependencies of all possible non-relativistic effective scattering operators expanded up to the quadratic order in momentum transfer and relative velocity. Therefore, their accurate determination is of great importance for correctly interpreting the direct detection constraints on DM-nucleus interactions.
In Fig. 9 we present the comparison of the inversion methods' predictions and the corresponding true values of g(vmin) and h(vmin) obtained directly from the Mochima simulation. For g(vmin),
7The chosen value of R is to a large degree arbitrary since the stellar discs in simulations significantly differ in many respects from the one of the Milky Way. Therefore, no particular importance should be given to the absolute values of the astrophysical factors obtained in this work, but rather to the relative differences between the two theoretical predictions and the values extracted directly from the simulations.

­ 20 ­

displayed in the left-hand side plot, the predictions of axisymmetric method notably differ from the Eddington prediction at low vmin, which is a consequence of its significantly lower azimuthal velocity dispersion. Since the LAB is approximately moving with the local circular velocity in the azimuthal direction, one expects significantly less scatterings with vmin 100 km/s within the axisymmetric model. On the other hand, above vmin  100 km/s the trend is reversed (i.e. g(vmin) associated with axisymmetric model becomes larger), while for vmin 300 km/s the two models become virtually indistinguishable. By comparing the predictions of the inversion methods with the values extracted from the simulation one can immediately notice that the aforementioned trends of axisymmetric model are too extreme and g(vmin) is better approximated by the Eddington inversion. This is a consequence of the fact that the axisymmetric method tends to under-predict the velocity dispersion along the azimuthal direction at intermediate galactocentric distances, as previously noted in Sec. 4.1. However, this discrepancy is rather small and does not amount to relative errors grater than a few per cent. On the other hand, at vmin 300 km/s, where the inversion methods lead to nearly identical predictions, the relative differences with respect to the simulation can become significantly larger, reaching up to 50%. The later is most likely sourced by non-equilibrium features, such as DM substructures or debris flow, which also manifest themselves as a additional peaks in the velocity distributions at large v (see, e.g., the middle panel of Fig. 3). In the case of h(vmin) the differences between the axisymmetric and Eddington inversion are reversed ­ at small vmin the axisymmetric method leads to larger values of h(vmin), while the opposite is true at intermediate values of vmin. Since this astrophysical factor is more sensitive to the high-velocity tail of the PLAB(v), the axisymmetric method leads to slightly more accurate prediction at low vmin, however, the relative difference with respect to the Eddington inversion is below the per cent level. At large vmin the inversion methods again result in very similar values for h(vmin), while the relative difference with respect to the simulation grows up to  50% due to the same reason as in the case of g(vmin).

g(vmin) [(km/s)-1]

0.004 0.003 0.002 0.001 0.000
0.5 0.0
0

Simulation Axi. inversion Edd. inversion 100 200 300 400 500 600 700 vmin [km/s]

h(vmin) hsim(vmin)

-1

h(vmin) [km/s]

250

Simulation Axi. inversion

200

Edd. inversion

150

100

50

0

0.5

0.0

0 100 200 300 400 500 600 700 vmin [km/s]

-1

g(vmin) gsim(vmin)

Figure 9. Comparison of direct detection astrophysical factors extracted directly from the Mochima simulation with the corresponding predictions of the inversion methods. The lower pannels show the relative differences between predictions and the true values.
Similar trends can be observed in the case of Halo B and Halo C simulations, for which the analogous plots of astrophysical factors can be found in Fig. 23 and Fig. 24 of Appendix C. In both objects g(vmin) is more accurately predicted the Eddington inversion, while the axisymmetric method can lead to even larger relative errors than those observed in the case of Mochima. Furthermore, we generally find a better agreement between the predictions of the Eddington inversion and the simulations also for h(vmin). Both of this findings are most likely related to the fact that the Eddington approach tends to predict the individual components of velocity distribution more accurately around

­ 21 ­

R , as can be seen from Fig. 18 and Fig. 19. Similarly as in the case of Mochima, the relative errors in the predictions of the inversion methods are relatively small (below 15%) at low vmin, but can exceed 50% at large vmin.
The above results highlight several issues that hinder our ability to accurately determine the astrophysical factors which enter the interpretation of DD experiments. While the axisymmetric inversion method is generally expected to perform better in describing the DM velocity distribution in galaxies with massive baryonic discs, this is not necessary the case. In particular, the complex dynamics of galaxy formation can lead to significant deviations from the assumed axial symmetry, which in turn causes the axisymmetric method to be less accurate than the simpler Eddington inversion. Further errors in the predictions can also be sourced by the unaccounted rotation of the DM halo. On the other hand, our results show that both methods lead to relative errors smaller than 15% at low vmin, however, they can become significantly larger with increasing vmin. The latter is most likely related to the presence of numerous non-equilibrium structures which can not be accounted for within a framework based on dynamical equilibrium. As a consequence, this can source appreciable uncertainties in the scattering rate of light DM candidates or the high-energy part of the recoil energy spectrum.

5.2 Indirect detection
If DM particles can annihilate in SM states, which is generically true for thermal relic candidates, the associated emissions could be detected through various messengers, ranging from -rays, neutrinos to cosmic rays. Currently the dominant limits on most annihilation channels come from -ray observations of the galactic center [97­100] and dwarf satellite galaxies [101­108], however, important complementary bounds can be obtained from Cherenkov and neutrino telescopes ­ for a review on the topic see, e.g., [109­111].
The expected flux due to pair annihilation of DM into SM particles, for a given DM halo with a PSDF f (x, v) integrated over angular acceptance , is given by:

d 1 =
dE 8

annv 0 dN m2 dE

d d



l.o.s.

d3v1f (x, v1) d3v2 f (x, v2) S(|vrel|) ,

(5.6)

where the DM particle, , is assumed to be its own antiparticle (otherwise an extra factor of 1/2 is
needed), m is its mass and dN/dE the energy spectrum of the emitted radiation. The above formula is applicable to the general case in which the pair annihilation cross-section annv has a non-trivial dependence on the modulus of the relative velocity vrel = |v1-v2|, with v1 and v2 being the velocities of two annihilating particles, namely annv is factorised into the velocity independent term annv 0 and a dimensionless factor fully comprising its dependence on relative velocity, annv = annv 0 · S(vrel).
By isolating the astrophysical contribution in Eq. (5.6), one can define:

J  d d



l.o.s.

d3v1fDM(x, v1) d3v2 fDM(x, v2) S(vrel)

= d

d 2(x) S(vrel) (x) .



l.o.s.

(5.7)

This definition is in analogy to what is usually denoted in the literature as "J-factor", which is typi-
cally limited to the standard lore of s-wave annihilations, in which annv is velocity independent. In the latter case, the velocity boost factor can be omitted, i.e. S(vrel) = 1, and the J-factor simply depends on the DM density distribution along the line of sight, making the predictions of inversion
methods irrelevant. However, there exist several well-motivated DM models in which s-wave annihi-
lations are forbidden or severely suppressed, and hence p-wave becomes the dominant contribution to the annihilation cross-section [112­115], leading to S(vrel)  vr2el. Alternatively, non-perturbative effects due to long-range interactions in the non-relativistic limit, commonly known as Sommerfeld
enhancement, can introduce an additional velocity dependence, which can be in certain limiting cases
well approximated by inverse powers of vrel [116­119]. More precisely, under the assumption of the Yukawa coupling one finds S(vrel)  vr-e1l in the Coulomb regime (i.e. for vanishing mediator mass)

­ 22 ­

and as S(vrel)  vr-e2l in the resonant regime, which occurs for particular values of the associated particle physics parameters. This motivates us to consider four different power-law scalings, namely S(vrel)  vrnel for n  [-2, -1, 1, 2], corresponding to all possible combinations of the aforementioned velocity dependences.
In Fig. 10 we present our results for the four moments of the relative velocity as a function of the radial distance along the galactic plane for the Mochima simulation. In the left-hand side panel we show the values of vrnel extracted from the simulation, as well as the predictions of the axisymmetric and Eddington inversion methods, while in the right-hand side panel we show the corresponding relative differences between the predictions and the simulation. Not surprisingly, the accuracy of the predictions for vrnel is fairly similar to the one obtained for vn , presented in Sec. 4.2. The relative differences between the simulation and inversion methods are also in this case smaller than 7% (15%) for first (second) moments over the entire radial range, with the exception of vr-e2l at R 30 kpc. In the inner  30 kpc the inversion methods again systematically over predict the negative and under predict the positive moments, while at R 30 kpc we observe a smaller, O(10%), offset towards lower values only in the case of vr-e2l . The axisymmetric method tends to lead to more accurate predictions in the range 2 kpc R 10kpc. While at larger radii the difference between the two methods gradually diminishes, the innermost part of the galaxy again shows systematic under (over) prediction of negative (positive) velocity moments due to the miss-modelling of the central DM density slope.
Similar conclusions can be made for the moments of relative velocity distribution in Halo B and Halo C, for which the analogous plots are shown in Figures 25 and 26 of Appendix C. The key differences with respect to Mochima are the aforementioned discrepancies in the central parts of the haloes. In the case of Halo B, which has a significant mismatch between the centre of DM halo and barycentre, the axisymmetric method leads to significantly more accurate results than the Eddington inversion, while the opposite is true in the case of Halo C. Apart from the central mismatch of one of the methods, the typical relative errors amount to less than 10% over most of the radial range. Furthermore, we find that the negative (positive) moments tend to be over (under) predicted by the inversion methods, which agrees with our observations based on the Mochima simulation.
In conclusion, both inversion methods tend to provide fairly accurate estimates for the first two positive and negative moments of the relative velocity distribution. While the axisymmetric method performs notably better in Mochima and Halo B simulations, this is not necessarily true for all the objects, as seen in the case of Halo C. However, since the typical relative errors do not exceed  20%, apart from possible larger deviations in the case of vr-e2l , we expect that the main uncertainty in the indirect searches will continue to be sourced by the poorly determined DM density profiles of the observed galaxies. In particular, it turns out to be very difficult to properly constrain the central slope of the DM density profile which, however, crucially determines the strength of the expected annihilation signal, but can also noticeably affect the predictions of the inversion methods, as demonstrated on the example of single-particle velocity moments in the Appendix A.
­ 23 ­

Figure 10. Values of the first two positive and negative moments of the relative speed distribution as a function of the radial distance along the galactic plane for the Mochima simulation. The left-hand side panels shows the values extracted directly from the simulation as well as the corresponding predictions of the inversion methods, while the right-hand side panels show the relative differences between the predictions and the true values.
6 Summary and conclusions
In this work, we have compared the accuracy of Eddington and axisymmetric inversion methods in predicting the DM phase-space distribution within galaxies. The two methods most notably differ in the assumed level of symmetry, with the Eddington formulation being limited to spherically symmetric objects, which represent merely a subclass of systems allowed by the more general axisymmetric approach. The comparison was performed on high-resolution hydrodynamical simulations, which make it possible to adequately sample the DM distribution throughout the DM halo. Since the DM density profile serves as an input quantity for the inversions, we focused our attention on the velocity distribu-
­ 24 ­

tions, which fully characterize the corresponding predictions for the phase-space distribution. In the following, we summarize the main results of this work.
Fits of the baryonic gravitational potential and the DM density distribution We began our analysis by fitting simple parametric functions for the key input quantities of the inversion methods to the simulations. For the baryonic gravitational potential, we adopted a minimalistic model that was composed of a Hernquist bulge and a single Miyamoto-Nagai disc, which nonetheless resulted in good fits with typical relative errors below 10%. On the other hand, regarding the DM density distribution, several comments are in place. Most importantly, to avoid the need of computing the corresponding gravitational potential numerically and circumvent possible non-physical solutions of the axisymmetric method, we decided to adopt the two-parameter NFW and Burkert density profiles. The latter provided a good fit to the enclosed DM mass in the case of Halo B and Halo C, leading to residuals at the level of 10%. Conversely, the NFW profile turned out to be a better choice for the Mochima simulation, however, resulted in residuals below 10% only beyond the inner 5 kpc due to a particularly steep central cusp. This could be improved by allowing for more general DM density profile, e.g. the Zhao parametrization. However, as demonstrated in Appendix A, this has only a few per cent impact on the resulting moments of DM velocity distribution and becomes negligible beyond the inner  2 kpc. Finally, it has to be noted that the high-resolution simulations contain significant amount of resolved DM substructures, which can not be captured by the standard parametric functions used for approximating the DM density distribution.
Velocity distribution After obtaining satisfying fits for the DM density profile and the baryonic potential gravitational, we were able to compute the corresponding PSDFs and compare their predictions with the simulations. Firstly, we provided a qualitative comparison by inspecting the probability density functions for velocity magnitude, meridional velocity and azimuthal velocity at distinctive radial distances along the galactic plane. For two out of three analysed objects, our results show that the axisymmetric method can lead to more accurate predictions for the speed distribution, particularly in the inner part of the galaxy, where the baryonic disc has a strong impact on the dynamics. The improvements manifest themselves as more accurate predictions for the peak as well as the general shape of the speed distribution. On the other hand, for Halo C the Eddington inversion method performed better, especially in the innermost few kpc. As the main reason for the failure of the axisymmetric approach, we identify the misalignment between the angular momentum of DM halo and the principal axis defined by the baryonic disc. Due to the same reason, the axisymmetric method does not always perform better in predicting the individual (meridional and azimuthal) components of the velocity distribution, which can be, however, mitigated by choosing a principal axis parallel to the halo's net angular momentum. Secondly, to quantify the match between the predicted velocity distributions with the ones inferred from the simulations over the entire radial range, we adopted the relative entropy metric. This confirmed our qualitative findings, clearly showing that the axisymmetric method leads to more accurate predictions for the speed distribution in two of the analysed simulations at all radii (with exception of few local fluctuations), while Eddington inversion performed notably better in the central part of Halo C. For the meridional and azimuthal velocity distributions, we observed significant variations in the accuracy within different simulations, which mainly stem from the aforementioned misalignment between the symmetry axes of DM and baryons. If the principal axis of the system was chosen perpendicular to the galactic disc, the predictions of the Eddington inversion often outperformed those of the axisymmetric method. On the other hand, if the principal axis was aligned with the angular momentum vector of the DM halo, the axisymmetric method generally leads to slightly more accurate predictions. As a final note, in the outskirts of all the analysed DM haloes we observed gradual degradation of the performance for both of the inversion methods due to an increasing amount of DM substructures and/or tidal debris.
Moments of velocity distribution Subsequently, we turned our attention to the first two positive and negative moments of the speed distributions, which are (unlike the relative entropy) particularly sensitive to the tails of the distribution. For the velocity moments, we find notably better agreement
­ 25 ­

between the predictions of the axisymmetric method and the Mochima simulation at 2 kpc R 10 kpc, where the impact of the baryonic disc is significant. However, it is important to note that in this radial range both inversion methods generically over predict the negative and underpredict the positive velocity moments by O(10%), which was observed in all the studied objects. At larger R the differences between inversion methods diminish, while the velocity moments extracted from the simulations become significantly noisier due to the presence of numerous DM substructures, which drastically worsens the agreement with the predictions. In the innermost part of the DM halo of Mochima simulation, our predictions tend to degrade due to the aforementioned mismatch in the DM density slope. On the other hand, in the case of Halo B (Halo C) we find very good agreement between the predictions of the axisymmetric (Eddington) method with the true velocity moments down to the very centre ­ the better performance of Eddington inversion within Halo C is mostly driven by a large, i.e. 53, misalignment of the DM halo's angular momentum with respect to the galactic disc, while in Halo B the axisymmetric method performs significantly better due to the presence of a prominent baryonic disc. In conclusion, both inversion methods (with the aforementioned exceptions in central parts of Halo B and Halo C) lead to fairly accurate predictions for the velocity moments over the majority of the explored radial range, with typical relative errors well below 20%.
Velocity anisotropy Another interesting comparison, which is made possible by the high-resolution simulations, can be performed by examining the orbital anisotropy of DM. While in the case of Eddington inversion the resulting phase-space distribution is isotropic by construction (or the anisotropy profile has to be specified beforehand in its anisotropic generalizations), the axisymmetric method provides us with a prediction for the orbital anisotropy from a given density-potential pair. By comparing the anisotropy along the galactic plane, we found that the axisymmetric method correctly predicts radially biased orbits (i.e. R^ > 0), however, quantitative agreement becomes poor at large galactocentric distances. In particular, the axisymmetric method leads to an orbital anisotropy profile which peaks around the disc scale length, while in simulations we find gradually increasing R^(R) up to R  100 kpc. The magnitude of the anisotropy approximately agrees with the prediction for the Mochima simulation at R 10 kpc, while at larger radii the true values are substantially above the predicted ones. The agreement is even worse for Halo B and Halo C, where the axisymmetric inversion method overshoots the true values in the inner parts of the haloes and under predicts the anisotropy in the outskirts.
Implications for direct and indirect searches As a final comparison, we have contrasted the predictions of inversion methods to the true values of astrophysical factors that are needed for interpreting the results of direct and indirect DM searches. In the context of direct detection, our results show that both inversion methods perform reasonably well, with the typical relative errors in the astrophysical factors below 15% for vmin 300 km/s. The axisymmetric method often performs worse than the Eddington inversion due to the aforementioned difficulties in predicting individual components of velocity distributions. On the other hand, at large vmin the differences between the predictions of the two inversion methods become smaller than the typical relative errors with respect to the true values, as the latter can surge up to 50%. The reason for this is most likely the presence of non-equilibrium structures within the DM halo, which can not be captured by the models based on dynamical equilibrium. In the context of indirect searches, we find that both inversion methods provide relatively robust predictions for the moments of the relative velocity distribution that enter the predictions for velocity-dependent DM annihilations. Similarly to the single-particle velocity moments, the typical relative errors are below 20% over most of the studied radial range. While the axisymmetric method performs better in the case of Mochima and Halo B simulations, the opposite in true for Halo C. Finally, we note that the differences between inversion methods, as well as residuals with respect to the simulations, are relatively small compared to the typical uncertainties associated with the observational determinations of the DM density profiles.
In conclusion, the inversion methods provide us with an indispensable tool for reconstructing the phase-space distribution of the galactic DM. Both, the Eddington inversion and its axisymmet-
­ 26 ­

ric generalization, allow us to accurately predict the DM velocity distribution over a broad range of galactocentric distances, as well as the corresponding astrophysical factors that needed for the interpretation of various DM searches. The axisymmetric approach generally leads to more accurate results, especially in the central parts of galaxies with massive baryonic discs. On the other hand, it is subject to additional systematic errors due to the assumptions related to the principal axis of the system as well as rotational properties of the DM halo. While the latter is most cases negligible, substantial misalignment between the principal axis of DM halo and the baryonic disc can spoil the predictions of the axisymmetric method and more accurate results are obtained through the simpler Eddington inversion. A further source of inaccuracy, common to both of the inversion methods, is the assumption that all of the galactic DM is smoothly distributed and has reached dynamical equilibrium. This is in stark contrast with the results of simulations, which predict a large amount of DM substructure that becomes increasingly prominent with the distance from the galactic centre. Nonetheless, the inversion methods manage to predict the moments of DM velocity distribution, which are of prime interest for DM searches, with typical relative errors well below 20%.
An interesting question, which we leave open for future work, is how the inversion methods compare to more general approaches of constructing DM distribution functions, such as action-angle modelling, where the restraining symmetry assumptions can be further relaxed. This could, for example, allow for misaligned principal axes of different galactic components, enable the use of more realistic triaxial description of the central bulge/bar regions of the galaxies or accommodate the large radial anisotropies of the DM particles in the outskirts of the halos, as predicted by the simulations. On the other hand, we expect that more flexible models could give rise to further systematic errors due to the additional degrees of freedom that can not be constrained through the existing observations. Beyond the scope of equilibrium models, there is also a pressing need for improvements in stochastic modelling of possible local and/or global non-equilibrium DM components, which can substantially affect the interpretation of DM searches. The development of such corrections for the equilibrium models most likely requires further theoretical work as well as novel insights provided by the high-resolution simulations of galaxy formation and evolution.
Acknowledgments
We thank Thomas Lacroix, Benoit Famaey and other members of the GaDaMa initiative for stimulating discussions during the preparation of this work. Centre de Calcul Intensif d'Aix-Marseille is acknowledged for granting access to its high performance computing resources. The authors acknowledge partial support from the ANR project ANR-18-CE31-0006. This project has been partly supported by the European Union's Horizon 2020 research and innovation program under the Marie Sklodowska -Curie grant agreement No 860881-HIDDeN. It has also benefited from funding from the CNRS-INSU programs PNHE and PNCG.
Appendix A Dependence of the DM velocity moments on the assumptions regarding the DM density profile
In our work we have adopted a simplifying assumption that the DM density profiles of simulated objects can be adequately approximated either by NFW [87] or Burkert [88] density profile. On the other hand, Lacroix et al. [37] performed the analysis of the same simulations using a more flexible Zhao parametrization [89]. Even though the latter provides a somewhat better fit to the actual DM distribution found within the simulations, it does not have a significant impact on the moments of the velocity distribution of DM, which are of the prime interest for DM search. In Fig. 11 we show the comparison of DM velocity moments obtained in this work with those of Lacroix et al. for the Mochima simulation. As can be seen from the plots, the more flexible parametrization provides better agreement with the true velocity moments in the very central parts of the halo, since it correctly accounts for the particularly steep central cusp ­ Lacroix et al. report that their best fit value for the central DM density slope is  = 1.718, while the NFW parametrization implicitly assumes  = 1. On the other,
­ 27 ­

it is surprising to see that our results become more accurate at R 2 kpc. This is perhaps related to the fact that the two analyses also differ in the parametrization of the baryonic gravitational potential. At even larger galactocentric distances, i.e. R 10 kpc, the predictions of the Eddington inversion method in both works become nearly identical.
Figure 11. Same as in Fig. 7, but additionally showing the results of Lacroix et al. [37], who performed the Eddington inversion using a more accurate fit of the DM density distribution by adopting the Zhao profile as well as a more flexible approach of approximating the baryonic gravitational potential.
Appendix B Systematic uncertainties associated with the choice of principal axis
To address the issue of misalignment between the principal axes of DM and baryons we repeat the analysis of Mochima simulation under the assumption that the z-axis coincides with the net angular momentum of the DM halo. The latter differs by 21 from the normal vector defined by the galactic plane, which was used as the principal axis in the main text. This naturally leads to slightly different best-fit parameters for the baryonic gravitational potential, while the parameters of the DM density profile remain essentially unchanged since the halo is nearly spherical. On the other hand, the velocity distributions extracted from the simulations are noticeably different, particularly in the case of meridional and azimuthal components as their definitions clearly depend on the choice of the coordi-
­ 28 ­

nate system. In Fig. 12 we show the corresponding speed distribution, as well as the meridional and azimuthal velocity distributions, at three distinctive galactocentric radii. The solid lines correspond to the principal axis aligned with the angular momentum vector of the DM halo, while the dashed lines show the results obtained when z-axis was chosen perpendicular to the galactic disc. As can be seen from the plots, at R = 3 kpc this leads to a better agreement of the axisymmetric method's predictions with the true values of the meridional and azimuthal velocity distribution, while the speed distribution is less affected by the change of principal axis. As a further comparison, we show in Fig. 13 the corresponding values of DKL, as defined by Eq. (4.1). The axisymmetric method can be seen to outperform the Eddington inversion over most of the radial range, with the exception of few local fluctuations. In comparison with the case where the principal axis was chosen perpendicular to the galactic plane, the improvement is particularly significant for the meridional and azimuthal velocity distributions, while some improvement can also be seen in predictions for the speed distribution at small R.

P(v) [(km/s)-1]

0.005 0.004 0.003 0.002 0.001 0.000 0
0.005 0.004 0.003 0.002 0.001 0.000 0
0.004 0.003

R = 3 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

0

v [km/s]

R = 3 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

0

vM [km/s]

R = 3 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

R = 9 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

0

v [km/s]

R = 9 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

0

vM [km/s]

R = 9 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

R = 26 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

v [km/s]

R = 26 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

200

400

600

vM [km/s]

R = 26 kpc, z = 0

Axi. inversion (z^ Axi. inversion (z^

LdDisMc))

Edd. inversion (z^ Edd. inversion (z^

LdDisMc))

Simulation (z^ Simulation (z^

LdDisMc))

PM(vM) [(km/s)-1]

P(v) [(km/s)-1]

0.002

0.001

0.000 600 400 200 0 200 400 600 800 600 400 200 0 200 400 600 800 600 400 200 0 200 400 600 800

v [km/s]

v [km/s]

v [km/s]

Figure 12. Speed distribution (top row), meridional velocity distribution (middle row) and azimuthal velocity distribution (bottom row) for Mochima simulation. The results are shown for the two different choices of z-axis alignment, i.e. parallel to the DM angular momentum (LDM) and perpendicular to the baryonic disc.

­ 29 ­

Figure 13. Relative entropy between the true velocity distributions and the predictions of axiymmetric and Eddington inversion methods as a function of the radial distance for Mochima simulation. The results are shown for the two different choices of z-axis alignment, i.e. parallel to the DM angular momentum (LDM) and perpendicular to the baryonic disc.
Appendix C Results for Halo B and Halo C
C.1 Baryonic gravitational potential
Figure 14. Relative difference between our best-fit and the azimuthally-averaged baryonic gravitational potential for Halo B (left-hand side panel) and Halo C (right-hand side panel) simulations.
­ 30 ­

C.2 Mass profiles Figure 15. The best-fit DM mass profiles for Halo B (left-hand side panel) and Halo C (right-hand side panel) simulations, obtained under the assumption of Burkert parametrization.
­ 31 ­

C.3 Velocity distributions

P(v) [(km/s)-1]

PM(vM) [(km/s)-1]

R = 3 kpc, z = 0

Axi. inversion

0.005

Edd. inversion

Simulation

0.004

0.003

0.002

0.001

0.000 0 100 200 300 400 500 600 v [km/s]

R = 3 kpc, z = 0

Axi. inversion

0.005

Edd. inversion

Simulation

0.004

0.003

0.002

0.001

0.000 0 100 200 300 400 500 600 vM [km/s]

0.0040 0.0035 0.0030 0.0025 0.0020 0.0015 0.0010 0.0005 0.0000

R = 3 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 v [km/s]
R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 vM [km/s]
R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 v [km/s]
R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 vM [km/s]
R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

P(v) [(km/s)-1]

Figure 16. Speed distribution (top row), meridional velocity distribution (middle row) and azimuthal velocity distribution (bottom row) for Halo B simulation at three distinctive galactocentric distances along the disc.

­ 32 ­

P(v) [(km/s)-1]

PM(vM) [(km/s)-1]

R = 3 kpc, z = 0

0.005

Axi. inversion Edd. inversion

Simulation

0.004

0.003

0.002

0.001

0.000 0 100 200 300 400 500 600 700 v [km/s]

R = 3 kpc, z = 0

0.005

Axi. inversion Edd. inversion

Simulation

0.004

0.003

0.002

0.001

0.000 0 100 200 300 400 500 600 700 vM [km/s]

0.0040 0.0035 0.0030 0.0025 0.0020 0.0015 0.0010 0.0005 0.0000

R = 3 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 700 v [km/s]
R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 700 vM [km/s]
R = 9 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 700 v [km/s]
R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
0 100 200 300 400 500 600 700 vM [km/s]
R = 26 kpc, z = 0
Axi. inversion Edd. inversion Simulation
600 400 200 0 200 400 600 v [km/s]

P(v) [(km/s)-1]

Figure 17. Speed distribution (top row), meridional velocity distribution (middle row) and azimuthal velocity distribution (bottom row) for Halo C simulation at three distinctive galactocentric distances along the disc.

­ 33 ­

DKL

0.25 0.20 0.15 0.10 0.05 0.00
100

Speed distribution
Axi. inversion Edd. inversion

101

102

R [kpc]

Meridional velocity distribution
Axi. inversion Edd. inversion

Azimuthal velocity distribution
Axi. inversion Edd. inversion

100

101

102

100

101

102

R [kpc]

R [kpc]

Figure 18. Same as in Fig. 6, but for Halo B simulation.

Speed distribution

Axi. inversion

0.8

Edd. inversion

0.6

0.4

0.2

0.0 100

101

102

R [kpc]

Meridional velocity distribution
Axi. inversion Edd. inversion

Azimuthal velocity distribution
Axi. inversion Edd. inversion

100

101

102

100

101

102

R [kpc]

R [kpc]

Figure 19. Same as in Fig. 6, but for Halo C simulation.

DKL

­ 34 ­

C.4 Velocity moments

v-2 [(km / s)-2]

v-1 [(km / s)-1]

0.0003 0.0002

Simulation Axi. inversion Edd. inversion

0.0001

0.0000

100

101

0.012

Simulation Axi. inversion

0.010

Edd. inversion

0.008

0.006

0.004

100

101

350

300

250

200

150

100

100

101

140000 120000 100000 80000 60000 40000 20000

100

101

R [kpc]

102
102 Simulation Axi. inversion Edd. inversion
102 Simulation Axi. inversion Edd. inversion
102

v2 / v2 sim - 1

v1 / v1 sim - 1

v-1 / v-1 sim - 1

v-2 / v-2 sim - 1

1.0 0.5 0.0

100

101

0.3

0.2

0.1

0.0

0.1

100

101

0.05

Axi. inversion

0.00

Edd. inversion

0.05

0.10

0.15

100

101

0.0 0.1 0.2
100

101 R [kpc]

Axi. inversion Edd. inversion
102 Axi. inversion Edd. inversion
102
102
Axi. inversion Edd. inversion
102

v1 [km / s]

v2 [km2 / s2]

Figure 20. Same as in Fig. 7, but for Halo B simulation.

­ 35 ­

v-2

v-1

0.00025 0.00020 0.00015 0.00010 0.00005 0.00000
100

Simulation Axi. inversion Edd. inversion
101

0.012 0.010 0.008 0.006 0.004 0.002
100

Simulation Axi. inversion Edd. inversion
101

400

300

v1

200

100

100

101

200000

150000

100000

50000

100

101

R [kpc]

102
102 Simulation Axi. inversion Edd. inversion
102 Simulation Axi. inversion Edd. inversion
102

v2 / v2 sim - 1

v1 / v1 sim - 1

v-1 / v-1 sim - 1

v-2 / v-2 sim - 1

0.1 0.0 0.1 0.2 0.3 0.4 0.5
100
0.05 0.00 0.05 0.10 0.15 0.20
100
0.10 0.05 0.00 0.05 0.10 0.15
100
0.2 0.1 0.0 0.1 0.2 0.3
100

Axi. inversion Edd. inversion

101

102

Axi. inversion Edd. inversion

101

102

Axi. inversion Edd. inversion

101

102

Axi. inversion Edd. inversion

101

102

R [kpc]

Figure 21. Same as in Fig. 7, but for Halo C simulation.

v2

­ 36 ­

C.5 Velocity anisotropy

 ^R

0.14

Simulation

0.12

AXi. inversion Edd. inversion

0.10

0.08

0.06

0.04

0.02

0.00

100

101

102

R [kpc]

 ^R

0.150

Simulation AXi. inversion

0.125

Edd. inversion

0.100

0.075

0.050

0.025

0.000

100

101

102

R [kpc]

Figure 22. Same as in Fig. 8, but for Halo B simulation in the left-hand side panel and Halo C simulation in the right-hand side panel.

C.6 DM searches

g(vmin) [(km/s)-1]

Simulation

0.003

Axi. inversion Edd. inversion

0.002

0.001

0.000
0.0 0.5
0

100 200 300 400 500 600 700 vmin [km/s]

h(vmin) hsim(vmin)

-1

h(vmin) [km/s]

350

Simulation

300

Axi. inversion

250

Edd. inversion

200

150

100

50

0

0.0

0.5

0 100 200 300 400 500 600 700 vmin [km/s]

-1

g(vmin) gsim(vmin)

Figure 23. Same as in Fig. 9, but for Halo B simulation.

g(vmin) [(km/s)-1]

0.0035 0.0030 0.0025 0.0020 0.0015 0.0010 0.0005 0.0000
0.0
0.5
0

Simulation Axi. inversion Edd. inversion 100 200 300 400 500 600 700 vmin [km/s]

h(vmin) hsim(vmin)

-1

h(vmin) [km/s]

Simulation

300

Axi. inversion Edd. inversion

200

100

0 0.0 0.5
0 100 200 300 400 500 600 700 vmin [km/s]

Figure 24. Same as in Fig. 9, but for Halo C simulation.

-1

g(vmin) gsim(vmin)

­ 37 ­

vre-l2 [(km / s)-2]

vre-l1 [(km / s)-1]

0.00020 0.00015 0.00010 0.00005

Simulation Axi. inversion Edd. inversion

100

101

Simulation

0.008

Axi. inversion Edd. inversion

0.006

0.004

100

101

vr1el [km / s]

400
300
200
100
250000 200000 150000 100000 50000
100

101 101 R [kpc]

102
102 Simulation Axi. inversion Edd. inversion
102 Simulation Axi. inversion Edd. inversion
102

vr2el / vr2el sim - 1

vr1el / vr1el sim - 1

vre-l1 / vre-l1 sim - 1

vre-l2 / vre-l2 sim - 1

0.4

0.2

0.0

0.2

100

101

0.20

0.15

0.10

0.05

0.00

0.05

0.10

100

101

0.05

Axi. inversion

0.00

Edd. inversion

0.05

0.10

0.15

100

101

Axi. inversion Edd. inversion
102 Axi. inversion Edd. inversion
102
102

0.0 0.1 0.2
100

101 R [kpc]

Axi. inversion Edd. inversion
102

Figure 25. Same as in Fig. 10, but for Halo B simulation.

vr2el [km2 / s2]

­ 38 ­

vre-l2 vre-l1

0.000125 0.000100 0.000075 0.000050 0.000025

Simulation Axi inversion Eddington inversion

100

101

Simulation

0.008

Axi inversion Eddington inversion

0.006

0.004

0.002

100

101

600

500

400

300

200

vr1el

100

101

400000

300000

200000

100000

102
102 Simulation Axi inversion Eddington inversion
102 Simulation Axi inversion Eddington inversion

100

101

102

R [kpc]

vr2el / vr2el sim - 1

vr1el / vr1el sim - 1

vre-l1 / vre-l1 sim - 1

vre-l2 / vre-l2 sim - 1

0.1

0.0

0.1

0.2

Axi inversion Eddington inversion

100

101

102

0.10

Axi inversion Eddington inversion

0.05

0.00

0.05

0.10 100

101

102

0.10 0.05 0.00 0.05 0.10 0.15
100

Axi inversion Eddington inversion

101

102

0.2 0.1 0.0 0.1 0.2 0.3
100

Axi inversion Eddington inversion

101

102

R [kpc]

vr2el

Figure 26. Same as in Fig. 10, but for Halo C simulation.
References
[1] I.B. Zeldovich and I.D. Novikov, Structure and evolution of the universe., Moscow, Izdatel'stvo Nauka (1975).
[2] B.W. Lee and S. Weinberg, Cosmological lower bound on heavy-neutrino masses, Phys. Rev. Lett. 39 (1977) 165.
[3] J.E. Gunn, B.W. Lee, I. Lerche, D.N. Schramm and G. Steigman, Some astrophysical consequences of the existence of a heavy stable neutral lepton., ApJ 223 (1978) 1015.
[4] A.D. Dolgov and Y.B. Zeldovich, Cosmology and elementary particles, Reviews of Modern Physics 53 (1981) 1.
[5] P. Binétruy, G. Girardi and P. Salati, Cosmological constraints on unstable heavy neutrinos, Physics Letters B 134 (1984) 174.

­ 39 ­

[6] M. Srednicki, R. Watkins and K.A. Olive, Calculations of relic densities in the early universe, Nuclear Physics B 310 (1988) 693.
[7] G. Steigman, B. Dasgupta and J.F. Beacom, Precise relic WIMP abundance and its impact on searches for dark matter annihilation, Phys. Rev. D 86 (2012) 023506 [1204.3622].
[8] J.R. Primack, D. Seckel and B. Sadoulet, Detection of cosmic dark matter, Annual Review of Nuclear and Particle Science 38 (1988) 751.
[9] G. Jungman, M. Kamionkowski and K. Griest, Supersymmetric dark matter, Physics Reports 267 (1996) 195.
[10] G. Arcadi, M. Dutra, P. Ghosh, M. Lindner, Y. Mambrini, M. Pierre et al., The waning of the WIMP? A review of models, searches, and constraints, Eur. Phys. J. C 78 (2018) 203 [1703.07364].
[11] R.K. Leane, T.R. Slatyer, J.F. Beacom and K.C.Y. Ng, GeV-scale thermal WIMPs: Not even slightly ruled out, Phys. Rev. D 98 (2018) 023016 [1805.10305].
[12] M.W. Goodman and E. Witten, Detectability of certain dark-matter candidates, Physical Review D 31 (1985) 3059.
[13] A.K. Drukier, K. Freese and D.N. Spergel, Detecting cold dark-matter candidates, Phys. Rev. D 33 (1986) 3495.
[14] K. Freese, M. Lisanti and C. Savage, Colloquium: Annual modulation of dark matter, Reviews of Modern Physics 85 (2013) 1561 [1209.3339].
[15] W.H. Press and D.N. Spergel, Capture by the sun of a galactic population of weakly interacting massive particles, ApJ 296 (1985) 679.
[16] L.M. Krauss, K. Freese, D.N. Spergel and W.H. Press, Cold dark matter candidates and the solar neutrino problem, ApJ 299 (1985) 1001.
[17] P. Salati and J. Silk, A stellar probe of dark matter annihilation in galactic nuclei, ApJ 338 (1989) 24.
[18] J. Lopes, T. Lacroix and I. Lopes, Towards a more rigorous treatment of uncertainties on the velocity distribution of dark matter particles for capture in stars, Journal of Cosmology and Astroparticle Physics 2021 (2021) 073 [2007.15927].
[19] L. Bergström, Non-baryonic dark matter: observational evidence and detection methods, Reports on Progress in Physics 63 (2000) 793 [hep-ph/0002126].
[20] T. Bringmann and C. Weniger, Gamma ray signals from dark matter: Concepts, status and prospects, Physics of the Dark Universe 1 (2012) 194 [1208.5481].
[21] J. Lavalle and P. Salati, Dark matter indirect signatures, Comptes Rendus Physique 13 (2012) 740 [1205.1004].
[22] P. McDonald, R.J. Scherrer and T.P. Walker, Cosmic microwave background constraint on residual annihilations of relic particles, Phys. Rev. D 63 (2001) 023001 [astro-ph/0008134].
[23] R. Essig, E. Kuflik, S.D. McDermott, T. Volansky and K.M. Zurek, Constraining light dark matter with diffuse X-ray and gamma-ray observations, Journal of High Energy Physics 11 (2013) 193 [1309.4091].
[24] K.K. Boddy, J. Kumar and L.E. Strigari, The effective j-factor of the galactic center for velocity-dependent dark matter annihilation, Phys. Rev. D 98 (2018) 063012 [1805.08379].
[25] M. Boudaud, T. Lacroix, M. Stref and J. Lavalle, Robust cosmic-ray constraints on p-wave annihilating mev dark matter, Phys. Rev. D 99 (2019) 061302 [1810.01680].
[26] H. Liu, W. Qin, G.W. Ridgway and T.R. Slatyer, Lyman- constraints on cosmic heating from dark matter annihilation and decay, arXiv e-prints (2020) arXiv:2008.01084 [2008.01084].
[27] J. Hisano, S. Matsumoto and M.M. Nojiri, Explosive Dark Matter Annihilation, Phys. Rev. Lett. 92 (2004) 031303 [hep-ph/0307216].
[28] J. Hisano, S. Matsumoto, M.M. Nojiri and O. Saito, Nonperturbative effect on dark matter annihilation and gamma ray signature from the galactic center, Phys. Rev. D 71 (2005) 063528 [hep-ph/0412403].
[29] B. Paczynski, Gravitational microlensing by the galactic halo, ApJ 304 (1986) 1.
[30] K. Griest, Galactic microlensing as a method of detecting massive compact halo objects, ApJ 366 (1991) 412.
­ 40 ­

[31] A.M. Green, Astrophysical uncertainties on the local dark matter distribution and direct detection experiments, Journal of Physics G: Nuclear and Particle Physics 44 (2017) 084001.
[32] M. Lisanti and D.N. Spergel, Dark matter debris flows in the Milky Way, Physics of the Dark Universe 1 (2012) 155 [1105.4166].
[33] J. Herzog-Arbeitman, M. Lisanti, P. Madau and L. Necib, Empirical determination of dark matter velocities using metal-poor stars, Phys. Rev. Lett. 120 (2018) 041102 [1704.04499].
[34] J. Binney and S. Tremaine, Galactic Dynamics: Second Edition, Princeton University Press (2008).
[35] A.M. Green, Effect of realistic astrophysical inputs on the phase and shape of the weakly interacting massive particles annual modulation signal, Phys. Rev. D 68 (2003) 023004 [astro-ph/0304446].
[36] M. Vogelsberger, S.D.M. White, A. Helmi and V. Springel, The fine-grained phase-space structure of cold dark matter haloes, Monthly Notices of the Royal Astronomical Society 385 (2008) 236 [0711.1105].
[37] T. Lacroix, A. Núñez-Castiñeyra, M. Stref, J. Lavalle and E. Nezri, Predicting the dark matter velocity distribution in galactic structures: tests against hydrodynamic cosmological simulations, arXiv:2005.03955 [astro-ph, physics:hep-ph] (2020) .
[38] F.-S. Ling, E. Nezri, E. Athanassoula and R. Teyssier, Dark matter direct detection signals inferred from a cosmological N-body simulation with baryons, Journal of Cosmology and Astroparticle Physics 2 (2010) 12 [0909.2028].
[39] N. Bozorgnia, F. Calore, M. Schaller, M. Lovell, G. Bertone, C.S. Frenk et al., Simulated Milky Way analogues: implications for dark matter direct searches, Journal of Cosmology and Astroparticle Physics 5 (2016) 024 [1601.04707].
[40] L.E. Strigari, Galactic searches for dark matter, Phys. Rep. 531 (2013) 1 [1211.7090].
[41] The Gaia Collaboration, T. Prusti, J.H.J. de Bruijne, A.G.A. Brown, A. Vallenari, C. Babusiaux et al., The Gaia mission, A&A 595 (2016) A1 [1609.04153].
[42] Gaia Collaboration, A.G.A. Brown, A. Vallenari, T. Prusti, J.H.J. de Bruijne, F. Mignard et al., Gaia data release 1. summary of the astrometric, photometric, and survey properties, A&A 595 (2016) A2 [1609.04172].
[43] Gaia Collaboration collaboration, Gaia data release 2. summary of the contents and survey properties, A&A 616 (2018) A1 [1804.09365].
[44] Gaia Collaboration, A.G.A. Brown, A. Vallenari, T. Prusti, J.H.J. de Bruijne, C. Babusiaux et al., Gaia early data release 3: Summary of the contents and survey properties, arXiv e-prints (2020) arXiv:2012.01533 [2012.01533].
[45] R. Catena and P. Ullio, A novel determination of the local dark matter density, Journal of Cosmology and Astroparticle Physics 8 (2010) 4 [0907.0018].
[46] P.J. McMillan, Mass models of the Milky Way, Monthly Notices of the Royal Astronomical Society 414 (2011) 2446 [1102.4340].
[47] R. Catena and P. Ullio, The local dark matter phase-space density and impact on WIMP direct detection, Journal of Cosmology and Astroparticle Physics 5 (2012) 5 [1111.3556].
[48] J.I. Read, The local dark matter density, Journal of Physics G Nuclear Physics 41 (2014) 063101 [1404.1938].
[49] T. Piffl, J. Binney, P.J. McMillan, M. Steinmetz, A. Helmi, R.F.G. Wyse et al., Constraining the Galaxy's dark halo with RAVE stars, Monthly Notices of the Royal Astronomical Society 445 (2014) 3133 [1406.4130].
[50] M. Fornasa and A.M. Green, Self-consistent phase-space distribution function for the anisotropic dark matter halo of the MilkyÂ Way, Phys. Rev. D 89 (2014) 063531 [1311.5477].
[51] P.J. McMillan, The mass distribution and gravitational potential of the Milky Way, Monthly Notices of the Royal Astronomical Society 465 (2017) 76 [1608.00971].
[52] M. Cautun, A. Benítez-Llambay, A.J. Deason, C.S. Frenk, A. Fattahi, F.A. Gómez et al., The milky way total mass profile as inferred from gaia dr2, Monthly Notices of the Royal Astronomical Society 494 (2020) 4291 [1911.04557].
­ 41 ­

[53] M. Petac, Equilibrium axisymmetric halo model for the Milky Way and its implications for direct and indirect dark matter searches, Phys. Rev. D 102 (2020) 123028 [2008.11172].
[54] A.S. Eddington, The Distribution of Stars in Globular Clusters, Monthly Notices of the Royal Astronomical Society 76 (1916) 572.
[55] L.M. Widrow, Distribution Functions for Cuspy Dark Matter Density Profiles, ApJS 131 (2000) 39 [astro-ph/0003302].
[56] P. Ullio and M. Kamionkowski, Velocity distributions and annual-modulation signatures of weakly-interacting massive particles, Journal of High Energy Physics 3 (2001) 49 [hep-ph/0006183].
[57] J.D. Vergados and D. Owen, New Velocity Distribution for Cold Dark Matter in the Context of the Eddington Theory, ApJ 589 (2003) 17 [astro-ph/0203293].
[58] F. Ferrer and D.R. Hunter, The impact of the phase-space density on the indirect detection of dark matter, Journal of Cosmology and Astroparticle Physics 9 (2013) 5 [1306.6586].
[59] T. Lacroix, M. Stref and J. Lavalle, Anatomy of Eddington-like inversion methods in the context of dark matter searches, Journal of Cosmology and Astroparticle Physics 2018 (2018) 040.
[60] L.P. Osipkov, Spherical systems of gravitating bodies with an ellipsoidal velocity distribution, Pisma v Astronomicheskii Zhurnal 5 (1979) 77.
[61] D. Merritt, Spherical stellar systems with spheroidal velocity distributions, The Astronomical Journal 90 (1985) 1027.
[62] P. Cuddeford, An analytic inversion for anisotropic spherical galaxies, Monthly Notices of the Royal Astronomical Society 253 (1991) 414.
[63] N. Bozorgnia, R. Catena and T. Schwetz, Anisotropic dark matter distribution functions and impact on WIMP direct detection, Journal of Cosmology and Astroparticle Physics 12 (2013) 50 [1310.0468].
[64] J. Binney and T. Piffl, The distribution function of the Galaxy's dark halo, Monthly Notices of the Royal Astronomical Society 454 (2015) 3653 [1509.06877].
[65] J.L. Sanders and J. Binney, A review of action estimation methods for galactic dynamics, Monthly Notices of the Royal Astronomical Society 457 (2016) 2107 [1511.08213].
[66] T. Piffl, Z. Penoyre and J. Binney, Bringing the Galaxy's dark halo to life, Monthly Notices of the Royal Astronomical Society 451 (2015) 639 [1502.02916].
[67] T.M. Callingham, M. Cautun, A.J. Deason, C.S. Frenk, R.J.J. Grand, F. Marinacci et al., The orbital phase space of contracted dark matter halos, arXiv e-prints (2020) arXiv:2001.07742 [2001.07742].
[68] K. Hattori, M. Valluri and E. Vasiliev, Action-based distribution function modelling for constraining the shape of the galactic dark matter halo, arXiv e-prints (2020) arXiv:2012.03908 [2012.03908].
[69] C. Hunter and E. Qian, Two-integral distribution functions for axisymmetric galaxies, Monthly Notices of the Royal Astronomical Society 262 (1993) 401.
[70] M. Petac and P. Ullio, Two-integral distribution functions in axisymmetric galaxies: Implications for dark matter searches, Physical Review D 99 (2019) 043003.
[71] P. Mollitor, E. Nezri and R. Teyssier, Baryonic and dark matter distribution in cosmological simulations of spiral galaxies, Monthly Notices of the Royal Astronomical Society 447 (2015) 1353.
[72] A. Nuñez-Castiñeyra, E. Nezri, J. Devriendt and R. Teyssier, Cosmological simulations of the same spiral galaxy: the impact of baryonic physics, Monthly Notices of the Royal Astronomical Society 501 (2021) 62.
[73] M. Petac, P. Ullio and M. Valli, On velocity-dependent dark matter annihilations in dwarf satellites, Journal of Cosmology and Astroparticle Physics 2018 (2018) 039.
[74] R. Wojtak, E.L. Lokas, G.A. Mamon, S. Gottlöber, A. Klypin and Y. Hoffman, The distribution function of dark matter in massive haloes, MNRAS 388 (2008) 815 [0802.0429].
[75] E.E. Qian, P.T. de Zeeuw, R.P. van der Marel and C. Hunter, Axisymmetric galaxy models with central black holes, with an application to M32, Mon.Not.Roy.Astron.Soc. 274 (1995) 602.
[76] D. Lynden-Bell, Stellar dynamics: Exact solution of the self-gravitation equation, Monthly Notices of the Royal Astronomical Society 123 (1962) 447.
­ 42 ­

[77] J.S. Bullock, A. Dekel, T.S. Kolatt, A.V. Kravtsov, A.A. Klypin, C. Porciani et al., A Universal Angular Momentum Profile for Galactic Halos, The Astrophysical Journal 555 (2001) 240.
[78] S. Sharma and M. Steinmetz, The Angular Momentum Distribution of Gas and Dark Matter in Galactic Halos, The Astrophysical Journal 628 (2005) 21.
[79] A.F. Teklu, R.-S. Remus, K. Dolag, A.M. Beck, A. Burkert, A.S. Schmidt et al., Connecting Angular Momentum and Galactic Dynamics: The Complex Interplay between Spin, Mass, and Morphology, The Astrophysical Journal 812 (2015) 29.
[80] J. Zavala, C.S. Frenk, R. Bower, J. Schaye, T. Theuns, R.A. Crain et al., The link between the assembly of the inner dark matter halo and the angular momentum evolution of galaxies in the EAGLE simulation, Monthly Notices of the Royal Astronomical Society 460 (2016) 4466.
[81] J. Zjupa and V. Springel, Angular momentum properties of haloes and their baryon content in the Illustris simulation, Monthly Notices of the Royal Astronomical Society 466 (2017) 1625.
[82] R. Teyssier, Cosmological hydrodynamics with adaptive mesh refinement. A new high resolution code called RAMSES, Astronomy and Astrophysics 385 (2002) 337.
[83] O. Hahn and T. Abel, Multi-scale initial conditions for cosmological simulations, Monthly Notices of the Royal Astronomical Society 415 (2011) 2101.
[84] J. Oñorbe, S. Garrison-Kimmel, A.H. Maller, J.S. Bullock, M. Rocha and O. Hahn, How to zoom: bias, contamination and Lagrange volumes in multimass cosmological simulations, Monthly Notices of the Royal Astronomical Society 437 (2014) 1894.
[85] L. Hernquist, An analytical model for spherical galaxies and bulges, The Astrophysical Journal 356 (1990) 359.
[86] M. Miyamoto and R. Nagai, Three-dimensional models for the distribution of mass in galaxies., Publications of the Astronomical Society of Japan 27 (1975) 533.
[87] J.F. Navarro, C.S. Frenk and S.D.M. White, A Universal Density Profile from Hierarchical Clustering, The Astrophysical Journal 490 (1997) 493.
[88] A. Burkert, The Structure of Dark Matter Halos in Dwarf Galaxies, The Astrophysical Journal 447 (1995) .
[89] H. Zhao, Analytical models for galactic nuclei, Monthly Notices of the Royal Astronomical Society 278 (1996) 488.
[90] S. Kullback and R.A. Leibler, On Information and Sufficiency, The Annals of Mathematical Statistics 22 (1951) 79.
[91] J.L. Feng, Dark Matter Candidates from Particle Physics and Methods of Detection, Annual Review of Astronomy and Astrophysics 48 (2010) 495.
[92] T. Lin, TASI lectures on dark matter models and direct detection, arXiv e-prints 1904 (2019) arXiv:1904.07915.
[93] A.L. Fitzpatrick, W. Haxton, E. Katz, N. Lubbers and Y. Xu, The effective field theory of dark matter direct detection, Journal of Cosmology and Astroparticle Physics 2013 (2013) 004.
[94] N. Anand, A.L. Fitzpatrick and W.C. Haxton, Model-independent WIMP Scattering Responses and Event Rates: A Mathematica Package for Experimental Analysis, arXiv e-prints (2013) arXiv:1308.6288.
[95] J.B. Dent, L.M. Krauss, J.L. Newstead and S. Sabharwal, General analysis of direct dark matter detection: From microphysics to observational signatures, Physical Review D 92 (2015) 063515.
[96] F. Bishara, J. Brod, B. Grinstein and J. Zupan, Chiral effective theory of dark matter direct detection, Journal of Cosmology and Astroparticle Physics 2017 (2017) 009.
[97] H.E.S.S. Collaboration, H. Abdallah, A. Abramowski, F. Aharonian, F.A. Benkhali, E.O. Angüner et al., Search for $\gamma$-ray line signals from dark matter annihilations in the inner Galactic halo from ten years of observations with H.E.S.S, arXiv:1805.05741 [astro-ph] (2018) .
[98] L.J. Chang, M. Lisanti and S. Mishra-Sharma, A Search for Dark Matter Annihilation in the Milky Way Halo, Physical Review D 98 (2018) 123004.
­ 43 ­

[99] Fermi-LAT Collaboration, C. Johnson, R. Caputo, C. Karwin, S. Murgia, S. Ritz et al., Search for gamma-ray emission from $p$-wave dark matter annihilation in the Galactic Center, Physical Review D 99 (2019) 103007.
[100] K.N. Abazajian, S. Horiuchi, M. Kaplinghat, R.E. Keeley and O. Macias, Strong constraints on thermal relic dark matter from Fermi-LAT observations of the Galactic Center, arXiv e-prints (2020) arXiv:2003.10416 [2003.10416].
[101] T.F.-L. Collaboration, M. Ackermann, A. Albert, B. Anderson, L. Baldini, J. Ballet et al., Dark Matter Constraints from Observations of 25 Milky Way Satellite Galaxies with the Fermi Large Area Telescope, Physical Review D 89 (2014) .
[102] M. Ackermann and others, Searching for dark matter annihilation from Milky Way dwarf spheroidal galaxies with six years of Fermi Large Area Telescope data, Physical review letters 115 (2015) 231301.
[103] S. Archambault, A. Archer, W. Benbow, R. Bird, E. Bourbeau, T. Brantseg et al., Dark matter constraints from a joint analysis of dwarf Spheroidal galaxy observations with VERITAS, Physical Review D 95 (2017) 082001.
[104] K.K. Boddy, J. Kumar, D. Marfatia and P. Sandick, Model-independent constraints on dark matter annihilation in dwarf spheroidal galaxies, Physical Review D 97 (2018) 095031.
[105] S. Hoof, A. Geringer-Sameth and R. Trotta, A Global Analysis of Dark Matter Signals from 27 Dwarf Spheroidal Galaxies using Ten Years of Fermi-LAT Observations, arXiv e-prints (2018) arXiv:1812.06986.
[106] T.H. Collaboration, Search for Gamma-ray Spectral Lines from Dark Matter Annihilation in Dwarf Galaxies with the High-Altitude Water Cherenkov Observatory, Physical Review D 101 (2020) 103001.
[107] J. Rico, Gamma-Ray Dark Matter Searches in Milky Way Satellites ­ A Comparative Review of Data Analysis Methods and Current Results, Galaxies 8 (2020) 25.
[108] A. Alvarez, F. Calore, A. Genina, J.I. Read, P.D. Serpico and B. Zaldivar, Dark matter constraints from dwarf galaxies with data-driven J-factors, arXiv:2002.01229 [astro-ph] (2020) .
[109] J. Lavalle and P. Salati, Dark Matter Indirect Signatures, Comptes Rendus Physique 13 (2012) 740. [110] J.M. Gaskins, A review of indirect searches for particle dark matter, Contemporary Physics 57 (2016)
496. [111] J. Hinton and E. Ruiz-Velasco, Multi-messenger astronomy with very-high-energy gamma-ray
observations, . [112] J.S. Hagelin, G.L. Kane and S. Raby, Perhaps scalar neutrinos are the lightest supersymmetric partners,
Nuclear Physics B 241 (1984) 638. [113] Y.G. Kim and K.Y. Lee, Minimal model of fermionic dark matter, Physical Review D 75 (2007) 115012. [114] M. Pospelov, A. Ritz and M. Voloshin, Secluded WIMP dark matter, Physics Letters B 662 (2008) 53. [115] K.Y. Lee, Y.G. Kim and S. Shin, Singlet fermionic dark matter, Journal of High Energy Physics 2008
(2008) 100. [116] R. Iengo, Sommerfeld enhancement: general results from field theory diagrams, Journal of High Energy
Physics 2009 (2009) 024 [0902.0688]. [117] J.B. Dent, S. Dutta and R.J. Scherrer, Thermal relic abundances of particles with velocity-dependent
interactions, Physics Letters B 687 (2010) 275 [0909.4128]. [118] T.R. Slatyer, The Sommerfeld enhancement for dark matter with an excited state, Journal of Cosmology
and Astroparticle Physics 2010 (2010) 028 [0910.5713]. [119] S. Tulin, H.-B. Yu and K.M. Zurek, Beyond collisionless dark matter: Particle physics dynamics for
dark matter halo structure, Physical Review D 87 (2013) 115007.
­ 44 ­

