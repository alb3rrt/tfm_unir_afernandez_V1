arXiv:2106.01811v2 [cond-mat.dis-nn] 8 Jun 2021

Detecting ergodic bubbles at the crossover to many-body localization using neural networks
Tomasz Szoldra,1 Piotr Sierant,2, 1 Korbinian Kottmann,3 Maciej Lewenstein,3, 4 and Jakub Zakrzewski1, 5 1Instytut Fizyki Teoretycznej, Uniwersytet Jagiellon´ski, Lojasiewicza 11, PL-30-348 Krako´w, Poland
2The Abdus Salam International Center for Theoretical Physics, Strada Costiera 11, 34151, Trieste, Italy 3ICFO-Institut de Ci`encies Foto`niques, The Barcelona Institute of Science and Technology, Av. Carl Friedrich Gauss 3, 08860 Castelldefels (Barcelona), Spain 4ICREA, Passeig Lluis Companys 23, 08010 Barcelona, Spain 5Mark Kac Complex Systems Research Center, Uniwersytet Jagiellon´ski, Krako´w, Poland (Dated: June 9, 2021)
The transition between ergodic and many-body localized phases is expected to occur via an avalanche mechanism, in which ergodic bubbles that arise due to local fluctuations in system properties thermalize their surroundings leading to delocalization of the system, unless the disorder is sufficiently strong to stop this process. We propose an algorithm based on neural networks that allows to detect the ergodic bubbles using experimentally measurable two-site correlation functions. Investigating time evolution of the system, we observe a logarithmic in time growth of the ergodic bubbles in the MBL regime. The distribution of the size of ergodic bubbles converges during time evolution to an exponentially decaying distribution in the MBL regime, and a power-law distribution with a thermal peak in the critical regime, supporting thus the scenario of delocalization through the avalanche mechanism. Our algorithm permits to pin-point quantitative differences in time evolution of systems with random and quasiperiodic potentials, as well as to identify rare (Griffiths) events. Our results open new pathways in studies of the mechanisms of thermalization of disordered many-body systems and beyond.

Introduction. Many-body localization (MBL) [1, 2] is a phenomenon that prevents strongly disordered quantum many-body systems from reaching thermal equilibrium [3­5]. In this dynamical phase, the transport is suppressed [6] due to the presence of a complete set of local integrals of motion [7­10] that account also for the logarithmic growth of entanglement entropy in time evolution [11­13], or the area-law entanglement of the eigenstates (for recent reviews see [14, 15]). While the properties of MBL phase are considerably well understood, its stability in the thermodynamic limit has recently been vividly debated [16­21], and it may depend on various system specific properties [22].
The delocalization of MBL was proposed to occur via an "avalanche" mechanism [23, 24]. In this approach, small ergodic regions ("ergodic bubbles") immersed among insulating blocks delocalize their surroundings and grow at the expense of the localized regions. If the disorder is not sufficiently strong to stop this process, the system becomes delocalized. The avalanche mechanism was soon incorporated into the real space renormalization group approaches [1, 25, 26, 28] that suggest the transition to MBL is of the Kosterlitz-Thouless type. This conclusion is supported by a structure of entanglement clusters in eigenstates of system at MBL transition identified in [2] with the help of quantum mutual information [30].
The signatures of MBL have been observed experimentally in setups of ultracold atoms [31­34], ions [35] or superconducting qubits [36, 37]. Most of the experiments investigated time evolution of initial product states probing correlations between the initial and time-evolved oc-

cupations of lattice sites. Strong correlations persisting in the long time limit of time evolution indicate memory of initial state and the onset of MBL. Recent experiments [38­40] were able to directly measure the density correlations between various lattice sites, hence opening up new directions in investigations of quantum dynamics.
The aim of this work is to propose a scheme to detect and study the dynamics of the ergodic bubbles at the crossover to MBL relying on the two-site correlation functions that are directly measurable in experiments. To this end we employ recurrent neural networks (RNN) that are tailored to time-dependent data and have achieved unprecedented success in natural language processing tasks in recent years [41­43]. Our scheme allows us to identify the ergodic bubbles, i.e. the regions of the system, where the dynamics is ergodic, and to study their time evolution. We pin-point the mechanism of delocalization of MBL phase by probing the distribution of the ergodic bubbles. Comparing various types of disorder, we detect rare Griffiths regions [44­48] and discuss their impact on delocalization of MBL phase.
The models. From now on we concentrate on the random-field Heisenberg model with Hamiltonian

L

L

H = J Si · Si+1 + WiSiz,

(1)

i=1

i=1

where Si are spin-1/2 operators, J = 1 is fixed as the energy unit and periodic boundary conditions are assumed. Setting Wi to be independent random variables uniformly distributed in the interval [-W, W ], we obtain the model with random disorder, widely studied in the

2

FIG. 1. Neural network architecture: A snapshot xi(t) of two-point correlation functions is input to the multi-channel time series autoencoder. The object xi(t) is processed by two consecutive LSTM layers in the encoder. The LSTMs additionally receive (pass) a hidden state from (to) the previous (next) time step, thus creating a time order. The decoder is simply composed of three dense (fully-connected) layers. The network outputs the time series x~i(t) that reconstructs the input signal xi(t).
context of MBL [49­59]. Estimates of the critical disorder strength vary between WCRD  4 [60, 61] and WCRD 5 [62­64]. We consider also the quasiperiodic potential Wi = W cos (2i + ), where   [0, 2] is a random phase, W characterizes the strength of the potential and the golden ratio  = 5 - 1 /2 is used. The transition to MBL phase for that  value occurs at WCQP  2.5 [65­ 68]. The random potential features rare regions, in which disorder may be anomalously weak or strong. There are no such fluctuations in the quasiperiodic case. Hence, the MBL transition may be qualitatively different in the two cases [69].
In what follows we use RNN to analyze the approach to thermal equilibrium in the course of time evolution of system (1). The neural networks have been applied to studies of properties of eigenstates of disordered quantum many-body systems [70­73] or in investigations of gross features of their time dynamics [74­76].
Ergodic bubble detection. We define a set of neighboring spins to be an ergodic bubble (or cluster ) if the local observables associated with them have properties characteristic to an ergodic/thermal phase. In particular, the observables undergo fluctuations in the course of time evolution and this feature may be used for their direct detection. Nevertheless, providing a well-defined criterion for distinguishing the ergodic from the non-ergodic evolutions remains a non-trivial task. In this section we propose an algorithm employing neural networks that learns how the ergodic evolutions "look like", and later assigns the time evolutions of experimentally accessible observables to an ergodic or non-ergodic class.
At the core of our framework is the anomaly detection scheme [77] (similar techniques were recently used for mapping out phase diagrams of the quantum many-body systems [78­80]). Precisely speaking, we consider a neural network of an autoencoder architecture, whose goal is to spot the characteristic features of the input data,

FIG. 2. Neural network loss ­ a measure of non-ergodicity in the system. In the ergodic regime W = 1.5, the nonergodic (high loss) regions quickly disappear; they persist in the MBL phase at W = 5.5. Both evolutions were calculated for the same uniform disorder realization but with a different amplitude. Insets show the two-site correlations (input of the NN - solid lines), Eq. (2), and the NN output (dashed lines). The NN learned to reconstruct ergodic evolutions perfectly (left inset). It performs significantly worse on the non-ergodic data (right inset) it has not encountered during training, as expected in the anomaly detection scheme.

"compress" it into a latent representation (the encoder network) and, from there, to accurately reproduce the original input (the decoder network) ­ compare FIG. 1. The autoencoder is trained on the normal data until it efficiently reproduces it, and then evaluated on a dataset consisting of normal and anomalous data to identify the anomalous data based on the high reconstruction loss. In our case, the normal data corresponds to the time series of observables in the ergodic regime at weak disorder, as opposed to the non-ergodic evolutions for large disorder, regarded as the anomalous data.
Specifically, as input data we use the two-site correlation functions Ci,d(t) = Siz(t)Siz+d(t) . Let us define a collection of these correlations xi(t) that is supposed to characterize site i at time t. It consists of correlation functions Ci,d(t) corresponding to d0 neighbors of site i, sampled across nt discrete points in time

xi(t) = {Ci,d(t + nt)}d=-d0,...,-1,1,...,d0 ,

(2)

n=0,...,nt -1

where, in our implementation we take t = 0.5, d0 = 2 and nt = 32. The four-channel time series of length 32 starting at time t, xi(t), constitutes a single input to the neural network. Having a trained autoencoder network we can perform an anomaly detection by measuring the reconstruction loss li(t) = ||x~i(t) - xi(t)||, where ||.|| is the Euclidean norm, see FIG. 2. In order to classify a site i at time t, one needs to set a loss cutoff parameter lcut. In our algorithm, the thermal bubble is defined as a set of adjacent sites which satisfy li  lcut, that is, for which the network succeeds in reconstructing the temporal evolution of observables with loss no larger than lcut. Thus, we have a quantitative tool to detect the

3

ergodic clusters and to differentiate them from sites at which the anomaly is detected and the dynamics is not ergodic.
Among many neural network architectures, particularly well suited for multichannel time series processing are RNN that naturally utilize the temporal order by recursively including the data from previously processed time steps. In our case, the encoder part of the network consists of a special type of RNN with two layers of Long Short-Term Memory (LSTM) architecture [81] with 64 and 32 units, see FIG. 1. As a decoder we use 3 dense time-distributed layers of dimension 128 and 64 and 32. The training dataset consists of time evolutions from t = 100 to t = 2000 corresponding to 100 realizations of uniformly distributed disorder of strength W  {0.1, 0.2, . . . 0.5} for system size L = 16. For a detailed comparison with the networks trained on larger values of disorder, as well as on the quasiperiodic distribution of disorder see [82]. We stop the training after a certain value 1.7 · 10-3 of the validation loss is achieved.
Dynamics of ergodic bubbles. We denote the average in a given state as .  and average over 2400 disorder realizations as . W . To control the risk that a single neural network model accidentally learns a random feature of the data which another model does not, we independently train 30 models on the same data and denote the average over them as . N . All error bars in the following plots correspond to one standard deviation in this averaging. We will consider the distributions of the number of spins n in an ergodic bubble, as well as the average size of ergodic bubbles nav  n  W N . Initially, the spins are fully uncorrelated and the initial state is chosen to be a N´eel state | = | . . . . The time evolution with Hamiltonian (1) is calculated numerically by means of a kernel polynomial method [83­85] for system consisting of L = 24 spins.
We start our studies of the MBL transition by checking how the average size of ergodic bubbles depends on the cutoff lcut, see FIG. 3(a). In the ergodic regime the increase of nav with lcut is much sharper than for the critical and MBL regimes which signifies that our algorithm indeed detects the prevalent ergodicity in the system. Moreover, comparing the results for t = 20 and t = 1980, we observe that the amount of ergodic regions increases in the course of the evolution, but the growth is much smaller in the MBL than in the ergodic and critical regimes. We may now choose a "reasonable" value of the cutoff l0 = 0.15, for which, at W = 1.5, the neural network treats almost the entire chain as a large thermal bubble and in the critical regime it finds a mixture of ergodic bubbles and non-ergodic regions.
In FIG. 3(b) we present the bubble dynamics for the chosen value of cut-off l0 = 0.15 and different disorder strengths. Due to a limited temporal resolution of our classification scheme (the time window in which the snapshot xi(t) of two-site correlation functions has a length

FIG. 3. (a) The average size nav of the ergodic bubbles as a function of the loss cutoff lcut at time t = 20 (dashed lines) and t = 1980 (solid lines) for random disorder. The ergodic (W = 1.5), critical (W = 3.5) and MBL (W = 7.0) regimes differ qualitatively by the dependence of nav on lcut and by the amount the bubbles grow in time. (b) Logarithmic in time growth of the average bubble size for lcut = 0.15 and several disorder strengths W . Inset: see text.
of ntt = 16), in the initial stage of the evolution we detect ergodic clusters of non-vanishing size. In the course of time evolution the ergodic bubbles thermalize their surroundings and, consequently, the average size of ergodic bubbles grows with time. Our results indicate that the growth of the bubbles is logarithmic in time until saturation.
The inset of FIG. 3(b) shows the logarithmic growth rates , fitted from nav(t) =  log t + C for different loss cutoffs lcut = 0.1, 0.15, 0.2 (from top to bottom, empty markers), considered as a function of W . They are surprisingly well compatible with the similar logarithmic growth rates of the bipartite von Neumann entanglement entropy S(A) = TrA (A ln A) where A is the reduced density matrix of subsystem A consisting of spins indexed by i = 1 . . . L/2 (bottom, full markers). That is, in both cases, (W )  C exp(-W ) where  = (0.55 ± 0.05) while C is different for entropy and clusters for dimensional reasons. Importantly, this conclusion holds for arbitrary cut-off lcut  [0.1, 0.2], indicating that our algorithm serves also as an indirect measure of the entanglement entropy. The decrease of the growth rate of ergodic bubbles with disorder strength W is consistent with the exponential decay of the diffusion constant derived from Thouless time [18], and with the exponential slow-down of decay of one-site correlation functions [86] with increasing W at the crossover to MBL regime.
The close relation between the growth of ergodic bubbles and spreading of the entanglement in the system can be explained by a simple qualitative argument. Let us assume that the chain contains a strongly correlated ergodic cluster of length n. If the cut that separates the subsystem A from its surroundings does not split the cluster, the contribution from this realization to the average entropy is relatively small. However, if the cut splits

4

probability density

0.8 0.6 0.4 0.2 0.0 0

all realizations anomalous events

(a) 0.25

0.20

0.15

0.10

0.05

2

4

6

S(L/2) at t = 2000

0.00 0

(b)
2 4 6 8 10 |Wi - Wi-1|

FIG. 4. Histograms of the bubble sizes n at time t = 20 (empty markers) and t = 1980 (full markers), at a cutoff level lcut = 0.15 and (a) uniform and (b) quasiperiodic distribution of disorder, 2400 realizations.

FIG. 5. Properties of 2400 realizations of uniform disorder W = 5.5 (solid black line), including those 74 for which very large clusters n  L - 1 = 23 were detected in the course of evolution from t = 0 to t = 1980 by a single neural network model (dashed pink line).

the cluster, the contribution will be much larger because A contains spins strongly correlated with the rest of the ergodic bubble. According to the volume law of entanglement, this contribution will be proportional to the number of cluster sites included in A which is proportional to nav. Therefore, we may conclude that S is proportional to nav. Moreover, we are convinced that the network detects strongly entangled parts of the system without the need to directly quantify the entanglement.
Distribution of ergodic bubbles. Further insights into MBL transition are obtained from an analysis of the distributions of the ergodic bubble size n. In FIG. 4(a) we present such distributions for random disorder, in the initial stage t = 20, and after a long evolution time t = 1980. In both cases, in the MBL regime (W = 7), the distribution decays exponentially as exp(-n), consistently with an intuitive expectation that ergodic bubbles correspond to rare events in which the disorder is anomalously weak on n neighboring lattices sites. Indeed, if p < 1 is the probability to have the weak disorder on a certain site, the probability to find n such sites is pn = en log p. In the critical regime (W = 4), the ergodic bubbles are distributed, at t = 1980, according to a power-law n- with   1 and there emerges a thermal peak at n  L. Indications of both the power-law distribution and the presence of thermal peak in the critical regime were observed in renormalization group schemes [87] as well as in exact diagonalization studies [88]. Exactly at the transition one expects the exponent  governing the decay of ergodic clusters to be equal to 2 [1]. The smaller value of  for W = 4 suggests that system becomes ergodic in thermodynamic limit at this disorder strength. While pin-pointing exactly the transition point would require much larger system sizes and evolution times, our results support the picture of the MBL transition occurring via rare avalanches [23]. Finally, on the ergodic side of the crossover (W = 2.5) we observe abundance of dominant thermal clusters of size n  L. During time evolution from t = 20 to t = 1980, the number of large er-

godic bubbles grows in time at the expense of the smaller ones. This process eventually leads to delocalization of the whole system. The transition from an exponential to a power-law distribution in FIG. 4 is quantitatively analyzed in [82].
The situation is qualitatively similar for the system with quasiperiodic potential as shown in FIG. 4(b). In the MBL regime (W = 4) the probability to detect ergodic bubble of size n is exponentially small in n. This suggests a presence of similar rare event mechanism as in the case of random disorder. Such a mechanism, in absence of fluctuations in the quasiperiodic potential, might be associated with rare configurations of the state of the system [89]. In the critical regime (W = 2.5), we find that bubble size is distributed according to a power-law n-2.2, although there are no traces of the thermal peak at n  L. This suggests that delocalization in quasiperiodic system occurs, similarly to the random case, via an avalanche mechanism [90]. Finally, in the ergodic regime (W = 1.5), the broad distribution of ergodic bubbles at small time t = 20 quickly evolves into a single thermal peak at n  L. The small variance of size of ergodic bubbles both in ergodic and thermal regimes suggests that the MBL transition in quasiperiodic systems is more stable than in the random case [91].
Griffiths regions. For the random disorder, even quite deeply in the MBL regime, at W = 5.5, our algorithm detects ergodic bubbles of size n  L - 1, see [82] for a corresponding plot similar to FIG. 2. FIG. 5 shows comparison of properties of all disorder realizations with properties of those anomalous realizations. Exceptionally large bipartite entanglement entropy S(A) and strongly resonant values of disorder distinguish these anomalous realizations from the background. This shows that our algorithm detects rare Griffiths events that arise due to fluctuations in the random disorder. For quasiperiodic potential the atypically large bubbles were not detected at all if the cutoffs lcut were set at the same level. Even

5

if we tune the cutoffs so that the number of detected anomalous realizations is comparable to the uniform disorder case, their features are not distinctive, for details see [82].
Summary. We proposed an algorithm based on neural networks, which allows us to detect and study dynamics of ergodic bubbles in disordered many-body systems. The algorithm learns itself features of ergodic time evolution and employs the anomaly detection scheme to identify lattice sites, at which the evolution is nonergodic. Detected ergodic bubbles grow logarithmically in time in the MBL regime, which indicates that our algorithm captures features of entanglement in the system without quantifying it directly. The distributions of the size of ergodic bubble, exponential in the MBL regime and algebraic with thermal peak in the critical regime, support the avalanche scenario of delocalization of MBL phase. Those results are in qualitative agreement with the results obtained when the algorithm of [2] is used to identify entanglement clusters in state of the system during time evolution, as we show in [82]. The approach of [2] relies on the quantum mutual information of numerous subsystems that is very hard to measure in practice. In contrast, our approach employs only two-site correlation functions readily accessible in present days experiments. Hence, our algorithm allows one for a quantitative investigation of mechanisms of thermalization at MBL transition, not only in the numerics, but also in the experimental setup.
Acknowledgments We would like to thank Fabien Alet for helpful comments and critical reading of the manuscript. T. S. and J. Z. acknowledge support by PL-Grid Infrastructure and by National Science Centre (Poland) under OPUS-18 project 2019/35/B/ST2/00034. M.L. acknowledges support from ERC AdG NOQIA, Agencia Estatal de Investigaci´on ("Severo Ochoa" Center of Excellence CEX2019000910-S, Plan National FIDEUA PID2019-106901GBI00/10.13039 / 501100011033, FPI), Fundaci´o Privada Cellex, Fundaci´o Mir-Puig, and from Generalitat de Catalunya (AGAUR Grant No. 2017 SGR 1341, CERCA program, QuantumCAT U16-011424 , co-funded by ERDF Operational Program of Catalonia 2014-2020), MINECO-EU QUANTERA MAQS (funded by State Research Agency (AEI) PCI2019111828-2 / 10.13039/501100011033), EU Horizon 2020 FET-OPEN OPTOLogic (Grant No 899794), and the National Science Centre, Poland-Symfonia Grant No. 2016/20/W/ST4/00314, Marie Sklodowska-Curie grant STRETCH No 101029393. This project has received funding from the European Union's Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie grant agreement No 713729 (KK). P.S. acknowledges the support of Foundation for Polish Science (FNP) through scholarship START.

[1] D. Basko, I. Aleiner, and B. Altschuler, Ann. Phys. (NY) 321, 1126 (2006).
[2] I. V. Gornyi, A. D. Mirlin, and D. G. Polyakov, Phys. Rev. Lett. 95, 206603 (2005).
[3] J. M. Deutsch, Phys. Rev. A 43, 2046 (1991). [4] M. Srednicki, Phys. Rev. E 50, 888 (1994). [5] L. D'Alessio, Y. Kafri, A. Polkovnikov, and M. Rigol,
Advances in Physics 65, 239 (2016). [6] R. Nandkishore and D. A. Huse, Annual Review of Con-
densed Matter Physics 6, 15 (2015). [7] D. A. Huse, R. Nandkishore, and V. Oganesyan, Phys.
Rev. B 90, 174202 (2014). [8] V. Ros, M. Mueller, and A. Scardicchio, Nuclear Physics
B 891, 420 (2015). [9] J. Z. Imbrie, Phys. Rev. Lett. 117, 027201 (2016). [10] M. Mierzejewski, M. Kozarzewski, and P. Prelovsek,
Phys. Rev. B 97, 064204 (2018). [11] M. Znidaric, T. Prosen, and P. Prelovsek, Phys. Rev. B
77, 064426 (2008). [12] J. H. Bardarson, F. Pollmann, and J. E. Moore, Phys.
Rev. Lett. 109, 017202 (2012). [13] M. Serbyn, Z. Papi´c, and D. A. Abanin, Phys. Rev. Lett.
111, 127201 (2013). [14] D. A. Abanin, E. Altman, I. Bloch, and M. Serbyn, Rev.
Mod. Phys. 91, 021001 (2019). [15] F. Alet and N. Laflorencie, Comptes Rendus Physique
19, 498 (2018), quantum simulation / Simulation quantique. [16] J. Suntajs, J. Bonca, T. c. v. Prosen, and L. Vidmar, Phys. Rev. E 102, 062144 (2020). [17] R. K. Panda, A. Scardicchio, M. Schulz, S. R. Taylor, and M. Znidaric, Europhysics Letters 128, 67003 (2020). [18] P. Sierant, D. Delande, and J. Zakrzewski, Phys. Rev. Lett. 124, 186601 (2020). [19] M. Kiefer-Emmanouilidis, R. Unanyan, M. Fleischhauer, and J. Sirker, Phys. Rev. Lett. 124, 243601 (2020). [20] D. Abanin, J. Bardarson, G. De Tomasi, S. Gopalakrishnan, V. Khemani, S. Parameswaran, F. Pollmann, A. Potter, M. Serbyn, and R. Vasseur, Annals of Physics , 168415 (2021). [21] D. Sels and A. Polkovnikov, "Dynamical obstruction to localization in a disordered spin chain," (2020), arXiv:2009.04501. [22] P. Sierant, E. Gonzalez Lazo, M. Dalmonte, A. Scardicchio, and J. Zakrzewski, "Constraints induced delocalization," (2021), arXiv:2103.14020. [23] W. De Roeck and F. Huveneers, Phys. Rev. B 95, 155129 (2017). [24] D. J. Luitz, F. m. c. Huveneers, and W. De Roeck, Phys. Rev. Lett. 119, 150602 (2017). [25] T. Thiery, F. m. c. Huveneers, M. Mu¨ller, and W. De Roeck, Phys. Rev. Lett. 121, 140601 (2018). [26] A. Goremykina, R. Vasseur, and M. Serbyn, Phys. Rev. Lett. 122, 040601 (2019). [1] P. T. Dumitrescu, A. Goremykina, S. A. Parameswaran, M. Serbyn, and R. Vasseur, Phys. Rev. B 99, 094205 (2019). [28] A. Morningstar and D. A. Huse, Phys. Rev. B 99, 224205 (2019). [2] L. Herviou, S. Bera, and J. H. Bardarson, Phys. Rev. B 99, 134205 (2019).

6

[30] G. De Tomasi, S. Bera, J. H. Bardarson, and F. Pollmann, Phys. Rev. Lett. 118, 016804 (2017).
[31] M. Schreiber, S. S. Hodgman, P. Bordia, H. P. Lu¨schen, M. H. Fischer, R. Vosk, E. Altman, U. Schneider, and I. Bloch, Science 349, 842 (2015).
[32] J.-y. Choi, S. Hild, J. Zeiher, P. Schauß, A. RubioAbadal, T. Yefsah, V. Khemani, D. A. Huse, I. Bloch, and C. Gross, Science 352, 1547 (2016).
[33] H. P. Lu¨schen, P. Bordia, S. Scherg, F. Alet, E. Altman, U. Schneider, and I. Bloch, Phys. Rev. Lett. 119, 260401 (2017).
[34] H. P. Lu¨schen, S. Scherg, T. Kohlert, M. Schreiber, P. Bordia, X. Li, S. Das Sarma, and I. Bloch, Phys. Rev. Lett. 120, 160404 (2018).
[35] J. Smith, A. Lee, P. Richerme, B. Neyenhuis, P. W. Hess, P. Hauke, M. Heyl, D. A. Huse, and C. Monroe, Nature Physics 12, 907 (2016).
[36] P. Roushan, C. Neill, J. Tangpanitanon, V. M. Bastidas, A. Megrant, R. Barends, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A. Fowler, B. Foxen, M. Giustina, E. Jeffrey, J. Kelly, E. Lucero, J. Mutus, M. Neeley, C. Quintana, D. Sank, A. Vainsencher, J. Wenner, T. White, H. Neven, D. G. Angelakis, and J. Martinis, Science 358, 1175 (2017).
[37] Q. Guo, C. Cheng, Z.-H. Sun, Z. Song, H. Li, Z. Wang, W. Ren, H. Dong, D. Zheng, Y.-R. Zhang, R. Mondaini, H. Fan, and H. Wang, Nature Physics 17, 234 (2021).
[38] M. Rispoli, A. Lukin, R. Schittko, S. Kim, M. E. Tai, J. L´eonard, and M. Greiner, Nature 573, 385 (2019).
[39] Q. Guo, C. Cheng, H. Li, S. Xu, P. Zhang, Z. Wang, C. Song, W. Liu, W. Ren, H. Dong, R. Mondaini, and H. Wang, "Stark many-body localization on a superconducting quantum processor," (2020), arXiv:2011.13895 [quant-ph].
[40] W. Morong, F. Liu, P. Becker, K. S. Collins, L. Feng, A. Kyprianidis, G. Pagano, T. You, A. V. Gorshkov, and C. Monroe, "Observation of stark many-body localization without disorder," (2021), arXiv:2102.07250 [quant-ph].
[41] K. Cho, B. Van Merri¨enboer, C. Gulcehre, D. Bahdanau, F. Bougares, H. Schwenk, and Y. Bengio, in EMNLP 2014 - 2014 Conference on Empirical Methods in Natural Language Processing, Proceedings of the Conference (Association for Computational Linguistics (ACL), 2014) pp. 1724­1734, arXiv:1406.1078.
[42] I. Sutskever, O. Vinyals, and Q. V. Le, Advances in Neural Information Processing Systems 4, 3104 (2014), arXiv:1409.3215.
[43] D. Bahdanau, K. H. Cho, and Y. Bengio, in 3rd International Conference on Learning Representations, ICLR 2015 - Conference Track Proceedings (International Conference on Learning Representations, ICLR, 2015) arXiv:1409.0473.
[44] T. Vojta, J. Low Temp. Phys. 161, 299 (2010). [45] S. Gopalakrishnan, M. Mu¨ller, V. Khemani, M. Knap,
E. Demler, and D. A. Huse, Phys. Rev. B 92, 104202 (2015). [46] K. Agarwal, S. Gopalakrishnan, M. Knap, M. Mu¨ller, and E. Demler, Phys. Rev. Lett. 114, 160401 (2015). [47] K. Agarwal, E. Altman, E. Demler, S. Gopalakrishnan, D. A. Huse, and M. Knap, Annalen der Physik 529, 1600326 (2017). [48] N. Pancotti, M. Knap, D. A. Huse, J. I. Cirac, and M. C. Ban~uls, Phys. Rev. B 97, 094206 (2018).

[49] L. F. Santos, G. Rigolin, and C. O. Escobar, Phys. Rev. A 69, 042304 (2004).
[50] V. Oganesyan and D. A. Huse, Phys. Rev. B 75, 155111 (2007).
[51] A. Pal and D. A. Huse, Phys. Rev. B 82, 174411 (2010). [52] T. C. Berkelbach and D. R. Reichman, Phys. Rev. B 81,
224429 (2010). [53] S. Bera, H. Schomerus, F. Heidrich-Meisner, and J. H.
Bardarson, Phys. Rev. Lett. 115, 046603 (2015). [54] T. Enss, F. Andraschko, and J. Sirker, Phys. Rev. B 95,
045121 (2017). [55] P. Sierant and J. Zakrzewski, Phys. Rev. B 101, 104201
(2020). [56] L. Colmenarez, P. A. McClarty, M. Haque, and D. J.
Luitz, SciPost Phys. 7, 64 (2019). [57] J. Suntajs, J. Bonca, T. Prosen, and L. Vidmar, Phys.
Rev. B 102, 064207 (2020). [58] N. Laflorencie, G. Lemari´e, and N. Mac´e, Phys. Rev.
Research 2, 042033 (2020). [59] L. Vidmar, B. Krajewski, J. Bonca, and M. Mierzejew-
ski, "Phenomenology of spectral functions in finite disordered spin chains," (2021), arXiv:2105.09336 [condmat.dis-nn]. [60] D. J. Luitz, N. Laflorencie, and F. Alet, Phys. Rev. B 91, 081103 (2015). [61] N. Mac´e, F. Alet, and N. Laflorencie, Phys. Rev. Lett. 123, 180601 (2019). [62] T. Devakul and R. R. P. Singh, Phys. Rev. Lett. 115, 187201 (2015). [63] J. Gray, S. Bose, and A. Bayat, Phys. Rev. B 97, 201105 (2018). [64] P. Sierant, M. Lewenstein, and J. Zakrzewski, Phys. Rev. Lett. 125, 156601 (2020). [65] S. Iyer, V. Oganesyan, G. Refael, and D. A. Huse, Phys. Rev. B 87, 134202 (2013). [66] M. Lee, T. R. Look, S. P. Lim, and D. N. Sheng, Phys. Rev. B 96, 075146 (2017). [67] S. Bera, T. Martynec, H. Schomerus, F. HeidrichMeisner, and J. H. Bardarson, Annalen der Physik 529, 1600356 (2017). [68] E. V. H. Doggen and A. D. Mirlin, Phys. Rev. B 100, 104203 (2019). [69] V. Khemani, D. N. Sheng, and D. A. Huse, Phys. Rev. Lett. 119, 075702 (2017). [70] F. Schindler, N. Regnault, and T. Neupert, Phys. Rev. B 95, 245134 (2017). [71] Y.-T. Hsu, X. Li, D.-L. Deng, and S. Das Sarma, Phys. Rev. Lett. 121, 245701 (2018). [72] P. Huembeli, A. Dauphin, P. Wittek, and C. Gogolin, Phys. Rev. B 99, 104106 (2019). [73] H. Th´eveniaut and F. Alet, Phys. Rev. B 100, 224202 (2019). [74] E. van Nieuwenburg, E. Bairey, and G. Refael, Phys. Rev. B 98, 060301 (2018). [75] E. V. H. Doggen, F. Schindler, K. S. Tikhonov, A. D. Mirlin, T. Neupert, D. G. Polyakov, and I. V. Gornyi, Phys. Rev. B 98, 174202 (2018). [76] A. Bohrdt, S. Kim, A. Lukin, M. Rispoli, R. Schittko, M. Knap, M. Greiner, and J. L´eonard, "Analyzing nonequilibrium quantum states through snapshots with artificial neural networks," (2020), arXiv:2012.11586 [condmat.quant-gas]. [77] G. Pang, C. Shen, L. Cao, and A. V. D. Hengel, ACM Computing Surveys 54, 1­38 (2021).

1

[78] K. Kottmann, P. Huembeli, M. Lewenstein, and A. Ac´in, Phys. Rev. Lett. 125, 170603 (2020).
[79] N. Ka¨ming, A. Dawid, K. Kottmann, M. Lewenstein, K. Sengstock, A. Dauphin, and C. Weitenberg, Machine Learning: Science and Technology (2021), arXiv:2101.05712 [cond-mat.quant-gas].
[80] K. Kottmann, M. Lewenstein, A. Acin, and P. Corboz, "Unsupervised mapping of phase diagrams of 2d systems from infinite projected entangled-pair states via deep anomaly detection," (2021), arXiv:2105.09089 [quant-ph].
[81] S. Hochreiter and J. Schmidhuber, Neural Comput. 9, 1735­1780 (1997).
[82] See Supplemental Material at [URL will be inserted by publisher].
[83] H. Tal-Ezer and R. Kosloff, J. Chem. Phys. 81, 3967 (1984), https://doi.org/10.1063/1.448136.
[84] C. Leforestier, R. Bisseling, C. Cerjan, M. Feit, R. Friesner, A. Guldberg, A. Hammerich, G. Jolicard, W. Karrlein, H.-D. Meyer, N. Lipkin, O. Roncero, and R. Kosloff, J. Comput. Phys. 94, 59 (1991).
[85] H. Fehske and R. Schneider, Computational manyparticle physics (Springer, Germany, 2008).
[86] T. Chanda, P. Sierant, and J. Zakrzewski, Phys. Rev. Research 2, 032045 (2020).
[87] P. T. Dumitrescu, R. Vasseur, and A. C. Potter, Phys. Rev. Lett. 119, 110604 (2017).
[88] X. Yu, D. J. Luitz, and B. K. Clark, Phys. Rev. B 94, 184202 (2016).
[89] S. Gopalakrishnan and S. Parameswaran, Physics Reports 862, 1 (2020), dynamics and transport at the threshold of many-body localization.
[90] S.-X. Zhang and H. Yao, Phys. Rev. Lett. 121, 206601 (2018).
[91] S.-X. Zhang and H. Yao, "Strong and weak many-body localizations," (2019), arXiv:1906.00971.
SUPPLEMENTAL MATERIAL
ERGODIC BUBBLE SIZE HISTOGRAMS
In FIG. S1 we show how the ergodic bubble size distribution changes from a power-law decay Cn- with a thermal peak in the critical regime W 4.5, into an exponential decay C exp(-n) when W 4.5 in the many-body localized phase. All fits are performed on n = 3 . . . 22 to minimize the influence of the thermal peak on the fit. We extract the fitted parameters and present them in FIGs. S1(d),(e). We notice that on the MBL side  increases with an increasing disorder strength. Moreover, it is expected [1] that at the critical point  = 2 and our results range from  = 0.54 at W = 3.5 to  = 1.76 at W = 5.0.
In FIG. S2 we provide an example of an anomalous realization/Griffiths event, detected by the neural network. An initially strongly non-ergodic regions thermalizes after some time due to the interaction with its ergodic surroundings.

ALTERNATIVE CLUSTERING ALGORITHM BASED ON QUANTUM MUTUAL INFORMATION

In this part of the Supplemental material we compare our neural network-based algorithm with a scheme introduced in [2] that detects so-called entanglement clusters. We start with a short revision of this algorithm, point out important differences between entanglement- and ergodic clusters, and then apply this method to the time evolving quantum states, obtaining results in qualitative agreement with our neural network approach.
The input to the entanglement clustering algorithm is the many-body wave function | . After the clusterization procedure, entanglement clusters should contain indices of spins strongly correlated with each other and, at the same time, weakly entangled between separate clusters. The clusters are constructed starting from the whole system and subdividing it recursively into two parts A, B containing nA, nB sites each, at every step minimizing the normalized quantum mutual information (QMI) of the splitting,

0



i(A, B)

=

S (A)

+ S(B) - S(A min(nA, nB)



B)



2 ln 2,

(S1)

where the von Neumann entropy of subsystem A reads

S(A) = TrA (A ln A) ,

(S2)

A is its reduced density matrix, and periodic boundary conditions are assumed. The number of all such possible bipartitions to choose from grows exponentially with the system size. To make the problem numerically tractable, only a certain class, the continuous bipartitions, are left as candidates for the splitting. ("Continuous" means that the splitting does not introduce holes in a single cluster. For example, a cluster consisting of sites {1, 2, 3, 4, 5, 6} can be divided into {1, 2, 5, 6} and {3, 4} but not into {1, 3, 5, 6} and {2, 4}. However, holes in the clusters may occur due to periodic boundary conditions assumed at each step, e.g. splitting {1, 2, 5, 6} can result in {1, 6} and {2, 5}.) Splitting is performed recursively until the cluster size is equal to 1 and the final representation of the wave function forms a binary tree. Each node of the tree contains indices of the lattice sites, as well as the QMI of the minimal bipartition i. Then, the user chooses a certain cutoff of the quantum mutual information icut and traverses the tree starting at the root. If the current node contains at least two sites and i < icut, one goes down to the node's two children. In the opposite case, i  icut, the list of sites at the current node is considered an entanglement cluster. A list of all such clusters is the final output of the clustering algorithm at the QMI cutoff level icut.
There is an important difference in the sense of entanglement and ergodic clusters: every site must be a member of one and only one entanglement cluster whereas

2

counts

(a) 103

W = 4.0 W = 7.0

(b) 103

counts

102

102

101

101

100

100

4 8 12 16 20 24 n

1 2 4 8 16 n

R2

1.0 (c)

0.3 (d)



0.9 0.2

0.8

5

6

7

0.7

(e)

1.5



0.6

C exp(-n) fit

1.0

Cn- fit

0.5

4

5

6

7 0.5 3.5

4.0

4.5

5.0

W

W

FIG. S1. Transition from an exponential to a power-law decay of ergodic bubble size n distributions for loss cutoff lcut = 0.15 and system size L = 24. (a): Bubble size histograms at large time t = 1980. Exponential fit C exp(-n) (dashed line) deviates from the W = 4.0 datapoints and agrees very well with those for W = 7.0.(b): same as (a) but with power-law fits Cn-
(notice the logarithmic horizontal scale). Here, the fit describes datapoints at W = 4.0 better than for W = 7.0. (c): Measure of the fit quality R2 = 1 - RSS/T SS, where RSS, T SS ­ residual and total sum of squares, for exponential and power-law fits
like in (a) and (b) but for more disorder strengths. Power-law fits the data better in the critical regime W 4.5. On the MBL
side, W 4.5, the exponential decay has a lower relative error. (d): Fitted values of . (e): Fitted values of .

(a)

FIG. S2. Neural network loss for an anomalous W = 5.5 disorder realization, detected at the cutoff level lcut = 0.15, system size L = 16. We notice the disappearance of the large loss (non-ergodic) region due to thermalization by its environment.
it doesn't necessarily have to be assigned to an ergodic cluster; the observables associated with single spins from an entanglement cluster may show either ergodic- or nonergodic kind of dynamics. This means that the QMI clustering algorithm detects a somewhat different family of clusters than the neural network. On the other hand, it is known that if at least a few spins are strongly entangled, their observables will converge towards thermal values and thermal evolutions, thus large entanglement clusters become equivalent to ergodic clusters. It is, however, not meaningful to compare very small ergodic clusters (n = 1 or 2) with similarly small entanglement clusters. Additionally, in our approach, a time series of spin correlations is needed to clusterize the system, whereas in the QMI case the clusters can be defined at time t based on the entanglement properties of the instantaneous wave function |(t) . Furthermore, entanglement clusters can have holes (see the discussion in the preceding paragraph), and

FIG. S3. a) Average size of entanglement clusters nav at time instants t = 20 (dashed lines) and t = 1900 (solid lines) for different QMI cutoffs icut and random disorder strengths W , system size L = 16. b) Average cluster size growth in time for cutoff icut = 0.5.

Entanglement clusters

Ergodic clusters

n1

n0

i ni = L defined for |(t)

i ni  L defined for {(t), . . . , |(t + nt) }

TABLE I. Comparison of some properties of entanglement clusters and ergodic clusters.

NN clusters cannot, but, as argued in ref. [2], QMI clusters with holes amount to less than 5-10% of all clusters in a typical scenario. For a summary of this paragraph see TABLE I.
So far, the QMI clustering procedure has been applied only to the middle-spectrum eigenstates of the disordered Heisenberg Hamiltonian [2]. Here, we extend those studies to characterize the cluster growth in time and compare the results with the neural network clustering. The system size is limited to L = 16 due computationally expensive entanglement entropy calculations. As in the

3

FIG. S4. Histograms of the entanglement cluster sizes n detected at the QMI cutoff level icut = 0.4 by the QMI clustering algorithm close to the start of the evolution t = 20 (empty markers) and after a long time t = 1900 (filled markers) for 2500 disorder realizations with system size L = 16.

Letter, we denote the averaging of the cluster size over a single state as .  and over disorder realizations as . W . In FIG. S3a) we present the average entanglement cluster size nav = n  W for different cutoff values icut at time t = 20 and t = 1900. We confirm that, similarly to the NN case, the transitions with cutoff are qualitatively different in the ergodic, critical and MBL regimes and that the clusters grow regardless of the cutoff. Next, we select an intermediate value of the cutoff icut = 0.5, in FIG. S3b) we analyze the average cluster size evolution in time and, like for neural networks, observe a logarithmic growth nav(t) =  log t + C in the MBL phase. We find no relation between the growth rates  of entanglement entropy and entanglement clusters because the latter strongly depend on the chosen threshold lcut.
In FIG. S4 we plot the histograms of entanglement cluster sizes in the ergodic, critical and MBL regime for uniform and quasiperiodic disorder. In the ergodic case, we notice the disappearance of initially large number of small clusters and the appearance of the power-law distribution p(n)  n-X with a peak for large clusters dominating the distribution after a long time evolution. In the critical regime, after the evolution, we detect a mixture of all cluster sizes. This is in agreement with the main result from the study of eigenstates [2], namely that at the critical point small entanglement clusters are entangled together to form larger clusters ­ choosing a constant cutoff we are able to observe clusters of nearly all sizes. In contrast, in the localized phase, the clusters become small and independent of each other, with the cluster distribution described by p(n)  exp(-n) without the thermal peak. All qualitative conclusions about the properties of the cluster distributions are thus in agreement with the NN results presented in the Letter. A one order of magnitude difference in the number of the smallest clusters is connected with the different meanings of ergodic and entanglement clusters, as described in the previous paragraph ­ between the two methods one can only compare the properties of the largest clusters.

FIG. S5. Anomalous realizations for uniform (first row) and quasiperiodic (second row) disorder for system size L = 16. At the same values of cutoffs as in the uniform disorder case, no anomalous realizations are detected at all. If the cutoffs are tuned to icut = 0.33, lcut = 0.09 (presented here) to obtain a similar number of anomalous realizations as in FIG. ??, these realizations are not as clearly distinguishable from the background as in the uniform disorder case (maybe except for a fraction of the high-entropy states detected by QMI).
Griffiths regions We can verify whether the anomalously large clusters, at large disorders, detected by the QMI clustering algorithm, have the same properties as the anomalously large clusters found by the neural network.
NEURAL NETWORK TRAINING
In the Letter we present results obtained using a network trained on evolutions corresponding to uniform disorder in the range W = 0.1 - 0.5, which we assume to be all ergodic. To perform a consistency check and verify how the input data affects the model performance, we also train models on larger values of disorder up to W = 1.0, as well as on quasiperiodic disorder of the same amplitudes.
Specifically, the training dataset consists of 100 realizations of disorder from the set called "w": W  {0.1, 0.2, . . . 0.5} or "W": W  {0.1, 0.2, . . . 1.0}. We train separately on disorders coming from the uniform (models called "U-w", "U-W") and quasiperiodic ("Qw", "Q-W") distributions, as shown in TABLE II. We

4

FIG. S6. Comparison of ergodic bubble size distributions obtained using neural networks trained on different input data (see TABLE II) at loss cutoff lcut = 0.15.

model name dist. of disorder values of disorder

"U-w"

uniform

{0.1, 0.2, . . . 0.5}

"U-W"

uniform

{0.1, 0.2, . . . 1.0}

"Q-w" quasiperiodic {0.1, 0.2, . . . 0.5}

"Q-W" quasiperiodic {0.1, 0.2, . . . 1.0}

TABLE II. Distributions and values of disorder used for training four classes of neural network models. At each value of disorder, time series of its 100 random realizations were used as input. From each model class, 30 neural networks were trained independently on the same data.

stop the training after a certain value 1.7 · 10-3 of the

validation loss is achieved. Validation data corresponds to 40 disorder realizations that the network does not use to tune the weights but only to terminate the training when the desired level of loss is achieved.
In FIG. S6 we present cluster size histograms similar to FIG. 4 from the Letter but for all considered models and only at the end of the evolution t = 1900. We observe that all networks except "U-W" give consistent results. We suspect that this is due to the fact that in the "U-W" training scenario some of the realizations contain non-ergodic features which spoil what the network learns about the ergodic ones.
It is important to note that the neural networks are trained on the L = 16 data only. They can later be applied to any system size L which is a strong advantage of the method. It is possible because the two-site correlations the network uses as an input are local observables characterizing a single site andd not the whole system of length L.
[S1] P. T. Dumitrescu, A. Goremykina, S. A. Parameswaran, M. Serbyn, and R. Vasseur, Phys. Rev. B 99, 094205 (2019).
[S2] L. Herviou, S. Bera, and J. H. Bardarson, Phys. Rev. B 99, 134205 (2019).

