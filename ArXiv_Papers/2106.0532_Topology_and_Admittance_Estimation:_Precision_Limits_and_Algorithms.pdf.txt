1
Topology and Admittance Estimation: Precision Limits and Algorithms
Yuxiao Liu, Student Member, IEEE, Ning Zhang, Senior Member, IEEE, Qingchun Hou, Student Member, IEEE, Audun Botterud, Member, IEEE, and Chongqing Kang, Fellow, IEEE

arXiv:2106.00532v1 [cs.IT] 1 Jun 2021

Abstract--Distribution grid topology and admittance information are essential for system planning, operation, and protection. In many distribution grids, missing or inaccurate topology and admittance data call for efficient estimation methods. However, measurement data may be insufficient or contaminated with large noise, which will introduce fundamental limits to the estimation accuracy. This work explores the theoretical precision limits of the topology and admittance estimation (TAE) problem, with different measurement devices, noise levels, and the number of measurements. On this basis, we propose a conservative progressive self-adaptive (CPS) algorithm to estimate the topology and admittance. Results on IEEE 33 and 141-bus systems validate that the proposed CPS method can approach the theoretical precision limits under various measurement settings.
Index Terms--Distribution grids, topology estimation, admittance estimation, data-driven, Newton-Raphson method.
I. INTRODUCTION
The vast integration of distributed energy resources and electric vehicles raise both economic and security concerns to modern distribution grids [1]. Smart grid operations such as state estimation (SE), demand response, voltage control, and pricing are increasingly implemented at the distribution level. However, accurate grid topology and line admittance, which are the pre-requisite for the above operations, are often unavailable in many medium and low-voltage distribution grids. Therefore, efficient and accurate topology and admittance estimation (TAE) is essential in future distribution grids.
Many efforts have been made to estimate distribution grid topology and admittance. Most of the works use the data collected from the advanced metering infrastructures (AMIs) or the micro-phasor measurement units (µPMUs). Some researches that only focus on topology identification use the statistical information of voltage magnitudes, such as the covariances [2], the mutual information [3], and the conditional independence test [4]. Other researches address the joint estimation of topology and the line admittance, by formulating the problem as the maximum likelihood estimation [5]­[9]. The above works often make some assumptions to simplify the problem, including uncorrelated nodal power/current injections [3], [4], [10], [11], radial network topologies [2], [8], [10]­[13], sufficient phasor measurements [5], [6], [8], [9], or accurate voltage measurements [7]. Those assumptions may hold in some cases, but hinder the practical implementation under more general distribution system cases. For instance, the power/current injections can be highly correlated because of similar electricity consumption or rooftop solar PV generation patterns [14]. The distribution grids may contain loops or even

be heavily meshed [15]. The measurement devices may not be sufficient in the distribution level, especially for the µPMUs that contain phasor information [16].
In fact, the TAE in distribution grids is extremely challenging because of the poor measurements and the nonconvexity of power flow models. It still remains an open question whether the distribution grid is observable with some specific measurement devices and measurement precisions. Some recent works discuss the fundamental limits of the TAE problem. Moffat et al. proved that the admittance matrix cannot be estimated without any prior knowledge when the system contains some zero power injection buses [8]. Still, they do not consider any physical knowledge (e.g. the admittance matrix is symmetric and sparse) that could largely improve the estimation results. Li et al. provided a theoretical relationship among the number of measurements, the prior knowledge, and the probability of estimation error [9]. They proved a worstcase sample complexity for the linear graph learning task, i.e., how much data is required to guarantee a certain accuracy (with probability). The above researches [8], [9] only address the estimation limits for linear learning tasks. That is, the voltage and current magnitudes and angles are assumed to be available at all buses so that the estimation problem can be formulated by the linear Ohm's law. Grotas et al. proposed the lower bound for the transmission grids under the DC power flow (DCPF) setting [17]. The DCPF approximation simplifies the problem but introduces great error for the estimation problem. Further, the DCPF approximation even incurs larger error in distribution grids, because of the high ratio of R/X and also requires the phasor measurements.
This work addresses a more practical setting: to derive the theoretical precision limits with different measurement devices and measurement precisions. We first derive the Crame´r-Rao Lower Bound (CRLB) [18] that can evaluate the best possible TAE precisions under given measurement devices, noise levels, and the number of data. Then, we show that to design an efficient algorithm for the TAE problem is mathematically difficult. The TAE problem is far more memory consuming, ill-conditioned, and non-convex compared with the traditional SE problem [19]. Some traditionally well-behaved methods can easily diverge (the Newton's method) or suffer from an extremely slow converge speed (gradient-based methods), even under a simple 3-bus case. Furthermore, we propose an algorithm for the TAE problem. The method contains a first-order optimizer and a second-order optimizer in order to combine stability (or conservative) and fast convergence

2

(or progressive) features with one method. The method also contains a hybrid line search strategy to self-adaptively tune the weights of the first-order and second-order optimizer. To this end, we name the proposed algorithm the conservative progressive self-adaption (CPS) algorithm. Case studies on IEEE 33 and 141-bus systems show that the proposed CPS method can approach the theoretical precision limits under different experimental settings.
This work focuses on systems with a balanced power flow setting and Gaussian measurement noise. The framework can be extended to address the unbalanced three-phase estimation problem and some non-Gaussian noise. We also do not consider active injection approaches [20], [21], because they require sufficient active devices (e.g. smart inverters) and may not be compliant with the grid code [22].
In short, the contributions of this work are as follows:
1) We quantify the theoretical precision limits for the distribution grids' TAE problem. The proposed method identifies precision limits given different measurement devices, noise levels, number of measurements, and prior topology knowledge.
2) We propose the CPS algorithm that is specially designed for the memory-heavy, ill-conditioned, and non-convex estimation problem. The method can approach the theoretical precision limits under a lack of voltage angle measurements and different levels of measurement noise.
The remainder of this paper is organized as follows. Section II introduces how to evaluate the precision limits for the TAE problem. Section III demonstrates the proposed CPS algorithm. Section IV provides case studies. Finally, section V draws the conclusions.

II. PRECISION LIMITS FOR TOPOLOGY AND ADMITTANCE ESTIMATION
A. Problem Formulation
The TAE of a distribution grid can be formulated as a maximum likelihood problem using the AC power flow equations.

min
Gij ,Bij ,V^it,^it

T t=1 iMP

(Pit -P^it)2 P2 i

+
iMQ

(Qti -Q^ti)2 Q2 i

+
iMV

(Vit -V^it)2 V2i

+
iM

(it

-^it 2i

)2

,

(1a)

N
with P^it = V^it V^jt Gij cos ^itj + Bij sin ^itj ,
j=1
(1b)
N
Q^ti = V^it V^jt Gij sin ^itj - Bij cos ^itj ,
j=1

where Gij/Bij denote the (i,j)th element of conductance/susceptance matrix, Pit/Qti denote the active/reactive power injection measurements of bus i snapshot t, Vit/it
denote the voltage magnitude/angle measurements of bus i snapshot t, P^it/Q^ti/Vit/it denote the evaluated value of Pit/Qti/Vit/it, Pi /Qi /Vi /i denote standard deviations

of the corresponding measurements, and MP /MQ/MV /M denote the bus sets that the corresponding P/Q/V / measure-
ments are available, respectively. In the above problem (1), the estimation of Gij and Bij is equivalent to the estimation of topology and admittance, where zero values denote the
disconnection of two buses and non-zero values denote the admittance. We also recover all the state variables Vit and it as a by-product. The objective function (1a) minimizes the
weighted squared loss of the data from the measurement sets MP /MQ/MV /M. The measurement sets can be any combinations of the buses in the distribution grid, from the universe to the empty set. The standard deviations Pi /Qi /Vi /i reflect the precisions of different measurements. The estimated values P^it/Q^ti/Vit/it satisfy the AC power flow equations in (1b). By neglecting the shunt admittance in the distribution grid [5], [8], Gij and Bij become:

Gij = Gji = -gij , Gii = gij ,

(2a)

j

Bij = Bji = -bij , Bii = bij ,

(2b)

j

where gij/bij denote the conductance/susceptance of line (i, j).

We then provide a general formulation of the estimation model. We formulate all the measurements as an M ×1 vector z:

T
z = Pit iMP Qti iMQ Vit iMV it iM t=1T . (3)
Similarly, we define vector  with each element corresponding

to the standard deviation of measurement z. The estimated

variables contain not only the voltage states but also the network admittances, with the S × 1 state vector x formulated

as:

x = {gij }(i,j)ST{bij }(i,j)ST

T

V^it

^it

,

iSB

iSB t=1T

(4)

where ST denotes the set of possible connected buses, and SB denotes the set of all the buses. If no prior topology information is available, ST contains all of the possible branches between any two buses. From (1)-(4), we get the

measurement model of the TAE problem:

z = h(x) + ,

(5)

where denotes the M × 1 vector of measurement error.

B. Geometric Illustration
As shown in Section II-A, the estimation problem is an unconstrained nonlinear optimization problem, which belongs to the same category as the power system SE problem. However, the TAE problem is much more difficult to solve such that the traditional methods used for SE problems have very poor performance on TAE problems.
In Fig. 1, we provide an illustrative example of why the TAE problem is much more difficult to solve than the SE problem: 1) the TAE problem is more non-convex because

3

(a)

(b)

(c)

(d)

Fig. 1. Geometric illustration of SE problem and TAE. The 2-D space denotes the parameter space. The black lines are contour lines of the loss function value. The blue dashed lines represent the local second-order Taylor approximations. (a) First-order optimization for SE. (b) First-order optimization for TAE. (c) Second-order optimization for SE. (d) Second-order optimization for TAE.

much more variables (both the model parameters and the state variables) are unknown and should be optimized. The multiplications of more decision variables, as shown in (1b), incur more severe non-convexity. 2) the TAE problem is more ill-conditioned than the SE problem. The decision variables in the TAE problem have very different scales. For example, the voltage magnitudes are often around 1 p.u. and the voltage angles are often below 1.0 rad. However, the admittance in distribution grids can be very large (from 102 to more than 104), especially when the lines are short. As a result, the parameter space can have very different scales in different directions, which makes the problem ill-conditioned. Hence, we use a slightly non-convex contour map to represent the SE problem in Fig. 1 (a) and Fig. 1 (c). For comparison, we use a highly non-convex and ill-conditioned contour map to represent the TAE problem in Fig. 1 (b) and Fig. 1 (d).
There are two types of methods to solve the unconstrained differentiable optimization problem: the first-order optimizations (the gradient-based methods) and the second-order optimizations (the Newton or quasi-Newton-based methods) [23]. The first-order optimizations use the local gradient information and iteratively search the solution. With proper step length, the first-order optimization is stable because the direction of the gradient can reduce the loss function. Such strategy may work for SE problems as shown in Fig.1 (a), but may get trapped for the TAE problems as shown in Fig.1 (b). On the other hand, the second-order optimizations search the solution iteratively by using the information from the secondorder Taylor approximations. This kind of method is widely adopted and proved effective in SE problems [19]. It has a fast convergence speed for problem in Fig.1 (c). However, secondorder optimizations can easily diverge as shown in Fig.1 (d).

C. Crame´r-Rao Lower Bound
Since the TAE problem is rather difficult, we first estimate the precision limit to better evaluate the estimation result. We use the CRLB to estimate the precision limit of the TAE problem. The reason for using CRLB is that it can be applied to lower bound the estimation variances of any unbiased estimator [18], which is seldomly developed in power system analysis. Wang et al. derived the CRLB for the power system SE problem [24]. Grotas et al. derived the CRLB of TAE using a simplified linear DCPF model [17]. Damavandi et al. [25] and Xygkis et al. [26] developed the Fisher Information based approach, which is closely related to the CRLB thoery, for the meter placement problem. In this section, we derive the CRLB for the TAE problem, under the accurate non-linear AC power flow formulation. Compared with the existing problems [17], [24]­[26], it is a large-scale multiple snapshots non-linear estimation problem with unknown models and state variables.

Theorem 1 (Crame´r-Rao lower bound for topology and admittance estimation). For the estimation problem (5) with
 N (0, ), the covariance matrix C of any unbiased estimator of x satisfies:

C - F -1 0,

(6a)

with

F

= HT diag(-2)H,

H

=

h(x) xT ,

(6b)

where F denotes the S × S symmetric Fisher-information matrix [18], and  denotes the M × 1 vector of measurement noise standard deviations, respectively.

See Appendix A for the proof. Since C - F -1 is semi-
definite, the variance of x, which reflects the estimation precision, is lower bounded by the diagonal elements of F -1:

x  xcr = diag(F -1).

(7)

It can be intuitively interpreted that the more information the measurement z carries about the estimated state x, the lower variance the estimators can obtain.

D. Fisher-information Matrix Partition

The challenge of using CRLB for the TAE problem is that the dimension of the Fisher-information matrix is very large. For a N-bus distribution grid system, MT contains at most CN2 = N (N - 1)/2 elements, MV and M contain at most N elements. In this case, the number of state variables is S = N (N - 1) + 2N T . Simply estimating the 33-bus distribution system using 200 snapshots of measurement data, we have to calculate the Fisher-information matrix and its inverse with 14256 × 14256 dimension.
To address the heavy memory consumption challenge, we partition the Fisher-information matrix and calculate its inverse in a memory saving manner:

Faa Fa1 Fa2 ... FaT 

F=

Faa FaTv

Fav Fvv

 FaT1

=

 

FaT2

 

...

F11

F22

...



 

,

(8)





FaTT

FT T

4

where the subscript a corresponds to the admittance [{gij} {bij}] in (4), the subscript v corresponds to the voltage magnitudes and angles from all the snapshots [{{V^it}{^it}}t=1T ] in (4), and the subscript T corresponds to the voltage magnitudes and angles from snapshot T [{V^iT }{^iT }] in (4), respectively. Note that we formulate (8) in a symmetric way. From (8), we can observe that the Fisher-
information matrix is a sparse matrix because the voltage
states in different snapshots are decoupled. In other words,
the voltage measurements in one snapshot do not contain any
information about the voltage in any other snapshots. We can
take advantage of this feature and calculate the CRLB of
[{gij} {bij}] in a memory saving manner.

Theorem 2 (Crame´r-Rao lower bound with matrix partition). The covariance matrix Ca of any unbiased estimator of xa = {gij }(i,j)MT {bij }(i,j)MT satisfies:

Ca - Fa-1 0,

(9a)

T

with Fa = Faa - FatFt-t 1FaTt.

(9b)

t=1

Proof. The inverse of the Fisher-information matrix is:

F -1 =

Faa FaTv

Fav Fvv

-1
=

Iaa IaTv

Iav Ivv

.

(10)

From Theorem 1, the CRLB of xa is given by:

Ca - Fa-1 0, with Fa-1 = Iaa.

(11)

where Fa is the Schur complement of block Fvv:

Fa = Faa - FavFv-v1FaTv.

(12)

Since Fvv is a block diagonal matrix, we can compute the inverse in a decoupled way and finish the proof:

T

FavFv-v1FaTv =

FatFt-t 1FaTt.

t=1

(13)

to calculate the CRLB is largely reduced to S × S , S = N (N - 1) + 2N . Since we decouple the states from different snapshots, the space complexity does not increase with the increase of snapshots. We only need to compute the inverse of matrices with dimension of N (N - 1) × N (N - 1) (Faa) and 2N ×2N (Ftt). Recall the 33-bus example, the dimension of the matrices are 1056 × 1056 and 66 × 66, much smaller than 14256 × 14256.
III. CPS ALGORITHM A. Framework of the Algorithm
Fig. 3. The framework of the CPS algorithm.
The framework of the proposed CPS algorithm is shown in Fig.3. We first obtain an initial value of the admittance by evaluating a simplified model. Then we propose an optimizer that combines the advantages of both first-order optimizations and second-order optimizations. We take the advantage of the stability (or conservative) and the fast convergence (or progressive) from the two methods. We also propose a hybrid search strategy to self-adaptively tune the weights of the firstorder optimizer and the second-order optimizer. Afterward, we update the topology each time after the iteration converges. At last, we stop the algorithm when there is no need to update the topology. The following sections will describe the details of each step in the framework.

Fig. 2. The structure of the partitioned Fisher-information matrix. The CRLB

can be calculated in a memory saving manner.

Fig. 4. Geometric illustration of CPS method.

The structure of the Fisher-information matrix and way to In Fig.4, we also provide a geometric illustration of why the calculate the inverse is shown in Fig. 2. The required space CPS method can have good performance for the aforemen-

5

tioned highly non-convex and ill-conditioned problem. The CPS method is conservative by taking the gradient descent direction when the second-order solution is not stable and is progressive when the second-order solution largely reduces the loss function. In other words, the CPS method can automatically choose a proper "mode" between the first-order solution and the second-order solution.
B. Initial Value
The proposed CPS algorithm starts by obtaining an initial value of state vector x from the current measurements. Note that the measurement availabilities can be a large variety and there are no general methods to obtain the initial value under all the circumstances. Since the initial value do not require a mesh network setup or accurate parameters, we refer to [5], [7], [8], [10]­[12] for initial value estimation under various conditions. Even the initial values can be set as the values from the grid planning files [5]. In this work, we extend the method in [7], which is explained in Appendix B.

Algorithm 1 The First-order Optimization

Inputs: The last state vector xk-1 and the moment of the last iteration mk-1.

1: if the iteration step k = 1 then

2: Calculate the empirical CRLB using the initial value x0

and get xcr. Initialize m0 = x0. Get the mean value of xcr among admittances, voltage magnitudes, voltage angles, and get [wacr, wVcr, wcr]. 3: Set the moment ratio .

4: end if

5:

Calculate the corresponding

gradient by gk = mean absolute value

[wxagk,-w1 VLg o, wssg.].Get

the

6: Normalize and rescale the gradient by mk  [gak/wag ×

wacr, gVk /wVg × wVcr, gk/wg × wcr].

7: Update the moment mk = mk-1 + ( - 1)gk.

Outputs: The moment mk and the gradient gk.

g(F )-1 can be calculated in a memory saving manner:

C. First-order Optimization
The first-order optimization used in this work is modified from the adaptive moment estimation (Adam) optimizer [27], which is widely applied and most favored in the training of deep learning networks. The Adam optimizer combines the advantages of the momentum method and the root mean square propagation (RMSProp) method [27]. On the one hand, Adam uses the moving average of the gradient to prevent oscillations during iterations. On the other hand, Adam rescales the gradient by dividing the moving average of the squared gradients, so that the gradient of each variable is normalized to one or minus one.
On this basis, we improve the Adam in the way of rescaling the gradient. Adam rescales every gradient equally to one or minus one. However, the voltage magnitudes, angles, and admittances have very different scales and thus Adam can have a poor performance. Instead, we first normalize the gradient and use the approximated CRLB to rescale the gradient. The details are shown in Algorithm 1.

D. Second-order Optimization

The second-order optimization used in this work is modified from the Newton's method [19], [23].

xk = xk-1 - gk(F k)-1.

(14)

Different from the SE problem, the TAE problem is a mul-
tiple snapshots estimation problem. The challenge for the
Newton's method is the large memory consumption when calculating gk(F k)-1. We can derive from Theorem 2 that the gk(F k)-1 can also be calculated in a memory saving
manner.

d = -g(F )-1 = dTa dT1 dT2 ... dTT T ,

(16a)

T

T

with da = (Faa - FatFt-t 1FaTt)-1(ga - FatFt-t 1gt),

t=1

t=1

(16b)

dt = (Ftt - FaTtFa-a1Fat)-1(gt - FaTtFa-a1ga). (16c)

Note that for simplicity of notation, we drop the superscript of k that denotes the kth iteration.

Recall that the TAE problem is ill-conditioned caused by
different scales of admittance, voltage magnitudes and angles. The inversion of (Faa- Tt=1FatFttFaTt) may incur numerical instability in (16b). Therefore we use the Moore­Penrose
inverse [28] instead.

E. Hybrid Line Search
Neither the first-order optimization nor the second-order optimization can provide a stable and efficient search for the highly non-convex and ill-conditioned TAE problem. We provide a hybrid line search strategy to combine the advantages of the two optimization methods. This strategy is inspired by the Armijo­Goldstein condition [29], a.k.a., the backtracking line search. We modify the backtracking line search by adding the hybrid search strategy of first-order and second-order directions.

Proposition 3 (Second-order update with low memory consumption). For the Fisher-information matrix F in the form of (8) and the gradient vector in the form of

g = gaT gvT T = gaT g1T g2T ... gTT T ,

(15)

Fig. 5. Geometric illustration of hybrid search.

6

In detail, we first search for a step along the first-order direction that satisfies the Armijo­Goldstein condition. That is, we start with a large enough step and then iteratively decrease the step size until the decrease of the loss function is large enough corresponding to the step size (or satisfies the Armijo­Goldstein condition). It can guarantee a stable searching solution because the gradient direction will decrease the loss function with a sufficiently small step size. We then search the step along the line from the second-order result to the first-order result. Similarly, we start with assigning a larger weight to the second-order result and then iteratively decrease the weight of the second-order result and increase the first-order result, until the Armijo­Goldstein condition is satisfied. In this way, we maintain a large enough proportion of second-order optimizer as long as it is stable. The geometric illustration is shown in Fig.5.The details of the hybrid line search are shown in Algorithm 2.

Algorithm 2 The Hybrid Line Search

Inputs: The last state vector xk-1.

1: if the iteration step k = 1 then

2: Set the start ratio r0, the maximum ratio rmax, the

incremental ratio , and the stop threshold .

3: end if

4: Do Algorithm 1.

5: Get mk and gk.

6: r  r0.

7: while r  rmax do 8: xk  xk-1 + mk/r.

9: r  r + 1.

10: if Loss(xk-1) - Loss(xk)  (gk)T mk/r then

11:

mk  mk/r.

12:

Break.

13: end if

14: end while

15: Calculate dk from (16).

16: r  r0.

17: while r  rmax do 18: w1 = 1/(1 + r). w2 = r/(1 + r). 19: xk  xk-1 + w1mk + w2dk. 20: if Loss(xk-1) - Loss(xk)  (gk)T (w1mk + w2dk)

then

21:

xk-1  xk.

22:

mk  mk/r.

23:

Break.

24: end if

25: r  r + 1.

26: end while

Outputs: The vector of this state xk.

F. Update the Topology
We estimate the admittances of all possible bus pairs. Some pairs are disconnected and have zero admittances. Therefore, we should update the topology and set the branches with small admittances to zero. We use the method in Section III.B of [7] to set small admittances to zero. Since TAE is

a non-convex optimization, some non-zero admittances may approach zero temporally during the iterations. To this end, we only update the topology when the iteration converges. The converge criterion is:

max(|xk - xk-1|)  ,

(17)

where  is the iteration termination threshold. It is common that some prior topology information of the
distribution grids is available [7], [9], i.e., some bus pairs must be disconnected, so that we can set the corresponding admittances to zero during the iterations.

IV. CASE STUDY
The power load data are from the Commission for Energy Regulation in Ireland [30]. We simulate the power system operational data with the aid of MATPOWER 7.0 [31]. The simulation strategy is the same with [32]. Additive white Gaussian noise is then added to the data. In all our case studies, we set our hyper-parameters as:  = 0.9, r0 = -5, rmax = 20,  = 5,  = 0.01, and  = 10-5, respectively.

A. Convergence of the Optimizer

Fig. 6. The 3-bus system.
We first use a simple 3-bus system in Fig.6 to compare the convergence of the proposed method with other methods. We assume the topology of the 3-bus system is known and only estimates the admittance. We estimate the admittance with 50 snapshots of data, with P , Q, V measurements under 0.1% noise.

Fig. 7. The loss of 3-bus system during the iterations.
We compare the losses during iterations with three methods: the first-order optimization in Section III-C, the second-order optimization in Section III-D, and the proposed CPS algorithm. As shown in Fig.7, both the first-order and the secondorder optimization have very poor performances even with a very simple 3-bus system. The first-order optimization has a very slow converge speed. The loss is over 103 and fails to decrease after 10000 iterations. The second-order optimization

7

is not stable and the loss values oscillate in the range of 108  1010. However, the proposed CPS method converges in only 63 iterations with loss approaches to 3 × 102. The performance of the compared three methods can be well explained by the illustrations in Fig. 1 and Fig.4. The proposed CPS method shows extraordinary performance in the TAE problem.
B. The Bound Attainability
We then use the 12.66 kV 33-bus system [33] to demonstrate how well can the CPS method approaches the theoretical precision limits in Section II. We assume we have the P , Q, V ,  measurement from all the buses, with 0.1% measurement error. The snapshot of the measurement is 120. We run the CPS algorithm 100 times under different randomly generated measurement noise and obtain the mean absolute error. Under this setting, we can accurately estimate all the topologies. The histogram of the admittance estimation error is shown in Fig.8. We compare the estimation error of the first-order optimization, the second-order estimation, and the proposed CPS method. We also demonstrate the theoretical precision limit evaluated by the method in Section II. It can be concluded that the proposed CPS method is 13 orders of magnitudes more accurate than the compared methods. From the histogram of estimation error, the variance of the estimation error can approach the theoretical precision limit.
C. Different Settings
At last, we use the 33-bus system and the 141-bus system [34] to show the precision limits and the performance of the CPS algorithm under different settings. We compare the following different settings as shown in Table I. The experimental settings include the types of sensors, the noise level, and the prior topology knowledge. All the errors are transformed to a scale of 100%. We use the ratio of wrong branches number to the true branches number as the error of topology estimation. We use the relative geometric mean as the error of admittance estimation. The prior topology knowledge denotes only the connectivity of existing transmission lines or tie lines are unknown. That is, we know the disconnection of the branches that do not exist. As can be concluded from Table I, the proposed CPS method can approach the precision limits under various settings. Still, there are some fundamental limits from the results: 1) the estimation error will largely increase (more than one degree of magnitude) without the phasor measurements; 2) the prior topology knowledge is good compensation for poor measurements; 3) the estimation of the 141-bus system with larger admittances and more buses is far more difficult than the 33-bus system and requires more accurate measurements.
V. CONCLUSIONS
Our work quantifies the theoretical precision limits for the distribution grids TAE problem. We can identify the best possible estimation precisions under some specific measurement settings, i.e. different measurement devices, noise

levels, number of measurements, and prior knowledge. We also demonstrate the TAE problem is more difficult than the SE problem, in terms of the non-convexity and the illconditioning. For the TAE problem, the widely applied Adam or Newton method can fail even with a very simple 3-bus system. We propose a CPS algorithm to adaptively combine the stability of the first-order optimizer and the fast convergence of the second-order optimizer. We also enable large scale second-order optimization by decoupling the calculation from different snapshots. Case studies on IEEE 33 and 141bus systems validate the proposed CPS method can approach the theoretical precision limits under different settings. We also conclude some fundamental limits from our theory. For example, the estimation error will largely increase without phasor measurements and can be compensated by the prior topology knowledge. Future works will explore more theoretical relationships among the measurement devices, the measurement noise, the number of snapshots, and the prior knowledge.
REFERENCES
[1] B. Muruganantham, R. Gnanadass, and N. Padhy, "Challenges with renewable energy sources and storage in practical distribution systems," Renewable and Sustainable Energy Reviews, vol. 73, pp. 125­134, 2017.
[2] S. Bolognani, N. Bof, D. Michelotti, R. Muraro, and L. Schenato, "Identification of power distribution network topology via voltage correlation analysis," in 52nd IEEE Conference on Decision and Control. IEEE, 2013, pp. 1659­1664.
[3] Y. Weng, Y. Liao, and R. Rajagopal, "Distributed energy resources topology identification via graphical modeling," IEEE Transactions on Power Systems, vol. 32, no. 4, pp. 2682­2694, 2016.
[4] D. Deka, S. Backhaus, and M. Chertkov, "Estimating distribution grid topologies: A graphical learning based approach," in 2016 Power Systems Computation Conference (PSCC). IEEE, 2016, pp. 1­7.
[5] J. Yu, Y. Weng, and R. Rajagopal, "Patopa: A data-driven parameter and topology joint estimation framework in distribution grids," IEEE Transactions on Power Systems, vol. 33, no. 4, pp. 4335­4347, 2017.
[6] ----, "Patopaem: A data-driven parameter and topology joint estimation framework for time-varying system in distribution grids," IEEE Transactions on Power Systems, vol. 34, no. 3, pp. 1682­1692, 2018.
[7] J. Zhang, Y. Wang, Y. Weng, and N. Zhang, "Topology identification and line parameter estimation for non-pmu distribution network: A numerical method," IEEE Transactions on Smart Grid, 2020.
[8] K. Moffat, M. Bariya, and A. Von Meier, "Unsupervised impedance and topology estimation of distribution networks--limitations and tools," IEEE Transactions on Smart Grid, vol. 11, no. 1, pp. 846­856, 2019.
[9] T. Li, L. Werner, and S. H. Low, "Learning graphs from linear measurements: Fundamental trade-offs and applications," IEEE Transactions on Signal and Information Processing over Networks, vol. 6, pp. 163­178, 2020.
[10] D. Deka, M. Chertkov, and S. Backhaus, "Joint estimation of topology and injection statistics in distribution grids with missing nodes," IEEE Transactions on Control of Network Systems, 2020.
[11] S. Park, D. Deka, S. Backhaus, and M. Chertkov, "Learning with endusers in distribution grids: Topology and parameter estimation," IEEE Transactions on Control of Network Systems, 2020.
[12] X. Miao, M. Ilic´, X. Wu, and U. Mu¨nz, "Distribution grid admittance estimation with limited non-synchronized measurements," in 2019 IEEE Power & Energy Society General Meeting (PESGM). IEEE, 2019, pp. 1­5.
[13] J. Zhao, L. Li, Z. Xu, X. Wang, H. Wang, and X. Shao, "Full-scale distribution system topology identification using markov random field," IEEE Transactions on Smart Grid, 2020.
[14] H. Xu, A. D. Dom´inguez-Garc´ia, and P. W. Sauer, "Data-driven coordination of distributed energy resources for active power provision," IEEE Transactions on Power Systems, vol. 34, no. 4, pp. 3047­3058, 2019.

8

(a)

(b) Fig. 8. The histogram of the admittance estimation error. (a) The error of line conductance. (b) The error of line susceptance.

TABLE I THE THEORETICAL PRECISION LIMITS AND THE PERFORMANCE OF CPS UNDER DIFFERENT SETTINGS.

System
33-bus 33-bus 33-bus 33-bus 33-bus 141-bus 141-bus

Snapshots
120 120 120 120 120 200 200

Sensors
P , Q, V ,  P , Q, V ,  P , Q, V ,  P , Q, V ,  P , Q, V P , Q, V ,  P , Q, V

Noise
0.1 0.2 0.2 0.5 0.1 0.1 0.01

Prior topology knowledge
No Yes No Yes Yes Yes Yes

Topology precision limits
0 0 3.125 0 0 0 0

Estimated topology precision
0 0 3.125 0 0 0 0

Admittance precsion limits
0.264 0.475 0.701 1.188 28.711 2.346 21.747

Estimated admittance precision
0.236 0.521 0.746 1.370 29.805 2.823 33.625

[15] J. P. A. Sandraz, R. Macwan, M. Diaz-Aguilo´, J. McClelland, F. De Leon, D. Czarkowski, and C. Comack, "Energy and economic impacts of the application of cvr in heavily meshed secondary distribution networks," IEEE transactions on power delivery, vol. 29, no. 4, pp. 1692­1700, 2014.
[16] S. Bhela, V. Kekatos, and S. Veeramachaneni, "Enhancing observability in distribution grids using smart meter data," IEEE Transactions on Smart Grid, vol. 9, no. 6, pp. 5953­5961, 2017.
[17] S. Grotas, Y. Yakoby, I. Gera, and T. Routtenberg, "Power systems topology and state estimation by graph blind source separation," IEEE Transactions on Signal Processing, vol. 67, no. 8, pp. 2036­2051, 2019.
[18] S. M. Kay, Fundamentals of statistical signal processing. Prentice Hall PTR, 1993.
[19] A. Abur and A. G. Exposito, Power system state estimation: theory and implementation. CRC press, 2004.
[20] M. Liserre, F. Blaabjerg, and R. Teodorescu, "Grid impedance estimation via excitation of lcl-filter resonance," IEEE Transactions on Industry Applications, vol. 43, no. 5, pp. 1401­1407, 2007.
[21] G. Cavraro and V. Kekatos, "Inverter probing for power distribution network topology processing," IEEE Transactions on Control of Network Systems, vol. 6, no. 3, pp. 980­992, 2019.
[22] X. Miao, X. Wu, U. Mu¨nz, and M. Ilic´, "Multi-layered grid admittance matrix estimation for electric power systems with partial measurements," in 2019 American Control Conference (ACC). IEEE, 2019, pp. 1288­ 1294.
[23] S. Boyd, S. P. Boyd, and L. Vandenberghe, Convex optimization. Cambridge university press, 2004.
[24] G. Wang, A. S. Zamzam, G. B. Giannakis, and N. D. Sidiropoulos, "Power system state estimation via feasible point pursuit: Algorithms

and crame´r-rao bound," IEEE Transactions on Signal Processing, vol. 66, no. 6, pp. 1649­1658, 2018. [25] M. G. Damavandi, V. Krishnamurthy, and J. R. Mart´i, "Robust meter placement for state estimation in active distribution systems," IEEE Transactions on Smart Grid, vol. 6, no. 4, pp. 1972­1982, 2015. [26] T. C. Xygkis, G. N. Korres, and N. M. Manousakis, "Fisher informationbased meter placement in distribution grids via the d-optimal experimental design," IEEE Transactions on Smart Grid, vol. 9, no. 2, pp. 1452­1461, 2016. [27] D. P. Kingma and J. Ba, "Adam: A method for stochastic optimization," arXiv preprint arXiv:1412.6980, 2014. [28] A. Ben-Israel and T. N. Greville, Generalized inverses: theory and applications. Springer Science & Business Media, 2003, vol. 15. [29] L. Armijo, "Minimization of functions having lipschitz continuous first partial derivatives," Pacific Journal of mathematics, vol. 16, no. 1, pp. 1­3, 1966. [30] CER Smart Metering Project--Electricity Customer Behaviour Trial, 2009-2010, Commission for Energy Regulation, Dublin, Ireland, 2012. [31] R. D. Zimmerman, C. E. Murillo-Sa´nchez, and R. J. Thomas, "Matpower: Steady-state operations, planning, and analysis tools for power systems research and education," IEEE Transactions on power systems, vol. 26, no. 1, pp. 12­19, 2010. [32] Y. Liu, N. Zhang, Y. Wang, J. Yang, and C. Kang, "Data-driven power flow linearization: A regression approach," IEEE Transactions on Smart Grid, vol. 10, no. 3, pp. 2569­2580, 2018. [33] M. E. Baran and F. F. Wu, "Network reconfiguration in distribution systems for loss reduction and load balancing," IEEE Power Engineering Review, vol. 9, no. 4, pp. 101­102, 1989. [34] H. Khodr, F. Olsina, P. De Oliveira-De Jesus, and J. Yusta, "Maximum savings approach for location and sizing of capacitors in distribution

9
systems," Electric Power Systems Research, vol. 78, no. 7, pp. 1192­ 1203, 2008.

10

APPENDIX A PROOF OF THEOREM 1

The negative log-likelihood distribution of problem (5) is the multiplication of the following Gaussian distributions:

M1 p(z, x) = - ln  exp
m=1 2

-

(zm

- hm(x))2 2m2

(18a)

M
=
m=1

(zm

- hm(x))2 2m2

+

ln(2m2 ) 2

.

(18b)

The Fisher information matrix is defined as the expectation of the Hessian matrix of p(z, x):

2 F = Ex xT x p(z, x)

(19a)

= Ex

M xT
m=1

-

zm

- hm(x) m2

×

hm(x) x

(19b)

= Ex

M m=1

1 m2

×

2hm(x) xT x

[1

-

(zm

-

hm(x))]

.

(19c)

Since the Gaussian noise distribution is symmetric to zero, the expectation of zm -hm(x) over the whole distribution is zero. Therefore, we have:

hT (x) 1 h(x)

F = x × m2 × xT .

(20)

According to the CRLB [18], the covariance matrix is lower bounded by the inverse of Fisher information matrix.

voltage magnitudes to decrease the influence of measurement

noise:

V^i1

=

1 l

l

Vit.

(21)

t=1

Lastly, we use the correlation coefficient to construct the topology. It is under the assumption that the voltage magnitudes of the connected buses are highly correlated [3], [10]. See Algorithm 3 for details. Note that the proposed method may not obtain an accurate result because the assumptions may not be satisfied in practice. However, Algorithm 3 only provides an initial value and the inaccuracy can be corrected in the following iterations. Further, some recent works also provide some topology estimation methods [3], [10], [13] and can be used to obtain the initial topology.

Algorithm 3 Tree Structure Topology Construction
Inputs: The voltage magnitude measurements of different buses [V1, ..., Vi, ..., VN ].
1: Initialize the topology set ST = . Sort the average voltage magnitudes in a descending order [Vd1, ..., Vdi, ..., VdN ].
2: Get the l moving average of the voltage magnitudes [V^d1, ..., V^di, ..., V^dN ].
3: for i = 2  N do 4: Get the bus j with maximum correlation coefficient
arg maxj1i-1 Corr(V^di, V^dj ). 5: ST  (di, dj). 6: end for
Outputs: The topology set ST .

We then estimate line admittance by introducing an approximate power flow formulation without voltage angles.

APPENDIX B METHOD TO OBTAIN THE INITIAL VALUE
We extend the method in [7] to obtain the initial value, assuming there are power injection measurements (Pit, Qti) and voltage magnitude measurements Vit. The reason for this setting is the phasor measurements it are usually not available in distribution grids. We also assume the topology is radial at the initial stage, which can be relaxed in the following iteration stages. The initial value of x begins by setting the voltage magnitudes measurement as the initial value of [{V^it}]. Then, we estimate an initial value of [{gij} {bij}] from the Pit, Qti, and Vit measurements. At last, we obtain the initial value of [{^it}] by the DC power flow calculation.
The main difficulty is how to estimate the [{gij} {bij}] without the voltage angle measurements.
We start by estimating a radial topology using the voltage magnitudes by a tree structure topology construction. We use the average value of the voltage magnitudes to obtain the root-leaf relationship of the distribution grids. We assume the voltage magnitudes are decreasing from the root to the leaf nodes. We can only use the measurements at the night to avoid the possible bidirectional power flow caused by distributed PV generation. We then calculate the moving average of the

Theorem 4 (Phasor-free power flow). The power flow equations can be approximated as (22) under the assumption that ij = Pij/Qij is a constant and sin ij  ij.

Pi/Vi = (Vi - Vj )/zi#j ,

(22a)

Qi/Vi = (Vi - Vj)/(zi#j ij),

(22b)

with the augmented impedance zi#j defined as:

zi#j

=

gij - gi2j

bij /ij + b2ij

.

(23)

Proof. The branch flow equations are formulated as:

Pi/Vi = (Vi - Vj cos ij )gij - Vj sin ij bij  (Vi - Vj cos ij )gij - Vj ij bij ,

(24a)

Qi/Vi = -(Vi - Vj cos ij )bij - Vj sin ij gij  -(Vi - Vj cos ij )bij - Vj ij gij ,

(24b)

where we use the assumption sin ij  ij. (24a) × bij + (24b) × gij is:

Pij bij Vi

+

Qij gij Vi

= -(b2ij + gi2j )ij ,

(25a)

11

1

ij

=

- Vi

bij Pij b2ij + gi2j

+

gij Qij b2ij + gi2j

.

(25b)

Substitute (25b) into (24a) and substitute (25b) into (24b):

Pij Vi

=

gi2j + b2ij gij - i-j1bij

(Vi

-

Vj ),

Qij Vi

=

- gi2j + b2ij bij - ij gij

(Vi

-

Vj ),

(26a) (26b)

where ij = Pij /Qij .
Afterwards, we can estimate the value of 1/zi#j and 1/(z[#ij]ij) by the least squares estimation and set them as the initial value of gij and bij, respectively.

gij = (Pi/Vi)T (Vi - Vj)/[(Vi - Vj)(Vi - Vj)T )], (27a)

bij = (Qi/Vi)T (Vi - Vj)/[(Vi - Vj)(Vi - Vj)T )]. (27b)

