1
Distance and Position Estimation in Visible Light Systems with RGB LEDs
Ilker Demirel and Sinan Gezici

arXiv:2106.00396v1 [cs.IT] 1 Jun 2021

Abstract--In this manuscript, distance and position estimation problems are investigated for visible light positioning (VLP) systems with red-green-blue (RGB) light emitting diodes (LEDs). The accuracy limits on distance and position estimation are calculated in terms of the Crame´r-Rao lower bound (CRLB) for three different scenarios. Scenario 1 and Scenario 2 correspond to synchronous and asynchronous systems, respectively, with known channel attenuation formulas at the receiver. In Scenario 3, a synchronous system is considered but channel attenuation formulas are not known at the receiver. The derived CRLB expressions reveal the relations among distance/position estimation accuracies in the considered scenarios and lead to intuitive explanations for the benefits of using RGB LEDs. In addition, maximum likelihood (ML) estimators are derived in all scenarios, and it is shown that they can achieve close performance to the CRLBs in some cases for sufficiently high source optical powers.
Index Terms­ CRLB, estimation, LED, positioning, RGB, visible light.
I. INTRODUCTION
Visible light positioning (VLP) systems have attracted significant attention in recent studies due to their low-cost and high-accuracy characteristics ( [2], [3], and references therein). In addition, they incur very low deployment cost as they are already employed for illumination. VLP systems with high localization accuracy can facilitate various applications such as real-time robot control, patient monitoring, and warehouse management [4]­[6].
Among various theoretical and experimental studies related to VLP systems, a group of them focuses on determination of accuracy limits related to distance and position estimation [7]­ [13]. Accuracy limits provide theoretical performance bounds for a large class of estimators (such as unbiased estimators) and they can present guidelines for system design under specific accuracy requirements. In [7], the Crame´r-Rao lower bound (CRLB) is obtained for distance estimation based on the time-of-arrival (TOA) parameter in a synchronous VLP system and the dependence of the CRLB on various system parameters is investigated. In [8], the CRLB is derived for distance estimation in an asynchronous VLP system, where the distance related information in the received signal strength (RSS) parameter is utilized. The work in [9] focuses on the distance estimation problem for both synchronous and asynchronous VLP systems, and considers the cases of known and unknown channel attenuation formulas at the visible
I. Demirel and S. Gezici are with the Department of Electrical and Electronics Engineering, Bilkent University, 06800, Ankara, Turkey, Tel: +90-312-290-3139, Fax: +90-312-266-4192, Emails: ilkerd@ee.bilkent.edu.tr, gezici@ee.bilkent.edu.tr
Part of this research was presented at the IEEE 30th Annual International Symposium on Personal, Indoor and Mobile Radio Communications (PIMRC), Istanbul, Turkey, Sep. 8-11, 2019 [1].

light communication (VLC) receiver. It is shown that the distance related information contained in the TOA parameter (which can be utilized in the presence of synchronization) increases with the effective bandwidth of the transmitted optical waveform. Therefore, synchronous VLP systems can provide performance improvements over asynchronous ones only for sufficiently high effective bandwidths.
Regarding the position estimation problem in visible light systems, both theoretical limits and practical estimators are investigated in a multitude of studies such as [13]­[21]. In [14], the CRLB is derived for three-dimensional localization in an indoor VLP system based on RSS information by considering a generic configuration for LED transmitters and VLC receiver. In [15] and [16], two-dimensional RSS-based localization is studied under the assumption of a known receiver height, and an analytical CRLB expression is derived in the considered setting. The work in [13] provides the CRLBs for three dimensional position estimation in synchronous and asynchronous VLP systems by employing RSS and/or TOA parameters. In addition, it presents the maximum likelihood (ML) estimators for synchronous and asynchronous settings by employing direct and two-step positioning approaches. Instead of the RSS and TOA parameters, angle-of-arrival (AOA), time-difference-of-arrival (TDOA), or a combination of multiple parameters are employed in [14], [22]­[26] for position estimation in visible light systems. For example, both AOA and RSS parameters are utilized in [14] to perform threedimensional localization of VLC receivers. By taking a direct positioning approach, [18] proposes an asynchronous VLP system in which a Bayesian signal model is constructed for position estimation based on the entire received signal from multiple LEDs in the presence of obstruction of signals from several LEDs.
Although the theoretical limits on distance and position estimation and corresponding ML estimators are investigated for VLP systems with white LEDs in [7]­[11], [13], they are not available for VLP systems with red-green-blue (RGB) LEDs in the literature. Since RGB LEDs can provide additional benefits for visible light systems [27], [28], analysis of theoretical limits and derivation of ML estimators are crucial for VLP systems with RGB LEDs, as well. The aim of this manuscript is to provide a detailed analysis of the position estimation problem in visible light systems with RGB LEDs. We focus on three scenarios where Scenario 1 and Scenario 2 correspond to synchronous and asynchronous systems, respectively, with known channel attenuation formulas at the receiver. In Scenario 3, a synchronous system is considered but channel attenuation formulas are not known at the receiver. For all of these scenarios, we first focus on the distance estimation

2

problem for VLP systems with RGB LEDs by considering a specific setting with a known VLC receiver height, and derive the CRLBs and ML estimators. Then, we consider the generic three-dimensional localization problem for visible light systems with RGB LEDs and derive the CRLBs and ML estimators. The provided CRLB expressions and ML estimators generalize the ones in the literature [9], [13] as there exist three parallel channels in RGB based VLP systems. In addition, Scenario 3, which is not considered in [13], is investigated for VLP systems with both white and RGB LEDs. The main contributions and novelty of this manuscript can be summarized as follows:
· The CRLBs and the ML estimators are derived for distance estimation in VLP systems with RGB LEDs for the first time in the literature. The obtained results generalize those in [9] to VLP systems with RGB LEDs and reveal the benefits of employing RGB LEDs for distance estimation.
· The CRLBs and the ML estimators are derived for generic three-dimensional position estimation in VLP systems with RGB LEDs for the first time in the literature. In this way, not only the results in [13] are extended to VLP systems with RGB LEDs but also a synchronous scenario with unknown channel attenuation formulas (Scenario 3) is investigated, which is not considered in [13].
· Via the derived CRLB expressions, the relations among the distance/position estimation accuracies are revealed in the considered scenarios and the benefits of using RGB LEDs can be quantified.
In addition, numerical examples are provided to illustrate the theoretical results and to compare the performance of the ML estimators against the corresponding CRLBs in various scenarios. (In the conference version of this manuscript [1], only the distance estimation problem was investigated for VLP systems with RGB LEDs.)
The remainder of the manuscript is organized as follows: Section II introduces the VLP system model with RGB LEDs. Then, the derivations of the CRLBs and ML estimators for distance estimation are performed in Section III. In Section IV, the general case of three-dimensional localization is investigated by deriving CRLBs and ML estimators. The numerical examples are presented in Section V, which are followed by the concluding remarks in Section VI.

II. SYSTEM MODEL

Consider a VLP system that consists of NL LED transmit-

ters at known locations (e.g., on the ceiling of a room) and

a VLC receiver at an unknown location. The VLC receiver

estimates its location by utilizing the signals emitted by the

LED transmitters (i.e., self-positioning [29]). Let lr  R3 and lkt  R3 represent the locations of the VLC receiver and the kth LED transmitter, respectively, where k  {1, . . . , NL}.

Each LED transmitter can emit red, green, and blue signals

(colors), which are denoted by ski (t) for i  C and k  {1, . . . , NL} with

C {r, g, b}

(1)

The VLC receiver processes the incoming optical signals from the LED transmitters via three parallel photodetectors (PDs) corresponding to red, green, and blue signals. It is assumed that a certain type of a multiple access protocol is employed at the VLC receiver so that signals from the LED transmitters can be processed separately [13], [30]. Accordingly, the following electrical signals are observed at the VLC receiver:

yjk(t) = hkj,i ski t -  k + jk(t)

(2)

iC

for k  {1, . . . , NL}, j  C and t  [T1k,j, T2k,j], where T1k,j and T2k,j specify the observation interval for PD j related to the signal coming from the kth LED transmitter, hkj,i is the overall channel attenuation factor for PD j and the ith signal (color) of the kth LED transmitter (hkj,i > 0),  k is the TOA parameter related to the kth LED transmitter, and jk(t) is the noise at PD j during the reception of the signal from the kth
LED transmitter. The noise terms jk(t) in (2) are modeled as zero-mean
white Gaussian random processes with a spectral density level of j2, which are assumed to be independent for all k  {1, . . . , NL} (due to the use of a multiple access protocol [13], [30]) and for all j  C (due to the processing at different branches of the VLC receiver). The transmitted signals ski (t) are nonzero over an interval of [0, Tsk,i] for k  {1, . . . , NL} and i  C, and they are assumed to be known by the VLC
receiver. Also, the TOA parameter in (2) can be expressed as

k =

lr - lkt c

2 + k

(3)

where c denotes the speed of light and k is the time offset between the clocks of the kth LED transmitter and the VLC receiver. For synchronous VLP systems, k = 0 for all k  {1, . . . , NL}, whereas k's are unknown parameters for asynchronous VLP systems. As in [9], it is assumed that a
coarse acquisition is performed such that the signal component in (2) resides completely in the observation interval [T1k,j, T2k,j] for k  {1, . . . , NL} and j  C.
As in [7], [8], [13], a line-of-sight scenario is considered
and the overall channel attenuation factors in (2) are modeled
as [19], [31]­[33]

hkj,i

=

- (mk

+ 1)Aj 2

[(lr

-

lkt )T nkt ]mk (lr - lr - lkt mk+3

lkt )T nr

R~j,i

(4)

for i, j  C and k  {1, . . . , NL}, where mk is the Lambertian

order for the kth LED transmitter, Aj is the area of PD j, nr

and and

nkt the

denote the orientation kth LED transmitter,

vectors for the VLC receiver respectively, and R~j,i is the

responsivity of PD j to the ith signal (color).

III. DISTANCE ESTIMATION
Before investigating the general case of three-dimensional localization, we first focus on a special scenario in which the VLC receiver performs distance (range) estimation with each of the LED transmitters, and then determines its twodimensional location based on those distance estimates [9].

3

In this scenario, accuracy of distance estimation is the main

factor that determines the accuracy of location estimation [9,

Sec. VI]. Therefore, the purpose in this section is to determine

the accuracy limits of distance estimation for VLP systems

with RGB LEDs, which has not been investigated in the

literature.

As the aim is to estimate the distance between each LED

transmitter and the VLC receiver, we focus on one LED

transmitter and drop the index k (superscript k) from the

parameters in Section II. The system model for this scenario is

shown in Fig. 1, and the distance between the LED transmitter

and the VLC receiver is represented by x, which is given by

x = lr - lt 2. As in [7]­[9], [34], it is assumed in this section that the LED transmitter points downwards (which is

a common scenario) and the VLC receiver points upwards such

that nr in (4),

= -nt where

= ~h

[0 0 1] and -(lr-lt)T nr = denotes the height of the

(lr-lt)T nt = h~ LED transmitter

relative to the VLC receiver. In addition, it is assumed similarly to [7]­[9], [34] that h~ is known by the VLC receiver;

that is, possible locations of the VLC receiver are confined

to a two-dimensional plane (e.g., to the floor of a room).

This assumption is made (only in this section) to provide

intuitive and clear explanations for accuracy limits of distance

estimation in VLP systems with RGB LEDs. (It also holds

in many practical scenarios; e.g., when the VLC receiver is

attached to a warehouse vehicle or a robot; see Fig. 3 in [4]).

Under these assumptions, the channel attenuation factors in

(4) can be expressed as

hj,i

=

Aj(m + 2x2

1)

h~ x

m+1
R~j,i

j,i x-m-3

(5)

for i, j  C, where j,i Aj (m + 1)h~m+1R~j,i/(2).

A. Theoretical Limits for Distance Estimation

In this section, accuracy limits of distance estimation are investigated for VLP systems with RGB LEDs under various scenarios.
1) Scenario 1: Synchronous System with Known Channel Attenuation Formula: In this scenario, it is assumed that the LED transmitter and the VLC receiver are synchronized; hence,  = 0 in (3). In addition, the VLC receiver is assumed to know the channel attenuation formula in (5) with j,i's being known constants. (In practice, j,i's can be learned via calibration by placing the VLC receiver at known distances.) Under these assumptions, the log-likelihood function corresponding to the received signals in (2) (for only one LED transmitter) can be expressed, based on (3) with  = 0 and (5), as follows:

(x)

=

K~ -

jC

1 2j2

T2,j T1,j

yj (t)

(6)

-

j,i x-m-3 si

t

-

x c

2
dt

iC

where K~ is a constant that does not depend on x.

The CRLB provides a lower limit on MSEs of unbiased es-

timators and can be obtained from the log-likelihood function

as follows:

CRLB1 = E

d(x) 2 dx

-1

(7)

From (6), the CRLB in (7) can be derived as

CRLB1 =

1 jC j2

T2,j T1,j

x-m-4

j,i

iC

× (m + 3)si(t - x/c) + (x/c)si(t - x/c)

2

-1

dt

(8)

where si(t) denotes the derivative of si(t). After some manipulation, (8) can be expressed as

CRLB1 =

(m

+

3)2 x-2m-8 

+

x-2m-6 c2



+

2(m + c

3) x-2m-7

-1

(9)

where



jC

1 j2

iC

lC

j,i j,l Ei,l



jC

1 j2

iC

lC

j,i j,l Ei,l



jC

1 j2

iC

lC

j,i j,l Ei,l

(10) (11) (12)

with



Ei,l

si(t)sl(t)dt

(13)

-



Ei,l

si(t)sl(t)dt

(14)

-



Ei,l

si(t)sl(t)dt

(15)

-

Various observations can be made based on (9)­(15). First,

as expected, there is contribution to accuracy from all three

colors. Second, distance related information contained in both

the received signal strength (RSS) parameter and the TOA

parameter is utilized in this scenario. To see this more clearly,

suppose that the same intensity levels are transmitted from

all the LEDs such that sr(t) = sg(t) = sb(t). Also, assume

that si(0) = si(Ts,i) for i  C, which is commonly the case

for practical signals. Then, it is obtained from (11) and (14)

that (m

 +

= 0; hence, the CRLB in (9) becomes 3)2x-2m-8 + x-2m-6c-2 -1. In this

CRLB1 = expression,

the first term comes from the information obtained from

the RSS parameter based on the known channel attenuation

formula (as  is related to the total received power) and the second term is due to the TOA parameter (since  is related

to the time resolution; equivalently, the effective bandwidth of

the signals). As a final observation, it can be shown that the

CRLB formula in (9)­(15) covers the one in [9] as a special

case if there exists only one LED at the transmitter and one

PD at the receiver (cf. [9, Sec. III-A]).

4

LEDs

PDs

Red

Red

Control Unit

Green

Green

Distance Estimator

Blue

Blue

Fig. 1. For distance estimation, VLP system model with RGB LEDs.

2) Scenario 2: Asynchronous System with Known Channel Attenuation Formula: In this scenario, it is assumed that the LED transmitter and the VLC receiver are asynchronous; namely,  in (3) is modeled as a deterministic unknown parameter. However, the VLC receiver is assumed to know the channel attenuation formula in (5) with j,i's being known constants. In this case, the log-likelihood function corresponding to the received signals in (2) can be expressed via (5) as

(x,  )

=

K~ -

jC

1 2j2

T2,j T1,j

yj (t)

(16)

2
- j,i x-m-3 si(t -  ) dt

iC

where K~ is a constant that does not depend on x or  . Then, the CRLB on distance estimation is given by1

CRLB2 = JF-1 11

(17)

where JF is the Fisher information matrix (FIM) defined as





JF

=

 E E

(x, ) 2 x

(x, ) (x, )

x



E

(x, ) (x, )

x



E

(x, ) 2 

 .

(18)

From (16), the elements of the FIM in (18) can be calculated after some manipulation as

JF =

(m + 3)2x-2m-8 (m + 3)x-2m-7

(m + 3)x-2m-7 x-2m-6

(19)

where , , and  are as defined in (10)­(12).

Based on (17) and (19), the CRLB on distance estimation

can be calculated as

CRLB2

=

(m

+

x2m+8 3)2(  -

()2)

·

(20)

By comparing (9) and (20), it is noted that only the
RSS parameter is utilized in this scenario since there is
no synchronization between the transmitter and the receiver. In particular, if  = 0, then the CRLB in (20) becomes CRLB2 = ((m + 3)2x-2m-8)-1, which corresponds to the first term in (9), as expected. Also, it is noted that the CRLB

1In (17) and (22), [X]11 denotes the element of matrix X at row 1 and column 1.

formula in (20) covers the one in [9, Sec. III-B] as a special case if there exists only one LED at the transmitter and one PD at the receiver.
3) Scenario 3: Synchronous System with Unknown Channel Attenuation Formula: In the final scenario, it is assumed that the LED transmitter and the VLC receiver are synchronized (i.e.,  = 0 in (3)) but the VLC receiver does not know the channel attenuation formula in (5). Then, the log-likelihood function corresponding to the received signals in (2) can be expressed, based on (3) with  = 0, as follows:

()

=

K~ -

jC

1 2j2

T2,j T1,j

yj (t)

(21)

-

hj,i si

t

-

x c

2
dt

iC

where  = [x hr,r hr,g hr,b hg,r hg,g hg,b hb,r hb,g hb,b]T is the vector of unknown parameters and k is a constant that does not depend on .
In this scenario, the CRLB on distance estimation is stated as

CRLB3 = JF-1 11

(22)

where JF is the FIM, which has a size of 10×10. The elements of JF are specified as follows:

JF =

A BT

B D

(23)

where A = E

() x

2

, B is a 1 × 9 vector given by

B= E

() () x hl,k

for l, k  C, and D is a 9 × 9 matrix

defined as D = E

() () hl,k hn,m

for l, k, n, m  C. Based

on (21), the elements of JF in (23) can be specified as follows:

A

=

1 c2

jC

1 j2

iC

lC

hj,i hj,l Ei,l

(24)

B=

1 c l2

iC

hl,i Ek ,i

,

l, k  C

(25)

D=

½ Ek,m {l=n}
l2

,

l, k, n, m  C

(26)

5

where Ek,m, Ek ,i, and Ei,l are as defined in (13)­(15), and
½{l=n} is the indicator function, which is equal to one if l = n
and zero otherwise.
From (23)­(26), the CRLB in (22) can be obtained as

CRLB3 = A - BD-1BT -1 .

(27)

It is noted from (26) that the 9 × 9 matrix D has a block diagonal structure; hence, the calculation of (27) requires inversion of three 3 × 3 matrix blocks.
In this scenario, the distance related information in the TOA parameter is utilized since the system is synchronous but the
channel attenuation formula is unknown. As a special case, if Ek ,i = 0 for all k, i  C, then B = 0 and CRLB3 = 1/A. In this case, unknown channel attenuation factors, hj,i's, do not affect the distance estimation accuracy. In all other cases, distance estimation accuracy is affected by the presence of
unknown channel attenuation factors (as they influence how
accurately the TOA information can be extracted).

B. ML Estimators for Distance Estimation
In this section, the ML estimators are derived for the scenarios considered in the previous subsection.
1) ML Estimator for Scenario 1: The ML estimator in Scenario 1 is stated as

x1 = arg max (x)

(28)

x

where (x) is given by (6). Based on the expression in (6), the ML estimator in (28) can be specified, after some manipulation, as

x1

=

arg max
x

x-m-3
jC

1 j2

iC

j,iRyj ,si

x c

- 0.5 x-2m-6

(29)

where  is as in (10) and

Ryj ,si ( )

T2,j
yj(t)si(t -  )dt .
T1,j

(30)

As noted from (29), a one-dimensional search is required to obtain the distance estimate. However, for each possible distance, correlations of the received signals are performed with delayed versions of the transmitted signals from the LEDs (see (30)).
2) ML Estimator for Scenario 2: The ML estimator in Scenario 2 is defined as

(x2,  ) = arg max (x,  )

(31)

(x, )

where (x,  ) is as in (16). After some manipulation, the ML estimator in (31) can be expressed as

(x2,  )

=

arg max
(x, )

x-m-3

jC

1 j2

iC

j,iRyj,si ( )

- 0.5 x-2m-6

(32)

where Ryj,si ( ) is given by (30). From (32),  can be obtained as



=

arg max



jC

1 j2

iC

j,iRyj,si ( ) .

(33)

Then,  can be inserted into the objective function in (32), and derivatives with respect to x can be calculated to show that x2 is given by the following formula:



 -1

m+3

x2

=

1 

jC

1 j2

j,iRyj ,si
iC





(34)

where  is as defined in (33) and jC j-2 iC j,iRyj,si  is assumed to be positive. From (33) and (34), it is noted that the ML distance
estimation is performed in two steps in Scenario 2. In the first step, the TOA parameter is estimated. In the second step, this TOA estimate is used to determine the RSS level, which is then employed in the distance estimation process by utilizing the known channel attenuation formulas.
3) ML Estimator for Scenario 3: The ML estimator in Scenario 3 is defined as

 = arg max ()

(35)



where () is given by (21). After some manipulation, the ML estimator in (35) can be stated as

 = arg max


jC

1 j2

hTj Rj (x) - 0.5 hTj E hj

(36)

where hj

[hj,r hj,g hj,b]T and Rj (x)

[Ryj,sr (x) Ryj,sg (x) Ryj,sb (x)]T with Ryj,si (x) being

given by (30). In addition, E in (36) is a 3 × 3 symmetric

matrix described as

 Er,r
E = Eg,r Eb,r

Er,g Eg,g Eb,g

 Er,b Eg,b  Eb,b

(37)

whose elements are as defined in (13). For simplicity of
the derivations, E is assumed to be positive definite in the
remainder of the manuscript.
The gradient of the objective function in (36) with respect to hj is calculated as j-2(Rj(x) - E hj) for j  C. Then, the ML estimates for hj are obtained as hj = E-1Rj(x) for j  C. Inserting these estimates into (36), the ML distance
estimate is derived as

x3

=

arg max
x

jC

1 j2

RTj (x)E-1Rj (x)

.

(38)

Similar to Scenario 1, a one-dimensional search is performed to obtain the distance estimate and for each possible distance, correlations of the received signals are calculated with delayed versions of the transmitted signals from the LEDs.

6

4) Modified ML Estimator for Scenario 1: To utilize the distance related information in the TOA parameter effectively, it can be required to sample the correlation function in (30) at high rates. Otherwise, the performance of the ML estimator in (29) may not get very close to the CRLB. To mitigate this problem, a modified version of the ML estimator can be designed as proposed in [9]. In particular, the ML estimate calculated from (29) can be used as an input to the relation in (34); that is, the modified ML estimator can be obtained as



 -1

m+3

x4

=

1 

jC

1 j2

iC

j,iRyj ,si

x1 c



(39)

where x1 is the ML estimate in (29). This estimator is robust against sampling rate limitations, as observed in Section V.

IV. POSITION ESTIMATION

In this section, we consider a generic three-dimensional
localization scenario in which the LED transmitters and the
VLC receiver can have any orientations and locations. In
particular, the aim is to estimate the location lr of the VLC receiver based on the received signals in (2); namely, yjk(t) for t  [T1k,j, T2k,j], j  C, and k  {1, . . . , NL}. Based on these received signals, the log-likelihood function can be stated as

()

=

K~

-

NL k=1

jC

1 2j2

T2k,j

2

×

yjk(t) - hkj,i ski t -  k dt

T1k,j

iC

(40)

where  denotes the set of unknown parameters and K~ is a constant that does not depend on the unknown parameters. The set of unknown parameters varies according to the considered scenario as specified below. The CRLB on the covariance matrix of any unbiased estimator ^ of  can be expressed as [35]

E (^ - )(^ - )T J()-1

(41)

where J() denotes the FIM for  and A~ B~ means that A~ - B~ is positive semidefinite. The FIM is computed as

J() = E (()) (())T

(42)

where  represents the gradient operator with respect to  and () is the log-likelihood function in (40).

A. Theoretical Limits for Position Estimation
In this section, accuracy limits of position estimation are investigated for VLP systems with RGB LEDs under three different scenarios.

1) Scenario 1: Synchronous System with Known Channel
Attenuation Formula: In this scenario, the clocks of the VLC receiver and the LED transmitters are synchronized (that is, k = 0 for all k  {1, . . . , NL} in (3)), and the VLC receiver knows the channel attenuation formula in (4). Then, the set of unknown parameters in (40) becomes  = lr = [lr,1 lr,2 lr,3]T ; i.e., the only unknown parameter is the location of the VLC receiver. For this scenario, the CRLB is given by the following
proposition.
Proposition 1: In Scenario 1, the CRLB on the MSE of any unbiased estimator lr for the location of the VLC receiver is given by

E lr - lr 2  trace J-sc1e1

(43)

where

[Jsce1 ]n1 ,n2

=

jC

1 j2

NL k=1

iC

lC

 hkj,i  lr,n1

 hkj,l  lr,n2

Eik,l

-

 hkj,i  lr,n1

k  lr,n2

hkj,lEi,,lk

-

k  lr,n1

 hkj,l  lr,n2

hkj,iEl,,ik

+

k  lr,n1

k  lr,n2

hkj,l hkj,i Ei,l,k

(44)

for n1, n2  {1, 2, 3} with



Eik,l

ski (t)skl (t)dt

(45)

-



Ei,,lk

ski (t)(skl (t))dt

(46)

-



Ei,l,k

(ski (t))(skl (t))dt

(47)

-

k  lr,n

=

lr,n - ltk,n c lr - lkt

(48)

 hkj,i  lr,n

=

- (mk

+ 1)Aj R~j,i 2

(lr - lkt )T nkt mk-1 lr - lkt mk+3

(49)

× mk nkt,n(lr - lkt )T nr + nr,n(lr - lkt )T nkt

-

(mk + 3)(lr,n - ltk,n) lr - lkt mk+5

(lr - lkt )T nkt

mk (lr - lkt )T nr

Proof: In Scenario 1, the log-likelihood function in (40)
is considered for  = lr, where  k is given by (3) with k = 0 for all k  {1, . . . , NL} and hkj,i is as in (4). Then, the
elements of the FIM in (42) is stated as

[J()]n1,n2 = E

() () lr,n1 lr,n2

(50)

for n1, n2  {1, 2, 3}, where ()/lr,n is given by

()  lr,n

=

NL k=1 jC

1 j2

T2k,j T1k,j

yjk(t) - hkj,i ski t -  k
iC

×
iC

 hkj,i  lr,n

ski (t

-



k

)

-

hkj,i(ski (t

-



k

))

k  lr,n

dt (51)

7

for n  {1, 2, 3}. From (51), the elements of the FIM in (50) can be obtained, after some manipulation, as follows:

[J()]n1,n2

=

NL k=1

jC

1 j2

T2k,j T1k,j iC lC

 hkj,i  lr,n1

ski (t

-



k

)

 hkj,l  lr,n2

skl (t

-



k

)

-

 hkj,i  lr,n1

ski (t

-

 k)hkj,l(skl (t

-

 k))

k  lr,n2

-

 hkj,l  lr,n2

skl (t

-

 k)hkj,i(ski (t

-

 k))

k  lr,n1

+

hkj,i(ski

(t

-



k

))

k  lr,n1

hkj,l(skl

(t

-



k ))

k  lr,n2

(52)

As the signals ski (t -  k) are assumed to be contained completely in the observation intervals [T1k,j, T2k,j], the expression in (52) can be shown to be equal to that (44) based on the definitions in (45), (46), and (47). Also, the partial derivatives in (48) and (49) can be obtained from (3) with k = 0 for all k  {1, . . . , NL} and (4), respectively. Overall, the CRLB on the MSE of any unbiased estimator lr for the location of the VLC receiver, lr, can be expressed via (41) as E lr - lr 2  trace J()-1 . Since J() in (52) and Jsce1 in (44) are equivalent, the expression in (43) is reached.
Proposition 1 provides a closed-form expression for the CRLB on location estimation in VLP systems with RGB LEDs based on a generic three-dimensional setup. From the expression in (44), it is noted that both the RSS information and the TOA information are utilized in Scenario 1, and their relative contributions depend on signal characteristics via the Ei,,kl, Ei,,lk and Ei,l,k terms. Also, different signals (colors) emitted from each LED transmitter contribute to the localization accuracy, as expected. In the special case of a single color at each LED transmitter and a single PD at the VLC receiver, the FIM in Proposition 1 reduces to that in [13, Prop. 1].
2) Scenario 2: Asynchronous System with Known Channel Attenuation Formula: In this scenario, the VLC receiver is not synchronized with the LED transmitters, and the k terms in (3) are modeled as deterministic unknown parameters. Therefore, the TOA parameters are unknown and do not contribute to localization accuracy. Hence, the set of unknown parameters in (40) is specified as  = [lr,1 lr,2 lr,3  1 · · ·  NL ]T in this scenario. The CRLB in Scenario 2 is presented in the following proposition:
Proposition 2: In Scenario 2, the CRLB on the MSE of any unbiased estimator lr for the location of the VLC receiver is expressed as

where Jsce2 denotes a 3×3 matrix with the following elements:

NL
[Jsce2]n1,n2 =
k=1

jC

iC

lC

 hkj,i  lr,n1

 hkj,l  lr,n2

Eik,l j2

-

hkj,i hkj,lEi,,lk

hkj,i hkj,lEi,,lk

jC iC lC lr,n1 j2

jC iC lC lr,n2 j2

hkj,i hkj,l Ei,l,k

jC iC lC

j2

(54)

for n1, n2  {1, 2, 3}, with Eik,l, Ei,,lk, Ei,l,k, and hkj,i/lr,n being defined by (45), (46), (47), and (49), respectively.
Proof: For the parameter vector given by  = [lr,1 lr,2 lr,3  1 · · ·  NL ]T , the partial derivatives of the log-
likelihood function in (40) are calculated as follows:

()  lr,n

=

NL k=1 jC

1 j2

T2k,j T1k,j

yjk(t) - hkj,i ski t -  k
iC

×

iC

 hkj,i  lr,n

ski

(t

-



k

)dt

(55)

() k

=

-
jC

1 j2

T2k,j T1k,j

yjk(t) - hkj,i ski t -  k
iC

× hkj,i ski (t -  k) dt

(56)

iC

for n  {1, 2, 3} and k  {1, . . . , NL}. From (55) and (56), the FIM in (42) can be obtained as

J() =

JA JTB

JB JD

(57)

where JA is a 3 × 3 matrix with elements

[JA ]n1 ,n2

=

NL k=1 jC

iC

lC

 hkj,i  lr,n1

 hkj,l  lr,n2

Eik,l j2

(58)

for n1, n2  {1, 2, 3}, JB is a 3 × NL matrix with elements

[JB ]n,k

=

-
jC

iC

lC

 hkj,i  lr,n

hkj,lEi,,lk j2

(59)

for n  {1, 2, 3} and k  {1, . . . , NL}, and JD is an NL × NL

matrix with elements





[JD ]k1 ,k2

=

jC
0 ,

iC

, hkj,i hkj,lEi,,lk

lC

j2

if k1 = k2 if k1 = k2

(60)

for k1, k2  {1, . . . , NL}. In (58)­(60), Eik,l, Ei,,lk, Ei,l,k, and hkj,i/lr,n are as defined in (45), (46), (47), and (49), respectively.
From (41), the CRLB on the location lr of the VLC receiver can be expressed as [35]

E lr - lr 2  trace J-sc1e2

(53)

E lr - lr 2  trace J-1() 3×3

(61)

8

where lr is any unbiased estimator for lr. From (57), J-1() 3×3 can be computed as

J-1() 3×3 =

JA - JBJ-D1JBT

-1
.

(62)

Since JD in (60) is a diagonal matrix, the elements of JA - JBJ-D1JB can be stated as

JA - JBJ-D1JBT

n1 ,n2

=

[JA ]n1 ,n2

-

NL k=1

[JB ]n1 ,k [JB ]n2 ,k [JD]k,k

(63)

By inserting (58)­(60) into (63), the expression in (54) is

obtained. This observation together with (61) verifies the

expressions in (53) and (54) in the proposition. Proposition 2 presents a generic closed-form expression for

the CRLB in Scenario 2, which illustrates that the location

relation information in extracted only from the channel atten-

uation factors (RSS parameters) in this scenario as there exits

no synchronization between the VLC receiver and the LED

transmitters. The expression in Proposition 2 covers the CRLB

expression in [13, Prop. 3] as a special case when single-color

LEDs and a VLC receiver with a single PD are employed. 3) Scenario 3: Synchronous System with Unknown Channel

Attenuation Formula: In the last scenario, the LED transmitters and the VLC receiver are synchronized (i.e., k = 0 for all k  {1, . . . , NL} in (3)) but the VLC receiver does not know the channel attenuation formula in (4). Therefore,

only the TOA parameters contribute to localization accuracy,
and the set of unknown parameters in (40) becomes  = lr,1 lr,2 lr,3 {hkj,i}Nk=L1,jC,iC T . Namely, there exist 9NL + 3 unknown parameters. The CRLB in this scenario is provided

in the following proposition: Proposition 3: In Scenario 3, the CRLB on the MSE of any
unbiased estimator lr for the location of the VLC receiver can be stated as

E lr - lr 2  trace J-sc1e3

(64)

Jsce3 = J~A - J~BJ~-D1J~TB

(65)

where J~A is a 3 × 3 matrix with elements



J~A

=


jC

1 j2

NL k=1

iC

lC

k  lr,n1

k  lr,n2

hkj,lhkj,iEi,l,k



(66)

for n1, n2  {1, 2, 3}, J~B is a 3 × 9NL matrix with elements

J~B =

-

1 j2

lC

k  lr,n

hkj,l

Ei,,lk

(67)

for n  {1, 2, 3} and {k, j, i}  {1, . . . , NL} × C × C, and J~D is a 9NL × 9NL matrix with elements

½ J~D =

Eik,l j2 {k=k~,j=~j}

(68)

for {k, j, i}  {1, . . . , NL} × C × C and {k~, ~j, l}  {1, . . . , NL} × C × C. In (66)­(68), Eik,l, Ei,,lk, Ei,l,k, and  k/lr,n are as defined by (45), (46), (47), and (48), re-
spectively, and ½{k=k~,j=~j} denotes the indicator function.

Proof: In this scenario, the partial derivatives of the loglikelihood function in (40) are computed as

()  lr,n

=

NL
-
k=1 jC

1 j2

T2k,j T1k,j

yjk(t) - hkj,i ski t -  k
iC

×

iC

hkj,i

k  lr,n

ski (t -  k) dt

(69)

()  hkj,i

=

T2k,j T1k,j

yjk(t) - hkj,i ski t -  k
iC

ski

(t - j2



k

)

dt

(70)

for n  {1, 2, 3} and {k, j, i}  {1, . . . , NL} × C × C. After some manipulation, it can be derived from (69) and (70) that the FIM in (42) is in the form of

J() =

J~A J~TB

J~B J~D

(71)

where J~A, J~B, and J~D are as in (66), (67), and (68), respectively. Since E lr -lr 2  trace J-1() 3×3 and J-1() 3×3 = J~A - J~BJ~-D1J~TB -1, the expressions in the proposition are obtained.

Via Proposition 3, the theoretical accuracy limit on lo-

calization can be calculated for synchronized VLP systems

with RGB LEDs, where the VLC receiver does not know the

channel attenuation formula in (4) due to certain reasons such

as unknown transmitter parameters or calibration problems.

It should be noted that localization of VLC receivers in

Scenario 3 has not been considered in the literature even in

the special case of single-color LEDs and a VLC receiver with

a single PD. In that special case, the CRLB can be calculated

as in the following corollary.

Corollary 1: Suppose that each LED has a single color,

say red, and the VLC receiver has a single PD for that color.

Then, in Scenario 3, the CRLB on the MSE of any unbiased estimator lr for the location of the VLC receiver is given by

E lr - lr 2  trace J-sc1e3

(72)

where Jsce3 is a 3 × 3 matrix with the following elements:

NL
[Jsce3]n1,n2 =
k=1

Er,,rk -

Er,,kr 2 Erk,r

hkr,r 2  k  k r2 lr,n1 lr,n2
(73)

for n1, n2  {1, 2, 3}. Proof: When each LED transmitter emits only the red
color (signal) and the VLC receiver has a single PD for that color, the matrices J~A, J~B, and J~D in (66), (67), and (68) of Proposition 3 become

J~A =

1 r2

NL k=1

k  lr,n1

k  lr,n2

hkr,r hkr,r Er,,rk

for n1, n2  {1, 2, 3},

(74)

J~B =

-

1 j2

k  lr,n

hkr,r Er,,kr

(75)

9

for n  {1, 2, 3} and k  {1, . . . , NL}, and

J~D =

½ Erk,r
r2 {k=k~}

(76)

for k, k~  {1, . . . , NL}. Then, the result in the corollary follows from the relations E lr-lr 2  trace J-1() 3×3 and J-1() 3×3 = J~A - J~BJ~-D1J~TB -1 based on the expressions in (74), (75), and (76).

B. ML Estimators for Position Estimation
In this section, ML estimators are derived for localization of the VLC receiver in the scenarios considered above.
1) ML Estimator for Scenario 1: The ML estimator for the location of the VLC receiver in Scenario 1 is expressed as

lr = arg max ()

(77)

lr

where () is given by (40) and  = lr. Based on the expression in (40), the ML estimator in (77) can be stated, after some manipulation, as follows:

lr = arg max
lr

NL

1

k=1 jC j2

hkj,iRyjk,ski  k
iC

- 0.5

hkj,ihkj,lEik,l

iC lC

(78)

where hkj,i and  k are functions of lr as in (4) and (3) (with k = 0 for all k  {1, . . . , NL}), respectively, and

Ryjk,ski  k

T2k,j
yjk(t)ski t -  k dt .
T1k,j

(79)

It is noted from (78) that the ML estimator for Scenario 1 re-
quires a three-dimensional search over all possible locations of the VLC receiver. For each possible location lr, the correlation term Ryjk,ski  k should be calculated for all k  {1, . . . , NL}, j  C, and i  C (i.e., 9NL times), which constitutes the operation with the highest complexity. Hence, by considering
the exhaustive search method (due to the non-convexity of the problem), the correlation terms should be calculated 9NLNV times in total, where NV denotes the number of possible values of lr. In addition, the ML estimator in (78) reduces to that in [13, eqn. (19)] in the special case of single-color LEDs and a
VLC receiver with a single PD.
2) ML Estimator for Scenario 2: The ML estimator in
Scenario 2 is given by

(lr,  ) = arg max ()

(80)

(lr, )

where   1 · · ·  NL T ,  = (lr,  ), and () is given by (40). From (40), (80) can be expressed as

(lr,  ) = arg max
(lr, )

NL

1

k=1 jC j2

hkj,iRyjk,ski  k
iC

- 0.5

hkj,i hkj,l Eik,l

iC lC

(81)

where hkj,i are functions of lr as in (4) and Ryjk,ski  k is given by (79). The ML estimator in (81) can also be implemented
as follows:

lr = arg max
lr

NL

1

k=1 jC j2

hkj,iRyjk,ski  k(lr)
iC

- 0.5

hkj,ihkj,lEik,l

iC lC

(82)

where

 k(lr) = arg max
k

1 jC j2

hkj,i Ryjk ,ski
iC

k

(83)

for k  {1, . . . , NL}.

The ML estimator described by (82) and (83) indicates

that a three-dimensional search over all possible locations

of the VLC receiver should be implemented together with

NL one-dimensional searches for each possible location lr.

During each one-dimensional search in (83), the correlation

term Ryjk,ski  k should be calculated for all possible delay values  k (considering exhaustive search). If Nk denotes the number of possible values for  k, the correlation terms

should be calculated 9NL

NL k=1

N

k

times

for

each

lr,

and

9NLNV

NL k=1

N k

times

in

total

(with

NV

denoting

the

number of possible values of lr). Hence, the ML estimator

in Scenario 2 has higher complexity than that in Scenario 1

(see (78)).

In the special case of single-color LEDs and a VLC receiver

with a single PD [13, Sec. IV-B], the one-dimensional search

in (83) becomes independent of the VLC location lr. In that case, the complexity of the ML estimation in (82) and

(83) reduces significantly. Namely, a three-dimensional search

over lr is performed and, in total, the correlation terms are

calculated

NL k=1

Nk

times

only.

3) ML Estimator for Scenario 3: The ML estimator in

Scenario 3 is formulated as

lr,

hkj,i

NL k=1,jC,iC

=

arg max

lr ,{hkj,i}N k=L1,jC,iC

()

(84)

where  = lr,1 lr,2 lr,3 {hkj,i}Nk=L1,jC,iC T and () is as in (40). From (40), (84) can be expressed as (cf. (36) and (78))

lr,

k
hj

NL k=1,jC

NL

1

=

arg max
lr,{hkj }N k=L1,jC

k=1 jC j2

(85)

× hkj T Rkj  k - 0.5 hkj T Ekhkj

where  k are functions of lr as in (3) (with k = 0 for all k  {1, . . . , NL}),

hkj Rkj  k
Ek

[hkj,r hkj,g hkj,b]T

REyrkjk,r,skr

k Erk,g

Ryjk ,skg Erk,b

 

k

Ryjk,skb  k

T

Egk,r Egk,g Egk,b

Ebk,r Ebk,g Ebk,b

(86) (87)
(88)

10

10-1 101

10-2

100

10-3

10-1

10-4

10-2 10-3

10-5

102

103

104

10-4

105

106

107

108

109

Fig. 2. CRLB vs. Po for x = 5 m. and Ts = 0.01 sec.

Fig. 3. CRLB vs. fc for x = 5 m., Ts = 0.01 sec., Po = 0.1 W

The objective function in (85) is a quadratic expression in

terms of hkj , and Ek is positive semi-definite by definition.

Hence, the gradients with respect to hkj can be set to zero to

100

characterize the ML estimator as follows:

hkj ()

=

1 j2

Rkj  k

- Ekhkj

=0

(89)

for k  {1, . . . , NL} and j  C. Assuming that Ek is

10-1

invertible, the relation in (89) becomes hkj = Ek -1Rkj  k ,

which reduces the ML estimator in (85) to the following

problem (cf. (38)):

lr

=

NL

arg max

lr

k=1

jC

1 2j2

Rkj

k

T Ek -1Rkj  k

(90)

10-2

The ML estimator in (90) for Scenario 3 requires a

three-dimensional search over all possible locations of the

10-3 10-4

10-3

10-2

10-1

VLC receiver, and 9NL evaluations of the correlation terms

Ryjk,ski  k for each lr. Hence, the complexity order of the ML estimator in Scenario 3 is the same as that in Scenario 1.

Fig. 4. CRLB vs. Ts for x = 5 m. and Po = 0.1 W.

V. NUMERICAL RESULTS

A. Simulation Setup

In this section, numerical examples are presented to inves-

tigate the CRLBs derived in Sections III-A and IV-A and the

performance of the ML estimators in Sections III-B and IV-B.

For distance estimation, a similar setting to that in [9] is

considered; that is, the Lambertian order is set to m = 1 and h~ in (5) is taken as 2.5 meters. The areas of the PDs at the VLC receiver are set to Aj = 1 cm2 for j  C, and the spectral

density level of the noise components at different branches of the VLC receiver are j2 = 1.336 × 10-22 W/Hz for j  C [7], [9]. For position estimation, a similar setting to that in [13] is

analyzed. We consider a room with width, depth, and height of

[8 8 5] m., respectively, where NL = 4 LED transmitters are

attached l3t = [2

to the 6 5]T ,

ceiling and l4t

at positions = [6 6 5]T

l1t = [2 2 m. The

5]T , l2t = [6 2 5]T , orientation vectors

of the LEDs in (4) are expressed as

nkt = [sin k cos k sin k sin k cos k]T

(91)

10-1

10-2

10-3

10-4 3

3.2 3.4 3.6 3.8 4 4.2 4.4 4.6 4.8 5

Fig. 5. CRLB vs. x for Po = 0.1 W and Ts = 0.01 sec.

11

102

100

101 100 10-1 10-2 10-3

10-1 10-2 10-3 10-4

10-4

10-5

102

103

104

105

106

107

108

109

Fig. 6. RMSEs of ML estimators (MLEs) for distance estimation in different scenarios, together with the CRLBs, where x = 5 m., fc = 10 MHz, and Ts = 0.1 ms., where M-MLE denotes the modified ML estimator in Section III-B4.

for k = 1, . . . , NL, where k and k denote the polar and az-
imuth angles, respectively [36]. We consider the following angle configuration for the transmitters: (1, 1) = (150, 45), (2, 2) = (150, 135), (3, 3) = (150, -45), (4, 4) = (150, -135). The VLC receiver is located at lr = [4 4 1]T m. looking upwards, i.e., its orientation vector is given by nr = [0 0 1]T [13]. The transmitted signals from
the LEDs are modeled as [7]:

ski (t) = Po

1 - cos

2t Ts

1 + cos(2fikt)

(92)

for t  [0, Ts], k = 1, . . . , NL, and i  C, where fik is the center frequency for the ith signal (color) coming from transmitter k. fik's are specified through a constant center frequency fc as fik = kfi, where fr = 0.9fc, fg = fc, and fb = 1.1fc. Note that in the distance estimation problem, we consider the
scenario where there is only one transmitter, i.e., NL = 1, and drop the index k in the relevant definitions (implicitly setting k = 1). Parameter Po in (92) corresponds to the average
emitted optical power (i.e., source optical power). In addition, the R~j,i terms in (4) are taken as [R~r,r R~r,g R~r,b] = 0.4 × [1 0.042 0.03], [R~g,r R~g,g R~g,b] = 0.4 × [0.194 0.665 0.277], and [R~b,r R~b,g R~b,b] = 0.4 × [0.009 0.084 0.421], where 0.4 mA/mW represents a coefficient related to the responsivity
of the PDs as in [9], and the remaining numbers are adopted
from eqn. (14) in [27].

B. Distance Estimation
First, the CRLBs (in meters) for the considered scenarios in Section III-A are plotted in Fig. 2 with respect to Po in (92) (equivalently, with respect to source optical power), where x = 5 m. and Ts = 0.01 sec. It is noted that for small center frequencies (around 10 MHz), the CRLBs in Scenario 1 and Scenario 2 are almost the same since synchronization does not bring any additional benefits in this case. In other words, the distance related information contained in the RSS parameter

Fig. 7. CRLB vs. fc for Ts = 0.01 sec. and Po = 0.1 W for position estimation.
100

10-1

10-2

10-3 10-6

10-5

10-4

10-3

10-2

10-1

Fig. 8. CRLB vs. Ts for Po = 0.1 W and fc = 10 MHz for position estimation.

is more significant than that in the TOA parameter. This can also be verified from the high CRLB values in Scenario 3 for fc = 10 MHz as only the TOA parameter is utilized in that scenario. As the center frequencies are increased, the TOA parameter becomes significant and the CRLB in Scenario 3 decreases rapidly. Since only the RSS information is used in Scenario 2, its CRLB does not depend on the center frequencies. On the other hand, the CRLB of Scenario 1 also decreases with increased center frequencies as it utilizes both the RSS and TOA parameters in distance estimation.
Fig. 3 illustrates the frequency dependencies of the CRLB expressions more explicitly, where x = 5 m., Ts = 0.01 sec., and Po = 0.1 are used. As the center frequencies of the transmitted signals are raised, the distance related information in the TOA parameter increases. Hence, the CRLB in Scenario 3, which only utilizes the TOA parameter, decreases with the center frequency parameter fc in Fig. 3. On the other hand, the CRLB in Scenario 2 does not change with the center frequencies, as noted before. Since both the TOA and RSS

12

parameters are utilized in Scenario 1, the CRLB is almost constant for small fc's (as the distance related information in the TOA parameter is insignificant compared to that in the RSS parameter in that region) and then starts decreasing with fc (as the distance related information in the TOA parameter gets significant).
Next, Fig. 4 presents the CRLB versus Ts curves in the considered scenarios for two different center frequencies, where x = 5 m. and Po = 0.1. As expected, the CRLB decreases as the duration Ts of the transmitted signals in (92) increases. In addition, the relative CRLB performances in different scenarios carry similarities to those in Fig. 2 due to the same reasons.
Moreover, the CRLBs are plotted versus the distance x in Fig. 5, where Po = 0.1 and Ts = 0.01 sec. As channel attenuation becomes more severe as the distance increases (see (4)), the CRLBs increase with distance. As expected, it is observed that the CRLBs increase with distance. However, the slopes of the CRLBs with respect to distance are not the same. The slope of the CRLB in Scenario 2 is higher than that in Scenario 3 since they are proportional to xm+4 and xm+3, respectively (considering the CRLBs in meters) based on the expressions in Sections III-A2 and III-A3. On the other hand, the slope of the CRLB in Scenario 1 (see (9)) is almost the same as that in Scenario 2 for low center frequencies (as the RSS parameter is dominant in that case) and it is close to and higher than that in Scenario 3 for high center frequencies (as the TOA parameter is significant in that case, as well).
Furthermore, the root mean-squared errors (RMSEs) of the ML estimators derived in Section III-B are plotted versus P0, together with the CRLBs, where x = 5 m., fc = 10 MHz, and Ts = 0.1 ms. From Fig. 6, it is observed that the RMSEs of the ML estimators in Scenario 1 (see (29)) and Scenario 3 (see (38)) are significantly higher than the corresponding CRLBs. The main reason for this is the finite sampling interval used in the simulations (namely, 0.5 ns), which limits the utilization of distance related information contained in the TOA parameter (please see [9] for a similar observation). On the other hand, the ML estimator in Scenario 2 (see (33) and (34)) and the modified ML estimator in Scenario 1 (see (39)) achieve close performance to the CRLBs. The best performance is achieved in Scenario 1 as both the TOA and RSS parameters are utilized.

102

101

100

10-1

10-2

10-3

10-4

101

102

103

104

105

Fig. 9. RMSEs of ML estimators for position estimation, together with the CRLBs, where fc = 10 MHz and Ts = 1µ s.

center frequency increases, Scenario 1 and Scenario 3 induce lower CRLBs since they exploit the information contained in the TOA parameter whereas Scenario 2 has a constant CRLB since the information in the TOA parameter is not utilized. Also, the CRLBs in all the scenarios decrease as the observation interval of the signals, Ts, increases.
Finally, we obtain the RMSEs of the ML estimators derived in Section IV-B and present them together with the CRLBs in Section IV-A in Fig. 9, where fc = 10 MHz and Ts = 1µ s. Since fc is not very high, the CRLB in Scenario 3, where only the TOA information is utilized, is the highest for all source optical powers in compliance with the previous results. In addition, at high source optical powers, the ML estimators achieve RMSEs close to the CRLBs and the RMSEs are ordered in the same way as the CRLBs. On the other hand, for low and medium source optical powers, the CRLBs do not provide tight bounds on the RMSEs of the ML estimators (as expected) and the highest RMSEs are obtained in Scenario 2. Moreover, it is noted that the RMSEs can be lower than the CRLBs for low source optical powers since the search for the position of the VLC receiver is performed in the specified room whereas the CRLB derivations do no assume any prior information about the position of the VLC receiver.

C. Position Estimation
Position estimation is performed in a room with the setup described in Section V-A by considering the scenarios specified in Section IV. Figs. 7 and 8 present the CRLBs for the position estimation problem with respect to the center frequency parameter fc (for Ts = 0.01 sec.) and the observation interval Ts (for fc = 10 MHz), respectively, where Po = 0.1 W. We make similar observations to those for the distance estimation simulations in Section V-B. Namely, for lower values of the center frequency parameter, the CRLBs in Scenario 1 and Scenario 2 are almost identical since the information contained in the TOA parameter is inconsiderable compared to the RSS parameter, and the CRLB for Scenario 3 is very high. As the

VI. CONCLUDING REMARKS
Performance limits and ML estimators have been derived for distance and position estimation in VLP systems in the presence of RGB LEDs by considering three different scenarios. In Scenario 1 and Scenario 2, a synchronous and an asynchronous system have been assumed, respectively, with a known channel attenuation formula at the VLC receiver. In Scenario 3, synchronism has been assumed but the channel attenuation formula has been modeled as unknown. Since both the TOA and RSS parameters are utilized in Scenario 1, it has the lowest CRLBs in all the cases. On the other hand, Scenario 2 achieves lower (higher) CRLBs than Scenario 3 for low (high) center frequencies (more generally, effective bandwidths).

13

The results obtained for distance estimation in Section III
generalize the CRLBs and ML estimators in [9] to VLP
systems with RGB LEDs and corresponding PDs. In addition,
the CRLBs and ML estimators were derived in [13] for a
single (white) LED at each transmitter and a single PD at the
VLC receiver by considering Scenario 1 and Scenario 2. The
results in Section IV have not only extended the results in
[13] to VLP systems with RGB LEDs but also covered a new
scenario (Scenario 3) that has not been investigated for VLP
systems before in the literature.
REFERENCES
[1] I. Demirel and S. Gezici, "Accuracy limits of distance estimation in visible light systems with RGB LEDs," in IEEE 30th Annual International Symposium on Personal, Indoor and Mobile Radio Communications (PIMRC), 2019, pp. 1­6.
[2] Y. Zhuang, L. Hua, L. Qi, J. Yang, P. Cao, Y. Cao, Y. Wu, J. Thompson, and H. Haas, "A survey of positioning systems using visible LED lights," IEEE Communications Surveys & Tutorials, vol. 20, no. 3, pp. 1963­ 1988, 2018.
[3] M. F. Keskin, A. D. Sezer, and S. Gezici, "Localization via visible light systems," Proceedings of the IEEE, vol. 106, no. 6, pp. 1063­1088, June 2018.
[4] J. Armstrong, Y. Sekercioglu, and A. Neild, "Visible light positioning: A roadmap for international standardization," IEEE Communications Magazine, vol. 51, no. 12, pp. 68­73, Dec. 2013.
[5] M. Afzalan and F. Jazizadeh, "Indoor positioning based on visible light communication: A performance-based survey of real-world prototypes," ACM Comput. Surv., vol. 52, no. 2, May 2019.
[6] E. W. Lam and T. D. C. Little, "Visible light positioning for locationbased services in industry 4.0," in 2019 16th International Symposium on Wireless Communication Systems (ISWCS), 2019, pp. 345­350.
[7] T. Wang, Y. Sekercioglu, A. Neild, and J. Armstrong, "Position accuracy of time-of-arrival based ranging using visible light with application in indoor localization systems," Journal of Lightwave Technology, vol. 31, no. 20, pp. 3302­3308, Oct. 2013.
[8] X. Zhang, J. Duan, Y. Fu, and A. Shi, "Theoretical accuracy analysis of indoor visible light communication positioning system based on received signal strength indicator," Journal of Lightwave Technology, vol. 32, no. 21, pp. 4180­4186, Nov. 2014.
[9] M. F. Keskin and S. Gezici, "Comparative theoretical analysis of distance estimation in visible light positioning systems," Journal of Lightwave Technology, vol. 34, no. 3, pp. 854­865, Feb. 2016.
[10] A. Sahin, Y. S. Eroglu, I. Guvenc, N. Pala, and M. Yuksel, "Accuracy of AOA-based and RSS-based 3D localization for visible light communications," in IEEE Vehic. Technol. Conf. (VTC), Boston, MA, Sep. 2015.
[11] E. Gonendik and S. Gezici, "Fundamental limits on RSS based range estimation in visible light positioning systems," IEEE Communications Letters, vol. 19, no. 12, pp. 2138­2141, Dec. 2015.
[12] M. F. Keskin, E. Gonendik, and S. Gezici, "Improved lower bounds for ranging in synchronous visible light positioning systems," Journal of Lightwave Technology, vol. 34, no. 23, pp. 5496­5504, Dec. 2016.
[13] M. F. Keskin, S. Gezici, and O. Arikan, "Direct and two-step positioning in visible light systems," IEEE Transactions on Communications, vol. 66, no. 1, pp. 239­254, Jan. 2018.
[14] A. Sahin, Y. S. Eroglu, I. Guvenc, N. Pala, and M. Yuksel, "Hybrid 3-D localization for visible light communication systems," Journal of Lightwave Technology, vol. 33, no. 22, pp. 4589­4599, Nov. 2015.
[15] H. Steendam, T. Q. Wang, and J. Armstrong, "Cramer-Rao bound for indoor visible light positioning using an aperture-based angular-diversity receiver," in 2016 IEEE International Conference on Communications (ICC), May 2016, pp. 1­6.
[16] ----, "Theoretical lower bound for indoor visible light positioning using received signal strength measurements and an aperture-based receiver," Journal of Lightwave Technology, vol. 35, no. 2, pp. 309­319, Jan. 2017.
[17] Z. Zheng, L. Liu, and W. Hu, "Accuracy of ranging based on DMT visible light communication for indoor positioning," IEEE Photonics Technology Letters, vol. 29, no. 8, pp. 679­682, April 2017.
[18] G. Kail, P. Maechler, N. Preyss, and A. Burg, "Robust asynchronous indoor localization using LED lighting," in 2014 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), May 2014, pp. 1866­1870.

[19] W. Zhang, M. I. S. Chowdhury, and M. Kavehrad, "Asynchronous indoor positioning system based on visible light communications," Optical Engineering, vol. 53, no. 4, pp. 045 105­1­045 105­9, 2014.
[20] M. Aminikashani, W. Gu, and M. Kavehrad, "Indoor positioning in high speed OFDM visible light communications," arXiv preprint arXiv:1505.01811, 2015.
[21] W. Xu, J. Wang, H. Shen, H. Zhang, and X. You, "Indoor positioning for multiphotodiode device using visible-light communications," IEEE Photonics Journal, vol. 8, no. 1, pp. 1­11, Feb 2016.
[22] Y. Eroglu, I. Guvenc, N. Pala, and M. Yuksel, "AOA-based localization and tracking in multi-element VLC systems," in IEEE 16th Annual Wireless and Microwave Technology Conference (WAMICON), Apr. 2015.
[23] S.-Y. Jung, S. Hann, and C.-S. Park, "TDOA-based optical wireless indoor localization using LED ceiling lamps," IEEE Transactions on Consumer Electronics, vol. 57, no. 4, pp. 1592­1597, Nov. 2011.
[24] S.-H. Yang, H.-S. Kim, Y.-H. Son, and S.-K. Han, "Three-dimensional visible light indoor localization using AOA and RSS with multiple optical receivers," Journal of Lightwave Technology, vol. 32, no. 14, pp. 2480­2485, July 2014.
[25] G. B. Prince and T. D. C. Little, "Latency constrained device positioning using a visible light communication two-phase received signal strength angle of arrival algorithm," in 2015 International Conference on Indoor Positioning and Indoor Navigation (IPIN), Oct. 2015, pp. 1­7.
[26] E. Kazikli and S. Gezici, "Hybrid TDOA/RSS based localization for visible light systems," Digital Signal Processing, vol. 86, pp. 19­28, 2019.
[27] E. Monteiro and S. Hranilovic, "Design and implementation of colorshift keying for visible light communications," Journal of Lightwave Technology, vol. 32, no. 10, pp. 2053­2060, May 2014.
[28] K. Choi, Y. Jang, M. Ju, and Y. Park, "Visible light communication with color and brightness control of RGB LEDs," ETRI Journal, vol. 35, no. 5, pp. 927­930, 2013.
[29] S. Gezici, "A survey on wireless position estimation," Wireless Personal Communications, vol. 44, no. 3, pp. 263­282, Feb. 2008.
[30] D. Karunatilaka, F. Zafar, V. Kalavally, and R. Parthiban, "LED based indoor visible light communications: State of the art," IEEE Communications Surveys & Tutorials, vol. 17, no. 3, pp. 1649­1678, 3rd Quart. 2015.
[31] J. M. Kahn and J. R. Barry, "Wireless infrared communications," Proceedings of the IEEE, vol. 85, no. 2, pp. 265­298, Feb. 1997.
[32] P. Chvojka, S. Zvanovec, P. A. Haigh, and Z. Ghassemlooy, "Channel characteristics of visible light communications within dynamic indoor environment," Journal of Lightwave Technology, vol. 33, no. 9, pp. 1719­1725, May 2015.
[33] L. Li, P. Hu, C. Peng, G. Shen, and F. Zhao, "Epsilon: A visible light based positioning system," in 11th USENIX Symposium on Networked Systems Design and Implementation (NSDI), Seattle, WA, Apr. 2014, pp. 331­343.
[34] S.-H. Yang, E.-M. Jung, and S.-K. Han, "Indoor location estimation based on LED visible light communication using multiple optical receivers," IEEE Communications Letters, vol. 17, no. 9, pp. 1834­1837, Sep. 2013.
[35] H. V. Poor, An Introduction to Signal Detection and Estimation. New York: Springer-Verlag, 1994.
[36] A. Mostafa and L. Lampe, "Optimal and robust beamforming for secure transmission in MISO visible-light communication links," IEEE Transactions on Signal Processing, vol. 64, no. 24, pp. 6501­6516, Dec. 2016.

