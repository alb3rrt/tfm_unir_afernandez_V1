arXiv:2106.00401v1 [math.PR] 1 Jun 2021

On moments of downwards passage times for spectrally negative L´evy processes
Anita Behme and Philipp Lukas Strietzel
June 2, 2021
Abstract
The existence of moments of first downwards passage times of a spectrally negative L´evy process is governed by the general dynamics of the L´evy process, i.e. whether it is drifting to +, - or oscillates. Whenever the L´evy process drifts to +, we prove that the -th moment of the first passage time (conditioned to be finite) exists if and only if the ( + 1)-th moment of the L´evy jump measure exists, thus generalizing a result shown earlier by Delbaen for Cram´er-Lundberg risk processes [2]. Whenever the L´evy process drifts to - we prove that all moments of the passage time exist, while for an oscillating L´evy process we derive conditions for non-existence of the moments and in particular we show that no integer moments exist. Moreover we provide general formulae for integer moments of the first passage time (whenever they exist) in terms of the scale function of the L´evy process and its derivatives and antiderivatives.
2020 Mathematics subject classification. 60G51, 60G40 (primary), 91G05 (secondary)
Keywords: conjugate subordinator; Cram´er-Lundberg risk process; exit time; fluctuation theory; first hitting time; fractional calculus; moments; Marchaud derivative; ruin theory; spectrally negative L´evy process; subordinator; time to ruin

1 Introduction

Let X = (Xt)t0 be a spectrally negative L´evy process, i.e. a L´evy process that does not exhibit positive jumps, starting in zero. In this article we study moments of the first (downwards) passage time of -x, x  0, of the process X, that is moments of

x- := inf {t > 0 : Xt < -x} ,

(1.1)

conditioned on finiteness of this stopping time.
The first passage time x- - sometimes also referred to as exit time - of (spectrally negative) L´evy processes is a well known object that has been studied by many authors, see

Technische Universit¨at Dresden, Institut fu¨r Mathematische Stochastik, Fakulta¨t Mathematik, 01062 Dresden, Germany, anita.behme@tu-dresden.de and philipp.strietzel@tu-dresden.de, phone: +49-351-463-32425, fax: +49-351-463-37251.

1

e.g. [4, Sec. 9.5] for a general overview. However, most results are limited on giving a

representation of the Laplace transform of the first passage time.

In case of a Brownian motion with drift p  R, due to continuity of the paths, the first

passage time x- coincides with the first hitting time of -x, i.e. with x-, = inf{t > 0 :

Xt = -x}. In this special case, x- is known to have Laplace transform, cf. [11, Eq. I.(9.1)],



E[e-qx- ] = e-( p2+2q+p)x, x  0, q > 0,

(1.2)

and its distribution is given explicitely as, cf. [11, Eq. I.(9.2)],

P(x-



dz)

=

x

e dz, -

(x+pz)2 2z

2z3

x, z  0,

where in both formulas we assumed the process to be standardized, i.e. such that 2 = 1. For general spectrally negative L´evy processes the first hitting time and the first passage time can be related via the overshoot Xx-  0 as shown in [3]. In particular, for spectrally negative -stable processes (1 <  < 2) this relation reads, cf. [15],

x-, = x- - (Xx- )^x+,,

(1.3)

where ^x+, is an independent copy of the first upwards hitting time x+, = inf{t > 0 : Xt = x}. The hitting time x-, of a spectrally one-sided stable process has been studied e.g. in [10, 15, 7]. In particular, in [15] fractional moments and a series representation of the density x-, are provided.

The first downwards passage time x- has also been extensively studied in the field of actuarial mathematics where the spectrally negative L´evy process X is interpreted as risk
process and shifted to start in x  0. Then, due to the space homogeneity of the L´evy process, x- coincides with the time of ruin, i.e. the first time the process passes the value 0. The most prominent example for such a risk process is the classical Cram´er-Lundberg
model, where X is chosen to be a spectrally negative compound Poisson process, i.e.

Nt
Xt = x + pt - Si, t  0.
i=1

(1.4)

Hereby x  0 is interpreted as initial capital, p > 0 denotes a constant premium rate,
the Poisson process (Nt)t0 represents the claim counting process, and the i.i.d. positive random variables {Si, i  N} are the claim size variables and independent of (Nt)t0. For this model, under the profitability assumption E[X1] > 0, it is shown in [2] for all  > 0 that the -th moment of the ruin time exists, if and only if the (+ 1)-th moment of the claim size distribution exists. The generalization of this result to arbitrary spectrally
negative L´evy processes is a main result of this paper and will be presented and proved in Section 3. Note that, while the proof given in [2] relies on results on the speed of convergence of random walks, we use a completely different approach here via fractional
differentiation of Laplace transforms. In particular our approach allows us to relate the existence of E[(x-)|x- < ] with the existence of the -th moment of the subordinator (x+)x0 of upwards passage times x+ = inf{t > 0 : Xt > x} at a specific random time. As a by-product we show that (x+)x0 is a special subordinator and identify its conjugate subordinator.

Before presenting and proving our main theorem on the existence of moments of the first passage time in Section 3, we collect various preliminary results on (spectrally negative)

2

L´evy processes and fractional derivatives in Section 2. In the final Section 4 we focus on integer moments of (x-|x- < ) and derive semi-explicit formulae for these in terms of scale functions, their derivatives and their integrals.

2 Preliminaries

Throughout this article let X = (Xt)t0 be a L´evy process, i.e. a c`adla`g stochastic process with independent and stationary increments, defined on a filtered probability space
(, F , F, P). It is well-known that the L´evy process X is fully characterized by its characteristic exponent , which is defined via e-t() = E[eiX(t)] and takes the form

()

=

ia

+

1 2

22

+

R

1 - eiy + iy1{|y|<1}

(dy),

  R,

for constants a  R, 2  0, and a measure  on R\{0} satisfying R(1  y2)(dy) < . The measure  is called the L´evy measure or jump distribution of X, while (2, a, ) is

the characteristic triplet of X.

If X has no upwards jumps, i.e. if ((0, )) = 0, then X is called spectrally negative.

In

this

case

it

is

handy

to

use

the

Laplace

exponent

()

:=

1 t

log E[eXt],





0,

of

-X

instead of the characteristic exponent, which then can be written in the form

()

=

c

+

1 2

22

+

(0,)

e-y - 1 + y1{y<1}

(dy),

(2.1)

where c = -a  R, 2  0, and (dy) = (- dy) is the mirrored version of the jump measure which is therefore defined on (0, ).
The Laplace exponent  admits some useful properties: Clearly (0) = 0, and lim () = . Moreover, on (0, ) the function  is infinitely often differentiable and strictly convex. Lastly, as  is nothing else than the cumulant generating function of X1, it carries information on the moments of X. In particular it is well-known, cf. [13, Cor. 25.8], that for any  > 0

E[|X1|] <  if and only if

|y| (dy) < ,
|y|1

and for  = k  N0 this in turn implies

|k(0+)| := |(k)(0+)| < .

(2.2) (2.3)

Note that throughout this article qkf (q, z) denotes the k-th derivative of a function f with respect to q, while q := q1. In case of only one parameter, we will usually omit the subscript.
We will frequently use the Laplace exponent's right inverse that we always denote by

(q) := sup{  0 : () = q}, q  0.

From the mentioned properties of  it follows immediately that

(0) = 0 if and only if (0+)  0,

3

while (0) > 0 if and only if (0+) < 0.

Moreover the function q  (q) is strictly monotone increasing on [0, ), infinitely often differentiable on (0, ), and it is the well-defined inverse of () on the interval [(0), ), i.e.
(()) =  and ((q)) = q,   [(0), ), q  0.
Thus applying the chain rule on q  q = ((q)) immediately yields

(q)

=

q(q)

=

1 ((q))

,

q  0,

(2.4)

where the case q = 0 is interpreted in the limiting sense q  0. Finally note that, cf [9, Theorem 8.1 (ii)],

lim q = (0+), if (0+)  0,

q0 (q)

0,

else.

(2.5)

For proofs of the stated properties and a more thorough discussion of L´evy processes in general we refer to [9] and [13].
As announced in the introduction, we are interested in the first downwards passage time x- of -x, x  0, as defined in (1.1), or, more precisely, in the passage time, given that the process passes through -x, i.e.

x-|x- <  .

(2.6)

Note that in the case that (0+) = E[X1]  [-, 0] we have x- = (x-|x- < ) as X enters the negative half-line almost surely. In the case (0+) > 0 the term passage time
will be typically used for the conditioned quantity (2.6). To avoid trivialities we shall throughout exclude the case that X is a pure drift, which implies that we always have P(x- < ) > 0.

To study x- (or (x-|x- < )) we will use the concept of scale functions. Recall that for any q  0 the q-scale function W (q) : R  [0, ) of the spectrally negative L´evy process X with W (q)(x) = 0, x < 0, is the unique function such that for x  0 its Laplace

transform satisfies


e-xW (q)(x) dx =

1,

0

() - q

for all  > (q). Furthermore the integrated q-scale function Z(q) : R  [0, ) is given by

x
Z(q)(x) := 1 + q W (q)(y) dy,
0

and it fulfills, cf. [9, Thm. 8.1],

E

e 1 -qx- {x-<}

=

Z (q) (x)

-

q (q)

·

W

(q)(x),

x  R, q  0.

(2.7) (2.8)

In the limit q  0 this immediately implies

P(x- < ) = 1 - (0  (0+)) · W (0)(x), x  R,

(2.9)

4

where we use the standard notation  to denote the maximum. Observe that the functions q  W (q)(x) and q  Z(q)(x) may be extended analytically to C, which means especially that they are infinitely often differentiable with bounded derivatives on [0, ). Again, we refer to [9] for missing proofs and further details. For detailed accounts on scale functions and their numerous applications we also refer to [1] and [8].
Lastly, let us recall that fractional moments of non-negative random variables can be computed via fractional differentiation of the corresponding Laplace transform as shown in [18]. More precisely, define for any   (0, 1) the following variation of the Marchaud fractional derivative of a function f (z), z  0,

Dzf (z)

=

(-1) ·  (1 - )

z



f (z) - f (u) (u - z)+1

du,

(2.10)

while for   1 with n :=  denoting the largest integer smaller or equal to 

Dzf (z) = znDz-nf (z).

Then by [18, Thm. 1] for any non-negative random variable T with Laplace transform

g(z) = E[e-zT ], z  0, the -th absolute moment of T exists, if and only if Dzg(0) exists,

in which case

E[T ] = (-1)-Dg(0).

(2.11)

With this we can easily derive the following lemma.

Lemma 2.1. For any  > 0, x  0, the -th moment of the first downwards passage time x-|x- <  of a spectrally negative L´evy process is given by

E

(x-) x- < 

=

(-1) P(x- < )

·

Dq

Z (q) (x)

-

q (q)

·

W (q)(x)

,
q=0

(2.12)

and it exists if and only if the right-hand side exists and is finite.

Proof. As

E

e 1 -qx- {x-<}

=E

e-qx- x- < 

· P(x- < )

the claim follows immediately from (2.11) and (2.8).

3 Existence of moments
In [2], Delbaen showed in a classical Cram´er-Lundberg model (1.4) that is profitable, i.e. with (0+) > 0, that for any  > 0 the -th moment of the ruin time exists if and only if the ( + 1)-th moment of the claim sizes exists. Delbaen's proof relies on results on the speed of convergence of random walks. In this paper we use an alternative approach via fractional derivatives of Laplace transforms to prove an extension of the result in [2] to any spectrally negative L´evy process. Moreover, we additionally consider the nonprofitable settings of (0+)  0.
Our main result in this section thus reads as follows.

5

Theorem 3.1. Let (Xt)t0 be a spectrally negative L´evy process with Lapace exponent  as in (2.1), and let x- denote its first passage time of -x for x  0.
(i) If (0+) < 0, then for any  > 0 and x  0 E (x-) < .
(ii) If (0+) > 0, then for any  > 0 and x > 0

E (x-)|x- <  <  if and only if

y+1(dy) < .
[1,)

For x = 0 the above equivalence remains true for all  > 0 whenever (Xt)t0 is of bounded variation. For (Xt)t0 of unbounded variation 0- = 0 a.s. (iii) Assume (0+) = 0.

(a) If there exists   (0, 1] such that [1,) y+1(dy) = , then for any x > 0 and   

E (x-)|x- <  = .

(3.1)

(b)

If

(0+) < ,

then

(3.1)

holds

for

any

x>0

and

>

1 2

.

In particular, (3.1) holds for any x > 0 and   1. For x = 0 the above statements are true for the given ranges of  whenever (Xt)t0 is of bounded variation. For (Xt)t0 of unbounded variation 0- = 0 a.s.

Remark 3.2. Note that a priori the above theorem does not make any restrictions concerning possible choices of the location parameter c  R of (Xt)t0. However, as by [13, Example 25.12],

c-

y(dy) = E[X1] = (0+),

[1,)

in cases (ii) and (iii) the assumption (0+)  0 implies that actually

(3.2)

c

y(dy)  0.

[1,)

In particular c < 0 is a valid choice only in case (i).

Remark 3.3. At first glance, Theorem 3.1 (iii) suggests that for an oscillating process (Xt)t0 no fractional moments of the first passage time of zero exist. This however is not true in general and we provide two counterexamples in the following.

(i) Consider a (standardized) Brownian motion without drift for which by (1.2)

E e-q·x-


= e- 2q·x,

x  0.

Then P(x- < ) = 1 and from (2.10) and (2.11) we obtain for any   (0, 1) that



E[(x-)] = (-1)-


De- 2q·x

=
q=0

 (1 - )

 0

1

- e- 2u·x u+1

du,

(3.3)

which any 

is 

fi12 nwitheicifhasnhdowons ltyhiaftThe(o0r,e12m).

In particular, 3.1 (iii) (b) is

in this example (3.1) near to being sharp.

holds

for

6

(ii) Consider a spectrally negative, -stable L´evy process (Xt)t0, with index   (1, 2), such that the Laplace exponent of -X is given by () =  and in particular (0) = 0. For such a process it has been shown in [15, Cor. 1] that the first hitting time x-, := inf{t > 0 : Xt = -x} admits finite fractional moments, namely
E[(x-,)] <  for all   (-1 - 1/, 1 - 1/), x > 0.
However, as x-  x-, a.s. by (1.3), this immediately implies that also
E[(x-)] <  for all   (0, 1 - 1/), x > 0.

To prove Theorem 3.1 we start with a simple lemma that reduces the problem of existence of moments of the first passage time to finiteness of (fractional) derivatives of a certain function in zero.

Lemma

3.4.

Set

(q)

:=

q (q)

,

q

>

0.

Then

for

any



>

0

and

x

>

0

E (x-)|x- <  < 

if and only if

lim
q0

Dq(q)

< .

(3.4)

If x = 0 then (3.4) holds if and only if (Xt)t0 is of bounded variation. If (Xt)t0 is of unbounded variation, then 0- = 0 a.s.

Proof. It follows immediately from Lemma 2.1 that E [(x-)|x- < ] <  if and only if limq0 Dq Z(q)(x) - (q) · W (q)(x) < . However, q  W (q)(x) and q  Z(q)(x) are infinitely often differentiable with bounded derivatives on [0, ). Hence, linearity of the (fractional) derivative reduces the problem to finiteness of limq0 Dq (q) · W (q)(x) . Now remark that (except of the constant factor (-1)) the definition of the Marchaud
derivative given in (2.10) coincides with the one of the fractional derivative D- in [12, Eq. (5.58)]. This in turn is equivalent to the Liouville derivative for sufficiently good functions,
see [12, Remark 5.3] for details. We may therefore apply the product rule for fractional Liouville derivatives, cf. [17, p. 206], to (q) · W (q)(x). Recalling again, that q  W (q)(x) is infinitely often differentiable with bounded derivatives and that W (q)(x) > 0 for any x > 0, we conclude then immediately that limq0 Dq (q) · W (q)(x) <  if and only if limq0 Dq(q) <  as stated. If x = 0 note that W (q)(0) > 0 if and only if (Xt)t0 is of bounded variation, cf. [1, Eq.
(25)], and in this case the above argumentation yields the result. If (Xt)t0 is of unbounded variation we have W (q)(0) = 0, cf. [1, Eq. (25)], and we see from (2.8) that 0- = 0 a.s.

With this we can now directly prove part (i) of Theorem 3.1.

Proof of Theorem 3.1 (i). From the general Leibniz formula we obtain for any k  N

k
qk(q) = qk q · ((q))-1 =

k 

· qq · qk- (q)-1

=0

= q · qk (q)-1 + k · qk-1 (q)-1 .

Recall that (q) is the inverse of  on [(0), ) (0, ) which, in turn, is infinitely often differentiable on (0, ). Hence, (q) : [0, )  [(0), ) is infinitely often differentiable

7

with bounded (right) derivative in 0. Furthermore (·)-1 is an infinitely often differentiable function on (0, ). Consequently, we may apply Fa`a di Bruno's formula, cf. [6, Equation (2.2)], and obtain

k
qk ((q))-1 = (-1) · ! · ((q))--1 · Bk, (q), ..., (k-+1)(q) ,
=1

(3.5)

where Bk, denote the partial Bell polynomials. Hereby, as (0) > 0 we have (0)--1 <  for all  = 1, . . . , k. Moreover, Bk,((0), ..., (k-+1)(0)), being a polynomial, is finite, if (n)(0) is finite for every n  {1, ..., k - + 1}. This has been argued to hold above. Thus
every summand on the right hand side of (3.5) is finite in the limit q  0 which implies that qk(q) is finite for all q  0 and k  N. Clearly this implies finiteness of Dq(q) for all q  0 and  > 0 and the claim follows via Lemma 3.4.

The proof of the second and third part of Theorem 3.1 is more involved and relies on

the interpretation of (q) as Laplace exponent of a certain killed subordinator that is

shown in the next proposition. Recall that a subordinator (Yt)t0 is a L´evy process with

non-decreasing

paths

whose

Laplace

exponent

()

=

-

1 t

log

E[e-Yt ]

is

always

of

the

form


() = c ·  + (1 - e-y)(dy),
0

(3.6)

for   0, a drift c  0 and a measure  such that (0,)(1  y)(dy) < . A killed subordinator (Yt)t0 is defined via

Yt =

Yt, ,

if t < e, if t  e,

where (Yt)t0 is a subordinator, e is an independent, Exp()-distributed time,  > 0, and  denotes some cemetery state. As usual, we interpret  = 0 as e =  corresponding to no killing. The Laplace exponent Y of a killed subordinator is given by

Y () = - log E e-Y1 = - log E e-Y1 · 1{1<e} =  + Y (),

(3.7)

for the Laplace exponent Y () of (Yt)t0.

Further, for any x  0, let x+ := inf{t > 0 : Xt > x} be the first upwards passage time of x, i.e. the first time that Xt is above x. It is well-known, cf. [9, Thm. 3.12], that for all
q0

E e-q·x+ · 1{x+<} = e-(q)x, x  0.

(3.8)

If furthermore E[X1] = (0+)  0, then (x+)x0 is a subordinator with Laplace exponent (q), cf. [9, Cor. 3.14].

Proposition 3.5. Assume that (0+)  0. Set

()

:=

() 

=

(0+)

+

2 2



+

 0

1 - e-y ((y, )) dy,

 > 0,

8

then () is the Laplace exponent of a killed subordinator (Yt)t0, i.e. E[e-Yt] = e-t(), where we assume (Yt)t0 to be independent of (x+)x0. Moreover (Y+t)t0 is a killed subordinator with Laplace exponent

-

1 t

log

E

e-q·Y+t

= (q),

q  0.

(3.9)

Proof. From (2.1) we obtain

()

=

() 

=

c+

2 2



+

1 

(0,)

e-y - 1 + y1{y<1}

(dy)

=

c

+

2 2



+

(0,)

1 

e-y - 1 + y1{y<1} (dy)

=

c

+

2 2



+

(0,1)

y 0

1 - e-z

dz (dy) +

[1,)

y 0

- e-z dz (dy)

where by partial integration

y
1 - e-z dz(dy)

(0,1) 0

y

1

=

1 - e-y ((y, )) dy +

1 - e-z dz((y, ))

(0,1)

0

y=0

=

1 0

1 - e-y

((y, )) dy + (1 +

1 

(e-

-

1))((1,

)),

since by Taylor's expansion

lim
y0

y

+

1 

(e-y

-

1)

((y, ))

=

 2

lim(y2
y0

+

O(y3))((y,

))

=

0,

as  is a L´evy measure. Likewise we compute

y
- e-z dz (dy) =

- e-y ((y, )) dy - 1(e- - 1)((1, )),

[1,) 0

[1,)



such that we can summarize and obtain

()

=

c

+

((1,

))

+

2 2



+

 0

1{y<1} - e-y ((y, )) dy

= c + ((1, )) -

[1,)

((y,

))

dy

+

2 2



+

 0

1 - e-y ((y, )) dy

=c-

[1,)

y(dy)

+

2 2



+

 0

1 - e-y ((y, )) dy,

where in the last step we again used partial integration and the fact that [1,) x(dx) is finite due to (3.2) and the assumption (0+)  0. Moreover, via (3.2) it is obvious from
the given form of  that it is the Laplace exponent of a killed subordinator with killing rate (0+)  0. Finally, as (x+)x0 is a subordinator with Laplace exponent (q), we observe immediately

E exp -qY+t

= E exp

-q + Yt

· 1{t<e(0+)}

9

= E E exp -qy+ |Yt = y · 1{t<e(0+)} = E exp -(q)Yt · 1{t<e(0+)} = exp (-t((q))) ,

which proves that (Y+t)t0 is a killed subordinator with Laplace exponent ((q)) =

((q)) (q)

=

q (q)

=

(q)

as

stated.

Remark 3.6. Note that the above proposition implies that - as long as (0+)  0 -

the subordinator (x+)x0 is a special subordinator, since its conjugate Laplace exponent

q (q)

=

(q)

is

shown

to

be

the

Laplace

exponent

of

a

(killed)

subordinator.

See

e.g.

[9,

Chapter 5.6] or [14, Chapter 11] for general information on special subordinators and their

Laplace exponents that are also known as special Bernstein functions.

Taking together Lemma 3.4, Proposition 3.5 and Equation (2.11) it is now an immediate consequence that, assuming (0+)  0, for all  > 0

E (x-)|x- <  <  if and only if E[(Y+1)] < ,

(3.10)

for all x  0, where in the case x = 0 we additionally assume that (Xt)t0 is of bounded variation as otherwise 0- = 0 a.s.
In order to find suitable conditions for the right-hand side of (3.10), we next prove a general statement concerning the existence of moments of a subordinated subordinator.

Proposition 3.7. Let (Zt)t0 be a non-zero subordinator, and let (Yt)t0 be a (possibly killed) non-zero subordinator, independent of (Zt)t0. If E[Z1] < , then for all  > 0

E[ZY1] <  if and only if

E[Z1] <  and E[Y1] <  .

If E[Z1] =  and   (0, 1), then E[ZY1] <  implies E[Z1] <  and E[Y1] < .

To prove this proposition two more lemmas are needed, the first of which is a simple inequality and likely to be known.

Lemma 3.8. Let n  N, a1, ..., an  0 and r  1. Then (a1 + ... + an)r  nr-1 · (ar1 + ... + arn) .
If r  1, then (3.11) holds with " " instead of " ".

(3.11)

Proof. Recall that (·)r for r  1 is a convex function on [0, ). Thus by a simple induction of the convexity property

1 n

·

a1

+

...

+

1 n

·

an

r



1 n

· ar1

+

...

+

1 n

·

arn

=

1 n

(ar1

+ ... +

arn) .

Multiplication with nr immediately implies (3.11). For r  1 the function ( · )r is concave and the proof is completely analogue.

10

Lemma 3.9. Let (Zt)t0 be a non-zero subordinator such that E[Z1] < . If E[Z1] <  for some  > 0, then E[Zt] <  for all t  0 and the mapping t  E[Zt], t  1, is of polynomial order .

Proof. Let  be the Laplace exponent of the subordinator (Zt)t0. By [13, Cor. 25.8] finiteness of E[Z1] for some  > 0 implies finiteness of E[Zt] for all t  0. Moreover, by our assumptions necessarily E[Z1] = (0+)  (0, ) and, cf. [13, Ex. 25.12],
E[Zt] = t · (0+) = t · E[Z1].

Let now   1. Then by Jensen's inequality

E[Zt]  E[Zt] = t · E[Z1],

which yields a lower bound of degree . In order to show an upper bound set n := t

such

that

t/n

=:

cn



[

1 2

,

1]

and

let

i

be

i.i.d.

copies

of

Z1.

Then,

due

to

the

infinite

divisibility and monotonicity of Z, it holds that

E[Zt]  E[Zn] = E

n



i

i=1

n

 E n-1 · i = n · E[1] = t · c-n  · E[Z1]  t · 2 · E[Z1],

i=1

(3.12)

where we used (3.11) for the second inequality. To prove the statement for   (0, 1) note that ( · ) is concave. Hence, Jensen's inequality yields an upper bound in this case. The lower bound follows analogously to (3.12), setting n := t, and applying the second part of Lemma 3.8.

Proof of Proposition 3.7. We write Z, bZ for the L´evy measure and drift of Z, respec-
tively, and likewise Y , bY for L´evy measure and drift of Y . Then as (ZYt)t0 is a (killed) subordinator with L´evy measure , say, E[ZY1] <  is equivalent to, cf. [13, Cor. 25.8],

z(dz) < .
[1,)

(3.13)

where the L´evy measure  of the subordinated process is given by, cf. [13, Thm. 30.1],

(B) = bY Z(B) +

µs(B)Y (ds),

(0,)

for any Borel set B in (0, ), where µ = L(Z1) denotes the distribution of Z1. Thus

z(dz) = bY

zZ (dz) +

z d

µs(z)Y (ds)

[1,)

[1,)

[1,)

(0,)

= bY

zZ (dz) +

zµs(dz)Y (ds)

[1,)

(0,) [1,)

(3.14)

where all terms are non-negative and hence the appearing sum is finite if and only if both summands are finite. Again from [13, Cor. 25.8] we know that [1,) zZ(dz) <  if and

11

only if E[Z1] <  if and only if E[Zs] <  for all s  0. Thus assume [1,) zZ(dz) <  from now on, then also [1,) zµs(dz) = E[1{Zs1}Zs] < . Furthermore

zµs(dz)Y (ds) =

E[1{Zs1}Zs]Y (ds)

(0,) [1,)

(0,)

=

E[1{Zs1}Zs]Y (ds) +

E[Zs]Y (ds) -

E[1{Zs<1}Zs] Y (ds),

(0,1)

[1,)

[1,)

[0,1)

(3.15)

where the left-hand side of the equation is finite if and only if the right-hand side is. Hereby, the last integral as well as the sum of all three is obviously non-negative. Consider the first integral. It holds that

E[1{Zs1}Zs] = P(Zs  1) · E Zs Zs  1 ,
where E[Zs|Zs  1] =: C1 <  since we assumed E[Zs] < . Moreover, from [13, Lemma 30.3] it follows that P(Zs  1)  C2s for some C2  (0, ). Thus,

E[1{Zs1}Zs]Y (ds)  C1C2

sY (ds),

(0,1)

(0,1)

is finite because Y is a subordinator which implies (0,)(1  y)Y (dy) < . For the second integral note that by Lemma 3.9 the mapping s  E[Zs] is of polynomial order  for all s  1. Thus it follows that the second summand in (3.15) and hence also the
second summand in (3.14) is finite if and only if [1,) sY (ds) <  and [1,) zZ(dz) < . This finishes the proof of the equivalence.
In the case E[Z1] =  and   (0, 1) we can not apply Lemma 3.9 to find a necessary and
sufficient condition for finiteness of the second summand in (3.15). However, an inspection
of the proof of Lemma 3.9 shows, that even in this case the mapping s  E[Zs] can be bounded from below by a function of polynomial order  for all s  1. Thus finiteness of the
second summand in (3.15) still implies [1,) zZ(dz) < , and moreover finiteness of all summands in (3.14) implies [1,) sY (ds) <  and [1,) zZ (dz) <  as stated.

Let us now concentrate on the case (0+) > 0 treated in Theorem 3.1(ii), where in the light of (3.10) it remains to prove that E[(Y+1 )] <  is equivalent to [1,) y+1(dy) < . To show this we need the following useful connection between the existence of integer moments of 1+ and X1.

Lemma 3.10. Assume that (0+) > 0. Then for all k  N0

lim (k)(q) < 
q0

if and only if

lim (k)(q) < .
q0

(3.16)

Proof. We prove the statement by induction. Clearly, for k = 0 there is nothing to show, while for k = 1 it follows from the assumption (0+) > 0 and the fact that (Xt)t0 is spectrally negative, that (0+)  (0, ). By (2.4) we thus conclude that (0+) = 1/(0+)  (0, ) and again there is nothing to show. Further, for k = 2 we compute via
(2.4)

(q) = q

1 ((q))

=

-

((q)) ((q))3

,

q > 0,

12

such that

(0+)

=

-

(0+) (0+)3

which proves the claim for k = 2. Assume now that (3.16) holds for all  = 1, ..., n - 1. If there exists   {1, ..., n - 1} such that both sides of (3.16) are infinite, then for all   {, ..., n - 1} both terms are infinite
as well. Therefore we assume that both sides are finite for all  = 1, ..., n - 1. By definition of  we have ((q)) = q for all q  0 and hence qn((q)) = 0 for all n  2. Using Fa`a di Bruno's formula, cf. [6, Equation (2.2)], for n  2 we therefore
conclude that

n
0 = (k)((q)) · Bn,k((q), ..., (n-k+1)(q)),
k=1

where Bn,k still denote the partial Bell polynomials. Thus we get

(n)(q)

=

Bn,1((n)(q))

=

-1 ((q)

·

n

(k)((q)) · Bn,k

(q), ..., (n-k+1)(q)

k=2

=

-1 ((q))

·

n-1

(n+1-j)((q))

·

Bn,n+1-j

(q), ..., (j)(q)

,

j=1

where the left-hand side is finite if and only if the right-hand side is. However, the righthand side is finite in the limit q  0 if and only if

lim
q0

1 ((q))

·

(n)((q))

·

Bn,n((q))

= lim q0

1 ((q))

·

(n)((q))

·

(q)n

=

(n)(0+) (0+)n+1

< ,

since all other summands are finite in the limit q  0 by assumption.

We are now in the position to present the proof of part (ii) of Theorem 3.1.

Proof of Theorem 3.1(ii). Assume (0+) > 0 and additionally that x > 0, or x = 0 and (Xt)t0 is of bounded variation. As mentioned, using Lemma 3.4, Proposition 3.5 and (2.11) we see immediately that for all  > 0

E (x-)|x- <  <  if and only if E[(Y+1)] < . Further applying Proposition 3.7 in the present situation it follows that

E[(Y+1)] <  if and only if

E[(1+)] <  and E[Y1] <  ,

(3.17)

since E[1+] = (0+) = 1/(0+) <  as noted in the proof of Lemma 3.10. Furthermore, E[Y1] <  is equivalent to finiteness of

y((y, )) dy
[1,)

=



1 +

1

[1,)

y+1(dx)

-



1 +

1 ((1,

))

(3.18)

13

by partial integration. Thus E[Y1] <  if and only if E[|X1|+1] < 
such that E[|X1|+1] <  is shown to be a necessary condition for E [(x-)|x- < ] < . However, it is a sufficient condition as well, since E[|X1|+1] <  implies E[|X1|k] <  for k =  + 1  1. This in turn implies E[(1+)k] <  by (2.3) and Lemma 3.10, which then yields E[(1+)] < , since  < k. Thus both conditions on the right-hand side of (3.17) hold if and only if E[|X1|+1] <  which finishes the proof.

Finally we consider the oscillating case of (0+) = 0. Again, in the light of (3.10) we need

to investigate conditions for

the existence of E[(Y+1)] = .

E[(Y+1 )],

where

this

time

we

restrict

ourselves

on

finding

Proof of Theorem 3.1 (iii). Assume that (0+) = 0 and additionally that x > 0, or x = 0 and (Xt)t0 is of bounded variation. (a),   (0, 1]: From (3.10) we have

E (x-)|x- <  =  if and only if E[(Y+1)] = ,

and by Proposition 3.7 for   (0, 1) the latter follows in particular if E[Y1] = .

This however is equivalent to [1,) y((y, )) dy =  and via (3.18) it is furthermore

equivalent to [1,) y+1(dy) = .

Consider now that case  = 1, i.e. E[Y1] = . From (2.4) it follows that (0+) =

E[1+] =  and an inspection of the proof of Proposition 3.7 reveals that in this setting

also E[Y+1] = . This again (b) We consider a fixed  

implies the statement.

(

1 2

,

1)

and

prove

(3.1)

for

the

chosen

.

This

will

immediately

imply the statement also for any   1.

As before, from (3.10) we have

E (x-)|x- <  =  if and only if E[(Y+1)] = ,
where by Proposition 3.7 the latter follows if E[(1+)] = . Here, by (3.8), (2.11) and (2.10),

E[(1+)] = (-1)- De-(q) q=0

= (-1)-

(-1) ·  (1 - )

 q

e-(q) - e-(u) u+1

du

q=0

=

 (1 -

)

 0

1

- e-(u) u+1

du,

(3.19)

where the left-hand side is finite if and only if the right-hand side is finite. As  is monotonely increasing with (0) = 0 and (u) u-  we clearly have for all

>0

 

1

- e-(u) u+1

du



 

1 u+1

du

<

.

Thus by (3.19)

E[(1+)] <  if and only if

 0

1 - e-(u) u+1

<



for

some



>

0.

(3.20)

14

By Taylor's expansion, as u  0, the term 1 - e-(u) is of the same order as u(u)e-(u).

Moreover, by (2.4),

lim
u0

u(u) u

=

lim
u0

(u) u-1

=

lim
u0

u1- ((u))

.

Recall

that





(

1 2

,

1)

and

(0+)

<

.

By

a

twofold

application

of

l'Hospital's

rule

we

get

lim
u0

u1- ((u))

=

lim
u0

(1 - ) · u- ((u)) · (u)

=

(1 - ) (0+)

·

lim
u0

((u)) u

=

(1 - ) (0+)

· lim u0

((u)) · (u)  · u-1

=

(1 - 

)

·

lim
u0



u1- ((u))

.

As



=

1 2

this

can

only

be

true

if

lim
u0

u1- ((u))

=

lim
u0

((u)) u

=

either 0 or ,

(3.21)

which in turn implies

lim
u0

u(u) u

=

lim
u0

u1- ((u))

·

((u)) u

=

lim u1-2
u0

=

.

Thus also

lim
u0

1 - e-(u) u

=

lim
u0

u(u)e-(u) u

=

,

and

in

particular

for

any

C

>

0

there

exists

u0

>

0

such

that

1-e-(u) u

>

C

for

all

u

<

u0.

Hence

 1 - e-(u)

u0 1 - e-(u)

u0 C · u

u0 1

0

u+1

du 
0

u+1

du 
0

u+1 = C · 0

u du = .

By (3.20) this implies E[(1+)] =  and thus the statement.
Lastly, note that (3.1) for all x > 0,   1 is a direct consequence of (a) and (b), as either (0+) <  in which case we can apply (b), or (0+) = , which is equivalent to [1,) y2(dy) =  and hence  = 1 is a possible choice in (a).

4 Representation formulas for integer moments

We end this paper with several explicit formulae for the integer moments of the first passage time of -x in terms of the Laplace exponent  and the q-scale function W (q). We start with a general formula in Proposition 4.1 before considering the first two moments separately in Theorem 4.2. Note that the special case k = 1 of Equation (4.2) below can also easily be derived from [1, Theorem 6.9.A)].

Proposition 4.1. Let X = (Xt)t0 be a spectrally negative L´evy process with Laplace exponent . For any x  0 and any k  N the k-th moment of the first passage time x-|x- <  is given by

E[(x-)k|x- < ]

(4.1)

15

=

(-1)k P(x- < )

lim
q0

x

k

k qk-1W (q)(y) dy -

0

=0

k 

· q(q) · qk-W (q)(x)

,

where

(q)

:=

q (q)

.

Moreover,

with

(W (0))k(x)

denoting

the

k-fold

convolution

of

W (0)(x)

with itself, for all x > 0

E[(x-)k|x-

<

]

=

(-1)k · k! P(x- < )

x
(W (0))k(y) dy
0

-

k =0

()(0+) !

(W

(0))(k-+1)(x)

.

(4.2)

In particular the left-hand side of (4.1) and (4.2) is finite if and only if the right-hand

sides are finite.

Proof of Proposition 4.1. We use (2.12) for  = k  N, i.e.

E

(x-)k x- < 

=

(-1)k P(x- < )

·

lim
q0

qk

Z (q) (x)

-

q (q)

·

W (q)(x)

,

where by induction one can show using the product rule of differentiation that

x

x

qkZ(q)(x) = k · qk-1W (q)(y) dy + q · qkW (q)(y) dy,

0

0

Second, an application of the general Leibniz rule yields

qk

q (q)

·

W (q)(x)

k
=

k 

· q(q) · qk-W (q)(x) ,

=0

such that we can combine and obtain

E[(x-)k|x-

<

]

=

(-1)k P(x- < )

·

lim
q0

x

x

k · qk-1W (q)(y) dy + q · qkW (q)(y) dy

0

0

k
-

k 

· q(q) · qk-W (q)(x)

.

l=0

Now (4.1) follows, since W (q) and

x 0

W

(q)(y)

dy

are

analytical

w.r.t.

q.

To

prove

the

second

equation, observe that from [9, Eq. (8.29)] for x > 0

qkW (q)(x) = qk q(W (0))(+1)(x) = (qkq)(W (0))(+1)(x),

0

k

which implies limq0 qkW (q)(x) = k!(W (0))(k+1)(x).

The next theorem states formulae for the first and second moment of the first downwards
passage time of a spectrally negative L´evy process X with Laplace exponent . Note that
as in Section 3 we have to distinguish between three cases, where in the first two one has (0+) = E[X1] = 0 and the L´evy process drifts to ±. In the third case (0+) = 0 the process X is oscillating. However, as already seen in Theorem 3.1, in this case no integer
moments of the first passage time exist. Hence we exclude this case in the next theorem as well as the case of (0) > 0, x = 0 and (Xt)t0 being of unbounded variation, where 0- = 0 a.s.

16

Theorem 4.2. Let X = (Xt)t0 be a spectrally negative L´evy process with Laplace exponent  and x  0.

(i) Assume (0+) < 0, then all moments of x- are finite and in particular

E[x-]

=

1 W (0)(x) (0)

-

x
W (0)(y) dy,
0

E[(x-)2] = 2

x 0

lim
q0

qW (q)(y)

dy

-

2 (0)

lim
q0

qW (q)(x)

+

2 · W (0)(x) (0)2 · ((0))

.

(4.3) (4.4)

(ii) Assume that (0+) > 0, and that either x > 0 or (Xt)t0 is of bounded variation. Then E[x-|x- < ] <  if and only if E[X12] < , in which case (0+) < 
and

E[x-|x-

<

]

=

(0+)

·

limq0(qW (q)(x))

+

 (0+) 2· (0+)

·

W (0)(x)

-

1 - (0+) · W (0)(x)

x 0

W

(0)(y)

dy

.

(4.5)

Moreover, E[(x-)2|x- < ] <  if and only if E[|X1|3] < , in which case (0+), |(0+)| <  and

E[(x-)2|x- < ]

(4.6)

=

1

-

1 (0+)

·

W (0)(x)

·

x

2 · lim q0

0

q W

(q)(y)

dy

-

(0+)

lim
q0

q2W

(q)(x)

-

(0+) (0+)

·

lim
q0

qW (q)(x)

-

(0+) 3 · (0+)2

-

(0+)2 2 · (0+)3

W (0)(x) .

Obviously, in order to evaluate any of the formulas (4.1) to (4.6) for a specific L´evy process (Xt)t0, it is necessary to have an explicit expression for its scale function. Collections of processes where this is the case can be found e.g. in [5] and [8]. However, even in case of rather simple scale functions, the computations needed to obtain closed form expressions for the moments of the first passage time involve serious computational efforts. We thus restrain ourselves from providing an explicit example at this place and postpone these considerations to our forthcoming paper [16].
In view of Proposition 4.1, to prove Theorem 4.2 we need to compute the first two derivatives of  and their behaviour as q  0. This will be done in the next two lemmas.

Lemma 4.3. For all q > 0 we have

(q)

=

1 (q)

-

q ((q))

·

(q)2 ,

(q)

=

(q)3

·

2q ((q))2

-

(q)2

·

2 ((q))

+

q (q

· ((q)) )2 · ((q))3

.

(4.7) (4.8)

Proof.

Both

formulas

follow

by

standard

differentiation

of

(q)

=

q (q)

applying

the

quo-

tient and product rule and using relation (2.4).

17

Lemma 4.4. As q  0 we have

(0+) := lim (q) = q0

1 (0)

,

if (0+) < 0,

,  (0+)
2· (0+)

if (0+) > 0 and (0+) < ,

while

(0+) =

, -2
(0)2 · ((0))

- , (0+)
3· (0+)2

 (0+)2 2·(0+)3

if (0+) < 0, if (0+) > 0 and (0+), |(0+)| < .

Proof. The limit of  in the case (0+) < 0 follows immediately from (4.7) since (0) > 0 and ((0+)) > 0, where the latter is a consequence of (0) = 0 = ((0)) and the monotonicity of (q), q > 0. Concerning the second derivative in the case (0+) < 0 observe that the first and last term in (4.8) vanish in the limit since (0) > 0, ((q))  ((0)) > 0, and ((q))  ((0)) as q  0 with (0) > 0 which implies ((0)) < . So only the second term remains and this immediately yields the result. In the case (0+) > 0 we have (0+) = 0. Further
(q) = (((q))-1) = -((q)) · (q)3

by (2.4). Applying l'Hospital's rule we thus obtain

lim (q)
q0

=

lim
q0

(q) - q · (q) (q)2

=

- lim q0

2

·

q · (q) (q) · (q)

=

lim
q0

((q)) 2

·

q

· (q)2 (q)

=

(0+) 2 · (0+)

,

since q/(q)  (0+) by (2.5) and ((q))  (0+) as q  0. To obtain the limit of the second derivative note that from (4.8) we have

(0+)

=

lim
q0

1 ((q))3

·

2q

·

((q))

-

2

·

(q)

·

((q))2 (q)3

+

q

·

((q))

·

(q)

=:

lim
q0

1 ((q))3

·

H1(q),

(4.9)

where the first factor converges to (0+)-3 > 0 as q  0. Applying l'Hospital's rule on H1 we obtain after some rearrangement using (2.4)

lim
q0

H1(q)

=

lim
q0

3q

·

((q))

-

3((q))

·

((q)) 3(q)2

·

(q)

+

q

·

((q))

·

(q)

=

lim
q0

((q))

·

q

-

(q) · ((q)) (q)2

+

lim
q0

q (q)

·

((q)) 3

=

((0+))

·

lim
q0

H2(q)

+

(0+)

·

((0+)) 3

since ((q))  (0+) < , ((q))  (0+) < , and q/(q)  (0+) as q  0 by (2.5). Finally, applying l'Hospital's rule on H2 and rearranging using (2.4) yields

lim
q0

H2(q)

=

lim
q0

1

-

(q)

·

((q)) - (q) · ((q)) 2(q) · (q)

·

(q)

=

-



((0+)) 2

.

Inserting everything into (4.9) now completes the proof.

18

Proof of Theorem 4.2. Finiteness of the moments as stated follows from Theorem 3.1 together with (2.2) and (2.3). Evaluating (4.1) for k = 1 and using (2.5) and (2.9) yields that

E[x-|x-

<

]

=

(0



(0+))

·

limq0(qW (q)(x)) + (0+)W (0)(x) 1 - (0  (0+)) · W (0)(x)

-

x 0

W

(0)

(y)

dy

,

and via Lemma 4.4 we immediately derive (4.3) and (4.5). Likewise, an evaluation of (4.1) for k = 2 leads to (4.4) and (4.6) via (2.5), (2.9), and Lemma 4.4.

References
[1] F. Avram, D. Grahovac, and C. Vardar-Acar. The W, Z scale functions kit for first passage problems of spectrally negative L´evy processes, and applications to control problems. ESAIM: Probability and Statistics, 24:454­525, 2020.
[2] F. Delbaen. A remark on the moments of ruin time in classical risk theory. Insurance: Mathematics and Economics, 9(2-3):121­126, 1990.
[3] R.A. Doney. Hitting probabilities for spectrally positive L´evy processes. J. London Math. Soc., 44:566­576, 1991.
[4] R.A. Doney. Fluctuation theory for L´evy processes. In Jean Picard, editor, Lecture Notes in Mathematics, volume 1897. Springer, Berlin, 2007.
[5] F. Hubalek and A.E. Kyprianou. Old and new examples of scale functions for spectrally negative L´evy processes. In Sixth Seminar on Stochastic Analysis, Random Fields and Applications, Progress in Probability, pages 119­146. Birkh¨auser, 2010.
[6] W.P. Johnson. The curious history of Fa`a di Bruno's formula. The American Mathematical Monthly, 109(3):217­234, 2002.
[7] A. Kuznetsov, A.E. Kyprianou, J.C. Pardo, and A.R. Watson. The hitting time of zero for a stable process. Electron. J. Probab., 19 (30):1­26, 2014.
[8] A. Kuznetsov, A.E. Kyprianou, and V. Rivero. The theory of scale functions for spectrally negative L´evy processes. In L´evy Matters II, Springer Lecture Notes in Mathematics. 2013.
[9] A.E. Kyprianou. Fluctuations of L´evy processes with Applications. Springer, 2nd edition, 2014.
[10] G. Peskir. The law of the hitting times to points by a stable L´evy process with no negative jumps. Electron. Commun. Probab., 13:653­659, 2008.
[11] L.C.G. Rogers and D. Williams. Diffusions, Markov Processes and Martingales. Volume 1: Foundations. Cambridge University Press, 2nd edition, 2000.
[12] S.G. Samko, A.A. Kilbas, and O.I. Marichev. Fractional Integrals and Derivatives - Theory and Applications. Gordon and Breach Science Publishers, Yverdon, 1993.
[13] K. Sato. L´evy Processes and Infinitely Divisible Distributions. Cambridge University Press, Cambridge, 2nd edition, 2013.

19

[14] R.L. Schilling, R. Song, and Z. Vondracek. Bernstein Functions. Theory and Applications. De Gruyter, 2nd edition, 2012.
[15] T. Simon. Hitting densities for spectrally positive stable processes. Stochastics, 83:203­ 214, 2011.
[16] P.L. Strietzel and A. Behme. Moments of the ruin time in a perturbed Cram´er-Lundberg model with phase-type jumps. 2021. Preprint.
[17] V.V. Uchaikin. Fractional Derivatives for Physicists and Engineers: Volume I Background and Theory Volume II Applications. Nonlinear Physical Science. Springer Berlin Heidelberg, 2013.
[18] S.J. Wolfe. On moments of probability distribution functions. In Ross B., editor, Fractional Calculus and Its Applications, volume 457 of Lecture Notes in Mathematics, pages 306­316. Springer, 1975.
20

