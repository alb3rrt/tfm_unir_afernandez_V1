WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS
LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI
Abstract. We construct almost periodic solutions of the one dimensional analytic NLS with external parameters. Our solutions have Sobolev regularity both in time and space and typically solve the equation only in a weak sense. This is the first result of this kind in KAM theory for PDEs.

arXiv:2106.00499v1 [math.AP] 1 Jun 2021

Contents

1. Overview and main result

1

2. Proof of Theorem 1

10

3. Functional setting

12

4. Degree decompositions, projections and normal forms

15

5. Proof of Theorems 2 and 3

17

6. Small divisors and homological equation

19

7. Iterative Lemma and Proof of Theorem 4

25

8. Measure estimates

30

Appendix A. Technicalities

35

Appendix B. Topology, measure and continuous functions on infinite product spaces

38

References

40

1. Overview and main result
In the study of finite dimensional nearly-integrable Hamiltonian systems KAM Theorem play a pivotal role, casting a light that illuminated the picture quite clearly. Indeed under some (generic) non-degeneracy assumptions most of the phase space of such systems is foliated by maximal invariant tori, whose dimension is half of the one of the whole space. In particular the system is not ergodic and the majority of initial data give rise to quasi-periodic solutions that densely fill some invariant torus and are, therefore, perpetually stable. Possible chaotic behaviour is restricted to a set of small measure. On the other hand, in the infinite dimensional setting, for example in the PDEs case, the general picture is so far rather obscure and the main questions still remain unanswered The typical (in the sense of measure) solutions of an infinite dimensional integrable system are the almost-periodic ones1 that lie on maximal infinite dimensional invariant tori; what is their fate under perturbation? Is it still true that the majority of initial data produce perpetually stable solutions? Both the above related questions are completely open and only partial answer in model cases are available. As is usual in KAM Theory, a key point in the study of the dynamics in the neighborhood of these invariant tori, consists in controlling the spectral properties of appropriate linear operators and dealing with the connected problem of small-divisor. The main difficulty is then to guarantee that suitable arithmetic (Diophantine) conditions on the frequencies are fulfilled all along the scheme, so that small-divisors can be bounded accordingly and the almost-periodic dynamics controlled. Extending diophantine (or similar) estimates, which strongly depend on the dimension, to the infinite dimension is not straightforward. In fact all the results on almost-periodic
1i.e. solutions which are limit (in the uniform topology in time) of time-quasi-periodic functions.
1

2

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

solution for PDEs only deal with special model cases and consider parameter dependent equations. Quoting Bourgain [Bou05]: "the role of this parameter is essential to ensure appropriate non-resonance properties of the (modulated) frequencies along the iteration. In the absence of exterior parameters, these conditions need to be realized from amplitude-frequency modulation and suitable restriction of the action-variables. This problem is harder. Indeed, a fast decay of the action-variables (enhancing convergence of the process) allows less frequency modulation and worse small divisors". Indeed, in all the existent literature, the almost periodic solutions have an extremely fast decay in their Fourier coefficients, which approach zero super-exponentially, exponentially or sub-exponentially (Gevrey). This means that those solutions are "very close" to quasi-periodic ones.
For example Po¨schel in [Po¨s02], studies an NLS with a multiplicative potential (producing an infinite set of free parameters) and smoothing nonlinearity and constructs almost-periodic solutions iteratively, through successive small perturbations of finite (but at each step higher) dimensional invariant tori. This leads to a very strong compactness property: in order to overcome the dependence of the KAM estimates on the dimension, the distances of these tori have to shrink super-exponentially, this leading to very regular solutions. See also [GX13] for a generalization of Po¨schel's approach to the analytic cathegory, by using T¨oplitz-Lipschitz function techniques. In his pioneering work [Bou05] on the quintic NLS with Fourier multipliers (providing external parameters in ), Bourgain proposed a different approach which does not rely on approximations by quasi-periodic functions by working directly in Fourier space, and relying on a Diophantine condition which is taylored for the infinite dimension. For most choices of the parameters, this leads to the construction of almost periodic invariant tori which support Gevrey solutions.
The recent work [BMP21] extends the techniques of [Bou05] and proposes a novel, flexible approach which allows to construct in a unified framework, both maximal and elliptic invariant tori of any dimension which are the support of the desired Gevrey solutions, for an NLS with Fourier multipliers. A key improvement with repect to Bourgain's result is that we do not need any lower bound on the Fourier coefficients of the solutions, i.e. our method is not affected by the singularities of action-angle variables. This means for instance that we can construct infinite dimensional elliptic invariant tori . The persistence of the invariant tori is achieved through an abstract normal form theorem "a` la Herman", whose estimates are uniform in the dimension (see [BMP21, Theorems 3 and 7.1]). See also [BM20, Mas19, Mas18] for a survey on this technique.
The possibility of constructing almost-periodic solutions for a fixed PDE, i.e. "eliminating" the external parameters through amplitude-frequency modulation, appears to be intimately related to the regularity issues. Roughly speaking, a fast decay of the "actions" (needed for the scheme to converge) leads to a weak modulation of frequencies which in turn results in bad bounds on the small divisors. Moreover, in the context of completely integrable PDEs, the invertibility of the amplitude-frequency map is known only in spaces of very low regularity (see [KM18]). It then becomes fundamental to look for almost-periodic solutions in lower regularity spaces if we want to bypass the introduction of external parameters. However this appears to be a very difficult problem, due to the presence of extremely small divisors. An analogous problem with rapidly vanishing small divisors arises in Birkhoff Normal Form theory for PDEs. Indeed in the analytic or Gevrey case one has sub-exponential stability times (see [FG13] and [CMW20]), whereas in the Sobolev case the best known estimates have a power growth in the Sobolev exponent (see [BG06], [FI], [BD18], [BMP20a]). The counterpart of total and long time stability results is the construction of unstable trajectories, which undergo growth of the Sobolev norms, see [Bou96, CKS+10, GK15, GHHP18, GGMP]. In the context of quasi-periodic solutions there is a wide literature regarding solutions of finite regularity. However most of the interest is in the case of a non-linearity which is only Sobolev. The strategy is to apply a Nash-Moser scheme and prove tame estimates on the inverse of the linearized equation at an approximate solution. This method was proposed in [BB13] (generalizing the seminal works [CW93], [Bou99] concerning the analytic case) via multiscale analysis, see also [BB] or [BBM16] for a reducibility approach. In this type

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

3

of result the regularity of the quasi-periodic solution is related to the regularity of the non-linearity, moreover lower bounds on the regularity are required in order to ensure that the constructed solutions are classical ones.
Of course one can apply these techniques also in the case of analytic non-linearities, note however that solutions obtained with such methods are usually smooth (by bootstrap arguments).

Main result. In dealing with almost periodic solutions one finds a rather different scenario. A main point is that the topology of the phase space becomes crucial. Indeed, in the quasi-periodic case (at least for semi-linear PDEs with an analytic non-linearity) one typically looks for an analytic embedded finite dimensional torus in a fixed phase space of x-dependent functions, by modulating the analyticity strip in the angles. Then the analyticity in time directly follows. Our approach in [BMP21] was a generalization of this strategy to an infinite dimensional context, with the fundamental difference that even if one finds an 2 infinite dimensional analytic torus, the analyticity in time does not follow since the map t  t is not even continuous3. Taking all the advantage from the flexible construction proposed in [BMP21], we present here the very first result of persistence of almost-periodic solutions with finite regularity both in time and space. The solutions that we construct can have very low regularity, so that they are not even classical solutions. The first step is to reformulate the existence of almost periodic solutions as the existence of invariant infinite tori for the NLS Hamiltonian on a phase space of fuctions of x with finite regularity. The idea is to look for special tori which are approximately supported, in Fourier space, on a sparse subset of Z, the tangential sites. Indeed our solutions are, up to a close to identity change of variables, only supported on the tangential sites, see (2.5). The point is that the choice of tangential sites provides an extra set of parameters which can be used in order to avoid resonances, simplify small divisor estimates, etc...(see for instance [PP15], [HP17]).
In the present context, in constructing solutions of this type we may impose very strong Diophantine conditions, see Definition 1.3, so that our small divisors can be controlled similarly to the Gevrey case of [BMP21]. The key points are the definition of diophantine vectors 1.3, the measure estimates of Theorem 2 and the bounds on the homological equation in Lemma 6.1 .
Having constructed an invariant torus contained in the phase space, we show that it is the support of a weak almost periodic solution. Actually our method allows to construct solutions which are not even C2 in x and C1 in t and, therefore, have meaning only as weak solutions (see Definition 1.1 and Remark 1.1). In the context of integrable PDEs there are results on weak almost-periodic solutions, we mention [KM18] for the KdV and [GH17] for the Szego equation. On the other hand, local well posedness is known even in very low regularity (see, e.g. [Bou93] and [Bou94]).

In order to discuss more precisely our result, let us introduce the model and the functional setting. Starting form the Banach space of summable complex sequences

1 = 1(C) := {u := (uj)jZ  CZ : |u|1 := |uj| < }
jZ

we identify by Fourier series u(x) = jZ ujeijx a subspace of 2-periodic x-continuous functions. Analogously in the paper we shall systematically identify spaces of sequences and spaces of x-function with the corresponding
norms.
Let us consider families of NLS equations on the circle with external parameters of the form:

(NLSV )

iut + uxx - V  u + f (|u|2)u = 0 , u(t, x) = u(t, x + 2) ,

2In the infinite-dimensional case, whether this is an embedding depends strongly on the chosen topology. See discussion after
Theorem 2 3At least if supj |j | =  as it is typical in PDEs.

4

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

 where i = -1 and f (y) is real analytic in y in a neighborhood of y = 0 with f (0) = 0 and the Fourier multiplier

V  is defined as the bounded4 linear operator V  : 1  1 by5

(1.1)

(V  u)(x) = Vj ujeijx , V = (Vj )jZ  [-1/4, 1/4]Z  (R) .
jZ

Definition 1.1 (weak solutions). A function u : R2  C which is 2-periodic in x and such that the map t  u(t, ·)  1 is continuous is a weak solution of (NLSV ) if for any smooth compactly supported function  : R2  R one has

(1.2)

(-it + xx)u - (V  u + f (|u|2)u) dx dt = 0 .
R2

Note that according to our definition a weak solution is a continuous6 function on R2.

Theorem 1. For almost every V  [-1/4, 1/4]Z there exist infinitely many small-amplitude weak almost-periodic solutions u of (NLSV ).

Here by almost every we mean a full measure set with respect to the product probability measure on [-1/4, 1/4]Z. The Borel sets on such measure are respect to the product topology on [-1/4, 1/4]Z (see Appendix B).
Actually the solution we construct are slightly more regular. Let us introduce the scale of Banach spaces7

(1.3)

wp := u := (uj)jZ  1(C) :

|u|p := sup |uj|jp <  ,
jZ

p> 1,

j := max{2, |j|} .

Note that u  wp implies that u  Ck for every integer k < p - 1 and8 u  hq for q < p - 1/2. Moreover V  : wp  wp is still a linear bounded operator with norm |V |.

Remark 1.1. We are able to construct solutions in wp for every p > 1 that do not belong to wp with p > p. If p > 3 then ut and uxx are continuous function on R2 and, therefore, are classical solution of (NLSV ). On the
other hand at the end of section 2 we prove that when p  5/2 our weak solutions are not classical ones.

1.1. The dynamical system approach. The solutions of Theorem 1 can be seen as almost-periodic orbits lying on invariant tori of the NLS Hamiltonian9

(1.4)

y

HV (u) := (j2 + Vj)|uj|2 + P , with P := F (x, | ujeijx|2)dx , F (y) := f (s)ds .

jZ

T

j

0

Note that (1.4) is an analytic function defined for u  wp  h1. Thus for 1 < p < 3/2 we are working in space with infinite energy. However, as usual, one only needs that the Hamiltonian vector field is well defined and the flow is locally well-posed, which holds true in wp, for p > 1.
By analyticity, for some R > 0 we have

(1.5)


f (y) = f (d)yd ,
d=1


|f |R := |f (d)|Rd <  .
d=1

As explained before our invariant tori are approximately supported on sparse sets S  Z.

4Clearly the operator norm is V L(1,1) = |V | := supj |Vj |. 5More precisely (V  u)(t, x) := (V  u(t, ·))(x) for every t  R. 6Indeed |u(t, x) - u(t0, x0)|  |u(t, ·) - u(t0, ·)|1 + |u(t0, x) - u(t0, x0)|. 7Obviously one could also take the more standard weight j := max{1, |j|} instead of j, which generates the same Banach
space. We made such choice for merely technical reasons. 8hq is the Hilbert space of sequences u  2(C) such that j j2q |uj |2 < . . 9We endow wp  2 with the symplectic structure inherited from 2.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

5

Definition 1.2 (Admissible tangential sites). Let S be any unbounded subset of N. Let s(i) be a smooth strictly increasing function10 s : [0, +)  [0, +) such that S = s(N). We call i(s) the inverse function of
s(i). Assume that there exist i  21 such that

(1.6a)

s(i)  e(log i)1+ ,

i  i ,

for some given 1 <   2 ;

(1.6b)

s(i + i)  s(i) + s(i) , s(ji)  js(i) ,  j  1 , i, i  i ;

(1.6c)

s(i2)  s2(i) , i  i .

We call tangential site a site s belonging to S.

Remark 1.2. 1) Definition 1.2 above gives a quantitative control on how "sparse" the set S should be. In particular by(1.6a) the function s(i) must grow faster than any polynomial; for example we can choose11 s(i) = 2i or a slower growth such as s(i) = [e(log i)1+ ] ([·] being the integer part). 2) If S1, S2 are admissible tangential sites (according to Definition 1.2) and S0 is any bounded subset of Z, then we can consider also admissible tangential sites of the form -S1, (-S1)  S0, S1  S0, (-S1)  S2  S0.
In what follows, given a sequence indexed over Z we systematically decompose it over S and Sc := Z \ S; for example, for the potential V we write

V = (VS , VSc ) ,

VS := (Vj )jS , VSc := (Vj )jSc .

Analogously, we define the set of tangential frequencies as

(1.7)

QS :=

 = (j )jS  RS :

j - j2

<

1 2

.

The cube QS inherits the product topology12 and the product probability measure measQS from [-1/2, 1/2]S through the map

(1.8)

VS : QS  [-1/2, 1/2]S ,

where

VS,j() := j - j2 , j  S .

Moreover the above map also endows QS with the -metric, which induces a finer topology. Finally, given r > 0 we define the tangential actions

(1.9)

I(p, r) := { I  Br2(w2p) with Ij = 0 for j  Sc , Ij  0 for j  S} .

We are now ready to state our main dynamical result, which can be summarized as follows.

Theorem. For all p > 1, r > 0 sufficiently small, I  I(p, r), VSc  [-1/4, 1/4]Sc , there exists a Cantor-like set C of positive Lebsegue measure such that the following holds. For all frequencies   C, there exist a potential VS  [-1/2, 1/2]S and a symplectic diffeomorphism  analytic on a small ball in wp such that for all   C

(1.10)

TI := {u  wp : |uj|2 = Ij j  Z}

is a KAM torus of frequency  for HV  , with V = (VS , VSc). Namely, the Hamiltonian vector field of HV   is well defined and, restricted to the invariant torus TI , its flow is

uj (t) = uj (0)eijt ,

j  S

and

uj(t) = 0 ,

 j  Sc ,

t  R .

Thus, the (NLSV ) has invariant tori on which the dynamics is the linear translation by t.

10The function s(i) is obviously not unique but its restriction to S is unique. The same holds for its inverse i(s).
11See [BMP20b]
12Recall that if Xi, i  I, are topological metrizable spaces, the product topology on X := iI Xi is the topology of the pointwise convergence, meaning that a sequence x(k) = (x(ik))iI converges iff x(ik) converges for all i  I.

6

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

The statement above is a typical KAM Theorem, regarding the existence of an invariant torus. The fact
that we are looking for an infinite torus however introduces various new difficulties, in particular related to the
regularity of the dependence on , I, VSc. This appears immediately when one wishes to prove that the Cantor set C of "good frequencies" is measurable (and of positive measure) with respect to the product probability measure measQS on QS . The -algebra of such measure, which is the natural one in this context, is given by the Borel sets of the product topology, which is coarser than the one induced by the -metric. Then a crucial point is that a function f : QS  R which is Lipschitz (with respect to the -metric) might be non continuous with respect to the product topology and, hence, non measurable. As typical in KAM schemes C is defined as the intersection of sets of the form {|f ()| >  > 0} (see (8.1) and (8.2)) and f : QS  R is a Lipschitz function. As explained above this does not assure measurability13.
So we reformulate our theorem in a more technical way, carefully keeping track of the regularity w.r.t. all the
parameters. To avoid working with functions defined only on a Cantor set, we suitably (see Lemma 3.1) extend all the functions so that they are defined for   QS. To summarize, the parameter dependences we need to control are:
- continuity w.r.t. the product topology for measure estimates both in  and in V ; - Lipschitz dependence (w.r.t. -metric) for implicit funct theorems/contractions/extensions (see Lemma B.1).

Theorem 2. Let p > 1 and 0 <   |f |R. There exists  = (p) > 0 and C = C(p) > 1 such that, for all r > 0 satisfying

(1.11)
and for every (1.12) the following holds. There exist: i) a map



:=

|f |R R

r2





p + 1 2



p



p

(1.13)

VS : QS × [-1/4, 1/4]Sc × I(p, r)  [-1/2 - , 1/2 + ]S ,

(, VSc , I)  VS (, VSc , I)

which is continuous in , VSc w.r.t. the product topology and Lipschitz in all its variables w.r.t. the  metric. More precisely it is Lipschitz C-close w.r.t.  to the map VS; ii) a map

 : B3r(wp) × QS × [-1/4, 1/4]Sc × I(p, r)  B4r(wp) ,

(u; , VSc , I)  (u; , VSc , I)

which is Lipschitz in all its variables and r/16-close to the identity w.r.t. u; iii) a Cantor-like Borel set C = C(VSc , I, )  QS , with14

(1.14) measQS (QS \ C(VSc , I, ))  C0 ,

meas[-1/4,1/4]S VS QS \ C(VSc , I, ), VSc , I  C0 ,

for a suitable absolute constant C0 > 0. Moreover for any I  I(p, r), VSc  [-1/4, 1/4]Sc and   C(VSc , I, ), the map (·; , VSc , I) is an analytic symplectic change of variables. Finally, for   C(VSc , I, ), TI defined in (1.10) is a KAM torus of frequency  for HV   with V = (VS (, VSc , I), VSc ).

We now reformulate our result in terms of the Fourier multiplier V (for the proof see Section 8)

13This problem does not appear if f actually depends only on a finite number of variables as in the case of maximal tori, where
f () =  · , with || < . 14By measQS and meas[-1/4,1/4]S we denote the product probability measures on QS and [-1/4, 1/4]S , respectively. For brevity
we write measQS (A) for measQS (A  QS ) and similarly for meas[-1/4,1/4]S .

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

7

Corollary 1.1. For I  I(p, r), let

G(I, ) := V  (VS , VSc )  [-1/4, 1/4]Z : VS  VS (C(VSc , I, ), VSc , I) .
G(I, ) is a Borel set in [-1/4, 1/4]Z with measure greater than 1 - C0 (C0 is the constant in (1.14)). Therefore for all I  I(p, r) and all V  G(I, ) the equation (NLSV ) has an invariant torus.

Invariant tori and regularity of our almost periodic solutions. Given any I  I(p, r) the map

(1.15) i : TS  TI  wp,  = (j )jS  i() , with ij() := Ijeij for j  S , ij () := 0 otherwise ,

is analytic provided that we endow TS with the -topology (see Lemma B.2 below for details). Then by

composition so is the map   i and the invariant torus (i(); , VSc , I) is analytic. Of course the map i is not
injective if some of the Ij's are zero. Note that, defining S := {j  S : Ij = 0}, the map i := i|TS is an injective immersion15.

By construction the NLS dynamics on the torus TI is    + t so our candidate for an almost periodic solution is u(t, ·) := (i(t); , VSc , I). If p > 3 the fact that u(t, x) is a (classical) solution is indeed standard but dealing with lower regularity requires more attention, see section 2.

We wish to stress that analiticity of (i()) in the angles does not imply analiticity in time, since the map t  t  TS is not even continuous (endowing TS with the -topology). Of course the regularity of t  i(t) depends on the choice of the actions Ij . If we take for instance Ij = j -p, for j  S and Ij = 0 for j  Sc, then i(·) : R  wp is not continuous w.r.t. the strong16 topology, see also [KM18]. On the other hand, for all
x  T, the map

t

j -pei(jx-jt) =: v(t, x)

jS

is

continuous

(recall

that

p

>

1)

and

is

Ck(R, C)

for

all

k

<

p-1 2

,

but

not

for

k



p-1 2

.

Note

that

for

every

fixed

t

v(t, ·)  wp but v(t, ·) / wp ,  p > p .

The Cantor set C. We can be rather explicit in our description of the set C. We start by fixing the hypercube

(1.16)

Q :=

 = (j)j  RZ :

j - j2

<

1 2

,

Q = QS × QSc ,

endowed with the product topology, and by introducing the following closed set

Definition 1.3 (Diophantine condition). Let  > 1. We say that a vector   Q belongs to D,S if it satisfies

(1.17)

|

· |




sS

(1

1 + |s|2

i(s)

2 )

,

 : 0 < || <  ,

|s|  2 ,
sS c

() = m() = 0 ,

where17 i(s) is the inverse function of s(i), () := sZ ss is the "momentum" and m() := sZ s is the "mass".

From now on we fix  = 3/2 .

Theorem 3. Under the hypotheses of Theorem 2, there exists a Lipschitz map  : QS × [-1/4, 1/4]Sc × I(p, r)  QSc which is continuous with respect to the product topology on QS ×[-1/4, 1/4]Sc and18 for every j  Sc satisfies

(1.18)

|j(, VSc , I) - j2 - Vj|  C

15Assuming also that infj Ij j p > 0 the map i is an embedded torus. Otherwise, i is an homeomorphism on the image only
if we endow both source and target spaces with the product topology 16Note that the map is continuous endowing wp with the product topology, which coincides with the weak  topology on bounded
sets. 17As usual for integer vector   ZZ we set || = jZ |j |. 18The constant C is the one of Theorem 2.

8

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

and the Lipschitz estimates

(1.19)

sup
  =

|j (, VSc , I) - j (, VSc , I)| | - |



C ,

Moreover we can choose in Theorem 2

sup
I  =I

|j (, VSc , I) - j (, VSc , I)| |I - I|2p



Cr-2 .

(1.20)

C(VSc , I, ) := {  QS : (, VSc , I)  D,S} , where (, VSc , I) := (, (, VSc , I)) .

In this way, the torus TI defined in (1.10) is an elliptic invariant torus in the sense that its linearized dynamics in the "normal" directions is u j = ijuj for j  Sc.

Remark 1.3. Note that (1.17) is a much stronger diophantine condition that the one proposed in [Bou05] (or [BMP21]), where the denominators were of the form 1 + |j|2j2. Of course the reasons why we can impose such strong diophantine conditions, still obtaining a positive measure set, are the structure of the set S and the fact that we only need to consider denominators with sSc |s|  2.
1.2. Plan of the paper, strategy and main novelties. - Deducing Theorem 1 from Theorems 2 and 3 is a self contained argument, which we present in section 2. The proof is developed as follows: VSc , I being fixed, we first construct a set C(VSc , I, )  QS of large relative measure such that for all   C(VSc , I, ) the function u(t, ·) := (i(t); , VSc , I) is almost-periodic since it is uniform limit of quasi periodic functions. Such approximating functions are in fact classical solutions of the approximate equation (NLSVn ) with Vn = Vn()  V (). Secondly we show that u is a weak solution in the sense of (1.2), for such V = V (). We next reformulate our result in terms of the external parameters V instead of the frequencies , namely we prove that for every V in a large measure set G(I, )  [-1/4, 1/4]Z we can solve (1.2). A main point is to show that G(I, ) is measurable. Next, taking the union over  we obtain a full measure set, then we show that for a.e. V there exists at least one solution. Finally moving S and suitably choosing I we produce, for a.e. V , countably many different solutions.
- In order to prove Theorems 2 and 3 (see end of Section 5) we follow the general strategy of [BMP21], nevertheless, in the present frame, keeping track of the regularity w.r.t. the various parameters is fundamental and represents one of the main new difficulties. To this purpose, in section 3 we start by defining the Poisson algebra of "regular Hamiltonians" (basically a space of normally analytic functions H such that the corresponding Hamiltonian vector field XH is a normally analytic map19 Br(wp)  wp) and further introduce the space of parameter depending regular Hamiltonians (see definitions 3.3 and 3.4). In particular, we set our ambient space as the closure, w.r.t. a suitable norm (see (3.10) together with(3.13)-(3.14)), of functions depending only on a finite number of frequencies. A Lipschitz extension result is given in Lemma 3.1.
- Having taken care of the of the parameter dependence, we prove the dynamical Theorems 2-3 in the following main steps: we firs put HV in (1.4) in a suitable normal form with counter terms in the spirit of Herman through Theorem 4, which contains the main KAM difficulties in dealing with Sobolev regularity. Roughly speaking, this normal form theorem states that, under appropriate smallness conditions, for all   D,S, VSc  [-1/4, 1/4]Sc and I  I(p, r) there exist    and a symplectic change of variables  (see (5.3)) such that

( (j + j )|uj|2 + P )   = j|uj|2 + O(|u|2 - I)2,

jZ

jZ

where R = O(|u|2 - I)2 means that R is a regular Hamiltonian which has a zero of order at least 2 at the torus TI defined in (1.10) (we formalize this definition in section 4, introducing an appropriate degree decomposition). In order to deduce the dynamical Theorems 2-3 we need to eliminate the counter terms (see equations in (5.9)): the main point is that we can solve with respect only to the tangential variables VS .

19We denote by Br(wp) the open ball of radius r centered at the origin of wp.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

9

Coming back to the counter-term theorem 4, let us explain the main new issues related to Sobolev regularity. As is habitual, the map  is constructed as the composition of a sequence of changes of coordinates whose generating function S at every step is determined by solving a homological equation

(1.21)

LS := { j|uj|2, S} = F ,
j

where F is a given analytic function on the phase space wp (see definition 3.4) which is at most quadratic in the normal variables. At a formal level, a solution S = L- 1F of (1.21) is readily determined. In order to prove that S is in fact analytic, one has to control the contribution given by small divisors (i.e. the eigenvalues of L). This is possible by imposing the arithmetic Melnikov conditions on the frequencies (1.17), where the constraint
sSc |s|  2 comes from the fact that F is at most quadratic in the normal variables, while the zero mass and momentum conditions come from the presence of two quadratic constants of motion.
Also in this Sobolev context, due to the presence of small divisors, one bounds the solution S at the cost of some "loss of information". More explicitly, if XF maps Br(wp)  wp, then XS maps Br(wp+)  wp+ (with  > 0), this meaning that S is analytic in a smaller domain, since wp+  wp. Then, at each iteration, one is able to define the solutions S only on a (ball of a) smaller phase space of the Banach scale (wp)p>1, the target space shrinking accordingly. Resembling the finite dimensional case, we call  the "loss of regularity "
Of course, the convergence of a KAM scheme is achieved only if one loses a summable, amount of regularity n at each step n (in particular n  0). Nonetheless the typical characteristic of the Sobolev case is the presence of a lower bound on the loss of regularity, so that a KAM scheme based on such bound cannot converge. In KAM schemes for quasi-periodic Sobolev solutions a similar problem arises but it is bypassed by using tame estimates,
or approximation by analytic functions. In the present context such methods do not apply, since we are already
working with analytic nonlinearities, while the phase space consists of functions with finite regularity. Our purpose is to bypass this problem by taking full advantage of the fact that the tangential sites set S is sparse (recall Definition 1.2). To see this idea neatly, take for simplicity S = {s(i) = 2i , i  N}. In order to get an intuition of our strategy let us start by considering a toy model with a nonlinearity for which the set

US := {u  wp : uj = 0 j / S} {v   s.t. sup |vi|2ip < }
iN
is invariant for the dynamics; so that we may study the equation restricted to S. Then we are essentially in the analytic case (or Gevrey or slightly less if we take a slower growth for s(i)) and the Bourgain strategy in [Bou05] (or [BMP21], [Con]) applies with the same Diophantine condition. Of course for the NLS equation (NLSV ) the set US is not invariant and the main difficulties arise from interaction between tangential and normal modes.
In the Diophantine estimates, to deal with the terms  not supported only on the tangential sites, we use the constants of motion and the dispersive nature of the equation (k  k2). Once one has guessed the correct Diophantine conditions (1.17), the proof of Lemma 6.1 (i.e. controlling the solution of the homological equation 1.21) is the real core of our result. Again the proof is simple if F is supported only on S or Sc, on the other hand dealing with the interaction between tangential and normal sites requires a careful case analysis. The final goal is to control the norm of XS as a map Br(wp+)  wp+, for arbitrarily small . This should be compared with the corresponding estimate on XS in [BMP20a] Proposition 7.1 item (M). In the latter paper we take S = Z and then, in order to control L- 1F we cannot take any  > 0 but instead must require   1, where 1 > 0 is some fixed quantity. As one can expect the less sparse is S the worst bounds one gets. The quantitative condition in Definition 1.2 is needed in order to ensure convergence of the iterative KAM scheme. We suitably choose the values of the parameter at each iterative step n  N, in particular the loss of regularity n must be summable, e.g. n  n-c, for some c > 1. Then the divergence due to small divisors, which is of order exp(exp(nc/)) by (6.3) and with  defined in (1.6a), must be compensated by the superexponential convergence exp(- exp(Cn)) given by the KAM quadratic scheme. This forces c <  and  > 1. The super-linearity assumptions (1.6b) and (1.6c) are essential for our estimate on the homological equation to work. The asymptotic growth in (1.6a) is only needed in the KAM step. A slower growth would give rise to

10

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

a too large estimate on the solution of the homological equation which would not be compensated anymore by the quadratic convergence of the KAM scheme.

2. Proof of Theorem 1

The solutions of Theorem 1 are constructed as the limit of sequences of smooth quasi-periodic functions. Fix p > 1 and an admissible set of tangential sites S. Fix  > 0 and take r such that (1.11) holds. For any potential VSc  [-1/4, 1/4]Sc and I  I(p, r), we apply Theorem 2 and obtain, for all frequencies   C(VSc , I, ), an invariant torus. Now define I(n) = Ij(n) by setting Ij(n) = Ij if |j|  n and Ij(n) = 0 otherwise. We apply Theorem 2 with I I(n),  /2 and set V(n)(·) := VS (·, VSc , I(n)), VSc a n(·; ·) := (·; ·, VSc , I(n)). We have obtained a sequence of NLS equations with potentials V(n)() for   [-1/4, 1/4]S ; each equation admits a finite dimensional invariant torus with frequency , for all   C(VSc , I(n), /2). It is not hard to see that each torus supports a smooth quasi-periodic solution.
The idea is to show that (at least up to a subsequence) the limit over n is the desired almost-periodic solution.
First step (construction of the Cantor set). In order to apply Theorem 2 for each n (with the same frequency) we take the "good frequencies" in the (countable) intersection of the Cantor-like sets where all the tori are defined. Correspondingly, we define the set of "good potentials". This is the content of the following result, which is proved in Section 8.

Lemma 2.1. There exists a subsequence nk   (independent of VSc ) such that the following holds. Defining the Borel sets

(2.1) (2.2)

C(VSc , I, ) := C(VSc , I, ) C(VSc , I(nk), /2)

kN

GS (VSc , I, ) := [-1/4, 1/4]S

VS C(VSc , I, ), VSc , I

(2.3)

G(I, ) := {V = (VS , VSc )  [1/4, 1/4]Z s.t. VS  GS (VSc , I, )}

we have the estimates

(2.4)

meas[-1/4,1/4]S GS (VSc , I, )  1 - C0 ,

where C0 is defined in Theorem 2

meas[-1/4,1/4]Z G(I, )  1 - C0 ,

Second step (construction of the convergent subsequence). We now prove that for every V  G(I, ) we can solve (1.2) with V = (VS , VSc ). Indeed for every VS  GS (VSc , I, ) there exists   C(VSc , I, ) such that VS , VSc , I = VS . We claim that

(2.5) u(t, x) := (v(t, x); , VSc , I) , where v(t, x) :=

Ij ei(jx-j t) ,

jS

and, moreover, it is the uniform limit of the C-quasi-periodic functions

satisfies (1.2)

uk(t, ·) := nk (vk(t, ·); )

where

vk(t, x) :=
j S ,|j |nk

Ij ei(jx-j t) .

Note that by construction v, u  wp while t  nk (vk(t, ·); ) =: uk(t, ·) is a classical (actually C) quasiperiodic solution of (NLSV ) (nk) with V (nk) = V(nk)(), VSc . Thus each uk satisfies (1.2) with V (nk) in place of V .
Taking p < p satisfying (1.12) we get

ck := sup Ij|j|p  0 ,
|j|>nk

as k  

and, for every t  R,

|v(t, ·) - vk(t, ·)|p = ck ,

|I - I(nk)|2p = c2k .

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

11

Since the map I  VS (, VSc , I) is Lipschitz then V (nk)  V in . Moreover since  is also Lipschitz (w.r.t. u and I), for every t  R

|u(t, ·)-uk(t, ·)|p = |(v(t, ·); , VSc , I)-(vk(t, ·); , VSc , I(nk))|p  L |v(t, ·)-vk(t, ·)|p+|I-I(nk)|2p  L(ck+c2k)
for a suitable20 L > 0. Then uk  u uniformly21 in R2. In order to prove that u satisfies (1.2) we have to show that
(-it + xx)(u - uk) - (V  u - V (nk)  uk) - f (|u|2)u - f (|uk|)uk  dx dt k- 0 .
R2
This follows since uk  u uniformly and observing that

V (nk)  uk - V  u L(R2)  |V (nk)  uk - V  u|p  |(V (nk) - V )  uk - V  (u - uk)|p  |V (nk) - V | |uk|p + |V | |u - uk|p k- 0 .

This proves the claim in (2.5). Third step (A set of good potentials). We now show that for almost every V  [-1/4, 1/4]Z there exists at least
one solution of (1.2). For every integer h  1 take h = |f |R/h and rh such that (1.11) holds as an equality, namely rh := R/|f |R = R/h. For every given sequence Ih  I(p, rh) we set

(2.6)

G := G(Ih, h) .
h1

By (2.4) G has full measure in [-1/4, 1/4]Z. This implies that for almost every V  [-1/4, 1/4]Z there exists an

integer h  1 such that V  G(Ih, h). Then (2.5) (with I = Ih) gives a solution of (1.2). Fourth step (Abundance of solutions). In order to find infinitely many solutions for almost every V in [-1/4, 1/4]Z

we proceed as follows. First we choose in (2.6)

(Ih)j

:=

1 2

rh

j

-p

.

All

the

above construction depends

on

the choice of the set S of admissible tangential sites; in particular this holds for the set G above. Let us consider

infinitely many countable different S and call G the countable intersection of the corresponding sets G. The set G has full measure in [-1/4, 1/4]Z as well. Then for every V  G we construct infinitely many solutions

corresponding to different S's. Note that for a given V  G the solutions corresponding to different S and S are different. In particular there exist h, h such that V  G(Ih, h)  G(Ih , h), where G(I, ) is the set defined in the last line of (2.3) corresponding to S. Let us call u, v,  and u, v,  the functions defined in

(2.5), respectively for S and S. Since by Theorem 2 (point ii)) the maps  and  are ¯r/16-close to the identity

where ¯r := max{rh, rh}, then

|u(t, ·) - u(t, ·)|p  |v(t, ·) - v(t, ·)|p - ¯r/8  ¯r/2 - ¯r/8 > 0 .
The same holds for any translations u(t + t0, x + x0) and u(t, x). This concludes the proof of Theorem 1.

Validity of Remark 1.1(weak Vs strong solutions). By (2.5) we know that if p > 3 then vt and vxx are continuous function on R2. Moreover, by analyticity of v  (v; , I), also ut and uxx are continuous function on R2. Therefore u is a classical solution. On the other hand, when p  5/2 and Ij = (r/2) j -2p , for every t the function uxx(t, ·) is not continuous. Otherwise its Fourier coefficients (uxx(t, ·))j = -j2(u(t, ·))j
would belong to 2. Since  is close to the identity  = Id + 1 with 1 uniformly r/16-small, we have that u(t, ·) := (v(t, ·)) = v(t, ·) + 1(v(t, ·)) and its Fourier coefficients satisfies |uj(t, ·)|  (r/4) j -p and (uxx(t, ·))j  j 2-p .

20We can take L = 2 since  is C-close to the identity. 21Given f : R2  C we have f L(R2) = suptR f (t, ·) L x (R)  suptR |f (t, ·)|p for every p  1.

12

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

3. Functional setting

Let us introduce the spaces of Hamiltonians used in the paper.

Definition 3.1 (Multi-index notation). In the following we denote, with abuse of notation, by NZ the set of

multi-indexes ,  etc. such that || := jZ j is finite. As usual ! := jZ, j=0 j. Moreover  

means j  j for every j  Z, then

 

:=

! !(-)!

.

Finally

take

j1

<

j2

<

...

<

jn

such

that

j

=

0

if

and

only if j = ji for some 1  i  n, as usual we set f := ujj11 . . . ujjnn f ; analogously for u¯ f.

Definition 3.2 (regular Hamiltonians). Consider a formal power series expansion

(3.1)

H(u) =

H,uu¯ ,

(,)M

u :=

uj j ,

jZ

where (3.2)

  M := (, )  NZ × NZ ,

s..t. || = || < + ,

  j(j - j) = 0
jZ

satisfying the reality condition

(3.3)

H, = H, ,  (, )  M .

We say that H  Hr,p for p > 1, r > 0 if

(3.4)

|H |r,p

:=

1 r

sup
|u|p r

XH

p

< ,

where XH denotes the hamiltonian vector field of the majorant H(u) := (,)M |H,|uu¯ of H(u). Finally we denote by Hr,p(C) the space of H satisfying (3.1) and (3.4) but not necessarily the reality condition
(3.3).

Note that by Lemma 2.1 of [BMP21]

(3.5)

|H |r,p

=

1 2

sup

|H, |

j (,)M

j + j

up +-2ej ,

where up = up(r) is defined as

(3.6)

up,j(r) := rj-p .

Remark 3.1. Regarding M in (3.2) we note that the condition || = ||, i.e. m( - ) = 0, corresponds to
mass conservation, namely the H Poisson commutes with the mass jZ |uj|2; moreover jZ j(j - j) = 0, i.e. ( - ) = 0, corresponds to momentum conservation, namely H Poisson commutes with the momentum
jZ j|uj|2.

Note that |·|r,p is a seminorm on Hr,p and a norm on its subspace

(3.7)

Hr0,p := { H  Hr,p with H(0) = 0 } ,

endowing Hr0,p with a Banach space structure. Moreover the space Hr,p enjoys the following algebra property with respect to Poisson brackets.

Proposition 3.1 (Poisson structure). For any F, G  Hr+,p, with  > 0,

(3.8)

F, G  Hr,p = {F, G}  Hr0,p

and the following bound holds

(3.9)

|{F, G}|r,p  8 max

1,

r 

|F |r+,p|G|r+,p .

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

13

The proof is given in Appendix A. Of course the same estimates hold in Hr,p(C).

The next result controls the norm of the NLS nonlinearity P defined in (1.4) and it is based on the algebra property of wp, p > 1, with respect to convolution.

Proposition 3.2 (Proposition 2.1 of [BMP21]). There exist c1, c2 > 1 continuously depending on p > 1 such that if c1r2  R then, recalling (1.5),

|P

|r,p



c2

|f |R R

r2

.

3.1. Parameter families of regular Hamiltonians. Throughout the paper our Hamiltonians will depend on two parameters, the frequency   D,S  Q and the action I  I(p, r). In order to control the regularity w.r.t these parameters throughout the iterative scheme, we will introduce an appropriate weighted norm as follows.

Given a closed (w.r.t. the product topology) subset O  Q and an open subset I of some Banach space, for f : O × I  C , (, I)  f (, I) we set

(3.10)

|f | = |f |,O×I := sup |f (, I)| +  sup |, f |,

O

=O

I I

I I

where as usual (3.11)

, f

:=

f (, I) - f (, I) | - |

.

Definition 3.3. Given O and I as above let CLip(O × I) be the Banach space of functions f : O × I  C, which have finite norm |f |,O×I and which are:

· continuous w.r.t the product topology in O; · analytic in I.

In CLip(O × I) we consider the subalgebra F(O × I) of functions which depend only on a finite number of j's.
The subalgebra F(O × I) can be described as follows. Given f  F(O × I), which depends only on the variables (-k, . . . , k), there exists a function f^ : Pk(O) × I  C, where Pk is the projection Pk : RZ  R2k+1 defined as Pk() := (-k, . . . , k), such that f (, I) = f^(-k, . . . , k, I) for every (, I)  O × I.
Finally denote the closure of F(O × I) in CLip(O × I) by F (O × I).

The spaces CLip(O × I) and F (O × I) are Banach algebras (i.e. multiplicative algebras with constant equal to 1) w.r.t. the norm | · |,O×I.
The following extension result will be proved in the Appendix.

Lemma 3.1 (Lipschitz extension). Given O  Q and a ball B in some complex Banach space E and f  F (O × B) there exists an extension f~ : Q × B/2  C such that |f~|,Q×B/2  2|f |,O×B, f~ is continuous w.r.t the product topology in Q, f~ is Lipschitz on B/2 with estimate

|f~(, I) - f~(, I)|  4-1|f |,O×B|I - I|E ,

   Q , I, I  B/2 .

In the following we mainly consider I = I(p, r) (see (1.9)), however in order to use Lemma 3.1 we need to pass to the complex. Then we define

(3.12)

I(C) = I(p, r, C) := { I  Br2(w2p) with Ij = 0 for j  Sc } ,

which we systematically identify with the open ball of radius r2 centered at the origin of the Banach space {w = (wj )jS : supjS |wj |j2p < }.

14

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Definition 3.4 (Real and complex Hamiltonians). Let 0 < r0  r, p0  p > 1. Let Hr,p = HrO,p×I with I = I(p0, r0) be the space of parameter depending real regular hamiltonians H : O × I  (, I)  H(, I)  Hr,p
such that

(3.13)
We set (3.14)

H,  F (O × I) ,  ,   M and H :=

|H, | uu¯  Hr,p .

,M

H r,p =

H

O×I r,p

:=

|H  |r,p

(3=.5)

1 2

sup

|H, |

j (,)M

j + j

up +-2ej .

Respectively for I(C) = I(p0, r0, C) we define the space Hr,p(C) = HrO,p×I(C) of parameter depending complex hamiltonians H : O × I(C)  (, I)  H(, I)  Hr,p(C) satisfying (3.13) with I(C) instead of I and verifying the reality condition H(, I)  Hr,p when I  I. Finally we denote by Hr0,p, resp. Hr0,p(C) the subspace of Hr,p, resp. of Hr,p(C), such that H|u=0 = 0.

The following result is proved in Appendix A

Lemma 3.2. (Hr0,p, · r,p) is a Banach-Poisson algebra in the following sense: 1. (Hr0,p, · r,p) is a Banach space 2. for any F, G  Hr+,p the following bound holds

(3.15)

{F, G} r,p  8 max

1,

r 

F r+,p G r+,p .

Proposition 3.3 (Monotonicity). The norm · r,p is monotone decreasing in p and monotone increasing in r:

(3.16)

· r,p+  · r+,p  ,   0.

The fact that this norm is increasing in r follows directly from mass conservation and the fact that H(0) = 0. Concerning the monotonicity in p, we refer the reader to [BMP20a, Proposition 6.3], where the proof is contained, written in the case of | · |r,p. The fact that it holds also in the Lipschitz frame, follows trivially.

Proposition 3.4 (Hamiltonian flow). Let S  Hr+,p = HrO+×I,p with

(3.17)

S

r+,p   :=

 16e(r +

)

.

Then, for all (, I)  O × I the time 1-Hamiltonian flow of S = S(·, , I) is well defined, analytic, symplectic;

more precisely 1S : Br(wp)  Br+(wp) with

(3.18)

sup
uBr (wp )

1S (u) - u r,p  (r + )

S

r+,p



 16e

.

For any H  Hr+,p we have that22 H  1S = e{S,·}H  Hr,p, e{S,·}H - H  Hr0,p and

(3.19)

e{S,·}H

2
r,p

H

r+,p ,

(3.20)

e{S,·} - Id

H

 -1
r,p

S r+,p

H

r+,p ,

(3.21)

e{S,·} - Id -{S, ·}

H

r,p



1 2

-2

2

S r+,p

H r+,p

More generally for any h  N and any sequence (ck)kN with |ck|  1/k!, we have

(3.22)

ck adkS (H)  2 H r+,p

kh

r,p

22e{S,·}H := kN adkS (H)/k!, where adS = {S, ·}.

S r+,p /2 h ,

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

15

where adS (·) := {S, ·}.
The proof is based on (3.15) and on the Lie series expansion for e{S,·}, see [BMP20a] Proposition 2.1 and Lemma 2.1 for details.
Remark 3.2. If we are working in Hr,p(C) all the estimates in Lemma 3.2, Proposition 3.3 and Proposition 3.4 still hold except for (3.18) which holds only for real I. Indeed without the reality condition (3.3) the generating function S does not define anymore a hamiltonian flow satisfying the reality condition u(t) = u¯(t).

4. Degree decompositions, projections and normal forms

We want to prove that, in suitable variables, TI introduced in (1.10) is an invariant torus on which the flow is linear. To this purpose we introduce a suitable degree decomposition, whose main idea is to make a power series expansion centered at I without introducing a singularity in order to highlight the terms which prevent TI from being a KAM torus. This seminal idea was proposed in [Bou05] and further formalized in [BMP21, Section 4]. For convenience of the reader, we sketch here the main features of this decomposition. The main novelty here is to control the regularity with respect to the parameters. Fix S as in (1.2). Consider a Hamiltonian H(u) expanded in Taylor series at u = 0 and tautologically rewrite H as

(4.1)

H=

Hm,,,a,b|v|2mvv¯ zaz¯b

m,,NS = a,bNSc

where, by slight abuse of notation23, u = (v, z) with v = (vj)jS := (uj)jS and z = (zj)jSc := (uj)jSc . Then introduce the auxiliary "action" variables w = (wj)jS substituting |v|2mvv¯zaz¯b wmvv¯zaz¯b in
(4.1). Now we Taylor expand the Hamiltonian with respect to w and z at the point wj = Ij for j  S and z = 0
respectively.

Definition 4.1 (Degree decomposition). Let I  I(p, r) (recall (1.9)). For every integer d  -2 and any regular Hamiltonian H  Hr,p we define the following projection:

(4.2)

(dH)(u) = (dI H)(u) = H(d)(u) :=

Hm,,,a,b

m,,,NS ,a,bNSc

m 

Im-(|v|2 - I)vv¯ zaz¯b .

= ,  m

2||+|a|+|b|=d+2

where  m means that s  ms for any s  S, |v|2 = |vs|2 sS , while the multiindex notations are introduced

in Definition 3.1. We also set d :=

d d=-2

d

and

d

:=

Id - <d ,

analogously for

<d

and

>d.

Moreover

we define, e.g., H(d) := (d)H and also Hrd,p := dHr,p and, e.g., Hr,pd := dHr,p.

Note that, if S = Z, projections coincide with the ones of Section 4 of [BMP21], while if S = , H(d) represents the usual homogeneous degree at z = 0. In this way, given H  Hr,p, then

(4.3)

H = H (0) + H (1)  H (-2) + H (-1) + H (0) + H (1)

where H(-2) consists of terms which are constant w.r.t. both z and and the "auxiliary action" w = |v|2, H(-1) is independent of the action but linear in the zj, while H(0) contributes with two terms: the one linear in the action and independent of z, the second one quadratic in z and independent of the action. Finally, H(1) is
what is left and XH(1) vanishes on TI .
The operators d define continuous projections (see Section 4 of [BMP21] and also Proposition 4.1) satisfying dd = d and dd = dd = 0 for every d = d, d  -2. Moreover, this decomposition enjoys all the

23Consisting in a reordering of the indexes j.

16

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

crucial properties required for a KAM scheme to converge, in particular they behave well with respect to Poisson brackets, that is:
F, G  Hr,p F, G1 (-2) = 0
and F (-2) = 0 = F, G1 (-1) = 0, and F (-1) = 0 = F (-2) = F, G1 (0) = 0.
Note also that if <d1 F = <d2 G = 0, then <d1+d2 {F, G} = 0; moreover

(4.4)

H = F (0), G(d)

=

H = H(d) .

For all the properties of the projections see [BMP21] Proposition 4.1 and 4.2. As is standard, on Hr,p we define the projections

(4.5)

KH :=

H,|u|2 ,

NZ

RH := H - KH .

Note that HrK,p  ker L() and if   D,S then the two spaces coincide. Correspondingly, we define the following subspaces of Hr,p:

(4.6)

HrK,p := {H  Hr,p : KH = H} ,

HrR,p := {H  Hr,p : RH = H} .

these projections are continuous on Hr,p. Moreover, e.g. Hr,p0,R := Hr,p0  HrR,p. Note that by (4.2) and (4.5) we have

(4.7)

d odd = Hrd,p,K = {0} .

In Lemma 4.3 of [BMP21] we proved that the map    defined by

(4.8)

 = j(|vj |2 - Ij) +

j |zj|2

jS

j S c

is a linear isometry from  to Hr0,p,K for every r, p.

The projections defined in (4.2) naturally extend to H  Hr,p or H  Hr,p(C) setting

(4.9)

(dH)(u, , I) := (dI H(, I))(u) .

Similarly for (4.5).

The following result is proved in Appendix A

Proposition

4.1.

For

every

d

 N  {-2, -1}

and

H

 Hr,p

=

HrO,×pI

where

I

= I(p, r)

with

r

  2r

the

following holds.

(i) The projection operators d : Hr,p  Hr,p are continuous with bound

(4.10)

dH

r,p



3

d 2

+1

H

r,p .

(ii) Moreover the following representation formula holds

(4.11)

dH(u) =

(|v|2 - I)zaz¯bH(u)

NS ,a,bNSc 2||+|a|+|b|=d+2

for |u|p < r ,

where H(u) are analytic in Br (wp) and can be written in totally convergent power series in every ball |u|p  r
with  < 1. Analogous statements hold for the complex case H  Hr,p(C) = HrO,×pI(C) where I(C) = I(p, r, C) (recall formula (3.12)).

As above for Hr,p we define the corresponding subspaces Hrd,p, HrK,p, HrR,p, etc. of Hr,p. Analogously for the complex case Hr,p(C). In particular we discuss the subspace Hr0,,pK.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

17

Definition 4.2. We denote by H0,K = H0,K(O × I) the space of maps

O × I  (, I)  (, I)  (R)

with j  F (O × I)

for every j  Z endowed with the norm (recall (3.10))

(4.12)

  := sup |j| .
jZ

Then by (4.8) H0,K is isometrically equivalent to Hr0,,pK for all r, p. Similarly in the complex case H0,K(C) = H0,K(O × I(C)).

Since are we mainly interested in the decomposition (4.3), we remark (see Proposition 4.1) that for H  HrO,×pI with I = I(p, r) and r  2r , p  p, one has

(4.13) 0H r,p , 0,KH   3 H r,p ,

-1H r,p , -2H r,p  H r,p ,

1H r,p  6 H r,p .

Analogous estimates hold in the complex case H  HrO,×pI (C) with I(C) = I(p, r, C) (see (3.12)).

5. Proof of Theorems 2 and 3

Definition 5.1 (Normal Forms). Let D : Q  R be the linear map defined as

D = D() := j|uj|2 .
jZ
Let 0 < r < r0, 1 < p0  p and I = I(p, r), as in (1.9). We will say that N is an analytic family of normal forms if N - D  Hr01,p,O0 ×I. We denote such affine space by Nr0,p0 = NrO0,×p0I Same definition in the corresponding complex spaces.
Remark 5.1. Given N  NrO0,×p0I for every   O and I  I(p, r) the flat torus TI is invariant for the dynamics of N (, I) .

Let us state our counterterm KAM result.

Theorem 4. Fix 0 <  < 1, S as in (1.2), r > 0 and p > 1. Set O = D,S and I = I(p, r). Consider

r0, ,  > 0 and p0 > 1 with

(5.1)

  r0 - r , r  r0 ,   p - p0 .

4

2

4

There exists ¯, 1/C¯ > 0, decreasing functions of /r0 and  such that the following holds. Consider N0  NrO0,×p0I, H  D + HrO0×,pI0 and assume that

(5.2) (1 + )5  ¯,

where

 := -1 sup
I I (p,r)

H - N0

r0,p0 ,

 := -1 sup
I I (p,r)

D - N0

r0,p0 .

Then there exist a /4-close to the identity symplectic diffeomorphism in u, Lipschitz in  and analytic in I

(5.3)

 : Br0-(wp) × O × I  Br0 (wp) , (u; , I)  (u; , I)

and a countertem   H0,K(O × I), with

(5.4)

   C¯(1 + )2 ,

such that (TI ; , I) is an invariant torus for the dynamics of (, I)+H() for every   D,S and I  I(p, r). More precisely there exists an analytic family of normal forms N  NrO0-×I,p0+, such that

(5.5)

( + H)   - N = 0 ,

where  = j |uj|2 - Ij .
j

Finally if N0 and H admit a complex extention on I(p, r, C) satisfying (5.2), then also the counterterm  extends to an holomorphic map in H0,K(O × I(p, r, C)) satisfying (5.4).

18

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Remark 5.2. By (5.4) and Cauchy estimates we get that  is uniformly Lipschitz in I(p, r/2)

(5.6)

|(, I) - (, I)| |I - I|2p

 4C¯(1 + )2r-2 ,

   D,S, I, I  I(p, r/2) , I = I .

Proof of Theorem 2 and 3. Theorem 2 follows from Theorem 4 in a straightforward way. Fix p0 = p - (p - 1)/2, r0 = 2r = 4r,  = r/8 and  = (p - 1)/16. Note that by these choices

(5.7)

the constants ¯ and C¯ depend only on p .

One first rewrites HV in (1.4) as D +  + P by setting j = j2 - j + Vj . Set H = D + P and N0 = D so that
by definition  = 0. Since the Hamiltonian P  Hr0,p0 (C) does not depend on , I, trivially P  Hr0,p0 (C). Since by hypothesis   |f |R we have by (1.11) that r2/R  ; then the hypothesis c1r2  R of Proposition 3.2 holds for all p satisfying (1.12) taking  small enough. Then , by Proposition 3.2,

(5.8)

 = -1 P r0,p0 = -1|P |r0,p0  -1|P |2r,(p+3)/4  c(p)

for some24 c(p) > 1 by (1.11). Again taking  = (p) in (1.11) small enough, condition (5.2) is satisfied and Theorem 4 gives us the desired change of variables provided that   H0,K(C) is fixed accordingly.
Now we denote j = j if j  S and j = j otherwise. We get the equations

(5.9)

j + j(, , I) = j2 + Vj , if j  Sc j + j (, , I) = j2 + Vj , if j  S ,

for   D,S and I  I(p, r, C). By Lemma 3.1 we Lipschitz extend the map  to the whole Q × I(p, r, C), (where, recall, r = r/2) in such a way that (5.4) and (5.6) hold for ,   Q (with C¯ 2C¯). From now on we can work only on the real25 case I  I(p, r). By (5.4) and taking (p) small enough such that 2C¯  2C¯c(p)(p)  1/2 (recall (5.8)) we use the Contraction Lemma (recall Lemma26 B.1), we solve the first equation finding  : QS × [-1/4, 1/4]Sc × I(p, r)  QSc which is continuous in the product topology of QS × [-1/4, 1/4]Sc and satisfies

(5.10)

|j (, VSc , I) - j2 - VSc,j |  2C¯ ,

sup
=

|j (, VSc , I) - j (, VSc , I)| | - |



4C¯ ,

sup
VSc =VSc

|j (, VSc , I) - j (, VSc , I)| |VSc  - VSc |

 4C¯ ,

sup
I  =I

|j (, VSc , I) - j (, VSc , I)| |I - I|2p



2C¯r-2 ,

for every j  Sc and where the first three estimates follows from (5.4) (recalling (4.12) and (3.10)) and the last one from (5.6). By (5.10) and (5.8) we prove (1.18) and (1.19) taking C  4C¯c(p). Note that this condition
depends only on p.
Finally the second equation in (5.9) defines

(5.11)

VS,j (, VSc , I) = j + j (, (, VSc , I), I) - j2

for j  S. Analogously, by Kirszbraun's Theorem, we can Lipschitz extend the map  : Br0-(wp) × D,S × I(p, r)  Br0(wp) on Br0-(wp) × Q × I(p, r). Then (u; , VSc , I) := (u; (, VSc, I), I) (where (, VSc , I) was defined in (1.20)). The map  conjugates the NLS Hamiltonian HV to normal form for all  such that (, VSc, I)  D,S, namely for   C (recalling (1.20)). Then the proofs of Theorems 2 and 3 are concluded provided that one shows that the set C defined in (1.20) satisfies (1.14). This is the content of Lemma 8.1 proved in Section Section 8,
where all the measure estimates are discussed.

24Note that the constants c1, c2 in Proposition 3.2 continuously depend on p, which belongs to the compact [(p + 1)/2, p]. 25Obviously the same statements hold also in the complex case
26We use it with Fj (, VSc , w) := -j (, q + VSc + w) , j  Sc, where q = (j2)jSc and r := C¯.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

19

6. Small divisors and homological equation

The proof of Theorem 4 is based on an iterative scheme that kills out the obstructing terms, namely terms belonging to Hr-,p2, Hr-,p1 and Hr0,p, by solving homological equations of the form

(6.1)

LF (d) = G(d),

G(d)  Hrd,p, d = -2, -1, 0.

where

L()[·] := { j|uj|2, ·} , LH =

 · ( - )H,(, I)uu¯ .

j

,NZ

The convergence of the iterative KAM scheme comes from a good control of the solution L- 1G(d) in the set D,S .

For   D,S the Lie derivative operator L() is formally invertible on the subspace HrR,p with inverse

(6.2)

(L-1 ()H ),

:=

-iH,  · ( - )

.

We now show that the inverse is well defined also at a non formal level.

Lemma 6.1. Let O = D,S and I = I(p, r) and set Hr,p0,R = Hr,p0,R,O×I. For every 0 <  < 1, (6.2) defines a bounded linear operator L-1 : Hr,p0,R  Hr,p0+,R with estimate27

(6.3)

L-1H

r,p+



1 

exp

c exp

2 1/ 

H r,p ,

for some constants i,  are introduced in Definition in 1.2. c = c(i), with i,  introduced in Definition in 1.2. The same estimate holds in the corresponding complex spaces.

Proof. Let us first prove that if H,  F (O × I) then the same holds for (L-1H),. Indeed, since || = || < , the expression  · ( - ) depends only on a finite number of frequencies i and hence is continuous w.r.t. the product topology. As for the Lipschitz dependence,   D,S implies that 1/ · ( - ) is C and
the result follows, since the product of Lipschitz functions is Lipschitz.

By (6.2) and (3.14) we get

(6.4)

L-1H

r,p+



1 

K

H

r,p ,

where

(6.5)

K =  sup sup
jZ (,)Mj

j2 s ss +s



1  · ( - ))


,

and (recall that H  Hr,p2,R)

(6.6)

Mj := (, )  M s.t.  =  ,

s + s  2 , j + j = 0 .

sS c

We now separate two cases. We define

(6.7) and consider (6.8)

Mj := (, )  Mj, such that

(s - s)s2 < 2 |s - s| ,

sZ

sZ

K1 =  sup sup
jZ (,)Mj

j2 s ss +s



1



 · ( - ))

27 was introduced in (1.6a).

20

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

and (6.9) Note that, by (1.16),
so

K2 =  sup sup
jZ (,)Mj \Mj

j2 sss+s



1



 · ( - ))

| · ( - )| 

s2|s

-

s|

-

1 2

|s - s| .

sZ

sZ

(6.10)

(s - s)s2  2 |s - s|

=

| · ( - )|  | - |  1

sZ

sZ

Remark 6.1. In the following we will strongly use the fact that the involved functions depend only on a finite number of j. In this case the Lipschitz semi-norm is bounded by the 1-norm of the gradient.

Let us first study K2. If (, )  Mj \ Mj then | · ( - )|  | - |  1. Therefore

1  · ( - ))



 sup
D,S

1 | · ( - )|

+  sup
D,S

| - | ( · ( - ))2

 2,

so that in conclusion K2  2. Otherwise if (, )  Mj, then (recall Definition 1.3)

sup
D,S

1  · ( - ))



2 d( -

) ,

with

d()

:=

(1

1 + |s|2

i(s)

2 )

;

as for the Lipschitz variation we estimate it as

sup
D,S j

1 j  · ( - )

 sup
D,S

| - | ( · ( - ))2



2

4 d( - )

3

,

where the last inequality comes form | - |  d( - ) -1. Note that the sum in the left hand side above is

over a finite number of indexes j's. In conclusion we have proved that for (, )  Mj

1  · ( - ))







14 d( - )

3,

and hence, recalling the definition of  in (1.6a), we have

(6.11)

K1  14 sup sup
jZ (,)Mj

j2 s ss +s



1+

i(s) 2|s - s|2

3
.

sS

To bound this last term, we need some basic results and notations coming from [BMP20a]

Definition 6.1. Given a vector v  NZ, 0 < |v| < , we denote by n = n(v) the vector (nl)lI (where I  N is finite) which is the decreasing rearrangement of

{N  h > 1 repeated vh + v-h times}  {1 repeated v1 + v-1 + v0 times}

Remark 6.2. A good way of envisioning this list is as follows. Given the set of (commutative) variables (xj)jZ, we consider a monomial (recall (3.1))

xv =

xvi i = xj1 xj2 · · · xx|v| ,

i

then n(v) is the decreasing rearrangement of the list j1 , . . . , j|v| . As an example consider

v = (vj)jZ with v-6 = 1, v-3 = 4, v-1 = v0 = 1, v1 = v6 = 2 , and vj = 0 otherwise

then n(v) = (6, 6, 6, 3, 3, 3, 3, 1, 1, 1, 1).

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

21

Given (, )  M with || = || > 1, from now on we define

n := n( + ) .

We observe that there exists a choice of i = ±1, 0 such that by momentum conservation

(6.12) with l = 0 if nl = 1. Indeed we recall that

lnl = 0 .
l

j(j - j ) = h(h + -h - (-h + h))

jZ

hN

and that each h > 1 appears exactly h + -h + h + -h times in the sequence n. Hence we assign the value  = 1, h + -h times to the nl = h (and  = -1 the remaining times). The value h = 1 instead appears in the sequence n, 1 + -1 + 1 + -1 + 0 + 0 times. Hence we assing the value  = 1, 1 + -1 times, the value  = -1, -1 + 1 times and  = 0 all the remaining times.
From (6.12) we deduce

(6.13)

n1  nl.
l2

Indeed, if 1 = ±1, the inequality follows directly from (6.12); if 1 = 0, then n1 = 1 and consequently nl = 1 l. Since the mass is conserved, the list n has at least two elements, and the inequality is achieved.

We need the following elementary result (see Lemma C.2 of [BMP20a])

Lemma 6.2. Let 0 < a < 1 and x1  x2  . . .  xN  2. Then

1N x 1N xa

 x11-a +

2 axa1

.

For j  Z and (, )  Mj by Lemma 6.2 (with a = 1/2) we can write

(6.14)

j2 s ss +s



n1 l2 nl 

(6.13)


l2 nl  l2nl



4

+

n2

1 2

l2

nl



1 2



3

l3

nl



1 2

.

Now, by (6.14) and (1.17)

(6.15)

K1/14

(6.11)


K1

:=

sup

sup

jZ (,)Mj

3

l3

nl



1 2



1+

i(s) 2|s - s|2

1
,

sS

In the following we call j1, j2  Sc with |j1|  |j2| the possible normal sites. Let us set

1 := 3 .

i = s(i) ,

i = s(i) .

Lemma 6.3. If   ZZ with || < , satisfies m() = () = 0, then || is even and || = 2.

Proof. As usual we write in a unique way  = + - - where ±s  0 and +s -s = 0 for every s  Z. Since m() = 0 we get |+| = |-|, therefore || = |+| + |-| is even. Now assume by contradiction that |+| = |-| = 1. Then + = ei, - = ej for some i = j and () = i - j, which contradicts () = 0.

By Lemma 6.3, the constraint sSc s + s  2 implies that there exists at least one s  S such that s + s = 0. We denote the largest in absolute value s  S with this property as sM and iM := i(sM). We divide
the proof in six cases:

22

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Case 1. n2 > sM. Here, since there are at most two normal sites we get

l3nl = s(i)i+i .
iiM

Recalling that

i(s) |s - s| = i |i - i|  i (i + i) , if s = s(i) , i  Z ,

we get

(6.16)





log

K1



log(3 )

+

sup
,

-

 2

(i
iiM

+

i)

logs(i)

+

1

iiM

log

1+

i 2(i + i)2

 = log(3) + 1 sup Ak ,
kNZ

where, for k  NZ, we define

(6.17)

Ak :=

-¯ki logs(i) + log 1 + i 2ki2 ,

iiM : ki1

¯

:=

 21

,

meaning that the sum over i is restricted to the indexes such that ki  1. We split the sum into two terms Ak = Ak + A>k , with

Ak :=

-¯ki logs(i) + log 1 + i 2ki2 ,

i<i :ki1

A>k :=

-¯ki logs(i) + log 1 + i 2ki2 ,

i iiM:ki1

Regarding the first term we get, recalling that s(i)  i,

Ak 

-¯ki logi + 1 + 2 log i + 2 log ki  8i log i +

-(¯ log 2)ki + 2 log ki

i<i :ki1

i<i :ki1



8i

log

i

+

log

1 ¯

,

using that maxx1 -(¯ log 2)x + 2 log x  2 log 1/¯. Consider now the second term. By (1.6a) we get

where and28

A>k 

-¯ki log1+ |i| + log 1 + i 2ki2  A>k,1 + A>k,2 ,

i iiM ,ki 1

A>k,1 :=

2f (i, ki) ,

i iiM ,ki 28/¯

A>k,2 :=

2f (i, ki) ,

i iiM ,1ki <28/¯

(6.18)

f (i, k) := -¯k log1+ i + 3 log i + 2 log(¯k) + 2 log(1/¯) .

When ki  28/¯ we have29

f

(i,

ki)



-

1 2

¯ki

log1+

i

+

2

log(¯ki)

+

2

log(1/¯)



-

1 4

¯ki

log1+

i

+

2

log(1/¯)



-7

log1+

i

+

2

log(1/¯)

,

which is negative for i  1/¯. Then we get

A>k,1



4 ¯

log(1/¯) .

We finally consider the term A>k,2, namely when ki < 28/¯. In this case

f (i, ki)  3 - ¯ log i log i + 7 + 2 log(1/¯) .

28Recall that i  3.

29Using

that

-

1 4

x

+

2

log

x



0

for

x



28

and

log

i



log

i



1.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

23

We claim that the last quantity is negative for i  exp(4¯-1/). Indeed, since   2

f (i, ki)  - 4¯ + 7 + 2 log(1/¯)  0 for ¯  1/2. On the other hand for i < exp(4¯-1/) we have

So we finally get Recollecting we get

f (i, ki)



12 ¯

+7+

2 log(1/¯)



20 ¯

.

A>k,2



40 ¯

exp(4¯-1/ )



40 exp(5¯-1/) .

log K1  c exp(5¯-1/) ,

where, here and in the remaining part of the proof c is a suitably large constant depending only on i, 1.

Case 2. n1 > sM = n2 and only one normal site. We have iSc i + i = 1 and the normal site must be n1. Moreover

(6.19)

l3nl = s(iM)hM +hM -1 s(i)i+i .

i<iM
so

(6.20)

K1  3 sup

s(i)-(i+i)/2s(iM)-(iM +iM -1)/2 1 + iM 2|iM - iM |2 1

, i<iM

i<iM

1+

i 2(i + i)2

1
.

If iM = iM and hence iM does not appear in the small divisors, then we proceed as in case 1.

(a) If iM + iM  2 then we claim that

(6.21)

log s(iM)-(iM +iM -1)/2 1 + iM 2|iM - iM |2 1



c 

.

In order to prove our claim we consider two cases iM  i and iM > i. In the first case, letting x = hM +hM -1  1, the left hand side of (6.21) is bounded by

1 -¯x log 2 + log 1 + i2(x + 1)2 , which is negative for x  c/¯2 and, therefore, bounded by c log ¯. Consider now the case iM > i. By (1.6a) the left hand side of (6.21) is bounded by30
1 -¯x log1+ iM + log 1 + i2M(x + 1)2  1f (iM, x) , with f defined in (6.18). Reasoning as above we can estimate f (iM, x) by c/¯ obtaining (6.21). By (6.20) and (6.21) we have

log

K1



log(3 )

+

c 

+

sup
,

-

 2

(i + i) logs(i) + 1

log 1 + i 2(i + i)2

i<iM

i<iM

,

and we proceed as in case 1.

(b) If iM + iM = 1 (then |iM - iM | = 1), here the second factor in (6.20) is equal to one. Thus in order to bound the third factor (i.e. (1 + iM 2)1  21i2M1) we distinguish two cases: iM  i and iM > i. In the first case 21i2M1  21i21 and the estimate of K1 in (6.20) proceeds as in the case 1 above. On the other hand when iM > i we need a different argument.
Given u  ZZ, with |u| < , consider the set

{j = 0 , repeated |uj| times} ,

30Recalling that iM > i  21 and log 21  3.

24

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

where D <  is its cardinality. Define the vector m = m(u) as the reordering of the elements of the set above
such that |m1|  |m2|  · · ·  |mD|  1. Given  =   NZ, with || = || <  we consider m = m( - ) and31 n = n( + ).

Lemma 6.4 (Lemma C.4 of [BMP20a]). Given  =   NZ, with 1  || = || <  and satisfying (6.7), we have

(6.22)

|m1|  31 n2l .
l3

Recalling that |iM - iM | = |sM - sM | = 1 where sM = s(iM), we have that sM  |m1|. Then

s(iM) = sM  |m1|  31 n2l = 31 s(i)2(i + i)  31 s(i)2(i + i) + 31

s2(i)(i + i)

l3

i<iM

ii

i<i<iM

(6.23)  31 s2(i + i) + 31

s2(i)(i + i)

ii

i<i<iM

using that s(i) is increasing. By (1.6a)-(1.6c), for the inverse function i(s) we have for integer j  1 and s, s  s := s(i)

(6.24)

i(s + s)  i(s) + i(s) , i(js)  ji(s) , i(s2)  i2(s) .

Applying the inverse function i(s) to the inequalities in (6.23) and using (6.24) we get

(6.25)







iM  31i2 (i + i) + 31

i2(i + i)  c i2(i + i)  c

1 + i 2(i + i)2

ii

i<i<iM

i<iM

i<iM


where by we mean that the sum is only over the indexes i such that i + i  1. By (6.20) we get

(6.26)

log K1  c + log(3) + sup
, i<iM

-

 2

logs(i)

+

31

log

1+

i 2(i + i)2

.

Again we proceed as in case 1.

Case 3. n1 > sM = n2 and two normal sites. Now

(6.27)

l3nl = j2s(iM)hM +hM -1 s(i)i+i ,

i<iM

where j2 is the smallest32 normal site. We have

(6.28)

K1  3j2-/2 sup

s(i)-(i+i)/2s(iM)-(iM +iM -1)/2 1 + iM 2|iM - iM |2 1

1+

i 2(i + i)2

1
.

, i<iM

i<iM

(a)

If

hM

= hM ,

or

if

hM

+ hM



2

then

we

proceed

as

in

case

2-(a),

since

j2

-

 2

1

and

does

not

bother.

(b) Let now hM + hM = 1. The analogous of (6.25) is

(6.29)

2
iM  c i(j2)

1 + i 2(i + i)2 .

i<iM

Then by (6.28) we get

(6.30)

log

K1



c + log(3 )+ 41

log

i(j2)-

 2

logj2+sup
,

i<iM

-

 2

logs(i)

+

31

log

1+

i 2(i + i)2

.

31The relation between m and n is the following. If we denote by D the cardinality of m and by N the one of n, respectively,

we have D + 0 + 0  N and (|m1|, . . . , |mD|, 1, . . . , 1 ) (n1, . . . nN ), recalling Definition 3.1.

32In absolute value.

N-D times

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

25

Since

sup
x2

41

log

i(x)

-

 2

log

x

= sup
yi(2)

41

log

y

-

 2

log

s(y)

(1.6a)
 c + sup
yi

41

log

y

-

 2

log2

y



c

+

812 

,

we obtain

log K1



c

+

log(3 )

+

812 

+

sup
, i<iM

-

 2

logs(i)

+

31

log

1+

i 2(i + i)2

.

Again we conclude as in case 1.

Case 4 n1 = sM and the (eventual) normal sites are < n2. Let us start with the case of two normal sites j1, j2. We get

(6.31)

l3nl = j1j2s(iM)hM +hM -1 s(i)i+i ,
i<iM

which

contributes

with

the

additional

factor

j1

-

 2

in

the

expression

(6.28).

(a) If hM = hM , or if hM + hM  2 then we are reduced to case 3-(a) (b) If hM + hM = 1 then, we proceed as in case 3-(b) and apply Lemma C.433. The analogous of (6.29) is

(6.32)

2

2

iM  c i(j1) i(j2)

1 + i 2(i + i)2

4
 c i(j1)

1 + i 2(i + i)2 .

i<iM

i<iM

Then the analogous of (6.30) is

log

K1



c

+

log(3 )

+

81

log

i(j1)

-

 2

logj1

+

sup
,

i<iM

-

 2

logs(i)

+

31

log

1+

i 2(i + i)2

.

We conclude as in case 3-(b).

If there is only one normal site or if there is none, then the same arguments apply word by word with the only

"advantage" that there is only one j1 or none in (6.31)

Case 5 n1 = sM and only one normal site j1 = n2. Here (6.19) holds and we proceed as in case 2.

Case 6 n1 = sM, j1 = n2 and two normal sites. The proof follows word by word the one of case 3. This concludes the proof of (6.4).

7. Iterative Lemma and Proof of Theorem 4

Let r, r0, p, p0, ,  be as in (5.1) and 1 <   2 as in Definition 1.2. Let {n}nN, {n}nN be the summable34 sequences:

(7.1)

n

=

 6

2-n

,

0

=

 8

,

n

=

c

n-

1+ 2

n  1 ,

c- 1

:=

8 5

n-

1+ 2

>4

n1

Let us define recursively

(7.2)

rn+1 = rn - 3n  r := r0 -   7r/4 (decreasing) pn+1 = pn + 3n  p := p0 +   p (increasing) ,

recalling (5.1).
Set O = D,S, I = I(p, r) and I(C) = I(p, r, C)(recall (1.17), (1.9) and (3.12)). Since these sets are fixed, we omit to write them explicitly in the notations of this section. For instance we denote Hrn,pn = HrOn×,pIn and

33in the notation of [BMP20a] n1 = |m1|

34Note that

1+ 2

> 1.

26

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Hrn,pn (C) = HrOn×,pIn(C). By (4.13) and (7.2), we can use projections 0, -1, 1, on these spaces for all n.

Remark 7.1. A crucial point for the convergence of the algorithm is that, thanks to (4.13), no small divisor appears in the estimate of the counterterms, see (7.22) and (7.24) below.

Let

(7.3)

H0 := D + G0 + 0 ,

G0  Hr0,p0 (C) ,

0  H0,K(C) ,

where D is defined in (5.1) and the counterterms 0 are free parameters. We define

(7.4)

0 := -1

G(00,K)

+


G(00,R)

+
r0 ,p0

G0(-2)

+
r0 ,p0

G0(-1) r0,p0

,

0 := -1

G0 2

+ 0
r0 ,p0

Lemma 7.1 (Iterative step). There exists a constant C > 1 large enough35 such that if

0  (1 + 0)-5K-3 ,

K := C

r0 

6
sup 26n exp
n

n - n(1 - /2)

,

(7.5)

 := 2c exp

2 1/ c 

,



:=

1+ 2

<

1,

 := 3/2 ,

where

( as in (1.6a), c defined in Lemma 6.1 and c in (7.1)) then we can iteratively construct a sequence of generating functions Si = Si(-2) + Si(-1) + Si(0)  Hri-i,pi+1 (C) and a sequence of counterterms ¯ i  H0,K(C) such that the following holds, for n  0.
(1) For all   D,S, I  I(p, r), for all i = 0, . . . , n - 1 and all p  pi+1 the time-1 hamiltonian flow Si
generated by Si = Si(, I) satisfies

(7.6)

sup
uB¯ri+1 (wp

)

|Si

(u)

-

u|p



2-2i-7 .

Moreover

(7.7)

n := S0  · · ·  Sn-1

is a well defined, analytic map B¯rn (wp)  B¯r0(wp ) for all p  pn with the bound

(7.8)

sup |n(u)
uB¯rn (wp )

-

n-1(u)|p



2-2n-3.

(2) We set L0 := 0 and for i = 1, . . . , n

(7.9)

Li + Id := e{Si-1,·}(Li-1 + Id), i := i-1 - ¯ i-1 , Hi = e{Si-1,·}Hi-1

where i-1 are free parameters and Li : H0,K(C)  Hri,pi(C) are bounded linear operators. We have

(7.10)

Hi = D() + Gi + (Id +Li)i,

Gi,  Hri,pi (C).

Setting for i = 0, . . . , n

(7.11) i := -1 we have

G(i0,K)

+


G(i0,R)

+
ri ,pi

Gi(-2)

+
ri ,pi

Gi(-1) ri,pi

,

i := -1

Gi 1

+ i ,
ri ,pi

(7.12)

i  0e-i+1 ,

i  0

i j=0

2-j

(7.13) (Li - Li-1)h ri,pi  K0(1 + 0)22-i h  ,

Lih ri,pi  K(1 + 0)20

for all h  H0,K(C). Finally the counter-terms satisfy the bound

i j=1

2-j

h ,

(7.14)

¯ i-1   Ki-1(1 + 0)2 , i = 1, . . . , n .

35Depending only on i defined in (1.6a).

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

27

Proof of Theorem 4. Starting from the Hamiltonian H satisfying (5.2), we set G0 = H - D in (7.3). The smallness conditions (7.5) are met, provided that we choose ¯ and C¯ appropriately. Using (7.8) we define  as the limit of the n (which define a Cauchy sequence) and  = 0 = j ¯ j < .
Note that the series is summable by (7.14). For more details see [BMP21, Section 6].

Proof of the iterative Lemma. We start with a Hamiltonian H0 = D + 0 + G0 with 0  H0,K and D. At the n'th step we have an expression of the form

Hn = D + (Id +Ln)n + Gn

with Gn  Hrn,pn ,
To proceed to the step n + 1 we apply the change of variables e{Sn,·}. The generating function Sn and the counterterm ¯ n are fixed as the unique solutions of the Homological equation

(7.15)

0 Sn, D + Gn 1 + (Id +Ln)¯ n + Gn = G(n-2,K) ,

recalling that G(n-1,K) = 0 by (4.7). This equation can be written componentwise as a triangular system and solved consequently. Indeed we have

(7.16)

Sn(-2), D + -2,RLn¯ n + Gn(-2,R) = 0

(7.17)

Sn(-1), D + -1 Sn(-2), Gn 1 + -1Ln¯ n + Gn(-1) = 0

(7.18)

0,K Sn(-2) + Sn(-1), Gn 1 + ¯ n + 0,KLn¯ n + G(n0,K) = 0

(7.19)

Sn(0,R), D + 0,R Sn(-2) + Sn(-1), Gn 1 + 0,RLn¯ n + G(n0,R) = 0 .

We start by solving the equations for Sn it "modulo ¯ n", then we determine the counter-term by inversion of an appropriate linear operator resulting from inserting the equations for Sn into equation (7.18). We hence have by Lemma 6.1

(7.20)

Sn(-2) = L-1 -2Ln¯ n + Gn(-2)

Sn(-1) = L-1 -1 Sn(-2), Gn 1 + -1Ln¯ n + Gn(-1)

Sn(0,R) = L-1 0,R Sn(-2) + Sn(-1), Gn 1 + 0,RLn¯ n + G(n0,R) .

Plugging them into (7.18) we thus get

0,K L-1 -1Ln¯ n + -1 L-1-2Ln¯ n, Gn 1 , Gn1 + ¯ n + 0,KLn¯ n = - 0,K L-1 Gn -1 + -1 L-1Gn(-2), Gn 1 , Gn1 - G(n0,K) .

Note that the left hand side of the equation above can be written as (Id +Mn)¯ n, where Mn : H0,K  H0,K is the operator defined as

(7.21)

Mn : h  Mnh = 0,K L-1 -1Lnh + -1 L-1-2Lnh, Gn 1 , Gn 1 + 0,KLnh .

Similarly to Lemma 6.2 of [BMP21] one has

(7.22)

Mnh   h  /2 .

In order to prove (7.22), we treat the three summands of Mn separately, we recall that by (4.13), (7.13) and by the smallness condition in (7.5)

0,KLnh   3 Lnh rn,pn  3K(1 + )20

n

2-j

h



<

1 6

h .

j=1

28

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

In the (4.13)

soutchherthsautmrm andrs w2 eanudsepthe

identification p.

0,KF   3 F r,p for any r, p (see formulas (4.8) and

We have by (3.16), (4.13), Proposition3.1 and Lemma 6.1

0,K -1L- 1Lnh, Gn 1

3

-1L- 1Lnh, Gn1

 2r,p

(3.15),(7.2)
 120 (7.23)

-1L-1Lnh rn,p

Gn 1

(7.11)
rn,p  240

L- 1Lnh rn,p n

(5.1),(7.2),(6.3)



240 exp c exp

2 1/ 3

Lnh

rn,pn

n

(7.5),(7.13)


1 6

K2

0(1

+

0)3

h



(7.5)


1 6

h

,

where, in order to control the exponential term we used the definition of K given in (7.5) and the fact that c < 1/4 (recall (7.1)). Now we estimate the remaining term in (7.21). We have, again by (3.16), (4.13), (7.11), Proposition3.1 and Lemma (6.1)

0,K L-1-1 L-1-2Lnh, Gn 1 , Gn 1   3 L-1-1 L-1-2Lnh, Gn 1 , Gn 1

(3.15),(7.2)
 400

L-1-1

L-1-2Lnh, Gn 1

3r/2,p Gn 1 3r/2,p

(7.11)
 400 L-1-1 L-1-2Lnh, Gn1

(4.13),(6.3)
 400 exp c exp

4 1/ 3

3r/2,p n L-1-2Lnh, Gn 1

3r/2,(p+pn)/2 n

 2r,p

(3.15),(7.11)



214 exp c exp

4 1/ 3

L-1-2Lnh rn,(p+pn)/2 2n

(4.13),(6.3)
 214 exp 2c exp

4 1/ 3

Lnh

rn,pn

2n

(7.5),(7.13)


1 6

K2

0

(1

+

0)4

h



(7.5)


1 6

h



noting that by (5.1) and (7.2)

rn

-

3 2

r



r

-

3 2

r



r 4

,

p - pn 2



p - p 2



3 2



and estimating the exponential term as in (7.23). This concludes the proof of (7.22).

Then we have that:

(7.24)

¯ n = -(Id +Mn)-1 0,K L-1 Gn -1 + -1 L-1Gn(-2), Gn 1 , Gn 1 + G(n0,K)

is well defined. In order to prove (7.14) we split (7.24) in three terms and note that by (7.22) the operator norm of (Id +Mn)-1 is bounded by 2. Regarding the first one we obtain

(7.25)

(Id +Mn)-10,K L- 1Gn -1, Gn 1

6

L- 1Gn -1, Gn 1

 2r,p

(3.15),(7.2)
 240

L-1Gn -1

rn,p

(5.1),(7.2),(6.3)



240 exp c exp

Gn 1

(7.11)
rn,p  240

L- 1Gn -1

rn,p n

2 1/ 3

Gn -1

rn,pn

n

(7.5),(7.11),(7.13)


1 4

Kn(1

+ 0) ,

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

29

taking C large enough here and below. Regarding the second term we get

(Id +Mn)-10,K L-1-1 L-1Gn(-2), Gn 1 , Gn 1   6 L-1-1 L-1Gn(-2), Gn 1 , Gn 1

(3.15),(7.2)
 800

L-1-1

L-1Gn(-2), Gn 1

3r/2,p Gn 1 3r/2,p

(7.11)
 800

L-1-1

L-1Gn(-2), Gn 1

3r/2,p n

(4.13),(6.3)
 800 exp c exp

4 1/ 3

L-1Gn(-2), Gn 1 3r/2,(p+pn)/2 n

 2r,p

(3.15),(7.11)


215

exp

c exp

4 1/ 3

L-1Gn(-2) rn,(p+pn)/2 2n

(4.13),(6.3)
 215 exp 2c exp

4 1/ 3

Gn(-2)

rn,pn

2n

(7.5),(7.11),(7.13)


1 4

K

n(1

+

0)2 .

Finally for the third term we get

(Id +Mn)-1G0n,K

(7.11)
  2n

so (7.14) follows. By substituting in the equations (7.20) we get the final expressions for Sn(-2) and Sn(-1) and finally Sn(0,R)

which by (3.15), (6.3), (7.11), (7.13), (7.5) and (7.14) yield the estimates

(7.26)

Sn(-2) rn,pn+n  (1 + K2(1 + 0)40)Dnn  2Dnn Sn(-1) rn-n,pn+2n  (1 + 16r0-n 1Dn0)2Dnn Sn(0) rn-2n,pn+3n  (1 + 16r0-n 1Dn0)23Dnn

where

Dn := exp c exp

2 1/ n

 exp

1 2



n

( and  defined in (7.5)) systematically using the inductive hypothesis and the first bound in (7.5). The final bound thus reads (recall (7.1) and (7.2))

(7.27)

Sn

rn -2n ,pn+1



r02 2

4n+8

exp

 n

n(1 +

0)2

(7.5),(7.12)


 22n+10r0

.

Then we can apply Proposition 3.4 since (3.17) is satisfied by Sn with   n and r  rn+1. Then item (1) of Lemma 7.1 is easily proved. In particular (7.6) follows by (3.18) and (7.27) (for complete details see the

analogous proof of [BMP21, Lemma 6.1]).

Regarding item (2), by construction we have

Ln+1 - Ln = e{Sn,·} - Id  (Ln + Id)

hence by (3.20), (3.17), (7.1) and (4.8)

(7.28)

(Ln+1 - Ln)h rn+1,pn+1


(7.27),(7.5),(7.13)


r02n+9 

Sn

rn -2n ,pn+1

(Ln + Id)h rn-2n,pn+1

r03 3

8n+9

exp

 n

n(1 + 0)2

h ,

which by (7.5) proves (7.13). As for the expression of Gn+1, by (7.10) and (7.9) we have

Gn+1 = e{Sn,·}Hn - [D + (Id +Ln+1)n+1] .

30

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Since Sn solves the Homological equation (7.15), we have that by (7.9)

(7.29)

Gn+1 = G(n-2,K) + Gn1 + 1 Ln+1¯ n + Sn, Gn 1 + Gn+1,

Gn+1, = {Sn, Gn0} + 0(Ln+1 - Ln)¯ n + e{Sn,·} - Id -{Sn, ·} Gn


-

(ad Sn)h-1 h!

0(Id +Ln)¯ n + Gn 0 + 0{Sn(-1) + Sn(-2), Gn1}

h=2

using that 0({Sn, D}) = ({Sn, D}) by (4.4) and that Sn, G(n-2,K) = 0. Note that Gn+1, is quadratic in
Sn  Gn 0. Recalling (7.1), (7.2), (3.15), (4.13), (7.5), (7.11), (7.13), (7.14) and Proposition 3.4 (which can be applied by (7.27))

(7.28)

(7.27),(7.26)


Gn+1, rn+1,pn+1

2n+6r0 

Sn

rn-2n,pn+1 n

+

r03 3

8n+9

exp

 n

n(1 + 0)2

¯ n



+

22n+21r02 2

Sn

2 rn-2n

,pn+1



0

+

2n+10r0 

0(Id +Ln)¯ n + Gn 0 + 0{Sn(-1) + Sn(-2), Gn 1}

rn -2n ,pn+1

Sn

rn -2n ,pn+1

26n+55

r06 6

exp

2 n

2n(1 + 0)5

+

2n+24r0 

¯ n



+

n

+

2n

r02 2

20n

exp

 n



Sn rn-2n,pn+1

(7.27),(7.14)


26n+55

r06 6

exp n

+ K exp n

2n(1 + 0)5

(7.5)


257

 K2

exp

 n

+1

e-n+1/2n



260

 K

e-n+1

0



e-n+1 0

,

taking C large enough. Recalling (7.11) and (7.29) this implies36 the first estimates in (7.12).

By the above estimate and recalling (7.11) and (7.29) we get

n+1  n+1 + n + e-n+1 0 + -1 1 Ln+1¯ n + Sn, Gn 1

rn+1,pn+1

 n + 4e-n+1 0 + 24n + 2n+7r0-1 Sn  rn-2n,pn+1 0  n + 02-n-1

again by (4.13), (7.5), (7.13), (7.14), (3.15), (7.27). This finally implies the second estimates in (7.12). The analyticity of n and n follows by Lemma 6.1, point (ii) of Proposition 4.1 and recalling Remark 3.2.

8. Measure estimates Lemma 8.1 (Measure estimates). The set C defined in (1.20) satisfies (1.14), namely

measQS (QS \ C(VSc , I, ))  C0 ,

meas[-1/4,1/4]S VS QS \ C(VSc , I, ), VSc , I  C0 .

Proof. We start proving the first estimate in (1.14). Take   1/2. For  = 0 with || < , sSc |s|  2, () = 0 and m() = 0 we define the resonant set

(8.1)

R = R(VSc , I, ) :=



 QS

: |(, VSc , I) · |  
sS

1 (1 + |s|2 i(s)

2 )

=: d()

Recalling the definition of (, VSc, I) in (1.20) we note that by the continuity with respect to the product topology of the functions   j(, VSc, I) with j  Sc , I  I(p, r) (and since || < ) we have the crucial fact
that the sets R are closed (w.r.t. the product topology) and, therefore, measurable with respect to the product

36Recall that the seminorm of the constant term Gn(-2,K) is zero.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

31

probability measure on QS . Moreover, since QS is compact all the R are compact too.
In the following we will often omit to write the immaterial dependence on VSc and I. Set q() := sN s2s. If |q()|  || then

| · |  |

s2s| -

1 2

||



1 2

||

<

1 2

sN

and R = . Recall the definition of the set C given in (1.20) and (1.17). Denoting by meas the product probability measure on QS, we have

(8.2) where

QS \ C = R ,
A

which implies

meas(QS \ C)  meas(R) ,
A

(8.3)

A :=   ZZ : 0 < || < ,

|s|  2, m() = () = 0, |q()| < || .

sS c

Fix   A. We note that

(8.4)

 s¯ = s¯()  S (depending only on ) such that s¯ = 0,

otherwise 0 < || = sSc |s|  2, which contradicts Lemma 6.3. Since () = (, ()), we get
(1.19)
|t|-1|(( + tes¯) · ) - (() · )|  |s¯| - 2 sup |s|lip  1 - 2C  1/2 ,
sS c
taking (p) small enough in (1.11). Set ^ = (s)s=s¯. Then for every ^ there exist a(^) = a(^, VSc , I, ) < b(^) = b(^, VSc , I, ) satisfying

(8.5)

s¯ s.t (s¯, ^)  R  a(^), b(^) , with b(^) - a(^)  4d() ,

which implies

meas{s¯ s.t (s¯, ^)  R}  4d() .

Since R is measurable, by Fubini's Theorem we have that

meas(R)



4d()

=

4

sS

(1

+

1 |s|2

i(s)

2 )

=

4

iN

(1

+

1 |s(i)|2

i

2)

.

Therefore

(8.6)

meas(QS

\ C)



4
A iN

1 (1 + |s(i)|2

i

2)

.

We claim that

(8.7)

A

d()

=

A

iN

(1

+

1 |s(i)|2

i

2 )

 C0/17 ,

taking C0 large enough37. Given k  ZN with |k| <  we define k  ZZ supported on S setting

ks := ki(s) , for s  S , s = 0 for s / S .

Now for each   A there exist unique k  ZN with |k| <  and s1, s2  Sc and 1, 2 = ±1, 0 such that

(8.8)

 = k + 1es1 + 2es2 .

37The quantity on the left hand side of (8.7) depends only on  , but we fixed  = 3/2.

32

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

On the other hand, given k  ZN with |k| < , there exist at most 36(|k| + 2) vectors   A satisfying (8.8). Indeed we prove that, given 1, 2 = ±1, 0, there exist at most38 4(|k| + 2) couples (s1, s2)  Sc × Sc such that  in (8.8) belongs to A. Indeed they have to satisfy

1s1 + 2s2 = -(k) 1s21 + 2s22 = -q(k) + h ,

for some |h| < ||  |k| + 2 .

Then by (8.6) we get

1 A iN (1 + |s(i)|2

i

2 )



36

(|k|
kZN :0<|k|<

+

2)

iN

(1

+

1 |ki|2

i

2)

.

Since

we get

|k| + 2  2 (1 + |ki|2 i 2)1/2
iN

1 A iN (1 + |s(i)|2

i

2)



72

kZN :0<|k|<

iN

(1

+

1 |ki|2 i

2) -1/2 .

where the last sum converges (see [Bou05] or Lemma 4.1 of [BMP20a]) provided that  > 1. This concludes the

proof of (8.7) taking C0 large enough and, by (8.6), the proof of the first estimate in (1.14).

Let us now prove the second estimate in (1.14). Set for brevity

(8.9)

meas(E) := meas[-1/4,1/4]S (E  [-1/4, 1/4]S )

the product probability measure on [-1/4, 1/4]S . Since VS (defined in (1.13)) is Lipschitz C-close to the map VS (defined in (1.8)) we have that
VS (QS , VSc , I)  [-1/4, 1/4]S
for every VSc  [-1/4, 1/4]Sc and39 I  I(p, r). The function VS (, VSc , I) is invertible (w.r.t. ). In particular
there exists a function

(8.10)

g : [-3/8, 3/8]S × [-1/4, 1/4]Sc × I(p, r)  (VS , VSc , I)  g(VS , VSc , I)  [-4C¯, 4C¯]S ,

which is continuous w.r.t. the product topology in [-3/8, 3/8]S × [-1/4, 1/4]Sc and satisfies

(8.11)

VS q + VS + g(VS , VSc , I), VSc , I = VS ,

where q = (qj )jS , qj := j2 ,

with Lipschitz estimates

(8.12)

|g(VS , VSc , I) - g(VS , VSc , I)| S  6C¯|VS - VS | S .

Indeed recalling (5.11) g satisfies the fixed point equation (e.g. by a slightly modified version of Lemma B.1)

g = - q + VS + g, (q + VS + g, VSc , I), I ;

then (8.10) and (8.12) follow from (5.4)) (recalling (4.12) and (3.10)).
For the remaining of the proof we drop the dependence on VSc and . Fix   A, first we note that for all I, I  I(p, r) the set VS (R(I); I) is measurable since R(I) is closed and VS is continuously invertible. Recalling (8.1) we have

(8.13)

VS R(I), I  [-1/4, 1/4]S = VS  [-1/4, 1/4]S s.t.    R(I) with VS = VS (, I) (8=.11) VS  [-1/4, 1/4]S s.t. | q + VS + g(VS , I), I · |  d() =: E .

38Note that there are 9 possible choices of 1, 2 = ±1, 0. 39In the present proof we actually take I = I. We have introduced I for estimate (8.15) that will be used in the proof of Lemma 2.1.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

33

As usual we set  =: (S , Sc ) and note that, since   A by (8.4) we get |S |  1 and |Sc |  2. Let S¯ := {j  S : j = 0}. We split S =: (S¯, 0). Define ¯S¯ by ¯S¯,j = sign j for j  S¯; then ¯S¯ ·S¯ = |S¯| = |S|  1 and |¯S¯| = 1.
Decomposing VS = (VS¯, VS\S¯) we set
E(VS\S¯) := {VS¯  [-1/4, 1/4]S¯ : (VS¯, VS\S¯)  E} .
We claim that for every VS\S¯  [-1/4, 1/4]S\S¯

(8.14)

meas[-1/4,1/4]S¯ E(VS\S¯)  16d() .

Then by Fubini's theorem we get

(8.15)

meas[-1/4,1/4]S (E) = meas VS R(I), I  16d() .

Then

meas[-1/4,1/4]S VS QS \ C(I), I 

16d()

A

and the second estimate in (1.14) follows by (8.7) and taking I = I. Let us finally prove the claim in (8.14). Fix VS\S¯  [-1/4, 1/4]S\S¯. Setting for brevity40

f (VS¯) :=  q + VS + g(VS , I), I ·  (1=.20) VS¯ · S¯ + (q + g(VS , I)) · S +  q + VS + g(VS , I), I · Sc ,

we get |t|-1|f (VS¯ + t¯S¯) - f (VS¯)|  |S | - 16C¯|S|  |S |/2 .
by (8.12) and (5.10) and taking (p) in (1.11) small enough such that 16C¯  16C¯c(p)  1/2 (recall (5.8),(5.7)) Then we get that

meas{t  R : VS¯ + t¯S¯  E(VS\S¯)}  4d()/|S| .

We need the following (finite dimensional) result proved in the Appendix

Lemma 8.2. Let E  [-1/4, 1/4]n be a measurable set. Let  = (^, -1) with ^  Rn-1. Assume that for every x  [-1/4, 1/4]n we have41 measR{t  R : x + t  E}  . Then measRn (E)  21-n||22, where | · |2 denotes the Euclidean norm.

Then (8.14) follows by the above lemma with42 E = E(VS\S¯) , n = S¯ ,  = ¯S¯ , x = VS¯ ,  = 4d()/|S|
and noting that |¯S|22 = n  |S | and meas[-1/4,1/4]n (A) = 2nmeasRn (A) for every A  [-1/4, 1/4]n.

Proof of Corollary 1.1. It is equivalent to prove that

(8.16)

B(I, ) := {V  (VS , VSc )  [-1/4, 1/4]Z : VS  VS (QS \ C(VSc , I, ), VSc , I)}

is a Borel set in [-1/4, 1/4]Z with measure bounded by C0 (C0 is the constant in (1.14)). The function h : [-1/4, 1/4]Z  QS × [-1/4, 1/4]Sc defined by43

h(V ) := q + VS + g(VS , VSc , I), VSc

40Recall (1.20) and (8.11). 41measR, resp. measRn , being the standard Lebesgue measure in R, resp Rn. 42Here we consider the case when ¯S = -1 the +1 case is analogous. 43g was defined in (8.10). By (8.11) h is the inverse of the function (, VSc )  VS (, VSc ), VSc .

34

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

is continuous with respect to the product topology. Then, for every   A (recall (8.3)), the set

B(I, )

:=

{V  (VS , VSc )  [-1/4, 1/4]Z :

(8.1)=,(8.11) {V  (VS , VSc )  [-1/4, 1/4]Z :

|(h(V )) · |  d()} VS  VS R(VSc , I), VSc , I }

is closed and, therefore, measurable. Then by Fubini's theorem and (8.15) (with I = I) we get meas[-1/4,1/4]Z (B)  16d(). Since B defined in (8.16) can be written as B = AB (recall (8.2)), by (8.7) we get meas[-1/4,1/4]Z (B)  C0.

Proof of Lemma 2.1. The first estimate in (2.4) is equivalent to

(8.17)

meas[-1/4,1/4]S VS QS \ C(VSc , I, ), VSc , I  C0 ,

where C0 was defined in Theorem 2.
In the following we drop the dependence on VSc. We first note that recalling (8.1), (8.3) and setting L := Cr-2, we get

(8.18)

|I - I|2p  d()/4L

=

R(I, /2)  R(I, ) ,

  A.

Indeed, since   A,

Therefore

(1.19)
|(, I) · |  |(, I) · | + 2L|I - I|2p  d()/2 + 2L|I - I|2p  d() .

QS \ C(I, )  C(I, /2)

=

QS \ C(I, )

QS \ C(I, /2)

(8.2)=,(8.18)

R(I, )

R(I, /2) .

A

A , d()<4L|I -I  |2p

Then

QS \ C(I, ) := R(I, )

R(I(nk), /2)

A

kN

A ,

d()<4L|I -I (nk ) |2p

and (recalling the notation in (8.9))

meas VS QS \ C(I, ); I



meas VS (R(I, ); I) +

meas VS (R(I(nk), ); I)

A

kN

A ,

d()<4L|I -I (nk ) |2p

(8.15)
 16 d() + 16

(8.7)
d()  17 d()  C

A

kN

A ,

d()<4L|I -I (nk ) |2p

A

taking the subsequence (nk)kN growing fast enough44. This proves (8.17). The second estimate in (2.4) follows from the first one and Fubini Theorem provided that G(I, ) is a Borel set. This holds true since

G(I, ) = k{V = (VS , VSc )  [1/4, 1/4]Z s.t.VS  VS (C(I(nk), /2), VSc, I(nk))} {V = (VS , VSc )  [1/4, 1/4]Z s.t.VS  VS (C(I, ), VSc , I)}
= [1/4, 1/4]Z \ kB(I(nk), /2)  B(I, ) .

The Borel sets B(I(nk), /2), B(I, ) are defined in (8.16).

44Since the positive term series in (8.7) converges.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

35

Appendix A. Technicalities

Proof of Lemma 3.1. Let us consider first the case f  F(O × B), namely when f depends only on a finite number of j's. By definition this means that, for some k  N there exists a function f^ : Pk(O)×B  C, where Pk is the projection Pk : RZ  R2k+1 defined as Pk() := (-k, . . . , k), such that f (, I) = f^(-k, . . . , k, I)
for every (, I)  O × B. By Cauchy estimates

|f^(, I) - f^(, I)|  2-1|f |,O×B|I - I|E ,

   O , I, I  B/2 .

We need the following

Lemma A.1 (Lipschitz estension). Let X be a metric space endowed with the metric d(·, ·) and  = U  X. Let f : U  R with supU |f | =: M <  be a L-Lipschitz function, namely |f (u) - f (v)|  Ld(u, v) for every u, v  U. There exists an extension f~ : X  R of f such that f~(u) = f (u) for every u  U , supX |f~| = M and f~ is L-Lipschitz. Explicitly

f~ := max{-M, min{f¯, M }} ,

where

f¯(x) := inf f (u) + L d(x, u) .
uU

Before proving Lemma A.1 we conclude the proof of Lemma 3.1. Then Lemma A.1 with X = Pk(Q) × B/2, distance d (, I), (, I) = | - | + 2-1|I - I|E , U = Pk(O) × B/2, f = f^, L = -1|f |,O×B implies
Lemma 3.1 in the case f  F(O × B). Note in particular that, since Pk(Q) is finite dimensional the product topology on it coincides with one induced by the norm | · |. Then the extended function f~  F(Q × B/2) and its continuity in  follows by its Lipschitz-continuity in . Moreover, in this case, |f~|,Q×B/2 = |f |,O×B and

|f~(, I) - f~(, I)|  2-1|f |,O×B|I - I|E ,

   Q , I, I  B/2 .

Consider now the case of a general f  F (O × B). By definition there exists a sequence fn  F(O × B) such that |fn - f |,O×B  4-n-1|f |,O×B and g0 := f0, gn := fn - fn-1 for n  1. Then f = n0 gn. Moreover |g0|,O×B  5/4|f |,O×B, |gn|,O×B = |fn - f |,O×B + |f - fn-1|,O×B  5 · 4-n-1|f |,O×B
and gn  F(O × B). Then there exist extensions g~n  F(Q × B/2), n  0 such that g~n = gn on O × B/2, |g~n|,Q×B/2  5 · 4-n-1|f |,O×B, g~n is continuous w.r.t the product topology in O, finally g~n is Lipschitz on
B/2 with estimate

|g~n(, I) - g~n(, I)|  10-14-n-1|f |,O×B|I - I|E ,

   Q , I, I  B/2 .

Finally set f~ := n0 g~n.

Proof of Lemma A.1. We first prove that f¯ is well defined, namely that f¯(x) > - for all x  X. Indeed

for every u, v  U we have

f (u) + Ld(x, u) = f (v) + f (u) - f (v) + Ld(x, u)  f (v) + L d(x, u) - d(u, v)  f (v) - Ld(x, v) .
Taking the infuU on both sides we get f¯(x)  f (v) - Ld(x, v) > -. Now we prove that f¯(x) = f (x) for every x  U . Indeed, trivially, f¯(x)  f (x). By contradiction, if f¯(x) < f (x) then there exists u  U such that f (u) + Ld(x, u) < f (x). Therefore

Ld(x, u) < f (x) - f (u)  Ld(x, u) ,

which is a contradiction. Now we prove that f¯ is L-Lipschitz. Fix x, y  X. For every  > 0 there exists u  U such that f¯(y)  f (u) + Ld(y, u) - . Then
f¯(x) - f¯(y)  f¯(x) - f (u) - Ld(y, u) +   L d(x, u) - d(y, u) +   Ld(x, y) + 
by the triangular inequality. Since  > 0 is arbitrary we get f¯(x) - f¯(y)  Ld(x, y). Analogously we prove that f¯(y) - f¯(x)  Ld(x, y). The facts that f~(u) = f (u) for every u  U and supX |f~| = M trivially follow by -M  f (u) = f¯(u)  M .

36

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

The fact that f~ is L-Lipschitz follows applying twice the following result: Given a L-Lipschitz g : X  R and c  R the functions g¯ := max{g, c} and g := min{g, c} are L-Lipschitz. We prove it only for g¯, the other case being analogous. We first note that g¯ = (g + c + |g - c|)/2. Then

|g¯(x) - g¯(y)| 

1 2

|g(x) - g(y)| +

|g(x) - c| - |g(y) - c|

 |g(x) - g(y)|  Ld(x, y) .

Proof of Proposition 3.1 The proof reduces to prove the following bound

(A.1)

|{F, G}|r,p  8 max

1,

r 

|F |r+,p|G|r+,p .

Writing F =

F, u u¯ and G = G, u u¯ we have

{F, G} =

F G , ,

 , , ,

j

=: H = H,uu¯ .
,

j j - j j u u¯ +-ej +-ej

where

(A.2)

H, :=

F G , , j j - j j

j +-ej = +-ej =

Recalling (3.5) we have

(A.3)

|{F, G}|r,p  sup

F,

G ,

(j j

+

j



 j

)(

 

+

 )

×

u + -2e + + -2ej
p

,

 j ,,,

where up = up(r) was defined in (3.6). We split in four terms the right hand side of (A.3) according to the splitting
(j j + jj )( + ) = j j + j j + jj  + jj  ;
we will consider only the term

A := sup

F G , ,

j

j



 

×

u + -2e + + -2ej
p

,

 j ,,,

the others being analogous. Noting that j  Z,

G ,



 j

up

+

-2ej

 |G|r,p,

 ,

we have

A  |G|r,p sup

F ,

 ,

j



 

up 

+

-2e

=

|G|r,p sup

F, ||up +-2e

j

 ,

 |G|r,p sup

F ,



 

u~p 

+

-2e

 + 

 ,

r r+

|+|-2 ,

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

37

where u~p is short for up(r + ) (recall (3.6)). Since45

sup  + 
| |=| |

r r+

| + |-2
 sup x
x2

r r+

x-2
 2 max

1,

r 

we get

A  2 max

1,

r 

|G|r,p sup

F, u~p +-2e = 2 max

 ,

1,

r 

|G|r,p|F |r+,p.

This complete the proof of (A.1).

Remark A.1. Note that Proposition 3.1 and its proof hold for any -weighted norm, namely with norm supjZ wj |uj|, with wj  .

Proof of Lemma 3.2. Let us first prove the Banach structure. Consider a Cauchy sequence of Hamiltonians H(n)  HrO,p,0. For all   O, I  I, H(n)(, I) is a Cauchy sequence in Hr0,p then we define

H(, I) =

H,(, I)uu¯  Hr0,p

,M

for all   O I  I, one has pointwise convergence H(n)(, I)  H(, I)  Hr,p. Moreover, for all ,  the sequence H(n,) is a Cauchy sequence w.r.t the norm | · |. Since F (O × I) is Banach, for all ,   M H(n,)  H,  F (O × I). By hypothesis  > 0 there exist N such that forall n, m > N one has

1 2

sup
j

(,)M

|H(n,)

-

H(m,)|

j + j

up +-2ej

=

H (n) - H (m) r,p < 

so taking the liminf on m we get for all j

1 2

lim inf
m

|H(n,) - H(m,)| j + j up +-2ej < 

(,)M

Then, for all ,  one has

(A.4)

|H(n,)

-

H, |



lim inf
m

|H(n,)

-

H(m,)|

so

|H(n,) - H,| j + j up +-2ej 

lim inf
m

|H(n,)

-

H(m,)|

j + j

up +-2ej

(,)M

(,)M

 lim inf
m

|H(n,) - H(m,)| j + j up +-2ej <  ,

(,)M

by Fatou's lemma. Taking the supremum over j we have proved that H(n)  H in the HrO,p,0 norm. Concerning the Poisson algebra property, it suffices to use the fact that |·| has the algebra property with respect

to standard multiplication and from (A.2) we deduce

(A.5)

|H,| 

F,  G,  j j + j j .

j +-ej = +-ej =

Then the proof follows verbatim the one of Proposition 3.1.

45Indeed, 

setting

y

:=

/r,

we

have

that

supx2

x

r r+

x-2 = supx2 x(1 + y)2-x = 2 if y  e - 1. On the other hand, when

0 < y < e - 1 we have

sup x(1 + y)2-x
x2

=

(1 + y)2 e ln(1 + y)



1 y

0<ys<upe-1

(1 + y)2y e ln(1 + y)

=

2 y

.

38

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Proof of Proposition 4.1. Items (i) and (ii) directly follow by Propositions 4.1 and 4.2 of [BMP21], respec-

tively. Here we only discuss the analyticity with respect to I. By formula (4.30) in and recalling the notations

in (4.1) we get the representation formula for every |u|p  r

(A.6)

H(d)(u, , I) =

,,,a,b

m





m

2||+|a|+|b|d+2 2||+|a|+|b|=d+2

 

(-1)|-|Im- Hm,,,a,b(, I)|v|2 vv¯ zaz¯b ,

where m, , , ,   NS , a, b  NSc ,    = . Set for brevity X := XdH the hamiltonian vector field of dH (recall (4.9)). Then define Y componentwise
for j  Z as

Yj

:=

1 2

,,,a,b

m





m

2||+|a|+|b|d+2 2||+|a|+|b|=d+2

 

Ipm- |Hm,,,a,b| j up-2ej ,

with  := 2 +  +  + a + b and again m, , , ,   NS , a, b  NSc,    =  and where up = up(r) was defined

in (3.6) and Ip := u2p/2.

By the formula after (4.30) in [BMP21] we have Y

 wp

with |Y |p



3

d 2

+1

|H

|r,p

and

|Xj(u, , I)|  Yj for every j  Z, u  Br (wp),   O, I  I(p, r) (resp. I  I(p, r, C) in the complex case).

Therefore H(d) is analytic in I(p, r) (resp. I  I(p, r, C) in the complex case) since can be written in a totally

(a fortiori uniformly) convergent series (see e.g. Theorem 2, Appendix A of [PT87]).

Proof of Lemma 8.2. Set x =: (x^, xn). Let introduce the portion of hyperplane (which is a graph over x^) P := {(x^, ^ · x^) x^  [-1/4, 1/4]n-1} ,
orthogonal to . Note that for every y  E there exist unique t  R and x^  [-1/4, 1/4]n-1 such that y = (x^, ^ · x^) + t. Then by Fubini's theorem we have that

meas(E) = ||2 meas{t  R : (x^, ^ · x^) + t  E} d  ||2 d = ||2

P

P

[-1/4,1/4]n-1

= 21-n||22

1 + |^|22dx^

Appendix B. Topology, measure and continuous functions on infinite product spaces

Product topology. Let us consider the set [-1/2, 1/2]Z endowed with the product topology, namely the coarsest
topology (i.e. the topology with the fewest open sets) for which all the projections j : [-1/2, 1/2]Z  [-1/2, 1/2],
with j() := j, j  Z, are continuous. We call cylinder a subset nN An of [-1/2, 1/2]Z such that An  [-1/2, 1/2] with An = [-1/2, 1/2] only for finitely many n  N. Then a basis of the product topology is given by the open cylinders, namely cylinders nN An, where An are open. By the Tychonoff's theorem [-1/2, 1/2]Z with the product topology is a compact Hausdorff space.

Product measures. The product -algebra (of the Borel sets) of [-1/2, 1/2]Z is defined as the set of cylinders nN An, where An are Borel sets (w.r.t. the standard topology on [-1/2, 1/2]).
The probability product measure µ on product -algebra of [-1/2, 1/2]Z is defined by

µ

An := |An|

nN

nN

where |An| denotes the usual Lebesgue measure of the Borel set An. Through the bijective map

V : Q  [-1/2, 1/2]Z ,

where

Vj() := j - j2 ,

j  Z,

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

39

we induce the product topology and the probability product measure on the set Q. Analogously for QS and QSc .

Product measures. Given a compact Hausdorff space X and a Banach space E we denote by C(X, E) the Banach space of continuous functions f : X  E endowed with the uniform norm

|f |C(X,E)

:=

sup
xX

|f (x)|E

=

max
xX

|f

(x)|E

.

Lemma B.1 (Lipschitz fixed point). Let C be the closed subset of the Banach space C(QS × [-1/4, 1/4]Sc ,  Sc) (with the product topology on QS × [-1/4, 1/4]Sc ) defined as

C := {w  C(QS × [-1/4, 1/4]Sc ,  Sc ) s.t. |w|C(QS ×[-1/4,1/4]Sc , Sc )  r} , for some 0 < r < 1/4. Let F  C(QS × [-1/4, 1/4]Sc × [-r, r]Sc ,  Sc ) with

|F (, VSc , w)| Sc  r ,

|F (, VSc , w) - F (, VSc , w)| Sc  1/2|w - w| Sc ,

   QS , w, w  QSc .

Then there exists a unique w  C such that

w(, VSc ) = F (, VSc , w(, VSc )) .
Moreover if F is L-Lipschitz for some L > 0 w.r.t.   QS (endowed with the -metric) then w is 2LLipschitz in . Analogously if F is L-Lipschitz w.r.t. some other parameter I in some Banach space then w is 2L-Lipschitz in I.
Proof. First note that if w  C then F (, VSc , w(, VSc ))  C, since the product topology in [-r, r]Sc is weaker than the one induced by the -norm. Set  : C  C by

((w))(, VSc ) := F (, VSc , w(, VSc )) .

Let us check that  is a contraction on C. Indeed

|(w)

-

(w)|C

=

sup
QS , VSc [-1/4,1/4]Sc

|F (, VSc , w(, VSc ))

-

F (, VSc , w(, VSc ))| Sc



1 2

sup
QS , VSc [-1/4,1/4]Sc

|w(, VSc ) - w(, VSc )| Sc

=

1 2

|w

- w|C .

The existence of the fixed point follows from the Contraction Mapping Theorem on Banach spaces. Assume now that F is L-Lipschitz for some L > 0 w.r.t.   QS (endowed with the -metric d). Then

|w(, VSc ) - w(, VSc )| Sc 

|F (, VSc , w(, VSc )) - F (, VSc , w(, VSc ))| Sc + |F (, VSc , w(, VSc )) - F (, VSc , w(, VSc ))| Sc 

Ld(,

)

+

1 2

|w(,

VSc )

-

w(,

VSc )| Sc

implying

|w(, VSc ) - w(, VSc )| Sc  2Ld(, ) .

The next lemma regards the analyticity of the map i in (1.15). Without loss of generality we consider here

only the case S = Z since we are not assuming Ij = 0.

Lemma

B.2.

For

 I

 B¯r(wp)

the

map

i

in

(1.15)

can

be

extended

to

an

analytic

map

i : T s  wp(C), [] = (j )jZ  ( Ij eij )jZ ,

for any s > 0.

40

LUCA BIASCO, JESSICA ELISA MASSETTI, AND MICHELA PROCESI

Proof. Let us first define C s := { = (j )jZ with | Im j| < s,  j  Z} and the equivalence relation    iff  -   2Z. We set T s := C s / . For   C s we denote by []  T s the equivalence class of . T s is a metric space endowed with the distance

d([], []) := min | - | ,
[]

where | · | is the norm on (C). Moreover it is a Banach manifold. Indeed given every point []  T s , set  := min{1, s - | Im |}/2 and consider the open ball B([])  T s of radius  centered in [] and the open ball U of radius  centered at the origin of (C); then a local chart is  : B([])  U defined so that -1() := [ + ]. We claim that

g := i  -1 : U  wp(C) ,

g() := ( Ij ei(j+j))jZ

is analytic since the Frechet derivative Dg : U  L((C), wp(C)) is continuous. Indeed for every   (C)

Dg()[] = (i Ij ei(j+j)j )jZ

and

for

, ~



U

the

operator

norm

(recall

 I



B¯r (wp ))

satisfies

Dg() - Dg(~) op

=

sup
  (C),| |=1

i

Ij eij (eij - ei~j )j jZ wp(C)

 re| Im |+ (1 - ei(~j-j )) jZ (C)  re| Im |+2|~ - |(C) .

References

[BB]

M. Berti and P. Bolle. A Nash-Moser approach to KAM theory. to appear on Field Institute Communications.

[BB13] M. Berti and Ph. Bolle. Quasi-periodic solutions for Schro¨dinger equations with Sobolev regularity of NLS on T d with

a multiplicative potential. J. European Math. Society, 15:229­286, 2013.

[BBM16] P. Baldi, M. Berti, and R. Montalto. KAM for autonomous quasilinear perturbations of KdV. Ann. Inst. H. Poincare

Anal. Non Lineaire, 33:1589­1638, 2016.

[BD18] M. Berti and J.M. Delort. Almost global existence of solutions for capillarity-gravity water waves equations with periodic

spatial boundary conditions. Springer, 2018.

[BG06] D. Bambusi and B. Gr´ebert. Birkhoff normal form for partial differential equations with tame modulus. Duke Math. J.,

135(3):507­567, 2006.

[BM20] M. Berti and R. Montalto. Quasi-Periodic Standing Wave Solutions of Gravity-Capillary Water Waves. Mem. Amer.

Math. Soc., 263(1273):0, 2020.

[BMP20a] L. Biasco, J. E. Massetti, and M. Procesi. An Abstract Birkhoff Normal Form Theorem and Exponential Type Stability

of the 1d NLS. Comm. Math. Phys., 375(3):2089­2153, 2020.

[BMP20b] L. Biasco, J. E. Massetti, and M. Procesi. A note on the construction of Sobolev almost periodic invariant tori for the

1d NLS. Atti Accad. Naz. Lincei Rend. Lincei Mat. Appl., 31(4):981­993, 2020.

[BMP21] L. Biasco, J.E. Massetti, and M. Procesi. Almost-periodic invariant tori for the NLS on the circle. Ann. Inst. H. Poincar´e

Anal. Non Lin´eaire, 38(3):711­758, 2021.

[Bou93] J. Bourgain. Fourier transform restriction phenomena for certain lattice subsets and applications to nonlinear evolution

equations. I. Schro¨dinger equations. Geom. Funct. Anal., 3(2):107­156, 1993.

[Bou94] J. Bourgain. Periodic nonlinear Schro¨dinger equation and invariant measures. Comm. Math. Phys., 166(1):1­26, 1994.

[Bou96] J. Bourgain. On the growth in time of higher Sobolev norms of smooth solutions of Hamiltonian PDE. Internat. Math.

Res. Notices, (6):277­304, 1996.

[Bou99] J. Bourgain. Global solutions of nonlinear Schro¨dinger equations, volume 46 of American Mathematical Society

Colloquium Publications. American Mathematical Society, Providence, RI, 1999.

[Bou05] J. Bourgain. On invariant tori of full dimension for 1D periodic NLS. J. Funct. Anal., 229(1):62­94, 2005.

[CKS+10] J. Colliander, M. Keel, G. Staffilani, H. Takaoka, and T. Tao. Transfer of energy to high frequencies in the cubic

defocusing nonlinear Schro¨dinger equation. Invent. Math., 181(1):39­113, 2010.

[CMW20] H. Cong, L. Mi, and P. Wang. A Nekhoroshev type theorem for the derivative nonlinear Schro¨dinger equation. J.

Differential Equations, 268(9):5207­5256, 2020.

[Con]

Hongzi Cong. The existence of full dimensional KAM tori for Nonlinear Schro¨dinger equation. arXiv:2103.14777.

[CW93] W. Craig and C. E. Wayne. Newton's method and periodic solutions of nonlinear wave equations. Comm. Pure Appl.

Math., 46(11):1409­1498, 1993.

WEAK SOBOLEV ALMOST PERIODIC SOLUTIONS FOR THE 1D NLS

41

[FG13] E. Faou and B. Gr´ebert. A Nekhoroshev-type theorem for the nonlinear Schro¨dinger equation on the torus. Anal. PDE,

6(6):1243­1262, 2013.

[FI]

R. Feola and F. Iandoli. Long time existence for fully nonlinear NLS with small Cauchy data on the circle. To appear

on Annali della SNS, classe di Scienze. DOI:10.2422/2036 - 2145.201811003.

[GGMP] F. Giuliani, M. Guardia, P. Martin, and S. Pasquali. Chaotic-like transfers of energy in hamiltonian PDEs.

arXiv:2006.09309.

[GH17]

P. Gerard and Koch H. The cubic Szego¨ flow at low regularity., volume Exp. No. XIV of S´eminaire Laurent Schwartz E´ quations aux d´eriv´ees partielles et applications. Ann´ee 2016/2017 . Ed. E´c. Polytech., Palaiseau, 2017.

[GHHP18] M. Guardia, Z. Hani, E. Haus, A. Maspero and M. Procesi. Strong nonlinear instability and growth of Sobolev norms

near quasiperiodic finite-gap tori for the 2D cubic NLS equation. arXiv:1810.03694, 2018. To appear on JEMS

[GK15] M. Guardia and V. Kaloshin. Growth of Sobolev norms in the cubic defocusing nonlinear Schro¨dinger equation. J. Eur.

Math. Soc. (JEMS), 17(1):71­149, 2015.

[GX13] J. Geng and X. Xu. Almost periodic solutions of one dimensional Schro¨dinger equation with the external parameters.

J. Dynam. Differential Equations, 25(2):435­450, 2013.

[HP17] E. Haus and M. Procesi. KAM for beating solutions of the quintic NLS. Comm. Math. Phys., 354(3):1101­1132, 2017.

[KM18] T. Kappeler and J. Molnar. On the wellposedness of the kdv equation on the space of pseudomeasures. Sel. Math. New

Ser., 24:1479­1526, 2018.

[Mas18] J. E. Massetti. A normal form `a la Moser for diffeomorphisms and a generalization of Ru¨ssmann's translated curve

theorem to higher dimensions. Anal. PDE, 11(1):149­170, 2018.

[Mas19] J. E. Massetti. Normal forms for perturbations of systems possessing a Diophantine invariant torus. Ergodic Theory

Dynam. Systems, 39(8):2176­2222, 2019.

[P¨os02] J. P¨oschel. On the construction of almost periodic solutions for a nonlinear Schro¨dinger equation. Ergodic Theory

Dynam. Systems, 22(5):1537­1549, 2002.

[PP15] M. Procesi and C. Procesi. A KAM algorithm for the non­linear Schro¨dinger equation. Advances in Math., 272:399­470,

2015.

[PT87] Ju¨rgen P¨oschel and Eugene Trubowitz. Inverse spectral theory, volume 130 of Pure and Applied Mathematics . Academic

Press, Inc., Boston, MA, 1987.

Universita` degli Studi Roma Tre Email address: biasco@mat.uniroma3.it
Universita` degli Studi Roma Tre Email address: jmassetti@mat.uniroma3.it
Universita` degli Studi Roma Tre Email address: procesi@mat.uniroma3.it

