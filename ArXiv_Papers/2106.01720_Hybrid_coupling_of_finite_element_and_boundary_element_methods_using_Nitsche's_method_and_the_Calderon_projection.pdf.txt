arXiv:2106.01720v2 [math.NA] 9 Jun 2021

Hybrid coupling of finite element and boundary element methods using Nitsche's method and the
Calderon projection
Timo Betcke 1, Michal Bosy 1, and Erik Burman 1
1Department of Mathematics, University College London, 25 Gordon Street, WC1H 0AY, London, United Kingdom
June 10, 2021
Abstract In this paper we discuss a hybridised method for FEM-BEM coupling. The coupling from both sides use a Nitsche type approach to couple to the trace variable. This leads to a formulation that is robust and flexible with respect to approximation spaces and can easily be combined as a building block with other hybridised methods. Energy error norm estimates and the convergence of Jacobi iterations are proved and the performance of the method is illustrated on some computational examples. Key words. FEM-BEM coupling, Nitsche's method and hybridised methods
1 Introduction
The coupling of finite element (FEM) and boundary element (BEM) methods is the most widely used approach for solving multi-physical problems on an unbounded domain. It allows to take advantage of both methods. On the one hand, the BEM reduces the dimension of the problem by using the boundary integral equation, hence it is commonly used in exterior unbounded domains. On the other hand, the FEM is known from their robustness and universal applicability even for problem of inhomogeneous or non-linear nature.
The first coupled procedure was introduced by Zienkiewicz, Kelly and Bettess [ZKB77]. It has been analysed by Brezzi, Johnson and N´ed´elec [BJN78], [BJ79] and [JN80] for problem in unbounded domains. It is often referred to as the Johnson-N´ed´elec coupling. Extension for higher order equations was considered by Wendland [Wen86]. The convergence analysis requires compactness of the double layer potential that can be obtain on the smooth boundary. Furthermore, even for a symmetric discretisation scheme, the coupling method produces a system of equations with a non-symmetric coefficient matrix.
In order to avoid these disadvantages, a symmetric coupling of FEM and BEM was devised by Costabel [Cos87] and Han [Han90]. The independence of the compactness condition was obtain by using both equations of the Calder´on system, contrary to the previously introduced methods that employ only one of the two equations of the Calder´on system. Some years later, Sayas [Say09] showed that the weaker assumption of a Lipschitz coupling interface is sufficient for the JohnsonN´ed´elec coupling. His analysis has since been simplified by Steinbach [Ste11].
email: t.betcke@ucl.ac.uk email: m.bosy@ucl.ac.uk email: e.burman@ucl.ac.uk
1

More recent developments have focused on the coupling of BEM with mixed FEM. In [BCS96] and [MVMP96] the authors analysed symmetric coupling of BEM and mixed FEM that uses Raviart-Thomas elements. Further work on coupling BEM with mixed FEM with such elements as Brezzi-Douglas-Marini or Brezzi-Douglas-Marini-Fortin spaces was analysis by Carstensen and Funken [CF00].
Gatica, Heuer and Sayas [GS06] and [GHS10] introduced the first the coupling of BEM and discontinuous Galerkin (DG) methods, in order to exploit the possibility to easily use high order approximation in the latter. Another coupling of interior penalty DG methods with BEM was presented by Of, Rodin, Steinbach and Taus [ORST12]. A general approach using the unified hybridisation technique was presented by Cockburn and Sayas [CS12]. The class of FEM considered includes the mixed, the DG and the hybridisable discontinuous Galerkin (HDG) methods. Further collaboration of these authors with Gu´zman led to a new convergence results published in [CGS12].
In this paper, we present the coupling of FEM and BEM using weak imposition of coupling conditions. Nitsche's method [Nit71] is widely used in the context of FEM for imposing boundary conditions. In addition, methods based on Nitsche's method have been successfully utilized for BEM domain decomposition problems in [GHH09] and [CH12], and more recently for weakly imposing boundary conditions for BEM in [BBS19]. Merging these two approaches for FEM and BEM we weakly impose both coupling conditions in a hybridised formulation on the boundary. The hybridisation is made by introducing a trace variable and imposing the coupling in the form of a Nitsche type Dirichlet condition on the two systems. The use of Nitsche's method allows us to use the Dirichlet trace as the hybrid variable, ensuring continuity by a consistent penalty term. The test function partner of the trace variable, then acts to ensure continuity of fluxes. The global system can be constructed using arbitrary approximation orders for the two sub systems and the trace variable and the sub problem can be solved independently. The stability of the method poses no constraint on the approximation spaces and mesh refinement does not require special treatment as in the case of Johnson-N´ed´elec coupling. This means that the two systems can have independent meshes, that both have to be integrated only against the trace variable. We here consider the standard continuous FEM, but the formulation is by and large agnostic to the choice of FEM used in the bulk and the method can be applied with discontinuous FEM as well, such as DG, HDG [CGL09], or HHO [DPEL14] using a hybridised coupling on the interior domain boundary. In the case of using discontinuous FEM, our formulation can be interpreted as a hybridised interior penalty formulation of the class of methods discussed in [CS12]. Finally we note that, thanks to the use of Nitsche type mortaring, the method proposed herein can be used in the framework for unfitted hybridised methods introduced in [BEH+19]. In that case a surface mesh is required for the definition of the BEM method, but the FEM approximation on the interior domain can be computed on an unfitted bulk discretisation.
As many existing approaches of coupling FEM and BEM, we use Finite Element Tearing And Interconnecting (FETI) and Boundary Element Tearing And Interconnecting (BETI) type of methods [LS05] to solve the reduced system for the hybrid variable. FETI is formulated using a Schur complement formulation, while BETI is usually formulated in terms of Steklov-Poincar´e operators. Although Nitsche's method is an established framework for domain decomposition for finite elements methods such as FETI, it was not recognised by BETI community. In this paper, we demonstrate how the hybrid Nitsche approach can be integrated into the BETI framework.
The rest of the paper is organized as follows. We introduce the model problem in this section. In Section 2, we present on continuous level the symmetric coupling of BEM and FEM formulation known from [Cos87] and [Han90]. The discrete formulation including weakly imposed coupling condition is introduced and analysed in Section 3. Although the formulation obtained is not symmetric, we comment of how symmetry can be obtained. We discuss iterative domain decomposition in the model case of a simple relaxed Jacobi algorithm in Section 4 and prove its convergence. In Section 5, we present some numerical results and we conclude with some remarks in Section 6.
2

1.1 Model problem

Let us consider the unbounded domain  = R3. We divide  into a bounded internal part - and an unbounded external part + with common Lipschitz boundary , with n the outer unit

normal

vector

of

the

domain

-

on

.

We

let

nu

:=

u n

denote

the

outward

normal

derivative,

f  L2() be a function with support in - and introduce a function   L(),  0. Then

we can formulate our model problem as follows

(1.1)

 -u- + u = f



  

-u+ = 0



u- = u+

in -, in +,
on ,

  

nu- = nu+ on ,

 

|u+|  0

while |x|  .

where ui = u|i , i  {-, +}. The function  is introduced to make the interior problem heterogeneous and hence unsuitable for treatment using the boundary element method alone.

Remark 1. It is straightforward to extend the discussion to the case with a smoothly varying diffusion coefficient in - which has a jump over .

2 Variational formulation

Let

·, ·



denote

the

L2()-inner

product

that

can

be

extended

to

a

duality

pairing

on

H

-

1 2

()

×

H

1 2

().

We

recall

the

following

result.

Lemma

1

(Duality

pairing

relation).

For

any





H-

1 2

()

and

v



H

1 2

(),

the

following

relation

holds

(2.2)

, v  

 H-

1 2

()

v1 .
H 2 ()

Proof. It is obvious for v = 0 and immediately by the definition of the dual norm



= H

-

1 2

()

sup
1

0=vH 2 ()

,v  v1

.

H 2 ()

We start with the variational formulation of the internal problem. Applying integration by parts for first equation of (1.1) for every v  H01(-) we have

(2.3)

u · v dx + uv dx - nu, v  = f v dx.

-

-

-

We define the Green's function for the Laplace operator in R3 as follows

G(x, y)

:=

1 4|x-y|

.

In this paper, we focus on the problem in R3. A similar analysis can be used for problems in R2,

in which case this definition should be replaced by G(x, y) :=

log

|x-y| 2

.

Following the standard

approach (see, e.g. [Ste08, Chapter 6]), we introduce single layer and double layer operators

V

:

H

-

1 2

()



H 1 (+ )

and

K

:

H

1 2

()



H 1 (+ )

respectively

as

(V)(x) := G(x, y)(y) dy


(Kv)(x) :=



G(x,y) ny

v

(y)

dy

for





H

-

1 2

(),

1
for v  H 2 (),

3

where x  + \  and ny is an outer unit normal vector (for i, i  {-, +}) in the point y. Following [Ste08, Chapter 1], we define the Dirichlet and Neumann traces

Di

:

H 1 (i )



H

1
2 ()

Ni

:

H1(, i)



H

-

1 2

()

Di f (x) := i

lim f (y),
yx

Ni f (x) := i

lim nx · f (y),
yx

where H1(, i) := v  H1(i) : v  L2(i) , for i  {-, +}, and nx is an outer (for -) normal vector to  in the point x. The following results will be useful in what follows.

Lemma 2 (Trace theorem). Let i  {-, +}, then for i  R3 the trace operator Di : H1(i) 

H

1 2

()

is

bounded

for

all

v



H 1 (i )

(2.4)

Di v

1
H 2 ()



CT

v

H 1 (i ) .

Proof. See [Ste08, Theorem 2.21].

We use {·} to denote an average of the interior and exterior traces of a function. Then, applying the trace mappings yields to the single layer, double layer, adjoint double layer potentials and hypersingular boundary integral operator

V

:

H

-

1 2

()



H

1 2

()

1

1

K : H 2 ()  H 2 ()

K

:

H

-

1 2

()



H

-

1 2

()

W

:

1
H 2 ()



H

-

1 2

()

V := {DV}, K := {DK}, K := {N V}, W := {N K}.

For the solution u of the problem (1.1), we have the following boundary integral equations on 

(2.5)

D-u N- u

= C-

D-u N- u

,

D+u N+ u

= C+

D+u N+ u

,

where

C±

:

H

1 2

()

×

H

-

1 2

()



H

1 2

()

×

H

-

1 2

()

denotes

two

Calder´on

projectors

defined

as

follows

C± :=

1 2

I

d

±

K

W

V

1 2

I

d



K

.

From the relation (2.5) for external traces we can construct the following exterior Dirichlet-toNeumann operator

(2.6)

DtN +

:=

-W

+

(

1 2

I

d

-

K

)



V

-1



(K

-

1 2

I

d).

Obviously, it makes sense only if the inverse of the operator V exists. Using Dirichlet-to-Neumann operator (2.6) we introduce a new variable  = N+u = nu+ as

(2.7)

 :=

V

-1



(K

-

1 2

I

d)

D-u.

The classical symmetric coupling that satisfies the transmission conditions of (1.1) is as follow

Find

u



H 1 (- )

and





H

-

1 2

()

such

that

for

all

v



H 1 (- )

and





H

-

1 2

()

(2.8)

- u · v dx + - uv dx + W u, v  -

1 2

I

d

-

K

, v 

=

- f v dx,

1 2

I

d

-

K

u,



+

V ,  

=

0.

4

2.1 Well-posedness of the continuous problem

The following results are well known (see [Cos87] or [Han90]), but for reader's convenience we present them in the case of problem (1.1). Let us propose a more compact formulation of (2.8).

Find

u



H 1 (- )

and





H

-

1 2

()

such

that

for

all

v



H 1 (- )

and





H

-

1 2

()

(2.9) where

A ((u, ) , (v, )) = f v dx,
-

A ((w, ) , (v, )) :=

w · v dx +

uv

dx

-

1 2

,

v



+

1 2

w,



-

-

+ W w, v  + K , v  - Kw,   + V ,   .

For

simplicity

we

introduce

the

space

V

:=

H 1 (- )

×

H

-

1 2

()

and

the

associated

norm

(2.10)

(v, )

2 V

:=

v

2 H 1 (- )

+



. 2

H-

1 2

()

Lemma 3 (Continuity). There exists constant  > 0 such that for all w, v  H1(-) and ,  

H

-

1 2

()

(2.11)

|A ((w, ) , (v, ))|   (w, ) (v, ) .

V

V

Proof. We use the Cauchy-Schwarz inequality, the relation (2.2) and continuity of boundary operators (see [Ste08, Section 6.2-6.5]) to obtain

|A ((w, ) , (v, ))|  max{1,  L()} w H1(-) v H1(-)

+

1 2

w1
H 2 ()



H

-

1 2

()

+

1 2

 H-

1 2

()

v1
H 2 ()

+ CK

w1
H 2 ()



H

-

1 2

()

+

CV

  H-

1 2

()

H

-

1 2

()

+ CK

 H-

1 2

()

v

H

1 2

()

+

CW

w1
H 2 ()

v1 .
H 2 ()

We finished by applying the trace inequality (2.4) to terms including · 1 norm,
H 2 ()

v1 +
H 2 ()

w

1
H 2 ()



CT

v H1(-) + w H1(-) .

Lemma 4 (Coercivity). There exists constant  > 0 such that for all v  H1(-) and  

H

-

1 2

()

(2.12)

A ((v, ) , (v, ))   (v, ) 2 .
V

Proof. Using coercivity of V (see [Ste08, Theorem 6.22]) and coercivity of W (see [Ste08, Theorem 6.24]) we obtain

A ((v, ) , (v, )) c

v

2 H 1 (- )

+

V



2

H

-

1 2

()

+

W

v - v¯ 2 1
H 2 ()

where v¯ denotes the average over  of v and c = min(1, ). This shows (2.12) when  > 0. For the case = 0 we need a Poincar´e inequality of the form

(2.13)

cP v H1()  v L2() + |g(v)|

5

where g(v) is some functional that is non-zero for constant non-zero v [EG04, Lemma B.63]. We
claim that this holds with g(v) = V (v), (v)  where (v) is defined by the second equation of (2.8). We immediately see that if this is true then there exists  > 0 such that

A ((v, ) , (v, )) (

v

2 H 1 (- )

We need to show that for constant v = 0 there holds V (v), (v)  = 0. Let v| = u0 be a non-zero constant. Then we need to study

1 2

I

d

-

K

u0, 

+

V (v),   = 0,





H

-

1 2

().

We argue by contradiction. Assume that (v) = 0. Then u0 is the trace of a solution to the homogeneous Neumann problem in -. However by the first line of the left relation of equation
(2.5) there holds for all such traces

(2.14)

1 2

I

d

-

K

u0, 

=

Id u0,   ,





H

-

1 2

().

Hence the functional is defined by

V (v),   = - Id u0,   ,





H

-

1 2

().

However since the operator on the left hand side, defined by, V is injective it follows that (v) = 0,
which leads to a contradiction. Hence V (v), (v)  = 0 for v constant. This concludes the proof.

The existence and uniqueness of the solution of problem (2.9) is achieved by using the LaxMilgram theorem.

3 The discrete problem

We assume that - is a polyhedral domain. The boundary  may be decomposed in a set of n planar surfaces {j}nj=1. It will be convenient to use following broken Sobolev spaces over the polyhedral boundary . For s > 1 define

Hs() := v  H1() : v|j  Hs(j), 1  j  n .

When s > 1 the norm on Hs(), is defined as the broken norm over the faces of the polyhedral

boundary 

1


n

2

v Hs() := 

v

2
Hs(j )

.

j=1

When 0  s  1 the space Hs() coincides with the usual space Hs() and their norms are
the same (for more details see [SS11, Definition 4.1.48]). Let Th be a triangulation of - made of tetrahedrons. For each triangulation Th, Eh denotes the
set of its facets. In addition, for each of element K  Th, hK := diam(K), and h := maxKTh hK . Let Gi, i = 1, 2 denote two different surface triangulation of the boundary . For notation convenience we here assume that the trace mesh of Th and the Gi all have the similar local mesh size.
The following result will be useful in what follows.

Lemma 5 (Trace inequality). There exists Cmax > 0, independent of hK , such that for all K  Th and polynomial function v in K the following discrete trace inequality holds

(3.15)

1
hK2 v L2(K)  Cmax v L2(K).

6

Proof. See [DPE12, Lemma 1.46]

To discretise the problem (2.8) over the triangulation one can choose either continuous or discontinuous finite elements. For simplicity of the analysis we choose the following spaces

Vhj := Whk := lh := Mhm :=

vh  C0 - : vh|K  Pj (K)  K  Th , wh  C0 () : wh|E  Pk (E)  E  G1 , h  L2 () : h|E  Pl (E)  E  G1 , vh  L2() : vh|E  Pm (E)  E  G2 .

Let us denote Vh := Vhj × Whk and vh = vh-, vh+  Vh. Using the above spaces we propose the hybrid discrete formulation of the problem (2.8)

Find (uh, h, uh)  Vh × lh × Mhm such that for all (vh, h, vh)  Vh × lh × Mhm

(3.16) where

ah u-h , uh , vh-, vh + bh u+h , h, uh , vh+, h, vh =

f vh-dx,

-

ah ((wh, wh) , (vh, vh)) := wh : vhdx + whvhdx

-

-

- nwh, vh - vh  - wh - wh, nvh 

+

 h

wh - wh, vh - vh  ,

bh ((wh, h, wh) , (vh, h, vh)) :=

1 2

I

d

-

K

wh, h

+

V h,

h 

+ W wh, vh  -

1 2

I

d

-

K

h, vh 

+ h, vh - vh  - wh - wh, h 

+

 h

wh - wh, vh - vh  .

The stabilisation parameter  > 0 has to be chosen appropriately. The formulation of bilinear form ah is well known for example from [Egg09]. As we said before it is possible to use the discontinuous finite element method for example symmetric interior penalty hybrid discontinuous Galerkin method presented in [ES10].

Remark 2 (Impedance boundary condition). The hybrid weakly imposed Dirichlet and Neumann boundary conditions is related to an impedance boundary condition of the type

u u = - + u,
n

with



=

h 

.

This can be seen considering terms associated with vh in above definition of the

bilinear forms.

Remark 3 (Relation to a standard Nitsche type method without hybridisation). The trace variable uh can be eliminated by replacing it by a linear combination of u+h and u-h with similarly the test function vh replaced by the same linear combination of the test functions vh+ and vh- (see [BHL21, Section 4.2]). The below analysis carries over verbatim to this case. If in addition vh+ and vh- are chosen in the same spaces (with the same trace meshes) u-h and vh- can be substituted for u+h and vh+ respectively, resulting in a (fully coupled) method with the unknowns u-h and h only.

7

3.1 Symmetric formulation

Despite using the symmetric Nitsche method, our whole system is not symmetric. This is a consequence of the lack of symmetry of the boundary element method with weak imposition. We can use the Steklov-Poincar´e operator to eliminate the flux variable, so that the non-symmetric method above is transformed into a symmetric reduced system as we show below.
The following equations are associated with bilinear form bh from (3.16) reads

-

1 2

I

d

-

K

wh, h

-

V h, h  = -

wh - wh, h  ,

- W wh, vh  +

1 2

I

d

-

K

h, vh  -

h, vh - vh



=

 h

wh - wh, vh - vh  .

Similar to the continuous formulation we use the Dirichlet-to-Neumann operator (2.6) to obtain

(3.17)

h :=

V

-1



(K

-

1 2

I

d)

wh + V -1 (wh - wh) .

Injecting this relation into the second equation leads to the formulation of the new symmetric bilinear form

bh ((wh, wh) , (vh, vh)) := W wh, vh  -

1 2

I

d

-

K

V -1(K -

1 2

I

d)wh

,

vh



-

1 2

I

d

-

K

V -1 (wh - wh) , vh 

+

V -1(K -

1 2

I

d)wh,

vh - vh



+

V -1 (wh - wh) ,

vh - vh



+

 h

wh - wh,

vh - vh  .

3.2 Well-posedness of the discrete problem

Let us consider the following norms

(3.18) (3.19)

(wh, wh)

2 F

:=

wh

2 H 1 (- )

+

 h

wh - wh

2 L2 ()

,

(wh, wh)

2 F

:=

(wh, wh)

2 F

+

h

nwh

2 L2 ()

,

(wh, h, wh)

2 B

:=

wh

2
1

+

H 2 ()

h

2

H-

1 2

()

+

 h

wh - wh

2 L2 ()

,

(wh, h, wh)

2 B

:=

(wh, h, wh)

2 B

+

h

h

2 L2 ()

.

Lemma 6 (Equivalence of the norms). For all (wh, h, wh)  Vh × lh × Mhm there exist positive constants CF , CB such that

(3.20) (3.21)

wh-, wh F  wh-, wh wh+, h, wh B  wh+, h, wh

F  CF B  CB

wh-, wh F , wh+, h, wh B .

Proof. For (3.20) we use the trace inequality (3.15) and for (3.21) we use the inverse inequality

h1 2

h L2()  C

h

H-

1 2

()

(see [SS11, Remark 4.4.4]).

Lemma

7

(Continuity).

There

exists

positive

constant

F

such

that

for

all

w, v



H

3 2

+

(-

),

for

 > 0, and w, v  L2()

(3.22)

|ah ((w, w) , (v, v))|  F (w, w) F (v, v) F .

There

exists

positive

constant

B

such

that

for

all

w, v



H

1 2

(),

, 



L2()

and

w, v



L2()

(3.23)

|bh ((w, , w) , (v, , v))|  B (w, , w) B (v, , v) B .

Proof. We use Cauchy-Schwarz inequality to obtain (3.22). In the case of equation (3.23), we use Cauchy-Schwarz inequality and Lemma 3.

8

To show the well-posedness of (3.16) we need the ellipticity of the bilinear forms ah and bh

Lemma 8 (Coercivity). Assume that positive constant  is large enough. Then, there exists positive constant  such that for all (wh, h, wh)  Vh × lh × Mhm

(3.24)

ah wh-, wh , wh-, wh +bh wh+, h, wh , wh+, h, wh



(wh, wh)

2 F

+

(wh, h, wh)

2 B

.

Proof. Let us start with bilinear form ah. First we assume that   min > 0

ah

wh-, wh , wh-, wh

=|wh-|2H1(-) +

1/2wh-

2 -

-

2

nwh-, wh- - wh 

+

 h

wh- - wh

2 L2 ()

.

Using Cauchy-Schwarz and trace inequalities (3.15), followed by Young's inequality, we arrive at

ah

wh-, wh , wh-, wh

|wh-|2H1(-) + min

wh-

2 -

+

 h

wh- - wh

2 L2 ()

- 2 nwh- L2() wh- - wh L2()

|wh-|2H1(-) + min

wh-

2 -

+

 h

wh- - wh

2 L2 ()

- 2 wh- H1(-)

Cmax

h-

1 2

wh- - wh L2()



1 2

|wh- |2H 1 (- )

+

min

wh-

+ 2

 -2Cm 2 ax

-

h

wh- - wh

2 L2 ()

.

We finish by applying the equivalence of the norms (3.20) under the assumption that  > 2Cm2 ax.
In the case of bilinear form bh, by using the results from Lemma 4 we obtain, with w¯h = ||-1  wh+ ds,

bh

wh+, h, wh , wh+, h, wh

V

h

2

H

-

1 2

()

+

W

wh+ - w¯h

2
1
H 2 ()

+

 h

wh+ - wh

2 L2 ()

.

Observe that when  > 0 we may bound

wh+

1
H 2 ()





wh+ - w¯h

1+
H 2 ()

wh+ - w¯h

1+
H 2 ()

wh+ - w¯h

1+
H 2 ()

w¯h L2() wh+ - wh L2() + wh+ - wh L2() +

wh- - wh L2() + wh- L2() wh- - wh L2() + C wh- H1(-)

where we applied the trace inequality (2.4) in the last step. The right hand side is controlled by the lower bounds on ah and bh above. Once again, we finish by applying the equivalence of the norms (3.21).
In case  = 0 we need to show that a Poincar´e inequality holds, similar to (2.13), this time on the form

(3.25)

cP

wh-

H 1 (- )



|wh- |H 1 (- )

+

1 h

wh- - wh

L2 ()

+

1 h

+

wh+ - wh L2()

h

+ H -

1 2

()

wh+ - w¯h

1
H 2 ()

To this end, since coercivity holds up to a constant, we may assume that wh- = w~h = wh+ = w¯h and proceed verbatim as in the continuous case, since in that case the continuous and discrete
expressions corresponding to (2.14) are the same.

The existence and uniqueness of the solution of problem (3.16) is achieved by using the LaxMilgram theorem. In addition, the proposed method is consistent as the following result shows.

9

Lemma

9

(Consistency).

Let



>

0,

u-



H

3 2

+

(-

),

u+



H

1 2

()

and

nu+

=





L2()

be

the solution of problem (1.1) and u = u- = u+ on . If (uh, h, uh)  Vh × lh × Mhm solves (3.16)

then, for all (vh, h, vh)  Vh × lh × Mhm the following holds

ah u- - u-h , u - uh , vh-, vh + bh u+ - u+h ,  - h, u - uh , vh+, h, vh = 0.

Proof. Because of the transmission conditions from (1.1) we have u = u+ = u- and nu = nu+ = nu- on 

ah u - u-h , u - uh , vh-, vh = nu, vh  - u - u, nvh- 

+

 h

u - u, vh- - vh  ,

bh u - u+h ,  - h, u - uh , vh+, h, vh = - , vh  - u - u,  

+

 h

u - u, vh+ - vh  .

By adding above expressions and using the facts that  = nu and u = u on , we obtain consistency.

3.3 Error analysis

In this section we present the error estimates for the method. These estimates are proved using the following norm

(3.26)

u, , u h := u-, u F + u+, , u B .

The first step is the following version of Cea's lemma.

Lemma

10

(Cea's

Lemma).

Let



> 0,

u-



H

3 2

+ (- ),

u+



H

1 2

()

and

nu+

=

 L2()

be

the solution of problem (1.1), u = u- = u+ on , and let (uh, h, uh)  Vh ×lh ×Mhm solve (3.16).

Then there exists C > 0, independent of h, such that

(3.27)

(u - uh,  - h, u - uh)

h



C

inf
(vh ,h ,vh )Vh ×lh ×Mhm

(u - vh,  - h, u - vh) h .

Proof. Let us denote

Ah ((wh, h, wh) , (vh, h, vh)) :=a wh-, wh , vh-, vh + b wh+, h, wh , vh+, h, vh .

Using Lemma 8, we get that there exists  > 0, independent of h, such that for all (vh, h, vh)  Vh × lh × Mhm there exists (wh, h, wh)  Vh × lh × Mhm such that (wh, h, wh) h = 1, and

(3.28)

Ah ((vh, h, vh) , (wh, h, wh))   (vh, h, vh) h .

Now using Lemma 7, we get continuity of Ah, there exists  > 0

(3.29)

|Ah ((v, , v)) , (w, , w)|   (v, , v) h (w, , w) h .

Let (vh, h, vh)  Vh × lh × Mhm. Then, using the triangle inequality we see that

(u - uh,  - h, u - uh) h  (u - vh,  - h, u - vh) h + (vh - uh, h - h, vh - uh) h .

and it follows from (3.28), Lemma 9 and (3.29) that

(vh - uh, h - h, vh - uh)

h



1 

Ah

((vh

-

u,

h

-

,

vh

-

u)

,

(wh,

h,

wh))

+

1 

Ah

((u

-

uh,



-

h,

u

-

uh)

,

(wh,

h,

wh))



 

(vh - u, h - , vh - u) h .

Thus,

we

get

(3.27)

with

C

:=

1

+

 

.

10

Lemma

11

(Energy

norm

estimates).

For

s

>

3 2

,

r

>

1

and

p



1 2

,

let

u-



H s (- ),

u+



H r ()

and nu+ =   Hp() be the solution of problem (1.1). On  there holds u- = u+ = u on . Let

(uh, h, uh)  Vh × lh × Mhm solve (3.16). If the mesh is quasi uniform, then there exists C > 0,

independent of h, such that

(3.30)

(u - uh,  - h, u - uh) h 

C

h-1

u

H (-)

+

h-

1 2

u

H  ()

+

h-

1 2

u

H  ()

+

h+

1 2

 H()

,

where  = min{j + 1, s},  = min{k + 1, r},  = min{m + 1, r} and  = min{l + 1, p}.

Proof. The result is a consequence of (3.27) and approximation. Applying triangle inequality and trace inequality [BS08, Theorem 1.6.6] followed by Young's inequality, we obtain

(u - vh, u - vh)

2 F

:=

u - vh

2 H 1 (- )

+

 h

u - vh - (u - vh)

2 L2 ()

+h

nu - nvh

2 L2 ()



u - vh

2 H 1 (- )

+

C1

 h2

u - vh

2 L2 (- )

+



u - vh

2 H 1 (K )

K Th

+ C2

u - vh

2 H 1 (K )

+

h2

u - vh

2 H 2 (K )

+

 h

u - vh

2 L2 ()

.

K Th

K Th

Using approximation results [EG04, Theorem 1.109] and [SS11, Theorem 4.3.19] for the last term, we claim

inf
(vh ,vh )Vh ×Mhm

(u - vh, u - vh) F  CF

h-1

u

H (-)

+

h-

1 2

u H()

.

For the boundary part, by applying triangle inequality, we obtain

(u - vh,  - h, u - vh)

2 B

:=

u - vh

2
1

+

H 2 ()

 - h

2

H

-

1 2

()

+

h

 - h

2 L2 ()

+

 h

u - vh - (u - vh)

2 L2 ()

 u - vh 2 1 +
H 2 ()

 - h

2

H

-

1 2

()

+

h

 - h

2 L2 ()

+

 h

u - vh

2 L2 ()

+

 h

u - vh

2 L2 ()

.

Using approximation results [SS11, Theorems 4.3.19, 4.3.20 and 4.3.22], we claim

inf
(vh ,h ,vh )Vh ×lh ×Mhm

(u - vh,  - h, u - vh) B 

CB

h-

1 2

u

H  ()

+

h-

1 2

u

H  ()

+

h+

1 2

 H()

.

We conclude the proof by applying Lemma 10.

4 Iterative solution
For the solution of the linear system we will iterate on the Schur complement for the trace variable, solving independently in the two sub domains. To justify this split approach we here show that a simple relaxed Jacobi iteration on the two systems will converge. The condition number of the Schur complement can be analysed using the arguments of [BEH+19, Section 4].
1. Given un solve for un+1 and n+1 by solving the linear system
Ah[(un+1, n+1, un), (v, , 0)] = f v dx.
-
11

2. Given un+1 and n+1, solve for the new trace variable un+1, for  > 0,

Ah[(un+1,

n+1,

un+1

),

(0,

0,

v)]

+



 h

un+1 - un, v  = 0.

To prove that the iterative algorithm converges we only need to show that if f = 0, un+1, un+1 and n+1 all go to zero as n  .
We add and subtract un+1 in the first equation and add the second to obtain

Ah[(un+1,

n+1,

un+1

),

(v,

,

v)]

+



 h

un+1 - un, v  =

(un+1 - un), nv +  -

 h

((v-

+

v+)

.

Test this equation with un+1, n+1, un+1 and use coercivity to obtain

N -1

1 2



 h

uN

2 L2 ()

+

(

(un+1, n+1, un+1)

2 h

+

1 2



 h

un+1 - un

2 L2

()

)

n=0

N -1



1 2



 h

u0

2 L2 ()

+

(un+1 - un), nun+1 + n+1 -

 h

((un+1)-

+

(un+1)+)

.

n=0

Here we used the well known formula

(4.31)

N -1

N -1

(un+1 - un), un+1



=

1 2

uN

2 L2 ()

-

1 2

u0

2 L2 ()

+

1 2

un+1 - un

2 L2

()

.

n=0

n=0

Considering the terms on the right hand side and using trace inequality (3.15) we see that

(un+1 - un), n(un+1)-





1 4



 h

un+1 - un

2 L2 ()

+

Cmax

-1-1

un+1

2 H

1

(-

)

.

Using

the

duality

pairing

between

H1 2

and

H

-

1 2

followed

by

the

global

inverse

inequality

un+1 -

un

1
H 2 ()



Ct

h-

1 2

un+1 - un

L2() (see [SS11, Theorem 4.4.3]) and Young's inequality we have

(un+1 - un), n+1





1 4



 h

un+1 - un

2 L2 ()

+

Ct-2

-1-1

n+1

. 2

H-

1 2

()

Finally

(un+1

-

un),

 h

((un+1)-

+

(un+1)+)





1 4



 h

un+1 - un

2 L2 ()

+-1

 h

(un+1)+ - un+1

2 L2 ()

+

 h

(un+1)- - un+1

2 L2 ()

+

2

 h

(un+1 - un), un+1  .

Using the once again the telescoping property (4.31) we see that for

 >  -1-1 max Cmax, Ct-2,  + 2,

the right hand sides can all be absorbed in the left hand side to yield

N -1 n=0



(un+1, n+1, un+1)

2 h

+

1 4



 h

un+1 - un

2 L2 ()



1 2

(

-

2)

 h

u0

2 L2

()

.

It follows that as N   un+1, un+1 and n+1 all go to zero, since the sum of the left hand side has to be bounded by the constant of the right hand side.

12

5 Numerical experiments

In our experiment tests we consider  = 1 and Vh × lh × Mhm with j = k = m = 1. The value l varies depending on the geometry of domains considered. We let the trace meshes G1 and G2
coincide with the trace mesh of Th on . For our experiments we use two numerical softwares: FEniCS [ABH+15] and Bempp [SBA+15]. We use the solution of interior and exterior Dirichlet
boundary value problems to construct a Schur complement system solving the following equations

 h

(us

-

u)

+

 h

(um

-

u)

-

(nu

-

)

=

0

on

.

The solution u on  of the Schur complement is obtained using the nested conjugate gradient method (CG) [HS52]. Although one can use direct solvers to solve the interior and exterior Dirichlet boundary value problems, we here use iterative solvers to apply preconditioners. The interior Dirichlet boundary value problem that is a symmetric system associated with bilinear form ah (3.16) is solved by using FEniCS and CG without and with algebraic multigrid preconditioner. The discrete exterior problem associated with bilinear form bh (3.16) is not symmetric, however as we shown in Section 3.1, we can apply the Steklov-Poincar´e operator to the flux variable and transform the equations into a symmetric system. For clarity of the code, we here simply used the generalized minimal residual method (GMRES) [SS86] without or with mass matrix preconditioner to solve in Bempp the external Dirichlet boundary value problem. The tolerance of the iterative solvers is chosen to be not greater the 10-8. A Jupyter notebook demonstrating the functionality used in this paper will be made available at www.bempp.com.

5.1 Choice of parameter 

Thanks to Lemma 8 we know that the stabilisation parameter  in the discrete problem (3.16) must be large enough to assure the coercivity. We start with an experiment showing how the value of the parameter  influences the convergence and number of iterations. We consider - as a unit sphere with boundary . We define

u-(x, y, z) =

1

sin

(x2 + y2 + z2)

+

1

cos

(x2 + y2 + z2)

2 + 1

+

,

2

2

2

u+(x, y, z) =

1 .

x2 + y2 + z2

It is easy to check that for the unit sphere domain - the above elementary functions are the solution of our problem (1.1).
Figure 1 shows the error values for different values of  and j = k = m = l = 1. In this case,  is smooth, and so Wh1 = 1h. In Figure 1a, we plot in log-log scale the error of the interior solution u- - u-h L2(-) and on Figure 1b the error of the exterior solutions u+ - u+h L2() + + - +h L2() for h < 2-1 (solid line with circles), h < 2-2 (dash-dotted line with diamonds), and h < 2-3.5 (dashed line with squares).
It can be seen from the Figures 1 that both errors stop decreasing when  is around 10. Furthermore, for  > 10 the iterations increase with growing  , hence we fix  = 10 for the next experiments.

5.2 Spherical subdomain
Let - once again be the unit sphere,  its boundary and consider the same exact solution as above.
Figure 2 shows the convergence, CG iteration counts and solving time when  = 10 and k = l = 1. In Figure 2a, we plot in log-log scale the error of the interior solution u- - u-h L2(-) (dashed line with circles) and the error of the exterior solutions u+ - u+h L2() + + - +h L2() (solid line with squares).

13

(a) The error of the interior solution. (b) The error of the exterior solution. (c) Iteration taken by CG to solve the preconditioned system.
Figure 1: The dependence of the errors and iteration count on the value of  for h < 2-1 (solid line with circles), h < 2-2 (dash-dotted line with diamonds), and h < 2-3.5 (dashed line with squares) for the problem on the unit sphere subdomain, with j = k = m = l = 1.

(a) Error of the interior (dashed line with circles) and exterior solutions (solid line with squares). The dotted line shows order 2 convergence.

(b) Iteration taken by CG to solve the non-preconditioned system (dashed line), compared with the preconditioned system (solid line)

(c) Time to solve the nonpreconditioned system (dashed line), compared with the preconditioned system (solid line) of the whole discrete problem (3.16) including solving interior and exterior systems.

Figure 2: The convergence (left), CG iteration counts (middle) and solving time (right) for the problem on the unit sphere with  = 10 and j = k = m = l = 1.

In Figure 2b, we plot in log-log scale the number of iterations taken by CG to solve the non-preconditioned system associated with exterior problem (dashed line), compared with the preconditioned system (solid line). In addition, Figure 2c shows the time required by solvers of interior and exterior systems. The interior system is solved by CG with or without algebraic multigrid preconditioner and the exterior system is solved by GMRES with or without mass preconditioner. Preconditioning reduces both the iteration count and the CPU time needed by the solver.
5.3 Cubical subdomain
Let - = (0, 1)3 be a cube and we solve the problem (1.1) with f = 1. We choose  = 10 and j = k = m = l + 1 = 1, where 0h is the space of piece-wise constants per element in the trace space.
Figure 3a shows the convergence when  = 10 and j = k = m = l + 1 = 1. In this case, the

14

(a) Error between interior solution and exterior. The dashed line shows order 2 convergence.

(b) Iteration taken by CG to solve the non-preconditioned system (dashed line), compared with the preconditioned system (solid line)

(c) Time to solve the nonpreconditioned system (dashed line), compared with the preconditioned system (solid line) of the whole discrete problem (3.16) including solving interior and exterior systems.

Figure 3: The convergence (left), CG iteration counts (middle) and solving time (right) for the problem on the cube with  = 10 and j = k = m = l + 1 = 1.

exact solution is not known, thus in Figure 3a, we plot in log-log scale the error between interior

solution and exterior

u- h |-u+ h L2() u+ h L2()

(solid line).

In Figure 3, we plot as well in log-log scale the number of iterations and solving time taken

by CG to solve the non-preconditioned system (dashed line), compared with the preconditioned

system (solid line). Once again preconditioning brings improvement in terms of iteration counts

and time taken to solve the problem.

6 Conclusions
We have analyzed and demonstrated the effectiveness of Nitsche type methods for coupling finite element and boundary element formulations. Our approach gives flexibility to choose a continuous or discontinuous finite element space in the FEM solver, hence the interior problem can be solved essentially using any method that allows for the hybridised Nitsche method for interdomain coupling. We are also free to choose the trace variable minimising the coupling degrees of freedom. In this paper, we focus on the technical aspects and analysis to allow for flexibility within our framework. A work demonstrating the applicability for large problems using parallel approach is in preparation.
The method can be extended to other models such as the Helmholtz equations. In this case it is known [SW11] that the use of impedance interface conditions is advantageous and such an approach can be mimicked in the present framework by letting the stabilisation constant have nonzero imaginary part and depend on the wave number. Formulations of the presented FEM/BEM coupling method to the Helmholtz and Maxwell problems are currently in preparation. For these cases however more effective operator preconditioning techniques for exterior problem are essential, especially for high frequency problems. Despite that, we expect that their implementation will be similar to the presented Laplace case.

References
[ABH+15] M. S. Alnæs, J. Blechta, J. Hake, A. Johansson, B. Kehlet, A. Logg, C. Richardson, J. Ring, M. E. Rognes, and G. N. Wells. The fenics project version 1.5. Archive of

Numerical Software, 3(100), 2015.

[BBS19] T. Betcke, E. Burman, and M. W. Scroggs. Boundary element methods with weakly imposed boundary conditions. SIAM J. Sci. Comput., 41(3):A1357­A1384, 2019.

[BCS96]

U. Brink, C. Carstensen, and E. Stein. Symmetric coupling of boundary elements and Raviart-Thomas-type mixed finite elements in elastostatics. Numer. Math., 75(2):153­ 174, 1996.

[BEH+19] E. Burman, D. Elfverson, P. Hansbo, M. G. Larson, and K. Larsson. Hybridized CutFEM for elliptic interface problems. SIAM J. Sci. Comput., 41(5):A3354­A3380, 2019.

[BHL21] E. Burman, P. Hansbo, and M. G. Larson. CutFEM Based on Extended Finite Element Spaces. arXiv e-prints, page arXiv:2101.10052, January 2021.

[BJ79]

F. Brezzi and C. Johnson. On the coupling of boundary integral and finite element methods. Calcolo, 16(2):189­201, 1979.

[BJN78]

F. Brezzi, C. Johnson, and J.-C. N´ed´elec. On the coupling of boundary integral and finite element methods. In Proceedings of the Fourth Symposium on Basic Problems of Numerical Mathematics (Plzen, 1978), pages 103­114. Charles Univ., Prague, 1978.

[BS08]

S. C. Brenner and L. R. Scott. The mathematical theory of finite element methods, volume 15 of Texts in Applied Mathematics. Springer, New York, third edition, 2008.

[CF00]

C. Carstensen and S. A. Funken. Coupling of mixed finite elements and boundary elements. IMA J. Numer. Anal., 20(3):461­480, 2000.

[CGL09]

B. Cockburn, J. Gopalakrishnan, and R. Lazarov. Unified hybridization of discontinuous Galerkin, mixed, and continuous Galerkin methods for second order elliptic problems. SIAM J. Numer. Anal., 47(2):1319­1365, 2009.

[CGS12]

B. Cockburn, J. Guzm´an, and F.-J. Sayas. Coupling of Raviart-Thomas and hybridizable discontinuous Galerkin methods with BEM. SIAM J. Numer. Anal., 50(5):2778­ 2801, 2012.

[CH12]

F. Chouly and N. Heuer. A Nitsche-based domain decomposition method for hypersingular integral equations. Numer. Math., 121(4):705­729, 2012.

[Cos87]

M. Costabel. Symmetric methods for the coupling of finite elements and boundary elements (invited contribution). In Boundary elements IX, Vol. 1 (Stuttgart, 1987), pages 411­420. Comput. Mech., Southampton, 1987.

[CS12]

B. Cockburn and F.-J. Sayas. The devising of symmetric couplings of boundary element and discontinuous Galerkin methods. IMA J. Numer. Anal., 32(3):765­794, 2012.

[DPE12]

D. A. Di Pietro and A. Ern. Mathematical aspects of discontinuous Galerkin methods, volume 69 of Math´ematiques & Applications (Berlin) [Mathematics & Applications]. Springer, Heidelberg, 2012.

[DPEL14] D. A. Di Pietro, A. Ern, and S. Lemaire. An arbitrary-order and compact-stencil discretization of diffusion on general meshes based on local reconstruction operators. Comput. Methods Appl. Math., 14(4):461­472, 2014.

[EG04]

A. Ern and J. L. Guermond. Theory and practice of finite elements, volume 159 of Applied Mathematical Sciences. Springer-Verlag, New York, 2004.

16

[Egg09]

H. Egger. A class of hybrid mortar finite element methods for interface problems with non-matching meshes, 2009.

[ES10]

H. Egger and J. Sch¨oberl. A hybrid mixed discontinuous Galerkin finite-element method for convection-diffusion problems. IMA J. Numer. Anal., 30(4):1206­1234, 2010.

[GHH09]

G. N. Gatica, M. Healey, and N. Heuer. The boundary element method with Lagrangian multipliers. Numer. Methods Partial Differential Equations, 25(6):1303­ 1319, 2009.

[GHS10] G. N. Gatica, N. Heuer, and F.-J. Sayas. A direct coupling of local discontinuous Galerkin and boundary element methods. Math. Comp., 79(271):1369­1394, 2010.

[GS06]

G. N. Gatica and F.-J. Sayas. An a priori error analysis for the coupling of local discontinuous Galerkin and boundary element methods. Math. Comp., 75(256):1675­ 1696, 2006.

[Han90] H. D. Han. A new class of variational formulations for the coupling of finite and boundary element methods. J. Comput. Math., 8(3):223­232, 1990.

[HS52]

M. R. Hestenes and E. Stiefel. Methods of conjugate gradients for solving linear systems. J. Research Nat. Bur. Standards, 49:409­436 (1953), 1952.

[JN80]

C. Johnson and J.-C. N´ed´elec. On the coupling of boundary integral and finite element methods. Math. Comp., 35(152):1063­1079, 1980.

[LS05]

U. Langer and O. Steinbach. Coupled boundary and finite element tearing and interconnecting methods. In Domain decomposition methods in science and engineering, volume 40 of Lect. Notes Comput. Sci. Eng., pages 83­97. Springer, Berlin, 2005.

[MVMP96] S. Meddahi, J. Vald´es, O. Men´endez, and P. P´erez. On the coupling of boundary integral and mixed finite element methods. J. Comput. Appl. Math., 69(1):113­124, 1996.

[Nit71]

J. Nitsche. U¨ ber ein Variationsprinzip zur L¨osung von Dirichlet-Problemen bei Verwendung von Teilr¨aumen, die keinen Randbedingungen unterworfen sind. Abh. Math. Sem. Univ. Hamburg, 36:9­15, 1971.

[ORST12] G. Of, G. J. Rodin, O. Steinbach, and M. Taus. Coupling of discontinuous Galerkin finite element and boundary element methods. SIAM J. Sci. Comput., 34(3):A1659­ A1677, 2012.

[Say09]

F.-J. Sayas. The validity of Johnson-N´ed´elec's BEM-FEM coupling on polygonal interfaces. SIAM J. Numer. Anal., 47(5):3451­3463, 2009.

[SBA+15] W. S´migaj, T. Betcke, S. Arridge, J. Phillips, and M. Schweiger. Solving boundary integral problems with BEM++. ACM Transactions on Mathematical Software, 41(2):6:1­6:40, 2015.

[SS86]

Y. Saad and M. H. Schultz. GMRES: a generalized minimal residual algorithm for solving nonsymmetric linear systems. SIAM J. Sci. Statist. Comput., 7(3):856­869, 1986.

[SS11]

S. A. Sauter and C. Schwab. Boundary element methods, volume 39 of Springer Series in Computational Mathematics. Springer-Verlag, Berlin, 2011. Translated and expanded from the 2004 German original.

17

[Ste08] [Ste11] [SW11] [Wen86] [ZKB77]

O. Steinbach. Numerical approximation methods for elliptic boundary value problems. Springer, New York, 2008. Finite and boundary elements, Translated from the 2003 German original.
O. Steinbach. A note on the stable one-equation coupling of finite and boundary elements. SIAM J. Numer. Anal., 49(4):1521­1531, 2011.
O. Steinbach and M. Windisch. Stable boundary element domain decomposition methods for the Helmholtz equation. Numer. Math., 118(1):171­195, 2011.
W. L. Wendland. On asymptotic error estimates for the combined boundary and finite element method. In Innovative numerical methods in engineering (Atlanta, Ga., 1986), pages 55­69. Comput. Mech., Southampton, 1986.
O. C. Zienkiewicz, D. W. Kelly, and P. Bettess. The coupling of the finite element method and boundary solution procedures. Internat. J. Numer. Methods Engrg., 11(2):355­375, 1977.

18

