Visual Analysis of Electronic Densities and Transitions in Molecules

arXiv:2106.01215v1 [cs.HC] 2 Jun 2021

Talha Bin Masood  1 , Signe Sidwall Thygesen 1 , Mathieu Linares 1,2 , Alexei I. Abrikosov 1 , Vijay Natarajan  3 , and Ingrid Hotz 1
1Department of Science and Technology (ITN), Linköping University, Norrköping, Sweden 2Laboratory of Organic Electronics, Linköping University, Norrköping, Sweden 3Indian Institute of Science, Bangalore, India
Abstract The study of electronic transitions within a molecule connected to the absorption or emission of light is a common task in the process of the design of new materials. The transitions are complex quantum mechanical processes and a detailed analysis requires a breakdown of these processes into components that can be interpreted via characteristic chemical properties. We approach these tasks by providing a detailed analysis of the electron density field. This entails methods to quantify and visualize electron localization and transfer from molecular subgroups combining spatial and abstract representations. The core of our method uses geometric segmentation of the electronic density field coupled with a graph-theoretic formulation of charge transfer between molecular subgroups. The design of the methods has been guided by the goal of providing a generic and objective analysis following fundamental concepts. We illustrate the proposed approach using several case studies involving the study of electronic transitions in different molecular systems. CCS Concepts · Human-centered computing  Scientific visualization; Visualization techniques; · Applied computing  Chemistry; Physics;

1. Introduction
Molecular spectroscopy, dealing with the absorption or emission of light, plays an important role in material and biochemical applications. Its study is a common task when analyzing the chemical and physical properties of organic materials with a wide variety of technical applications, e.g., the design of new materials for organic solar cells. Absorption and emission of light are related to electronic transitions, which involve the promotion of electrons from one state to another by absorbing or emitting photons [KKPR19]. The complex quantum mechanical process behind these transitions can be numerically calculated using modern quantum chemistry methods such as Density Functional Theory (DFT).
Visualization has traditionally played an important role in analyzing the resulting electron density fields [SHS11]. Statistical plots and energy diagrams are typically used, but spatial representations of the density field of a specific electronic state of the molecule are also studied. The spatial electron density distribution is often visualized using isosurfaces. An isovalue that `best' depicts the system is manually chosen. This approach requires detailed knowledge about the molecule and localization of the elec-
 {talha.bin.masood | signe.sidwall.thygesen | mathieu.linares | alexei.abrikossov | ingrid.hotz}@liu.se  vijayn@iisc.ac.in

trons [HG08]. As one can imagine, this approach can be cumbersome, time-consuming, and lacks any quantifiable information, thereby making comparisons across different molecules often difficult and sometimes impossible. A tool to quickly identify the character of each excitation and to facilitate the analysis of a series of molecules is missing.
In this work, we propose an approach that automates the quantification and visualization of key measures for electron localization and transfer from molecular subgroups. From a data point of view, this is a scalar field analysis and visualization problem. The design of our visual analysis framework is guided by the goal to develop a generic and efficient pipeline (Fig. 2) that builds on fundamental concepts to generate effective and easy to interpret visualizations. More specifically, this includes (i) designing a simple yet powerful partitioning algorithm that is chemically plausible, efficiently computable, and easy to communicate, (ii) quantifying the field transition by solving a constrained optimization problem respecting simple rules, and (iii) providing a visualization that is easy to understand and capable of encoding the characteristics of the nature of the electronic transition.
Our contributions can be summarized as:
· Formulation of the charge transition problem as a general partitioning and constraint optimization problem.
· Introduction of a new automated method for quantitative anal-

2

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

ysis and comparison of charge distributions and transitions in molecular excitations. · Design and development of a framework for the visual analysis of electronic transitions in a series of molecules. · Demonstration of the utility and significance of the framework via four case studies on molecules and metal complexes.
The paper is structured as follows. In Sec. 2, we summarize required background in chemistry for the application. Sec. 3 summarizes the relevant related work. The visualization task and analysis problem are formalized in Sec. 4. Sec. 5 describes in detail the methods of our proposed solution. We present four case studies with increasing complexity in Sec. 6. A discussion of the proposed framework considering user participation in the visualization design, robustness, and efficiency of the method is provided in Sec. 7 before we conclude in Sec. 8.
2. Electronic densities and transitions
Atoms are composed of nuclei and electrons, with the latter occupying most of the space. The occupied space can be interpreted as an electronic cloud or a standing wave called orbital regions with the highest probability to find electrons. Within each atom, there is a series of available orbitals with specific energy levels, each orbital hosting a maximum of two electrons. In a molecule, the location of electrons is determined by the molecule as a whole, and molecular orbitals are formed by a linear combination of atomic orbitals [Mul32]. Thereby the electrons from the constituent atoms of the molecules fill the molecular orbitals starting from the lowest energy up to the Highest Occupied Molecular Orbital (HOMO) with two electrons per molecular orbital. The remaining orbitals are named Unoccupied orbitals with their lowest called the Lowest Unoccupied Molecular Orbital (LUMO). Molecular Orbitals are used not only to study the electron localization in a molecule but also to calculate chemical and physical properties such as the probability of finding an electron in any specific region or to calculate electronic transitions involved in the interaction between the molecule and light. When a molecule absorbs a photon, electrons are excited from the occupied orbitals to unoccupied orbitals.
Mathematically, molecular orbitals are an approximate solution to the Schrödinger equation for the electrons in the field of the molecule's atomic nuclei. They can be calculated using modern quantum chemistry methods such as Density Functional Theory (DFT), e.g., implemented in the program Gaussian [FTS16]. Using the Time-Dependent formalism of DFT (TD-DFT) it is possible to study the electronic transitions within a molecule. The result of such a calculation is excitation energy and a set of coefficients describing the contribution of each orbital to the excited state. An electron promoted from an occupied level will be named a hole on the remaining orbital and will be promoted to a virtual level (particle). To understand electronic transitions it is not sufficient to look at the individual orbitals but the linear combination of molecular orbitals involved in the electronic transition. Therefore, a more compact orbital representation, named Natural Transition Orbital (NTO) has been proposed to describe what has been excited (the hole NTO) and to where it has been excited (the particle NTO) [Mar03].
The output data of these calculations are scalar values given on

a regular grid in a so-called `cube' file. A typical analysis task is to identify the nature of the electronic transition. If both the NTO of the particle and hole are located on the same part of the molecule, one speaks of a Local Excitation (LE). In contrast, if the NTO of the particle and hole are located on different parts of the molecule, one speaks of a Charge Transfer excitation (CT). This task is generally approached by displaying an isosurface of the resulting scalar fields, Fig. 1 (d,f). This is a purely qualitative analysis and there is a need to quantify the character of LE and CT between each relevant part of the molecule. Moreover, a tool to identify quickly the character of each excitation is missing and would be really useful to facilitate the analysis of a series of molecules.
3. Related work
Atoms in molecules. Atoms in molecules is a model assuming that the molecular structure can be analyzed using atoms and bonds as constitutive elements. The hypothesis is that some characteristic physical properties can be determined on a per-atom basis. In this context, the question of how to assign charges to the individual atoms in a molecule is still actively discussed in chemistry with a variety of methods being proposed. Since this segmentation is not a physically observable property but rather a concept supporting the reasoning over molecules, there is no ground truth and the methods have to be validated by their usefulness in a given context. The methods can be classified into two groups ­ wave-function based partitioning in Hilbert space, e.g., Mulliken's Population analysis [Mul55], and 3D space partitioning using an appropriate descriptor, e.g., the electron density distribution of the molecule. The electron density distribution is a scalar field, that can be interpreted as the probability of observing the amount of electrons in a specific volume. Often the second group is preferred since the results do not depend on the chosen basis functions for the molecular modeling [HZAV18]. This second group of methods can be further classified into methods based on direct space partitioning and fuzzy methods following a fractional charge assignment [HZAV18]. In the case of space partitioning methods, in a second step, the charge density is integrated over pre-determined atomic regions, an area associated with the atom [PLEP70]. This approach boils down to the question of how to partition the molecule into atomic regions. For linear molecules, Politzer [PLEP70] proposed segmentation of the space using separating planes orthogonal to the molecular axis. This approach has later been generalized to non-linear atoms using a Voronoi partitioning [GHBB04]. While these approaches are purely geometric, a topological field-based segmentation has been proposed by Bader [Bad90]. A fuzzy approach is followed by Hirshfeld [Hir77], who proposes to share the electronic density at each point among all atoms in relation to their atomic contribution of its spherically averaged ground-state density.
Ground and excited state comparison. A frequent task is the comparison and characterization of the chemical nature of the electronic ground and excited states. In this context, the comparison of electron charge distributions plays an important role. For this purpose, a set of indexes serving as a descriptor for the charge transfer (CT) have been designed. These indexes are mostly based on a pointwise difference density field which is partitioned in positive and negative regions. The first indexes introduced by Ciofini et

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

3

CPK colors

THIO

QUIN

Min

Max

-v

v

Min

Max

-v

v

(a) Atom positions (b) Two subgroups

(c) Hole NTO h (d) Isosurfaces in h (e) Particle NTO p (f) Isosurfaces in p

Figure 1: Direct visualization of the output data from DFT simulations of a Thiophene-Quinoxaline molecule for the first excited state. This data as well as some domain knowledge about potential subgroups serve as input for the automatic analysis and visualization pipeline, Fig. 2.

al. [GAC10, BAC11] describe CT distance, amount of transferred charge, and the variation of the dipole moment. Later this set has been extended by an index that can be interpreted in terms of holeelectron distance [GCMA13, HPMM20]. Some of these indexes are also implemented into standard quantum chemical codes, such as Gaussian [FTS16]. An alternative approach has been proposed by Romouts et al. [REL17] who compare the segmented partial charges associated with the individual atoms. They propose to use atom-centered Voronoi cells for the partitioning. In contrast to the analysis of the difference-volume, this approach has the advantage that it is not sensitive to changes in the geometric configuration of the atomic positions. Our approach is closely related to this idea.
Typical visualization methods used in the domain. Visualization plays an important role in most of the above-mentioned studies. The most dominant visualizations are statistical plots and energy diagrams. Also, spatial representations are omnipresent. The typically used methods can be summarized as a combination of schematic molecular representations and isosurface plots. VMD, a widely used visualization tool for biomolecular systems, even provides hardware support for efficient orbital surface rendering [SSH09, SHS11]. Isosurfaces, however, can be misleading when the isovalue is not carefully selected and adapted to the orbital energies. To overcome this limitation, Haranczyk et al. [HG08] propose to visualize orbitals or electron densities in a more consistent way using a pre-selected fraction of the total charge to determine an orbital-specific isovalue. A direct visualization of the complex-valued molecular orbitals has been proposed by Al-Saadon et al. [ASSK19]. The schematic molecular representations including ball-and-sticks or van der Waals surface representations [KKL15] provide an overview of the molecular structures. Electron density isosurface plots provide a view of the density distributions. Side-by-side visualization is used for the comparison of ground and excited states. Besides, electron density difference isosurface plots give a more direct impression of the differences in the charge densities. In a few papers, these representations are overlaid with arrows representing the charge transition [JBAC12]. Sometimes, color plots on a slice using a divergent color map can be seen to give a more complete overview of the molecular electrostatic potential [LWX20]. While such plots give a good first qualitative impression about the charge transfer the pictures are not suitable for quantitative analysis. The chosen isovalue is a critical parameter in all these visualizations.

Volume segmentation for visualization. Segmentation of scalar fields is a prevalent topic in visualization. Also, the segmentation of the electron density field has been explored to provide insight into the properties of molecules and materials. Existing methods can be categorized as geometric and topological methods with two different goals. The first task is to assign charges to atoms in molecules and it requires high geometric accuracy. For this purpose, a numerical algorithm to divide the space into regions separated by zero flux surfaces has been presented by Henkelman [HAJ06]. It closely follows the theory introduced by Bader [Bad90]. The geometric accuracy of combinatorial approaches is often not sufficient for this purpose. However, there are a few approaches that try to overcome this limitation. Stochastic methods [RGH12,GBP12] did not provide guarantees but resulted in empirically convergent solutions. Facilitating a pre-segmentation, Gyulassy et al. [GGL14] introduced a conforming Morse-Smale complex achieving much better geometric embeddings. Specifically, for the computation of atomic volumes, Bhatia et al. [BGL18] introduced a computational tool, TopoMS, which combines numerical integration with concepts from computational topology and provides an accurate segmentation while still guaranteeing topological consistency. The second goal of topological segmentation is the analysis of atomic bonds where geometric accuracy is secondary. However, a robust extraction of the topological skeleton is essential. In this context, methods from computational topology are very successful [GBCG14]. For the analysis of ion diffusion in battery materials, a geometric segmentation of carbon nanospheres, inspired by the Delaunay triangulation, was proposed by Gyulassy et al. [GKLW16]. Segmentation based on the Voronoi diagram and its dual Delaunay triangulation has also been extensively studied in the context of macromolecules and used to measure their geometric properties such as volume and surface area [LEF98, PKKO07].
Bipartite graph visualization. A common approach to visualize bipartite graphs, which consist of two disjoint sets of nodes, is to represent the two node sets as parallel lines and to draw edges between pairs of nodes that are connected by an edge. For weighted graphs, a frequently used representation is the Sankey diagram encoding the weights or magnitude of the flow in the width of the connecting arrows. It was developed over 100 years ago for material flow analysis [Sch08] and is now used in many applications [BT20]. They are especially useful for simple graphs with a limited number of nodes and edges. Some variants can also cope with more complex scenarios including interactive ex-

4

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

Figure 2: Overview of the method. The first step is to segment the volume and calculate the charge for atoms and subgroups, both for hole and particle Natural Transition Orbitals (NTO), described in Sec. 5.1. Then we set up the constraint optimization problem to calculate the charge transfer between subgroups (Sec. 5.2). The charge results are visualized, both at atomic and subgroup level, this is described in Sec. 5.3.

ploration [RHF05]. The chord diagram is another visual representation targeting similar data. Here, the nodes are arranged along a circle and connected by arcs scaled according to the ratio of the outand in-flow of the respective nodes. Such diagrams have been used in many applications including charge flow networks [KFM19]. Considering weighted bipartite graphs as a special case of more general flow graphs or transition matrices, all related graph drawing methods are principally applicable [NMSL19]. There are also methods that focus on the visualization of large scale bipartite graphs with tens of thousands of nodes and edges [CXDR18] which goes far beyond our needs.
4. Problem specification and definition
In the following, we translate the computational chemists' requirements described above in Sec. 2 into a data-analysis and visualization problem. We start with specifying the visualization tasks and then give a precise mathematical formulation of the related data analysis problem.
4.1. Visualization and analysis tasks
We identified two data analysis tasks (A1 and A2) and three visualization tasks (V1, V2, and V3) specified below:
A1 Parameter-free quantification of charges associated to atoms. A2 Parameter-free quantification of electronic charge transfer be-
tween the hole and particle NTO at the chemical subgroup level. V1 Visualization of the hole and particle charge distribution. V2 Visualization of charge differences at atoms to emphasize the
loss or gain of electronic charge during the electronic transition. V3 Visualization of the charge transfer emphasizing the nature of
the electronic transition as Local Excitation (LE) or Charge Transfer excitation (CT).
The two analysis task relate to quantification of charge and the charge transfer using methods which do not require any dataspecific user-defined parameters. We decided to take a parameterfree approach to facilitate easy integration of these methods in automated analysis pipelines for processing a large set of molecules. The three visualization tasks are aimed at discerning the nature of

the electronic transition through visual analysis both at the chemical subgroup and atomic level of detail.

4.2. Formal problem specification
The basis for all the visualization tasks is an objective quantification of diverse charge contributions and transitions which should follow clear rules. The data is a set of scalar fields from TD-DFT calculations and the input configuration of the molecules constituted of atoms and atomic groups. The problems to solve are fundamentally partitioning and transfer computation tasks.

Input. We are given the following information:
· A set of atoms A = {a1, a2, . . . , aN } where each atom ai is a sphere centered at pi = (xi, yi, zi)  R3 with radius ri, e.g., the van der Waals radius.
· Partitioning of the atoms into M subgroups, S = {s1, s2, . . . , sM}, where s j  A, sjS = A and si  s j =  for i = j.
· Natural Transition Orbital (NTO) for the hole h : R3  R and the particle p : R3  R.
· In practice the scalar fields h and p are provided as sampled over a 3D grid G of size nx × ny × nz corresponding to a subset D  R3. The grid G consists of voxels of uniform size.

Problem. Given this, the problem can be specified as follows:

· Determine the hole charge qhi for each atom ai such that the total

·

hole

charge

N
i=1

qhi

=

D ||h||2.

Similarly, determine the particle charge

qip

for

each

atom

ai

such

that

the

total

particle

charge

N
i=1

qip

=

D ||p||2.

· Also, determine the hole charge Qhj for each subgroup s j and the

corresponding particle charge Qpj .

· Determine the amount of charge transfer Q~ jk between all pairs

of subgroups s j and sk according to a few given constraints.

5. Method
An overview of our visual analysis pipeline is presented in Fig. 2. The individual steps are described in the following sections.

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

5

(a)

(b)

(c)

(d)

(e)

Figure 3: Voronoi segmentation for Thiophene-Quinoxaline. (a) Ball and stick representation. (b) The weighted Voronoi segmentation.

Voronoi segments are clipped by a sphere of radius twice the van der Waals radius for better display. (c) The combined segments for the two

subgroups (THIO

QUIN). The regions associated to the subgroups are the union of the atomic Voronoi cells. A slice showing the Voronoi

segmentation is shown along with isocontours and isosurfaces for the hole NTO h (d) and the particle NTO p (e).

5.1. Segmentation and charge computation (Task A1)
To compute the charge of an atom we partition the volume D into regions, each belonging to one atom. The charge of an atom is then calculated as the charge within the region based on the charge density derived from the NTO, both for particle (p) and hole (h).
Segmentation of the volume. We find a partition of the volume D into non-overlapping regions V = {V1, . . . , VN } such that Vi  D and ViV = D. To solve this segmentation problem we considered both topological and geometrical segmentation methods. We investigated the Morse-Smale complex and the weighted Voronoi segmentation and concluded that the resulting subgroup charges were very similar for these two segmentation algorithms, refer to the appendix for a detailed comparison. Since we are mainly interested in the subgroup charge and also the fact that we want an efficient and fast method, our choice was the weighted Voronoi due to its simplicity. Chemists are also familiar with this segmentation approach thus making it easier to communicate to domain experts.
Voronoi segmentation. Given N seed points, the Voronoi diagram divides the space into N regions, each region consisting of the points in space closest to one particular seed point [Aur91]. A more general version is the weighted Voronoi diagram where each seed point has a weight. This weighted version is called a power diagram when using the power distance to measure the distance between a point x and seed point pi with weight ri: pd(x, pi) = ||x - pi||2 - ri2 [Aur87]. It partitions a volume D such that the region belonging to atom ai at position pi and radius ri can be described as
Vi = {x  D such that pd(x, pi) < pd(x, p j) j = i} (1)
This segmentation algorithm only considers the atom positions and their radii together with the volume dimensions and is not dependent on the scalar field values. This means that we do not need to recalculate the segmentation for the different scalar fields h and p for the same molecule. An example of a weighted Voronoi segmentation of the volume is shown in Fig. 3.
We implement the weighted Voronoi algorithm in the discrete setting. In parallel, for each point in the volume grid G, we compare the power distances to all the atom positions and pick the one giving

the minimum value. The result will be a volume, where each voxel is labeled with the index of the closest atom.

Charge computation in each region. The charge density in a point x is calculated by taking the square of the Natural Transition Orbital value in that point

(x) = ||(x)||2

(2)

Given the set of N regions V = {V1, V2, . . . , VN } partitioning our volume D  R3, and the Natural Transition Orbitals h and p sampled over D we want to calculate the sum of all charge densities for each region, the charge for each atom, for both h and p.

We obtain this by using Eqn. 2 for each point in Vi and integrating over all points in that region. This integral can be approximated by adding the charge over all voxels vk  VGi where VGi  G is the discrete representation of Vi in G. Let the volume of a voxel in G be vol, then the charge qhi can be computed as:

qhi = (x)dx vol  ||h(vk)||2

(3)

Vi

vk VGi

Similarly, the particle charge qip for all the atoms is also computed. The charge for each subgroup is the accumulated value for all atoms

within the subgroup

 Qhj =

qhi ,

 Qpj =

qip

(4)

ais j

ais j

5.2. Charge transfer (Task A2)
To study the charge transfer at the level of subgroups, it would be beneficial to quantify the charge transfer between two subgroups. However, there is no unique solution for this problem as the system of equations is underdetermined. We describe this in the following subsections and propose some solutions for the charge transfer problem under reasonable assumptions.
Problem specification. The charge transfer problem requires determination of the charge transfer Q~i j from a subgroup si to another subgroup s j under two constraints: (1) the total charge transfer from a subgroup si should be equal to the hole charge Qhi of the subgroup, and (2) the total charge transfer to a subgroup s j should be equal to

6

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

Considering equations 7 to 10, we can remove all the diagonal elements from Q~ M×M and the non-diagonal elements which are 0 to obtain a smaller matrix Tn×m with n rows corresponding to the donors and m columns corresponding to the acceptors. The matrix
T represents weights of the edges in a complete bipartite graph with
directed edges from the set D to A. See Fig. 4 for an example. ti j denotes the charge transfer between donor di and acceptor a j. The charge transfer for all donor-acceptor pairs is represented as

Figure 4: The general charge transfer problem for four subgroups (left) and a simpler formulation (right).

the

particle

charge

Q

p j

of

the

subgroup.

This

problem

can

be

written

in matrix form as follows.

 Q~ 11 . . . Q~ 1M 

Determine

Q~ M×M

= 

...

...

...

 

(5)

Q~ M1 . . . Q~ MM

M

M

Such that

 Q~i j = Qhi and

 Q~i j

=

Q

p j

(6)

j=1

i=1

The matrix Q~ M×M can be interpreted as a weighted complete directed graph. The subgroups S correspond to the vertex set and the matrix elements correspond to the edge weights. See Fig. 4 (left) for an example with four subgroups.

A simpler problem. A sub-group si is called a donor if Qhi > Qip. Otherwise, it is called an acceptor. We define the charge difference for si as Qdi = Qip - Qhi . Clearly the set S can be partitioned into two subsets, one consisting of donors D = {d1, d2, . . . , dn} and the other consisting of acceptors A = {a1, a2, . . . , am}. Here, n = |D| is the number of donors and m = |A| is the number of acceptors such
that n + m = M. Let ID : {1, . . . , n}  {1, . . . , M} be the index map that maps a donor di, i  {1, . . . , n} to the corresponding subgroup s j, j  {1, . . . , M}. Similarly, let IA : {1, . . . , m}  {1, . . . , M} be the index map mapping the acceptors to the corresponding sub-
group s j in the original list of subgroups S.

Now, we make the assumption that there is no charge transfer from an acceptor to any other subgroup, and no charge transfer from a donor to other donors. This implies for all i = j  {1, . . . , M}

Q~i j = 0 if si  A,

(7)

and Q~i j = 0 if si, s j  D.

(8)

This assumption, along with the two constraints in 6, lead to the following assignment of values to the diagonal of the matrix Q~ :

Q~ ii = Qhi if si  A,

(9)

and Q~ ii = Qip if si  D.

(10)

t11 . . . t1m

Tn×m

= 

...

...

...

 

tn1 . . . tnm

The index maps ID and IA provide the element corresponding to ti j  Tn×m within the matrix Q~ N×N as ti j = Q~ ID(i)IA( j). We use the notation Qdi to mean QID(i) and Qaj to mean QIA( j)

The total charge transfer from a donor di to acceptors should be equal to the charge deficit at di. So, for all di  D,

m

 ti j = Qhdi - Qdpi = -Qddi

(11)

j=1

The above set of equations gives us n row-sum constraints. Simi-
larly, total charge transfer to an acceptor aj from all donors should be equal to the charge excess at aj. So, for all aj  A:

n

 ti j = Qapj - Qhaj = Qdaj

(12)

i=1

This provides the additional m column-sum constraints. The constraints 11 and 12 follow directly from 6 respectively. The goal is to determine matrix T under these two constraints 11 and 12. Additionally, we have the non-negativity constraints,

ti j  0

(13)

In total, we have n + m equations, of which n + m - 1 are linearly independent. However, we have n × m unknowns. A unique solution exists only in the scenario when there is only one donor or in the case when there is only one acceptor.

Proportional charge division approach. One way to arrive at a
solution for the charge transfer problem would be to assume ti j to be directly proportional to the charge differences at the donor di and the acceptor aj. That is, ti j  Qdaj × Qddi . With this assumption and the constraints 11 and 12, we arrive at a unique solution for ti j which we refer to as proportional solution:

ti j = -Qdaj × Qddi /Q~ ,

(14)

where Q~ is the total charge transfer:

nm

n

m

Q~ =   ti j =  -Qddi =  Qdaj

(15)

i=1 j=1

i=1

j=1

It is easy to observe that such a solution satisfies the nonnegativity constraint (13). Further, we show that it also satisfies the

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

7

row sum constraint (11) and column sum constraint (12):

  m
ti j
j=1

=

m j=1

-Qdaj × Qddi Q~

  n
ti j
i=1

=

n i=1

-Qdaj × Q~

Qddi

 =

-Qddi Q~

m
Qdaj
j=1

=

-Qddi Q~

· Q~ = -Qddi

 =

Qdaj Q~

n
-Qddi
i=1

=

Qdaj Q~

· Q~

=

Qdaj

Quadratic optimization approach. We now discuss a general approach that provides the flexibility of determining an optimal solution under different assumptions and criteria. The matrix Tn×m can be represented as a column vector t having n × m components by sequencing the terms ti j in row major order. Constraints in 11 and 12 can be combined as an equality constraint

Bt = b,

(16)

where B is an (n + m - 1) × (n × m) matrix containing the
binary coefficients of n + m - 1 linearly independent con-
straints as the rows. The n row constraints are specified first
followed by the m - 1 column constraints. The vector b = [-Qdd1 , . . . , -Qddn , Qda1 , . . . , Qdam-1 ]T corresponds to the value for these constraints. Secondly, we have the non-negativity constraint
as specified in 13 that is converted into the inequality constraint:

t0

(17)

Let us consider the simple case of two donors and two acceptors to understand this conversion to vectors. The matrix T is:

T2×2 =

t11 t21

t12 t22

The four constraints are:

t11 + t12 = -Qdd1 t11 + t21 = Qda1

t21 + t22 = -Qdd2 t12 + t22 = Qda2

We can ignore one of the above constraints resulting in a set of linearly independent constraints. Let us assume we ignore the last equation. Then vectors t = [t11,t12,t21,t22]T and b = [-Qdd1 , -Qdd2 , Qda1 ]T while the constraint matrix B is:
1 1 0 0 B = 0 0 1 1
1010

It is reasonable to assume that there is a uniform transfer of
charge from any donor to any acceptor without any preference. Under this assumption the preferred transfer vector would be tp = [Q~/(n × m), . . . , Q~/(n × m)] where Q~ is as defined in 15. However, tp may not satisfy the constraints in Equation 16. In this case, we can set up an optimization problem to find the optimal to which is closest to tp but satisfies the constraints 16 and 17. More formally, we can write this as the following optimization problem:

Minimize ||t - tp||2

(18)

subject to t  0 and Bt = b

We recognize this as a quadratic optimization problem that can be solved to obtain an optimal solution to which we refer to as

quadratic solution. Note that tp does not have to be a uniform vector, it can have different weights and allows the possibility of computing optimal to under different scenarios.
5.3. Visualization
We use various spatial and information visualization methods to facilitate detailed visual analysis of electronic transitions. We describe these methods in brief in the following paragraphs. The implementation was primarily done in Python using VTK [SLM04]. We also used Inviwo [JSS19] and Paraview [AGL05] for prototyping and generating some higher quality images.
Spatial visualization (Task V1, V2). We employ standard scalar field visualization techniques like volume rendering, slicing and isosurface extraction for visualization of the orbitals h, p and the derived density fields h = ||h||2 and p = ||p||2. For direct volume rendering of scalar field h and p, we employ a diverging blue to red color map with a V-shaped transfer function for opacity so that the voxels with extreme positive and negative values are emphasized, see Fig. 1 (c,e). Two isosurfaces represent the orbitals h and p, for a given value v, one for value v and the other for -v. They are displayed together colored orange and blue respectively, see the first two columns of Fig. 5. For visualization of the fields h and p, we use a linear color map and opacity transfer functions.
The molecules are shown embedded in the same volume represented either as ball-and-stick or the space-fill model with the radii scaled proportionally to their van der Waals radii. We use color mapping on the balls representing the atoms to show various scalar quantities like hole charge qh, particle charge qp and charge difference qd defined as qp - qh. In case of charge difference, we use a red-to-blue diverging color map highlighting the donor atoms in shades of red and acceptor atoms in shades of blue, see the qd column of Fig. 5. For qh and qp, a linear white-to-blue color map is used, refer to the qh and qp columns in Fig. 5. Additionally, we support the coloring of atoms based on atomic type using the CoreyPauling-Koltun (CPK) color model. Lastly, color mapping to highlight the different subgroups is also supported, see Fig. 1(a, b).
Within this 3D spatial visualization, we also support the visualization of the Voronoi segments corresponding to the atoms or the combined Voronoi segments corresponding to the subgroups, see Fig. 3. We do not use direct volume rendering for such a visualization as it suffers from occlusion and discretization artifacts. Instead, we extract the bounding surface of each segment separately and smoothen the surface using a standard Gaussian filter. Further, the segment for atom ai is clipped by a ball of radius 2ri.
2D visualization (Task V3). To further support visual analysis, especially at the subgroup level, we utilize standard information visualization methods. The charges Qh and Qp on various subgroups are plotted as bar charts. To visualize the charge transfer we use a transition diagram. It is a variant of parallel set visualization [KBH06] and Sankey diagram [Sch08] which we have modified for this particular application, last column of the Fig. 5. At the bottom of the transition diagram, a bar of width proportional to the hole charge Qh is displayed for each subgroup in the molecule. At the top, the width of the bars is proportional to the particle charge Qp. In the

8

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

h: -v

v p: -v

v qh:

qp:

qd :

Transition

State 4

State 9

Figure 5: Two different state transitions in the Thiophene-Quinoxaline molecule. Top row: charge transfer transition. Bottom row: local excitation. Cols. 1 and 2 relate to visualization task V1, cols. 3-5 to the task V2, and the col. 6 to the task V3.

middle, connectors are drawn such that their width is proportional to the charge transfer Q~i j. The colors of the bars are based on the subgroups and can be chosen by the user. Brushing and linking is supported between the 3D spatial view and the 2D visualizations.
6. Results
The data for the case studies is calculated using the Gaussian software package [FTS16]. The cube files for individual molecular orbitals were generated using the included gencube program. The particle and hole NTOs were generated based on the set of coefficients describing the contribution that each particle-hole pair makes to the excited state.
6.1. Case study 1: Thiophene-Quinoxaline
As a first simple example, we study the thiophene-quinoxaline molecule which is composed of two subgroups as shown in Figure 1(b). Polythiophene polymer has been widely used in the field of organic electronics and in particular in organic field-effect transistors and organic solar cells because of its high conductivity. Thiophene and quinoxaline have very different properties since they are an acceptor and a donor of electrons, respectively. These properties provoke a charge transfer from the thiophene to the quinoxaline moieties making this a perfect model system to test our analysis and visualization pipeline. As can be seen in Fig. 5, the 4th and 9th excited states have very different properties. For excited state 4, the hole is localized on the thiophene moiety and the particle on the quinoxaline moiety. However, for the excited state 9, the hole is more delocalized over the whole molecule. This difference can be observed qualitatively by looking at the charge distribution for the hole and the particle as well as the charge difference between them. All this information is included in the transition diagram that provides a quantitative measurement of the nature of the transition. Here, a charge transfer of 87.1% between the thiophene and quinoxaline for state 4, and a local excitation of the quinoxaline (83.5%) for state 9 is observed.

6.2. Case study 2: [6]cycloparaphenylene
As the second case study, we investigated [6]cycloparaphenylene, a molecule composed of 6 benzene rings connected by covalent bonds in the para positions to form a ring Fig. 6 [XJ12]. Note that for the other three case studies in this paper, the number of subgroups is at most three which implies the charge transfer problem has a unique solution. Here, the molecule is fragmented into six groups, the six phenyl rings, and thus provides a good study of a system having more than one donor and acceptor. In this case, the charge transfer problem is not uniquely determined, and the transition diagrams computed using proportional and quadratic approaches may differ. We are here focusing on the first three excited states (Fig. 7). While for the first state, both the hole and the particle are delocalized over the whole molecule; the second and third excited states present a clear charge transfer character. When looking at the NTO for those two states, they appear to be very similar. However, looking at the charge difference density and the transition diagrams, we can observe subtle differences such as the difference of localization of the particle NTO mainly shared on two cycles for the second excited state and three cycles for the third excited state. The difference observed between the proportional and quadratic transition diagrams are marginal for our case but might be important in other systems bearing a large number of subgroups.

(a) Atoms

(b) Subgroups

(c) Segmentation

Figure 6: [6]cycloparaphenylene. (a) van der Waals representation, (b) the six subgroups and (c) the Voronoi segmentation.

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

9

h

-v

v

p

-v

v

qd

Transition diagram Transition diagram

Donor

Acceptor

(quadratic)

(proportional)

State 1

State 2

State 3

Figure 7: [6]cycloparaphenylene. Cols. 1, 2 relate to task V1. They show selected isosurfaces for three different NTOs for the hole (col. 1) and particle (col. 2). Col. 3 shows results of task V2 displaying how the charge changes during the electronic excitation. Cols. 4 and 5 display results of task V3. They show results of the quadratic (col. 4) and proportional (col. 5) method for computing the transition diagram.

6.3. Case study 3: Metal complexes
Metal complexes present very interesting electronic structure properties and are used in a range of applications such as catalysis, organic solar cells, and organic light-emitting devices. They are composed of one or several metallic atoms and one or several molecules (called ligands) which organize around the metal atom. Quantum chemistry has been widely used to study these systems and to identify if specific electronic excitations are localized on a specific part of a molecule or if there is a transfer from the metal to a specific ligand. Identifying the nature of these excitations is a prerequisite for designing new molecules with specific properties. We looked at the series of metal complexes made of one metal atom from group 11 (Copper Cu, Silver Ag and Gold Au) and two phenanthroline (Phe) molecules arranged around it (Fig. 8). Here, we are focusing on the first excited states for the three metal complexes. As expected for complexes made with a metal atom from the same group, the particle charge distribution Qp for all three molecules is similar. However, the hole charge distribution Qh is different with Cu-Phe having the most concentrated charge on Cu (71.6%). In Ag-Phe, QhAg = 52.3% and in Au-Phe, QhAu = 50.2%. In Au-Phe, the hole charge on the two Phe ligands is asymmetric (29.8% and 20.0%) as compared to the hole charge on Phe in Ag-Phe (23.0% and 24.7%) and Cu-Phe (14.6% and 13.8%). The transition diagrams allow to identify the differences between the three complexes with a larger

charge transfer from the metal to the Phe for Cu-Phe in comparison with Ag-Phe and Au-Phe.
6.4. Case study 4: Copper complexes with various ligands
We investigate a series of copper complexes bearing two ligands. The first ligand phenanthroline (Phe) is always the same in all complexes, while the second ligand varies: 2,9-diphenylphenanthroline (PhePhe), 2,9-dimethyl-phenanthroline (Pheme), 2,9-dimethoxy-phenanthroline (Pheome), a N-heterocyclic Carbene (IPR), and a diphosphine ligand (XANT). We are focusing here on the first excited states. The transition diagrams presented in Fig. 9 enable identification of the differences between the copper complexes as for Cu-Phe and Cu-Phe-PhePhe, the charge transfer occurs from the copper atom to both ligands. However, for the four other complexes, the charge transfer to Phe is coming from both the copper atom and the other ligands. Moreover, we observe that Cu-Phe-XANT presents a unique behavior since more of the transfer comes from the diphosphine ligand than from the Copper atom. This illustrates how this approach can be used on a series of molecules to identify quickly the typical differences between them.

10

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

h: -v

v

p: -v

v

Segmentation qd : Donor

Acceptor Transition diagram

Cu-PHE

Ag-PHE

Au-PHE

Figure 8: Case study 3: Metal complexes. Cols. 1 and 2 relate to visualization task V1. They show the isosurfaces for the different NTOs for the hole (col. 1) and particle (col. 2). Col. 3 shows the segmentation of the different subgroups. Col. 4 shows the results of V2, displaying how the charge changes during the electronic excitation at atomic level of detail. Col. 5 displays the results of V3, showing the transition diagram for the different metal complexes.

7. Discussion
Here we discuss some of the visualization design decisions and report the domain expert feedback. Discussion on the robustness and run-time performance of the method follows afterwards.
Visualization design. Our framework has been developed with computational chemists in the loop with constant feedback. During these discussions and along with the first experiments, the visualization and analysis tasks listed in Sec. 4 were developed. The process started with designs using bar charts which did not show the charge transfer. On the way to the final visualization design, we experimented with, among other visual representations, chord diagrams which were difficult to interpret for the chemists. Finally, we settled on Sankey diagram which is a simple yet effective visualization intuitively fulfilling all our visualization requirements. The transition diagram displays the charge distributions of hole and particle in the bottom and top bars and simplifies the comparison of the distributions. Showing the hole charge distribution at the bottom and particle at the top was natural for chemists because of their familiarity with energy diagrams, as against the standard practice of showing the flow in a Sankey diagram from left to right. Further, the transition diagram clearly distinguishes localized and non-localized charge transfer, a key requirement for chemists. In retrospect, we can summarize the design guidelines as providing a simple and direct visualization restricted to the most relevant aspects.

User feedback. In summary, the user feedback on the final result was very positive. There was an agreement that this visualization fills a gap in the analysis tools typically used for this task. The visualization gives easy access to quantitative information about the electronic transition that can be hardly derived from the sideby-side comparison of isosurfaces, a method that is typically used in such scenarios. The four use cases discussed above represent real-world examples, both in their type and complexity. While appreciating the presented methods, the computational chemists also stimulated discussion of further developments with respect to an increasing number and complexity of the configurations investigated, which we briefly discuss next in Section 8.
Robustness. As evident from the presented case studies and user feedback, the transition diagrams present the complete information about the subgroup charges and charge transfer very well for a small number of subgroups. They also capture the similarities and differences in transitions for a given set of molecules, even when the order of subgroups is changed as long as the order is changed consistently for all the molecules. However, further investigation is needed to study the scalability of these diagrams with an increasing number of subgroups. Novel visualization techniques may be needed to address these challenges.
One of the advantages of using the weighted Voronoi diagrambased segmentation method is that it is dependent only on the

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

11

atomic positions and radii, and not on the density field or its quality. However, the grid resolution does affect the segmentation quality in a discrete setting. The effect of the grid resolution on the quality of segmentation and computed charges need further investigation, but it is easy to see that higher resolution grids would be required for molecules containing a larger number of atoms. We also compared the weighted Voronoi-based segmentation with a gradient-based segmentation and found the computed charges at the subgroup level to be very similar, see the appendix (Table 1) for details.
Run time analysis. We performed some experiments to study the run time performance of our implementation and found that the segmentation was the most time-consuming stage of the pipeline. Although efficient implementation was not the focus of this work, we exploited parallelism during the segmentation and charge computation stages of the pipeline. The run times are dependant on the number of atoms and the grid size. For the molecules we considered in our case studies, we observed running times in the range of 50 ms (23 atoms) to 150 ms (97 atoms) on a workstation with an Intel i9 processor having 10 cores. All the grids in our case studies were of similar sizes with around half a million voxels.
8. Conclusions and future directions
In this paper, we have presented a pipeline for visual analysis of electronic transitions by looking at the Natural Transition Orbitals for the hole and particle. Our quantitative analysis adds a new perspective to a common problem in quantum chemistry with many applications. The proposed visual representation provides valuable information when comparing different designs of molecules concerning their physical and chemical properties.
The proposed pipeline represents a generic approach for applications where segmentation and transitions between those are of interest. However, the individual steps are using application-specific design decisions that have been driven by the goal to provide an efficient, simple, and chemically plausible solution to the problem. This is at first the choice of using a weighted Voronoi diagram for the segmentation. Second, the set of constraints in the optimization model are based on chemically plausible conditions. When applying the proposed pipeline to other settings, e.g., when moving from the investigation of molecules to crystal structures, the decisions may need to be reconsidered and adapted to the new application.
We will investigate alternatives for specific design decisions in the future. This includes different geometric, and topological approaches for volume segmentation and a larger variety of geometric constraints in the optimization. We also plan to extend this work to facilitate the automated classification of electronic transitions of ensembles of molecules. Further, integration of other physical and chemical properties of the transitions like transition energy and oscillatory strength would also be valuable to the chemists.

Bader [Bad90]. In practice, this idea has been implemented in software like TopoMS [BGL18] and an implementation by Henkelman et al. [HAJ06]. However, both these software failed to generate a segmentation for our input charge density fields i.e. NTOs. We believe this is because of the fact that these software are tailored for analysis of full charge density fields. The NTO charge density however is different, for example, it may not have any charge density maxima corresponding to some atoms, which is a crucial assumption made by both these software, resulting in failure to generate a segmentation.
In order to compare the Voronoi segmentation with some gradient-based approach, we then decided to use the Morse-Smale complex as implemented in Topology Toolkit (TTK) [TFL17]. It uses discrete Morse theory for computation of combinatorial gradient-based segmentation. To compute the segmentation, as a first step the maxima along with their ascending manifolds are computed using TTK. The ascending manifold of a maximum is the set of all points in the domain which reach this maximum after repeated integration in the gradient direction. Then in the second step, we used an approach suggested by TopoMS to assign a maximum to the closest atom, to compute the segmentation and charge per atom. The atomic charge can then be added to compute the subgroup charges.
Table 1 lists this detailed comparison for all the data sets used in our case studies. We can observe that Voronoi and gradient-based techniques provide very similar division of charge at the level of subgroups. The instances where the charge computed by Voronoi and Morse complex based approaches differ by more than 2% are highlighted in red. We observed only 6 such cases out of 102 computations of charges at the level of subgroup. Five of these six cases are observed in the case of metal complexes where one of the subgroups consist of just atom which can result in more noticeable differences in atomic boundaries.
Acknowledgements. This work is supported by the SeRC (Swedish eScience Research Center), the Swedish Research Council (VR) grant 201905487, and an Indo-Swedish joint network project: DST/INT/SWD/VR/P02/2019 and VR grant 2018-07085. VN is partially supported by a Swarnajayanti Fellowship from the Department of Science and Technology, India (DST/SJF/ETA-02/2015-16) and a Mindtree Chair research grant. The computations were enabled by resources provided by the Swedish National Infrastructure for Computing (SNIC) at NSC partially funded by the VR grant agreement no. 2018-05973.

Appendix A: Comparison of Voronoi segmentation with gradient-based segmentation
For segmenting charge density field spatially among the atoms of the molecule, gradient-based partitioning was suggested by

12

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

h: -v

v

p: -v

v

Segmentation qd : Donor

Acceptor Transition diagram

Phe

PhePhe

Pheme

Pheome

IPR

XANT

Figure 9: Case study 4: Copper complexes with various ligands. Columns 1 and 2 show selected isosurfaces for the hole and particle NTOs respectively. Column 3 shows the volume segmentation for the different subgroups. Column 4 shows how the charge changes during the electronic excitation. The last column shows the transition diagram for the different ligands. Notice how the transition diagrams in top two rows (Phe and PhePhe) are similar and how they differ from the second category, the next four rows.

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

13

Case study 1 Case study 2 Case study 3 Case study 4

Molecule Thiophene-Quinoxaline
[6]cycloparaphenylene
Cu-PHE2 Ag-PHE2 Au-PHE2 Cu-PHE2 Cu-PHE-PHEPHE Cu-PHE-PHEME Cu-PHE-PHEOME Cu-PHE-IPR Cu-PHE-XANT

State State 1 State 4 State 9 State 1
State 2
State 3
State 1 State 1 State 1 State 1 State 1 State 1 State 1 State 1 State 1

Subgroup
THIO QUIN
THIO QUIN
THIO QUIN
PHE1 PHE2 PHE3 PHE4 PHE5 PHE6
PHE1 PHE2 PHE3 PHE4 PHE5 PHE6
PHE1 PHE2 PHE3 PHE4 PHE5 PHE6
Cu PHE1 PHE2
Ag PHE1 PHE2
Au PHE1 PHE2
Cu PHE1 PHE2
Cu PHE PHEPHE
Cu PHE PHEME
Cu PHE PHEOME
Cu PHE IPR
Cu PHE XANT

QVh or
54.8% 45.2%
94.2% 5.8%
16.5% 83.5%
13.2% 15.6% 19.2% 14.0% 20.4% 17.6%
0.7% 0.7% 11.4% 11.4% 37.9% 37.9%
3.3% 24.8% 43.3% 0.5% 24.8% 3.3%
71.6% 13.8% 14.6%
52.3% 23.0% 24.7%
50.2% 29.8% 20.0%
71.6% 13.8% 14.6%
67.9% 12.9% 19.2%
70.9% 16.9% 12.2%
66.5% 14.7% 18.8%
71.4% 23.0% 5.6%
35.1% 8.0% 56.9%

Qh

QhMC
54.8% 45.2%

|QVhor - QhMC|
0.0% 0.0%

94.4% 5.6%

0.2% 0.2%

16.4% 83.6%

0.1% 0.1%

13.2% 15.6% 19.2% 14.0% 20.4% 17.6%

0.0% 0.0% 0.0% 0.0% 0.0% 0.0%

0.5% 0.5% 11.4% 11.4% 38.0% 38.0%

0.2% 0.2% 0.0% 0.0% 0.1% 0.1%

3.2% 24.9% 43.4% 0.4% 24.9% 3.2%

0.1% 0.1% 0.1% 0.1% 0.1% 0.1%

70.3% 14.3% 15.4%

1.3% 0.5% 0.8%

49.8% 24.3% 25.9%

2.5% 1.3% 1.2%

49.1% 30.4% 20.6%

1.1% 0.6% 0.6%

70.3% 14.3% 15.4%

1.3% 0.5% 0.8%

66.5% 13.7% 19.8%

1.4% 0.8% 0.6%

69.9% 18.0% 12.1%

1.0% 1.1% 0.1%

65.8% 15.5% 18.7%

0.7% 0.8% 0.1%

70.8% 24.9% 4.3%

0.6% 1.9% 1.3%

30.6% 7.9% 61.5%

4.5% 0.1% 4.6%

QVpor
6.8% 93.2%
7.1% 92.9%
2.1% 97.9%
20.3% 17.6% 14.1% 19.2% 13.2% 15.6%
37.9% 38.0% 10.5% 10.5% 1.5% 1.5%
24.1% 3.1% 1.8% 43.8% 3.1% 24.1%
3.5% 42.7% 53.8%
2.7% 46.8% 50.5%
2.8% 46.9% 50.3%
3.5% 42.7% 53.8%
3.2% 59.2% 37.6%
3.6% 95.7% 0.7%
3.2% 95.8% 1.1%
4.1% 93.8% 2.0%
2.3% 95.5% 2.2%

Qp

QMp C

|QVpor - QMp C|

5.8% 94.2%

1.0% 1.0%

6.0% 94.0%

1.1% 1.1%

1.8% 98.2%

0.3% 0.3%

20.7% 17.6% 13.8% 19.3% 13.0% 15.6%

0.4% 0.0% 0.3% 0.1% 0.2% 0.0%

39.7% 39.4% 8.9% 9.2% 1.4% 1.4%

1.8% 1.4% 1.6% 1.3% 0.1% 0.1%

23.6% 2.6% 1.8% 46.1% 2.6% 23.3%

0.5% 0.5% 0.0% 2.3% 0.5% 0.8%

1.8% 43.4% 54.8%

1.7% 0.7% 1.0%

0.7% 47.8% 51.5%

2.0% 1.0% 1.0%

1.3% 47.6% 51.1%

1.5% 0.7% 0.8%

1.8% 43.4% 54.8%

1.7% 0.7% 1.0%

1.7% 60.5% 37.8%

1.5% 1.3% 0.2%

2.0% 97.3% 0.6%

1.6% 1.6% 0.1%

1.9% 97.4% 0.7%

1.3% 1.6% 0.4%

1.5% 97.2% 1.3%

2.6% 3.4% 0.7%

1.2% 97.1% 1.7%

1.1% 1.6% 0.5%

Table 1: Comparison of subgroup charges computed using the Voronoi-based approach and the Morse complex-based approach. The symbols

QapVhporroaancdheQs.hMSCimairlaerulys,eQd Vptoor

denote the subgroup charge for hole NTO computed using Voronoi diagram-based and QMp C are used for particle NTO charges. The entries where the two approaches

and Morse complex-based differ by more than 2% are

highlighted in red.

14

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

References
[AGL05] AHRENS J., GEVECI B., LAW C.: Paraview: An end-user tool for large data visualization. The Visualization Handbook 717 (2005). 7
[ASSK19] AL-SAADON R., SHIOZAKI T., KNIZIA G.: Visualizing complex-valued molecular orbitals. The Journal of Physical Chemistry A 123 (2019), 3223­3228. 3
[Aur87] AURENHAMMER F.: Power diagrams: Properties, Algorithms and Applications. SIAM J. Comput. 16, 1 (1987), 78­96. 5
[Aur91] AURENHAMMER F.: Voronoi Diagrams - A survey of a Fundamental Geometric Data Structure. ACM Comput. Surv. 23, 3 (1991), 345­405. 5
[BAC11] BAHERS T. L., ADAMO C., CIOFINI I.: A Qualitative Index of Spatial Extent in Charge-Transfer Excitations. J Chem. Theory Comput. 7 (2011), 2498­2506. 3
[Bad90] BADER R. F. W.: Atoms in molecules ­ A Quantum Theory. International Series of Monographs on Chemistry. Wiley Online Library, 1990. 2, 3, 11
[BGL18] BHATIA H., GYULASSY A. G., LORDI V., PASK J. E., PASCUCCI V., BREMER P.-T.: TopoMS: Comprehensive topological exploration for molecular and condensed-matter systems. Journal of Computational Chemistry 39, 16 (2018), 936­952. 3, 11
[BT20] BURCH M., TIMMERMANS N.: Sankeye: A Visualization Technique for AOI Transitions. In ETRA'20 short papers (2020). 3
[CXDR18] CHAN G. Y.-Y., XU P., DAI Z., REN L.: VIBR: Visualizing Bipartite Relations at Scale with the Minimum Description Length Principle. IEEE Transactions on Visualization and Computer Graphics (TVCG) (2018). 4
[FTS16] FRISCH M. J., TRUCKS G. W., SCHLEGEL H. B., SCUSERIA G. E., ET AL. M. A. R.:, 2016. Gaussian Inc. Wallingford CT. 2, 3, 8
[GAC10] GARCIA G., ADAMO C., CIOFINI I.: Evaluating push­pull dye efficiency using TD-DFT and charge transfer indices. Phys. Chem. Chem. Phys. 15 (2010), 20210­20219. 3
[GBCG14] GÜNTHER D., BOTO R. A., CONTRERAS-GARCIA J., PIQUEMAL J.-P., TIERNY J.: Characterizing Molecular Interactions in Chemical Systems. IEEE Transactions on Visualization and Computer Graphics (TVCG) 20, 12 (2014), 2476­2485. 3
[GBP12] GYULASSY A., BREMER P.-T., PASCUCCI V.: Computing Morse-Smale Complexes with Accurate Geometry. IEEE Transactions on Visualization and Computer Graphics (TVCG) 18, 12 (2012), 2014­ 2022. 3
[GCMA13] GUIDO C. A., CORTONA P., MENNUCCI B., ADAMO C.: On the Metric of Charge Transfer Molecular Excitations: A Simple Chemical Descriptor. Journal of Computational Chemistry, 9 (2013), 3118­3126. 3
[GGL14] GYULASSY A., GÜNTHER D., LEVINE J. A., TIERNY J., PASCUCCI V.: Conforming Morse-Smale Complexes. IEEE Transactions on Visualization and Computer Graphics (TVCG) 20, 12 (2014), 2595­2603. 3
[GHBB04] GUERRA C. F., HANDGRAAF J., BAERENDS E. J., BICKELHAUPT F. M.: Voronoi deformation density (VDD) charges: Assessment of the Mulliken, Bader, Hirshfeld, Weinhold, and VDD methods for charge analysis. J. Comput. Chem. 25, 2 (2004), 189­210. 2
[GKLW16] GYULASSY A., KNOLL A., LAU C., WANG B.: Interstitial and interlayer ion diffusion geometry extraction in graphitic nanosphere battery materials. IEEE Transactions on Visualization and Computer Graphics (TVCG) 22, 1 (2016). 3
[HAJ06] HENKELMAN G., ARNALDSSON A., JÓNSSON H.: A fast and robust algorithm for Bader decomposition of charge density. Computational Materials Science 36, 3 (2006), 354­360. 3, 11
[HG08] HARANCZYK M., GUTOWSKI M.: Visualization of molecular orbitals and the related electron densities. Journal of Chemical Theory and Computation 4, 5 (2008), 689­693. 1, 3

[Hir77] HIRSHFELD F.: Bonded-atom fragments for describing molecular charge densities. Theoretica Chimica Acta 44, 2 (1977), 129­138. 2
[HPMM20] HUET L., PERFETTO A., MUNIZ-MIRANDA F., CAMPETELLA M., ADAMO C., CIOFINI I.: General DensityBased Index to Analyze Charge Transfer Phenomena: From Models to Butterfly Molecules. J. Chem. Theory Comput. 16 (2020), 4543­4553. 3
[HZAV18] HEIDAR-ZADEH F., AYERS P. W., VERSTRAELEN T., VINOGRADOV I., VÖHRIGER-MARTINEZ E., BULTINCK P.: Information-Theoretic Approaches to Atoms-in-Molecules: Hirshfeld Family of Partitioning Schemes. J. Phys. Chem. A 122 (2018), 4219­4245. 2
[JBAC12] JACQUEMIN D., BAHERS T. L., ADAMO C., CIOFINI I.: What is the "best" atomic charge model to describe through-space charge-transfer excitations? Phys. Chem. Chem. Phys. 14 (2012), 5383­ 5388. 3
[JSS19] JÖNSSON D., STENETEG P., SUNDÉN E., ENGLUND R., KOTTRAVEL S., FALK M., YNNERMAN A., HOTZ I., ROPINSKI T.: Inviwo--a visualization system with usage abstraction levels. IEEE Transactions on Visualization and Computer Graphics (TVCG) (2019). 7
[KBH06] KOSARA R., BENDIX F., HAUSER H.: Parallel sets: Interactive exploration and visual analysis of categorical data. IEEE Transactions on Visualization and Computer Graphics (TVCG) 12 (07 2006), 558­68. 7
[KFM19] KOTTRAVEL S., FALK M., MASOOD T. B., LINARES M., HOTZ I.: Visual Analysis of Charge Flow Network for Complex Morphologies. Computer Graphics Forum 38, 3 (2019). 4
[KKL15] KOZLIKOVA B., KRONE M., LINDOW N., FALK M., BAADEN M., BAUM D., VIOLA I., PARULEK J., HEGE H.-C.: Visualization of Molecular structure: The state of the art. In Eurographics Conference on Visualization (EuroVis) - STARs (2015). 3
[KKPR19] KIM H. W., KIM K., PARK S. W., RHEE Y. M.: Quantum chemistry for studying electronic spectroscopy and dynamics of complex molecular systems. In Molecular Spectroscopy: A Quantum Chemistry Approach, vol. 1. Wiley Online Library, 2019. 1
[LEF98] LIANG J., EDELSBRUNNER H., FU P., SUDHAKAR P. V., SUBRAMANIAM S.: Analytical shape computation of macromolecules: I. Molecular area and volume through alpha shape. Proteins: Structure, Function, and Bioinformatics 33, 1 (1998), 1­17. 3
[LWX20] LIU Q., WANG Q., XU M., LIU J., LIANG J.: DFT characterization and design of anthracene-based molecules for improving spectra and charge transfer. Spectrochimica Acta Part A: Molecular and Biomolecular Spectroscopy 227 (2020), 117627. 3
[Mar03] MARTIN R. L.: Natural Transition Orbitals. The Journal of Chemical Physics 118, 11 (2003), 4775­4777. 2
[Mul32] MULLIKEN R. S.: Electronic Structures of Polyatomic Molecules and Valence. II. General Considerations. Physical Review 41, 1 (July 1932), 49­71. 2
[Mul55] MULLIKEN R.: Electronic Population Analysis on LCAO-MO Molecular Wave Functions. Journal of Chemical Physics 23, 10 (1955). 2
[NMSL19] NOBRE C., MEYER M., STREIT M., LEX A.: The State of the Art in Visualizing Multivariate Networks. Computer Graphics Forum 38, 3 (2019). 4
[PKKO07] PETR EK M., KOSINOVÁ P., KOC A J., OTYEPKA M.: MOLE: a Voronoi diagram-based explorer of molecular channels, pores, and tunnels. Structure 15, 11 (2007), 1357­1363. 3
[PLEP70] POLITZER P., LEUNG K. C., ELLIOTT J., PETERS S. K.: Properties of Atoms in Molecules I. A Proposed Definition of the Charge on an Atom in a Molecule. J. Am. Chem. Soc. 92, 22 (1970), 6451­6453. 2
[REL17] ROMBOUTS J., EHLERS A. W., LAMMERTSMA K.: A quantitative analysis of light-driven charge transfer processes using voronoi partitioning of time dependent DFT-derived electron densities. J. Comput. Chem. 38, 20 (2017), 1811­1818. 3

Talha Bin Masood et al. / Visual Analysis of Electronic Densities and Transitions in Molecules

15

[RGH12] REININGHAUS J., GÜNTHER D., HOTZ I., WEINKAUF T., SEIDEL H. P.: Combinatorial Gradient Fields for 2D Images with Empirically Convergent Separatrices. arXiv:1208.6523v1, 2012. 3
[RHF05] RIEHMANN P., HANFLER M., FROEHLICH B.: Interactive Sankey diagram. In IEEE Symposium on Information Visualization (2005), vol. 1. 4
[Sch08] SCHMIDT M.: The Sankey Diagram in Energy and Material Flow Management, Part I: History. Journal of Industrial Ecology (2008). 3, 7
[SHS11] STONE J. E., HARDY D. J., SAAM J., VANDIVORT K. L., SCHULTEN K.: GPU-accelerated computation and interactive display of molecular orbitals. In GPU Computing Gems Emerald Edition, Applications of GPU Computing Series. Elsevier Inc., 2011, pp. 5­18. 1, 3
[SLM04] SCHROEDER W. J., LORENSEN B., MARTIN K.: The visualization toolkit: an object-oriented approach to 3D graphics. Kitware, 2004. 7
[SSH09] STONE A. J. E., SAAM J., HARDY D. J., VANDIVORT K. L., HWU W.-M. W., SCHULTEN K. J.: High performance computation and interactive display of molecular orbitals on GPUs and multi-core CPU. In GPGPU-2: Proceedings of 2nd Workshop on General Purpose Processing on Graphics Processing Units (2009). 3
[TFL17] TIERNY J., FAVELIER G., LEVINE J. A., GUEUNET C., MICHAUX M.: The topology toolkit. IEEE Transactions on Visualization and Computer Graphics (TVCG) 24, 1 (2017), 832­842. 11
[XJ12] XIA J., JASTI R.: Synthesis, Characterization, and Crystal Structure of [6]Cycloparaphenylene. Angewandte Chemie International Edition 51, 10 (2012), 2474­2476. 8

