TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES
TOMACK GILMORE
Department of Mathematics, University College London, London WC1E 6BT, UK
t.gilmore@ucl.ac.uk
Abstract. We consider matrices with entries that are polynomials in q arising from natural q-generalisations of two well-known formulas that count: forests on n vertices with k components; and trees on n + 1 vertices where k children of the root are smaller than the root. We give a combinatorial interpretation of the corresponding statistic on forests and trees and show, via the construction of various planar networks and the Lindstr¨om-Gessel-Viennot lemma, that these matrices are coefficientwise totally positive. We also exhibit generalisations of the entries of these matrices to polynomials in eight indeterminates, and present some conjectures concerning the coefficientwise Hankel-total positivity of their row-generating polynomials.

arXiv:2106.00656v2 [math.CO] 2 Jun 2021

Contents

1. Introduction

2

2. Preliminaries

6

2.1. Total positivity and the Lindstro¨m-Gessel-Viennot lemma

6

2.2. The binomial-like planar network

7

2.3. Matrix factorisations

10

2.4. A remark on Neville elimination

17

3. Combinatorial interpretations of the entries of the q-forests and q-trees

matrices, and some identites relating them

21

3.1. A combinatorial interpretation of the entries of F(q)

21

3.2. A combinatorial interpretation of the entries of T(q)

24

3.3. Some identities involving F(q) and T(q)

26

4. Pointwise total positivity of the q-forests and q-trees matrices

28

4.1. The planar network N1

29

5. Coefficientwise total positivity of the q-forests and q-trees matrices

33

6. Further comments and some open problems

37

6.1. General Abel Polynomials

38

6.2. Enumerating forests by proper and improper edges

41

6.3. A generalisation with more variables

48

6.4. (p, q)-Stirling polynomials

51

6.5. Generalised Bessel polynomials

53

Acknowledgements

57

References

57

1

2

T. GILMORE

1. Introduction

Two well-known enumerative formulas that often arise in the study of trees and forests are1

fn := (n + 1)n-1

(1.1)

and

tn := (n + 1)n.

(1.2)

The first formula, fn, gives the number of forests of rooted labelled trees on the vertex set [n] := {1, 2, . . . , n} and has the refinement:

n

fn =

fn,k

k=0

(1.3)

where each summand

fn,k :=

n - 1 nn-k k-1

(1.4)

is the number of forests on [n] comprised of k components (that is, k rooted labelled trees). The first few fn and fn,k are

 n,  k 0 1 2 3 4 5 6 fn

01

1

1 01

1

2 021

3

3 0961

16

4 0 64 48 12 1

125

5 0 625 500 150 20 1

1296

6 0 7776 6480 2160 360 30 1 16807

(1.5)

(see [63, A061356/A137452 and A000272]). By adding a new vertex (labelled 0) and connecting it to the root of each component in a forest, we see that fn is also the number of trees on vertices labelled 0, 1, . . . , n, rooted at 0, where the root has precisely k children.
The formula in (1.2), tn, gives the number of rooted labelled trees on the vertex set [n + 1] and has the following refinement similar to (1.3):

n

tn =

tn,k ,

k=0

(1.6)

where each summand

tn,k :=

n nn-k k

(1.7)

is the number of rooted labelled trees on the vertex set [n + 1] in which precisely k children of the root are lower-numbered than the root (see [7, 8, 65]). The first few

1See [14], [46, pp. 26-27], [15, p. 70], [69, pp. 25-28], [7], [65] or [3]. See also [25, 52, 60, 34, 57] and [1, pp. 235-240] for related information.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 3

tn and tn,k are:

 n,  k

0

1

2 3 4 56

tn

0

1

1

1

1

1

2

2

4

4

1

9

3

27 27

91

64

4

256 256 96 16 1

625

5

3125 3125 1250 250 25 1

7776

6 46656 46656 19440 4320 540 36 1 117649

(1.8)

(see [63, A071207]). We point out that this array has an alternative combinatorial interpretation; in [7, 8] the authors gave a bijection between trees on n + 1 vertices where k children of the root are lower-numbered than the root and forests on n + 1 vertices with k + 1 components where the vertex n + 1 is a leaf.
The main goal of this paper is to prove the total positivity of some matrices that arise from generalisations of fn,k and tn,k. Recall that a matrix is totally positive (strictly totally positive) if all of its minors are nonnegative (strictly positive, respectively).2 Total positivity has many applications across combinatorics, statistical physics, representation theory, and background material on the topic can be found in [42, 26, 51, 22].
Our first result concerns the forests (of rooted labelled trees) matrix

F := (fn,k)n,k0 =

n - 1 nn-k

,

k-1

n,k0

(1.9)

(the first few rows of which appear in (1.5)) and the (rooted labelled) trees matrix

T := (tn,k)n,k0 =

n nn-k

,

k

n,k0

(the first few entries of which appear in (1.8)). We have:

(1.10)

Theorem 1.1. The matrices F and T are totally positive.

The total positivity of the forests and trees matrices has been proven very recently

in [66, 67] using different methods to the ones we employ in the present paper. Sokal

observes in [66] that F is the exponential Riordan array R[F, G] with F (t) := 1 and

G(t) the tree function [16]

G(t) :=  nn-1 tn , n!
n=1

(1.11)

and similarly in [67] Sokal and Chen observe that T is the exponential Riordan array

R[F, G] with

F (t) :=  nn tn =

1

n! 1 - G(t)

n=0

(1.12)

and G(t) as above. In [66] and [67] the author(s) exploit these intepretations of F and

T and make use of the production-matrix method to prove these matrices are totally

2The terms "totally nonnegative" and "totally positive" have been used by previous authors (see, for example, [26, 24, 22]) in place of what we have called here "totally positive" and "strictly totally positive" respectively. In studying the literature it is important to clarify which sense of total positivity is being used, since many theorems are valid only for strictly totally positive matrices.

4

T. GILMORE

positive.3 The proof of Theorem 1.1 we offer below instead takes a leaf from [5, 24, 22], making use of the Lindstro¨m-Gessel-Viennot (LGV) lemma and planar networks (see Section 2.2).
The matrices F and T are closely related; by studying the entries one can, in effect, see the woods for the trees since for n > 0

fn,k =

n-1 k-1

nn-k =

k n

n k

nn-k

=

k n tn,k,

(1.13)

that is, F and T are related via a diagonal similarity transform (see Lemma 3.5 in

Section 3.3):

F = lim diag((n + )n0)-1T diag((k + )k0) 0

(1.14)

where diag(a) denotes (for the sequence a = (an)n0) the diagonal matrix with (n, n)entry equal to an and all other entries 0 (note we must take a limit in the above to avoid division by zero in the first column of T). Total positivity is preserved under

matrix multiplication (this follows from the Cauchy-Binet formula), so (1.14) shows

that the total positivity of T implies that of F (a diagonal matrix with nonnegative

entries on the diagonal is clearly totally positive).

In fact there are a number of identities we present in Section 3.3 that allow one to

go from T to F (and vice versa) via simple matrix multiplications that preserve total

positivity. By specialising q to q = 1 in Lemma 3.11 below we obtain the identity

T = F·M

(1.15)

where M := (mn,k)n,k0 is the unit-lower-triangular matrix with (n, k)-entry

n! mn,k = k!

(1.16)

for n  k and all other entries 0. The matrix M is easily shown to be totally positive (see Section 3.3), so it follows from (1.15) that the total positivity of F implies that of T. In order to prove Theorem 1.1 it therefore suffices to prove that the forests matrix F is totally positive; we do this in Section 4 by constructing a planar network with nonnegative rational weights and showing that the corresponding path matrix is F. The total positivity of F then follows from the LGV lemma (see Section 2.1).
In this paper, however, we are chiefly concerned with q-generalisations of the forests and trees matrices. The formula fn,k has a perfectly natural q-analogue, thus we define the q-forests matrix F(q) := (fn,k(q))n,k0 to be the matrix with (n, k)-entry



nk



  fn,k(q) :=


n-1 k-1

([n]q )n-k
q



0

if k = 0, if n  k  1, otherwise.

(1.17)

where

1 - qn

1 + q + · · · + qn-2 + qn-1 if n > 0,

[n]q := 1 - q = 0

if n = 0,

(1.18)

3We remark that in [66, 67] the author(s) prove that generalisations of F and T (that are different to those considered here) are coefficientwise totally positive. We discuss their results further in Section 6.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 5

n k

q

is

the

q-binomial

coefficient:

in which

n := [n]q! , k q [k]q![n - k]q!

n

[n]q !

:=

 

[j]q

j=1

1

if n > 0, if n = 0,

and nk is the Kronecker delta:

1 if n = k, nk := 0 if n = k

(1.19) (1.20) (1.21)

It follows easily from (1.17) that fn,k(q) is a monic self-reciprocal polynomial of degree (n - 1)2 - (k - 1)2, and the first few rows of F(q) are:

1



0

1



 

0

q+1

1

 

 0 q4 + 2q3 + 3q2 + 2q + 1 q3 + 2q2 + 2q + 1 1







...

...

...

... . . .

(1.22)

The q-forests matrix counts forests on n vertices with k components with respect to some statistic, which we interpret combinatorially in Section 3 (see Corollary 3.2). Please note that in [66] Sokal considers a different generalisation of F (he introduces indeterminates into F that count forests of rooted labelled trees in terms of proper and improper edges), whereas our results grew from studying natural q-generalisations of the matrix entries. In Section 6 we discuss how our generalisation gives rise to some curious conjectures concerning generalisations of well-known polynomial sequences including: the Schl¨afli-Gessel-Seo polynomials; the general Abel polynomials; (p, q)Stirling cycle polynomials; and the reverse Bessel polynomials.
Each entry tn,k of the trees matrix has a similar natural q-analogue; we thus define the q-trees matrix to be T(q) := (tn,k(q))n,k0 where

tn,k(q) :=

n k

([n]q )n-k .
q

(1.23)

Once more it is easy to see that tn,k(q) is a monic self-reciprocal polynomial of degree n(n - 1) - k(k - 1), and the first few rows of T(q) are:



1



1

1



q2 + 2q + 1

q2 + 2q + 1

1



 q6 + 3q5 + 6q4 + 7q3 + 6q2 + 3q + 1 q6 + 3q5 + 6q4 + 7q3 + 6q2 + 3q + 1 q4 + 2q3 + 3q2 + 2q + 1 1

 

...

...

...

... . . .

(1.24)

It follows from [7, 8] that the entries of the matrix T(q) count forests on n + 1 vertices

with k + 1 components where the vertex n + 1 is a leaf with respect to some statistic,

and we give a combinatorial interpretation of q in Section 3. We note that our q-

generalisation of the tree matrix and the corresponding combinatorial interpretation

differs from the generalisation of T studied by Chen and Sokal in [67].

6

T. GILMORE

The entries of F(q) and T(q) are polynomials in q with integer coefficients, and there is a natural extension of total positivity to matrices whose entries are polynomials in one or more indeterminates x. We equip the polynomial ring R[x] with the coefficientwise partial order, that is, we say that P is nonnegative (and write P 0) in case P is a polynomial with nonnegative coefficients. We then say that a matrix with entries in R[x] is coefficientwise totally positive (TP) if all of its minors are polynomials with nonnegative coefficients, and if all of its minors of size  r are polynomials with nonnegative coefficients we say that the matrix is totally positive of order r (TPr). Our main result is the following:
Theorem 1.2. The matrices F(q) and T(q) with entries in the polynomial ring Z[q] are coefficientwise totally positive.

It is plain to see that the above theorem reduces to Theorem 1.1 when q is specialised to q = 1. More generally, we say that a matrix M with polynomial entries belonging to R[x] is pointwise totally positive on some domain D  R+ if M is totally positive for all x  D (by which we mean all the indeterminates x are specialised to values in D). Coefficientwise total positivity of M thus implies pointwise total positivity for all x  R+, but the converse is not true.
The main goal of this paper is to prove Theorem 1.2 and the structure of our proof is as follows: after reviewing some basic concepts in total positivity from the perspective of planar networks in Section 2, we then provide combinatorial interpretations of the entries of F(q) and T(q) in Section 3 and establish some identities that show the coefficientwise total positivity of F(q) implies that of T(q). In Section 4 we construct a planar network with weights that are rational and pointwise nonnegative functions of q, and prove that the path matrix corresponding to this planar network agrees with F(q); thanks to the LGV lemma this proves pointwise total positivity of F(q) and T(q) for q  R+ (Theorem 1.1 is then obtained by specialising q to q = 1). In Section 5 we show how the network from Section 4 can be transformed into a planar network with weights that are polynomials in q, thereby proving Theorem 1.2. We conclude in Section 6 with some further generalisations and open problems, some of which will be the subject of future work.

2. Preliminaries
Here we review some fundamental definitions and facts regarding total positivity. Please note that since our proofs rely on Lindstr¨om-Gessel-Viennot lemma, many of the results in this section are motivated by performing operations on planar networks (see [22, 24, 5, 6]), from which various matrix identites follow.

2.1. Total positivity and the Lindstr¨om-Gessel-Viennot lemma

One fundamental tool in the study of total positivity is the Lindstr¨om-Gessel-
Viennot (LGV) lemma. Suppose G is a locally finite acyclic digraph with source vertices U := {u0, u1, . . . , un} and sink vertices V := {v0, v1, . . . , vn}, where the weight we of an edge e is an element of some commutative ring R. Let w(P (ui, vj)) denote the product of the weights of the edges of a path P (ui, vj) starting at ui and ending at vj, and define

PG(ui  vj) :=

w(P (ui, vj))

(2.1)

P (ui,vj )

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 7

to be the sum over all weighted paths between ui and vj. The path matrix corresponding to G is then the matrix

PG := (PG(ui  vj))0i,jn.

(2.2)

We say that a family of nonintersecting paths from U to V is an n-tuple (P0, P1, . . . , Pn) of paths in G such that:

(i) There exists a permutation  of {0, 1, 2, . . . , n} such that for each i, Pi is a path from ui to v(i).
(ii) Whenever i = j, paths Pi and Pj have no vertices in common (this includes endpoints).

The LGV lemma states that
n

det(PG) =

sgn() w(Pi),

(P0,P1,...,Pn):U V

i=0

(2.3)

where sgn() = (-1)inv() is the signature of the permutation  arising from Pi mapping ui to v(i) (note that inv() denotes the number of inversions of , that is, pairs (i, j) in {0, 1, . . . , n} such that i < j and (i) > (j)). In particular, if the only permutation giving rise to nonempty families of nonintersecting paths is the identity then det(PG) gives the sum over all weighted families of nonintersecting paths in G that begin at U and end at V , where the weight of each family is the product of the weights of the paths (P0, . . . , Pn).
Suppose now the source and sink vertices of G are fully compatible, by which we mean that for any subset of sources un1, un2, . . . , unr (where n1 < n2 < · · · < nr) and sinks vk1, vk2, . . . , vkr (where k1 < k2 < . . . < kr), the only permutation   Sr mapping each source uni to the sink vk(i) that gives rises to nonempty families of paths is the identity. The LGV lemma then implies that every minor of PG is a sum over families of nonintersecting paths between specified subsets of U and V , where each family has weight w(Pi). If every edge has a weight that is a positive real number then PG is totally positive; if the weights of the network belong to the field Q(x) of rational functions of x that are pointwise nonnegative on some domain D then PG is pointwise totally positive on D; and if the weight of each edge is a polynomial in the indeterminates x with nonnegative integer coefficients then PG is totally positive in Z[x] equipped with the coefficientwise order.
Determining whether a general locally finite acyclic digraph is fully compatible is non-trivial, however, if G is embedded in the plane and the source and sink vertices U and V lie on the boundary of G in the order "first U in reverse order, then V in order" then the topology of G clearly implies that U and V are fully compatible (see, for example, Lemma 9.18 in [49]). From now on we will refer to locally acyclic digraphs embedded in the plane with fully compatible sources and sinks as planar networks, in the spirit of [24].

2.2. The binomial-like planar network
The matrices T(q) and F(q) are unit-lower-triangular, so in the sequel we will be principally concerned with what we call the binomial-like planar network (depicted in Figure 1). This planar network consists of vertices indexed by i (j) increasing horizontally from the right (vertically upwards, respectively) where 0  i  j. Each source ui is the vertex with index (i, i) while each sink vj is the vertex (0, j). Each horizontal edge directed from vertex (i, j) to vertex (i-1, j) has weight i,j-i+1, while

8

T. GILMORE

Figure 1. The binomial-like planar network N for vertices u0, u1, . . . , u5 and v0, v1, . . . , v5.

the weight of a diagonal edge directed from vertex (i, j) to (i - 1, j - 1) has weight i,j-i. We also assume there exists a directed edge from u0 to v0 with weight 1.
The binomial-like planar network with weights  = {i,l}i,l1 and  = {i,l}i1,l0 described above is denoted N . Please note that the source and sink vertices of N are fully compatible, so it follows immediately from the LGV lemma that the path matrix PN is automatically coefficientwise totally positive over Z[, ] in all of these indeterminates!
This is really the beauty of the LGV lemma (in the context of total positivity): given a lower-triangular matrix M that appears to be coefficientwise totally positive in R[x], one can try to prove total positivity by specialising i,l, i,l to suitable nonnegative elements of R[x] and showing that under such a specialisation

PN = M.

(2.4)

Indeed, this is how we concoct our proof of Theorem 1.2. We first show that specialising the weights of the binomial-like network to suitably chosen rational functions of q yields a path matrix that agrees with F(q) in Section 4; since these rational functions are all nonnegative for q  R+ we conclude that F(q) is pointwise totally positive for q  R+. In Section 5 we then transform this binomial-like network to obtain a different planar network with weights that are polynomials in q in order to show that F(q) is coefficientwise totally positive.
The planar network construction described above originally goes back to Brenti [5] who also observed that if the binomial-like network N has weights  and  that depend purely on the first index (that is, i,l = i, and i,l = i, for all i) then the entries of the path matrix PN satisfy the n-dependent recurrence

PN (un  vk) = n, PN (un-1  vk-1) + n, PN (un-1  vk) .

(2.5)

Similarly if the weights depend solely on the second index (that is, i,l = ,l and i,l = ,l for all l) then the entries of the path matrix satisfy the k-dependent

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 9

recurrence

PN (un  vk) = ,k PN (un-1  vk-1) + ,k PN (un-1  vk) .

(2.6)

The most straightforward (and thus, eponymous) example that illustrates this connection between matrices with entries satisfying purely n- (or k-) dependent recurrences and binomial-like planar networks is the weighted binomial matrix,

Bx,y :=

n xn-kyk

,

k

n,k0

the entries of which satisfy the n-dependent linear recurrence

(2.7)

(Bx,y)n,k = x(Bx,y)n-1,k + y(Bx,y)n-1,k-1

(2.8)

for n > 0 with initial condition (Bx,y)0,k = 0k. The corresponding planar network is the network N with i,l = y and i,l = x, and it follows immediately from the LGV lemma that

Corollary 2.1. The weighted binomial matrix Bx,y is coefficientwise totally positive in Z[x, y].

Matrices with entries given by purely n-dependent or purely k-dependent recurrences have relatively straightforward planar network representations, and often in these cases it is easy to deduce a straightforward planar network by studying the recurrence.
Matrices with entries that satisfy recurrences dependent on both n and k, however, give rise to seemingly much more complex planar networks (see, for example, [11]). For example, the entries of the forests matrix

F = (fn,k)n,k0 = satisfy the recurrence:

n - 1 nn-k

,

k-1

n,k0

(2.9)

fn,k =

n n-1

1

n-1 k

n-1

(n - 1)fn-1,k + k - 1 n n

+ (k - n) fn-1,k-1

(2.10) for n > 1 with initial conditions fn,0 = n0, and f1,1 = 1. We note that we were able to find the correct weights for the binomial-like planar network corresponding to F in spite of this complicated recurrence, and not because of it.
In the sequel we will also make use of the following fact. Suppose i,l = 1 and consider the sum over all weighted paths from un to vk in N (denoted PN (un  vk)). By studying the network it is relatively easy to see that PN (un  vk) can be expressed as a nested sum

k+1

k+2

n

PN (un  vk) =

i1,k+1-i1

i2,k+2-i2 · · ·

in-k ,n-in-k(2.11)

i1=1

i2=i1+1

in-k =in-k-1 +1

=

  i1,k+1-i1 i2,k+2-i2 · · ·  . in-k,n-in-k

1i1 <···<in-k n

(2.12)

10

T. GILMORE

Observe that if the weights i,l are dependent only on the first index then PN (un  vk) can be realised as the elementary symmetric polynomial

en-k(X1, X2, . . . , Xn) :=

Xi1 Xi2 · · · Xin-k

1i1 <···<in-k n

(2.13)

where Xn := n,. If instead the weights i,l depend solely on the second index then (2.12) can be realised as the complete homogeneous symmetric polynomial

hn-k(X1, X2, . . . , Xk+1) :=

Xi1 Xi2 · · · Xin-k

1i1 ···in-k k+1

(2.14)

where Xk = ,k-1 (this observation again goes back to Brenti [5]). In this article we study total positivity primarily through the lens of planar net-
works; the next section dicusses how planar networks can be intepreted algebraically as matrix factorisations.

2.3. Matrix factorisations
The planar network approach outlined above allows us to easily write down various factorisations of the path matrix PN . Before discussing these factorisations we first clarify some notation. We use N to denote the binomial-like network described in the previous subsection with the set of horizontal weights  and diagonal weights . Conversely, given a matrix M , in this section we will often use NM to denote a planar network with corresponding path matrix PNM satisfying

PNM = M.

(2.15)

In this case NM is referred to as a planar network representation of the matrix M . We will make much use of the following definition. For sequences a := (an)n0 and
b := (bn)n0, let L(a, b) denote the lower-bidiagonal matrix with (n, k)-entry

 ak 
(L(a, b))n,k0 = bk
0

if n = k, if n = k + 1, otherwise.

(2.16)

The first few rows and columns of L(a, b) are:

 a0



 b0 a1



 

b1 a2

 



L(a, b)

=

 



b2 a3 b3 a4



 

.



 

b4 a5

 

 

b5 a6

 

... ...

(2.17)

In case an = 1 for all n we abbreviate L(a, b) to L(b), while if bn = 0 for all n the matrix L(a, b) is simply the diagonal matrix diag(a) with (n, n)-entry an and all other entries 0. Lastly, if an = 1 and the sequence b is constant, that is, bn = x for all n, we abbreviate L(b) to L(x), and if we have an = x and bn = y for all n with y = 1 we abbreviate L(a, b) to L(x, y).

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 11

Figure 2. The planar network NL(a,b) (left), and the planar network that arises from expressing L(a, b) as a product of elemen-
tary lower-bidiagonal transfer matrices and concatenating the networks
NE0(a0,b0), NE1(a1,b1), . . . (right). Note that unlabelled directed edges are assumed to have weight 1.

The lower-bidiagonal matrix L(a, b) has a planar network representation NL(a,b) in which

P (u NL(a,b) n  vn) = an

(2.18)

and

P (u NL(a,b) n  vn-1) = bn-1

(2.19)

(see the diagram on the left in Figure 2). Since we view these matrices through

the lens of planar networks we will refer to the sequences a and b as edge-sequences

corresponding to L(a, b). According to the LGV lemma we have:

Corollary 2.2 (Lower-bidiagonal matrices). The matrix L(a, b) is totally positive in Z[a, b] equipped with the coefficientwise order.

It is straightforward to verify that

L(a, b) = E0(a0, b0)E1(a1, b1)E2(a2, b2) · · ·

(2.20)

where En(a, b) denotes the elementary (lower) bidiagonal matrix with (n, n)-entry a, (n + 1, n)-entry b, all other diagonal entries 1, and all other entries 0. As with bidiagonal matrices, in case a = 1 we abbreviate En(1, b) to En(b). We now present a useful lemma relating matrix products and concatenated planar networks:

Lemma 2.3 (Concatenating planar networks). Suppose M1 and M2 are path matrices corresponding to two planar networks NM1 and NM2, where NM1 has source vertices

U := {u0, u1, . . . , un}

(2.21)

and sink vertices

V := {v0, v1, . . . , vm},

(2.22)

12

T. GILMORE

Figure 3. The planar network N1 up to sources u0, u1, . . . , u4 and v0, v1, . . . , v4 (unlabelled directed edges have weight 1).

and NM2 has source vertices

U := {u0, u1, . . . , um}

(2.23)

and sink vertices

V = {v0, v1, . . . , vl}.

(2.24)

Then the matrix product M1M2 is the path matrix corresponding to the planar network NM3 obtained by concatenating M1 and M2, with source vertices U and sink vertices V , where each vertex vi  V is identified with ui  U for all i.

Proof. Since vi is identified with ui we can write the sum over over weighted paths from un to vk in NM3 as

m

PNM3 (un  vk) = PNM1 (un  vs)PNM2 (us  vk) = (M1M2)n,k.
s=0

(2.25)

Concatenating planar networks thus corresponds to multiplying path matrices, and the matrices M1 and M2 in the above are referred to as transfer matrices of the planar network NM3. The elementary bidiagonal matrices on the right-hand side of (2.20) are thus transfer matrices of NL(a,b),4 and concatenating the planar networks for E0(a0, b0), E1(a1, b1), . . . yields the planar network on the right in Figure 2.
4Note that the elementary bidiagonals described here are, in fact, referred to as column transfer matrices, we will shortly also consider what we call diagonal transfer matrices.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 13

We now interpret the binomial-like planar network N and its path matrix PN from Subsection 2.2 in light of these definitions. By extending the source vertices of N to the left so that they lie on the same vertical line we obtain a planar network N1 that is isomorphic to N (see Figure 3), in particular we have

PN (un  vk) = PN1(un  vk).

(2.26)

Consider a subnetwork Ci of N1 consisting of source vertices U := {(i+1, j) : j  N} and sink vertices V := {(i, j) : j  N}. Let ai denote the sequence of weights of horizontally directed edges emanating from vertex (i + 1, i + n) for increasing n, that is, ai := (an)n0 where

an =

i+1,n

if n > 0, .

1

if n = 0

(2.27)

Similarly let bi denote the sequence of weights of the diagonal edges emanating from
vertex (i + 1, i + n + 1) for increasing n, that is, bi := (i+1,n)n0. It is easy to see that the path matrix corresponding to Ci is the column transfer matrix

PCi =

Ii

0

0 L(ai, bi)

(2.28)

where Ii is the identity matrix of size i, and L(ai, bi) is the lower-bidiagonal matrix with corresponding edge sequences ai and bi. Obviously the matrix PCi is totally positive in Z[a, b] equipped with the coefficientwise order.
Since N1 is the concatenation of column transfer matrices we immediately obtain what we refer to as a production-like factorisation of PN :

Corollary 2.4 (Production-like factorisation). The path matrix PN corresponding to the binomial-like planar network N has the factorisation:

PN = · · ·

I2

0

0 L(a2, b2)

·

I1

0

0 L(a1, b1)

· L(a0, b0)

(2.29)

where ai = (i+1,n)n0 (with i+1,0 = 1) and bi = (i+1,n)n0.

Recall from the previous subsection that the weighted binomial matrix Bx,y is the path matrix of the binomial-like network N with i,l = y and i,l = x. The above corollary thus yields the following factorisation of Bx,y:

Corollary 2.5 (Production-like factorsation of Bx,y). The matrix Bx,y has the productionlike factorisation

Bx,y = · · ·

I2 0 0 L(y, x)

·

I1 0 0 L(y, x)

· L(y, x)

(2.30)

where L(y, x) denotes the lower-bidiagonal matrix with (0, 0)-entry 1, all other diagonal entries y, all subdiagonal entries x, and all other entries 0.

We note that the above corollary imples that Bx,y satisfies

Bx,y =

10 0 Bx,y

L(y, x).

(2.31)

14

T. GILMORE

Figure 4. The planar network NT (a) that has corresponding path matrix T (a).

There are other ways to factorise PN that rely on the following helpful definition. Given a sequence a = (an)n0 let T (a) := (an,k)n,k0 denote the lower-triangular
matrix with (n, k)-entry

n-1

an,k =

aj

j=k

(2.32)

for n  k and 0 in all other cases (we consider the empty product arising from n = k

to be 1). The first few rows and columns of T (a) are thus:

1



 a1,0 1



 

a2,0

a2,1

1

 

T (a)

=

 

a3,0

a3,1

a3,2

1

 

.

 

a4,0

a4,1

a4,2

a4,3

1

 

 

a5,0

a5,1

a5,2

a5,3

a5,4

1

 

... ... ... ... ... ... . . .

(2.33)

The matrix T (a) is the path matrix corresponding to the planar network NT (a) in which

PNT (a) (un  vk) = an,k

(2.34)

(see Figure 4). Clearly T (a) is totally positive in Z[a] equipped with the coefficientwise

order, and by comparing Figure 2 with Figure 4 and (2.20) it is easy to see that

T (a) = · · · E2(a2)E1(a1)E0(a0) = (E0(-a0)-1E1(-a1)-1E2(-a2)-1 · · · )-1, (2.35)

since En(a)-1 = En(-a). We thus obtain the following corollary:

Corollary 2.6 (Inverse lower-bidiagonal matrices). For a sequence a = (an)n0 we

have

T (a) = L(-a)-1

(2.36)

where -a = (-an)n0.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 15

Figure 5. The planar network N2 up to source u4 and sink v4 (unlabelled edges have weight 1). Please note the red dashed lines are not
part of the planar network, they delineate the sources and sinks of each diagonal transfer matrix Dl.

In light of Corollary 2.6 we refer to the matrix T (a) as an inverse (lower-)bidiagonal
matrix with corresponding edge sequence a. The case where an = x for all n often arises in the study of total positivity, and T (a) is then referred to as a Toeplitz matrix of powers of x since each (n, k) entry is xn-k, and we denote it T(x). It follows from the LGV lemma that T(x) is coefficientwise totally positive in Z[x]. More generally, given a sequence a = (an)n0 we call the infinite lower-triangular matrix T(a) = (an-k)n,k0 where al = 0 for l < 0 the (infinite) Toeplitz matrix associated to a.5
Let us return again to the binomial-like planar network N . Observe that N is
isomorphic to the planar network N2 in Figure 5, in particular we have

PN (un  vk) = PN2(un  vk)

(2.37)

for all n, k  0. Consider a subnetwork Dl of N2 contained between a pair of consecutive dashed
diagonal lines. The path matrix for each such subnetwork is the diagonal transfer

matrix :

PDl =

Il

0

0 diag(al)T (bl)

(2.38)

where a0 = (1)n0, al = (n+1,l)n0 for l > 0, and bl = (n+1,l)n0 for all l. The concatenation of subnetworks D0, D1, . . . from left to right yields a different
factorisation of PN , namely its quasi-production-like factorisation:

5We observe here that a sequence a = (an)n0 of real numbers is Toeplitz-totally positive if its associated Toeplitz matrix T(a) is totally positive, and such sequences are commonly referred to as P´olya frequency sequences. A sufficient condition for Toeplitz-total positivity of a sequence a of real numbers is given by the celebrated Aissen­Schoenberg­Whitney­Edrei theorem [42, Theorem 5.3, p. 412]. Similarly, a sequence a of elements belonging to R[x] is coefficientwise Toeplitz-totally positive if its associated Toeplitz matrix T(a) is coefficientwise totally positive in R[x]; an extension of the Aissen­Schoenberg­Whitney­Edrei theorem to this more general setting can be found in [66, Lemmas 2.4 and 2.5].

16

T. GILMORE

Corollary 2.7 (Quasi-production-like factorisation). The path matrix PN has the factorisation

PN = T (b0) ·

I1

0

0 diag(a1)T (b1)

·

I2

0

0 diag(a2)T (b2)

···

(2.39)

where al = (n+1,l)n0, and bl = (n,l)n0.

The weighted binomial matrix Bx,y thus has the following quasi-production-like factorisation which can also be found in [10, Lemma 2.8]:

Corollary 2.8 (Quasi-Production-like factorisation of Bx,y). The weighted binomial matrix Bx,y has the quasi-production-like factorisation

Bx,y = T (x) ·

I1 0 0 yT (x)

·

I2 0 0 yT (x)

···

(2.40)

where

yT (x) = diag(y)T (x).

(2.41)

Observe that we can write the factorisation of Bx,y above as

Bx,y = T (x) diag(y) ·

I1

0

0 T (x) diag(y)

·

I2

0

0 T (x) diag(y)

···

(2.42)

where y = (1, y, y, . . .), from which it immediately follows that

Bx,y = T (x) diag(y) ·

10 0 Bx,y

.

(2.43)

We conclude this subsection with one final lemma relating bidiagonal and inverse bidiagonal matrices.

Lemma 2.9. Suppose a = (an)n0 and b = (bn)n0 are sequences of elements belonging to a field F . Then

(i) If an = -bn for all n then L(a)T (b) = I; (ii) If an + bn = 0 for all n then

L(a)T (b) =

10 0 T (b )

· L(a )

(2.44)

where a = (an)n0 is the edge sequence in which

an :=

a0 + b0
an-1 (an +bn ) an-1 +bn-1

if n = 0, if n > 0,

and b = (bn)n0 is the edge sequence in which

bn

=

bn(an+1 + bn+1) . an + bn

Proof. (i) If an = -bn then we trivially have L(a)T (b) = L(-b)T (b) = L(-b)L(-b)-1 = I,

(2.45) (2.46) (2.47)

(ii) Suppose an + bn = 0 for all n, and let M = L(a)T (b) and

N=

10 0 T (b )

· L(a ).

(2.48)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 17

Figure 6. The planar network representation of Lemma 2.9

Clearly Mn,n = 1 = Nn,n, while for n > k  0 the matrix entries of Mn,k can be written as a telescoping product

Mn,k

=

n-2
(an-1 + bn-1) bi
i=k

=

(ak

+

bk)

n-2 i=k

bi(ai+1 + bi+1) (ai + bi)

=

Nn,k

(2.49)

(the empty product is taken to be 1).

Figure 6 is a planar network representation of Lemma 2.9. As simple as Lemma 2.9 is, it will prove to be a fundamental tool in our proof of Theorem 1.2. In applications in this paper the field F will be the field Q(q) of rational functions of q, which is the fraction field of the ring Z[q] of polynomials in q. The planar network we present in Section 4 arises from specialising the weights  and  of the binomial-like planar network N to certain rational functions of q, and Lemma 2.9 allows us to transform this network into a different network with weights that are polynomials in q.
2.4. A remark on Neville elimination Given a totally positive matrix M there are myriad ways in which to express M as
a product of totally positive matrices, however, if the entries of M belong to R then Gasca and Pen~a [30] provide an algorithm for systematically determining a "canonical" factorisation. The process is based on the Neville-Aitken technique [28] which, in the context of solutions of linear systems, gives rise to Neville elimination [29, 27]. Neville elimination can be a powerful tool for studying totally positive matrices in general; here we sketch a brief overview of it purely for unit-lower-triangular matrices. For a full treatment please see [30].
Let M := (mn,k)0n,kN be a unit-lower-triangular matrix of size N + 1. If M contains any zeroes in its initial k = 0 column then form the matrix M0 := (m0n,k)0n,kN by moving the offending rows of M to the bottom in such a way that the relative order among them is preserved (if M does not contain any zeroes in its initial column then set M0 := (m0n,k)0n,kN ). The entries m0i,0 for i  0 are referred to as the (i, 0) pivots of M .

18

T. GILMORE

Suppose row n1 is the bottom-most nonzero entry in column k = 0. For i decreasing

from n1 to 1 subtract

m0i,0 m0i-1,0

(row

(i

-

1))

(2.50)

from row i (thereby reducing m0i,0 to 0 from bottom to top as i decreases). This operation is equivalent to left-multiplying M by a product of elementary lower-bidiagonal

matrices, and can thus be expressed algebraically as

EN+1,1(-1,0)EN+1,2(-2,0) · · · EN+1,N (-N,0)RN+1M =

10 0 M1

,

(2.51)

where: EN+1,n(x) is the elementary bidiagonal matrix of size N + 1 with (n, n - 1)entry x, 1s on the diagonal, and 0s everywhere else; RN+1 is some matrix of size N + 1 that encodes a permutation of rows; and

i,0 =

m0i,0 m0i-1,0
0

if m0i,0 = 0, if m0i,0 = 0

(2.52)

is a ratio of pivots of M . The entries m1i,0 in the k = 0 column of M1 = (m1n,k)0n,kN-1 are the (i, 1) pivots
of M . Reducing the zeroth column of M1 to 0s everywhere except on the diagonal in the manner described above (that is, rearranging rows and successively subtracting
them from each other) yields

1

0

0 EN,1(-1,1)EN,2(-2,1) · · · EN,N-1(-N-1,1)RN

· EN+1,1(-1,0)EN+1,2(-2,0) · · · EN+1,N (-N,0)RN+1M =

I2 0 0 M2

(2.53)

where M2 = (m2n,k)0n,kN-2 is a matrix of size N - 1 and

i,1 =

m1i,0 m1i-1,0
0

if m1i,0 = 0, if m1i,0 = 0

(2.54)

is a ratio of pivots of M1. Proceeding iteratively on smaller and smaller matrices we obtain, after a finite
number of steps, the identity

IN -1

0

0 E2,1(-1,N-1)

·

IN -2

0

0 E3,1(-1,N-2)E3,2(-2,N-2)R3

· · · EN+1,1(-1,0)EN+1,2(-2,0) · · · EN+1,N (-N,0)RN+1M = IN+1,

(2.55)

equivalently,

RN-1+1EN+1,N (N,0) · · · EN+1,2(2,0)EN+1,1(1,0)·

1 0

0 RN-1EN,N-1(N-1,1) · · · EN,1(1,1)

···

IN -2

0

0 R3-1E3,2(2,N-2)E3,1(1,N-2)

IN -1

0

0 E2,1(1,N-1)

= M. (2.56)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 19

Figure 7. The binomial-like planar network obtained using Neville elimination.

where each i,j is a ratio of pivots obtained at each step of the algorithm:

i,j

=

mji,0 mji-1,0

.

(2.57)

We call the factorisation of M obtained in this way the Neville factorisation of M . Gasca and Pen~a showed in [30] that the matrix M is totally positive if and only if
Rj = Ij for all j (that is, Neville elimination can be applied to M without ever interchanging rows at any stage of the algorithm), and the pivots of M are all nonnegative (the same result can also be found in Chapter 6 of Pinkus' book [51], although Neville elimination is not treated explicitly there).
We can translate the Neville factorisation of M into the language of planar networks. If M is totally positive then it follows from (2.56) that

EN+1,N (N,0) · · · EN+1,2(2,0)EN+1,1(1,0) ·

···

IN -2

0

0 E3,2(2,N-2)E3,1(1,N-2)

1

0

0 EN,N-1(N-1,1) · · · EN,1(1,1)

IN -1

0

0 E2,1(1,N-1)

= M, (2.58)

where every pivot i,j is nonnegative. We can easily construct a planar network representation NM of this factorisation (see Figure 7); the network we obtain is simply the standard binomial-like planar network with n,k = 1 and n,k = n,k. We call the planar network NM obtained using Neville elimination the Neville network corresponding to M .
We have already seen how to interpret such planar networks as production-like and quasi-production-like factorisations. By reading the network as a product of column transfer matrices we obtain the production-like factorisation

M=

IN -1

0

0 L2(bN-1)

···

10 0 LN (b1)

LN +1 (b0 )

(2.59)

20

T. GILMORE

where LN+1-i(bi) is the finite lower-bidiagonal matrix of size N + 1 - i with corresponding finite edge sequence

bi = (i+1,n)0nN-1-i.

(2.60)

Similarly, by reading the network as a product of diagonal transfer matrices we obtain

the quasi-production-like factorisation

M = TN+1(b0)

10 0 TN (b1)

···

IN -1

0

0 T2(bN-1)

.

(2.61)

where

bj = (n,j )1nN-j .

(2.62)

We note that the quasi-production-like factoristion above can be obtained di-

rectly from the products of elementary bidiagonal matrices in (2.58), since according

to (2.35) we have

Ij

0

0 EN-j+1,N-j (N-j,j ) · · · EN-j+1,1(1,j )

=

Ij

0

0 TN-j+1(bj)

.

(2.63)

The production-like factorisation, on the other hand, can be obtained from (2.58) by commuting elementary bidiagonal matrices. We have

Ii

0

0 EN-i+1,N-i(N-i,i) · · · EN-i+1,1(1,i)

= EN+1,N (N-i,i) · · · EN+1,i+1(1,i),

(2.64)

and since EN,n1(x)EN,n2(x) = EN,n2(x)EN,n1(x) for n2 > n1 + 1 it follows that we can commute elementary bidiagonal matrices in (2.58), thereby obtaining

[EN+1,N (N,0) · · · EN+1,2(2,0)EN+1,1(1,0)] · [EN+1,N (N-1,1) · · · EN+1,2(1,1)] · · · [EN+1,N (2,N-2)EN+1,N-1(1,N-2)][EN+1,N (1,N-1)] = [EN+1,N (N,0)][(EN+1,N-1(N-1,0)EN+1,N (N-1,1)] · · · [EN+1,1(1,0)EN+1,2(1,1) · · · EN+1,N (1,N-1)]. (2.65)
The right-hand side agrees with that of (2.59) since

[EN+1,i+1(i+1,0)EN+1,i+2(i+1,1) · · · EN+1,N (i+1,N-i-1)] =

Ii

0

0 LN-i+1(bi)

.

(2.66)

Neville elimination can easily be applied to a unit-lower-triangular matrix M with

entries that belong to the polynomial ring Z[x], though the resulting factorisation

may well consist of matrices with entries that belong to the field Q(x) of rational

functions of x. The planar network N1 described in Section 4 below (see Figure 8) that we use to prove the pointwise total positivity of the q-forests matrix is the Neville

network for the matrix F (q) = (fn,k(q))n,k1. By transforming this Neville network into a different planar network with weights that are polynomials in q we eventually

show in Section 5 that F(q) is coefficientwise totally positive in Z[q].

Determining binomial-like planar networks via Neville elimination can be incredibly

useful if the set of pivots are of a "nice" form from which a general pattern is easy

to guess; however, often when attempting to construct planar networks for suspected

totally positive matrices6 one finds oneself with a set of rational expressions for the

6Such as, for example, the maddeningly stubborn Eulerian triangle, which was conjectured by Brenti [6] to be totally positive over a quarter of a century ago.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 21
pivots that are difficult to make any sense of at all. Luckily, in the case of the forests and the trees matrices the pivots were of a general form that was easy to understand.
We have now established all of the fundamental concepts required to prove our main result (Theorem 1.2). In the next section we will interpret the entries of the q-forests matrix and the q-trees matrix combinatorially, and prove some matrix identities relating them.

3. Combinatorial interpretations of the entries of the q-forests and q-trees matrices, and some identites relating them
The entries of the matrices F(q) and T(q) are polynomials in q that count trees or forests according to some statistic, and it is natural to try to interpret what that statistic might be. We present one such interpretation in the following two subsections, before considering some identities relating F(q) and T(q).

3.1. A combinatorial interpretation of the entries of F(q) We begin with the q-forests matrix

F(q) =

n-1 k-1

([n]q )n-k
q

n,k0

(3.1)

which counts forests on n vertices with k-components. Let Fn,k denote the set of such forests for given n, k and consider a forest F  Fn,k. The vertices of F can be partitioned into three subsets:

where

Vr(F )  Vs(F )  Vt(F )

(3.2)

Vr(F ) := {v  F : v is a root of a component}, Vs(F ) := {v  F : v is a lowest-numbered child of a root}, Vt(F ) := {v  F : v is neither a root, nor a lowest-numbered child of a root}.

We now describe one way in which to assign weights to the vertices in Vr(F ), Vs(F ), and Vt(F ).
For each vertex v in Vr(F ) define

Vr(F, v) := {v : v / Fr, v < v}

(3.3)

to be the set of nonroot vertices in F that are lower-numbered than a root vertex v. Each root v  Vr(F ) is then given the weight

wt(v) = r|Vr(F,v)|

(3.4)

and for a forest F  Fn,k define7

niblings(F ) :=

|Vr(F, v)|.

vVr(F )

(3.5)

For the vertex vmin (if it exists), we consider the roots v0, v1, . . . , vk-1  Vr(F ) where

v0 < v1 < · · · < vk-1.

(3.6)

7The portmanteau "niblings" is a combination of nephews/nieces and siblings.

22

T. GILMORE

The vertex vmin is the child of one of v0, . . . , vk-1, so we assign vmin the weight

wt(vmin) = sj,

(3.7)

where vj is the parent of vmin (we say that j is the smallest child index of F and denote it scindex(F )).
Lastly, for each vertex v in Vt(F ) set

wt(v) = tparent(v)-1,

(3.8)

where parent(v) denotes the label of the parent of v, and define

parents(F ) :=

parent(v).

(3.9)

vVt(F )

Putting the above together in one place we have for a vertex v in F :

r|Vr (F,v)|  wt(v) := sscindex(F )
tparent(v)-1

v  Vr(F ), v = vmin, v  Vt(F ).

(3.10)

We then define the weight of a forest to be the product of the weights of its vertices:

wt(F ) :=

wt(v) = rniblings(F )sscindex(F )tparents(F )-n+k,

(3.11)

vF
and note that if n = k we have wt(F ) = 1.

Proposition 3.1. For the set Fn,k of forests on n vertices comprised of k components with n > k we have

rniblings(F )sscindex(F )tparents(F )-n+k =
F Fn,k

n k

[k]s([n]t)n-k-1.
r

(3.12)

Our proof below is an extension of the first proof of Proposition 5.3.2 given by Stanley in [69], and we are very grateful to Bishal Deb for pointing it out.

Proof. A forest F  Fn,k consists of a root set Vr(F ), and a subforest attached

to the roots consisting of the vertices Vt(F )  Vs(F ). We construct a sequence 1, 2, . . . , n-k+1 of subforests of F (all with root set Vr(F )) in the following way: set 1 = F . If i < n - k + 1 and i is defined then let i+1 be the subforest obtained from

i by removing its largest nonroot endpoint vi (together with the edge incident to it). Let pi be the unique vertex of i adjacent to vi and consider the Pru¨fer sequence (or Pru¨fer code, see [54]) of the subforest of F that arises from removing all vertices in

Vt(F ) in this way,

(F ) := (p1, p2, . . . , pn-k).

(3.13)

Note that for i < n - k, pi  [n], while pn-k  Vr(F ), so the number of such sequences is knn-k-1.

Now let Fn,Vr denote the set of forests with a specified root set Vr of size k. The map from forests to Pru¨fer sequences described above

 : Fn,Vr  [n]n-k-1 × Vr

(3.14)

is a bijection (see [69, Proposition 5.3.2]).8 Our aim is to understand the contribution

of the weights from the vertices in terms of these Pru¨fer sequences and root sets.

8Please note that here [n]n-k-1 denotes the cartesian product of the set [n] with itself n - k - 1 times.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 23

Each subforest on the vertices Vt(F )  Vs(F ) has a unique Pru¨fer sequence

(p1, p2, . . . , pn-k-1, pn-k),

(3.15)

and the first n - k - 1 elements of the sequence correspond to vertices with weights (tp1-1, tp2-1, . . . , tpn-k-1-1). The weight of all sequences (p1, p2, . . . , pn-k-1) is thus ([n]t)n-k-1. It is easy to see that the element pn-k is the parent of vmin, and since vmin has weight sl for 0  l  k - 1 (according to the definition of the weight function),
the weight of the set of subforests with root set Vr is

[k]s([n]t)n-k-1.

(3.16)

What remains is to show that the weight of all possible root sets is

n .
kr

(3.17)

Given a set of k root vertices Vr chosen from [n], form the word w = w1w2 . . . wn of length n on the alphabet {0, 1}, containing 0s at positions v1, . . . , vk  Vr and 1s everywhere else. The weight we assign to each vertex vi  Vr then corresponds to the number of 1s preceding the 0 at position wvi, so counting root sets with the weighting specified above is equivalent to counting all words w with respect to the number of
inversions in w (an inversion is a pair (i, j) such that wi = 1, wj = 0, and i < j). This is a well-known interpretation of the r-binomial coefficient:

n .
kr

(3.18)

The above proposition might invite one to consider the more general matrix

F(r, s, t) := (fn,k(r, s, t))n,k0 with (n, k)-entry given by

(3.19)

fn,k(r, s, t) =

n k

[k]s([n]t)n-k-1,
r

but alas, the first few rows of this matrix are:

(3.20)

1



0

1



 

0

r+1

1

 

 0 (r2 + r + 1) (t2 + t + 1) (r2 + r + 1) (s + 1) 1 





...

...

...

... . . .

(3.21)

which is not even coefficientwise TP2 in Z[r, s, t] since

f2,1(r, s, t)f3,2(r, s, t) - f3,1(r, s, t)f2,2(r, s, t) = (1 + r + r2)(s + r(1 + s) - t(1 + t)) 0 (3.22)

In fact it seems the only way to ensure that F(r, s, t) is coefficientwise totally positive is to set r = s = t = q, thereby reducing F(r, s, t) to the q-forests matrix F(q). We conclude:

24

T. GILMORE

Corollary 3.2. For the q-forests matrix F(q) = (fn,k(q))n,k0 we have

fn,k(q) =

qniblings(F )+scindex(F )+parents(F )-n+k,

F Fn,k

(3.23)

where Fn,k denotes the set of forests on n vertices with k components.

Having established this combinatorial interpretation of the entries of F(q) we now turn to the q-trees matrix.

3.2. A combinatorial interpretation of the entries of T(q) The entries of the q-trees matrix

T(q) =

n k

([n]q )n-k
q

n,k0

(3.24)

count rooted trees on n + 1 vertices with k children smaller than the root with respect
to some statistic. In [7, Lemma 2], however, the authors give a bijection between the set of all such trees and the set of forests Fn+1,k+1 on the vertex set [n + 1] comprised of k + 1 components where n + 1 is a leaf (note that a root with no children is also a leaf); we therefore interpret the entries of T(q) as enumerating forests in Fn+1,k+1 with respect to certain statistics.
We can can construct the set Fn+1,k+1 in the following way: either take the set Fn,k+1 of forests on n vertices with k + 1 components, and for each forest F  Fn,k+1 attach the vertex n + 1 as a leaf to any of the vertices in F (there are n ways to
do this); or take the set of forests Fn,k on n vertices with k components and to each F  Fn,k attach the vertex n + 1 as a singleton component. It follows that

|Fn+1,k+1| = n|Fn,k+1| + |Fn,k| = n

n-1 k

nn-k-1 +

n - 1 nn-k = k-1

n nn-k. k

(3.25)

If we weight the forests in Fn+1,k+1 according to (3.11) in the previous subsection then it is not difficult to see that

rniblings(F )sscindex(F )tparents(F )-n+k =
F Fn+1,k+1

n k+1

[k + 1]s([n]t)n-k-1
r

+ rn-k

n k

[k]s([n]t)n-k-1
r

(3.26)

since the weight of the set of forests where n + 1 is a leaf, but not a component, is

[n]t

rniblings(F )sscindex(F )tparents(F )-n+k+1 =

F Fn,k+1

n k+1

[k + 1]s([n]t)n-k-1
r

(3.27)

(we obtain a multiplicative factor of tparent(n+1)-1 each time we attach n + 1 as a leaf

to a leaf of a component, and each possible parent of n + 1 is an element of [n] in

a forest F  Fn,k+1) and the weight of the set of forests where n + 1 is a singleton component is

rn-k

rniblings(F )sscindex(F )tparents(F )-n+k = rn-k

F Fn,k

n k

[k]s([n]t)n-k-1
r

(3.28)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 25

(since all nonroot vertices of F  Fn,k are smaller than n + 1, and this corresponds to appending a 0 to the word obtained from the root set Vr(F ) described in the proof of Proposition 3.1). Letting

T(r, s, t) := (tn,k(r, s, t))n,k0 = ([n]t)n-k we have:

rn-k

n

k

[k]s + [k + 1]s
r

n
k+1 r (3.29)

Lemma 3.3. The entries of T(r, s, t) satisfy

tn,k(r, s, t) =

rniblings(F )sscindex(F )tparents(F )-n+k.

F Fn+1,k+1

(3.30)

The first few rows of T(r, s, t) are:



1

1



(r + 1)(t + 1)

 

r2 + r + 1

t2 + t + 1 2

...

1 r2 + r + s + 1 r2 + r + 1 t2 + t + 1 r2 + s + 1
...

which contains the 2 × 2 minor



1



r3s + r2s + r3 + r2 + rs + r + s2 + s + 1 1

 

...

... . . .

(3.31)

t1,0(r, s, t)t2,1(r, s, t) - t2,0(r, s, t)t1,1(r, s, t) = r2 + s - t - rt 0,

(3.32)

so T(r, s, t) is not even coefficientwise TP2 in Z[r, s, t]. Again, it seems the only way to restore total positivity is to specialise r = s = t = q, in which case

tn,k(q, q, q) = ([n]q)n-k-1

qn-k

n k

[k]q + [k + 1]q
q

n k+1

q

=

n k

([n]q)n-k-1(qn-k[k]q + [n - k]q) = ([n]q)n-k
q

n k

q

= tn,k(q).

(3.33)

We thus have:

Corollary 3.4. The entries of the q-trees matrix T(q) = (tn,k(q))n,k0 satisfy

tn,k(q) =

qniblings(F )+scindex(F )+parents(F )-n+k =

F Fn+1,k+1

n k

([n]q )n-k
q

(3.34)

where Fn+1,k+1 denotes the set of forests on n + 1 vertices with k + 1 components, in which the vertex n + 1 is a leaf.

It is safe to say that the statistics defined above are quite unconventional, arising from inserting q-weights into the Pru¨fer sequence for trees and forests. In [21] the authors provide an alternative method for encoding weighted trees that is more refined than that of Pru¨fer; a closer examination of this weight-preserving bijection in relation to q-forests and q-trees matrices will form part of future work on these matrices. For the time being we will turn our attention to some identities relating the matrices F(q) and T(q).

26

T. GILMORE

3.3. Some identities involving F(q) and T(q) We have already seen in Section 1 that the entries of the forests matrix

F := (fn,k)n,k0 =

n - 1 nn-k

k-1

n,k0

and the entries of the trees matrix

T := (tn,k)n,k0 =

n nn-k

k

n,k0

satisfy for n > 0. We therefore have:

k fn,k = n tn,k

(3.35) (3.36) (3.37)

Lemma 3.5. The matrices F and T satisfy

F = lim diag((n + )n0)-1T diag((n + )n0). 0

(3.38)

The above lemma shows that the total positivity of T implies that of F, however, by observing that tn,0 = tn,1 we also obtain the following identity:

Lemma 3.6. The matrices F and T satisfy

T = lim diag((n + )n0)F diag((n + )n0)-1E0(1) 0
where E0(1) is the elementary bidiagonal matrix.

(3.39)

Proof. This follows from Lemma 3.5 and observing that right multiplying a matrix with E0(1) corresponds to adding column 1 to column 0.

We conclude that total positivity of F implies that of T, but there are yet more identities to uncover. By observing that

fn+1,k+1 =

n (n + 1)n-k = k

we obtain:

n n-k n - k nn-k-l

k

l

l=0

nn =
l
l=k

l nn-l = n k

l k tn,l (3.40)

l=k

Lemma 3.7. The matrices F and T satisfy

F=

10 0 TB

where B is the weighted binomial matrix Bx,y with x = y = 1,

B :=

n .
k n,k0

Combining Lemmas 3.5­3.7 yields the curious dual identities below:

(3.41) (3.42)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 27

Corollary 3.8. The matrices F and T satisfy

F=

1

0

0 lim 0 diag((n + )n0)F diag((n + )n0)-1E0(1)B

and

T = lim diag((n + )n0) 0

10 0 TB

diag((n + )n0)-1E0(1).

(3.43) (3.44)

But what of the more general matrices F(q) and T(q)? In order to understand how the q-forests and q-trees matrices are related we first present some well-known identities concerning q-binomial coefficients.
The q-binomial coefficient satisfies the dual recurrences:

n

n

=

= n - 1 + qk n - 1

kq

n-k q

k-1 q

kq

(3.45)

and

n

n

=

= qn-k n - 1

n-1 +

kq

n-k q

k-1 q

kq

(3.46)

(see [2, equations (3.3.3) and (3.3.4)], for example). Combining (3.45) and (3.46)

above we obtain

n-1

1 - qk n

=

,

k - 1 q 1 - qn k q

(3.47)

so it follows that for the q-forest numbers

and the q-trees numbers

fn,k(q) =

n-1 k-1

([n]q )n-k
q

(3.48)

tn,k(q) =

n k

([n]q )n-k
q

n,k0

we have

fn,k(q)

=

[k]q [n]q

tn,k(q)

for n  1. We therefore have a direct q-generalisation of Lemma 3.5:

(3.49) (3.50)

Lemma 3.9. The matrices F(q) and T(q) satisfy

F(q) = lim diag(([n]q + )n0)-1T(q) diag(([n]q + )n0) 0

(3.51)

By observing that tn,0(q) = tn,1(q) we also obtain a q-generalisation of Lemma 3.6:

Lemma 3.10. The matrices F(q) and T(q) satisfy

T(q) = lim diag(([n]q + )n0)F(q) diag(([n]q + )n0)-1E0(1). 0

(3.52)

Since the entries of diag(([n]q + )n0)-1 are rational functions of q, Lemma 3.9 shows that the pointwise total positivity of F(q) implies that of T(q), and vice versa (also, note that Lemma 3.10 shows that the pointwise total positivity of F(q) implies that of T(q)). It follows that to show both of these matrices are pointwise totally positive (Corollary 4.3 below) it suffices to prove that one of them is. Neither of the

28

T. GILMORE

above lemmas, however, are of any help when considering the coefficientwise total positivity of our matrices.
We have one more simple identity that shows the coefficientwise total positivity of F(q) implies the coefficientwise total positivity of T(q). It turns out that T(q) can be obtained by right-multiplying F(q) with a simple inverse lower-bidiagonal matrix with entries that are polynomials in q.

Lemma 3.11. The matrices F(q) and T(q) satisfy

T(q) = F(q)T (a(q)),

(3.53)

where T (a(q)) is the inverse bidiagonal matrix with edge sequence

a(q) = (qn[n + 1]q)n0.

(3.54)

Proof. Since T (a(q)) is the inverse of the lower-bidiagonal matrix L(-a(q)) (Corollary 2.6 above), proving (3.53) is equivalent to showing that

F(q) = T(q)L(-a(q)),

(3.55)

where L(-a(q)) is a lower-bidiagonal matrix with 1s on the diagonal, (n, n - 1)-entry

- qn[n + 1]q

(3.56)

and all other entries 0. We have

(T(q)L(-a(q)))n,k =

n k

[n]nq -k - qk[k + 1]q
q

n k+1

[n]nq -k-1
q

(3.57)

which clearly reduces to nk for k = 0. For k > 1 the right-hand side reduces, via the dual recurrences (3.45) and (3.46), to

[n]nq -k

n - qk n - 1

kq

kq

=

n-1 k-1

[n]nq -k
q

=

fn,k(q),

completing the proof.

(3.58)

The matrix T (a(q)) in the above lemma is clearly coefficientwise totally positive, so it follows from Lemma 3.11 that in order to prove that T(q) is coefficientwise totally positive it suffices to show that F(q) is coefficientwise totally positive. We were unable to find a similar identity that proves the coefficientwise total positivity of T(q) implies that of F(q), and this is why we focus on the matrix F(q) in the sequel.
In the next section we describe how to specialise the weights of the binomial-like network to rational functions of q, and show that the corresponding path matrix agrees with F(q). In Section 5 we show how this network can be transformed into a different network with weights that are polynomials in q, thus proving that F(q) (and therefore T(q)) is coefficientwise totally positive in Z[q].

4. Pointwise total positivity of the q-forests and q-trees matrices
Recall the binomial-like network N with edge weights  and  described in Section 2. This section is devoted to showing how specialising the weights  and  to pointwise nonnegative elements of the field Q(q) (that is, the fraction field of the polynomial ring Z[q]) yields a path matrix that agrees with F(q), from which the pointwise total positivity of F(q) (and thus, T(q)) trivially follows. We then present the production-like and quasi-production-like factorisations of F(q).

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 29

Figure 8. The binomial-like network N1 up to u4 and v4.

4.1. The planar network N1 We begin by observing that since

F(q) =

10 0 F (q)

(4.1)

where

F (q) := (fn+1,k+1(q))n,k0 =

n k

([n + 1]q)n-k,
q

(4.2)

the pointwise (and indeed, coefficientwise) total positivity of F(q) is trivially equiva-

lent to that of F (q).

Now let N1 denote the binomial-like planar network N in which

i,l = 1

(4.3)

and

i,l = ql[i]q

[i + l + 1]q [i + l]q

i

(4.4)

(see Figure 8). Observe that since N1 is a binomial-like network in which the horizontal edges have weight 1 it must be a Neville network for some unit-lower-triangular

matrix. We make the following proposition:

Proposition 4.1. The path matrix matrix PN1 satisfies

PN1 = F (q).

(4.5)

Please note that by relabelling the source vertices un  un+1 and vk  vk+1, and
inserting a new source vertex u0 at the bottom of N1 connected via a horizontal edge of weight 1 to a new sink vertex v0, we obtain the planar network N1 with

corresponding path matrix

PN1 =

10 0 PN1 .

(4.6)

30

T. GILMORE

Since the weights of N1 are nonnegative for q  R+, the pointwise total positivity of F(q) (and therefore also T(q) according to Lemma 3.11) follows from Proposition 4.1. The author would like to point out that he is very grateful to Xi Chen and Shaoshi Chen for discovering a proof of Proposition 4.1 with q specialised to q = 1, which inspired what follows.
Our proof of Proposition 4.1 arises from considering directly the sum over weighted paths in the network N1 from un to vk:

PN1(un  vk) =

[i1]q

1i1 <···<in-k n

[k + 2]q

i1
qk-i1+1

[k + 1]q

· · · [in-k]q

[n + 1]q [n]q

in-k
qn-in-k

(4.7)

(see (2.12), where the i,ls have been replaced with the weights defined in (4.4)). Proving Proposition 4.1 amounts to showing that the right-hand side of (4.7) equals

n-1 k-1

([n]q )n-k .
q

(4.8)

Since the nested sum in (4.7) is somewhat complicated, in order to make better sense of it we first prove the following lemma:

Lemma 4.2. Given integers n, m, t with 0  m < n and 0  t < n - m we have

n-m
qn-m-s[s]q
s=t+1

[n + 1]q [n - m]q

s

n-s

n-t

m

= [n + 1]q
q

m+1

q

[n + 1]q [n - m]q

t
. (4.9)

Proof of Lemma 4.2. It is easy to verify (4.9) for t = n - m - 1 so suppose it holds for t  n - m - 1 and consider the case t - 1. We have

n-m
qn-m[s]q
s=t

[n + 1]q q[n - m]q

s

n-s m

q

=

[t]q q n-m

[n + 1]q q[n - m]q

t

n-t mq

n-t + [n + 1]q m + 1 q

[n + 1]q [n - m]q

t
, (4.10)

the right-hand side of which can be written

[n + 1]q [n - m]q

t

[t]q

qn-m-t n - t + mq

n-t m+1 q

+

qt[n

-

t

-

m]q

[n + 1 - t]q [n - t - m]q

n-t m+1 q

. (4.11)

The dual recurrences for q-binomial coefficients (3.45) and (3.46) then reduce (4.11)

to

[n + 1]q [n - m]q

t

n-t+1

m+1

[n - m]q,
q

(4.12)

which agrees with the right-hand side of (4.9) when t is replaced with t - 1.

With Lemma 4.2 in hand we are now ready to prove Proposition 4.1.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 31

Proof of Proposition 4.1. We will show that

PN1(un  vk) =

n k

([n + 1]q)n-k,
q

(4.13)

where PN1(un  vk) denotes the sum over weighted directed paths in N1 starting at un and ending at vk. According to (4.7) we have

PN1(un  vk) =

[i1]q

1i1 <···<in-k n

[k + 2]q

i1
qk-i1+1

[k + 1]q

· · · [in-k]q

[n + 1]q [n]q

in-k
qn-in-k . (4.14)

The nested sum (4.14) can be expressed recursively. Let

n

Sn-k :=

[in-k ]q

in-k =in-k-1 +1

and for 1  m  n - k - 1 define

[n + 1]q

in-k
qn-in-k ,

[n]q

(4.15)

n-m

Sn-k-m :=

[in-k-m]q

in-k-m =in-k-m-1 +1

so that in particular

[n + 1 - m]q q[n - m]q

in-k-m
qn-mSn-k-m+1, (4.16)

PN1 (un  vk) = Sn-k-m|m=n-k-1,i0=0

(4.17)

(where Sn-k-m|m=n-k-1,i0=0 denotes the right-hand side of Sn-k-m where m is replaced with n - k - 1 and i0 = 0). We make the following claim:
Claim. For 0  m  n - k - 1 we have

Sn-k-m = ([n + 1]q)m+1

n - in-k-m-1 m+1

q

[n + 1]q

in-k-m-1
.

[n - m]q

(4.18)

To prove (4.18) we first observe that since

n

Sn-k =

[in-k ]q

in-k =in-k-1 +1

[n + 1]q

in-k
qn-in-k

n - in-k

[n]q

0

q

(4.19)

(remember

n 0

q

=

1),

the

claim

clearly

holds

for

m

=

0

by

virtue

of

Lemma

4.2.

Suppose then (4.18) holds for m  0 and consider the case m1 = m + 1. Then

Sn-k-m1

n-m1

=

[s]q

s=t+1

[n + 1 - m1]q q[n - m1]q

s
qn-m1 Sn-k-l

n-m1-s

= [n + 1]mq 1

qn-m1 [s]q

s=t+1

[n + 1]q [n - m1]q

s

n-s m1 q

(4.20) (4.21)

by the induction hypothesis (where we have replaced in-k-m-1 and in-k-m-2 with s and t respectively). Applying Lemma 4.2 to (4.21) then proves the claim (4.18).

32

T. GILMORE

Substituting m = n-k-1 and i0 = 0 in the right-hand side of (4.18)) for n  k  0 yields

PN1(un  vk)

=

([n + 1]q)n-k

n n-k

q

=

n k

([n + 1]q)n-k,
q

(4.22) (4.23)

completing the proof.

The above proposition immediately implies the following corollary:

Corollary 4.3. The matrices F(q) and T(q) are pointwise totally positive for q specialised to q  R+.
Proof. According to Proposition 4.1 the matrix F (q) is the path matrix corresponding to a planar network with weights that are rational functions of q. Each weight in N1 is pointwise totally positive for q  R+, so according to the LGV lemma (see Subsection 2.1) F (q) is pointwise totally positive for q  R+. Since pointwise total positivity of F(q) is trivially equivalent to that of F (q), the matrix F(q) is pointwise totally positive. We have already seen in Section 3 (see Lemma 3.11, for example) that pointwise total positivity of F(q) implies that of T(q), so T(q) and F(q) are pointwise totally positive.

Of course for q specialised to q = 1, Corollary 4.3 proves that both the trees matrix T and the forests matrix F are totally positive (Theorem 1.1). Moreover, the planar network in Figure 8 implies, via Proposition 4.1, a matrix factorisation of F (q) and hence a factorisation of F(q). Indeed, we can obtain two such factorisations depending on whether we view N1 as a concatenation of column transfer matrices (yielding a production-like factorisation, see Corollary 2.4 above), or a concatenation of diagonal column transfer matrices (yielding a quasi-production-like factorisation, see Corollary 2.7 above).

Corollary 4.4. The matrix F(q) has the production-like factorisation

F(q) = · · ·

I3

0

0 L(a2(q))

·

I2

0

0 L(a1(q))

·

I1

0

0 L(a0(q))

(4.24)

where L(ai(q)) is the lower-bidiagonal matrix with corresponding edge sequence

ai(q) =

qn[i + 1]q

[n + i + 2]q [n + i + 1]q

i+1

.

n0

(4.25)

We will use the above matrix factorisation in our proof of Theorem 1.2, however, we also remark that F(q) also has a quasi-production-like factorisation (thanks to Corollary 2.7):

Corollary 4.5. The matrix F(q) has the quasi-production-like factorisation

F(q) =

10 0 T (a0(q))

·

I2

0

0 T (a1(q))

·

I3

0

0 T (a2(q))

···

(4.26)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 33

where T (al (q)) is the inverse bidiagonal matrix with corresponding edge sequence

al (q) :=

ql+1[n + 1]q

[n + l + 3]q [n + l + 2]q

n+1

.

n0

(4.27)

Having established the pointwise total positivity of the q-forests and q-trees matrix
via the planar network N1, in the next section we will show how N1 can be transformed into a different planar network with weights that are polynomial in q, from which the coefficientwise total positivity of F(q) and T(q) follows.

5. Coefficientwise total positivity of the q-forests and q-trees matrices

We now present a different planar network with weights that are polynomials in q and show that its corresponding path matrix can be transformed into the productionlike factorisation of F(q) from the previous section.
Let N2 denote the planar network in Figure 9. Observe that this network does not have the structure of the binomial-like network that we have considered up to this point, nonetheless we can still apply the tools from Section 2 to understand the corresponding path matrix. In particular we will repeatedly make use of Lemma 2.9, so for ease of reading we recall it here:

Lemma (Lemma 2.9 above). Suppose a = (an)n0 and b = (bn)n0 are sequences of elements belonging to a field F . Then

(i) If an = -bn for all n then L(a)T (b) = I; (ii) If an + bn = 0 for all n then

L(a)T (b) =

10 0 T (b )

· L(a )

(5.1)

where a = (an)n0 is the edge sequence in which

an :=

a0 + b0
an-1 (an +bn ) an-1 +bn-1

if n = 0, if n > 0,

(5.2)

and b = (bn)n0 is the edge sequence in which

bn

=

bn(an+1 + bn+1) . an + bn

(5.3)

Consider a subnetwork Ci of N2 depicted in Figure 9. The column transfer matrix corresponding to each subnetwork is

PCi =

Ii+1

0

0 L(ai(q))T (bi(q))

(5.4)

where L(ai(q)) and T (bi(q)) are lower-bidiagonal and inverse lower-bidiagonal matrices (respectively) with corresponding edge sequences

ai(q) = (qi+n+1[i + 1]q)n0

(5.5)

and bi(q) = (qi[n + 1]q)n0.
The path matrix corresponding to N2 has the factorisation

(5.6)

PN2 = · · · PC2 PC1 PC0

(5.7)

34

T. GILMORE

Figure 9. The planar network N2 up to source u6 and sink v6. Note that the dashed red lines do not form part of the network, they simply delineate the column transfer matrices of N2. Also note that the direction of the edges have been omitted, the reader should assume all edges are directed from left to right.

We make the following proposition:

Proposition 5.1. The path matrix for N2 satisfies

PN2 = F(q).

(5.8)

Before beginning the proof proper we first outline our approach. The factorisation of PN2 in (5.7) is of the form

· · · (L4T4)(L3T3)(L2T2)(L1T1),

(5.9)

where Li denotes a lower-bidiagonal matrix L downshifted by i:

Li =

Ii 0 0L

,

(5.10)

and similarly Ti denotes an inverse lower-bidiagonal matrix T downshifted by i:

Ti =

Ii 0 0T

.

(5.11)

Applying Lemma 2.9 to the rightmost product L1T1 we obtain

L1T1 = T2L1,

(5.12)

where T2 is an inverse lower-bidiagonal matrix downshifted by 2 and L1 a lowerbidiagonal matrix downshifted by 1. The factorisation in (5.9) can therefore be ex-
pressed as

· · · (L4T4)(L3T3)(L2T2T2)L1.

(5.13)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 35

More generally, Lemma 2.9 enables us to "pull" lower-bidiagonal matrices "through" inverse lower-bidiagonal matrices to the right (compare Figure 6 with Figure 9), so that in particular for a given i > 0 the factorisation in 5.9 can be written in the form

· · · (Li+2Ti+2)

i
Li+1Ti+1 Ti+1,j
j=1

LiLi-1 · · · L1

(5.14)

where each Ti+1,j is an inverse bidiagonal matrix downshifted by i + 1, and each Li is a lower-bidiagonal matrix downshifted by i. It is clear that in the limit (as i  )
the inverse lower-bidiagonal matrices disappear, and what remains is a factorisation
of PN2 into downshifted lower-bidiagonal matrices:

PN2 = · · · L4L3L2L1.

(5.15)

We will show that this resulting factorisation of PN2 agrees with the production-like factorisation of F(q) given in Corollary 4.4 of the previous section.

Proof of Proposition 5.1. It is easy to see that the matrices agree in the first column,

since

PN2(un  v0) = n0 = fn,0(q),

(5.16)

so consider again the matrix

F (q) := (fn,k(q))n,k0 =

n k

([n + 1]q)n-k
q

n,k0

(5.17)

and let N2 denote the planar network obtained by removing from N2 vertices u0, v0 and relabelling vertices ui  ui-1, vi  vi-1 for i > 0 (the corresponding path matrix
PN2 is thus obtained by deleting the first row and column of PN2). As described above, we will prove (5.8) by repeatedly applying Lemma 2.9 to the
matrix factorisation of PN2, thereby expressing PN2 as a product of lower-bidiagonal matrices that agree with those given in Corollary 4.4. To this end, fix i  0 and
consider the product

PCi · · · PC1 PC0 = where

Ii

0

0 L(ai(q))T (bi(q))

···

1

0

0 L(a1(q))T (b1(q))

·L(a0(q))T (b0(q))

(5.18)

ai(q) = (qi+n+1[i + 1]q)n0

(5.19)

and

bi(q) = (qi[n + 1]q)n0

(5.20)

(each matrix PCi is obtained by deleting the first row and column from PCi defined in (5.4) above).
Claim 1. We claim that

PCi · · · PC1 PC0 = where

Ii+1 0 0 Ti(q)

·

Ii

0

0 L(ci(q))

···

10 0 L(c1(q))

L(c0(q))

(5.21)

i
Ti(q) = T (bi,j(q))
j=0

(5.22)

36

T. GILMORE

is a product of inverse bidiagonal matrices with corresponding edge sequences

bi,j(q) :=

qi-j[n + 1]q

[n + i + 3]q [n + i + 2]q

j+1

n0

(5.23)

and each L(ci(q)) is the lower-bidiagonal matrix with edge sequence

ci(q) =

qn[i + 1]q

[n + i + 2]q [n + i + 1]q

i+1

.

n0

(5.24)

Please note that the lower-bidiagonal matrices L(ci(q)) are obtained by deleting the first row and column of the matrices found in the production-like factorisation of F(q)

in Corollary 4.4 above, so proof of the proposition follows once we have proved the

claim (since (5.21) implies that for 0  n  i + 1, each (n, k)-entry of PCi · · · PC1PC0 agrees with that of F (q)).

First observe that we can apply Lemma 2.9 to the product L(ai(q))T (bi(q)) in PCi, yielding

PCi =

Ii+1

0

0 T (bi(q))

·

Ii

0

0 L(ai(q))

(5.25)

where

ai(q) :=

qi+n[i + 1]q[n + i + 2]q [n + i + 1]q

,
n0

(5.26)

and

bi(q) :=

qi[n + 1]q[n + i + 3]q

.

[n + i + 2]q

n0

(5.27)

Clearly T (bi(q)) = T (bi,0(q)), moreover it is easily verified that a0(q) = c0(q), so suppose (5.21) holds for i - 1  0. By the induction hypothesis and (5.25) we have

PCi · · · PC0 =

Ii+1

0

0 T (bi,0(q))

·

Ii 0

0 L(ai(q))T(i-1)(q)

·

Ii-1 0

0 L(ci-1(q))

· · · L(c0(q)).

(5.28)

We now make the following claim:

Claim 2. For 0  m  i - 1,

m
L(ai(q)) T (bi-1,j(q)) =
j=0

1

0

0 T (bi,1(q)) · · · T (bi,m+1(q))

· L(cm+1(q)) (5.29)

where cm(q) is the edge sequence

cm(q) :=

qi+n-m[i + 1]q

[n + i + 2]q [n + i + 1]q

m+1

.

n0

Claim 2 (5.29) clearly holds for m = 0 by way of Lemma 2.9:

(5.30)

L(ai(q))T (bi-1,0(q)) =

1

0

0 T (bi,1(q))

· L(c1(q)),

(5.31)

and more generally we have (again by Lemma 2.9)

L(cm(q))T (bi-1,m(q)) =

1

0

0 T (bi,m+1(q))

· L(cm+1(q)).

(5.32)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 37
Letting m = i - 1 above proves Claim 2 (5.29), which in turn confirms Claim 1 (5.21) since it is straightforward to check that ci(q) = ci(q), thereby completing the proof of the proposition.

Coefficientwise total positivity of F(q) and T(q) follows almost immediately from Proposition 5.1:

Proof of Theorem 1.2. Since N2 is a planar network with weights that are polynomials with nonnegative coefficients in q and we have just shown that PN2 = F(q), the matrix F(q) is coefficientwise totally positive in Z[q] thanks to the LGV lemma. The coefficientwise total positivity of T(q) then follows from the fact that

T(q) = F(q)T ((qn[n + 1]q)n0)

(5.33)

(see Lemma 3.11 above), since the inverse lower-bidiagonal matrix T ((qn[n + 1]q)n0) is coefficientwise totally positive.

Proving Theorem 1.2 was the main goal of this paper, however, the planar network N2 can be seen as a specialisation of a more general network that appears to satisfy some interesting properties that we believe warrant further investigation. We discuss this more general network in the following section.

6. Further comments and some open problems

In this final section we turn our attention to a generalisation of the planar network N2 that under certain specialisations yield matrices with entries that appear to count a variety of combinatorial objects with respect to different statistics. These matrices are automatically coefficientwise totally positive, since they arise from planar networks with weights that are polynomials with nonnegative coefficients. Furthermore, under certain specialisations, sequences of row-generating polynomials related to these matrices turn out to be sequences of polynomials that are already well-known, and in some cases are also known to be coefficientwise Hankel-totally positive (a sequence a = (Pn(x))n0 of polynomials in one or more indeterminates x is coefficientwise Hankel-totally positive if its associated Hankel matrix H(a) := (Pn+k(x))n,k0 is coefficientwise totally positive in all the indeterminates x).
We will briefly touch upon the method of production matrices (see [18, 19]), which in recent years has become an important tool in enumerative combinatorics and has its roots in Stieltjes' work on continued fractions9. The theory of production matrices with respect to total positivity is extensively studied in [64], however, since [64] is not yet publicly available we direct the reader to Sections 2.2 and 2.3 of [66] for a fuller treatment.
For our purposes we will require the following principles: let P = (pi,j)i,j0 be an infinite matrix with entries in R[x] equipped with the coefficientwise order. In order that powers of P are well defined we assume that P is either row finite (that is, has only finitely many nonzero entries in each row) or column finite. Let us now define the infinite matrix A := (an,k)n,k0 where

an,k = (Pn)0,k,

(6.1)

9See [70, 71], which were reprinted together with an English translation in [72, pp. 401­566 and 609­745]

38

T. GILMORE

that is, row n of A is the first row of the matrix power Pn (in particular we set a0,k = 0k). We call P the production matrix of A, while A is referred to as the output matrix of P and we write O(P) = A. The entries of A are, explicitly,

an,k =

p0,i1 pi1,i2 pi2,i3 · · · p p , in-2,in-1 in-1,k

i1,...,in-1

(6.2)

which can be seen as the total weight of all n-step walks in N from i0 = 0 to in = k, in which the weight of a walk is the product of the weights of its steps, and each step from i to j has weight pi,j. An equivalent formulation is to define the entries by the recurrence


an,k =

an-1,ipi,k

(6.3)

i=0
for n  1 with initial condition a0,k = 0k. Given a production matrix P, we define the augmented production matrix to be

P~ :=

1 0 0 0 ··· P

,

(6.4)

and it is easy to show [66, Section 2.2] that the output matrix of P has the factorisation

O(P) = · · ·

I3 0 0 P~

·

I2 0 0 P~

·

10 0 P~

P~.

(6.5)

Clearly if P is coefficientwise totally positive then so is P~, and hence so is O(P) (Theorem 2.9 in [66]). The factorisation given above is the reason we call the factorisation in Corollary 2.4 production-like. The quasi-production-like factorisation in Corollary 2.7 is named after the related concept of quasi-production matrices (see [10]) that we do not require here.

6.1. General Abel Polynomials

Let us now return to the q-forests matrix F(q) and consider the matrix

F¯(q) := (f¯n,k(q))n,k0 = F(q) diag((qn(n-1)/2)n0),

(6.6)

the row-generating polynomials of which are defined to be

F¯0(x; q) := 1

(6.7)

and

n

n

F¯n(x; q) := f¯n,k(q)xk =

k=0

k=0

n-1 k-1

([n]q )n-k xk
q

(6.8)

for n > 0. By employing the finite sum version of the q-binomial theorem [2, Theo-

rem 3.3]:

n

n

n-1
(-z)kq(k+2 1) = (1 - zqi),

k=0 k q

i=0

(6.9)

in which z has been replaced with (-qx/[n]q), we obtain the explicit formulas

F¯0(x; q) = 1

(6.10)

and

n-1

F¯n(x; q) = x (xqi + [n]q).

(6.11)

i=1

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 39

For q specialised to q = 1 the polynomials F¯(x; 1) reduce to the Abel polynomials

F¯n(x; 1) = x(x + n)n-1,

(6.12)

which are the row-generating polynomials of the forests matrix F. Sokal [66] has
already proven that the Abel polynomials (along with further generalisations of the
row-generating polynomials of the forests matrix) are coefficientwise Hankel-totally
positive. It is natural to ask, then, whether this property is preserved if q is left as an indeterminate in F¯n(x; q).
The Hankel matrix associated to F¯n(x; q),

H((F¯n(x; q))n0) = (n,k)n,k0,

(6.13)

begins:



x

x(qx + q + 1)

··· 

x(qx + q + 1) x (q2 + qx + q + 1) (q2x + q2 + q + 1) · · ·





...

...

...

(6.14)

which contains the 2 × 2 minor

0,01,1 -1,00,1 = 2q2x2 +2q3x2 +q4x2 -qx3 +2q3x3 +q4x3 -q2x4 +q3x4 0, (6.15)

so our generalisation does not preserve coefficientwise Hankel-total positivity. By studying the minor above, however, one might suppose that shifting q by 1 (that is, replacing q with 1 + r) might yield a polynomial sequence (F¯n(x; 1 + r))n0 that is coefficientwise Hankel-totally positive; indeed, computer experiments conducted with Alan Sokal seem to confirm this for n  10. We conjecture:
Conjecture 6.1 (with Alan Sokal). The polynomial sequence (F¯n(x; 1 + r))n0 is coefficientwise Hankel-totally positive jointly in x and r.

In the following subsections we consider further generalisations of the forests matrix to more indeterminates, and a common theme begins to emerge; in each case we have observed that modifying these matrices in a similar way to (6.6) above and shifting the indeterminates by 1 yields a set of matrices with row-generating polynomials that appear to be coefficientwise Hankel-totally positive jointly in a number of indeterminates.
The polynomials F¯n(x; q) are, in fact, specialisations of a q-generalisation of the general Abel polynomials presented in [13, 37, 38]:

a0(x; b, h, w, q) := 1
n-1
an(x; b, h, w, q) := (x + b) (xqi + b + [i]qh + [n]qw) for n  1.
i=1

(6.16) (6.17)

Note that for w = 1, b = h = 0 the above formula gives a q-generalisation of the Stirling cycle polynomials, so the polynomials an(x; b, h, w, q) interpolate between qforest polynomials and a q-generalisation of the Stirling cycle polynomials (below we will consider a different q-generalisation of the Stirling cycle polynomials).

40

T. GILMORE

Johnson [38, Section 4] showed that the polynomials an(x; b, h, w, q) are of qbinomial type, that is, they satisfy

n
an(x; a + b, h, w, q) =
k=0

n

k

an-k(0; a, h + (1 - q)(b + [k]qw), w(1 - (1 - q)[k]q))
q

× ak(x; a, h, w, q) (6.18)

and

n
an(x + y; a + b, 0, w, q) =
k=0

n k

an-k(yqk; a, (1 - q)(b + [k]qw), w(1 - (1 - q)[k]q))
q

× ak(x; a, 0, w, q). (6.19)

The identities above are q-extensions of an identity that goes back to Rothe [59] in 1793 and Pfaff [50] in 1795, usually expressed as:

nn

Rn(x + y; h, w) =

k Rk(x; h, w)Rn-k(y; h, w)

k=0

(6.20)

where

R0(x; h, w) := 1

(6.21)

and

n-1

Rn(x; h, w) := x (x + ih + nw)

(6.22)

i=1

for n > 0.

In [66, Section 6] Sokal explains how these polynomials are a rewriting of the

Schl¨afli-Gessel-Seo polynomials:

P0(x; a, b) := 1

(6.23)

and

n-1

Pn(x; a, b) := x (x + ai + (n - i)b)

(6.24)

i=1

which were introduced by Schl¨afli in 1847 [61], and resurfaced much later in a 2006 paper by Gessel and Seo [31] who showed that

Pn,k(a, b) = [xk]Pn(x; a, b)

(6.25)

enumerates k-component forests on the vertex set [n] by proper and improper vertices, and also by ascents and descents. Sokal's paper contains a fuller discussion of these polynomials as well as a number of interesting conjectures regarding their coefficientwise Hankel-total positivity, and we enthusiastically encourage the reader to consult the final section of [66] for further details.
There is, unsurprisingly, something of an overlap between this current paper and the generalisations of the forest matrix studied by Sokal [66]. In the next subsection we will show how our planar network N2 from Section 5 can be modified to derive some of the results proven in [66].

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 41

6.2. Enumerating forests by proper and improper edges
In [66] Sokal considers total positivity properties of generalisations of the forests matrix that differs from the q-generalisations studied in this paper. We will now show how making some simple modifications to the planar network N2 yields a path matrix that agrees with one of the generalisations studied in [66].
Given two vertices i and j of a tree T belonging to a forest, we say that j is a descendant of i if the unique path from the root of T to j passes through i (note that every vertex is a descendant of itself). Let e = ij be an edge of T . We say that e is improper if there is a descendant of j (possibly j itself) that is lower-numbered than i, otherwise we say that e is proper (see Section 1 of [66]).
Consider the matrix

F(y, z) := (fn,k(y, z))n,k0,

(6.26)

the entries of which are given by

n-k

fn,k(y, z) :=

fn,k,mymzn-k-m

m=0

(6.27)

where fn,k,m is the number of forests of rooted trees on the vertex set [n] that have k components and m improper edges. The first few rows of F(y, z) are:

1



0

1



 

0

y+z

0

3y2 + 4yz + 2z2

1

3y + 3z

1



 

,

(6.28)





 0 25y2z + 15y3 + 18yz2 + 6z3 15y2 + 22yz + 11z2 6y + 6z 1



 ...

...

...

...

...

 ...

each entry is a homogeneous polynomial of degree n - k, and under the specialisation y = z = 1 we recover the forests matrix (that is, F(1, 1) = F). Sokal also observes (see the remark on page 7 of [66]) that the polynomials fn,1(y, z) (which enumerate rooted trees with respect to improper edges) are homogenised versions of the Ramanujan polynomials (see [9, 20, 35, 36, 40, 45, 55, 62, 75] and [63, A054589]).
The matrix F(y, z) is the exponential Riordan array R[F, G ] with F (t) = 1 and

1 G (t) = G
z

z z2 1- + t

e-(1-

z y

)

-

z 1-

yy

y

(6.29)

(Section 3.2 of [66]) where G(t) is the tree function (see [16] and (1.11) above). Sokal
proved that F(y, z) is coefficientwise totally positive in Z[y, z] using the productionmatrix method; the production matrix for F(y, z) is the lower-Hessenberg matrix10
P(y, z) := (pn,k(y, z))n,k0 with entries

n! n+1-k yn-lzl

pn,k(y, z) = (k - 1)!

l!

l=0

(6.30)

10A matrix is lower-Hessenberg if all entries above the super-diagonal are 0.

42

T. GILMORE

Figure 10. The planar network N3 arising from the productionmatrix approach used in [66] (unlabelled edges have weight 1).

(see [66, Proposition 4.7]). The first few rows of P(y, z) are:

0

1



0

y+z

y



0

2y2 + 2yz + z2

2y2 + 2yz

y2



 

,

 0 6y2z + 6y3 + 3yz2 + z3 6y2z + 6y3 + 3yz2 3y2z + 3y3 y3







...

...

...

...

... . . .

(6.31)

and P(y, z) has the factorisation [66, Proposition 4.8]

P(y, z) = Bz diag((n!)n0)T(y) diag((k!)k0)-1,

(6.32)

where T(y) is the Toeplitz matrix of powers of y (see Subsection 2.3 above) and  := (n+1,k)n,k0 is the lower-Hessenberg matrix with 1 on the superdiagonal and 0 elsewhere.
As described above (see (6.5)), the augmented production matrix

P~(y, z) :=

1 0 0 0 ··· P(y, z)

(6.33)

with P(y, z) defined previously yields the following factorisation of F(y, z):

F(y, z) = · · ·

I3

0

0 BzT (y)

·

I2

0

0 BzT (y)

·

10 0 BzT (y)

(6.34)

where y = ((n+1)y)n0 [equivalently, T (y) = D diag((n!)n0)T(y) diag((k!)k0))-1] and Bz = Bz,1 is the weighted binomial matrix Bx,y with x = z and y = 1. A diagram of the corresponding planar network N3 can be found in Figure 10.
Now let N4 denote the planar network in Figure 11, the corresponding path matrix of which has the production-like factorisation

PN4 = · · ·

I3

0

0 L(3z)T (y)

·

I2

0

0 L(2z)T (y)

·

1

0

0 L(z)T (y)

(6.35)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 43

Figure 11. The planar network N4 up to source and sink vertices u6 and v6.

where L(iz) denotes the lower-bidiagonal matrix with 1 on the diagonal, iz on the subdiagonal, and 0 everywhere else. Comparing Figure 9 in Section 5 with Figure 11 it is easy to see that we obtain N4 from N2 by specialising q = 1 and multiplying the weights of the blue and green edges by y and z respectively. We make the following proposition:

Proposition 6.2. The path matrix corresponding to N4 satisfies PN4 = F(y, z).
Proof. Consider the factorisation of F(y, z) in (6.34) above:

(6.36)

F(y, z) = · · ·

I3

0

0 BzT (y)

·

I2

0

0 BzT (y)

·

10 0 BzT (y)

.

(6.37)

The matrix Bz has the production-like factorisation

Bz = · · ·

I3 0 0 L(z)

·

I2 0 0 L(z)

·

10 0 L(z)

L(z) =

10 0 Bz

· L(z) (6.38)

(see Corollary 2.5 with y = 1 and x replaced with z, and also observe that the righthand side above implies that L(z) is the augmented production matrix of Bz). It follows that

F(y, z) = · · ·

I3

0

0 BzT (y)

·

I2

0

0 BzT (y)Bz

·

1

0

0 L(z)T (y) .

(6.39)

A straightforward calculation confirms that

T (y)Bz = DT(y)D-1DT((zn/n!)n0)D-1 = DT((zn/n!)n0)D-1DT(y)D-1 = BzT (y) (6.40)

44

T. GILMORE

where D = diag((n!)n0), since Toeplitz matrices matrices commute:

T(a)T(b) = T(a  b) = T(b)T(a)

where a  b is the convolution of the sequences a and b

ab =

n
ak bn-k
k=0

.
n0

Furthermore, it is easily verified that

(6.41) (6.42)

BzBz = Bz+z =

10 0 Bz+z

· L(z + z ),

(6.43)

hence

F(y, z) = · · ·

I3

0

0 BzT (y)B2z

·

I2

0

0 L(2z)T (y)

·

1

0

0 L(z)T (y)

. (6.44)

Iteratively commuting T (y) with Biz and writing

10 BzBiz = 0 B(i+1)z L((i + 1)z)

(6.45)

for increasing i in the factorisation of F(y, z) given above completes the proof.

The focus of this paper has been q-generalisations of the forests and trees matrices, and note that we can easily introduce q-weights into the planar network N3. Consider the network N5 in Figure 12, which has the corresponding path matrix

PN5 = · · ·

I3

0

0 Bq;zT ((y[n + 1]q)n0)

·

I2

0

0 Bq;zT ((y[n + 1]q)n0)

1

0

· 0 Bq;zT ((y[n + 1]q)n0)

where Bq;z is the q-binomial matrix

(6.46)

Bq;z =

n zn-k

.

kq

n,k0

(6.47)

Now let

F^(q, y, z) = (f^n,k(q, y, z))n,k0 = PN5

(6.48)

and observe that F^(q, y, z) is the output matrix of the lower-Hessenberg production

matrix P (q, y, z) = (pn,k(q, y, z))n,k0 where

P (q, y, z) = DqT((zn/[n]q!)n0)T(y)Dq-1

(6.49)

where Dq = diag(([n]q!)n0). Define the row-generating polynomials of F^(q, y, z) to be:

F^0(x; q, y, z) = 1

(6.50)

and n F^n(x; q, y, z) = f^n,k(q, y, z)xk
k=0
for n  1. We have the following lemma:

(6.51)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 45

Figure 12. The planar network N5, obtained by introducing q-weights into the network N3.

Lemma 6.3. The sequence (F^n(x; q, y, z))n0 of row-generating polynomials of F^(q, y, z) = O(P (q, y, z)) is coefficientwise Hankel-totally positive jointly in q, x, y, z.

In order to prove Lemma 6.3 we first recall two easy results from [66]. The first is:

Lemma 6.4 (Lemma 2.6 in [66]). Let P = (pi,j)i,j0 be a row-finite matrix (with entries in a commutative ring R) with output matrix A = O(P ); and let B = (bi,j)i,j0 be a lower-triangular matrix with invertible (in R) diagonal entries. Then

AB = b0,0O(B-1P B).

(6.52)

That is, up to a factor b0,0, the matrix AB has production matrix B-1P B.

The second is the following theorem:

Theorem 6.5 (Theorem 2.14 in [66]). Let P = (pi,j)i,j0 be an infinite row-finite or column-finite matrix with entries in a partially ordered commutative ring R, and define the infinite Hankel matrix H(O0(P )) = ((P n+n )0,0)n,n 0. If P is totally positive of order r, then so is H(O0(P )).

Our proof of Lemma 6.3 relies on these two useful facts, and follows along the same lines as the argument found in the proof of Lemma 2.16 of [66] where D is replaced with Dq, Bx is replaced with Bq;x, and

n zlyn-l

 = (n)n0 =

l=0

. [l]q !

(6.53)

Proof of Lemma 6.3. The row-generating polynomials of F^(q, y, z) are the entries in the zeroth column of the matrix

F^(q, x, y, z) = F^(q, y, z)Bq;x,

(6.54)

and according to Lemma 6.4 above we have

F^(q, x, y, z) = O(Bq-;x1P (q, y, z)Bq;x).

(6.55)

46

T. GILMORE

Since P (q, y, z) is coefficientwise totally positive it suffices (thanks to Theorem 6.5)

to show that the matrix

Bq-;x1P (q, y, z)Bq;x

(6.56)

is coefficientwise totally positive. We have

Bq;x = DqT((xn/[n]q!)n0)Dq-1,

(6.57)

and

P (q, y, z) = DqT()Dq-1,

(6.58)

where

n zlyn-l

 = (n)n0 =

l=0

. [l]q !

(6.59)

It follows that Bq;x and DqT()Dq-1 commute. Note further that according to the recurrences for q-binomial coefficients (see (3.45)

and (3.46) in Section 3) we have

Bq;x = Bq;x(diag((qnx)n0) + ).

(6.60)

We therefore have

Bq-;x1P (q, y, z)Bq;x = Bq-;x1DqT()Dq-1Bq;x = Bq-;x1DqT()Dq-1Bq;x(diag((qnx)n0) + ) = DqT()Dq-1(diag((qnx)n0) + ) = DqT()Dq-1(I + T diag((qnx)n0))

(since T = I), yielding the identity

Bq-;x1P (q, y, z)Bq;x = P (q, y, z)(I + T diag((qnx)n0)),

(6.61)

so Bq-;x1P (q, y, z)Bq;x coefficientwise totally positive. This completes the proof.

My experiments suggest that there is a more general principle lurking behind Lemma 6.3, concerning production matrices of q-Riordan arrays (see [12], and also [39, 32]). This will be rigorously addressed in future work; for now we turn our attention to a more general planar network that yields both N2 and N4 under suitable specialisations.
Consider now the planar network N6 in Figure 13 and observe that N4 can be obtained from N6 by specialising q = 1 in N6 to q = 1, and by instead specialising y = z = 1 in N6 we obtain the planar network N2. The path matrix corresponding to N6 has the factorisation:

PN6 = · · ·
where and

I3

0

0 L(a2(q, z))T (b2(q, y))

·

I2

0

0 L(a1(q, z))T (b1(q, y))

·

1

0

0 L(a0(q, z))T (b0(q, y))

ai(q, z) = (qn+1+iz[i + 1]q)n0

bi(q, y) = (qiy[n + 1]q)n0.

(6.62) (6.63) (6.64)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 47

Figure 13. The planar network N6.

Let

F~(q, y, z) = (F~n,k(q, y, z))n,k0 = PN6

(6.65)

and note that F~(q, y, z) is a generalisation of F(q) and F(y, z) in the sense that

F~(1, y, z) = F(y, z), and F~(q, 1, 1) = F(q).

Sokal showed in [66] that the row-generating polynomials of F(y, z):

F0(x; y, z) := 1

(6.66)

and n

Fn(x; y, z) := fn,k(y, z)xk

(6.67)

k=0

for n > 0 are coefficientwise Hankel-totally positive jointly in x, y, z (Theorem 1.3
of [66]). One might wonder, then, whether the sequence (F~n(x; q, y, z))n0 of rowgenerating polynomials of F~(q, y, z):

F~0(x; q, y, z) = 1

(6.68)

and n

F~n(x; q, y, z) = f~n,k(q, y, z)xk

(6.69)

k=0

is also Hankel totally-positive. Unfortunately this is not the case, for the Hankel matrix H((F~n+n )n,k0) = (n,k)n,k0 contains the 2 × 2 minor:

1,02,1-2,01,1 = q3x2yz+3q2x2yz+q4x2z2+q3x2z2-q2x2z2+q3x3z+2q2x3z+2qx2y2 - 2qx2yz + 2qx3y - 2qx3z - x3y 0. (6.70)

However, it appears that coefficientwise total positivity can be restored by multiplying F~(q, y, z) by a simple diagonal matrix. Consider the matrix

F¯(q, y, z) = (f¯n,k(q, y, z))n0 = F~(q, y, z) diag((qk(k-1)/2)k0),

(6.71)

48

T. GILMORE

the row-generating polynomials of which are F¯0(x; q, y, z) = 1

(6.72)

and n

F¯n(x; q, y, z) = f¯n,k(q, y, z)xk

(6.73)

k=0
for n  1. The matrix F¯(q, y, z) is manifestly totally positive, and the sequence of row-generating polynomials of F¯(q, y, z) appear empirically (up to 5 × 5) to be

coefficientwise totally positive jointly in q, x, y, z. I conjecture:

Conjecture 6.6. The Hankel matrix H(F¯n+n (x; q, y, z))n,n 0) is coefficientwise totally positive jointly in q, x, y, z.

But what of a combinatorial interpretation of the entries of F¯(q, y, z)? As we have seen, on the one hand the entries of F¯(1, y, z) count forests on n vertices with
k components with respect to proper and improper children, and on the other the entries of F¯(q, 1, 1) count forests on n vertices with k components with respect to the
statistics defined in Section 3. I therefore pose the following problem:

Problem 1. Find a combinatorial interpretation of the entries of F¯(q, y, z).

6.3. A generalisation with more variables

Consider now the planar network N7 in Figure 14. The path matrix corresponding

to N7 is

PN7 := (fn,k(p, q, r, s, , µ, y, z))n,k0

(6.74)

which has the factorisation

PN7 = · · · PC2 PC1 PC0

where

PCi :=

Ii+1

0

0 L(ai(p, q, , z))T (bi(r, s, µ, y))

in which L(ai(p, q, , z)) is the lower-bidiagonal matrix with edge sequences

ai(p, q, , z) = (i+n+1z[i + 1]p,q)n0

and T (bi(r, s, µ, y)) the inverse lower-bidiagonal matrix with edge sequences

bi(r, s, µ, y) = (µiy[n + 1]r,s)n0.

Now let

(6.75) (6.76) (6.77) (6.78)

F(p, q, r, s, , µ, y, z) := (fn,k(p, q, r, s, , µ, y, z))n,k0 = PN7,

(6.79)

and note that N7 reduces to N6 (see Figure 13) when p, r, s, , µ are specialised to p = r = 1 and s =  = µ = q, so F(p, q, r, s, , µ, y, z) is a generalisation of the forests

matrix to eight indeterminates.

The first few rows of F(p, q, r, s, , µ, y, z) are:

1



0

1



 

0

z + y

1

 

 0 2pyz + 3pz2 + 2qyz + 3qz2 2pz + 2qz + 2z 1 





 +2yz + µyz + µy2 + ry2 + sy2 +µy + ry + sy



 ...

...

...

 ...

(6.80)

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 49

Figure 14. The planar network N7 up to source and sink vertices u6 and v6.

Clearly this matrix is coefficientwise totally positive jointly in p, q, r, s, , µ, and the entries must count forests of trees on n vertices with k components with respect to eight different statistics. I present two main open problems regarding the matrix F(p, q, r, s, , µ, y, z). The first is:

Problem 2. Find a combinatorial interpretation of the entries of F(p, q, r, s, , µ, y, z).

We know that specialising p = r = y = z = 1 and s =  = µ = q yields the q-forests matrix F(q), and the entries count forests on n vertices with k components according to the statistics presented in Section 3. Similarly, by specialising  = µ = p = q = r = s = 1 we obtain the matrix F(y, z), the entries of which count k-component forests on n vertices with respect to proper and improper edges. In the following subsections we identify other specialisations of p, q, r, s, , µ, y, z yielding matrices with entries that appear to count a variety of interesting combinatorial objects including: permutations with respect to left-right maxima, unordered forest of increasing labelled trees, 0-1 tableaux by inversions and noninversions, and perfect matchings with respect to crossings and nestings.
Now define the row-generating polynomials of F(p, q, r, s, , µ, y, z) to be

F0(x; p, q, r, s, , µ, y, z) := 1
and n Fn(x; p, q, r, s, , µ, y, z) := fn,l(p, q, r, s, , µ, y, z)xl l=0
for n > 0, and consider the Hankel matrix

(6.81) (6.82)

where

H((Fn(x; p, q, r, s, , µ, y, z))n0) := (n,k)n,k0 n,k = Fn+k(x; p, q, r, s, , µ, y, z).

(6.83) (6.84)

50

T. GILMORE

The first few Fn(x; p, q, r, s, , µ, y, z) are:

n

Fn(x; p, q, r, s, , µ, y, z)

0

1

1

x

2

x(x + y + z)

3 x(x2 + (µ + r + s)xy + (µ + r + s)y2 + 2(1 + p + q)xz

+(µ + (1 + p + q))yz + 3(p + q)z2)

...

...

(6.85)

so the associated Hankel matrix contains the 2 × 2 minor:

1,02,1 - 2,01,1 = 2px2yz + 3px2z2 + 2px3z + 2qx2yz + 3qx2z2 + 2qx3z + 2x2yz - 2x2z2 + 2x3z + µx2yz - 2x2yz - 2x3z
+ µx2y2 + µx3y + rx2y2 + rx3y + sx2y2 + sx3y - x2y2 - 2x3y 0. (6.86)

The polynomial sequence (Fn(x; p, q, r, s, , µ, y, z))n0 is evidently not coefficientwise Hankel-totally positive. However, consider instead the matrix

F~(p, q, r, s, , µ, y, z) := (f~n,k(p, q, r, s, , µ, y, z))n,k0 = F(p, q, r, s, , µ, y, z) diag(((pqrsµ)n(n-1)/2)n0), (6.87)

the row-generating polynomials of which are

F~0(x; p, q, r, s, , µ, y, z) := 1

(6.88)

and

n

F~n(x; p, q, r, s, , µ, y, z) := f~n,k(p, q, r, s, , µ)xk

(6.89)

k=0

for n > 0. The sequence (F~n(x; p, q, r, s, , µ, y, z))n0 is not coefficientwise Hankel-totally pos-
itive, however, my computations suggest that shifting the indeterminates p, q, r, s, , µ

by 1 yields a polynomial sequence that appears to be coefficientwise Hankel-totally

positive jointly in nine indeterminates! I make the following conjecture:

Conjecture 6.7. The polynomial sequence (F~n(x; 1 + p , 1 + q , 1 + r , 1 + s , 1 +  , 1 + µ , y, z))n0
is coefficientwise Hankel-totally positive jointly in x, y, z, p , q , r , s ,  , µ .

(6.90)

I have verified the above conjecture to 5×5, and I do not yet understand what these polynomials enumerate. The conjectured coefficientwise Hankel-total positivity of the shifted row-generating polynomials of F~(p, q, r, s, , µ, y, z) is in a sense stronger than the coefficientwise total positivity of F~(p, q, r, s, , µ, y, z) alone, and in light of this a combinatorial interpretation of the entries of F~(p, q, r, s, , µ, y, z) is much desired. Clearly each (n, k)-entry enumerates k-component forests on n vertices with respect to eight statistics; interpreting these statistics is left as an open problem:
Problem 3. Find a combinatorial interpretation of the entries of F~(p, q, r, s, , µ, y, z).

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 51

6.4. (p, q)-Stirling polynomials

The network N7 is an interlacing of two different planar networks (one with green diagonal edges, one with blue). By setting r = s = µ = y = 0 we effectively remove

the blue edges and are left with a binomial-like planar network we shall denote N7. Specialising  = z = 1 in N7 we obtain the binomial-like network with edge weights specialised to i,l = 1 and

i,l = [i - 1]p,q,

(6.91)

with corresponding path matrix

G(p, q) := (gn,k(p, q))n,k0 = PN7 = F(p, q, 0, 0, 1, 0, 0, 1)

(6.92)

The weights of the network N7 are purely i-dependent so the entries of G(p, q) satisfy the recurrence:

gn,k(p, q) = gn-1,k-1(p, q) + [n - 1]p,qgn-1,k-1(p, q)

(6.93)

for n  1 with initial condition g0,k = 0k. Moreover we have

gn,k(p, q) = en-k([1]p,q, [2]p,q, . . . , [n - 1]p,q)

(6.94)

by way of (2.13) in Section 2. The recurrence (6.93) can be found in [17, Proposition 2.2] and [74], and the expression in terms of elementary functions (6.94) can be found in Proposition 2.3 (part (a)) of [17]. The entries of G(p, q) are thus the (p, q)Stirling cycle numbers (or unsigned (p, q)-Stirling numbers of the first kind, denoted cp,q[n, k]) and the row-generating polynomials of G(p, q) are

n-1
cn(x; p, q) := x (x + y[i]p,q)
i=1

(6.95)

where y = 1 (see Proposition 2.3 part (b) of [17]). Note that the authors of [17] have

a combinatorial interpretation of cp,q[n, k], but it has nothing to do with forests and trees! Intead they consider 0-1 tableaux: a 0-1 tableau is a pair  = (, f ) where

 = (1  2  · · ·  k) is a partition of an integer m = || and f = (fi,j)1ji a filling of of the corresponding Ferrer's diagram of  with 0s and 1s such that there

is exactly one 1 in each column. In [17] de M´edicis and Leroux define two statistics

on : the inversion number, inv(), is the number of 0s below a 1 in , and the

noninversion number, nin(), is the number of 0s above a 1 in . They then show

that

cp,q[n, k] =

pnin()qinv()

(6.96)

T d(n-1,n-k)

where T d(k, r) denotes the set of 0-1 tableaux with k rows and columns of length at

most r, where the lengths of the columns are distinct.

Permutations, however, are perhaps arguably more natural objects to study in

relation to generalisations of the Stirling cycle numbers (the polynomial cn(x; 1, 1) is the generating function for permutations counted with respect to cycles, after all). For p specialised to p = 1 Zeng [74, Section 3, where sq(n, k) = qn-kc1,q[n, k]] showed that

cn(x; 1, q) =

xlrm()qinv()

(6.97)

Sn

52

T. GILMORE

where lrm() denotes the number of left-right maxima in a permutation  (that is, the number of (i) such (i) > (j) for all j < i), and inv() the number of inversions of  (that is, the number of pairs i < j such that (i) > (j)), hence

gn,k(1, q) =

qinv()+k-n,

Sn(k)

(6.98)

where Sn(k) denotes the set of permutations on [n] with k left-right maxima. Clearly G(p, q) is totally positive, and for p specialised to p = 1 we can express

the row-generating polynomials of G(1, q) as the S-type (or Stieltjes-type) continued

fraction11

1+

c1,q[n, k]xktn =

n,k1

1-

1 1t

1 - 2t

···

(6.99)

1 - nt ···
where 2n-1 := (x + [n]q)qn-1 and 2n = [n]qqn+1 for n  1 (Lemma 3 of Zeng 1993, where we have replaced x with tq, and a with x/q). If a sequence of polynomials has
an S-fraction with nonnegative coefficients then the corresponding Hankel matrix is
coefficientwise totally positive (see [64] and [49, Section 9]), so we have:

Corollary 6.8. The polynomial sequence (cn(x; 1, q))n0 is coefficientwise Hankeltotally positive in x, q.

The Hankel matrix of cn(x; p, q), where p and q are indeterminates, however, begins

1

x

x

x(x + 1)

 x(x + 1) x(x + 1)(p + q + x)



...

...

which contains the 2 × 2 minor

x(x + 1)
x(x + 1)(p + q + x) x(x + 1)(p + q + x) (p2 + pq + q2 + x)
...

···  ···  ··· 
 ...
(6.100)

0,11,2 - 1,10,2 = px3 + px2 + qx3 + qx2 - x3 - x2 0

(6.101)

so is not even TP2 in Z[p, q]. Again it appears, however, that right-multiplying G(p, q) by a simple diagonal matrix yields a matrix whose row-generating polynomials appear to be coefficientwise Hankel-totally positive when p, q are shifted by 1.
Consider the matrix

G (p, q, , z) = (gn,k(p, q, , z))n,k0 = F(p, q, 0, 0, , 0, 0, z) diag(((pq)n(n-1)/2)n0) (6.102)
and define its row-generating polynomials to be

n
Gn(x; p, q, , z) := gn,k(p, q, , z)xk.
k=0

(6.103)

Clearly G (p, q, , z) is coefficientwise totally positive jointly in p, q, , z (this follows from Cauchy-Binet and the LGV lemma). I make the following conjecture:

11The study of continued fractions goes back to Euler, and was reinvigorated more recently by Flajolet in [23].

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 53

Conjecture 6.9. The polynomial sequence (Gn(x; p + 1, q + 1,  + 1, z))n0 is coefficientwise Hankel-totally positive jointly in p, q, , z, x.

I have verified this up to 7 × 7, and am yet to discover a suitable combinatorial interpretation of these polynomials. I therefore pose the following problem:

Problem 4. Find a combinatorial interpretation of the polynomials Gn(x; p, q, , z).
6.5. Generalised Bessel polynomials Now consider the planar network N7 obtained by specialising p = q =  = z = 0
in N7 (effectively removing all diagonal blue edges from the network), and let
M(r, s, µ, y) := (mn,k(r, s, µ, y))n,k0 = PN7 = F(0, 0, r, s, 0, µ, y, 0) (6.104) be the corresponding path matrix. The matrix M(r, s, µ, y) has a factorisation in terms of downshifted inverse bidiagonal matrices:

M(r, s, µ, y) = · · ·

I3

0

0 T (a2(r, s, µ, y))

·

I2

0

0 T (a1(r, s, µ, y))

·

1

0

0 T (a0(r, s, µ, y))

(6.105)

where ai(r, s, µ, y) = (µiy[n + 1]r,s)n0.

Each matrix T (ai(r, s, µ, y)) has (n, k)-entry:

µi(n-k)y [n]r,s! [k]r,s!

(6.106)

and specialising r, s, µ to r = s = µ = 1 we obtain

1

0

0 T (ai(1, 1, 1, y))

1



0 1



 

0

y

1

 

=

 

0

2y2

2y

1

 

 0 6y3 6y2 3y 1







 0 24y4 24y3 12y2 4y 1



 ... ...

...

...

...

...

 ...

(6.107)

(this array appears in [63, A094587]). Compare the above with the production matrix P := (pn,k)n,k0 defined in Proposition 1.4 of [48], where

 0

pn,k

=

n!  (k - 1)! n-k+1

if k = 0, if n  k - 1.

(6.108)

We have

0 1



 0 1 1



0

P

=

 

0



22 63

21 62

1 31

1



 

,



0  ...

244 ...

243 ...

122 ...

41 ...

1 ...


 ...

(6.109)

(where  = (n)n0 is a sequence of indeterminates, and for ease of reading we set
0 = 1). It is easy to see that (6.107) is the augmented production matrix obtained by setting i = yi in P.

54

T. GILMORE

The output matrix of P is the generic Lah triangle:

1

0

1

L := (Ln,k())n,k0

=

 

0

0



1 21 + 22

1

31

1

0  ...

31 + 812 + 63 ...

721 + 82 ...

61 ...

1 ...

...

the row-generating polynomials of which are







 

,







(6.110)

n
Ln(, y) := Ln,k()yk.
k=0

(6.111)

The entries of L are generating polynomials for unordered forests of increasing ordered
trees on the vertex set [n] having k components, in which each vertex with i children is assigned a weight i.12 Setting  = (1)n0 in (6.110) we obtain the reverse Bessel triangle :

1



0 1



 

0

1

1

 

M(1, 1, 1, 1)

=

 

0

3

31

 

 0 15 15 6 1







 0 105 105 45 10 1 

 ... ...

...

...

...

...

 ...

(6.112)

(see [63, A001497]). The row-generating polynomials of M(1, 1, 1, 1) are the reverse Bessel polynomials (see [33])

n (n + k)! xn-k

n(x) :=

, (n - k)!k! 2k

k=0

(6.113)

which is an orthogonal sequence of polynomials related to the Bessel polynomials

(see [44, 33]):

n (n + k)! x k yn(x) := (n - k)!k! 2
k=0

(6.114)

via the identity

n(x) = xnyn(1/x).

(6.115)

It follows from [48] that the sequence of polynomials n(x) is coefficientwise Hankeltotally positive.
Consider now the row-generating polynomials of M(r, s, µ, y), defined to be

M0(x; r, s, µ, y) := 1

(6.116)

12An ordered tree is a rooted tree in which the children of each vertex are linearly ordered. An unordered forest of ordered trees is an unordered collection of ordered trees. An increasing ordered tree is an ordered tree in which the vertices carry distinct labels from a linearly ordered set (usually some set of integers) in such a way that the label of each child is greater than the label of its parent; otherwise put, the labels increase along every path downwards from the root. An unordered forest of increasing ordered trees is an unordered forest of ordered trees with the same type of labeling.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 55

and n

Mn(x; r, s, µ, y) := mn,k(r, s, µ, y)xk

(6.117)

k=0

for n > 0, and note that the polynomials Mn(x; r, s, µ, y) are generalisations of the reverse Bessel polynomials in the sense that Mn(x; 1, 1, 1, 1) = n(x).
It follows from [48] that the polynomial sequence (Mn(x; 1, 1, 1, y))n0 is coefficientwise totally positive jointly in x and y. Again, it is natural to ask whether

the generalisation where r, s, µ, y are left as indeterminates preserves coefficientwise

Hankel-totally positivity. The answer is no, since the Hankel matrix

H((Mn(x; r, s, µ, y))n0) = (n,k)n,k0,

(6.118)

where

n,k = Mn+k(x; r, s, µ, y)

(6.119)

contains the 2 × 2 minor

1,02,1 - 2,01,1 = µx2y2 + µx3y + rx2y2 + rx3y + sx2y2 + sx3y - x2y2 - 2x3y 0. (6.120)
Once more, however, it appears that Hankel-total positivity could well be restored by right-multiplying M(r, s, µ, y) by a simple diagonal matrix and shifting r, s, µ by 1.
Consider the matrix

M (r, s, µ, y) := (mn,k(r, s, µ, y))n,k0 = M(r, s, µ, y) diag(((rsµ)n(n-1)/2)n0) (6.121)

and let

M0(x; r, s, µ, y) := 1

(6.122)

and n

Mn(x; r, s, µ, y) := mn,k(r, s, µ, y)xk

(6.123)

k=0

for n > 0 be the corresponding row-generating polynomials of M (r, s, µ, y). I conjec-

ture:

Conjecture 6.10. The sequence of polynomials (Mn(x; r + 1, s + 1, µ + 1, y))n0 is coefficientwise Hankel-totally positive jointly in r, s, µ, x, y.

I have verified this up to 5 × 5, and am yet to discover a suitable combinatorial interpretation of the entries of M(r, s, µ, y) or indeed M (r, s, µ, y), and therefore pose the following problem:

Problem 5. Find combinatorial interpretations of M (r, s, µ, y) and M(r, s, µ, y).

There is one final observation to make concerning perfect matchings that may help in tackling the foregoing problem. A perfect matching M on [2n] is a partition of 1, 2, . . . , 2n into n pairs (i, j) where i < j. We denote the set of all such perfect matchings M2n, and it is well-known that

|M2n| = (2n - 1)!!.

(6.124)

Two pairs (ir, jr) and (is, js) belonging to M  M2n form a crossing if ir < is < jr < js, and form a nesting if ir < is < js < jr. The number of crossings in M is denoted cr(M ) and the number of nestings is denoted ne(M ).

56

T. GILMORE

If µ and y are specialised to µ = y = 1 then the first few rows of M(r, s, 1, 1) are:

1

0

1



0

1



0

r+s+1

1

r+s+1

1

 

0

2r2s + r3 + r2 + 2rs2 + 2rs

2r2s + r3 + r2 + 2rs2 + 2rs

r2 + rs + r

1



+2r + s3 + s2 + 2s + 1

+2r + s3 + s2 + 2s + 1 +s2 + s + 1



...

...

...

...

...

For s specialised to s = 1 and 0 < n  20 I have verified empirically that


   .    
...
(6.125)

mn,1(r, 1, 1, 1)

=

(1

-

r)1-n

n-1
(-1)k rk(k+1)/2

2k

+

1

2n - 1

2n - 1 n+k

.

k=0

(6.126)

The formula above (where n is replaced with n+1) was found implicitly by Touchard [73], and explicitly by Riordan [58] (see also [4, 41, 47, 53, 56]), and counts perfect matchings with respect to crossings (or nestings):

rcr(M) =

rne(M) = (1 - r)-n n (-1)krk(k+1)/2 2k + 1

2n + 1

M M2n

M M2n

k=0

2n + 1 .
n+k+1 (6.127)

However, more may indeed be true, since it looks like the k = 1 column of

M(r, s, 1, 1) counts perfect matchings with respect to crossings and nestings. For

0 < n  20 my computations have confirmed that

mn,1(r, s, 1, 1) = [tn]S(t; r, s)

(6.128)

where S(t; r, s) is the S-type continued fraction

1

S(t; r, s) :=

.

1-

[1]r,st

1 - [2]r,st

···

(6.129)

1 - [n]r,st ···

Since S(t; r, s) is the master S-fraction for perfect matchings first given by Kasraoui and Zeng in [43, Proposition 4.4, with p, q replaced by r, s respectively] (see also [68, Theorem 4.4] specialised to x = y = u = v = 1, p+ = p- = r, and q+ = q- = s), I make the following conjecture:

Conjecture 6.11. For n > 1

mn,1(r, s, 1, 1) =

rcr(M ) sne(M ) .

M M2(n-1)

(6.130)

As described above, there exists an explicit formula for counting perfect matchings with respect to crossings or nestings given by Touchard and Riordan, however, an explicit closed formula that counts perfect matchings with respect to crossings and nestings is yet to be found. I therefore pose the following problem:

Problem 6. Find a closed form formula for mn,1(x; r, s, 1, 1).

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 57
Acknowledgements
I would like to thank Shaoshi Chen, Xi Chen, Bishal Deb, Alan Sokal, and Alexander Dyachenko for many helpful and illuminating conversations.
I would also like to thank the many volunteers who maintain and expand the Online Encyclopedia of Integer Sequences [63], and Neil Sloane for founding it in the first place. It is a fabulous resource that I make use of almost daily.
This research was supported by Engineering and Physical Sciences Research Council grant EP/N025636/1.

References

[1] M. Aigner and G. M. Ziegler, Proofs from The Book, 6th ed., Springer-Verlag, Berlin, 2018.

[2] G. E. Andrews, The Theory of Partitions, Encyclopedia of Mathematics and its Applications,

Cambridge University Press, 1984.

[3] A. Avro and N. Dershowitz, Cayley's formula: A page from The Book, The American Mathe-

matical Monthly 123 (2016), no. 7, pp. 699 ­ 700.

[4] N. Blitvi´c, The (q, t)-Gaussian process, J. Funct. Anal. 263 (2012), pp. 3270 ­ 3305.

[5] F. Brenti, Combinatorics and total positivity, J. Combin. Theory A 71 (1995), pp. 175 ­ 218.

[6]

, The applications of total positivity to combinatorics, and conversely., Total Positivity

and its Applications (M. Gasca and C. A. Micchelli, eds.), Kluwer, Dordrecht, 1996, pp. 451 ­

473.

[7] C. Chauve, S. Dulucq, and O. Guibert, Enumeration of some labelled trees, Research Report

RR-1226-99 (1999), LaBRI, Universite Bordeaux I.

[8]

, Enumeration of some labelled trees, Formal Power Series and Algebraic Combinatorics

(FPSAC 2000), Springer-Verlag, Berlin, 2000, pp. 146 ­ 157.

[9] W. Y. C. Chen and H. R. L. Yang, A context-free grammar for the Ramanujan--Shor polyno-

mials, Adv. Appl. Math. 126 (2021), no. 101908, p. 24.

[10] Xi. Chen, B. Deb, A. Dyachenko, T. Gilmore, and A. D. Sokal, Coefficientwise total positivity

of some matrices defined by linear recurrences, in preparation.

[11]

, Coefficientwise total positivity of some matrices defined by linear recurrences, (2020),

to appear in the proceedings of FPSAC 2021.

[12] G.-S. Cheon, J.-H. Jung, and Y. Lim, A q-analogue of the Riordan group, Linear Algebra and

its Applications 439 (2013), no. 12, pp. 4119 ­ 4129.

[13] J. Cigler, q-Abel polynomials, (2008), arXiv:0802.2886.

[14] L. E. Clarke, On Cayley's Formula for Counting Trees, Journal of the London Mathematical

Society 1-33 (1958), no. 4, pp. 471­474.

[15] L. Comtet, Advanced Combinatorics: The Art of Finite and Infinite expansions, Reidel,

Dordrecht­Boston, 1974, translated from the French by J.W. Nienhuys. [French original: Anal-

yse Combinatoire, tomes I et II, Presses Universitaires de France, Paris, 1970.].

[16] R. M. Corless, G. H. Gonnet, D. E. G. Hare, D. J. Jeffrey, and D. E. Knuth, On the Lambert

W function, Advances in Computational Mathematics 5 (1996), no. 1, pp. 329 ­ 359.

[17] A. de M´edicis and P. Leroux, A unified combinatorial approach for q- (and p, q-) Stirling num-

bers, Journal of Statistical Planning and Inference 34 (1993), no. 1, pp. 89 ­ 105.

[18] E. Deutsch, L. Ferrari, and S. Rinaldi, Production Matrices and Riordan Arrays, Annals of

Combinatorics 13 (2009), no. 1, pp. 65 ­ 85.

[19] E. Deutsch and L. Shapiro, Exponential Riordan arrays, handwritten lecture notes,

Nankai University, available online at http://www.combinatorics.net/ppt2004/Louis%20W.

%20Shapiro/shapiro.pdf, 26 February 2004.

[20] D. Dumont and A. Ramamonjiosa, Grammaire de Ramanujan et arbres de Cayley, Elec-

tron. J. Combin. 3 (1996), no. R17. [21] O¨ . Egecioglu and J. B. Remmel, Bijections for Cayley trees, spanning trees, and their q-

analogues, J. Combin. Theory A 42 (1986), no. 1, pp. 15 ­ 30.

[22] S. M. Fallat and C. R. Johnson, Totally Nonnegative Matrices, Princeton University Press,

Princeton NJ, 2011.

58

T. GILMORE

[23] F. Flajolet, Combinatorial aspects of continued fractions, Discrete Math. (1980), pp. 125 ­ 161. [24] S. Fomin and A. Zelevinsky, Total positivity: tests and parametrizations, Math. Intelligencer 22
(2000), pp. 23 ­ 33. [25] Jean Franc¸on, Preuves combinatoires des identites d'Abel, Discrete Mathematics 8 (1974), no. 4,
pp. 331 ­ 343. [26] F. R. Gantmacher and M. G. Krein, Oscillation Matrices and Kernels and Small Vibrations
of Mechanical Systems, AMS Chelsea Publishing, Providence RI, 2002, based on the second Russian edition, 1950. [27] G. Gasca and G. Mu¨hlbach, A test for strict total positivity via Neville elimination, Current Trends in Matrix Theory (F. Uhlig and R. Groue, eds.), Elsevier Science, 1987, pp. 225 ­ 232. [28] M. Gasca and E. Lebr`on, Elimination techniques and interpolation, J. Comput. Appl. Math. 19 (1987), pp. 125 ­ 132. [29] M. Gasca and G. Mu¨hlbach, Generalized Schur complements and a test for total positivity, Appl. Numer. Math. 3 (1987), pp. 215 ­ 232. [30] M. Gasca and J. M. Pen~a, Total positivity and Neville elimination, Linear Algebra and its Applications 165 (1992), pp. 25 ­ 44. [31] I. M Gessel and S. Seo, A refinement of Cayley's formula for trees, Elec. J. Combin. 11 (2006), no. R.27. [32] Ira M. Gessel, A q-analog of the exponential formula, Discrete Mathematics 306 (2006), no. 10, pp. 1022 ­ 1031, 35th Special Anniversary Issue. [33] E. Grosswald, Bessel Polynomials, Lecture Notes Math. 698 (1978). [34] S. Guo and J. W. Guo, A recursive algorithm for trees and forests, Discrete Mathematics 340 (2017), no. 4, pp. 695 ­ 703. [35] V. J. W. Guo, A bijective proof of the Shor recurrence, European J. Combin. 70 (2018), pp. 92 ­ 98. [36] V. J. W. Guo and J. Zeng, A generalization of the Ramanujan polynomials and plane trees, Avd. Appl. Math. 39 (2007), pp. 96 ­ 115. [37] F. H. Jackson, A q-generalization of Abel's series, Rendiconti Palermo 29 (1910), pp. 340 ­ 346. [38] W. P. Johnson, q-extensions of identities of Abel-Rothe type, Discrete Mathematics 159 (1996), no. 1, pp. 161 ­ 177. [39] Warren P. Johnson, Some applications of the q-exponential formula, Discrete Mathematics 157 (1996), no. 1, pp. 207 ­ 225. [40] M. Josuat-Verg`es, Derivatives of the tree function, Ramanujan J. 38 (2015), pp. 1 ­ 15. [41] M. Josuat-Verg`es and J. S. Kim, Touchard--Riordan formulas, T­fractions, and Jacobi's triple product identity, Ramanujan J. 30 (2013), pp. 341 ­ 378. [42] S. Karlin, Total Positivity, Stanford University Press, Stanford CA, 1968. [43] A. Kasraoui and J. Zeng, Distribution of crossings, nestings and alignments of two edges in matchings and partitions, Elec. J. Comb. 13 (2006), no. 1. [44] H. L. Krall and O. Frink, A new class of orthogonal polynomials: The Bessel polynomials, Trans. Amer. Math. Soc. 63 (1949), pp. 100 ­ 115. [45] Z. Lin and J. Zeng, Positivity properties of Jacobi­Stirling numbers and generalized Ramanujan polynomials, Adv. Appl. Math 53 (2014), pp. 12 ­ 27. [46] J. W. Moon, Counting labelled trees, Canadian Mathematical Congress, Montreal, 1970. [47] J.-G. Penaud, Une preuve bijective d'une formule de Touchard--Riordan, Discrete Math. 139 (1995), pp. 347 ­ 360. [48] M. P´etr´eolle and A. D. Sokal, Lattice paths and branched continued fractions ii. Multivariate Lah polynomials and Lah symmetric functions, European Journal of Combinatorics 92 (2021), pp. 103 ­ 235. [49] M. P´etr´eolle, A. D. Sokal, and B. Zhu, Lattice paths and branched continued fractions: An infinite sequence of generalizations of the Stieltjes­Rogers and Thron­Rogers polynomials, with coefficientwise Hankel-total positivity, (2020), accepted for publications in Memoirs of the AMS. [50] J. F. Pfaff, Allgemeine Summation einer Reihe, worinn h¨ohere differenziale vorkommen, Archiv der reinen und angewandten Mathematik 1 (1795), pp. 337 ­ 347. [51] A. Pinkus, Totally Positive Matrices, Cambridge University Press, Cambridge, 2010.

TREES, FORESTS, AND TOTAL POSITIVITY: I. q-TREES AND q-FORESTS MATRICES 59

[52] J. Pitman, Forest Volume Decompositions and Abel--Cayley-­Hurwitz Multinomial Expansions,

J. Combin. Theory, Series A 98 (2002), no. 1, pp. 175 ­ 191.

[53] H. Prodinger, On Touchard's continued fraction and extensions: combinatorics-free, self-

contained proofs, Quaestiones Math. 35 (2012), pp. 431 ­ 445.

[54] H. Pru¨fer, Neuer Beweis eines Satzes u¨ber Permutationen, Arch. Math. Phys. 27 (1918), pp. 742

­ 744.

[55] L. Randazzo, Arboretum for a generalisation of Ramanujan polynomials, Ramanujan J. 54

(2021), pp. 591 ­ 604.

[56] R. C. Read, The chord intersection problem, Second International conference on Combinatorial

Mathematics: Annals of the New York Academy of Sciences No. 319 (A. Gerwitz and L. V

Quintas, eds.), New York Academy of Sciences, New York, 1979, pp. pp. 444 ­ 454.

[57] J. Riordan, Forests of labeled trees, J. Combin. Theory 5 (1968), pp. 90 ­ 103.

[58]

, The distribution of crossings of chords joining pairs of 2n points on a circle,

Math. Comp. 29 (1975), pp. 215 ­ 222.

[59] H. A. Rothe, Formulae de serierum reversione demonstratio universalis signislocalibus combi-

natorioanalyticorum vicariis exhibita, Litteris Sommeriis, Leipzig, 1793.

[60] Bruce E. Sagan, A note on Abel polynomials and rooted labeled forests, Discrete Mathematics

44 (1983), no. 3, pp. 293 ­ 298.

[61] L. Schl¨afli, Bemerkungen u¨ber die Lambertische Reihe, Archiv der Mathematikund Physik 10

(1847), pp. 332 --- 340, Reprinted in L. Schl¨afli, Gesammelte Mathematische Abhandlungen,

Band I (Springer, Basel, 1950), pp. 38­45.

[62] P. W. Shor, A new proof of Cayley's formula for counting labeled trees, J. Combin. Theory A

71 (1995), pp. 154 ­ 158.

[63] N. Sloane, The Online Encyclopedia of Integer Sequences, available at http://oeis.org.

[64] A. D. Sokal, Coefficientwise total positivity (via continued fractions) for some hankel matrices

of combinatorial polynomials, in preparation.

[65]

, A remark on the enumeration of rooted labeled trees, Discrete Mathematics 343 (2020),

no. 7.

[66] A. D. Sokal, Total Positivity of some polynomial matrices that enumerate labelled trees and

forests: I. Forests of rooted labelled trees, (2021), arXiv:2105.05583.

[67] A. D. Sokal and X. Chen, Total positivity of some polynomial matrices that enumerate labelled

trees and forests: II. Rooted labelled trees, (2021), in preparation.

[68] A. D. Sokal and J. Zeng, Some multivariate master polynomials for permutations, set partitions,

and perfect matchings, and their continued fractions, 2020, arXiv:2003.08192.

[69] R. P. Stanley, Enumerative Combinatorics, vol. 2, Wadsworth & Brooks/Cole, Monterey CA,

1986, reprinted by Cambridge University Press, 1999.

[70] T. J. Stieltjes, Recherches sur les fractions continues, Ann. Fac. Sci. Toulouse 8 (1894), no. J1

­ J122.

[71]

, Recherches sur les fractions continues, Ann. Fac. Sci. Toulouse 9 (1895), no. A1 ­ A47.

[72]

, Euvres Compl`ete/Collected Papers, vol. II, Springer-Verlag, Berlin, 1993.

[73] J. Touchard, Sur un probl`eme de configurations et sur les fractions continues, Canad. J. Math

4 (1952), pp. 2 ­ 25.

[74] J. Zeng, The q-Stirling numbers, continued fractions and the q-Charlier and q-Laguerre poly-

nomials, Journal of Computational and Applied Mathematics 57 (1995), no. 3, pp. 413 ­ 424.

[75]

, A Ramanujan sequence that refines the Cayley formula for trees, Ramanujan J. 3

(1999), pp. 45 ­ 54.

