arXiv:2106.00972v1 [astro-ph.EP] 2 Jun 2021

MNRAS 000, 1­13 (2020)

Preprint 3 June 2021

Compiled using MNRAS LATEX style file v3.0

Predicting Exoplanet Mass from Radius and Incident Flux: A Bayesian Mixture Model
Qi Ma,1 and Sujit K. Ghosh,1
1Department of Statistics, North Carolina State University, 2311 Stinson Drive, Raleigh, NC 27695, USA

Accepted XXX. Received YYY; in original form ZZZ
ABSTRACT The relationship between mass and radius (M-R relation) is the key for inferring the planetary compositions and thus valuable for the studies of formation and migration models. However, the M-R relation alone is not enough for planetary characterization due to the dependence of it on other confounding variables. This paper provides a non-trivial extension of the M-R relation by including the incident flux as an additional variable. By using Bayesian hierarchical modeling (BHM) that leverages the flexibility of finite mixture models, a probabilistic mass-radius-flux relationship (M-R-F relation) is obtained based on a sample of 319 exoplanets. We find that the flux has nonnegligible impact on the M-R relation, while such impact is strongest for hot-Jupiters. On the population level, the planets with higher level of flux tend to be denser, and high flux could trigger significant mass loss for plants with radii larger than 13. As a result, failing to account for the flux in mass prediction would cause systematic over or under-estimation. With the recent advent of computing power, although a lot of complex statistical models can be fitted using Monte Carlo methods, it has largely remain illusive how to validate these complex models when the data are observed with large measurement errors. We present two novel methods to examine model assumptions, which can be used not only for the models we present in this paper but can also be adapted for other statistical models.
Key words: planets and satellites: fundamental parameters ­ methods: data analysis ­ methods: statistical

1 INTRODUCTION
With hundreds of confirmed exoplanets whose measured masses and radii are well constrained by the Kepler Mission and subsequent radial velocity campaigns, the M-R relation has been well studied on the population level in recent years (e.g. Weiss & Marcy 2014; Hadden & Lithwick 2014; Bashi et al. 2017; Wolfgang et al. 2016; Chen & Kipping 2017; Ning et al. 2018; Kanodia et al. 2019; Ma & Ghosh 2019). Such relation itself and the associated astrophysical scatter for different exoplanet populations are vital for inferring bulk compositions and understanding the planet formation pathways.
However, the M-R relation alone is not enough for planetary characterization since it could be affected by multiple other planetary properties such as the incident flux. It is widely accepted that the flux has nonnegligible impact on the M-R relation on both observational and theoretical grounds. For example, a large fraction of hot-Jupiters have inflated radii larger than expected by models of gas giants cooling and contraction (Miller & Fortney 2011; Demory & Seager 2011). Such abnormality is found to be related to the stellar irradiation, and a variety of inflation models have been proposed (e.g. Arras & Socrates 2010; Wu & Lithwick 2013; Tremblin et al. 2017). The mass loss driven by XUV photoevaporation could also contribute to the M-R relation for both hot-Jupiters and lower-mass planets (e.g. Lammer et al. 2003; Yelle 2004; Lopez et al. 2012; Hubbard et al. 2007).
 E-mail: qma4@ncsu.edu
© 2020 The Authors

Ignoring the effect of flux could amplify the intrinsic scatter of the estimated M-R relation and thus limit our accurate interpretation of it. Therefore, the relation between the mass, radius and flux (M-R-F relation hereafter) has been explored recently. Weiss et al. (2013) studied a sample of 135 planets and identified a break point in the M-R-F relation at 150 by visual inspection. They applied a simple power law to approximate the M-R-F relation and concluded that (/) = 1.78(/)0.53 (/erg s-1cm-2)-0.03 for planets with masses less than 150, and (/) = 2.45(/)-0.039 (/erg s-1cm-2)-0.094 for heavier planets. Following the work by Wolfgang et al. (2016), Neil & Rogers (2018) explored the dependence of the M-R relation on flux and host star mass for small planets ( < 8) using a Bayesian hierarchical model. However, they found it difficult to distinguish the effects of flux and host star mass with their limited data set, and preferred the model only considering the host start mass by performing model selection via WAIC (Watanabe 2013). Sestovic et al. (2018) used a sample of 286 gas giants to investigate how the mass and the flux influence the radius inflation. Their probabilistic model shows that the planets with masses between 0.37 and 0.98 exhibits the strongest correlation between the inflated radius and the flux.
In this work, we present a probabilistic M-R-F relation using Bayesian hierarchical modelling that leverages the flexibility of finite mixture models. We also focus on model checking techniques that can be applied to other models easily.

2 Q. Ma & S. K. Ghosh

2 MOTIVATING DATA SET
The data considered in this work were acquired from NASA Exoplanet Archive (Akeson et al. 2013) on 09/08/2019. There are a total of 319 transiting exoplanets in our sample that satisfy the following criteria:
(i) They have radial velocity (RV) or transit timing variation (TTV) mass measurements. In addition, their measurements of orbital semi-major axis in astronomical units (), stellar temperature (), and stellar radius () are also required to be available, as the incident flux in Earth units is computed using



=

4


2


12

(1)

   

where  and  are the effective temperature and radius of sun

respectively.

(ii) Following Wolfgang et al. (2016), in case of asymmetric

upper

and lower

error

bars

(+




-

),

the

average




=

1 2

(+

+

-  )

is

taken

as

the

standard

deviance

of

the

measure-

ment as discussed in section 5.2. To obtain a sample with relatively

high signal-to-noise ratio, a 3 cutoff is then applied to all measure-

ments, i.e., /  > 3,/ > 3, and /  > 3

(Chen & Kipping 2017).

(iii) Since our work is focusing on exoplanets, we exclude brown

dwarfs exhibiting deuterium fusion by introducing an upper mass

boundary at 13 (Spiegel et al. 2011).

In this work, the mass, radius and flux measurements are all in earth units. Since they differ by several orders of magnitude, we also apply base-ten logarithmic transformation to them for numerical stability and efficiency of using MCMC sampling. For simplicity, we denote  = log10 (),  = log10 (), and  = log10 (). Figure 1 shows the distribution of the flux, radius and mass measurements in our sample. We latter use these plots to guide us developing joint models for mass, radius and flux.
Unavoidably, the sample used in this work is perhaps subject to some level of selection bias that could impact the estimated M-RF relation to some extent. Incorporating the selection bias into the model is certainly a critical step for more accurate estimation and can be performed using appropriately weighted version of likelihood (e.g. Fulton et al. 2017; Neil & Rogers 2020). However, as primary goals of this work, we mainly focus on (i) how to fit the joint distribution on heterogeneous data using a mixture model; and (ii) how to verify various modeling assumptions made via the specification of prior and sampling distributions. One of the challenging aspects of the developing model verification methods is how to deal with data that are measured with errors. We also note that RV and TTV measurements exhibit different observational bias with TTV characterized planets typically having lower densities (Mills & Mazeh 2017; Steffen 2016). Following the previous works (e.g. Wolfgang et al. 2016; Ning et al. 2018), the inclusion of both techniques provides more data points especially in the sparse region of the M-R-F parameter space and thus could makes the inferred M-R-F relation more representative.

3 STATISTICAL MODELS
A quick look at top panel in Figure 1 indicates that the joint probability distribution of radius and flux may depend on the magnitude of the masses. The bottom panel indicates that the joint distribution of mass and flux may depend on the magnitudes of radii (via two
MNRAS 000, 1­13 (2020)

log10(Mob/M )

log10(Rob/R )

1.4
3.5
1.2
3.0
1.0
2.5

0.8

2.0

0.6

1.5

0.4

1.0

0.2

0.5

0.0

0.0

4.0

0

1 log10(2Fob/F ) 3

4

3.5

1.2

3.0

1.0

2.5

2.0

0.8

1.5

0.6

1.0

0.4

0.5
0.2
0.0

0

1 log10(2Fob/F ) 3

4

log10(Rob/R )

log10(Mob/M )

Figure 1. Top Panel: Scatter plot of log   vs log  with log   color-coded. Bottom Panel: Scatter plot of log   vs log   with log  color-coded.

or three clusters). Thus, mixture models that allow us to capture the variations (clusters) of the joint distributions of two objects when varies with the level of a third object seem appropriate. In this section, we first provide a brief overview of some basic concepts of finite mixture models (FMM) and then provide details of our Bayesian hierarchical mixture model (BHMM) guided by the observed scatter plots in Figure 1.

3.1 FMM in Astronomy

The probability density of a real-valued random variable modeled using an -component FMM takes the form





 (; ) =  (; ),

(2)

=1

where  (; ) is the th component density known up to a parameter vector , { }=1 are the nonnegative mixture weights that sum to 1, and  = (1, . . . , , 1, . . . , ) denotes the vector consisting of all the unknown parameters of the FMM.
For convenience with computational inference and better understanding of the mixture model, we can also express FMM in a hierarchical form. Let  be a categorical random variable taking values 1 to  with probabilities 1, . . . , , respectively. Then, the distribution of the random variable  with density given in equation (2), denoted

by    (; ), is equivalent to

 | =    (; ),  = 1, . . . , .

(3)

Equation (3) describes the generating process of the random variable  conditioned on the latent component indicator variable . The component densities  are often chosen as Gaussian densities with mean  and standard deviation , in which case  = (, ), but other probability densities (e.g., location-scale families like Cauchy, Laplace etc.) can also be useful in some settings depending on the range of the random variables (e.g. Peel & McLachlan 2000; Lee & McLachlan 2016).
FMM are a natural choice for many applications in astronomy mainly for two reasons. First of all, FMM provides conceptually and computationally convenient way to model the data exhibiting groupstructure, and is thus exploited for classification and cluster analysis of astronomical objects. For example, Lee et al. (2012) applies a 6component Gaussian mixture model to the pulsar distribution in the period-period derivative space, and identifies two possible clusters of millisecond pulsars. Einasto et al. (2012) studies multimodality in galaxy clusters using multivariate Gaussian mixture modelling, and shows the presence of complex substructures.
In addition, under some very mild regularity conditions, FMM as a flexible and semi-parametric approach can be used to approximate any unknown continuous density by choosing appropriately large  in terms of total variation norm (Roeder & Wasserman 1997; Li & Barron 1999; Nguyen et al. 2020). FMM is also better equipped with avoiding the common problem of choosing restrictive parametric probability densities (e.g. normal, log-normal, or gamma distributions) which can lead to considerable discrepancy between the chosen parametric model and the data, particularly when such astronomical data arise from (often unknown) complex astrophysical processes. Besides serving as an approximation of the target probability distribution directly (e.g. Melchior & Goulding 2018), FMM can be used effectively for deriving or approximating a complex model using a sequence of simpler hierarchical models guided by the insights learned from 2-d scatter plots (e.g. Kelly 2007).

3.2 The Problem of Label Switching
In making statistical inference, finite mixture models may suffer from the problem of label switching due to the invariance of likelihood to the permutation of model parameters, and it is well-known that even maximum likelihood estimates don't exist without some restriction (e.g., see Section 3.10 of (Peel & McLachlan 2000) for detail discussions). Suppose that there is a mixture model consisting of only two normal components with different means:

 (|, 1, 2) = N (|1, ) + (1 - )N (|2, )

(4)

It's easy to verify that  (|, 1, 2) =  (|1-, 2, 1). In other words, the likelihood would be invariant and two distinct values of the parameters and thus it's hard to identify the model parameters through the likelihood of the data. The problem gets even worse as the number of mixture components grows, because there would be more permutations of model parameters that lead to the same likelihood value. Hoever, if we are interested in estimating the density (and its parameters), this problem is not much of a concern.
Label switching doesn't affect posterior predictive inference as all of the integrals involved are not affected by the ordering of indices of the components. However, inferences about the parameters are problematic under label switching, including the posterior estimates of individual parameters. For example, the posterior mean of  in

M-R-F relation with Bayesian Mixture Model 3
Equation 4 may always be close to 0.5 with any data. Moreover, label switching usually results in highly multimodal posteriors that makes all known MCMC sampling techniques inefficient due to poor mixing of the chains (see Chapter 22.3 of Gelman et al. (2013) for more details).
The most common approach to deal with label switching is to impose ordering constraints on the parameters that identifies the component. For example, for the model describe in Equation 4, a possible constraint is 1 < 2 that forbids the swapping of 1 and 2 making the likelihood informative about these parameters. Other alternatives are to impose   0.5 and if we allow different 1 and 2 for the components, we can impose 1 < 2 as well. All of these order restriction techniques will be applied in our modeling as described in Section 3.3.1 and 3.3.2.

3.3 BHMM for the M-R-F Relation
Our BHMM is designed to infer the joint density of the true unobserved mass, radius and flux of a planet, denoted as  (, , ), which can be factorized as

 (, , ) =  ()  (|)  (|, ).

(5)

Other possible equivalent factorizations of the joint density in terms of appropriate conditional and marginal densities are also possible, but we use the above form for the convenience of our model development. In this section, we describe the details of modelling the three conditional density components on the right side of Equation (5), as well as how the measurement errors are incorporated into the model.

3.3.1 Marginal Distribution of Flux
Figure 2 shows the empirical histogram (with estimated kernel density overlaid) of the observed flux and visually it appears left-skewed with possibly local modes around the values 1, 2 and 3, which indicates that a Gaussian mixture with components having different location parameters can be a reasonable choice. However, notice that we do not need to correctly identify the local modes as those will be estimated from data. Hence we model the the marginal distribution of true flux:










N

(




,




)

,

(6)

=1

where

{ }=1,

{

}

 =1

are

the

means

and

standard

deviations

of

the

Gaussian

components,

and

{



}

 =1

are

mixture

weights.

The

number of components  will be chosen via model selection methods.

To tackle the label switching problem, order constraints are im-

posed on the location parameters by a simple reparameterization:








=

,  = 1, . . . , ;

(7)

=1

where

{ }=2

are

restricted

to

be

positive

such

that

1 ,

.

.

.

,




are

monotonically increasing.

MNRAS 000, 1­13 (2020)

4 Q. Ma & S. K. Ghosh

Proportion

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0.0

10

1 log10(2Fob/F )3

4

5

Figure 2. Histogram of  on the logarithmic scale with its kernel density estimation denoted by the blue curve.

The priors on the parameters in Equation 6 and 7 are specified below:

Notice that, this leads to a conditional mean (the so-called regression function) of log  conditioned on  given by  [|] =

  =1




(

+







)

which

is

motivated

by

the

top

panel

in

Figure

1.

To prevent the possible label switching problems, we impose order

constraints on the precision parameters which allows for identifica-

tion of the component parameters, and is given by:



1/ (   ) 2


 = ,



= 1, . . . , 

(11)

=1

where { }=1 are all positive. The above specification leads to a quadratic form of the conditional variance, Var(|) in terms of .
The priors on the parameters in Equation 9, 10 and 11 are listed below:

(


1

,

.

.

.

,





)



Dirichlet(5,

.

.

.

,

5),

  N (0, 5),

  N (0, 5)

(12)

  Gamma(1, 1),

(1

,

.

.

.

,




)





Dirichlet(5,

.

.

.

,

5),

2

1/




 Gamma(0.1, 0.1), for  = 1, . . . , ,

0  N (0, 5), and

(8)

   N (0, 5) (0, ), for  = 2, . . . , ;

where Gamma(, ) denotes the Gamma distribution with shape  and rate , and  (, ) denotes that the distribution is truncated with a lower bound at .
To make the mixture weights less concentrate on only a few components, the concentration parameters of the Dirichlet prior is larger than one. All other priors are quite vague considering that the largest observed flux after logarithm transformation is around 4.5. Also note that we place priors on the precision (inverted variance) instead of the standard deviation to be consistent with the parameterization of JAGS (Plummer 2003) used for MCMC sampling in this work.

3.3.2 Conditional Distribution of Radius on Flux
The insulation flux is one of the many factors that affect the radius. As shown in Figure 1, the radii of hot Jupiters with high flux are excessively large, and the inflation mechanism seems to be less active for heavier planets. Demory & Seager (2011); Miller & Fortney (2011) find a critical value of flux approximately at 0.2 Gerg s-1cm-2 below which the inflation mechanism is possibly not significant. Such heterogeneity justifies the use of following FMM for the conditional distribution of radius on flux:





| 




N




(



),




,

(9)







 =1

where the location parameters  () in each component are as-

sumed to be linear in :




(



)



=



+

 ,

 = 1, . . . , .

(10)

MNRAS 000, 1­13 (2020)

for  = 1, . . . , .

3.3.3 Conditional Distribution of Mass on Radius and Flux
The power law (i.e.  =  ) has been shown to be effective for characterizing the bivariate mass-radius or radius-period relations on the population level (e.g. Wolfgang et al. 2016; Weiss & Marcy 2014; Gieren et al. 1998). To strengthen the flexibility of fixed values of power law parameters where its coefficients  and  stay unchanged, the broken power law that allows the coefficients to vary across different clusters of planets has been developed (e.g. Ma & Ghosh 2019; Chen & Kipping 2017; Bashi et al. 2017).
Note that the observed mass-flux space displays subgroup structures over different ranges of the radius as shown in the bottom panel of Figure 1. Therefore, we propose an adapted version of the broken power law for the M-R-F Relation:

 | ,





N (

(,

),




()),

(13)

where  (·, ·) is determined by the power law with coefficients varying with  and is linear in :




(,

)

=

()

+

().

(14)

To capture the subgroup structures,  ,  and  are modelled using the zero-th order or linear splines of  as given below:

2




1/  () =   I( -1 <     ),

 =1





() =   I( -1 <     ),

(15)

 =1


 () =   +    I( -1 <     ),
 =1

where - = 0 < 1 < 2 < · · · < -1 <  =  are the

knot points dividing the log-radius dimension into several regions.

We use a higher-order (i.e. more smooth) spline to model () as it

is a key parameter that summarizes the influence of flux on the M-R

relation. For the other parameters, we assume them to be a constant

within each region to simplify the model. In Section 5, we will show

that our model is adequate to fit the data.

The

spline

coefficients

{ ,





}

  =1

are

constrained

to

keep

these

functions continuous and avoid abrupt changes the M-R-F relation:

  +     =  +1 +  +1   ,  = 1, . . . ,  - 1.

(16)

One of the advantages of Bayesian inference is that scientific knowledge about unknown parameters can be utilized for model developments through the priors and still allowing for some level of uncertainty. Both Ma & Ghosh (2019) and Ning et al. (2018) identify two change points at around 6 and 11 in the mass-radius relation. Especially for the inflated hot Jupiters with radii larger than 11, a flat mass-radius relation is observed possibly due to an unknown heating mechanism related the level of insulation flux (Guillot & Showman 2002; Kovács et al. 2010; Laughlin et al. 2011).
Therefore, we choose  = 3 in this work and place informative priors on the knots 1 and 2:

1  N (log10 6, 0.2),

2  N (log10 11, 0.2) (1, ).

(17)

The priors on the rest of the parameters are listed below:
   Gamma(0.1, 0.1)    N (0, 2)
(18)    N (0, 1)

for  = 1, . . . , , and 1  N (0, 2). It is to be noted, although we center the knots at values approximately identified by previous literature, we still allow for uncertainty around these values and let data decide on the estimated values.

3.3.4 Model for Measurement Errors
The observations ,  and  are subject to the (known) measurement errors  ,  and  that usually depends on experimental conditions such as the instruments and different mechanisms used to observe the mass, radius and flux of the planets. We follow the treatment in Wolfgang et al. (2016); Ning et al. (2018); Sestovic et al. (2018); Ma & Ghosh (2019) that assumes that the observed values of the mass, radius and flux are normally distributed around the unobserved values ,  and  of the corresponding mass, radius and flux, respectively and use the following measurement error model:






N (,

   )






N (, )

(19)






N (,






)

The above normality assumption is mostly driven by convenience rather than physics, but, unfortunately this topic has received a very little attention in astronomy literature. We provide a way to validate its rationality in section 5.2.

M-R-F relation with Bayesian Mixture Model 5
3.4 Model Selection
All of the above FMMs developed in earlier sections requires the specification of the number of components. There are two such tuning parameters in our model:  and  that are the number of components in the mixtures. With larger values of  and , our model built on Gaussian mixtures could result in multimodal posterior distributions that may not be efficiently explored by MCMC samplers even with order restrictions on the mean or standard deviation parameters. The primary reason for this is due to the fact with larger components, it becomes very unlikely for MCMC samplers to visit the components with very low weights. So, we restrict the choice of number of components to lower values and iteratively use convergence diagnostics of MCMC and standard model selection criteria to select such tuning model parameters.
We also need to make judicious choices for the number of knots used for the broken power law for our model. Bashi et al. (2017) and Buchhave et al. (2014) find transitional points in the mass-radius relation at 3.9 and 12.1 respectively, and the additional knots have informative priors centered around them.
Therefore, we first assess the convergence of the candidate parameterizations with different sets of tuning parameters and knots. The Gelman-Rubin (GR) diagnostic ^ (Gelman & Rubin 1992) that measures the discrepancies between parallel Markov chains is calculated, and ^ < 1.1 usually indicates convergence.
For the models appears to converge by the ^ criteria and lead to unimodal posteriors, we further calculate their deviance information criterion (DIC) (Spiegelhalter et al. 2002) that measures the goodness of fit and penalizes model complexity. A model with smaller DIC is preferred, and the difference between DICs indicates the degree of the preference.
MCMC sampling in this work is performed by JAGS that is also capable of calculating DIC of a hierarchical model directly (Plummer 2003). It turns out that only the two-knot configuration specified in Equation 17 leads to converging unimodal posteriors. We also find that the smallest DIC is achieved at  = 2 and  = 3 although only by a very narrow margin. It's important to note that DIC may not be suited to select mixture models (Steele & Raftery 2010). In fact, since the Gaussian mixtures serve as internal parts of our model, accurate selection of the tuning parameters  and  are not that influential as long as the model is adequate for approximating the underlying M-R-F relation. Thus, we continue to choose  = 2 and  = 3 in our final model configuration and perform model checking to validate its adequacy in section 5.
4 RESULTS
We ran 4 parallel chains, each consisting of 400,000 iterations. The first 200,000 iterations were discarded as burn-ins to allow for reasonable mixing, and the remaining 200,000 iterations were thinned with a lag of 20 (for computational efficiency). The GR diagnostic for each parameter calculated from the combined 40,000 posterior samples was considerably less than 1.1, which indicates that the chains have mixed well and there are no apparent issues with MCMC convergence.
The posterior estimates of the parameters of the marginal density  () is shown in Table 1. As the weights shows the abundance of samples in both components, the posterior estimates are all well constrained.
Table 2 lists the posterior estimates of the parameters in  (|). Since 1 is around 0, the planets belonging to the first component
MNRAS 000, 1­13 (2020)

6 Q. Ma & S. K. Ghosh

Table 1. Posterior mean of the parameters in  ( ) with  = 2. The error bars correspond to the 16th and 84th posterior percentiles.

Comp. ID p
1 2

Weight  
0.36+-00..0077 0.64+-00..0077

Mean 
22..0901+-+-0000....10106464

S.D. 
0.94+-00..0088 0.39+-00..0044

Table 2. Posterior mean of the parameters in  ( | ) with  = 3. The error bars correspond to the 16th and 84th posterior percentiles.

Comp. ID k
1 2 3

Weight 

0.10-+00..0022 0.24-+00..0055 0.66-+00..0055

Mean  +  
0.29+-00..1100 + 0.00+-00..0044  0.07+-00..0099 + 0.35+-00..0033  0.85+-00..0033 + 0.10+-00..0011 

S.D. 

0.15+-00..0022 0.12+-00..0011 0.12+-00..0011

show weak correlation between radius and flux. It is observed in the other two components that the radius inflates with increasing flux, while the second component has higher heating efficiency (2 = 0.35 vs 3 = 0.10). Also note that the estimates for the first component are not as well constrained as others due to the lack of samples
(1 = 0.1). Figure 3(a) shows the posteriors of the transitional points 1 and
2 where  ( |, ) modelled by the broken power law exhibits significant changes. With 1 and 2 having posterior estimates at 0.89-+00..0022 and 1.11+-00..0011 on logarithmic scale respectively, the MR-F relation is divided into three regions roughly corresponding to Neptunes, Jupiters, and super-Jupiters. By including the effect of flux, the transitional points from our model are both larger than those obtained by by Ma & Ghosh (2019); Ning et al. (2018).
The posterior estimates of the broken power law coefficients as functions of the radius are displayed in Figure 3(c)(d). In the first two regions where radius is less than around 13, the broken power law constant  and index  increase with larger radius. However, an opposite trend is observed for super-Jupiters. The intrinsic scatter
 also has its highest value around 12 as shown in Figure 3(b). To better understand the M-R-F relation estimated by our model,
Figure 3(e) shows ~ as a function of the flux. In general, it states that the planetary mass increases with higher level of flux with Jupiters having the largest increasing rate.
We also plot the estimated M-R-F relation as a function of radius at different flux levels in Figure 3(f) where several patterns are observed. First, the planets receiving higher level of flux are denser. It could be attributed to the stronger evaporation of H/He envelope triggered by higher stellar XUV flux (e.g. Lammer et al. 2003; Yelle 2004; Baraffe et al. 2004), which leads to a larger fraction of heavy elements. For low-mass and high-flux planets, they could have no (or very thin) H/He envelope, only rock/iron cores (Lopez et al. 2012). Second, planetary mass and radius have positive correlation in the first two radius regions, which is as expected and in agreement with the literature on the mass-radius relation (e.g. Wolfgang et al. 2016; Chen & Kipping 2017; Ning et al. 2018; Ma & Ghosh 2019). Finally, the estimated mean log-mass drops as the radius becomes larger after around 13 at high flux (the blue and red curves). For highly inflated hot-Jupiters, the H/He envelope dominates the composition and is only loosely attached to the planetary core. Thus, significant mass loss by stellar irradiation may occur during their
MNRAS 000, 1­13 (2020)

evolution (Valencia et al. 2010; Hubbard et al. 2007). The model of Baraffe et al. (2004) also suggests that for close-in giant planets with high flux and at a late evolutionary stage, the radius could increase rapidly as the outer layer expands violently, which further amplifies the atmospheric mass loss rate.

5 MODEL CHECKING
In this section, we provide two novel approaches for model checking that aim to validate the consistency of our hierarchical model with the observed data, as well as identify possible directions for model improvements.

5.1 Robust Hotelling's Test
A popular tool for Bayesian model checking is the posterior predictive p-value (PPP) that measures the discrepancy between the simulated data from the posterior predictive distribution and the actual data that have been observed. PPP is easy to implement with posterior samples, but requires test statistics that manages to summarize the model behaviors. Wolfgang et al. (2016) propose two test statistics to check their hierarchical model on the mass-radius relation, which are also adopted by Sestovic et al. (2018). However, those test statistics only focus on one level of the hierarchical model and thus fail to assess the model's ability to characterize the joint distribution. Therefore, we propose an approach based on the robust Hotelling's test to test the model adequacy by checking if the mean of the posterior joint distribution of (, , ) estimated by the model agrees with the observed values (, , ).
 
Hotelling's test (Hotelling 1931) is the multivariate counterpart of the well-known t-test. Let {1, . . . , }  R be a random sample from a p-variate normal distribution with location  and covariance . Under the null hypothesis 0 :  = 0, the Hotelling's 2 statistic follows a scaled F distribution:

2



(x -

0) S-1 (x -

0)



( - 1)   -  ,-

(20)

where x = 1


 =1

x

is the sample mean, S

=

1 -1

 =1

(x

-

x) (x - x) is sample covariance, and ,- denotes the F distri-

bution with degrees of freedom  and  - .

The simultaneous confidence intervals for each component of  at

the significant level of 100(1 - )% are given by:



x ±

( (

- -

1) )

,-



()



(21)

where x is the th entry of x,  is the th diagonal entry of S, and

,- () is the upper th quantile of ,-.

The classic Hotelling's test has several optimality properties in-

cluding the robustness to moderate departures from normality (e.g.

Mardia 1975; Kariya 1981; Dembo & Shao 2006). More recent works

on Hotelling's test (e.g. Willems et al. 2002; Van Aelst & Willems

2013) seek to improve its robustness to outliers by replacing the

naive location and covariance estimators (i.e. x and S) with their

robust counterparts.

We justify our model by checking if (, , ) is close to the

mean

of

the

posterior

samples

{( () ,


()
,


()



) }=1 ,

where



is

the number of posterior samples. To address the problem that only

the measurements of (, , ) with uncertainties are available,

we perform the test using following steps:

M-R-F relation with Bayesian Mixture Model 7

Posterior Density

Power Law Constant

40

BB12

30

20

10

0 0.8

0.9Knot Point1s.0in R 1.1

(a)

1.6

Posterior Mean

68% CI

1.4

1.2

1.0

0.8

0.6
0.2 0.4 0.6 R0.8 1.0 1.2 1.4

(c)

3.0

R=20R R=15R

R=10R

2.5

R=5R R=2R

2.0

1.5

1.0

M

Power Law Index

Standard Deviantion M

0.50

Posterior Mean 68% CI

0.45

0.40

0.35

0.30

0.25

0.2 0.4 0.6 R0.8 1.0 1.2 1.4

(b)

0.5

Posterior Mean

68% CI

0.4

0.3

0.2

0.1

0.0
0.2 0.4 0.6 R0.8 1.0 1.2 1.4

(d)

F=5000F

3.0

F=1000F F=100F

2.5

F=10F

2.0

1.5

1.0

M

101

102F/F

103

5

10 R/R 15

20

(e)

(f)

Figure 3. (a): Posterior distribution of knot points 1 and 2. (b), (c) and (d): The posterior means and the 68% credible intervals (CI) of  , power law constant  and index  in terms of  (logarithmic scale). (e) and (f): The posterior mean and the 68% credible interval of  in terms of  and  (linear scale) respectively.

MNRAS 000, 1­13 (2020)

8 Q. Ma & S. K. Ghosh

(i) Define the 1 "observed" hypercube:



=

(


±

 
,






±


,






±

  )


(22)

(ii) Compute the simultaneous 68% confidence intervals of the

mean

of

{(

()



,

()



,

()



)

}=1,

which

is

also

represented

by

a

hypercube



=

((,


),


(




,






),



(




,






))



(23)

where the superscripts  and  denotes the lower and upper bounds respectively.
(iii) Check if  and  intersect.

The motivation of the first step is that the true values should be close to the observed ones, such that (, , ) resides within  with a high probability. The second step adopts the robust Hotelling test developed by Willems et al. (2002) and implemented in the R package rrcov.
The preceding procedure is repeated for each of the 319 planets in our sample. The result shows that  is fully contained in  for 310 planets, indicating that the posterior joint distribution of (, , ) concentrates closely around the true values for the majority of the sample planets.
There are 4 planets whose  do not intersect with , including HATS-61 b, Kepler-87 b, WASP-140 b and WTS-1 b. They can be treated as outliers with respect to our model. Among the sample planets, HATS-61 b, WTS-1 b and WASP-140 b have significantly larger mass than the others with similar radii and fluxes. On the other hand, the flux received by Kepler-87 b is much lower than the others with similar radii and masses.

5.2 Bayesian Studentized Residual

Residual analysis is a common tool for detecting outlying data points

and validating normal assumption on the error terms in frequentist

linear

regression

models.

Let

the

regression

model

be



=






+



for  = 1, . . . , , where   R is the regression coefficients,  =

(1, . . . , ) is the design matrix,  are i.i.d. error terms from

N (0, ).

The

simple

additive

residual

is

defined

as



=



-




,

where  is the ordinary least square estimate of . To deal with

the problem that  scales with the magnitude of , the (internally)

studentized residual are given by:



=

 ()

=

   1 - 

(24)

where () is the estimated of the standard deviation of ,  is

 the estimate of  and is usually given by  =

  =1

2/(


-

)

in

classical linear models, and the leverage  is the th diagonal entry of the projection or hat matrix  =  (  )-1  .

For a data set where  is much larger than ,  approximately

follows a standard normal distribution. Therefore, an observation

with | | larger than 3 can be treated as a outlier. And if { }=1 don't seem to arise from a normal distribution, the assumption of

normality should be further investigated.

The normality assumption in many Bayesian hierarchical models

often corresponds to a linear model. For example, Equation 13 and

14 can be rewritten as

1  =  +  +  ·  +    N (0,  )  = 1, . . . ,  (25)

MNRAS 000, 1­13 (2020)

Bayesian riMob

Bayesian ri

3

2

1

0

1

2

3

0

5

10Rob/R

15

20

Figure 4. Posterior mean of  vs observed radii.

0.75

0.50

0.25

0.00

0.25

0.50

0.75

1.000

5

10Rob/R

15

20

Figure 5. Posterior mean of   vs observed radii.


where the region index for the coefficients are dropped for simplicity.
Therefore, given a posterior sample of model parameters () , we can calculate its studentized residual denoted by { () ,  = 1, . . . , }

following Equation 24, where  is the number of posterior samples. Then the Bayesian studentized residual  is defined as the average of them 1.
In Figure 4, we plot the Bayesian studentized residuals for each sample planet, which shows that the majority of studentized residuals scatter between -3 and +3. The only potential outlying planet is the low-mass and earth-sized TRAPPIST-1f orbiting around an ultracool dwarfs. Due to the lack of similar planets in the sample, our model has difficulty in characterizing its M-R-F relation.
Similar residual analysis can be applied to the observational layer (see Equation 19) that corresponds to a very simple linear model





=



+







N (0,

   )


 = 1, . . . , 

(26)

The Bayesian studentized residuals for this layer, denoted by {  ,  = 1, . . . , } are plotted in Figure 5. Although the resid-

uals are still distributed around 0, most of them have absolute values less than 0.5, implying normality assumption leads to overestimation of the observational scatter. A Q-Q plot of these residuals is also provided in Figure 6 to verify such departure from normality.
Therefore, the normality assumption may not be an appropriate choice to model the measurement error. This phenomenon has been hypothesized by other researchers but to the best of our knowledge has not been quantitatively justified as we have illustrated here. We

1 With the broken power law applied, there are in fact  linear models. A planet's studentized residual is computed using the coefficients of the radius region where it belongs.

M-R-F relation with Bayesian Mixture Model 9

Sample Quantiles

2 1 0 1 2
2 Th1eoretica0l Quantil1es 2

Density

5 4 3 2 1
1.0

0.5

0.0

riMob

Fitted GN

0.5

1.0

Figure 6. Q-Q plot of  .

5 4 3 2 1

Figure 7. Histogram and empirical fitting curve of   using

GN(-0.06, 0.06, 0.73). The fitted parameters are obtained by maximum likeli-
hood estimation.

R = 0.3

8

R = 0.9

R = 1.2

6

R = 1.3

Posterior Density

4

2

Count

0 2.5 5.0 7.5 10R.o0b/R12.5 15.0 17.5 20.0

0 0.1 0.0 0.1 0.2 0(.R3) 0.4 0.5 0.6 0.7

Figure

8.

Histogram

of

sample

planets

whose

 


is

larger

than

0.207.

Figure 9. Posterior distributions of  () at different .

therefore explored the use of the generalized normal (GN) distribution 2 (Nadarajah 2005) to model the residuals    and its appears

to provide a very well fit as shown in Figure 7, which indicates that the measurement errors can be modeled with a similar form. It thus remains as a part of our future work to find further evidence to support the non-normal assumption and validate it to develop more flexible models for measurement errors.
We also observe heteroskedasticity in Figure 5, i.e., there are more planets with relatively large studentized residuals in the radius regions smaller than 5 or around 15. Such pattern is in agreement with the distribution of the scaled measurement error of mass   =  /. For all sample planets, the 90% quantile of   is 0.207. In Figure 8, we plot a histogram of the sample planets whose   is larger than this quantile, which shows that the planets are clustered in the aforementioned regions. With a larger measurement error, the estimation of the true mass could be more difficult and the corresponding studentized residual would be therefore larger.

2

GN( , , )

has the density

(; , , )

=

 2  ( 1/ )

-(|

-|/)



,

where ( ·) denotes the gamma function.

6 DISCUSSION
6.1 The Impact of Flux on the M-R Relation
In this section, we illustrate how the M-R relation depends on the flux. As shown in Equation 14, the conditional mean of  is modeled as a linear function of , and the slope () measures how the flux impacts the M-R relation. In Figure 9, the posterior distributions of () at different  are plotted. Since all these distributions are away from zero, the impact of the flux is thus nonignorable. Figure 3(d) summarizes the behavior of (), indicating that the impact is not uniform along the radius. Particularly, hot-Jupiters with radius around 11 exhibit the strongest dependency on the flux.
To further illustrate the effect of flux, we plot the M-R relation from our model under different levels of flux using dashed curves in Figure 10. We also refit our model on a modified data set where the sample planets all have fixed flux. Specifically,  is set to be 1000 that is most common in our data set (see Figure 2), and  is set to be a small value (i.e. 0.1). In this way, we exclude the effect of flux from our model and plot the corresponding M-R relation using the purple curve 3. We also plot the M-R relations
3 We also provide another way to marginalize the flux in Appendix A.
MNRAS 000, 1­13 (2020)

10 Q. Ma & S. K. Ghosh
obtained by previous works in Figure 10. The method of estimating  ( |) from the results of Chen & Kipping (2017) that attempt to model  (|) is described in Appendix B.
As shown in Figure 10, the M-R relation obtained by Ma & Ghosh (2019) almost overlaps with that from our model after excluding the effect of the flux, which is as expected since they also adopt the broken power law and have a similar sample of planets. The M-R relation from Ning et al. (2018) exhibits a similar pattern but consistently prefers lower mass possibly because they use a much smaller sample with fewer massive planets. Compared to our MR relation that accounts for the impact of the flux, these two M-R relations tend to underestimate the mass for planets with higher flux and smaller radius ( 13). On the other hand, for planets with lower flux, they overestimate the mass along the entire radius range.
As mentioned in Appendix B, the M-R relation obtained by Chen & Kipping (2017) can be largely changed by the upper bound of the log mass grid. Therefore, we plot two M-R relations with different upper bounds. As shown by the yellow curve, with the upper bound at log10 (3 × 105 ) used by Chen & Kipping (2017), the mean mass increases rapidly along the radius and becomes larger than all the others after  = 6. It is because they use a sample including astronomical objects with mass up to 0.87 . With the continuity condition applied to the broken power law, the mean mass (especially for sub-Saturns and Jupiters) is pushed upwards by the impact of the included brown dwarfs and low-mass stars. Such impact could be mitigated with a smaller upper bound. For illustration, the blue curve denotes the M-R relation obtained with an upper bound at log10 (13 ), which agrees with some other M-R relations for smaller planets, but still tends to overestimate for larger planets.

6.2 Predict Masses Using the M-R-F Relation
The prediction of mass of a planet is critical for radial velocity surveys. For example, the TESS mission (Ricker et al. 2014) specially designed for small planets transiting small stars has discovered 581 candidates with radius less than 4 as of April 20th, 2020. To schedule the resource-intensive radial velocity campaign towards those potentially habitable exoplanets, the accurate mass prediction of them would be of great importance for assessing their detectability. Compared to the methods of predicting masses solely depending on the M-R relations, the use of insulation flux as an additional object could reduce the intrinsic scatter and therefore likely to yield more accurate predictions.
The prediction of masses based on our modeled M-R-F relation can be accomplished by the corresponding conditional posterior predictive distribution defined as



( |, , D) = ( |, , ) (|D),

(27)

where (|D) denotes the posterior distribution of the parameters in our M-R-F model. Using the posterior samples of , we plot the posterior 68% prediction region of mass versus the radius under two levels of flux in Figure 11 that shows higher flux could lead to the larger values of predicted mass at the same radius value.
As an example, we calculate the mass prediction of HR858 b/c/d and TOI-813 b that are all exoplanet newly confirmed by TESS. Table 3 summarizes the measured radii and fluxes of them.
Discovered by Vanderburg et al. (2019), HR858 b, c and d are super-Earths orbiting around a naked-eye F-type star. Following the treatment for data preprocessing used by Chen & Kipping (2017), their mass predictions from our M-R-F model are computed and also

MNRAS 000, 1­13 (2020)

Table 3. Mass predictions (68% central prediction interval) of newly confirmed exoplanets by TESS.

Planet Name
HR858 b HR858 c HR858 d TOI-813 b

 / 2.085+-00..006684 1.939+-00..006699 2.164+-00..008863 6.71+-00..3388

  / 989.70-+6525..5800
512+-2296 217+-1132 23.1+-43..61

Mass Pred./ 8.72+-74..4083 7.49+-63..3498 7.98-+63..7665 13.86+-162.4.332

included in Table 3. From limited observations of radial velocities, Vanderburg et al. (2019) conclude that the 95% upper limit on the masses of the three planets is around 45 using the RadVel package(Fulton et al. 2018). For comparison, our estimates of the same quantity are about 30, 26 and 27 for HR858 b, c and d respectively, which are in good agreement with their estimate.
TOI-813 b is a Neptune-like exoplanet discovered by Eisner et al. (2020). It is a transiting planet orbiting around an evolved star with a long orbital period, and is therefore of great interest for RV followups. Using the M-R model developed by Chen & Kipping (2017), Eisner et al. (2020) report a mass prediction at 42+-4199 . Considering that our model also incorporates the flux and is conditioned on a more comprehensive exoplanet sample, our predicted mass at around 14+-162  has smaller uncertainty and could be more accurate.
6.3 Transition Points in Radius
Our M-R-F model identifies two transition locations in radius at around 8 and 13 that divide the radius space into Neptunes, sub-Saturns and Jupiters. These are slightly larger than those found by earlier researchers which explored only the mass-radius space (e.g. Ma & Ghosh 2019; Ning et al. 2018; Bashi et al. 2017). The masses of the planets in the first two regions both increase in radius, as the degeneracy pressure only plays a minor role in determining the radius for less massive planets (Zapolsky & Salpeter 1969). However, as shown in Figure 3(b), the intrinsic scatter of sub-Saturns is significantly higher than that of Neptunes. A possible explanation is that sub-Saturns have larger variation in the fraction of H/He envelope, and the equation of state of these light elements significantly impact the observed M-R-F relation. The second transition point could be treated as the threshold beyond which the compression due to the large mass starts to take strong effect, and significant mass loss due to high flux might occur.

6.4 Selection Effects
The selection effects persisting with any piratical sample of exoplanets have two major sources. The first is the non-constant detection completeness that is decided by a combination of factors including the instrument and the data processing pipeline. For example, transit surveys tend to detect planets with larger radius and higher incident flux. This issue can be partially addressed by obtaining a more homogeneous sample (e.g. Wolfgang et al. 2016; Neil & Rogers 2018, 2020). We instead don't constrain our sample as the mixture model has better capability in handling heterogeneity. One can also corrects the detection bias by modeling the survey completeness as a function of parameters of interest (e.g. Fulton et al. 2017; Neil & Rogers 2020), which is the direction of our future work.
The ground-based follow-up observations also introduce selection bias that is much harder to deal with. Unlike the detection completeness that becomes less concerning when estimating the conditional

M-R-F relation with Bayesian Mixture Model 11
103

E(M|R)

102

101

FFFE===xc211l000u00Fde0FFF

MNCChhianee&gnnG&&ehtKKoaiispplh.pp((2ii2nn00gg11((8229)00)1177)) III

5

10 R/R

15

20

Figure 10. The mass-radius relation obtained by our model and previous work. The shaded region is the 68% confidence interval the M-R relation. The blue and yellow curves are obtained from Chen & Kipping (2017) with upper bounds of the log mass grid at log10 (3 × 105 ) and log10 (13 ), respectively. The yellow curve is horizontally truncated as the range of  axis is intentionally limited to better display the details of other M-R relations.

F=500F
103 F=1000F

function in a tractable way as well as all non-detections (Burt et al. 2018; Montet 2018).

Mass Prediction

102

101

5

10 R/R 15

20

Figure 11. Posterior mean (solid curves) and 68% prediction region (shaded areas) of the mass given the radius and the flux.

distribution (e.g.  ( |, )), the follow-up strategy could bias the estimation of both joint and conditional distribution in the same manner. Meanwhile, the decision process is usually not transparent and subject to human evaluation, which makes it impractical to model the selection function quantitatively for existing catalogs. To fully address this follow-up selection bias in subsequent statistical modeling, it is critical for the follow-up groups to report their selection

7 CONCLUSION
In this work, we present a Bayesian hierarchical finite mixture model (BFMM) to approximate the 3-dimensional joint distribution of the planetary mass, radius and flux. Conditioned on a sample of 319 exoplanets, the key findings from our models are summarized below:
· The relationship between mass and radius has a nonnegligible dependence on the flux, especially for hot-Jupiters with radius around 11. The planets receiving higher level of flux tend to be denser, possibly because of the H/He envelope evaporation caused by stellar XUV flux. Hot-Jupiters larger than 13 and receiving strong stellar irradiation exhibit a trend of decreasing mass with increasing radius, indicating that significant atmospheric mass loss could happen during their evolution.
· With the assumption of broken power law, we find two transition locations in radius at around 8 and 13, which are slightly larger than those found by previous works (e.g. Ma & Ghosh 2019; Ning et al. 2018; Bashi et al. 2017).
· The flux is a key ingredient for mass prediction. The M-R relation that fails to account for the flux may overestimate or underestimate the mass for planets with low or high flux, respectively.
It is to be noted that our proposed modeling framework that make use of FMM, can also be adopted to explore the impact of period
MNRAS 000, 1­13 (2020)

12 Q. Ma & S. K. Ghosh
(P) on M-R relation and can possibly be extended to develop more general models that can approximate the 4-dimensional joint distribution of (Mass)M-Radius(R)-Flux(F)-Period(P). However, such higher-dimensional extensions are admittedly non-trivial as we'd need a much larger sample of data set on M-R-F-P to accurately estimate such a 4-d distribution.
From a methodological perspective, a major contribution of this work is that we proposed two novel methods for model checking which can be used more broadly than just for exploring the validity of our proposed joint models. The robust Hotelling's test can be used to measure the discrepancy between the model and the observed data, as well as identify outliers for further examination. And the Bayesian studentized residual analysis is a powerful tool to validate distributional assumptions in Bayesian hierarchical modeling. Finally, we also point out the possible violation of the normality assumptions for the measurement error models that are predominantly used in astronomy literature. We have suggested the use of generalized normal models which requires further more in-depth explorations in future at a more computational cost.
ACKNOWLEDGEMENTS
This paper includes data collected by the Kepler mission. Funding for the Kepler mission is provided by the NASA Science Mission directorate. This paper makes use of data from the first public release of the WASP data (Butters et al. 2010) as provided by the WASP consortium and services at the NASA Exoplanet Archive, which is operated by the California Institute of Technology, under contract with the National Aeronautics and Space Administration under the Exoplanet Exploration Program.
DATA AVAILABILITY
The data and code underlying this article are available in Zenodo, at https://doi.org/10.5281/zenodo.4774442. The data set was derived from sources in the public domain: The Confirmed Planets table of NASA Exoplanet Archive, at https://dx.doi.org/10. 26133/NEA1.
REFERENCES
Akeson R. L., Chen X., Ciardi D., et al., 2013, PASP, 125, 989 Arras P., Socrates A., 2010, ApJ, 714, 1 Baraffe I., Selsis F., Chabrier G., et al., 2004, A&A, 419, L13 Bashi D., Helled R., Zucker S., et al., 2017, A&A, 604, A83 Buchhave L. A., Bizzarro M., Latham D. W., et al., 2014, Nature, 509, 593 Burt J., Holden B., Wolfgang A., et al., 2018, AJ, 156, 255 Butters O. W., West R. G., Anderson D. R., et al., 2010, A&A, 520, L10 Chen J., Kipping D., 2017, ApJ, 834, 17 Dembo A., Shao Q. M., 2006, Electron. Commun. Probab., 11, 149 Demory B. O., Seager S., 2011, ApJS, 197, 12 Einasto M., Vennik J., Nurmi P., et al., 2012, A&A, 540, A123 Eisner N. L., Barragán O., Aigrain S., et al., 2020, MNRAS, 494, 750 Fulton B. J., Petigura E. A., Howard A. W., et al., 2017, AJ, 154, 109 Fulton B. J., Petigura E. A., Blunt S., et al., 2018, PASP, 130, 044504 Gelman A., Rubin D. B., 1992, Statistical Science, 7, 457 Gelman A., Carlin J. B., Stern H. S., et al., 2013, Bayesian data analysis, 3
edn. Chapman and Hall/CRC Gieren W. P., Fouqué P., Gómez M., 1998, ApJ, 496, 17 Guillot T., Showman A. P., 2002, A&A, 385, 156 Hadden S., Lithwick Y., 2014, ApJ, 787, 80
MNRAS 000, 1­13 (2020)

Hotelling H., 1931, Ann. Math. Statist., 2, 360 Hubbard W. B., Hattori M. F., Burrows A., et al., 2007, Icarus, 187, 358 Kanodia S., Wolfgang A., Stefansson G. K., Ning B., Mahadevan S., 2019,
The Astrophysical Journal, 882, 38 Kariya T., 1981, The Annals of Statistics, 9, 211 Kelly B. C., 2007, ApJ, 665, 1489 Kovács G., Bakos G. Á., Hartman J. D., et al., 2010, ApJ, 724, 866 Lammer H., Selsis F., Ribas I., et al., 2003, ApJ, 598, L121 Laughlin G., Crismani M., Adams F. C., 2011, ApJ, 729, L7 Lee S. X., McLachlan G. J., 2016, Statistics and Computing, 26, 573 Lee K. J., Guillemot L., Yue Y. L., et al., 2012, MNRAS, 424, 2832 Li J. Q., Barron A. R., 1999, Advances in neural information processing
systems, 12, 279 Lopez E. D., Fortney J. J., Miller N., 2012, ApJ, 761, 59 Ma Q., Ghosh S. K., 2019, AJ, 158, 86 Mardia K. V., 1975, Journal of the Royal Statistical Society: Series C (Applied
Statistics), 24, 163 Melchior P., Goulding A. D., 2018, Astronomy and Computing, 25, 183 Miller N., Fortney J. J., 2011, ApJ, 736, L29 Mills S. M., Mazeh T., 2017, ApJ, 839, L8 Montet B. T., 2018, Research Notes of the American Astronomical Society,
2, 28 Nadarajah S., 2005, Journal of Applied Statistics, 32, 685 Neil A. R., Rogers L. A., 2018, ApJ, 858, 58 Neil A. R., Rogers L. A., 2020, ApJ, 891, 12 Nguyen T. T., Nguyen H. D., Chamroukhi F., McLachlan G. J., 2020, Cogent
Mathematics & Statistics, 7, 1750861 Ning B., Wolfgang A., Ghosh S. K., 2018, ApJ, 869, 5 Peel D., McLachlan G. J., 2000, Statistics and Computing, 10, 339 Plummer M., 2003, in Proceedings of the 3rd international workshop on
distributed statistical computing. pp 1­10 Ricker G. R., Winn J. N., Vanderspek R., et al., 2014, in Oschmann Jacobus M.
J., Clampin M., Fazio G. G., MacEwen H. A., eds, Society of PhotoOptical Instrumentation Engineers (SPIE) Conference Series Vol. 9143, Space Telescopes and Instrumentation 2014: Optical, Infrared, and Millimeter Wave. p. 914320 (arXiv:1406.0151), doi:10.1117/12.2063489 Roeder K., Wasserman L., 1997, Journal of the American Statistical Association, 92, 894 Sestovic M., Demory B. O., Queloz D., 2018, A&A, 616, A76 Spiegel D. S., Burrows A., Milsom J. A., 2011, ApJ, 727, 57 Spiegelhalter D. J., Best N. G., Carlin B. P., et al., 2002, Journal of the royal statistical society: Series b (statistical methodology), 64, 583 Steele R. J., Raftery A. E., 2010, Frontiers of statistical decision making and bayesian analysis, 2, 113 Steffen J. H., 2016, MNRAS, 457, 4384 Tremblin P., Chabrier G., Mayne N. J., et al., 2017, ApJ, 841, 30 Valencia D., Ikoma M., Guillot T., et al., 2010, A&A, 516, A20 Van Aelst S., Willems G., 2013, Journal of Statistical Software, 53, 1 Vanderburg A., Huang C. X., Rodriguez J. E., et al., 2019, ApJ, 881, L19 Watanabe S., 2013, Journal of Machine Learning Research, 14, 867 Weiss L. M., Marcy G. W., 2014, ApJ, 783, L6 Weiss L. M., Marcy G. W., Rowe J. F., et al., 2013, ApJ, 768, 14 Willems G., Pison G., J R. P., et al., 2002, Metrika, 55, 125 Wolfgang A., Rogers L. A., Ford E. B., 2016, ApJ, 825, 19 Wu Y., Lithwick Y., 2013, ApJ, 763, 13 Yelle R. V., 2004, Icarus, 170, 167 Zapolsky H. S., Salpeter E. E., 1969, ApJ, 158, 809
APPENDIX A: REMOVE THE IMPACT OF FLUX USING KERNEL DENSITY ESTIMATOR
In Section 6.1, the impact of flux is removed by refitting our model on a modified data set. Here we show another way to achieve the same purpose based on the kernel density estimator (KDE):
(i) Using a set of model parameters  and following Equation 6, 9

103

102

E(M|R)

101
Refit with Fixed Flux KDE

5

10 R/R 15

20

Figure A1. Comparison of two methods to exclude the impact of flux from our model.

M-R-F relation with Bayesian Mixture Model 13

masses. Then  ( |) can be estimated by

 ( |; ) =

1


 10


=1

(iv) Repeat (i) to (iii) for  sets of posterior model parameters to get { ( |; () ),  = 1, . . . , } whose average and quantiles are
the posterior estimate and credible interval of  ( |).

We

find

that

the

choice

of

the

upper

bound

()
g

can

largely

change the shape of the obtained M-R relation. Therefore, two M-R

relations from Chen & Kipping (2017) are plotted, one with their original upper bound at log10 (3 × 105 ), the other with an upper bound at log10 (13 ).

This paper has been typeset from a TEX/LATEX file prepared by the author.

and 13, generate flux, radius and mass samples {(, , ),  = 1, . . . , }, where  is the number of samples.
(ii) Use KDE and {(, ),  = 1, . . . , } to estimate the joint distribution of mass and radius, denoted by (, ; ).
(iii) For a given radius , Estimate  ( |) with





 ( |; ) = ( |)  =

(, )  (, ) 





(iv) Repeat (i) to (iii) for  sets of posterior model parameters to get { ( |; () ),  = 1, . . . , } whose average and quantiles are
the posterior estimate and credible interval of  ( |).

In Figure A1, we compare the M-R relations obtained by the two methods of removing the impact of flux. In general, they follow a similar trend but exhibit slight difference around 10. It's because the model parameters used for sample generation are still subject to the impact of flux, although we attempt to marginalize the flux later. In our words, the method of refitting the model with fixed flux removes the impact of flux more completely.

APPENDIX B: FROM CONDITIONAL EXPECTATION OF RADIUS TO CONDITIONAL EXPECTATION OF MASS

Different from other works included in Figure 10, Chen & Kipping (2017) model  (|), and thus we cannot obtain  ( |) directly from their results. In this section, we describe how to deal with it following their treatment for mass prediction (see Section 5.3 in Chen & Kipping (2017)).
For a given radius  (or ), the expected mass can be estimated with the following steps:

(i) Prepare an equally partitioned grid of mass in log scale, de-

noted

by

{

()
g

,



=

1, . . . , },

where



is

the

number

of

grid

points,

and

()
g

is

the

upper

bound

of

this

grid.

(ii) Using a set of model parameters , Estimate



(

()
g

|;

)





(



|

()
g

;

)



(

()
g

)

 = 1...

where (|; ) is directly modeled by Chen & Kipping (2017), and () is a constant as  has a uniform prior in their model.
(iii) Perform weighted sampling from the grid of mass with the above probabilities. Let {,  = 1, . . . , } denote the sampled log

MNRAS 000, 1­13 (2020)

