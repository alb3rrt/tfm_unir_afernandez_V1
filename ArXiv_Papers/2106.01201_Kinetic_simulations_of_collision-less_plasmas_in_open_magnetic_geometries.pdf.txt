arXiv:2106.01201v1 [physics.plasm-ph] 2 Jun 2021

Kinetic simulations of collision-less plasmas in open magnetic geometries
Atul Kumar1, Juan F Caneses Marin2
Oak Ridge National Laboratory, 1 Bethel Valley Road, Oak Ridge, TN-37831, USA E-mail: 1kumara1@ornl.gov, and 2canesesmarjf@ornl.gov
Abstract. Laboratory plasmas in open magnetic geometries can be found in many different applications such as (1) Scrape-Of-Layer (SOL) and divertor regions in toroidal confinement fusion devices ( 1 - 102 eV), (2) linear divertor simulators ( 1 - 10 eV), (3) plasma-based thrusters ( 10 eV) and (4) magnetic mirrors ( 102 - 103 eV). A common feature of these plasma systems is the need to resolve, in addition to velocity space, at least one physical dimension (e.g. along flux lines) to capture the relevant physics. In general, this requires a kinetic treatment. Fully kinetic Particle-In-Cell (PIC) simulations can be applied but at the expense of large computational effort. A common way to resolve this is to use a hybrid approach: kinetic ions and fluid electrons. In the present work, the development of a hybrid PIC computational tool suitable for open magnetic geometries is described which includes (1) the effect of non-uniform magnetic fields, (2) finite fully-absorbing boundaries for the particles and (3) volumetric particle sources. Analytical expressions for the momentum transport in the paraxial limit are presented with their underlying assumptions and are used to validate the results from the PIC simulations. A general method is described to construct discrete particle distribution functions in state of mirror-equilibrium. This method is used to obtain the initial state for the PIC simulation. Collisionless simulations in a mirror geometry are performed. Results show that the effect of magnetic compression is correctly described and momentum is conserved. The self-consistent electric field is calculated and is shown to modify the ion velocity distribution function in manner consistent with analytic theory. Based on this analysis, the ion distribution function is understood in terms of a loss-cone distribution and an isotropic Maxwell-Boltzmann distribution driven by a volumetric plasma source. Finally, inclusion of a Monte-Carlo based Fokker-Planck collision operator is discussed in the context of future work.
 This manuscript has been authored by UT-Battelle, LLC, under contract DE-AC05-00OR22725 with the US Department of Energy (DOE). The US government retains and the publisher, by accepting the article for publication, acknowledges that the US government retains a nonexclusive, paid-up, irrevocable, worldwide license to publish or reproduce the published form of this manuscript, or allow others to do so, for US government purposes. DOE will provide public access to these results of federally sponsored research in accordance with the DOE Public Access Plan (http://energy.gov/downloads/doepublic-access-plan).

Kinetic simulations of collision-less plasma in open magnetic geometries

2

1. Introduction: Context and objectives

The main objective of the work herein presented is the development of computational tools to model the evolution of the distribution function of plasmas in open magnetic geometries in the presence of non-uniform magnetic fields, Radio-Frequency (RF) heating and/or volumetric plasma sources. Important examples of such plasma systems include (1) Scrape-Of-Layer (SOL) and divertor regions in toroidal confinement fusion devices ( 1 - 100 eV), (2) linear divertor simulators ( 1 - 10 eV) such as the MPEX1,2 , (3) plasma-based thrusters ( 10 eV) such as the VASIMR3 and (4) magnetic mirrors ( 102 - 103 eV) such as the WHAM4,5 .
Understanding, predicting and controlling the velocity-space distribution of these plasma systems and associated parallel transport is required to achieve their scientific/technical objectives. For example, calculating the SOL heat fluxes and ionization/excitation rates in the divertor region require the inclusion of kinetic effects to correctly describe the contribution of non-thermal distribution functions. Another example is the application of RF heating in linear divertor simulators to increase plasma temperature. In the MPEX concept,1,2 this is done via resonant RF heating schemes where the interplay between RF-driven velocity space diffusion, collisional relaxation and magnetic mirror effects determine the evolution of the distribution function. An important feature of these plasma systems is that in addition to resolving the physics in velocity space, the dimension along the magnetic field needs to be retained. The kinetic description of these systems is best done with the Boltzmann transport equation with suitable source and sink terms. In the context of plasmas, the acceleration term in the Boltzmann transport equation is replaced by the Lorentz force which leads to the so-called Vlasov-Maxwell system of equations.
An important method for solving the Vlasov-Maxwell system of equations is the Particle-In-Cell (PIC) technique which describes both ions and electrons kinetically. Moreover, when ions are treated kinetically while electrons are modeled as a fluid, the technique is refereed to as hybrid PIC. This method allows ions to develop nonthermal distributions and provide means to intrinsically capture many effects that are difficult, if not impossible, to capture in a fluid-ion formulation. Examples of phenomena that may require a non-Maxwellian treatment of ions include: flow interpenetration,6­9 ion-viscosity, non-isotropic pressure,10 acceleration of low density ion beams, finite ion gyroradii effects,11 diffusion and kinetic mix at shocked interfaces,12­14 and plasma heating11,15,16 . Moreover, such hybrid codes are not restricted to resolving electron spatial scales such as the Debye length, the electron skin depth or the electron gyroradius, and their associated time scales. Thus, it is possible to use these hybrid codes to model much larger spatial/temporal scales and use higher dimensionality than is practical using a fully kinetic method. However, with fluid electrons, inertial electron dynamics or other electron kinetic effects are not resolved. An additional advantage of hybrid over fully-kinetic methods is the presence of a well-defined electron temperature, and thus it is easier to interface the system with physics modules such as equation-of-

Kinetic simulations of collision-less plasma in open magnetic geometries

3

state (EOS), ionization, and radiation transport. Different flavors of kinetic-ion hybrid particle codes are being used for many years to capture the details of physics related to ion heating17, 18 magnetized pinches,19­21 space plasmas22­25 magnetic fusion energy26­28 and high-energy-density physics (HEDP)29­31 . Furthermore, there are many vibrant areas of research in magnetic fusion that relate directly to kinetic-ion physics.
In this paper, the development of a parallel, electromagnetic, Hybrid ParticleIn-Cell (PIC) code is described and employed to simulate plasmas in open magnetic geometries. The code resolves 1 dimension in physical space (1D) and three dimensions in velocity space (3D). In the present work, the collision-less evolution of the ion Probability Density Function (PDF) in a magnetic mirror is investigated as this forms the basis of many plasma systems with non-uniform magnetic field geometries where the physical dimension along the magnetic flux must be retained. Addition of Coulomb collisions, RF heating and volumetric particle/energy sources and sinks to this modelling capability allows simulation of various systems of interest such as those mentioned previously.
This paper is structures as follows: (1) an overview of the hybrid PIC technique is presented followed by (2) a description of important physics required to apply the hybrid PIC to open magnetic geometries. Next, (3) the particle and momentum transport in the paraxial limit are introduced and associated assumptions presented. This is followed by (4) a discussion on setting the initial conditions for the PIC calculations, (5) the presentation of the results and (6) discussion.

2. Overview of the Hybrid Particle-In -Cell technique

The PIC simulation technique is commonly used in plasma physics to study kinetic effects in plasmas not captured in fluid models;32,33 moreover, the use of the hybrid PIC approach enables simulation of plasma systems over timescales much longer than practically realizable with fully-kinetic (PIC) simulations at the price of not incorporating a full kinetic treatment of electron dynamics. This level of description is well adapted to phenomena occurring on length scales comparable to, or greater than, the ion inertial length, and on timescales comparable to the ion gyro-period.13,34 The hybrid PIC model describes the different ion populations as a collection of superparticles and the electrons as a neutralizing, mass-less fluid. The dynamics of the ion is governed by the Lorentz force Eq. 1 and Eq. 2, where r and v are the position and velocity vector of an ion of species  respectively, and m and Z are the corresponding mass and charge state. On the other hand, electrons are considered as an isotropic and isothermal ideal gas, Pe = nTe.

dr dt

=

v

(1)

m

dv dt

=

eZ[E(r) + v × B(r)]

(2)

Kinetic simulations of collision-less plasma in open magnetic geometries

4

To advance ions in time according to equations(1-2), a time-centered. finite difference

leapfrog method33,35 is employed. The electric E and magnetic B fields are linked

together by the generalized Ohm's law (Eq. 3), where n is the plasma density, Jp the

plasma current, B is the total magnetic field, Ui the total ion bulk velocity and Pe the

electron pressure.

1

1

E = en Jp × B - Ui × B - en Pe

(3)

In the above expression, the total magnetic field B is composed of the externally applied

magnetic field B0 and the plasma contribution Bp (Eq. 4). Moreover, the plasma

current Jp is calculated via Ampere's law in the low frequency limit (Eq. 5) where Bp

is advanced via Faraday's law (Eq. 6).

B = B0 + Bp

(4)

 × Bp = µ0Jp

(5)

Bp = - × E

(6)

t

The electric field in Eq.(3) is a state quantity36 which is a function of ions moments:

density n, ion bulk velocity Ui, magnetic field B and electron temperature Te. This implies that the electromagnetic fields in the Hybrid PIC approach are solved without

specifying field boundary conditions. Moreover, the electromagnetic fields are described

using a 1-D staggered grid37,38 which effectively produces a central difference operator

with an error of order O(x2). The total ion bulk velocity Ui is given by Eq. 7 where the summation is over k species of ions, u and n are the bulk velocity and ion number density of species  respectively.

Ui =

k =1

(Znuj)

k=1(Zn)

(7)

The plasma density n is obtained from the quasi-neutrality condition:

k

n  ne = (Zn)

(8)

=1

A hybrid PIC model for the multi-species case can be completely defined by Equations

(1)­(8). This model exhibits the existence of low-frequency kinetic electrostatic modes

such as ion-Bernstein waves, as well as electromagnetic modes including ion-cyclotron

waves and Alfvén waves.

It is important to note that solving Eq. 1 and Eq. 2 in a PIC framework is equivalent

to solving the Vlasov equation using the single particle (Klimontovich) Probability

Distribution Function (PDF) for each species  presented in Eq. 9. In this expression,

NSP is the total number of super-particles, NC the total number of computational particles and ai is the weight of the ith computational particle of species . Each delta function product represent a particle in phase-space whose trajectory (ri (t), vi(t)) is
defined by Eq. 1 and Eq. 2.

f(r, v, t)

=

1 NSP

NC
ai (r - ri (t))(v - vi(t))
i=1

[m-6s-3]

(9)

Kinetic simulations of collision-less plasma in open magnetic geometries

5

In the present work, the electromagnetic parallel hybrid PIC code PROMETHEUS++14 is employed. PROMETHEUS++ solves for the plasma dynamics in one dimension in physical space and 3 dimensions in velocity space (1D-3V). PROMETHEUS++ is used as the starting point for developing a hybrid modelling capability for plasma systems confined in open magnetic field geometries such as SOL plasmas, linear divertor simulators, electric thrusters and/or mirror devices.

3. Hybrid PIC for open magnetic geometries
The 1D-3V hybrid PIC code PROMETHEUS++ as described in reference14 assumes uniform profiles along the spatial dimension and periodic particle boundary conditions. For the present study, PROMETHEUS++ has been used as the basis and significantly modified to make it suitable for simulating plasmas in open magnetic geometries. The main modifications include: (1) the effect of externally applied non-uniform magnetic fields and (2) presence of finite boundaries and (3) volumetric particle sources. The presence of non-uniform magnetic fields, introduces radial variation in the plasma cross section which effectively produces a 1.5D-3V PIC code. As a result, the code is hereafter referred to as "PRO++ OMG" where OMG is an abbreviation for Open Magnetic Geometries.

3.1. Non-uniform magnetic fields

As described in section 2, the PIC formulation is equivalent to solving the Vlasov equation using a Klimontovich PDF (Eq. 9), where each delta function represents a super-particle in phase-space whose trajectory is governed by the equations of motion shown in Eq. 1 and Eq. 2. In a 1D-3V formulation, two out of the three dimensions in physical space are integrated out leading to the reduced Klimontovich PDF shown in Eq. 10, where A(xi) represents the cross sectional area of the plasma at the position xi and ai is the weight of each computational particle.

f(x, v, t)

=

1 NSP

NC i=1

ai A(xi )

(x

-

xi )(v

-

vi)

[m-6s-3]

(10)

To illustrate the effect of magnetic compression due to a non-uniform magnetic field, the above PDF is integrated over all velocity space to obtain the zeroth moment (Eq. 11) and consequently the particle density n for the  species. In Eq. 11, the term NR is the total number of real particles of species  represented in the computational domain. Using conservation of magnetic flux in the form Bx0A0 = Bx(x)A(x) where Bx0 and A0 are the magnetic field and plasma cross sectional area respectively at some reference location, the particle density for the  species is given by Eq. 12. The term Bx(xi )/Bx0 represents the magnetic compression effect caused by the non-uniform externally applied magnetic field. In the case of a uniform magnetic field, the compression term becomes

Kinetic simulations of collision-less plasma in open magnetic geometries

6

unity and the usual particle density expression is recovered as in reference.39 As a result, inclusion of magnetic compression effectively leads to a 1.5D-3V PIC formulation.

n(x, t) = NR f(x, v, t)d3v

(11)

n(x, t)

=

NR NSP

1 A0

NC i=1

ai

Bx(xi ) Bx0

(x

-

xi )

[m-3]

(12)

3.2. Finite boundaries
When particles exceed the boundaries of the computational domain, they are reintroduced back into the domain according to a set of rules. These rules determine the state of the computational particle on the next time step in the simulation. The state of each computational particle is completely defined by its (1) position xi, (2) velocity vector vi and (3) weight ai. Depending on how the particle state is updated after it has left the computational domain, periodic, reflecting or fully-absorbing boundary conditions for the particles can be implemented. For example, to model a system with no physical boundaries, a simple periodic boundary condition for the computational particles can be used where only the position state is updated. To model a system with finite boundaries, fully-absorbing boundary conditions for the particles are required where all the particle states are updated.

3.3. Volumetric particle sources
In the present study, the rules which update the state of the computational particles upon re-injection are chosen to model volumetric plasma sources such as: Neutral Beam Injection (NBI), isotropic warm-plasma sources or a combination of them.
To update the computational particle position xi and velocity vector vi, the PDF of the particle source needs to be specified. For example to model NBI, the PDF of the beam needs to be specified using the following parameters: (1) beam injection location and (2) beam width in physical space, (2) beam energy, (3) beam temperature and (4) beam pitch angle. Setting the beam energy to zero and setting the temperature to a suitable value allows modelling a warm plasma source. Using these parameters, positions xi and velocity vectors vi are randomly sampled from the plasma source PDF using a Box-Muller or Metropolis-Hastings (MH) algorithm.40
In the strategy employed to update the computational particle weight ai, it is necessary to distinguish between "real", "super" and "computational" particles. The PIC code employs a fixed number of computational particles NC; that is, the number of memory locations updated in each PIC cycle is fixed. However, to allow for a timedependent real particle density driven by volumetric particle sources and sinks, each computational particle must have a time-dependent weight. Since the total number of computational particles NC at any time step is fixed; the flux of computational particles out of the domain is equal to the flux into the domain. Hence, the new particle weight ai is calculated by dividing the requested particle injection rate by the

Kinetic simulations of collision-less plasma in open magnetic geometries

7

influx of computational particles. In general, the requested particle injection rate can be time-dependent. In this strategy, the computational particle weight ai can change only if it crosses the boundaries of the computational domain and is re-injected into the simulation.

4. Particle and momentum transport in the paraxial limit
As stated in the introduction (section 1), mirror physics forms the basis of plasma systems where, in addition to velocity space, the physical dimension along the magnetic field must be resolved to extract the desired physics. An important step in the development of the 1D-3V hybrid PIC for open magnetic geometries is to confirm that the effect of spatially-dependent magnetic fields is correctly described. This can be achieved by testing conservation of momentum along the computational domain.
The purpose of this section is to present the particle and momentum transport equations for a plasma in the so-called paraxial limit.41­43 In this framework, moments of the Vlasov equation are calculated in the limits of small inverse aspect ratio R/L 1 and small gyro-radius rL/R 1 where L and R are the axial and radial scale lengths respectively and rL is the gyro-radius. Important assumptions required to produce the transport equations in the paraxial limit are also presented.

4.1. Assumptions

4.1.1. The magnetic field in the paraxial limit The externally applied magnetic field B0 is described in cylindrical coordinates (r, , x) by Eq. 13, where x is the coordinate along the length of the plasma system. The azimuthal magnetic field components B is neglected. The radial magnetic component Br (Eq. 14) is obtained by setting  · B0 = 0 and assuming that Bx varies only along the x coordinate. This approximation is well suited for long-thin magnetized plasma columns and has the property that Bx Br. This implies that the angle  between the magnetic field vector B0 and x^ is small ( 1) such that sin   , cos  1 , tan   and Bx  |B0| = B.

B0 = Bxx^ + Br^r

(13)

Br

=

r -
2

Bx x

(14)

4.1.2. Magnetic field aligned coordinate system A coordinate system aligned with the magnetic field can be produced whose unit vectors are given by Eq. 15 and Eq. 16, where  is the angle between the magnetic field vector and x^. The unit vector s^ is tangent to the magnetic field while n^ is normal to both s^ and ^. In this way, the unit vectors s^, n^, ^ form an orthogonal set and thus a coordinate system aligned with the magnetic field vector at every point along the plasma.

^s = + cos x^ + sin ^r

(15)

Kinetic simulations of collision-less plasma in open magnetic geometries

8

n^ = - sin x^ + cos ^r

(16)

Moreover, the differential operators in cylindrical coordinates expressed in terms of the

field-aligned coordinates are given by Eq. 17 and Eq. 18.



= cos  

sin  -



(17)

x

s s 



 cos  

= sin  +

(18)

r

s s 

4.1.3. Radial transport constraint In cylindrical coordinates, the bulk plasma flow is described by Eq. 19, where x^ is the unit vector along the length of the plasma and ^r the radial unit vector. Assuming that the parallel transport far exceeds the radial transport under conditions of strong magnetization, the radial transport can be constrained by declaring u · n^ = 0 which leads to Eq. 20 and hereafter referred to as the "radial transport constraint".44

u = uxx^ + ur^r + u^

(19)

ur

=

ux

Br Bx

(20)

4.2. Particle and momentum transport

The zeroth and first moments of the Vlasov equation lead to the particle and momentum transport equations for the species  presented in Eq. 21 and Eq. 22 and taken from Ref.(45).

n t

+



·

(nu)

=

G

(21)



t (mnu) +  · (mnuu + P) = qn(E + u × B)

(22)

Assuming that inertia is dominated by ions and using quasi-neutrality (n = ne = ni), the single-fluid momentum transport equation is given by Eq. 23, where M = mi + me, u is the plasma bulk velocity given by Eq. 24 and the plasma pressure P is given by Eq. 25.

 (M nu) t

+



·

(M nuu)

=

-

·

P

+

J

×

B

(23)

u = miui + meue

(24)

mi + me

P = Pi + Pe

(25)

To proceed, divergence operators in 23 are expanded in cylindrical coordinates and then transformed to the field-aligned coordinate system using Eq. 17 and Eq. 18 and the unit vectors given in Eq. 16 and Eq. 15. Moreover, the pressure tensor P is given in terms of the field-aligned coordinate system as shown in Eq. 26. The radial transport constraint

Kinetic simulations of collision-less plasma in open magnetic geometries

9

(Eq. 20) is applied and the magnetic field in the paraxial limit is used. This leads to the particle and single-fluid parallel momentum transport equations in the paraxial limit presented in Eq. 27 and Eq. 28 respectively, where s is the coordinate along the magnetic flux.

P = P ^s^s + Pn^n^ + P^^

(26)

n + B  nu  t s B

= G

(27)



 M nu u

(M nu ) + B

P =-

- P - P

B

(28)

t

s B

s

B s

Eq. 28 is a general statement of momentum conservation in one dimension in physical space (along the magnetic flux) and includes the effect of a non-uniform magnetic field. As the plasma flows into regions of higher magnetic field, it experiences magnetic compression due to the reduction in cross-sectional area. It is worthwhile to note that in steady-state and in the absence of plasma flow, Eq. 28 reduces to the classic mirror force balance equation as shown in Eq. 29 and taken from reference.46

P

+ P - P

B =0

(29)

s

B s

4.2.1. Distribution function It is important to note that in all the transport equations presented above, no assumption is made about the form of the distribution function. All terms represent integrals of an unspecified distribution function. In general, each transport equation is coupled to the next higher order transport equation and leads to the problem of fluid closure. To provide closure, assumptions are made on the form of the distribution function as in the Braginskii fluid plasma formalism47,48 where the distribution function is explicitly assumed to be a Maxwellian to first order with first-order non-Maxwellian corrections. In the present work, the form of the distribution function is not imposed as this is calculated self-consistently by the hybrid PIC code and the transport equations herein presented, in particular (Eq. 28), are specifically used to validate the results produced by the PIC code. More specifically, using the particle positions and velocities evolved by the PIC code, the moments of the distribution function (n, u , P , P) are calculated as a function of physical space and each term in Eq. 28 is evaluated to test conservation of momentum and thereby validate the new physics added to the code: (1) non-uniform magnetic fields, (2) finite boundaries and (3) volumetric sources.

5. Initial conditions for the simulation
In the present 1D-3V calculation, the state of each computational particle is defined by its: (1) position xi, (2) velocity vector vi and (3) weight ai, Prior to evolving the state of the computational particles with the PIC code, the initial state of the entire set of particles needs to be specified. In the present study, the initial distribution of

Kinetic simulations of collision-less plasma in open magnetic geometries

10

particles states is chosen so as to satisfy the paraxial mirror force equation (Eq. 29). In other words, the initial state of the plasma described by the PIC is close to a state of equilibrium or force balance.
The general procedure for selecting a suitable initial condition for the entire particle set is the following:

Step-1: Define the externally applied magnetic field profile B0 along the length of the computational domain. An example is shown in figure 1.
Step-2: Given the magnetic field profile B0 from Step-1 and suitable boundary conditions for the parallel and perpendicular pressure, solve the mirror equilibrium in the paraxial limit (Eq. 29) to obtain the parallel and perpendicular pressures profiles P and P along the length of the plasma. This step is described in more detail in Appendix A.1. A solution to Eq. 29 is shown in figure 2 using the magnetic field from figure 1. In this solution, the parallel pressure at the central cell P 1 and mirror throats P 2 are specified and the perpendicular pressures are given as P1 = P 1 and P2 = P 2/3.
Step-3: Construct a 4-D probability density function (PDF) whose moments are equivalent to the new pressure profiles P (x) and P(x) obtained in step-2. The process to construct a suitable PDF is described in Appendix B.
Step-4: Apply a Metropolis-Hasting (MH) algorithm40,49,50 to randomly extract positions xi and velocity vectors vi from the 4-D PDF. This process creates a distribution of discrete particles consistent with the mirror equilibrium in the paraxial limit (Eq. 29).
Step-5: Set the particle positions xi and velocity vectors vi from Step-4 as the initial condition for Hybrid PIC simulation.

5.1. Simulation condition and input data
The hybrid PIC code PRO++OMG is targeted to any system with open magnetic geometries where the physical dimension along the magnetic field needs to be retained such as in the SOL of fusion devices, linear divertor simulators, mirror devices and plasma thrusters. In the present study, PRO++OMG is applied to a magnetic mirror geometry. The magnetic field profile and nominal plasma conditions are taken from the Wisconsin HTS Axisymmetric Mirror (WHAM) device.5 The magnetic field profile is presented in figure 1. The various parameters used in the simulation are tabulated in the Table-1 below:

Kinetic simulations of collision-less plasma in open magnetic geometries

11

Table 1. Simulation parameters for Hybrid PIC simulation

Simulation parameters

Physical value

Length of the domain L Coil to coil distance Lm Peak magnetic field B2 Central cell magnetic field B1 Central cell plasma radius R1 Electron temperature Te Ion mass number A Ion charge number Z Ion density fraction
Number of cells
Number of computational particles per cells

3.19 [m] 2.0 [m] 17 [T] 0.6 [T] 0.1 [m] 1 [keV] 1 [AMU] +1 1 500 5000

(a)
18 16 14 12 10
8 6 4 2 0
0 0.5 1 1.5 2 2.5 3

(b)
0.4 0.2
0 -0.2 -0.4 -0.6
1.6 1.8 2 2.2 2.4 2.6

Figure 1. (a) Axial magnetic field profile based on a pair of 17 T magnets separated by a distance of 2 meters. The location of the coils is represented by the red squares. The magnetic field strength at the central cell is 0.6 T. (b) Magnetic flux lines. Red rectangular box shows the position of the coils.

6. Results
6.1. Plasma profiles:
To start the 1D-3V hybrid PIC calculation, the initial state of the particles needs to be selected as described in section 5. This requires the selection of boundary conditions for the plasma pressure profiles at the central cell and mirror throats as described in table 2. Near the edges of the computational domain in the so-called exhaust regions, the fully-absorbing particle boundary conditions render the paraxial mirror equilibrium invalid, hence the pressure profiles are truncated at the mirror throats. Beyond the

Kinetic simulations of collision-less plasma in open magnetic geometries

12

mirror throats, the pressure profiles are described with hyperbolic tangent functions to model the decay of the plasma and temperature in the exhaust regions.

Table 2. Input parameters for calculating paraxial mirror equilibrium

Simulation parameters

Physical value

Central cell plasma density ne1 Central cell electrons temperature Te Central cell parallel ion pressure P 1 Central cell perpendicular ion pressure P1 Throat parallel ion pressure P 2 Throat perpendicular ion pressure P2

5 × 1019 [m-3] 1 [keV] ne1Te1 [Pa] P 1 [Pa] P 1/6 [Pa] P 1/3 [Pa]

Using the parameters from table 2 and the procedure outlined in Appendix A.1, the equilibrium plasma profiles are shown in figure 2. Near the mirror throats, the ion temperature acquires an anisotropic nature. This is expected as pressure anisotropy is required to balance the parallel pressure gradient force as demonstrated by Eq. 29. The bottom panel evaluates the term Q discussed in Appendix A.1 which is related to stable equilibrium of the profiles. The solution shows that Q > 0 in all regions of the domain. Equilibrium solutions that do not satisfy Q > 0 are rejected as recommended in reference.43

Kinetic simulations of collision-less plasma in open magnetic geometries

13

2000

1000

0

0

0.5

1

1.5

2

2.5

3

10 19 6

4

2

0

0

0.5

1

1.5

2

2.5

3

20

10

0

0

0.5

1

1.5

2

2.5

3

10 5

0

0.5

1

1.5

2

2.5

3

Figure 2. Plasma profiles obtained using the parallel and perpendicular force balance equations as described in Appendix A. These profiles are used in PRO++-OMG as initial condition to be loaded at t = 0 as an external files.
In the present case, the plasma system is evolved up to 3000 gyro-periods (t = 3000-c 1) and fueled with a warm isotropic (Maxwellian) plasma source injected at the central cell. The plasma source has a Gaussian distribution in physical space with a spread of L/10 about the center of the cell. The gyro-period is calculated based on the magnetic field in the central cell which is set to 0.6 T. This corresponds to a total simulation time of 0.33 ms. The isotropic warm plasma source is set to have a temperature of 1 keV and injects ions at a rate which maintains the central density equal to 5 × 1019 [m-3]. The addition of a warm isotropic plasma source implies that the collision-less plasma system will evolve to be a combination of a mirrortrapped/loss-cone distribution and an isotropic Maxwell-Boltzmann distribution. This is demonstrated in section 6.4.
Using the computational particle positions, velocity vectors and weights evolved by the PIC code, the moments of the distribution function are calculated to obtain the plasma density, ion flux and ion pressure tensor profiles along the length of the

Kinetic simulations of collision-less plasma in open magnetic geometries

14

plasma and as a function of time. The axial variation of the ion temperature (parallel and perpendicular) and plasma density are presented in Figure 3 at t = 3000-c 1. The results show that both the temperature and density profiles evolve to a state that is qualitatively similar to the equilibrium profiles used to initialize the distribution at the start of the simulation (Figure 2); namely, the temperature develops an anisotropic nature near the mirror throats. This suggests that the plasma system has evolved while maintaining force balance. This is confirmed in section 6.2.
It is worth noting that for the present conditions, Coulomb collisions are expected to play a role only after several thousands of ion-gyro periods. Using equation 1 from reference,1 the mean time for 90 degree scattering a thermal proton on a background proton plasma with a mean temperature 1.5 keV and density 5 × 1019 [m-3] is about 0.33 ms. Hence at 3000 gyro-periods which in the present case correspond to about 0.3 ms, the dynamics of the plasma system can still be considered quasi-collision-less; nevertheless, 3000 gyro-periods is sufficient time to allow evolution of the ion trajectories in phase space and hence the evolution of the ion PDF. Therefore, in order to proceed to several tens of thousands gyro-periods and into the tens of milliseconds range, the addition of Coulomb collisions becomes imperative. This will be the subject of another paper. In the discussion, a brief description of the planned Coulomb collision operator is presented.

Kinetic simulations of collision-less plasma in open magnetic geometries

15

3000

Tx

Ty

2000

Tz

1000

0

0

0.5

1

1.5

2

2.5

3

6 1019

4

2

0

0

0.5

1

1.5

2

2.5

3

10

5

0

0

0.5

1

1.5

2

2.5

3

Figure 3. Plasma profiles for ion temperatures Tx, Ty and Tz along x^, y^ and z^ directions respectively, ion density n, axial and radial magnetic field obtained from the collision-less simulations of mirror plasma at t = 3000-c 1. These profiles obtained at t = 3000 ion-gyro periods are very much similar to the equilibrium profiles shown in Fig.(2) loaded as an initial condition at t = 0.
6.2. Conservation of Momentum
The process of calculating the moments of the ion PDF using the particle positions in phase space naturally leads to the evaluation of conservation of momentum or force balance. Specifically, using the plasma density, plasma flux and ion pressure tensor evolved by the PIC code, each term of the momentum transport equation in the paraxial limit (Eq. 28) can be evaluated as a function of time and space to test conservation of momentum. This process has been carried out in the present study using the simulation results at t = 3000-c 1 and presented in figure 4.
The spatial variation of the ion pressure tensor is shown in figure 4a, where the term PKE represents the term associated with the kinetic energy density given by PKE = M nu u . The dominant term is the perpendicular pressure leading to an anisotropic ion pressure; however, near the throats, as the plasma exhaust begins to accelerate (see Figure 6b), the kinetic energy density of the plasma PKE increases. Based

Kinetic simulations of collision-less plasma in open magnetic geometries

16

on these spatially-varying pressure profiles, each term in paraxial mirror momentum transport equation (Eq. 28) is evaluated and presented in figure 4b. The time-dependent term is not included as it is vanishingly small during the approach to steady state. The red line represents the parallel pressure gradient, the green line the magnetic mirror force and the black line the force associated with accelerating the plasma through the mirror. The data indicates that the parallel gradient force (red line) is balanced mostly by the magnetic mirror force (green line). To confirm conservation of momentum, Figure 4c compares two terms of Eq. 28 and indicates that indeed momentum is conserved. In other words, the plasma system at 3000 gyro-periods is in a state of force balance or equilibrium and consistent with the momentum transport equation in the paraxial limit.

Kinetic simulations of collision-less plasma in open magnetic geometries

17

(a)

(b)

(c)

Figure 4. Comparison of simulation data with the momentum transport equation in the paraxial limit. (a) Axial variation of individual energy density terms- Parallel drift kinetic energy M nu2 (solid black curve ), Perpendicular Pand parallel P pressures (green and red solid curves) ; (b) corresponding derivative of energy density terms; and (c) Comparison of analytic value (solid black curve) of mirror force with that obtained from the simulation data (solid green curve).

Kinetic simulations of collision-less plasma in open magnetic geometries

18

6.3. Self-consistent ambipolar electric field
As the PIC code evolves the particle positions in phase space, the parallel electric field E is self-consistently calculated using the generalized Ohm's law presented in Eq. 3. This electric field in turn, affects the parallel plasma transport. Figure 5 presents the parallel electric field along the length of the plasma at t = 3000-c 1. Moreover, the parallel plasma drift velocity is shown for completeness indicating the presence of plasma flows of several ion thermal velocities towards the boundaries.
The electric field E is approximately flat in the central cell region and increases to a maximum near the mirror throats. The sign of the electric field indicates that it expels ions and confines electrons in the central cell. The presence of this parallel electric field has important consequences on the formation of mirror-trapped distributions in the form of so-called Yushmanov potentials.51 This is discussed further in the next section. In the exhaust region, the noise level of the electric field increases as illustrated by the error bars. These fluctuations are most likely caused by the poor statistics in this region as the plasma density drops sharply in the exhaust region (see Figure 3). To improve the statistics in this region, there are two actions that can be taken. The first one is to increase the particle interpolation scheme. Currently, PRO++ OMG utilizes a secondorder interpolation scheme and implementing a third order scheme could help reduce noise.52 In addition, a particle splitting scheme can be applied in the exhaust region to improve statistics and thus the noise levels on the electric field calculation (53,54)
It is worth noting that resolving the parallel electric field in a self-consistent manner is required to correctly describe the parallel transport of ions along the magnetic flux. This becomes increasingly important in devices like WHAM5 and MPEX1 where radiofrequency plasma heating can produce mirror-trapped fast particles. As the density of trapped fast particles increases, the parallel electric field changes and affects the parallel transport of the bulk plasma. An important example of this is the use NBI to create a sloshing ion population in a mirror device which improves the confinement of the background warm plasma. On the other hand, in devices such as MPEX, care must be taken to prevent the formation of mirror-trapped particles during RF heating which reduce the parallel transport of particles towards the target region.1

Kinetic simulations of collision-less plasma in open magnetic geometries

19

(a)
20 t=3000 -1
c
0

-20

0

0.5

1

1.5

2

2.5

3

(b)

5

20

t=3000 -1
c

0

0

-5

-20

0

0.5

1

1.5

2

2.5

3

Figure 5. (a) Self-consistent parallel electric field E profile at t = 3000-c 1along the magnetic flux lines normalized to the electron temperature Te. The dashed black curve represent the standard deviation the electric field (b) Parallel ion drift velocity profile normalized with the average ion sound speed at t = 3000-c 1 (solid black curve) superposed over the magnetic field profile (red curve).

6.4. Loss cone ion distribution function

The conditions for plasma confinement in a mirror configuration in the presence of an

ambipolar potential is determined by the condition presented in Eq. 30 and obtained from references.51,55­57 In this expression, v and v are the perpendicular and parallel ion velocities at the center of the mirror region respectively, Rm = Bm/B1 is the mirror ratio; e is the electronic charge and  is the electric potential between the central cell

and the mirror throat. The confinement region/loss cone boundary in the presence of

an ambipolar potential becomes a hyperboloid in velocity space coordinates.

v2 (1

-

1 )-
Rm

v2 Rm

>

2e M Rm

(30)

The ion velocity space distribution in the central cell is presented in figure 5(a, b & c) at t = 3000c-1 . The dotted black lines represent the loss cone boundary in the absence of an electric potential. These straight lines have a pitch angle relative to the v coordinate

given by sin-1 1/Rm . The black solid lines which trace hyperbolas represent the confinement boundary given by Eq. 30 where  is obtained by integrating the parallel

electric field presented in Figure 5a from the central cell to the mirror throat. Ions with

energies less than e/Rm exist below the confinement boundary and are lost from the mirror region. On the other, ions with energies greater than e/R can exist above the

confinement boundary given by Eq. 30 and thus have a greater probability to remain

Kinetic simulations of collision-less plasma in open magnetic geometries

confined.

(a)

(b)

20 (c)

Figure 6. Velocity distribution of ions in mirror plasma configuration: (a) Total distribution of ions in presence of an isotropic particle source (b) Particle source distribution, and (c) Loss cone distribution of ions in absence of any particle source. The solid and dashed black curve in figures are boundaries of the confinement regions with and without ambipolar potential respectively.
Figure 6a presents the total ion velocity distribution obtained directly from the PIC calculation. As discussed in section 6.1, the plasma system is fueled with a warm isotropic plasma source injected at the central cell with a temperature of 1 keV. The velocity space distribution of this plasma source is shown in Figure 6b. In fact, subtracting the plasma source velocity distribution (figure 6b) from the total distribution presented in figure 6a produces the distribution presented in figure 6c. This distribution is precisely a loss-cone distribution in the presence of an electric potential. Regions of high particle density are accurately described by the the hyperbolas representing Eq. 30. This figure clearly demonstrates that the total ion velocity distribution in the central cell at t = 3000-c 1 can be understood as a combination of a loss cone-distribution driven by mirror physics and an isotropic Maxwellian distribution driven by the warm plasma source.
7. Discussion
The development of Pro++ OMG has been motivated by the need to develop tools to model the evolution of the distribution function in plasma systems with open magnetic geometries in the presence of non-uniform magnetic fields, RF heating and collisional process. Examples of such systems include (1) the SOL in toroidal fusion confinement devices, (2) linear divertor simulator such as the MPEX under construction at ORNL for fusion PMI research, (3) mirror devices such as the Wisconsin HTS Axisymmetric Mirror (WHAM) under construction at the University of Wisconsin Madison, (4) plasma thrusters such as the VASIMR concept which uses Ion Cyclotron Resonance Heating (ICRH) to heat a low-temperature high-density plasma to increase thrust.

Kinetic simulations of collision-less plasma in open magnetic geometries

21

A key aspect of plasmas systems in open magnetic geometries is the need to retain/resolve the physics along the physical dimension associated with the magnetic field. Depending on the level of collisionality, the presence of non-uniform magnetic fields introduces velocity space anisotropies leading to mirror forces on the plasma and nonuniform plasma densities. Moreover, the use of RF plasma heating via resonant methods and/or injection of energetic particles further drives velocity space anisotropies which in general becomes a function of space. The minimum theoretical model needed to capture all these effects is the Boltzmann transport equation with at least 1 dimension in physical space (1D) and at least two dimensions velocity space dimension (2D). In addition, source terms are required to account for plasma sources/sinks and collisional process. In the context of plasmas, the acceleration term in the Boltzmann transport equation becomes the Lorentz force and leads to the Vlasov equation. In the present work, a hybrid PIC approach is employed to solve the transport problem along 1 dimension in physical space (1D) and 3 dimensions in velocity space (3V).

7.1. Initial state of the plasma system
To evolve the hybrid PIC code, the initial state of each particle needs to be specified. The particle state in the current formulation is completely defined by: (1) position xi, (2) velocity vector vi and (3) weight ai. This can be clearly seen in the discrete particle distribution function Eq. 10. To select the initial state of the entire set of particles, the general method described in section 5 is employed. A key step in this process is calculating the parallel P and perpendicular pressure P profiles as a function of the spatial coordinate. This process amounts to the solution of the mirror equilibrium in the paraxial limit (Eq. 29). A simple method to compute these profiles is presented in Appendix A.1 where the required inputs are: (1) vacuum magnetic field profile and (2) four boundary conditions of the pressure profiles. The outputs are: (1) parallel pressure, (2) perpendicular pressure and (3) beta-corrected magnetic field. This method can be extended to problems with two dimensions (2D) in physical space by dividing the volume into nested flux surfaces. The paraxial mirror equilibrium is solved along each flux surface. Using the beta-corrected magnetic field profiles, the new nested flux surfaces are calculated and the 2D spatially-resolved pressure profiles can be assembled.

7.2. Non-uniform magnetic fields
In the present work, the focus has been on the correct implementation of non-uniform magnetic fields, finite fully-absorbing boundaries for the particles and volumetric plasma sources. The presence of non-uniform magnetic fields leads to "pinching" or "compression" of the plasma as particles move into regions of higher magnetic field. In the 1D-3V formulation, this effect is captured by a compression factor B(xi)/B0 in the discrete particle distribution function as presented in Eq. 10 which effectively increases the density of super-particles as they enter regions of higher magnetic field. This term is essential in retaining the 2D nature of a cylindrically symmetric non-uniform magnetic

Kinetic simulations of collision-less plasma in open magnetic geometries

22

field. To demonstrate correct implementation of the non-uniform magnetic fields, the
hybrid PIC is applied to a simple magnetic mirror geometry which features two finite fully-absorbing boundaries and a warm isotropic plasma source to sustain the plasma. The results of the code are evaluated using the momentum transport equation in the paraxial limit. This process consists of computing the moments of the distribution function based on the super-particle phase-space positions. The computed moments are used to evaluate each term of the momentum transport equation (Eq. 28) to assess conservation of momentum along the length of the plasma system. The results presented in fig. 4 describe the contribution of each force and demonstrates conservation of momentum along the length of the plasma system. The results show that the plasma exists in a state of force balance between the parallel pressure gradient and the mirror force. The plasma acceleration term becomes important only near the mirror throats where the plasma accelerates to super-sonic speeds (Figure 6b).
In addition to evaluating conservation of momentum, the velocity distribution of the ions in the central cell is analyzed. It is well known in the literature51,57 that the presence of an electric potential in a mirror plasma modifies the loss cone boundary from a cone to a hyperboloid. The exact shape of this boundary can be calculated with knowledge of the electric potential and the mirror ratio as shown in Eq. 30. The electric potential is self-consistently calculated in the hybrid PIC approach using the generalized Ohm's law (Eq. 3) and is used to evaluate the loss boundary. The results presented in figure 6 demonstrate that indeed the regions in velocity space with the highest ion density are those above the hyperbolic loss boundaries predicted by Eq. 30. In fact, the total ion distribution function can be understood as the combination of a losscone distribution and an isotropic Maxwellian distribution driven by the warm isotropic plasma source. This further demonstrate the correct implementation of non-uniform magnetic field physics in the present 1D-3V hybrid PIC.

7.3. Coulomb collisions
In the present work, the ion distribution function is evolved up to 3000 gyro-periods. Based on the central cell magnetic field, this corresponds to approximately 0.3 ms. Given the plasma parameters (ne  5 × 1019 [m-3] and Ti  1 [keV]), coulomb collisional relaxation becomes important for time scales greater 0.3 ms; hence, evolving the distribution beyond the present case requires the addition of Coulomb collisions. For lower plasma temperatures, the effect of Coulomb collisions becomes increasingly important. An important effect of collisions is the relaxation of anisotropies that arise in the presence of non-uniform magnetic fields and/or plasma heating. For example, an important physical process of interest in devices such as the linear divertor simulator MPEX is collisional relaxation and transport of fast particles created via RF plasma heating. Modelling this process provides means to determine the evolution of the distribution function in the PMI region and aid in the interpretation of exposure

Kinetic simulations of collision-less plasma in open magnetic geometries

23

experiments. The planned strategy to incorporate Coulomb collisions is based on the Monte-
Carlo Fokker-Planck (FP) collision operators from references.1,58,59 On each time step of the PIC calculation, the moments of the distribution function are calculated by extrapolating the particle states to the mesh in order to obtain spatially-resolved plasma density, temperature and plasma flow profiles. These profiles are used as inputs to the Monte-Carlo FP collision operator which takes each computational particle and simulates a collision with the background plasma based on the moments of the distribution function at the current time step. The collisions are applied in the reference frame moving with the plasma by incrementing the particle energy, pitch angle and gyro-phase according to the statistical rules determined by the FP operator. The implementation of the FP collision operator and associated physics investigation will be the subject of another paper.

Acknowledgement
This work supported by the US. D.O.E. contract DE-AC05- 00OR22725 and sponsored by the Laboratory Directed Research and Development Program of Oak Ridge National Laboratory, managed by UT-Battelle, LLC, for the U. S. Department of Energy. The authors would also like to acknowledge Dr. L. Carbajal Gomez, UNAM, Mexico for providing support and various physics discussions during the development of new aspects of this code.

References
[1] J. F. Caneses, D. A. Spong, C. Lau, T. M. Biewer, R. H. Goulding, T. S. Bigelow, J. B. O. Caughman, N. Kafle, and J. Rapp, "Effect of magnetic field ripple on parallel electron transport during microwave plasma heating in the Proto-MPEX linear plasma device," Plasma Physics and Controlled Fusion, vol. 62, p. 045010, Feb. 2020. Publisher: IOP Publishing.
[2] J. Rapp, C. Lau, A. Lumsdaine, C. J. Beers, T. S. Bigelow, T. M. Biewer, T. Boyd, J. F. Caneses, J. B. O. Caughman, R. Duckworth, R. H. Goulding, W. R. Hicks, N. Kafle, P. A. Piotrowicz, and D. West, "The Materials Plasma Exposure eXperiment: Status of the Physics Basis Together With the Conceptual Design and Plans Forward," IEEE Transactions on Plasma Science, vol. 48, pp. 1439­1445, June 2020. Conference Name: IEEE Transactions on Plasma Science.
[3] E. A. Bering, F. R. Chang-Díaz, J. P. Squire, M. Brukardt, T. W. Glover, R. D. Bengtson, V. T. Jacobson, G. E. McCaskill, and L. Cassady, "Electromagnetic ion cyclotron resonance heating in the VASIMR," Advances in Space Research, vol. 42, pp. 192­205, July 2008.
[4] "Concept development of steady state compact fusion neutron sources," IAEA-TECDOC-1875, 2019.
[5] J. Anderson, C. Forest, and et. al., "Introducing the wisconsin hts axisymmetric mirror," Fusion Science and Technology, vol. In preparation, 2021.
[6] D. Winske and M. M. Leroy, "Diffuse ions produced by electromagnetic ion beam instabilities," Journal of Geophysical Research: Space Physics, vol. 89, no. A5, pp. 2673­2688, 1984.
[7] A. Mankofsky, R. Sudan, and J. Denavit, "Hybrid simulation of ion beams in background plasma," Journal of Computational Physics, vol. 70, no. 1, pp. 89 ­ 116, 1987.

Kinetic simulations of collision-less plasma in open magnetic geometries

24

[8] K. Akimoto, D. Winske, T. G. Onsager, M. F. Thomsen, and S. P. Gary, "Steepening of parallel propagating hydromagnetic waves into magnetic pulsations: A simulation study," Journal of Geophysical Research: Space Physics, vol. 96, no. A10, pp. 17599­17607, 1991.
[9] D. Winske and N. Omidi, "Electromagnetic ion/ion cyclotron instability: Theory and simulations," Journal of Geophysical Research: Space Physics, vol. 97, no. A10, pp. 14779­14799, 1992.
[10] C. Baranger, A. Burbeau-Augoula, P. Seytor, P. Hoch, O. Larroche, J. Métral, and B. Rebourcet, "Numerical modeling of a self-colliding plasma," International Journal for Numerical Methods in Fluids, vol. 65, no. 11-12, pp. 1451­1463, 2011.
[11] P. W. Gingell, S. C. Chapman, R. O. Dendy, and C. S. Brady, "Transport and evolution of ion gyro-scale plasma blobs in perpendicular magnetic fields," Plasma Physics and Controlled Fusion, vol. 54, p. 065005, may 2012.
[12] M. S. Weidl, D. Winske, F. Jenko, and C. Niemann, "Hybrid simulations of a parallel collisionless shock in the large plasma device," Physics of Plasmas, vol. 23, no. 12, p. 122102, 2016.
[13] S. E. Clark, D. Winske, D. B. Schaeffer, E. T. Everson, A. S. Bondarenko, C. G. Constantin, and C. Niemann, "Hybrid simulation of shock formation for super-alfvénic expansion of laser ablated debris through an ambient, magnetized plasma," Physics of Plasmas, vol. 20, no. 8, p. 082129, 2013.
[14] L. Carbajal, R. O. Dendy, S. C. Chapman, and J. W. S. Cook, "Linear and nonlinear physics of the magnetoacoustic cyclotron instability of fusion-born ions in relation to ion cyclotron emission," Physics of Plasmas, vol. 21, no. 1, p. 012106, 2014.
[15] P. W. Gingell, S. C. Chapman, and R. O. Dendy, "Plasma blob formation by ion kinetic kelvin­helmholtz and interchange instabilities," Plasma Physics and Controlled Fusion, vol. 56, p. 035012, feb 2014.
[16] P. W. Gingell, S. C. Chapman, and R. O. Dendy, "Plasma heating by ion gyro-scale blobs in the kinetic and fluid regimes," Plasma Physics and Controlled Fusion, vol. 55, p. 055010, apr 2013.
[17] R. Chodura, "A hybrid fluid-particle model of ion heating in high-mach-number shock waves," Nuclear Fusion, vol. 15, pp. 55­61, feb 1975.
[18] D. Winske, "Hybrid simulation codes with application to shocks and upstream waves," Space Science Reviews, vol. 42, no. 1, pp. 53­66, 1985.
[19] A. G. Sgro and C. W. Nielson, "Hybrid model studies of ion dynamics and magnetic field diffusion during pinch implosions," The Physics of Fluids, vol. 19, no. 1, pp. 126­133, 1976.
[20] S. Hamasaki, N. A. Krall, C. E. Wagner, and R. N. Byrne, "Effect of turbulence on theta pinch modeling by hybrid numerical models," The Physics of Fluids, vol. 20, no. 1, pp. 65­71, 1977.
[21] D. S. Harned, "Quasineutral hybrid simulation of macroscopic plasma phenomena," Journal of Computational Physics, vol. 47, no. 3, pp. 452 ­ 462, 1982.
[22] M. M. Leroy, C. C. Goodrich, D. Winske, C. S. Wu, and K. Papadopoulos, "Simulation of a perpendicular bow shock," Geophysical Research Letters, vol. 8, no. 12, pp. 1269­1272, 1981.
[23] L. K. Daldorff, G. Tóth, T. I. Gombosi, G. Lapenta, J. Amaya, S. Markidis, and J. U. Brackbill, "Two-way coupling of a global hall magnetohydrodynamics model with a local implicit particlein-cell model," Journal of Computational Physics, vol. 268, pp. 236 ­ 254, 2014.
[24] L. Franci, S. Landi, L. Matteini, A. Verdini, and P. Hellinger, "HIGH-RESOLUTION HYBRID SIMULATIONS OF KINETIC PLASMA TURBULENCE AT PROTON SCALES," The Astrophysical Journal, vol. 812, p. 21, oct 2015.
[25] B. J. Vasquez and S. A. Markovskii, "VELOCITY POWER SPECTRA FROM CROSS-FIELD TURBULENCE IN THE PROTON KINETIC REGIME," The Astrophysical Journal, vol. 747, p. 19, feb 2012.
[26] A. P. Matthews, "Current advance method and cyclic leapfrog for 2d multispecies hybrid plasma simulations," Journal of Computational Physics, vol. 112, no. 1, pp. 102 ­ 116, 1994.
[27] Y. Todo and T. Sato, "Linear and nonlinear particle-magnetohydrodynamic simulations of the toroidal alfvén eigenmode," Physics of Plasmas, vol. 5, no. 5, pp. 1321­1327, 1998.
[28] Z. Lin and L. Chen, "A fluid­kinetic hybrid electron model for electromagnetic simulations,"

Kinetic simulations of collision-less plasma in open magnetic geometries

25

Physics of Plasmas, vol. 8, no. 5, pp. 1447­1450, 2001. [29] M. Casanova, O. Larroche, and J.-P. Matte, "Kinetic simulation of a collisional shock wave in a
plasma," Phys. Rev. Lett., vol. 67, pp. 2143­2146, Oct 1991. [30] C. Thoma, D. R. Welch, R. E. Clark, D. V. Rose, and I. E. Golovkin, "Hybrid-pic modeling
of laser-plasma interactions and hot electron generation in gold hohlraum walls," Physics of Plasmas, vol. 24, no. 6, p. 062707, 2017. [31] B. D. Keenan, A. N. Simakov, W. T. Taitano, and L. Chacón, "Ion species stratification within strong shocks in two-ion plasmas," Physics of Plasmas, vol. 25, no. 3, p. 032103, 2018. [32] C. K. Birdsall and A. B. Langdon, Plasma physics via computer simulation. New York: Taylor and Francis, 2005. [33] R. W. Hockney and J. W. Eastwood, Computer simulation using particles. Bristol: Hilger, 1988. [34] D. Winske and N. Omidi, "A nonspecialist's guide to kinetic simulations of space plasmas," Journal of Geophysical Research: Space Physics, vol. 101, no. A8, pp. 17287­17303, 1996. [35] A. S. Lipatov, R. Glowinski, Y. Hussaini, P. Colella, and M. Holt, The Hybrid Multiscale Simulation Technology: An Introduction with Application to Space and Plasma Physics, p. 83. Berlin, Heidelberg: Springer-Verlag, 2001. [36] G. Colonna and A. D'Angola, eds., Plasma Modeling. 2053-2563, IOP Publishing, 2016. [37] Kane Yee, "Numerical solution of initial boundary value problems involving maxwell's equations in isotropic media," IEEE Transactions on Antennas and Propagation, vol. 14, pp. 302­307, May 1966. [38] O. Buneman, "TRISTAN The 3-D electromagnetic particle code," Computer Space Plasma Physics: Simulation Techniques and Software, Tokyo, pp. 67­84, 1993. [39] A. S. Lipatov, The Hybrid Multiscale Simulation Technology: An Introduction with Application to Astrophysical and Laboratory Plasmas, p. 83. Scientific Computation, Berlin Heidelberg: Springer-Verlag, 2002. [40] N. Metropolis, A. W. Rosenbluth, M. N. Rosenbluth, A. H. Teller, and E. Teller, "Equation of state calculations by fast computing machines," The Journal of Chemical Physics, vol. 21, no. 6, pp. 1087­1092, 1953. [41] W. A. Newcomb, "Equilibrium and stability of collisionless systems in the paraxial limit," Journal of Plasma Physics, vol. 26, no. 3, p. 529­584, 1981. [42] W. A. Newcomb, "Guiding-center autonomy theorem," The Physics of Fluids, vol. 28, no. 2, pp. 505­516, 1985. [43] B. I. Cohen, R. P. Freis, and W. A. Newcomb, "Interchange, rotational, and ballooning stability of long-thin axisymmetric systems with finite-orbit effects," Physics of Fluids, vol. 29, no. 5, p. 1558, 1986. [44] A. M. Wright, Z. S. Qu, J. F. Caneses, and M. J. Hole, "An experimentally constrained MHD model for a collisional, rotating plasma column," Plasma Phys. Control. Fusion, vol. 59, no. 2, p. 025003, 2017. [45] E. T. Meier and U. Shumlak, "A general nonlinear fluid model for reacting plasma-neutral mixtures," Physics of Plasmas, vol. 19, no. 7, p. 072508, 2012. [46] R. Goldston, Introduction to Plasma Physics. CRC Press, 2020. [47] S. I. Braginskii, "Transport Processes in a Plasma," in Reviews of Plasma Physics, vol. 1, p. 205, New York: Consultants Bureau, edited by m.a. leontovich ed., 1965. [48] R. Fitzpatrick, Plasma Physics: An Introduction. Taylor & Francis, 2014. [49] W. K. Hastings, "Monte Carlo sampling methods using Markov chains and their applications," Biometrika, vol. 57, pp. 97­109, 04 1970. [50] B. Calderhead, "A general construction for parallelizing Metropolis-Hastings algorithms," Proceedings of the National Academy of Sciences of the United States of America, vol. 111, no. 49, pp. 17408­17413, 2014. [51] D. D. Ryutov, "Open-ended traps," Soviet Physics Uspekhi, vol. 154, no. 4, pp. 565­614, 1988. [52] M. Shalaby, A. E. Broderick, P. Chang, C. Pfrommer, A. Lamberts, and E. Puchwein, "Importance

Kinetic simulations of collision-less plasma in open magnetic geometries

26

of resolving the spectral support of beam-plasma instabilities in simulations," The Astrophysical Journal, vol. 848, p. 81, oct 2017. [53] R. Smets, N. Aunai, A. Ciardi, M. Drouin, M. Campos-Pinto, and P. Deegan, "A new method to dispatch split particles in particle-in-cell codes," Computer Physics Communications, vol. 261, p. 107666, 2021. [54] M. Pfeiffer, A. Mirza, C.-D. Munz, and S. Fasoulas, "Two statistical particle split and merge methods for particle-in-cell codes," Computer Physics Communications, vol. 191, pp. 9­24, 2015. [55] A. Kaufman, "Ambipolar effects in mirror losses," Report TID 7520, vol. Pt-2, p. 387, 1956. [56] D. J. BenDaniel, "Plasma potential in a magnetic mirror system," Journal of Nuclear Energy. Part C, Plasma Physics, Accelerators, Thermonuclear Research, vol. 3, pp. 235­241, jan 1961. [57] E. E. Yushmanov, "Confinement of Slow Ions of a Plasma with Positive Potential in a Mirror Trap," Soviet Journal of Experimental and Theoretical Physics, vol. 22, p. 409, Feb. 1966. [58] M. T. Beidler, D. del Castillo-Negrete, L. R. Baylor, D. Shiraki, and D. A. Spong, "Spatially dependent modeling and simulation of runaway electron mitigation in DIII-D," Physics of Plasmas, vol. 27, p. 112507, Nov. 2020. Publisher: American Institute of Physics. [59] A. H. Boozer and G. Kuo-Petravic, "Monte Carlo evaluation of transport coefficients," The Physics of Fluids, vol. 24, p. 851, June 1998.

Appendix A. Solution to the mirror equilibrium in the paraxial limit

Appendix A.1. Paraxial mirror equilibrium

The paraxial mirror force balance equation is described in section 4 (Particle and momentum transport) and for clarity is presented below in Eq. A.1. Moreover, as described in reference,43 the perpendicular pressure equilibrium is given by Eq. A.2, where B0 is the externally applied magnetic field in vacuum and B is the beta-corrected magnetic field due to the finite perpendicular plasma pressure.

P

+ P - P

B =0

x

B x

(A.1)

B2 2µ0

=

B02 2µ0

- P

(A.2)

Moreover, following the framework presented in reference,43 two macroscopic stability

conditions are imposed to ensure well posedness of the equilibrium problem. Let Q be

a quantity defined by Eq. A.3. Stability with respect to the fire-hose mode (lengthwise

buckling of the magnetic field lines) requires Q > 0 and with respect to the mirror mode

requires Eq. A.4.

B2 Q = 2µ0 + P + P B2  Q > 0
B B

(A.3) (A.4)

Appendix A.2. Solution to the paraxial equilibrium
A special class of solution to Eq.(A.1) and Eq.(A.2) can be obtained by describing the parallel pressure P as a function of magnetic field B as described in reference.43 Based

Kinetic simulations of collision-less plasma in open magnetic geometries

27

on this, Eq. A.1 can be re-written as in Eq. A.5

P

=

-B2

 B

P B

(A.5)

Following the development in reference,43 the parallel pressure P (B) is described as a

4th degree polynomial of the magnetic field B as shown in Eq. A.6. Inserting Eq. A.6

into Eq. A.5, leads to an expression for the perpendicular pressure P(B) as shown in Eq. .

P (B) = a + bB + cB2 + dB4 P(B) = a - cB2 - 3dB4

(A.6) (A.7)

Substituting the perpendicular pressure P(B) into the perpendicular pressure balance Eq. A.2 leads to the bi-quadratic equation for the beta-corrected magnetic field as

shown in Eq. A.8, where the coefficients a, c, d are the same terms appearing in Eq.

A.6 and A.7. This bi-quadratic describes the beta-corrected magnetic field B in the

presence of finite plasma pressure.

B4(3d) + B2(c - 1 ) + ( B02 - a) = 0

2µ0

2µ0

(A.8)

To solve for the profiles P and P which satisfy the paraxial mirror equilibrium Eq. A.1, the coefficients a, b, c and d in Eq.(A.6) need to be determined subject to appropriate

boundary conditions. The boundary conditions to constrain the coefficients a, b, c and

d are the plasma pressures (parallel and perpendicular) at the (1) central cell and (2)

mirror throats. This produces a total of four boundary conditions. Using these boundary

conditions, the beta-corrected magnetic field at the central cell and mirror throats are

calculated using Eq. A.9, where i = 1, 2 corresponds to central and mirror throat

regions.

Bi2 2µ0

=

B02i 2µ0

- pi

(A.9)

The four boundary conditions lead to four equations with four unknown coefficients.

This leads to the matrix equation shown in Eq. A.10 whose solution determines the

values of the coefficients a, b, c and d in Eq.(A.6) and Eq. A.7. Once these coefficients

have been determined, the beta-corrected magnetic field profile B(x) can be calculated.

Finally, using B(x) the perpendicular P(x) and parallel pressure P (x) profiles as a function of physical space can be obtained. The resulting beta-corrected magnetic field

B(x) , perpendicular P(x) and parallel pressure P (x) profiles satisfy the paraxial mirror equilibrium equations Eq. A.1 and Eq. A.2.

 P 1   1 0 -B12 -3B14   a 

  

P1



 

=

 

1

 

P2

 

1


B1 0

+B12 -B22

+B14

 

b

 

-3B24

  

c

  

P2

1 B2 +B22 +B24

d

(A.10)

Kinetic simulations of collision-less plasma in open magnetic geometries

28

Appendix B. Construction of a 4-D probability density function

In this section, a 4-D Probability Density Function (PDF) is constructed using the parallel and perpendicular pressure profiles (P and P) computed from the paraxial mirror equilibrium calculation outlined in Appendix Appendix A.1. For completeness, a plasma drift profile U is also included in the construction of the 4-D PDF. The pressure profiles needed to construct the 4-D PDF are expressed in the form shown in Eq. B.1, where i is an index for the coordinate (x, y or z), n(x) is the particle density spatial profile and Ti(x) is the temperature associated with the ith coordinate.

Pi(x) = n(x)Ti(x)

(B.1)

The PDF is constructed using a product of normal distributions for each degree of freedom in velocity space as given Eq. B.2, where i is an index for the coordinate (x, y or z), Ti is the effective temperature along the ith coordinate, Ui is the bulk plasma flow. The normal distributions satisfy the condition shown in Eq. B.3.

fi(vi) =

m

1/2
exp

2Ti

-m(vi - Ui)2 2Ti

(B.2)

+
fi(vi)d3v = 1
-

(B.3)

Using the normal distributions in Eq. B.2, the 4-D PDF is given by Eq. B.4, where g(x) is given by Eq. B.5 and h(x, v) by Eq. where i is an index for the coordinate (x, y or z). In Eq. B.5, n(x) is the spatial profile of the number density for the species  and NR is the total number of real particles for species .

f (x, u) = g(x)h(x, v)

(B.4)

g(x)

=

n(x) NR

(B.5)

h(x, v) = fi(x, vi)
i

(B.6)

The moments of the function h(x, v) are shown in Eq. B.7 to Eq. B.9, where u is the

bulk plasma flow vector and T is the temperature tensor given in Eq. B.10.

+
h(x, v)d3v = 1
-

(B.7)

+
h(x, v)vd3v = u
-

(B.8)

+
h(x, v)(v - u)(v - u)d3v = T/m
-

(B.9)





Tx 0 0

T

=

 

0

Ty

0

 





0 0 Ty

(B.10)

Kinetic simulations of collision-less plasma in open magnetic geometries

29

Using Eq. B.7 to Eq. B.9, it can be shown that the moments of the 4-D PDF (Eq. B.4) return the pressure profiles used as inputs (Eq. B.1) to the PDF. In other words, the 4-D PDF in Eq. B.4 satisfies the paraxial mirror equilibrium equation presented in Eq. A.1. This PDF is used to initialize the distribution of particle states (xi, vi) in the hybrid PIC simulation at t = 0 using a Metropolis-Hasting algorithm.40,49,50

