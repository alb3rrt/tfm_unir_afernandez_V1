DRAFT VERSION JUNE 3, 2021 Typeset using LATEX twocolumn style in AASTeX63

arXiv:2106.01107v1 [physics.flu-dyn] 2 Jun 2021

Compressible test-field method and its application to shear dynamos
MAARIT J. KA¨ PYLA¨ ,1, 2, 3 MATTHIAS RHEINHARDT,4 AND AXEL BRANDENBURG3, 5, 6
1Department of Computer Science, Aalto University, P.O. Box 15400, FI-00076 Aalto, Finland 2Max Planck Institute for Solar System Research, Justus-von-Liebig-Weg 3, D-37077 Go¨ttingen, Germany 3Nordita, KTH Royal Institute of Technology and Stockholm University, Hannes Alfve´ns va¨g 12, SE-10691 Stockholm, Sweden
4Department of Computer Science, Aalto University, PO Box 15400, FI-00076 Aalto, Finland 5Department of Astronomy, AlbaNova University Center, Stockholm University, SE-10691 Stockholm, Sweden 6McWilliams Center for Cosmology & Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA

(Dated: Revision: 1.198)

ABSTRACT

In this study we present a compressible test-field method (CTFM) for computing  effect and turbulent mag-

netic diffusivity tensors, as well as those relevant for mean ponderomotive force and mass source, applied

to the full MHD equations. We describe the theoretical background of the method, and compare it to the

quasi-kinematic test-field method (QKTFM), and to the previously studied variant working in simplified MHD

(SMHD). We present several test cases using velocity and magnetic fields of the Roberts geometry, and also

compare with the imposed-field method. We show that in all cases investigated, the CTFM gives results in

agreement with the imposed field method. Some deviations between CTFM and SMHD variant exist. As a rel-

evant physical application, we study non-helically forced shear flows, which exhibit large-scale dynamo (LSD)

action, and present a re-analysis of low Reynolds number, moderate shear systems, where we previously ne-

glected the pressure gradient in the momentum equation, and found no coherent shear-current effect. Another

key difference is that in the earlier study we used magnetic forcing to mimic small-scale dynamo (SSD) action,

while here it is self-consistently driven by purely kinetic forcing. We still find no coherent shear-current effect,

but do recover strong large-scale dynamo (LSD) action, that, according to our analysis, is driven through the

incoherent effects.

1. INTRODUCTION

port coefficients for an MHD background turbulence due to

The shear-current (SC) effect is a mean-field dynamo effect that can, in principle, generate large-scale magnetic fields based on the off-diagonal components of the turbulent magnetic diffusivity tensor (Rogachevskii & Kleeorin 2003, 2004). Whether or not this effect can be responsible for the large-scale dynamo (LSD) seen in some non-helically forced shear flows continues to raise debate (see, e.g., the recent papers Squire & Bhattacharjee 2016; Ka¨pyla¨ et al. 2020; Zhou & Blackman 2021, with contradictory results for and against). Such a dynamo has been proposed to avoid the need for the more classical helicity-based  effect in situations where stratification and rotation are ineffective or absent, and hence neither kinetic helicity nor  effect can arise. One major cause of the aforementioned contradictions arises from the fact that, methodologically, a reliable quantitative measurement device capable of returning the turbulent trans-

a small-scale dynamo (SSD) in full MHD has not been available.
The imposed-field method was the first machinery developed in the 1990's (Brandenburg et al. 1990) for the retrieval of  effect and turbulent pumping by imposing uniform magnetic fields in different directions, measuring the mean (a.k.a. turbulent) electromotive force (EMF), and solving for the unknown coefficients. Gradients of the mean field contribute to the mean EMF via the turbulent diffusivity tensor, hence it is important to guarantee that they remain weak in the evolving magnetic field. Therefore, the field has to be reset after suitable time intervals, and not taking this into account properly has led to some misinterpretations of the results (see the discussion in Ossendrijver et al. 2001; Ka¨pyla¨ et al. 2010, and the references therein). When properly used, this method continues to be a valuable tool, and is used also in this work to validate the test-field results in the simplest cases.

The next methodology was introduced by Brandenburg &

Corresponding author: Maarit J. Ka¨pyla¨

Sokoloff (2002) as a method of moments: to tackle the large

maarit.kapyla@aalto.fi

amount of unknown transport coefficients entering the mean

2

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

EMF while there are only three equations relating it to the mean field, additional equations were constructed by forming a sufficient number of moments. Measuring them from the numerical models enables then to solve for the coefficients. This method can retrieve both the  and the turbulent resistivity tensors, but relies on the mean field, generated in the system, to be unsteady, typically oscillatory. This method has various incarnations in many astrophysical contexts (e.g. Squire & Bhattacharjee 2015; Shi et al. 2016; Simard et al. 2016; Ka¨pyla¨ et al. 2018). Occasionally, however, it is employed in an improper way by pre-assuming some of the coefficients to be negligible; putting them deliberately to zero then renders the fitting meaningless in the worst case (e.g. Simard et al. 2013; Squire & Bhattacharjee 2015; Shi et al. 2016).
The third alternative is the test-field method (TFM), introduced by Schrinner et al. (2005, 2007), where linearly independent test fields are subjected to the velocity taken from a simulation run, including both its fluctuating and mean constituents. The test fields are passive, i.e., do not affect the course of the simulation itself (except possibly through the time step control). The equations for the corresponding fluctuating magnetic fields are solved, which then allows for retrieving the full set of tensor coefficients (Brandenburg et al. 2008b). If the simulation is purely hydrodynamic, this approach is called the kinematic TFM (KTFM), but if it is an MHD run, where the generated magnetic field does backreact on the flow, the method is called quasi-kinematic (QKTFM). For both variants, however, the same procedures apply. This method has proven immensely successful, and has been utilized within a broad spectrum of astro- and planetary dynamo applications, including the shear dynamo problem (Brandenburg et al. 2008a). When an SSD is excited in such setups, it is supposed to boost the SC effect (the scenario proposed by Squire & Bhattacharjee 2016). The (Q)KTFM however, does not apply: SSD action generates a magnetic background turbulence, the magnetic part of which is not accounted for.
A core machinery towards a TFM, which can take into account the magnetic background turbulence, was presented by (Rheinhardt & Brandenburg 2010), albeit relying on simplified MHD (SMHD), where pressure gradient and selfadvection of the flow were dropped from the momentum equation. Another step further was taken in Ka¨pyla¨ et al. (2020), admitting self-advection, while yet ignoring the pressure gradient and hence variations of density. This study has been deemed inconclusive (see, e.g. Zhou & Blackman 2021), as second-order correlation approximation (SOCA) calculations of Squire & Bhattacharjee (2016) were interpreted to indicate a decisive role of the pressure gradient in creating the magnetic SC effect. In contrast, we argued that the magnetic SC effect continues to exits in SMHD in the ideal limit, albeit with a sign not supportive for a mean-field

dynamo. This paper aims at introducing a method meeting all requirements, namely the fully compressible nonlinear test field method (CTFM). We present test cases to prove its functionality, and then make a first attempt to apply it to the shear dynamo problem in the regime of moderate Reynolds number and shear, where we measure the turbulent transport coefficients and interpret them in the framework of mean-field dynamo theory.

2. MODEL AND METHODS
The full MHD (FMHD) system of equations, here with an isothermal equation of state, is more complex than that of SMHD used in earlier TFMs because of the occurrence of the pressure gradient. As a result, we need an additional evolution equation for the density, being the counterpart to the Poisson equation for the pressure in incompressible MHD. Also the viscous force is now more complex. Hence, we have

DAA = U × B + FM + 2A, (1) (DU + U ·)U + P = J × B + FK + ·(2S),(2)

(D + U · ) ln  = - · U ,

(3)

where J =  × B is the current density with the vacuum permeability set to unity. Furthermore,

DAA = DA + SAyx^,

(4)

DU U = DU + SUxy^ + 2 × U ,

(5)

D = t + Sxy

(6)

are linear operators. Here,  = z^ is the global angular
velocity vector, Sij = (Ui,j + Uj,i)/2 - ij · U /3 are the components of the traceless rate-of-strain tensor S, where
commas denote partial differentiation, and P is the pressure related to the density via P = c2s  with the isothermal sound speed cs. Terms containing S are due to a linear background shear flow of the form U (S) = Sxy^. Magnetic diffusivity ,
kinematic viscosity , and sound speed are assumed constant.
For ln  ("pseudo enthalpy") we shall employ the symbol H.

2.1. Test-field methods
Throughout, we define mean quantities by horizontal averaging, i.e., averaging over x and y, denoted by an overbar. So the means depend on z and t only. Fluctuations are denoted by lowercase symbols or primes, e.g., a = A - A, (u × b) = u × b - u × b, and fK,M = FK,M - F K,M. The horizontal average obeys the Reynolds rules, given that U (S) can effectively be treated as a mean flow. For peculiarities involved here, we refer to Ka¨pyla¨ et al. (2020), Sec. 2.3.1.
The evolution equations for the fluctuations of magnetic vector potential, a, velocity, u, and pseudo-enthalpy, h =

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

3

(ln ) , follow from Eqs. (1)­(3) as
DAa = U × b + u × B + (u × b) + fM + 2a, (7) DU u = -c2s h + -re1f J × b + j × B + (j × b)
-U · u - u · U - (u · u) + fK (8) + 2u +  · u/3 +2 S · h + s · H + (s · h) Dh = -U · h - u · H - (u · h) -  · u. (9)
In order to avoid the occurrence of triple correlations, we have modified the momentum equation by replacing the density in the denominator of the Lorentz acceleration by a reference density ref . It is set equal to the volume averaged density and is constant in time as mass is conserved. A possible refinement would consist in using a horizontal average

instead, thus allowing ref to change in time and to depend on z.
2.1.1. Nonlinear TFM
In the quasi-kinematic test-field method (QKTFM; see Sect. 2.1.2), the mean electromotive force E = u × b, is a functional of only u, U , and B (linear in B). However, in the more general case with a magnetic background turbulence, this is no longer so. To deal with this difficulty, RB10 added the evolution equations for the background turbulence u(0), b(0) to the equations of the TFM. In the context of FMHD we add the evolution equations for u(0), b(0), h(0) , which by definition apply for zero mean field -- thus we name this system the "zero problem". Let now all variables be split in parts independent of (superscript "(0)") and homogeneous in B (superscript "(B)"), respectively, like u = u(0) + u(B) etc. Then

DAa(B) = U × b(B) + u × B + u(0) × b(B) + u(B) × b(0) + u(B) × b(B) + 2a(B),

(10)

DU u(B) = -c2s h(B) + -re1f J × b + j × B + j(0) × b(B) + j(B) × b(0) + j(B) × b(B)

-U · u(B) - u(B) · U - u(0) · u(B) + u(B) · u(0) + u(B) · u(B)

(11)

+ 2u(B) +  · u(B)/3 + 2 S · h(B) + s(B) · H + s(0) · h(B) + s(B) · h(0) + s(B) · h(B)

Dh(B) = -U · h(B) - u(B) · H - u(0) · h(B) + u(B) · h(0) + u(B) · h(B) -  · u(B),

(12)

and the "zero problem" is given by

DAa(0) = U × b(0) + u(0) × b(0) + fM + 2a(0),

(13)

DU u(0) = -c2s h(0) + -re1f j(0) × b(0) -U · u(0) - u(0) · U - u(0) · u(0) + fK

(14)

+ 2u(0) +  · u(0)/3 + 2 S · h(0) + s(0) · H + s(0) · h(0)

Dh(0) = -U · h(0) - u(0) · H - u(0) · h(0) -  · u(0).

(15)

Note that, while Equations (10) and (11) are visibly inhomogeneous1 via the terms u(0) × B and J × b(0) + j(0) × B (both homogeneous in B), this also holds true for Equation (12) via  · u(B), which does not vanish for B = 0.
In general, E = u × b can be split into a contribution E(0) = u(0) × b(0), which is independent of the mean field,
1 The more precise term is "heteronomous" as used in the nonlinear dynamical systems context.

and
E(B) = u(0) × b(B) + u(B) × b(0) + u(B) × b(B), (16)
where u(B) and b(B) denote the solutions of Eqs. (10) and (11) (called "test problems"), which are supposed to vanish for vanishing B. E(B) can be written in two equivalent ways as
E(B) = u × b(B) + u(B) × b(0) = u(0) × b(B) + u(B) × b. (17)
Both become linear in quantities with subscript B when b and u are identified with the fluctuating fields in the "main

4

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

run", which is the system (1)­(3) solved simultaneously with the test problems. In this way, we have recovered the mentioned linearity property of the functional E[B] of the QKTFM. Likewise, one writes that part of the mean ponderomotive force F (B) (an acceleration by unit), which results from the Lorentz force as
j × b(B) + j(B) × b(0) or j(0) × b(B) + j(B) × b, (18)
(the factor 1/ref omitted here), that resulting from selfadvection as
-u·u(B) - u(B) ·u(0) or - u(0) ·u(B) - u(B) ·u, (19)
that resulting from the nonlinear viscous force part
s(0) · h(B) + s(B) · h or s · h(B) + s(B) · h(0), (20)
and the mean "magnetically induced mass source" Q(B), resulting from the advective term in the continuity equation
-u(0) ·h(B)-u(B) ·h or -u·h(B)-u(B) ·h(0), (21)
cf. Eqs. (29) and (30) of RB10. Corresponding expressions can be established for the fluctuating parts of the bilinear terms, (u × b) , (j × b) , (u · u) , (s · h) , and (u · h) occurring in Eqs. (10) , (11) and (12). We recall that these different formulations result in different stability properties of the test solutions. Here, we chose to use in Eqs. (17)­(19) and the aforementioned expressions for the fluctuating parts of the bilinear terms the respective first version, that is, E(B) = u × b(B) + u(B) × b(0), (u × b) = u × b(B) + u(B) × b(0) etc. This choice forms what is called the ju method; see Table 1 of RB10. As we have five bilinear terms, altogether 32 different flavors of the CTFM exist, out of which, however, we consider only the four, already employed in earlier works. All these alternative formulations become equivalent when the mean magnetic field, possibly evolving in the main run, is too weak to have any influence on the fluctuating fields, or, in other terms, when B  0. Then, u  u(0), b  b(0), and h  h(0), which defines the kinematic limit. Employing it means dropping terms like u(B) × b(B) in mean EMF, mean force, and mean mass source, which is the correct way to obtain the latter as quantities of first order in B. Then all possible versions of the CTFM (which actually ceases to be nonlinear) have to yield identical results up to roundoff errors.
We solve Eqs. (10)­(12) not by setting B to the actual mean field resulting from the solutions of Eqs. (1)­(3), but by setting it to one out of four test fields B(i), i = 1, . . . , 4. Those are
B(1) = (cos kBz, 0, 0), B(2) = (sin kBz, 0, 0), (22) B(3) = (0, cos kBz, 0), B(4) = (0, sin kBz, 0), (23)

where kB is the wavenumber of the test field, being a multiple of of the wavenumber corresponding to the ver-
tical extent of the computational domain. From the solutions of Eqs. (10)­(12) we can construct, for each B(i) (superscripts (i) left out hereafter), the mean electromotive forces E(B) = u × b (B), the mean ponderomotive forces, F (B) = j × b/ref - u · u + 2 s · h (B), and the mean mass sources Q(B) = - u · h (B), which are then
expressed in terms of the mean field by the ansatzes

E

(B) i

= ij Bj

-

ij J j ,

(24)

F

(B) i

= ij Bj

-

ij J j ,

(25)

Q(B) = iBi - iJ i,

(26)

where i, j adopt only the values 1, 2 as a consequence of Jz = 0 and setting (the anyway constant) Bz arbitrarily to zero. Hence, each of the four tensors, ij, ij, ij, ij, has four components,and together with the vectors i and i, we have 20 unknowns. ij, ij, and i are pseudo-quantities, ij, ij, and i true ones. Note that often the  and  tensors are defined as just the symmetric parts of our ij and ij while their antisymmetric parts are cast into the vectorial coefficients of the  and  effects. The coefficients , , , and  describe in turn the effects of turbulent generation,
diffusion, pumping and the (non-generative, non-dissipative) so-called Ra¨dler effect. In the presence of shear, the coefficient yx plays a prominent role; see Sect. 3.2.4.
In spite of what could be expected from the Lorentz force, being quadratic in B, the turbulent ponderomotive force Eq. (25) is with leading order linear in B. This is because of the effect of the magnetic background turbulence b(0) via, in the kinematic limit, j(0) × b(B) + j(B) × b(0). A mass source Q(B) due to non-vanishing vectors  or  requires
anisotropy of the turbulence. It was not considered in this work, nor was F (B).
For completeness, we provide here the equations governing the mean quantities A, U and H

tA = - SAyx^ + U × B + 2A + E,

(27)

tU = - SU xy^ - c2s H - U · U - 2 × U (28)

+ (2U +  · U /3) + 2S · H (29)

+ J × B/ref + F ,

(30)

tH = - U · H -  · U + Q .

(31)

Note that in this most general form, all quantities comprise `(0)' and `(B)' constituents. Thus, also the vorticity dy-
namo is covered, which to model, however, one would need a parameterization of F (0) and Q(0) in terms of U (0). The
CTFM cannot produce such.

2.1.2. Quasikinematic TFM

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

5

We state here for comparison the governing equation for the QKTFM (see also Schrinner et al. 2005, 2007), which is just Eq. (10) with b(0) = 0, while dropping Eq. (11) ­ Eq. (12). Hence Eq. (17) reduces simply to

E(B) = u × b(B),

(32)

and we find the contribution u(B) × b(0) missing. Again, for further details see RB10.

2.1.3. Resetting
The test problems Eqs. (10)­(12), being linear, can have unlimitedly growing solutions, but usually the measured transport coefficients nevertheless show intervals, in which they are statistically stationary, in other words show "plateaus". If these are absent altogether, we disregard such a measurement, or try to improve it by lowering the time step or increasing the resolution. We reset the test solutions after regular intervals (typically every 15­20 turnover times in this study); see Hubbard et al. (2009) for a discussion. Each resetting interval hence contains an initial transient, which we remove from the analysis. If the coefficients also show nonstationary behavior towards the end of the resetting interval, these parts are removed, too.

2.2. Random forcing
We utilize the standard random forcing as implemented in the PENCIL CODE (Pencil Code Collaboration et al. 2021), which employs white-in-time harmonics. Their wavevectors are chosen from a thin shell in k space of radius kf further requiring that they fit into the computational domain. We also exclude the case ky = 0 to avoid a mean field or flow to be directly sustained.

2.3. Suppression of the vorticity dynamo
The runs with shear alone ( = 0) are prone to a hydrodynamic instability, leading to the generation of mean flows and usually referred to as the vorticity dynamo (see, e.g. Elperin et al. 2003; Ka¨pyla¨ et al. 2009). As in Ka¨pyla¨ et al. (2020), we prefer to suppress these flows, to focus on studying the magnetic shear current effect in isolation. The procedure adopted there, namely subtracting xy averaged mean flows, is not a sufficient measure here as not all the mean flows are captured. Hence, we turn to another method, namely suppressing the vorticity dynamo by adding a small amount of rotation to the system. For  and S of opposite sign, which is the standard case in galactic and accretion disks, we would be limited to the range where q  -S/ < 2, as at the upper limit the flow would become Rayleigh unstable. If we, however, choose the same sign, hence a negative q, we can avoid this limitation. Here, we investigate values of q in the range [-40, ..., -10], and choose the maximum value that still suppresses the vorticity dynamo, but does not yet significantly affect the test field measurements; see Sect. 3.2.1.

2.4. Input and output quantities

The simulations are fully defined by choosing shear param-

eter S, rotation rate , the forcing amplitude and wavenum-

ber, kf , and the diffusivities  and . For normalizations we use the length scale k1-1, with k1 = 2/L, where L is the ex-
tent of the simulation domain in any direction, and the acous-
tic time scale s = (csk1)-1. Rotation rate  and shear rate S are normalized by the acoustic time scale as ~ = s and S~ = Ss. The boundary conditions are periodic in y and z,
while shearing­periodic in x.

For the velocity field, we define a time-averaged rootmean-square (rms) value as urms = u2 1/2 t, and a timedependent variant urms(t) = u2 1/2. Simulation results are
often shown as functions of the time in units of turnover time,

turmskf . Similarly, we define rms values for the magnetic

field Brms = B2 1/2 t, and Brms(t) = B2 1/2, while

Bi,rms =

B

2 i

1/2 z

are

the

rms

values

of

the

mean

field

com-

ponents. Here, . denotes volume averaging and .  aver-

aging over a coordinate . The magnetic field is normalized

by the equipartition field strength, Beq = u2 1/2 t. For diagnostics, we quantify the strength of the turbulence

by the fluid and magnetic Reynolds numbers

Re = urms ,  kf

ReM

=

urms kf

=

PrM Re,

(33)

where



PrM

=

, 

(34)

is the magnetic Prandtl number. The Lundquist number is

given by

Lu = kBf rmsref .

(35)

The strength of the imposed shear is measured by the dy-

namic shear number

S

ShK

=

. urmskf

(36)

We normalize the turbulent magnetic diffusivity tensor by the molecular diffusivity .

2.5. Interpretation of the dynamo instability
As in Ka¨pyla¨ et al. (2020), we compute three different dynamo numbers describing a 1D mean­field dynamo model2, in which both the coherent shear-current effect and the incoherent ones due to yy and yx fluctuations with zero mean are taken into account. The coherent shear current effect is characterized by

1S

DS  T2

kz2 + xy yx + ,

(37)

2 In Ka¨pyla¨ et al. (2020) we labelled this model "0D" because the explicit z dependence can be eliminated by employing the ansatz A  exp(ikz)

6

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

where T =  +t, t = (xx + yy)/2, = (xx - yy)/2, and kz is the dynamo wavenumber. Our standard approach is to identify this wavenumber from the Fourier mode grow-

ing fastest during the exponential phase of an LSD and we

denote it as kz,kin. The incoherent -shear-driven dynamo is

described by

DS

=

rms |S T2 kz3

|

,

(38)

where we consider in rms only the fluctuations of yy. Fi-

nally, for a dynamo driven by the incoherent SC effect due to

fluctuations of yx and shear,

Drms S

=

yx,rms |S| T2 kz2

(39)

is relevant. In Ka¨pyla¨ et al. (2020), we derived the marginal dynamo numbers for a grid of combinations of (DS, DS, DrmsS), and we refer the reader to these results. For orientation, we note that in the absence of the incoherent effects, DS > 1 is required for dynamo action, but in the absence of the coherent and incoherent SC effects, DS > 2.3. The presence of the SC effects can increase DS, but this influence is mild.

3. RESULTS

3.1. Roberts flow and field

A simple and reliable way of validating the CTFM is to restrict oneself to two dimensions (x and y) and compare with the imposed-field method, where xx,yy = u × b · B0/B02x,0y and B0 is a uniform field, imposed in either the x or the y direction. The two-dimensional case corresponds to kz = 0, so that no turbulent diffusion can act and only the  tensor is considered. For the flow (or field) geometry, we have chosen case I of Roberts (1972),which is a vector field of the form (- cos x sin y, sin x cos y, 2 cos x cos y) having the Beltrami property. A ponderomotive force is constructed such that without magnetic field exactly that geometry is obtained, in the background flow u(0), that is, the distortion by the u(0) · u(0) term is compensated and the pressure gradient vanishes as well as the nonlinear part of the viscous force. In the complementary case of magnetic forcing, an EMF with just the Roberts geometry is sufficient as due to its Beltrami property and the linearity of the induction equation the resulting Lorentz force is zero, no flow is driven, and b(0) has exactly the Roberts geometry bRob. In Figures 1 and 2 we show the ReM dependence of xx = yy   for kinetic and magnetic forcing, respectively (xy,yx = 0). As in Rheinhardt & Brandenburg (2010), we have normalized  by 0K = -urms/2 and 0M = 3brms/4, respectively.
In the kinetically forced case, we compare with the QKTFM and find perfect agreement, as expected. In the magnetically forced case, the QKTFM yields the wrong sign of , as was already found by Rheinhardt & Brandenburg (2010)
in SMHD, while the corresponding TFM was found to agree with the imposed-field method. Comparing their re-

Figure 1. ReM dependence xx = yy  , agreeing with imp for the forced Roberts flow.
Figure 2. Lu dependence of  for forced magnetic background with Roberts geometry PrM = 1, using FMHD with CTFM and (black). Red dashed: SMHD. sults with those of the CTFM, we find agreement up to some fixed offset for small values of Lu; see Figure 2.
In Figure 3 we show the dependence of xx and yy on B0 for the forced magnetic background with Roberts geometry and  = . We also compare with  from the imposed field method, which is in perfect agreement with xx. As expected, due to the anisotropy induced by the imposed field, the  components show an increasing difference. Surprisingly, the slope of the quenching characteristic exhibits now power -5 while in Rheinhardt & Brandenburg (2010) and Karak et al. (2014) -4 had been observed. It is suggestive to attribute this difference to the inclusion of pressure gradient and self-advection.
3.2. Shear dynamos with SSD magnetic background turbulence

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

7

Figure 3. B0 dependence of  for the flow-free magnetically forced background with Roberts geometry 0, bRob and PrM = 1 from the CTFM. Red dashed: imposed field method with B0 = B0x^. Lu0 = Lu(B0 = 0).
In this section we perform a continuation study of Ka¨pyla¨ et al. (2020), where the SMHD equations were used (governing so-called burgulence) with kinetic and magnetic forcing. Now we turn to full MHD, forced, however, only kinetically with a nonhelical form of the forcing. Hence, in all experiments, we set fM to zero. We measure the turbulent transport coefficients from volume averaged quantities, that are, furthermore, averaged over time, neglecting the transients and untrustworthy parts of the time series, as explained in Sect.2.1.3. The incoherent effects are measured following the same procedure, but rms values are used: rms = yy2 1/2 t and rms = yx2 1/2 t. It should be noted that our values of rms and rms underestimate the actual ones, which also include the z dependent fluctuations.
3.2.1. Vorticity dynamo
For certain values of PrM, namely for 5 and 10, while not for 1 and 20, we see the generation of strong mean flows. In Figure 4 we compare cases with and without rotation from purely hydrodynamical counterparts of our MHD runs. With such experiments we can verify the presence of the mean flows due to a vorticity dynamo and not due to the backreaction of the magnetic field. In the case of ~ = 0, hence shear alone (black line in panel (a), and panel (b)), we see the generation of a strong mean flow, which first grows exponentially with a dominating kz = k1 mode, and then saturates, exhibiting oscillatory behavior with complicated phase migration. In the MHD runs with TFM the mean flows perturb the system to the extent that the test solutions start to grow super-exponentially. The time step becomes prohibitively small, and no plateaus can be observed anymore in the transport coefficients. Hence, all these TFM measurements have been disregarded.

If a very small amount of rotation is added (panels (c) and (d)), the instability is suppressed, with urms(t) remaining statistically constant throughout the simulation (blue and orange lines in panel (a)). We see, however, that the vertical length scale of the flow is larger in the case of weaker (d) than in the case of stronger rotation (c). This indicates that the q = -40 case has still too weak rotation to fully suppress the vorticity dynamo, while q = -20 brings the vertical scales close to the forcing scale kf = 10k1. The presence of weak mean flows for q = -40 is also reflected in the slightly larger urms(t) (orange line slightly above the blue one in panel (a)).
We have run CTFM simulations without shear, but with a rotation rate corresponding to q = -20, and also with a ten times higher rotation rate; see Figure 5(a)­(d). One can observe that the crucial yx is very similar in the cases with weak rotation, with shear included (orange lines) or excluded (black lines), while all the other  components are much more strongly affected. The diagonal components are clearly larger for S~ = 0, and xy reverts its sign from strongly positive (with shear) to very low values fluctuating about zero (without shear) 3 From the run with ten times faster rotation (blue lines) we observe that with increasing rotation rate there is a tendency to revert the sign of yx to positive and to increase its magnitude, while reverting xy to negative values, but with weaker magnitude. We conclude that for q = -20, the rotation rate is still small enough to not affect the TFM measurements significantly. Hence, we select q = -20 as the fiducial parameter for our runs.
We use this setup for all Prandtl numbers above unity, to guarantee that no mean flows disturb the measurements. We note, however, that for PrM = 20 the results are nearly identical with and without rotation, indicating that the vorticity dynamo is not active there. This is illustrated in Figure 5(e), where we show the measurements of the yx component with and without rotation, yielding very similar results in the midranges of the resetting intervals. The parameters, varied in the henceforth presented simulations, are the shear rate S~, the magnetic Prandtl number PrM, and the forcing wavenumber kf .
3.2.2. Models with Prandtl number of unity
We proceed by discussing runs with PrM of unity and forcing wavenumber kf = 5k1. This choice is motivated by a recent study by Zhou & Blackman (2021), who highlighted weak-shear cases at low to moderate Reynolds numbers and PrM = 1 to give rise to a negative yx, when measured with the QKTFM. Without further analysis, such a result could be easily interpreted to be (i) contradictory to all previously
3 Note that in the absence of shear but  = 0, the off-diagonal elements of  have to reflect the Ra¨dler effect, hence xy = -yx. In our results, however, the signal is drowned out by the fluctuations.

8

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

Figure 4. Comparison of the generated mean flows with S~ = -0.2, ~ = 0 (black line panel (a); zt diagram in panel (b)), S~ = -0.2, ~ = -0.01 (q = -20; blue line in panel (a); (c)), and S~ = -0.2, ~ = -0.005 (q = -40; orange line in panel (a); (d)). The uppermost panel
shows the time evolution of the volume-averaged rms velocity, urms(t). Colors in the zt diagrams encode U y/cs with extrema ±0.7, ±0.014,
and ±0.022, in panels (b)­(d), respectively.

Run ReM ShK Lu

xx/

yy /

yx/

xy /

rms/tkf

rms/

nS00Pm1 43

0 12 26.491±0.321 26.919±0.463 0.094±0.156 0.233±0.429 0.044±0.016 2.873±0.985

qS00Pm1 43

0 12 27.298±0.207 26.922±0.051 0.110±0.138 -0.159±0.422 0.045±0.016 3.353±1.423

kS005Pm1 43 -0.09 13 28.794±0.322 28.480±0.227 0.122±0.296 3.413±0.413 0.036±0.012 2.601±0.381

nS005Pm1 43 -0.09 13 28.516±0.549 28.158±0.502 -0.151±0.320 4.006±0.125 0.038±0.011 2.810±0.679

qS005Pm1 43 -0.09 13 29.107±0.377 28.621±0.517 -0.543±0.318 4.070±0.302 0.039±0.012 2.987±0.829

kS01Pm1* 47 -0.16 16 36.436±0.354 35.382±0.098 0.435±0.366 8.707±0.718 0.029±0.015 2.839±1.442

nS01Pm1* 46 -0.19 16 27.413±0.291 27.604±0.478 0.552±0.378 6.923±0.129 0.036±0.014 2.401±0.558

qS01Pm1 46 -0.17 18 38.173±0.653 36.291±0.830 -1.033±0.829 11.399±0.924 0.039±0.011 5.107±1.501

kS02Pm1 66 -0.23 25 70.218±6.340 65.830±6.636 0.717±0.298 32.987±3.260 0.020±0.009 4.164±1.529

nS02Pm1 62 -0.25 28 59.060±3.234 57.019±2.562 0.390±0.554 29.457±2.578 0.020±0.011 3.391±1.806

qS02Pm1 65 -0.24 28 70.091±0.825 70.265±0.564 -0.568±0.277 42.854±0.917 0.027±0.008 5.468±1.317

Table 1. Summary of the PrM=1 runs with varying shear rate.
Note. Runs marked with `q', `k' and `n' have been analyzed with the quasi-kinematic TFM (QKTFM), the kinematic version of the CTFM (no main run), and the CTFM including the main run, respectively. Boldfaced: runs most compatible with Zhou & Blackman (2021). Runs marked with * indicate cases, where the magnetic background turbulence is not statistically similar.

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

9

Figure 5. Panels (a)­(d): components of , measured with the
CTFM and normalized to the microscopic diffusivity . Black: S~ = 0, ~ = -0.01; blue: S~ = 0, ten times stronger rotation (~ = -0.1); orange: S~ = -0.2, ~ = -0.01 (q = -20),
all for PrM = 10. The time axes have been made to match at
t urmskf = 400 hence orange and blue curves have been introduced
with small offsets (t urmskf = 6 and 8, respectively). Panel (e):
yx from PrM = 20 runs with no (black) and weak (orange) rotation (~ = -0.01, q = -20).

Table 2. Dynamo numbers for the runs with PrM=1 and variable shear rate.

Run
nS00Pm1 qS00Pm1 kS005Pm1 nS005Pm1 qS005Pm1 kS01Pm1 nS01Pm1 qS01Pm1 kS02Pm1 nS02Pm1 qS02Pm1

-S~ kz,kin kz,sat kB [k1] [k1] [k1]
0 1 11 0 1 11 0.05 1 1 1 0.05 1 1 1 0.05 1 1 1 0.1 1 1 1 0.1 1 1 1 0.1 1 1 1 0.2 1 1 1 0.2 1 1 1 0.2 1 1 1

DS
9×10-5 2×10-5 -0.0135
0.0169 0.0585 -0.0609 -0.1870 0.1339 -0.0542 -0.0076 0.0401

DrmsS DS

0 0 0.2961 0.3265 0.3350 0.4168 0.5908 0.6988 0.3496 0.0973 0.4317

0 0 0.7048 0.6812 0.6829 0.8029 1.1218 1.0811 0.4357 0.0600 0.5277

Note. The dynamo numbers are calculated based on the wavenumber kz,kin of the fastest growing Fourier mode in the kinematic stage of the LSD. The other wavenumbers are those of the mode dominating in the saturation stage of the mean field, kz,sat, and those of the test fields, kB. For the kinematic CTFM measurements (label `k', no main run), kz,kin and kz,sat have been taken from the corresponding CTFM run with main run (label `n').

published numerical results that have not reported negative

Figure 6. Volume-averaged rms values of the velocity (urms(t), black) and the total magnetic field from the main run (Brms(t), yellow), magnetic zero solution (b(r0m)s(t), orange), rms values of the mean azimuthal (By,rms, red) and radial (Bx,rms, blue) magnetic fields from Run nS02Pm1, all normalized to urms.
Figure 7. zt diagrams of By (top) and Bx (bottom) from the main run of qS02Pm1. The main run of nS02Pm1 is identical up to some slight differences due to the difference of time steps.
yx values in incompressible, anelastic, or SMHD, and (ii) favorable for shear-current effect dynamos.
Our strategy for measuring the transport coefficients is the following: we start the CTFM simulations with only the zero problem turned on until its solution has saturated. The measurements would not be meaningful before, but this strategy also accelerates the runs as most of the test problems are activated only after saturation. There we proceed with the measurements until the saturation of the mean fields. These kind of runs are reported in our tables below with names starting with `n' (nonlinear). To obtain the turbulent transport coefficients in the kinematic regime, we repeat the simulations without the main run (run names starting with `k'). We also perform QKTFM measurements for each run (run names

10

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

starting with `q'). In the last two cases, we compute the turbulent transport coefficients after the saturation of both types of dynamos (if present).
We begin by presenting results from two runs without shear and rotation employing the CTFM and QKTFM, respectively, and integrated over six thousand turnover times; see the first entries in Table 1. For these setups, a SSD is present, resulting in initial exponential growth of the magnetic field, which then saturates at around 400 turnover times. After that, the magnetic energy stays close to its average saturation value of Lu  0.25 ReM. We see that both methods give consistent results: the diagonal elements are isotropic, i.e., roughly of the same magnitude within error bars, and the off-diagonal elements are consistent with zero. These runs were integrated twice as long as any other run, hence their error bars reflect the minimal level to be achieved with realistic computation times. The agreement of the CTFM and QKTFM is not self-evident: Given the weakness of the SSD, we interpret it as an indication of strong dominance of the contribution u(0) × b(B) to the mean EMF over u(B) × b(0); see Sect. 2.1.2.
By adding shear, we find that SSD is enhanced in terms of its saturation strength, as indicated by the increasing Lundquist number (Lu) in Table 1. The growth rate also increases somewhat as function of the shear rate; for a typical case see Figure 7 with the largest shear number in this set. For the shear numbers covered, the rms strength of the total magnetic field reaches Lu  0.42ReM at the highest shear. In all cases, the magnetic fields of the zero problem and the main run are of similar strength; correspondingly, the mean fields reach maximally a few percent of the equipartition strength at the highest shear rate. None of the constituents of the magnetic field show significant growth after the SSD has saturated; see Figure 6. Obviously, shear and turbulence have only the capability of generating shortlived large-scale patches in By (see Figure 7), persisting only over a few tens to maximally a couple of hundred turnover times. The timescale of persistence is even shorter in Bx (maximally a few tens). The wavenumber of these patches is kz = k1, which is consistently used to compute the dynamo numbers for these runs, see Table 2. We note that the dynamo numbers are maximized by kz,kin = k1 ­ any larger wavenumber would reduce them.
As per the measurements of the turbulent transport coefficients, differences start emerging in yx when shear is added and increased. The kinematic CTFM gives consistently positive values, except in the case with the weakest shear, S~ = -0.05, where the error bars are too large to infer the sign. Integrating further, however, is prohibitive in view of the resources needed. The same is found beyond kinematics, i.e., when the main run is included in the CTFM. This is expected as no clear mean-field dynamo is operational and

the two versions of the CTFM have to agree. The QKTFM, however, yields negative yx within error bars with all shear numbers investigated. Hence, we can reproduce the results of Zhou & Blackman (2021) of negative yx with the QKTFM, but the results of the CTFM do not lend support to them.
As per the other  components, we note that the QKTFM yields larger diagonal components in comparison to the CTFM with main run, especially in the cases with high shear. Both methods give positive values of xy, but the values retrieved with the QKTFM are larger than those with CTFM.
We note that in one case, namely with S~ = -0.1, the background turbulence is statistically different between the kinematic and non-linear CTFM runs, which can only be understood by assuming the SSD to exhibit more than one statistically stationary solution (due to a second bifurcation additional to the one from the non-magnetic state). Simultaneously, we observe a difference in the measured transport coefficients, such that the diagonal components are larger by about 25% in the case where the background turbulence is stronger (kinematic run). Given the weakness of the mean field, we attribute these marked differences to the difference in the background turbulence. Similar difference, but weaker, is also seen in the case S~ = -0.2 ( 15%), although the background turbulence is statistically similar. Hence we must conclude that here the mean field is responsible.
We also compute the dynamo numbers, following the procedure described earlier, and report them in Table 2. We note that in the shearless case, DS is ideally zero, but not in practice due to limited accuracy of the measurements. With all the shear rates investigated, the dynamo number remain subcritical both with respect to the coherent shear-current effect and the incoherent ones (for a complete analysis, see Ka¨pyla¨ et al. 2020). This is in perfect agreement with the observation of the mean fields to remain weak with hardly any growth, except for a slight increase in By. This is most likely the reason why in the earlier study of Brandenburg et al. (2008a) employing the QKTFM, which concentrated on analyzing the regime with generation of strong large-scale fields, no attention was paid to this parameter regime. We also regard it to be insignificant for the investigation of dynamos in shear flows.
3.2.3. Varying Prandtl number and moderate shear
Next we map out a part of the parameter space where the generation of significant large-scale magnetic fields occurs. One such regime can be found when kf and PrM are increased, while keeping the shear number ShK at moderate values. For runs with 5  PrM  20, we find mean magnetic field configurations closely matching those of (Brandenburg et al. 2008a; Squire & Bhattacharjee 2015); see Figure 8. In contrast to the weak, incoherent, and short-lived patches seen in Figure 7, the mean azimuthal field grows to near equipar-

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

11

Table 3. Summary of the models with variable PrM and fixed shear rate.

Run

PrM ReM ShK Lu

xx/

yy /

yx/

xy /

rms/tkf

rms/

kS02Pm5*

5 17 -0.48 16 5.444±0.515 5.045±0.578 0.043±0.037 3.180±0.381 0.031±0.013 0.259±0.083

nS02Pm5*

5 16 -0.50 22 4.235±0.181 4.210±0.220 0.173±0.016 0.634±0.136 0.028±0.012 0.194±0.087

qS02Pm5

5 16 -0.49 18 5.910±1.429 6.034±1.388 0.273±0.125 1.994±1.447 0.025±0.009 0.381±0.315

kS02Pm10

10 42 -0.50 45 13.444±0.495 12.284±0.741 0.094±0.067 5.031±0.440 0.026±0.012 0.405± 0.218

nS02Pm10

10 42 -0.47 48 14.832±1.066 14.923±1.042 0.501±0.035 3.710±1.178 0.026±0.011 0.659±0.246

qS02Pm10

10 42 -0.47 49 13.276±1.528 13.541±1.641 0.400±0.077 2.160±1.844 0.030±0.011 0.631±0.376

kS02Pm20

20 33 -0.60 44 6.093±0.136 5.371±0.249 0.040±0.012 1.574±0.790 0.046±0.013 0.326±0.077

nS02Pm20

20 33 -0.60 47 7.356±0.807 5.608±0.486 0.000±0.042 0.874±0.326 0.041±0.020 0.202±0.128

nS02Pm20k3 20 33 -0.60 50 6.148±0.172 5.275±0.195 -0.023±0.104 0.671±0.324 0.042±0.021 0.218±0.133

qS02Pm20

20 33 -0.61 47 5.696±0.462 6.008±0.528 0.033±0.021 -1.017±0.533 0.045±0.011 0.228±0.094

Note. Conventions as in Table 1.

12

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

Table 4. Dynamo numbers for the models with variable PrM and fixed shear rate.

Run

PrM kz,kin kz,sat kB

[k1] [k1] [k1]

kS02Pm5

52 11

nS02Pm5

52 11

qS02Pm5

52 11

kS02Pm10 10 2 1 1

nS02Pm10 10 2 1 1

qS02Pm10 10 2 1 1

kS02Pm20 20 3 1 1

nS02Pm20 20 3 1 1

nS02Pm20k3 20 3 1 3

qS02Pm20 20 3 1 1

DS
-0.2150 -1.2616 -1.1108 -0.4694 -0.9868 -0.7421 -0.5960 0.0124 0.1192 -0.1564

DrmsS DS

1.3290 1.4233 1.5666 1.0548 1.3086 1.5195 1.6005 0.8021 1.0737 1.0812

3.2462 2.9659 2.4237 3.4429 2.9487 3.5596 3.2820 2.6719 2.9375 3.2568

Note. Conventions as in Table 2.

tition; see further Figure 9. The kz = k1 mode emerging in the nonlinear stage exhibits phase coherence nearly throughout the whole 5000 turnover times of the run. Likewise, Bx shows faint hints of the same pattern, but with a sign opposite to By.
The properties of the obtained SSDs and LSDs are as follows: the mean azimuthal field grows always to near equipartition as can be seen from Figure 10. The dynamo growth rates depend on ReM, hence the SSD grows slowest for PrM = 5, while for PrM = 10 and 20 nearly equally fast, yet with a higher growth rate. For PrM = 5, the SSD saturates below equipartition, but very close to it for the higher Prandtl numbers. After saturation of the SSD, mainly By continues to grow. Again, the highest PrM and ReM cases show the fastest growth, which is, however, distinctly slower than that of the SSD. For PrM = 5, the LSD grows the slowest, and, because its SSD's saturation strength was lower4, growth is seen also in Bx. Its growth rate, however, is different from that of By, which is somewhat atypical of "standard" dynamos and could be taken indicative of eigenmodes that consist of only one component; see Rheinhardt et al. (2014); Brandenburg & Chen (2020) for examples. However, for an LSD based on the coherent effects alone this can be ruled out here. Eventually, the Bx components grow equally strong in all cases, while the saturation strength of By is the highest for the highest PrM, but this component undergoes semi-regular oscillations in all the runs. The total magnetic

4 As we diagnose the mean field in terms of the rms values of Bx,y, high vertical wavenumber modes enter. Hence, if the SSD is strong and LSD is weak, these modes will dominate, and the growth of the low wavenumber modes (the actual mean field) cannot necessarily be seen.

field saturation strength is also increasing with PrM, see the Lundquist numbers in Table 3. Our data also reveals that the saturation values of both b(0)2 and B2 grow with PrM. This indicates that a possible reduction of b2 in comparison to b(0)2 , caused by the mean field (quenching), is overcompensated by B2 as the total magnetic energy is  b + B 2 = b(0) + b(B) 2 + B2 .
It is very difficult to disentangle the wavenumber of the preferentially growing Fourier mode of the LSD, as the SSD `contaminates' the growth rates: all modes exhibit exponential growth with the same growth rate as long as LSD and SSD grow simultaneously (for a more detailed analysis of a similar system; see Va¨isa¨la¨ et al. 2021), and separating the growth rates of these two instabilities is impossible. Hence, we have to rely on the following means of separation: We perform a dedicated set of runs, where we first suppress the mean magnetic field at each time step, while letting the SSD grow until saturation. After that we continue the simulations, but with the mean fields allowed to grow from very small seeds. Now only the eigenmodes of the LSD grow, so we can determine the fastest growing of them and extract its wavenumber kz,kin. For PrM = 5 and 10 we obtain kz/k1 = 2, while kz,kin/k1 = 3 for PrM = 20. As is evident from Figure 8, in the saturated stage, the mode of wavenumber unity takes over, thus kz,sat = k1. This happens in all LSD­active simulations, as can be seen from Table 4.
From Table 3, we observe that with none of the employed TFMs the measured yx is significantly negative. Hence, it is unlikely that these dynamos are driven by the coherent magnetic SC effect. We observe that the higher the PrM, the more anisotropic the diagonal components of  get, when measured with the CTFM. Since this anisotropy is also recovered with the kinematic version, it cannot solely be due to the mean magnetic field, but must also reflect the growing influence of the shear, given that ShK is growing with PrM. Contrariwise, we note that the QKTFM does not reveal this anisotropy at all. Moreover, for higher PrM, the two methods tend to return xy with different sign ­ still positive for CTFM, negative for QKTFM.
We can also observe that the higher PrM, the more yx is approaching zero with all of the methods used. In particular, we have performed one run, nS02Pm20k3, where the vertical wavenumber of the test fields, kB is made to match kz,kin. There, a negative yx, albeit not significant within error bars, is obtained. This could be indicative of a tendency of yx to change sign as PrM is increased further. We tried to investigate this regime with the CTFM, but observed the test solutions to get unstable, with super-exponential, likely unphysical growth. Accordingly, the measurements become unreliable. Preliminary results from the QKTFM, indeed indicate a sign change of yx to negative, but without the pos-

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

13

Figure 8. zt diagrams of By (top) and Bx (bottom) from from the main run of qS02Pm20. The main run of nS02Pm20 is identical up to some slight differences due to the difference of time steps.
Figure 9. As Figure 6, but for Run nS02Pm20.
sibility of properly utilizing the CTFM, we leave this to be investigated in forthcoming work.
The kinematic dynamo numbers listed in Table 4, clearly predict positive growth rates for all PrM, as evidenced by the 1D mean-field dynamo model. The nonlinear version of CTFM gives predictions close to marginality, slightly subcritical for PrM = 5 and 10, and clearly critical for PrM = 20. Those returned by the QKTFM do not predict dynamo action for PrM = 5, but for larger PrM, they are more consistent with the kinematic CTFM measurements. In all cases in this set, the incoherent effects are sufficient to explain dynamo action, with often slight, but far from fatal inhibition by the coherent effect. We note that for PrM = 20 the nonlinear CTFM yields positive dynamo numbers DS for the coherent SC effect, but these are clearly below the critical one; moreover, the corresponding yx values turn out to be insignificant within error bars.

Figure 10. Volume-averaged rms values of the total magnetic field from the main run (Brms(t), solid), rms values of the mean azimuthal (By,rms, dashed), and radial (Bx,rms, dotted) fields from three different runs. Black: qS02Pm5, orange: qS02Pm20, blue: qS02Pm10.
3.2.4. Dependence on the shear rate
Here, we investigate the shear rate dependence of the transport coefficients and the LSD at PrM = 20. We perform three additional runs with shear rates S~ = -0.05, -0.1, and -0.3. As per the efficiency of the LSD, we notice that the strongest mean azimuthal field By in terms of equipartition is obtained with S~ = -0.2. For that value, roughly 70% of the magnetic energy is in the mean field. For S~ = -0.1 the corresponding fraction is 30%, and 55% for S~ = -0.3. Topology and coherence of the mean fields do not change as a function of shear rate: in all runs, we see the dominance of a coherent kz = k1 mode in the nonlinear stage. We also observe that shear enhances the SSD: In the case of the highest shear rate, the values of Lu are larger than in any other run, with, at times, even superequipartition total magnetic field. The presence of a more vigorous SSD, however, does not seem to boost the LSD.
The shear numbers ShK in this set approach the value -1, beyond which the shear is expected to dominate the dynamics of the system. We have also performed simulations in this regime, but, similarly to runs with strong mean flows, the test solutions of the CTFM exhibit enhanced instability, preventing us from performing sensible measurements. The test solutions show likely unphysical super­exponential growth, due to which the time step gets prohibitively small, while the retrieved transport coefficients do not show plateaus anymore. Already at S~ = -0.3, we see some high-frequency oscillations in xx, likely yet announcing enhanced instability, but the behavior of the test solutions and transport coefficients appears otherwise meaningful.
In the regime where the measurements are still trustworthy, the diagonal components of  do not manifest marked

14

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

anisotropy until |S~|  0.2, corresponding to |ShK| 0.5. Then, the CTFM indicates xx > yy within error bars, while the QKTFM rather tends to yy > xx, yet to be considered insignificant in view of the error bars. Both methods reveal a sign change of xy, when the shear is increased, but the transition occurs at smaller shear rates for the QKTFM (|S~|  0.1) than for the CTFM (|S~|  0.3). The most noteworthy change is for yx, where the CTFM indicates a change of sign to negative values at the highest shear rates, but this is not seen in the QKTFM. The negative sign from the CTFM, however, is still inconclusive given the error bars.
The retrieved dynamo numbers (Table 6) indicate slightly subcritical incoherent dynamos for the lowest shear rate, but clearly supercritical incoherent dynamos for all other shear rates. The prediction for the coherent SC-effect dynamo is unfavorable, except for the highest shear rate, where a positive, yet still subcritical DS is obtained. But, as already mentioned, this finding should not be regarded significant given the error bars of the transport coefficients.
4. CONCLUSIONS
This work presents the compressible test-field method (CTFM) applicable to full MHD with magnetic background turbulence. We present an extensive set of tests using 2D velocity and magnetic fields of Roberts geometry, for which it has long been known that the quasi-kinematic test-field method (QKTFM) completely fails (giving even the wrong sign of ) when a magnetic background is forced (Rheinhardt & Brandenburg 2010). We find agreement in  between the CTFM and the imposed-field method. We also compare with the SMHD approach of our earlier study (Ka¨pyla¨ et al. 2020), neglecting the pressure gradient, and find some mild discrepancies due to the former omission of this term.
We proceed by applying the CTFM to the case of shear dynamos, where our previous study was limited to SMHD with magnetic forcing, and was hence deemed inconclusive. In this work, we use full MHD subject to kinetic non-helical forcing only and moderate ReM, yet resulting in vigorous small-scale dynamo (SSD) action. We largely confirm the results of the earlier study, namely, the finding of largescale dynamos (LSD) excited by the incoherent ­shear effect, in the parameter regime of moderate shear numbers (up to ShK  -0.3 . . . - 1) and magnetic Prandtl numbers PrM = 5 . . . 20. With smaller PrM, where Zhou & Black-

man (2021) measured negative yx (favorable for the coherent SC-effect dynamo) with the QKTFM, we find uninterestingly weak LSD, and the CTFM does not confirm the QKTFM measurements.
We can identify two directions into interesting parameter regimes, where hints of tendencies to obtain negative yx can be observed: higher PrM and higher shear numbers ShK. What prevented us here from extending our analysis to these regimes is the aforementioned enhanced instability of the test solutions either in the presence of strong mean flows or very strong magnetic fluctuations. Further studies in this regime might be enabled by using higher resolution and even smaller time steps, greatly increasing the computational challenge, though. Another avenue for future research would be to assess the importance of the density in the Lorentz force, where we have replaced it by a constant reference value. It is conceivable that density variability becomes important at high Mach numbers, which is a regime that has not yet received much attention; but see Rogachevskii et al. (2018) for specific predictions.
ACKNOWLEDGMENTS
We acknowledge fruitful and inspiring discussions with Prof. Nishant Singh, Dr. Hongzhe Zhou, and Dr. Jonathan Squire and Prof. Amitava Bhattacharjee in the Max Planck Princeton Center for Plasma Physics framework. M.J.K. and M.R. acknowledge the support of the Academy of Finland ReSoLVE Centre of Excellence (grant number 307411). This project has received funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation program (Project UniSDyn, grant agreement n:o 818665). A.B. acknowledges support through the Swedish Research Council (Vetenskapsra°det), grant 2019-04234.
Software and Data Availability. The source code
used for the simulations of this study, the PENCIL CODE (Pencil Code Collaboration et al. 2021), is freely available on https://github.com/pencil-code/. The DOI of the code is https://doi.org/10.5281/zenodo.2315093 (Brandenburg 2018). The simulation setup and the corresponding data are freely available on http://www.nordita.org/brandenb/ projects/CompressibleTestfield/.

REFERENCES

Brandenburg, A. 2018, Pencil Code, v2018.12.16, Zenodo, doi: 10.5281/zenodo.2315093. https://doi.org/10.5281/zenodo.2315093
Brandenburg, A., & Chen, L. 2020, J. Plasma Phys., 86, 905860110, doi: 10.1017/S0022377820000082

Brandenburg, A., Ra¨dler, K. H., Rheinhardt, M., & Ka¨pyla¨, P. J. 2008a, ApJ, 676, 740, doi: 10.1086/527373
Brandenburg, A., Ra¨dler, K.-H., Rheinhardt, M., & Subramanian, K. 2008b, ApJL, 687, L49, doi: 10.1086/593146

COMPRESSIBLE TEST-FIELD METHOD AND SHEAR DYNAMOS

15

Table 5. Summary of the runs with varying shear rate and PrM = 20.

Run
kS005Pm20 nS005Pm20 qS005Pm20 kS01Pm20 nS01Pm20 qS01Pm20 kS02Pm20 nS02Pm20 nS02Pm20k3 qS02Pm20 kS03Pm20 nS03Pm20 qS03Pm20

-S ReM
0.05 34 0.05 34 0.05 33 0.1 33
0.1 33 0.1 32 0.2 33 0.2 33 0.2 33 0.2 33 0.3 33 0.3 35 0.3 34

ShK
-0.15 -0.15 -0.15 -0.30 -0.30 -0.31 -0.60 -0.60 -0.60 -0.61 -0.90 -0.84 -0.87

Lu
17.2 18.0 20.3 30.2 28.2 35.2
44 47 50 47 52.5 111.8 59.8

xx/
11.136±0.252 12.036±0.655 11.116±2.280 7.459±0.282 9.152±1.560 6.696±0.309 6.093±0.136 7.356±0.807 6.148±0.172 5.696±0.462 5.302±0.224 5.060±1.837 5.813±0.311

yy /
11.436±0.177 12.191±0.630 11.398±2.113 7.568±0.282 9.506±1.551 7.097±0.308 5.371±0.249 5.608±0.486 5.275±0.195 6.008±0.528 4.362±0.142 3.858±1.355 5.933±0.333

yx/
-0.038±0.076 0.133±0.061 0.135±0.089 0.011±0.093 0.203±0.121 0.041±0.011 0.040±0.012 0.000±0.042 -0.023±0.104 0.033±0.021 0.037±0.048 -0.062±0.065 0.055±0.022

xy /
0.930±0.142 1.297±0.241 1.013±0.677 0.754±0.189 1.236±0.878 -0.426±0.115 1.574±0.790 0.874±0.326 0.671±0.324 -1.017±0.533 -0.123±0.262 -2.903±2.858 -0.693±0.695

rms/tkf
0.041±0.021 0.043±0.013 0.046±0.020 0.040±0.012 0.040±0.019 0.050±0.013 0.046±0.013 0.041±0.020 0.042±0.021 0.045±0.011 0.060±0.025 0.070±0.030 0.039±0.009

rms/
0.316±0.316 0.547± 0.278 0.552±0.354 0.238±0.060 0.345±0.233 0.297±0.087 0.326±0.077 0.202±0.128 0.218±0.133 0.228±0.094 0.333±0.169 0.247±0.178 0.188±0.062

Note. Conventions as in Table 1.
Table 6. Dynamo numbers for the models with varying shear rate and PrM=20.

Run
kS005Pm20 nS005Pm20 qS005Pm20 kS01Pm20 nS01Pm20 qS01Pm20 kS03Pm20 nS03Pm20 qS03Pm20

-S kz,kin kz,sat kB [k1] [k1] [k1]
0.05 2 1 1 0.05 2 1 1 0.05 2 1 1 0.1 2 1 1 0.1 2 1 1 0.1 2 1 1 0.3 3 1 1 0.3 3 1 1 0.3 3 1 1

DS
0.03138 -0.0957 -0.1110 -0.0361 -0.4746 -0.1653 -0.3576 0.7078 -0.3848

DrmsS DS

0.2615 0.3979 0.4594 0.8215 0.8095 1.1906 3.2605 2.7607 1.3288

2.4082 2.0790 2.4033 5.7946 4.3888 6.2656 5.5275 4.4260 3.4519

Note. Conventions as in Table 2.

Brandenburg, A., & Sokoloff, D. 2002, Geophysical and Astrophysical Fluid Dynamics, 96, 319, doi: 10.1080/03091920290032974
Brandenburg, A., Tuominen, I., Nordlund, A., Pulkkinen, P., & Stein, R. F. 1990, A&A, 232, 277
Elperin, T., Kleeorin, N., & Rogachevskii, I. 2003, PhRvE, 68, 016311, doi: 10.1103/PhysRevE.68.016311
Hubbard, A., Del Sordo, F., Ka¨pyla¨, P. J., & Brandenburg, A. 2009, MNRAS, 398, 1891, doi: 10.1111/j.1365-2966.2009.15108.x
Ka¨pyla¨, M. J., Gent, F. A., Va¨isa¨la¨, M. S., & Sarson, G. R. 2018, A&A, 611, A15, doi: 10.1051/0004-6361/201731228
Ka¨pyla¨, M. J., Vizoso, J. A´ ., Rheinhardt, M., Brandenburg, A., & Singh, N. K. 2020, The Astrophysical Journal, 905, 179

Ka¨pyla¨, P. J., Korpi, M. J., & Brandenburg, A. 2010, MNRAS, 402, 1458, doi: 10.1111/j.1365-2966.2009.16004.x
Ka¨pyla¨, P. J., Mitra, D., & Brandenburg, A. 2009, PhRvE, 79, 016302, doi: 10.1103/PhysRevE.79.016302
Karak, B. B., Rheinhardt, M., Brandenburg, A., Ka¨pyla¨, P. J., & Ka¨pyla¨, M. J. 2014, ApJ, 795, 16, doi: 10.1088/0004-637X/795/1/16
Ossendrijver, M., Stix, M., & Brandenburg, A. 2001, A&A, 376, 713, doi: 10.1051/0004-6361:20011041
Pencil Code Collaboration, Brandenburg, A., Johansen, A., et al. 2021, The Journal of Open Source Software, 6, 2807, doi: 10.21105/joss.02807
Rheinhardt, M., & Brandenburg, A. 2010, A&A, 520, A28, doi: 10.1051/0004-6361/201014700
Rheinhardt, M., Devlen, E., Ra¨dler, K.-H., & Brandenburg, A. 2014, MNRAS, 441, 116, doi: 10.1093/mnras/stu438
Roberts, G. O. 1972, Philosophical Transactions of the Royal Society of London Series A, 271, 411, doi: 10.1098/rsta.1972.0015
Rogachevskii, I., & Kleeorin, N. 2003, PhRvE, 68, 036301, doi: 10.1103/PhysRevE.68.036301
--. 2004, PhRvE, 70, 046310, doi: 10.1103/PhysRevE.70.046310 Rogachevskii, I., Kleeorin, N., & Brandenburg, A. 2018, Journal of
Plasma Physics, 84, 735840502, doi: 10.1017/S0022377818000983 Schrinner, M., Ra¨dler, K.-H., Schmitt, D., Rheinhardt, M., & Christensen, U. 2005, Astron. Nachr., 326, 245, doi: 10.1002/asna.200410384 Schrinner, M., Ra¨dler, K.-H., Schmitt, D., Rheinhardt, M., & Christensen, U. R. 2007, Geophysical and Astrophysical Fluid Dynamics, 101, 81, doi: 10.1080/03091920701345707

16

KA¨ PYLA¨ , RHEINHARDT & BRANDENBURG

Shi, J.-M., Stone, J. M., & Huang, C. X. 2016, MNRAS, 456, 2273, doi: 10.1093/mnras/stv2815
Simard, C., Charbonneau, P., & Bouchat, A. 2013, ApJ, 768, 16, doi: 10.1088/0004-637X/768/1/16
Simard, C., Charbonneau, P., & Dube´, C. 2016, Advances in Space Research, 58, 1522, doi: 10.1016/j.asr.2016.03.041

Squire, J., & Bhattacharjee, A. 2015, ApJ, 813, 52, doi: 10.1088/0004-637X/813/1/52
--. 2016, J. Plasma Phys., 82, 535820201, doi: 10.1017/S0022377816000258
Va¨isa¨la¨, M. S., Pekkila¨, J., Ka¨pyla¨, M. J., et al. 2021, ApJ, 907, 83, doi: 10.3847/1538-4357/abceca
Zhou, H., & Blackman, E. G. 2021, arXiv e-prints, arXiv:2104.11112. https://arxiv.org/abs/2104.11112

