arXiv:2106.01814v2 [stat.ME] 7 Jun 2021

Explaining Recruitment to Extremism: A Bayesian Contaminated Case Control Approach
Roberto Cerina1, Christopher Barrie2, Neil Ketchley3, and Aaron Y. Zelin4
1Maastricht University 2University of Edinburgh
3University of Oslo 4Brandeis University
June 8, 2021
Abstract Who joins extremist movements? Answering this question poses considerable methodological challenges. Survey techniques are practically infeasible and selective samples provide no counterfactual. Assigning recruits to contextual units provides one solution, but is vulnerable to problems of ecological inference. In this article, we take inspiration from epidemiology and the protest literature and elaborate a technique to combine survey and ecological approaches. The rare events, multilevel Bayesian contaminated case-control design we propose accounts for individual-level and contextual factors, as well as spatial autocorrelation in the incidence of recruitment. We validate our approach by matching a sample of Islamic State (ISIS) fighters from nine Muslim-majority countries with representative population surveys enumerated shortly before recruits joined the movement. We find that high status individuals in their early twenties who had university education were more likely to join ISIS. We find more mixed evidence for relative deprivation.
Author contributions: NK and CB conceived of the study. RC developed the models. RC, CB, and NK contributed to the analysis. CB, NK and AZ contributed to the data collection. CB developed the literature review. RC, CB, NK, and AZ contributed to the writing. Hertog et al. [2021] reached out to us as we were finalizing our paper. Note that their analysis also uses leaked ISIS recruitment data to analyze the socio-economic correlates of joining the movement.

1 Introduction
Who joins extremist movements? To answer this question, one of two approaches are commonly preferred. A first approach employs survey techniques of varying sophistication; a second uses information on the origins of recruits to make ecological inferences using contextual information. Both approaches are beset by difficulties. Eliciting truthful responses about sensitive attitudes is notoriously difficult. This has necessitated innovations in survey design aimed at obtaining accurate responses to questions probing political extremism [Blair et al., 2013, Lyall et al., 2013]. However, these approaches only capture attitudes, not behaviour. An alternative strategy is to sample on the dependent variable by targeting groups themselves and obtaining relevant demographic information about members [Tezcu¨r, 2016]. Researchers can then assign members to meaningful contextual units and use unit-level characteristics to explain variation in the rate of recruitment. While this approach captures actual behaviour, it suffers from familiar problems of ecological inference.
The method we propose allows researchers to leverage both survey and contextual data to make robust inferences about the correlates of recruitment. The technique overcomes a considerable number of challenges that researchers face when studying rare and extreme forms of political behaviour. By first combining individual cases (recruits) with controls (survey respondents), we build on existing approaches in the literature on protest participation [Rosenfeld, 2017]. Several problems remain, however. Popular approaches for modelling rare events [e.g., King and Zeng 2001] cannot account for spatial autocorrelation or contamination in a case-control design. Further, conventional rare events approaches face potential separation problems in the absence of regularized priors for coefficients of interest. Finally, while existing approaches incorporate informative priors on the true prevalence of the outcome of interest (here: recruitment), this information is often not known.
1

Our approach can be described as a multilevel, rare-event Bayesian contaminated case-control study that accounts for spatial autocorrelation [Rota et al., 2013]. The Bayesian approach is preferable for a number of reasons. First, Bayesian probabilistic programming software provides unique flexibility in the modeling of the complex hierarchical structures characterizing recruitment into extremism. Second, it permits the use of informative priors to account for the true prevalence of the event of recruitment, as well as to regularize coefficient estimates to account for separation bias and instability [Heinze and Schemper, 2002]. Finally, in the absence of prior knowledge of the overall propensity of being a recruit in a given context, the model can estimate the propensity from the data [Rota et al., 2013].
To validate our approach, we analyze recruitment by Sunni Muslim males in nine Muslim-majority countries to the Islamic State in Iraq and Syria (ISIS). We focus our analysis on education and social status -- two key variables associated with recruitment to extremism according to the literature. We show how our approach can be used to perform two types of analyses. In the first, we leverage a multilevel regression model trained on a sample of ISIS recruits and non-recruits. This provides a robust descriptive analysis about the individual-level characteristics of recruits across countries and sub-national administrative units. A second analysis focuses on two countries for which we have rich contextual information: Egypt and Tunisia. This analysis adds value by adjusting for local heterogeneity with the addition of relevant ecological covariates, allowing us to ascertain the potential sensitivity of individual-level findings to unobserved contextual confounding.
Overall, we find that high-status, college educated males in the early twenties were more likely to join ISIS. We also find that relatively deprived males in Egypt were more likely to join ISIS, but not in Tunisia. This heterogeneity in the individual and contextual correlates of violent extremism demonstrates the importance of accounting
2

for country-specific factors. More generally, the models are easily applicable to other forms of political extremism where both general population surveys and data on recruits is available. Examples include participants in the 2021 Capitol Riots in Washington D.C. [Pape, 2021], membership in violent left-wing movements, and far-right militias.
2 Explaining Recruitment to Extremism
The challenges when studying the demographic profile of recruits to extremism are many. First, eliciting truthful responses about participation in extremist organizations is difficult. This has necessitated innovations in survey design aimed at obtaining accurate responses to sensitive questions around support for extremist organizations or extreme forms of political behaviour [Blair et al., 2013, Corstange, 2009]. Others have elaborated ways of determining attitudes using online digital traces [Bail et al., 2018, Mitts, 2019]. But even if we can rely on the accuracy of attitudinal measures, there remains an obvious gap between attitudes and acting on those beliefs. What is more, actual recruits, as opposed to sympathizers, are tiny minorities in their own countries and are therefore minorities in general population surveys. In consequence, even techniques designed to elicit truthful responses about participation in extremism would likely only result in a very small sample of actual participants.
The second strategy available to researchers is to select on the dependent variable, targeting rebel groups or extremists, and obtaining relevant demographic information about these individuals [Tezcu¨r, 2016]. In the ideal scenario, researchers are able to obtain movement membership lists [Biggs and Knauss, 2012], although in practice such complete data is vanishingly rare. Absent this information, a common strategy is to leverage data from arrests or killings to generate samples of participants [Kawalerowicz and Biggs, 2015, Ketchley and Biggs, 2017]. Of course, neither approach provides infor-
3

mation on individuals outside the subpopulation of interest, meaning it is not possible to compare recruits to non-recruits in the population from which they are drawn. To remedy this, researchers often assign recruits to meaningful contexts, e.g. universities, cities, or districts, and then use the characteristics of those units to explain crosssectional variation in the recruitment rate [Kawalerowicz and Biggs, 2015, Ketchley and Biggs, 2017]. While undoubtedly superior to simply analyzing sample proportions, such approaches inevitably rely on ecological inference.
We face similar problems when studying protestor crowds. Protestors, while more accessible, also constitute a relatively hard to reach population, especially in authoritarian contexts where response bias also poses design questions [Beissinger et al., 2015, Opp and Gern, 1993]. Here, as with much research into political extremism, survey research tends to sample on the dependent variable to arrive at representative samples of crowds or movements [Fisher et al., 2019, McAdam and Paulsen, 1993]. Rosenfeld [2017] advances the only solution to date for providing an individual-level counterfactual, recommending a variation on the case-control design popular in epidemiology. It is on this technique that we build in this article, as we describe below.
3 A rare-event Bayesian contaminated case-control
design
In what follows, we suggest two methods for analyzing recruitment to extremism. The first leverages a cross-national, multilevel regression model trained on a complete sample of recruits and unlabeled records. This provides a robust descriptive analysis about the individual-level factors which characterize recruits across countries and subnational units. The model uses random effects to control for unobservable subnational heterogeneity; these are preferable to fixed effects due to potentially heavily imbalanced
4

area-level sample sizes [Gelman and Hill, 2006, Clark et al., 2015]. The model further uses a conditionally auto-regressive prior [Besag et al., 1991, Morris et al., 2019] to account for spatial smoothing. The second analysis focuses on single country studies where rich contextual information is available. The added value of this analysis lies in controlling for local heterogeneity in order to ascertain the robustness of findings to contextual confounding. Our proposed setup thus plots a way forward for researchers to combine survey and ecological information for the robust analysis of rare forms of high-risk, political participation.

3.1 Simple Case-Control Set-up

We begin by describing the backbone of our model, which is a logistic regression ac-

counting for case-control sampling protocol via an offset. Borrowing from Rota et al.

[Rota et al., 2013], we define ri = {0, 1} as the set of states that observation i in our

sample of size n = n0 + n1 can obtain, where ri = 1 implies the observation is a `case',

ri = 0 defines a control, n1 =

n i

1(ri

=

1)

and

n0

=

n i

1(ri

=

0).

In

our

application,

a `case' refers to a known recruit; a `control' refers to a survey respondent. Recall

that cases are selected entirely on the dependent variable while controls come from the

larger population. Take N1 to represent the number of cases in the whole population

of interest, and N0 the number of controls. The probability of being included in the

sample (si = 1) conditional on the true state of any individual can hence be under-

stood

as

P1

=

Pr(si

=

1

|

ri

=

1)

=

, n1
N1

while

that

of

being

sampled

as

a

control

is P0 = Pr(si = 1 | ri = 0) =

. n0
N0

The log-ratio of these sampling probabilities can

then be used as an `offset' in a logistic regression, to account for the sampling protocol.

The hierarchical specification of the model follows, with regression coefficients being

5

assigned a very weakly informative prior;1

ri  Bernoulli(i);

(1)

logit(i) = log

P1 P0

+ xi,kk;
k

(2)

k  N (0, 10).

(3)

The above hierarchical model thus contains three layers: layer (1) is a model of the true state of an observation, conditional on their latent propensity ; layer (2) describes this latent propensity, by accounting for systematic variation due to heterogeneity in covariates; layer (3) models the effects of each covariate by assigning a prior probabilistic model.

3.2 Contaminated Controls
Recall that that the case-control setup as described above takes known recruits and combines with `controls' taken from survey respondents. While we know that our cases are correctly labeled, we do not know whether this is true of our controls. That is, our controls may be `contaminated' as survey respondents may have become recruits [Lancaster and Imbens, 1996]. Rota et al. [2013] outline a `latent variable' formulation of their contamination model. Below we present our version of that same model as a mixture, which we find more intuitive.
The `label' of an observation, yi = {0, 1}, is observed for all observations, while the true `state' of an observation, ri = {0, 1}, is only observed for cases. The implied probability distribution of labels conditional on being a control is:
Pr(yi = 1 | ri = 0, si = 1) = 0 = 0;
1See https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations for priorchoice advice on STAN. Note further that the Normal distribution in the model (and in STAN) is parametrized by mean and standard deviation.
6

Pr(yi = 0 | ri = 0, si = 1) = 1 = (1 - 0);

Due to contamination, it is possible that observations characterized by yi = 0 are

actually in state ri = 1; hence we need a probability distribution for y | ri = 1.

Let



=

N1 N1+N0

be

the

prevalence

of

recruits

in

the

population

of

interest,

and

let

nu =

n i

1(yi

=

0)

be

the

number

of

unlabeled

observations.

We expect there to be

nu cases amongst the unlabeled observations. We can then characterize the probability

distribution of labels, conditional on being a case, as:

Pr(y

=

1

|

r

=

1, s

=

1)

=

n1

n1 + nu

=

1;

Pr(y

=

0

|

r

=

1, s

=

1)

=

nu n1 + nu

=

(1

-

1).

Finally, our model for the latent state ri must reflect the possibility of contamination.

We do this by re-defining the relative-risk of being sampled as:

P1 =

n1+nu N1

= n1 + 1.

P0

n0+(1-)nu N0

nu

The updated, hierarchical specification for the case-control model accounting for

contaminated controls is then:

yi  Bernoulli(ri);

(4)

ri  Bernoulli(i);

(5)

logit(i) = log

n1 + 1 nu

+ xi,kk;
k

(6)

k  N (0, 10).

(7)

In summary, we derive our labels via two distinct data generating processes, identified by a latent state ri = {1, 0}. In the event that the latent state of a given record is that of a true control, ri = 0, it is then impossible for this record to be labeled yi = 1;

7

conversely, if the latent state is that of a true case, ri = 1, then it is still possible for a record to be labeled yi = 0, with probability (1 - 1). This latter model describes the issue of contamination.
3.3 Area-level Random Effects
Both survey and membership data often contain information on the origin or location of residence of individuals. And we can understand individuals as nested within geographical units of increasing sizes. Generalizing, we can exploit variance at three levels: the individual, some small-area, and some large-area.
These area effects could be in principle incorporated in the model via fixed-effects, by expanding the design matrix to include relevant dummy-variables for each area of interest. We consider this strategy unwise in the case of rare forms of political behaviour such as recruitment to extremism and prefer a random-effects approach. In the case of rare forms of political behaviour, our geographical units at all levels of analysis will have relatively few observations [Gelman and Hill, 2006]. Additionally, for many units, we will have no cases. Finally, we know that lists of recruits are unlikely to be exhaustive; that is, we will not have data for every recruit hailing from every region or country. Here, a sample of recruitment data or similar can be treated as a nonprobability sample -- it is unlikely that we can have complete confidence the sample constitutes a complete or random sample of the population of interest. Given these concerns, a random effects approach is preferable as it means: 1) we are able to borrow strength across areas, which also increases efficiency, to produce more realistic estimates for the area-level coefficients [Clark et al., 2015, Baio, 2012]; 2) in the absence of more detailed knowledge about the data-generating process, the shrinkage effect obtained by partial pooling is more likely to shield our estimates from any systematic sampling bias among our cases [Gelman and Hill, 2006].
8

We can also relax some of the theoretical bias associated with the shrinkage induced by random effects via incorporating observable area-level heterogeneity in the designmatrix as fixed effects [Gelman and Hill, 2006]. This is what we elect to do in single country analyses. Finally, it is worth highlighting that our goal is not to make inferences about area-level effects. Instead, their inclusion is designed to strip our individual-level effects estimates of any variance that may be associated with the provenance of the recruit. The resulting hierarchical model is as follows:

yi  Bernoulli(ri);

(8)

ri  Bernoulli(i);

(9)

logit(i) = log

n1 + 1 nu

+ xi,kk + l[i] + j[i];
k

(10)

k  N (0, 10);

(11)

l  N (0, );

(12)

1

 =

, 

  Gamma(

,

);

(13)

j  N (0, );

(14)

1



=

, 

  Gamma(

,

);

(15)

where stands for some arbitrary number, chosen as a compromise to minimize the

prior information and maximise the Markov chain Monte Carlo (MCMC) convergence

speed and stability.

3.4 Spatial Autocorrelation
The network ties connecting actors across space play an important role in recruitment to high-risk activism and extremism [Centola and Macy, 2007, McAdam and Paulsen, 1993]. Sometimes the ties connecting recruits will be available; more commonly this

9

information will be unrecoverable.2 In the absence of detailed network information, we propose controlling for potential
network effects at levels of varying scale. We work on the assumption that network ties are more likely to form between individuals who are geographically proximate. Depending on the richness of the data on recruits, we may generate distance matrices between geographical units of varying size.
To account for area-level spatial autocorrelation, we propose incorporating a version of the conditional auto-regressive (CAR) model [Besag et al., 1991]. This approach has been used in individual-level models of behaviour, enabling local smoothing of predictions according to behaviour observed in neighbouring areas [Selb and Munzert, 2011]. The key ingredients of a CAR model are , a distance-weight matrix; , a parameter governing the degree of autocorrelation, where  = 0 implies spatial independence, and  = 1 implies an intrinsic conditional auto-regressive (ICAR) model [Besag and Kooperberg, 1995]; and , the standard deviation of the subnational unit effects. The resulting model for spatial random effect l  l = {1, ..., L} is then:

l | l  N  ll l ,  .
l =l
In practice, we implement the ICAR specification of the model, with  = 1, and take  to be the neighbourhood matrix. The neighbourhood matrix has diagonals zero (a unit cannot neighbour itself) and off-diagonal zero or one depending on whether the given units are neighbours. We choose this specification of the distance matrix because of the efficiency gains it affords in a Bayesian context [Morris et al., 2019]. This leads to:

l | l  N

l =l l , 

,

dl,l

dl,l

2But see Rosenblatt [2020] for a comparative analysis of network ties connecting ISIS recruits in Europe and the Arab Peninsula.

10

where dl,l is an entry of the diagonal matrix D of size L × L, whose diagonal is defined as a vector of the number of neighbours of each area. The joint distribution of this

model

is

simply

a

multivariate

normal

distribution





N (0, [(D

-

W )]-1),



=

,1
2

which is conveniently proportional to the squared pairwise difference of neighbouring

effects. Note that the sum-to-zero constraint is needed for identifiability purposes,

as in its absence any constant added to the s would cancel out in the difference.3

Following Morris et al. [2019], setting the precision to 1 and centering the model such

that

L l

l

=

0,

we

arrive

at:

1 log p()  exp -
2

(l - l )2 ;

l =l

The hierarchical model we implement to incorporate the spatial component is within

the Besag-York-Molli´e (BYM) family [Besag et al., 1991]. For a given level of analysis,

say the governorate or province in a cross-country analysis, BYM models are charac-

terized by two random effects which explain unobserved heterogeneity: l defines a

non-spatial component while l defines systematic variance due to spatial dependency. The typical challenge with BYM is that the two areal effects cannot be identified without

imposing some structure since they are mutually dependent, meaning either component

is capable of accounting for the full residual variance. This leads to inefficient posterior

exploration of the MCMC sample, and subsequent lack of convergence [Riebler et al.,

2016]. To overcome this, we implement a state-of-the-art solution leveraging penalized-

complexity priors [Simpson et al., 2017], which proposes modelling the two effects as a

scaled mixture such that:
3Generally, this model has the disadvantage of being an improper-prior, as its density does not integrate to unity and is non-generative (i.e., it can only be used as a prior and not as a likelihood) though it serves our purposes within the context of a hierarchical model. Finally, we should note that this prior encodes an intrinsic dependence between subnational units. It can no longer detect the degree of spatial autocorrelation supported by the data but instead assumes that areas are explicitly dependent, and estimates coefficients accordingly.

11

l =  l (1 - ) + l (/s) ;

where  and  are random effects scaled to have unitary variance and   [0, 1] is a

mixing parameter, defining the proportion of residual variation attributable to spatial

dependency. In order for the spatial and unstructured effects to share , they must

be on the same scale. We must therefore scale the ICAR-distributed effects, as their

original scale is defined by the local neighbourhood. A proposed scaling factor is chosen

such that the geometric mean of the variance parameters over the areal units is 1,

Var(l) = 1. Note that this scaling factor, s in the equation above, can be calculated directly from the adjacency matrix, and hence it is not to be estimated but passed to

the model as data.

The resulting hierarchical specification of our model follows:

yi  Bernoulli(ri);

(16)

ri  Bernoulli(i);

(17)

logit(i) = log

n1 + 1 nu

+ xi,kk + l[i] + j[i];
k

(18)

k  N (0, 10);

(19)

l =  l (1 - ) + l (/s) ;

(20)

  Beta(0.5, 0.5);

(21)

l  N (0, 1);

(22)

l | l  N

l =l l , 1

dl,l

dl,l

(23)

1

  N (0, 1);

(24)

2

j  N (0, );

(25)

1



=

, 

  Gamma(

,

);

(26)

where

1 2

N

denotes

a

half-normal

distribution,

which

is

the

recommended

prior

for

the

12

variance of BYM effects [Morris et al., 2019].

3.5 Regularizing Prior Coefficients
Multiple contributions have highlighted problems with logistic regression coefficient estimates under rare-events [King and Zeng, 2001]. The intuition behind these challenges is typically described as some variation on the standard separation problem where any given covariate or simple combination thereof perfectly separates cases from controls. This leads to biased and unstable point-estimates with large associated uncertainty [Heinze, 2017]. A number of regularization techniques have been proposed to reduce bias and stabilize the coefficient estimates. Our preferred regularization method is that proposed by Gelman et al. [2008] and Ghosh et al. [2018]. The approach assumes it should be unlikely to observe unit-changes in the (standardized) covariates that would lead to outcome changes as large as 5 points on the logit scale. This information is encoded using a Cauchy prior with scale-parameter set to 2.5 for the regression coefficients, and a `looser' scale of 10 logit points on the intercept to accomodate for the rarity of the event in the sample. The advantages of the Cauchy prior lie in its fat tails, which avoid over-shrinkage of large coefficients [Ghosh et al., 2018]. We apply this prior to our fixed effects exclusively, as the likelihood of our random effects is already structured and penalized. Our final model specification is then as follows:

yi  Bernoulli(ri);

(27)

ri  Bernoulli(i);

(28)

logit(i) = log

n1 + 1 nu

+ xi,kk + l[i] + j[i];
k

(29)

1  Cauchy(0, 10);

(30)

k | k > 1  Cauchy(0, 2.5);

(31)

13

l =  l (1 - ) + l (/s) ;

(32)

  Beta(0.5, 0.5);

(33)

l  N (0, 1);

(34)

l | l  N

l =l l , 1

dl,l

dl,l

(35)

1

  N (0, 1);

(36)

2

j  N (0, );

(37)

1



=

, 

  Gamma(

,

);

(38)

3.6 Bayesian Modeling in STAN

The model outlined above is amenable to Bayesian estimation via Monte Carlo Markov Chain (MCMC) methods. Previous contributions [e.g., Rota et al. 2013, Rosenfeld 2017] have used WinBUGS [Lunn et al., 2000] or JAGS [Plummer et al., 2003] as software to implement some variations on a simple Gibbs sampler. Due to the heavy computational burden imposed by the spatial prior, we propose instead to innovate by estimating this model in STAN [Carpenter et al., 2017]. STAN leverages a version of Hamiltonian MonteCarlo (HMC) called the `No U-Turn Sampler' (NUTS) [Hoffman and Gelman, 2014], which dramatically improves the efficiency and speed of convergence of our MarkovChains. A challenge we face is that STAN cannot handle the sampling of latent discrete parameters (ri in our hierarchical model above), posing a problem for the estimation of mixture models. The state-of-the-art solution is to marginalize the latent parameter out. In practice this means replacing our model for the observed labels y with the following mixture of Bernoulli distributions:

f (yi | i) = i Bernoulli(yi | 1) + (1 - i) Bernoulli(yi | 0).

(39)

14

Beyond allowing for model parameters to be informed by yi according to the mixed structure above, marginalization provides significant advantages for posterior exploration and MCMC efficiency as it leverages expectations rather than sampling of discrete parameters.4 Listing 1 presents the STAN code for our final model. As a final STAN-related note, we note that fixed-effects covariates are standardized. We standardize both dichotomous and continuous variables as this aids convergence.5 In what follows, we illustrate our empirical model, examining the individual and contextual-level correlates of recruitment to the Islamic State.
4 Correlates of extremism
Determining the demographic profile of recruits to violent extremism is a central concern in studies of terrorism [Gambetta and Hertog, 2016]. Among the most commonly studied characteristics is education [Krueger and Maleckova, 2003, Krueger, 2017, Østby et al., 2019, Mesquita, 2005]. In their review of the literature, Østby et al. [2019] summarize three mechanisms linking education to a reduction in political violence. First, the availability of educational infrastructure might lead to a reduction in the societal grievances and consequent decline in support for rebel groups. Second, the opportunity cost of war is higher when education levels are high in a given society. Third, education helps spread norms of tolerance and civic engagement, lowering support for forms of political extremism.
An alternative body of literature argues that educational expansion may increase recruitment to violent extremism as a result of relative deprivation [Davies, 1962, Gurr, 1970]. This argument has been especially popular among scholars studying politi-
4https://mc-stan.org/docs/2_25/stan-users-guide/rao-blackwell-section.html 5https://mc-stan.org/docs/2_25/stan-users-guide/standardizing-predictors-and-outputs. html
15

cal instability in the Middle East and North Africa (MENA) where it is argued that mass educational expansion created a pool of educated unemployed who were prone to both rebellion and violent extremism [Campante and Chor, 2012, Lia, 2005, Malik and Awadallah, 2013].6 A parallel literature focuses on the educational contexts of Islamist and jihadist groups. The key finding in this literature is that recruits to violent jihadist groups are drawn disproportionately from the more highly educated and, in particular, the medical sciences and engineering [Gambetta and Hertog, 2016, Ketchley and Biggs, 2017]. Relative deprivation is again cited here as an explanatory factor. MENA countries have expanded medicine and engineering training out of step with the expansion of the labor market, creating a "lumpen intelligentsia" vulnerable to recruitment [Roy, 1994].
A final body of work focuses on recruitment to transnational rebel groups and, in particular the Islamic State. These contributions tend to operate at the country level, and find associations between human development indices or horizational inequalities in educational attainment and the flow of domestic fighters to ISIS [Verwimp, 2016, Benmelech and Klor, 2018, Gouda and Marktanner, 2019]. Using a similar sample of leaked border documents to those we exploit below, Devarajan et al. [2016] find that recruits tend to be highly educated but fail to make full use of the individual-level information contained in the documents by basing their main statistical analyses on a discretized country-level outcome variable. Other research does examine the locallevel determinants of ISIS recruitment, comparing the demographic characteristics of fighters with local-level averages for the general population. These studies conclude that fighters tend to hail from marginalized regions with prehistories of violence but that there remains significant cross-regional variation in the individual and contextual
6Here, it is worth noting, argument is somewhat distinct from the above: as Østby et al. [2019] note this is not about the "static stock" of education but the flow of educational expansion and consequent inequalities in opportunity.
16

correlates of recruitment [Rosenblatt, 2018, Sterman and Rosenblatt, 2018]. In summary, there are competing predictions for the association between education
and recruitment to violent extremism. Relative deprivation is commonly advanced to explain recruitment patterns but existing research points to inconsistent patterns. This inconsistency is most stark when examining recruitment patterns cross-nationally. The literature on recruitment to violent extremist movements also points to important subnational factors conditioning recruitment. Taken together, the literature would benefit from a method of combining information at the individual and ecological levels better to appraise patterns of recruitment.
5 Data
Our key data source to study ISIS is a set of leaked border documents. This leak was widely covered in the news media and have been used, in research to date, to provide descriptive statistics on the geographical distribution, and demographic characteristics, of ISIS fighters from multiple countries in the MENA [Devarajan et al., 2016, Zelin, 2018, Sterman and Rosenblatt, 2018].7 Whenever an individual entered Islamic State territory from Turkey to Syria, there was the equivalent of a border control called al-Idarah al-`Amah Li-l-Hudud (The General Administration for the Borders). The leaked documents deriving from these border controls contain detailed information on the home residence of each fighter. They also include information on age, highest education level achieved, marital status, previous employment, employment status, previous combat experience, and date of entry into ISIS-controlled territory. Appendix Figure A.1 provides an imitation of one of the border documents. We use data for nine
7The provenance and authenticity of these data is, of course, a concern. Scrutiny of these documents, however, has demonstrated that around 98% could be corroborated against personnel records for ISIS recruits held by the U.S. Department of Defense [Dodwell et al., 2016].
17

countries in the MENA that were included in the leak. These are: Algeria, Egypt,
Jordan, Kuwait, Lebanon, Libya, Morocco, Tunisia, and Yemen. In total, we have
complete records of 1,051 recruits.
For the case-control design, we combine individual-level ISIS recruitment data with
a nationally representative sample of individuals from Wave III of the Arab Barometer
survey ArabBarometer [2014]. The fieldwork for these surveys was completed before
most recruits entered ISIS-held territory (in 2014), and so may be vulnerable to contamination.8 Our choice of covariates to use from this survey is naturally constrained
by the information included in the border documents. We elect to include covariates
for age (integers, [18-86]), marital status (1/0), college educated (1/0), student sta-
tus (1/0), unemployed (1/0), and employment in agriculture or manual labor (1/0).
Finally, we combine our variables for unemployed and employment in agricultural or
manual labor to create a composite variable designed to capture "low status" activity.
An interaction between this variable and our college education variable is designed to
capture relative deprivation; that is, whether highly educated individuals engaged in
low status economic activity are more likely to become recruits.
As per our models above, we present a "bird's eye" and "worm's eye" view of ISIS
recruits. The first approach uses just individual-level information for recruits across our
nine countries. Here, we leverage a multilevel regression model trained on the complete sample of 1, 051 recruits and 5, 093 unlabeled records.9 The second incorporates contex-
tual information for Egypt (n1 = 63, n0 = 520 complete records) and Tunisia (n1 = 468,
8The surveys were in the field at different times for each country: December, 2012­January, 2013 for Jordan; February, 2013 for Tunisia; March­April, 2013 for Egypt and Algeria; April­June, 2013 in Morocco; July 2013 in Lebanon; November­December 2013 in Yemen; and February­March 2014 in Kuwait [ArabBarometer, 2014].
9We lose 248 cases 225 unlabeled records due to incompleteness. We considered incorporating a multiple imputation model in our Bayesian analysis, but decided against it: a) in the interest of clarity, as a number of layers of complexity are already present; b) in the interest of estimation stability, as incorporating further uncertainty could destabilize the rare-event estimates of coefficients; c) we have no a-priori reason to believe missingness is correlated with the outcome, and hence we do not expect that record exclusion will bias the estimates.
18

n0 = 412 complete records) at the district level. We focus on these two countries due to the availability of contextual information at the district level that is not easily accessible for the other countries in our sample. Again, the added value of this analysis lies in controlling for observable district-level heterogeneity in order to ascertain the robustness of findings to contextual confounding. As such, for each country we include variables to capture subnational variation in demographic and labor-market composition, employment opportunities, as well as more context-specific variables designed to capture support for Islamist political organizations and prehistories of activist mobilization. For Egypt, we include variables measuring population density, total population, % Christian, % college-educated, % employed in agriculture, % voted for the ousted Islamist President Mohamed Morsi, the number of individuals killed at the August 2013 Rabaa Massacre (square-rooted), % unemployed, and number of protests in the twelve months after the January 25 Revolution in 2011 (square-rooted). For Tunisia, we include variables measuring population, population density, % employed in agriculture, % college-educated, unemployment rate, graduate unemployment rate, number of protest events in the year aftermath of the January 14 Revolution in Tunisia (square-rooted), % vote for Ennahdha in the elections of 2011 and 2014, as well as the distance to the Libyan border (square-rooted). We describe the sources and details of the operationalization of each of these variables in the Appendix. Our choice of contextual variables is based on existing research finding that lack of employment opportunities, prehistories of mobilization and repression, as well as support for political Islam are predictive of ISIS recruitment [Devarajan et al., 2016, Rosenblatt, 2018, Grewal et al., 2020, Barrie and Ketchley, 2018]. The inclusion of these variables provides insight into the potential magnitude and origin of contextual confounding when analyzing rare forms of political behaviour.
19

6 Results
In this section we present the results of our two analytic approaches: the `bird's eye' view, referring to our cross-country analysis, and the `worm's eye' view, referring to our two country-specific analyses. For each, we present: i) convergence diagnostics; ii) the posterior density of fixed and random effects according to our models; 3) posterior predictive checks to generate information about likely "contaminated controls."
6.1 MCMC Convergence
Convergence diagnostics provide a first measure of the reliability of our parameter estimates for both the Bird's Eye and Worm's Eye models. Figure E.1 presents the Gelman-Rubin statistic for the Bird's Eye model; Figure E.2 for the Worm's Eye models. We can be confident our parameter estimates are samples of the joint posterior, as the R^ for every parameter is below 1.1. The likelihood of the model, lp , is also below the 1.1 threshold, indicating global convergence has been achieved. For our Worm's Eye models, we also see global convergence, as all parameters are below the 1.1 threshold, and the likelihood of the model appears to have converged. Trace plots for all models show good mixing for all parameters of interest (see Figures E.3:E.5).
6.2 Fixed and Random Effects
Figure 1 presents the posterior density of the fixed effects in the Bird's Eye model; Figures 2a and 2b present the Worm's Eye equivalent. These plots contain the main results of our models. Note that all the covariates, including dummies, are centered and scaled, hence the coefficients are to be interpreted in terms of standard deviations from the mean of each covariate. Since we are principally interested in the robust estimation of individual-level predictors, we display only the posterior density of individual fixed
20

0.6

Intercept
E[beta_1] = -10.799 sd(beta_1) = 0.739 Pr(beta_1<0) = 1

4

6

College edu.
E[beta_2] = 0.073 sd(beta_2) = 0.055 Pr(beta_2>0) = 0.904 mean(X) = 0.2 sd(X) = 0.4

0.4

0.6

Age
E[beta_3] = 1.604 sd(beta_3) = 0.675 Pr(beta_3>0) = 0.994 mean(X) = 36.16 sd(X) = 14.2

0.4

Density

Density

Density

0.2

0.2

2

0.0

0

0.0

-15

-10

-5

0

logit probability of recruitment

Age^2

E[beta_4] = -4.654 sd(beta_4) = 0.908 Pr(beta_4<0) = 1 mean(X) = 1509.29 sd(X) = 1222.91

-3

-2

-1

0

1

2

3

logit probability of recruitment

Married
E[beta_5] = -0.08 sd(beta_5) = 0.067 Pr(beta_5<0) = 0.89 mean(X) = 0.55 sd(X) = 0.5

-2

0

2

4

6

logit probability of recruitment

Student

E[beta_6] = -0.305 sd(beta_6) = 0.052 Pr(beta_6<0) = 1 mean(X) = 0.11 sd(X) = 0.31

Density 02468

Density 0123456

Density 0.0 0.1 0.2 0.3 0.4

-10 -8

-6

-4

-2

0

2

logit probability of recruitment

Low status
E[beta_7] = -0.605 sd(beta_7) = 0.057 Pr(beta_7<0) = 1 mean(X) = 0.23 sd(X) = 0.42

-3

-2

-1

0

1

2

3

logit probability of recruitment

College edu.*Low status
E[beta_8] = 0.038 sd(beta_8) = 0.046 Pr(beta_8>0) = 0.778 mean(X) = 0.02 sd(X) = 0.16

-3

-2

-1

0

1

2

3

logit probability of recruitment

Density 02468

Density 0123456

-4

-3

-2

-1

0

1

2

3

logit probability of recruitment

-3

-2

-1

0

1

2

3

logit probability of recruitment

Figure 1: Posterior density of fixed-effect coefficients for the Bird's Eye model.

effects for all of our models.10 To aid with interpretation, the mean and standard

deviation of each covariate are reported in the legend of each plot.

The estimated intercepts for the three models are extremely low. For the Bird's Eye

model, they are in the order of 11 negative logit-scale points. For the Egypt Worm's Eye

model, it is 15.5 negative logit points; in Tunisia it is 9 negative logit points. The size

of the intercept is primarily driven by the size of the offset, which is in turn determined

by the overall prevalence of recruitment. It is therefore not surprising that Egypt's

intercept is so dramatically low, given the close-to-zero prevalence of recruitment when

compared

to

population

size

(

=

4 100,000

)

versus

Tunisia

where

this

prevalence

is

higher

( =

2 1,000

).

For the Bird's Eye model, a different offset is provided for observations

coming from different countries, to account for country-specific prevalence. The large

and negative intercept underscores an important challenge in the explanation of why
10Figures F.1 and F.2 display the district-level posterior densities.

21

Density

0.10

Density 0.0 0.4 0.8 1.2

Density 0.0 0.1 0.2 0.3 0.4

Intercept

E[beta_1] = -14.211 sd(beta_1) = 1.136 Pr(beta_1<0) = 1

College edu.
E[beta_2] = 0.607 sd(beta_2) = 0.297 Pr(beta_2>0) = 0.98 mean(X) = 0.28 sd(X) = 0.45

0.20

E[beta_3] = 0.083 sd(beta_3) = 2.08 Pr(beta_3>0) = 0.44 mean(X) = 38.32 sd(X) = 13.83

Age

0.00

-20

-15

-10

-5

0

logit probability of recruitment

Age^2

E[beta_4] = -2.2 sd(beta_4) = 2.559 Pr(beta_4<0) = 0.858 mean(X) = 1659.68 sd(X) = 1197.19

0.8

-2

0

2

4

logit probability of recruitment

Married
E[beta_5] = 0.061 sd(beta_5) = 0.376 Pr(beta_5>0) = 0.574 mean(X) = 0.72 sd(X) = 0.45

-5

0

5

10

logit probability of recruitment

Student
E[beta_6] = 0.158 sd(beta_6) = 0.252 Pr(beta_6>0) = 0.744 mean(X) = 0.04 sd(X) = 0.19

Density 0.0 0.5 1.0 1.5

0.20

Density

0.10

Density

0.4

0.0

0.00

-15

-10

-5

0

5

logit probability of recruitment

Low status
E[beta_7] = -1.093 sd(beta_7) = 0.505 Pr(beta_7<0) = 0.994 mean(X) = 0.26 sd(X) = 0.44

1.0

1.5

-4

-2

0

2

4

logit probability of recruitment

College edu.*Low status
E[beta_8] = 0.62 sd(beta_8) = 0.285 Pr(beta_8>0) = 0.976 mean(X) = 0.03 sd(X) = 0.17

-2

0

2

4

logit probability of recruitment

Density

0.5

Density 0.0 0.2 0.4 0.6

0.0

-4

-2

0

2

logit probability of recruitment

Intercept

E[beta_1] = -9.252 sd(beta_1) = 0.675 Pr(beta_1<0) = 1

-2

0

2

4

logit probability of recruitment

(a) Egypt

College edu.
E[beta_2] = 0.447 sd(beta_2) = 0.15 Pr(beta_2>0) = 1 mean(X) = 0.2 sd(X) = 0.4

E[beta_3] = 5.149 sd(beta_3) = 2.574 Pr(beta_3>0) = 0.992 mean(X) = 36.45 sd(X) = 15.88

Age

Density 0.00 0.04 0.08 0.12

Density 0.0 0.5 1.0 1.5 2.0 2.5

0.4

Density

0.2

0.0

-15

-10

-5

0

logit probability of recruitment

Age^2

E[beta_4] = -12.195 sd(beta_4) = 3.715 Pr(beta_4<0) = 1 mean(X) = 1580.59 sd(X) = 1448.96

-3

-2

-1

0

1

2

3

4

logit probability of recruitment

Married

E[beta_5] = -0.126 sd(beta_5) = 0.173 Pr(beta_5<0) = 0.766 mean(X) = 0.48 sd(X) = 0.5

2.0

3.0

0

5

10

15

logit probability of recruitment

Student

E[beta_6] = -0.537 sd(beta_6) = 0.141 Pr(beta_6<0) = 1 mean(X) = 0.1 sd(X) = 0.3

Density

Density 0.0 0.5 1.0 1.5 2.0

0.08

Density

0.04

1.0

0.0

0.00

-25 -20 -15 -10

-5

0

logit probability of recruitment

Low status

E[beta_7] = -0.731 sd(beta_7) = 0.162 Pr(beta_7<0) = 1 mean(X) = 0.34 sd(X) = 0.47

2.0

3.0

-3

-2

-1

0

1

2

3

logit probability of recruitment

College edu.*Low status
E[beta_8] = -0.329 sd(beta_8) = 0.137 Pr(beta_8<0) = 0.992 mean(X) = 0.04 sd(X) = 0.19

-4

-3

-2

-1

0

1

2

3

logit probability of recruitment

Density

Density 0.0 0.5 1.0 1.5 2.0 2.5

1.0

0.0

-4

-2

0

2

logit probability of recruitment

-3

-2

-1

0

1

2

3

logit probability of recruitment

(b) Tunisia

Figure 2: Posterior density of fixed-effect coefficients for the Worm's Eye models.

22

individuals join ISIS: a linear combination of features capable of pushing an individual to become a recruit has to be extremely large, on the logit scale, to meaningfully affect the otherwise extremely low probability of recruitment.
We focus primarily on testing the role of education and social-status in the decision to join ISIS. An individual who is college-educated and low-status is assumed to be relatively deprived. We compare logit-scale effects, as opposed to predicted probabilities, as these are scarcely comparable due to the powerful effect of the intercept, which drags probabilities of most profiles close to zero. The total logit effects on probability of recruitment for different relative-deprivation profiles are shown in Figure 3 for the Bird's Eye model, and in Figures 4a and 4b for the Worm's Eye. The relative deprivation hypothesis finds mixed support: at the Bird's eye level, it seems clear that being high-status plays a key role in increasing propensity of being recruited, whilst being college educated plays a more minor role. A similar pattern is evident in Tunisia, though the effect of being high-status and college-educated is starker, meaningfully increasing the propensity to join ISIS by around 1 logit-point compared to relatively deprived individuals. In Egypt the effects are more consistent with the traditional relative-deprivation hypothesis, though note the large prediction intervals around the total effects of relatively-deprived individuals. The varying prediction intervals on the effects reflect the highly unbalanced prevalence of the groups in our study, with noncollege-educated and high-status individuals being far more common in our sample, and the interaction group being extremely rare. All in all, the evidence from these analyses suggest that high-status individuals were more likely to be recruited by ISIS, and that having a college degree on-top of a high social status further increases the likelihood of recruitment.
To fit the ICAR model we implemented the fully-connected graph shown in Figure
23

& high status high status

nococllolelgeegeedeudcuactaetidon&

no college education & low status college educated & low status

10

8

6

Density

4

2

0

-1.5

-1.0

-0.5

0.0

0.5

logit probability of recruitment

Figure 3: Posterior density of relative-deprivation profiles for the Bird's Eye model.
5a.11 The spatially autocorrelated component dominates the governorate-level variance,
as shown by the posterior of mixing parameter  in Figure 5b, estimated via Monte-
Carlo mean at close to 0.9, suggesting around 90% of the variance at the governorate
level can be explained by the ICAR model.12
We repeat these analyses for Egypt and Tunisia. Figure 6 shows similar mixing
among spatial and non-spatial components for the two countries, with around 21% of
the district-level variance in Egypt being explained by spatial patterns, and 23% in
Tunisia. It is noteworthy that very few of our contextual variables have explanatory
power for predicting recruitment. Coupled with the low percentage of variance being
11In the graph, edges connect nodes identified by the centroids of governorates for each country. Minor adjustments were performed to ensure the absence of islands or sub-graphs, which would have made the analysis needlessly complicated. Note also that Israel and Saudi Arabia are included for the purpose of obtaining this fully-connected graph, but no observations were available for either of these countries in terms of recruits or Arab Barometer observations, and hence the direction of the estimates for their governorates is entirely driven by the spatial component. Figure G.2 displays the observed number of recruits per area, along with the residual for each governorate.
12The spatial distribution of point estimates for governorate and country-level random effects are presented in Figure G.3.

24

25

(b) Tunisia
Figure 4: Posterior density of relative-deprivation profiles for the Worm's Eye models.

logit probability of recruitment

2

1

0

-1

-2

-3

Density 0.0 0.5 1.0 1.5 2.0 2.5 3.0

nococlolellgeegeedeudcuactaetdion&

low status & low status

no college education & high status college educated & high status

(a) Egypt

logit probability of recruitment

6

4

2

0

-2

-4

Density 0.0 0.2 0.4 0.6 0.8 1.0 1.2
no college education & low status noccocololllelelgegegeeeededuducucacatateetdidon&&&hloighwhigshsttaastttuaustsus

MCMC mean: 0.865

4

3

Density

2

1

0

(a)

0.0

0.2

0.4

0.6

0.8

1.0

logit probability of recruitment

(b)

Figure 5: Fully-connected graph for the Bird's Eye model (a) and Governorate-level variance mixing parameter -  (b).

explained by the spatial components, our analysis suggests that, in spite of our best efforts to account for observable heterogeneity, there exist a vast array of unobserved, non-spatial district-level effects, which accounts for around 80% of the unexplained district-level variance in both Egypt and Tunisia. Hence this contextual variance, while properly accounted for, remains unexplained. In the Appendix we also describe Moran's I statistics for the Worm's Eye analysis as well as point estimates for the district and governorate effects in Egypt and Tunisia.

6.3 Predicted Propensity of Recruitment
To conclude our analysis, we present inferences derived from the posterior predictive distribution of the out-of-sample probability of recruitment. We produce descriptive plots on the logit scale, again to aid interpretation and avoid the intercept-trap which would collapse all propensities to zero. Note further that these predicted probabilities differ from the within-sample propensities, in that it is calculated after removing the offset, hence generalized to apply to any sampling protocol, as opposed to the specific

26

Density 0.0 0.5 1.0 1.5 2.0 2.5
Density 0.0 0.5 1.0 1.5 2.0 2.5

MCMC mean: 0.197

MCMC mean: 0.222

0.0

0.2

0.4

0.6

0.8

1.0

logit probability of recruitment

0.0

0.2

0.4

0.6

0.8

1.0

logit probability of recruitment

(a)

(b)

Figure 6: District-level variance mixing parameter -  - for Egypt (a) and Tunisia (b).

case-control setting of our application. What is the profile of individuals `at risk' of recruitment to ISIS according to
our models? We attempt to answer this question by analyzing the predicted logitprobabilities of all possible theoretical profiles, defined by the individual-level characteristics available in our data. Figure 7 presents the distribution of the predicted probabilities' MCMC mean, over a wide range of possible profiles in the Bird's eye model; Table 1 presents the profiles of the top 10 most likely profiles to be recruited, this time in probability terms. A similar analysis at the Worm's Eye level is available for Egypt in Figure G.9, Table G.1, and Tunisia in Figure G.10, Table G.2. In the interest of simplicity, the Worm's eye analysis focuses on the most recruitable profiles in a hypothetical 'average district'.
From the Bird's Eye density plot we notice that the average predicted probability of recruitment lies below -10 logit points, again underscoring how rare the event in question is, and how few are the profiles of people who are susceptible to it. A

27

Density 0.00 0.05 0.10 0.15 0.20

quantile: 0 q quantile: 0.1
quantile: 0.5 quantile: 0.9 quantile: 1

no college edu. age: 57 married student
low status Algeria El Oued

no college edu. age: 45 married student
high status Algeria El Oued
q

college edu. age: 33
not married not a student
low status Morocco Fez Meknes

no college edu. age: 25
not married not a student
low status Tunisia
Sidi Bou Zid

college edu. age: 21
not married not a student high status
Tunisia Mahdia

-20

-15

-10

-5

0

logit probability of recruitment

Figure 7: Distribution of the predicted probabilities' MCMC mean across a variety of hypothetical profiles. The distribution is presented on the logit scale to be more informative.

Rank College Edu Age Married Student Low-Status Country

Governorate

Pr(r = 1)

1

1

21

0

0

2

1

21

1

0

3

0

21

0

0

4

1

21

0

0

5

1

25

0

0

6

0

21

1

0

7

1

21

1

0

8

1

25

1

0

9

1

21

0

0

10

0

21

0

0

0

Tunisia

Mahdia

0.14251

0

Tunisia

Mahdia

0.12400

0

Tunisia

Mahdia

0.12158

0

Tunisia

Gafsa

0.11583

0

Tunisia

Mahdia

0.11477

0

Tunisia

Mahdia

0.10545

0

Tunisia

Gafsa

0.10037

0

Tunisia

Mahdia

0.09944

0

Tunisia Ben Arous (Tunis Sud) 0.09881

0

Tunisia

Gafsa

0.09836

Table 1: Top 10 recruitable theoretical profiles according to the Bird's eye model. Profiles are ordered by predicted probability of recruitment net of sampling protocol. 5 age quantiles (0.1, 0.25, 0.5, 0.75, 0.9) are evaluated.

28

select number of profiles approach a predicted probability around zero logit points, and translate to meaningful probabilities of recruitment; these are highlighted in the predicted-probabilities table, which show the 10 most recruitable profiles. All of these profiles have approximately a 10 percent chance of being recruited. Unsurprisingly, they are all profiles form Tunisia, and within Tunisia the province of Mahdia appears to represent most of the profiles in the top-ten. This highlights significant cross-country and within-country contextual heterogeneity. It is worthwhile to note that, in agreement with Figure 3, all the most recruitable profiles are high-status individuals, and a majority of them has a college degree. Unsurprisingly, all of these profiles are under-25, and not currently studying. The individual-level profiles highlighted at the Bird's eye level are similar to those highlighted within Tunisia in the worm's Eye level, whilst the Egypt analysis reveals more evidence for the relative-deprivation hypothesis, with a majority of the highly-recruitable profiles being relatively-deprived. Note finally that the Egypt-specific propensity of recruitment is dramatically lower than that of Tunisia, again highlighting the role of contextual effects.
7 Conclusion
Extreme forms of political behaviour are rarely ever committed by more than a tiny subsection of any given population. Despite their small size, these groups often have an outsized influence on politics. Because of their small size, they are particularly hard to understand using conventional statistical techniques.
This article proposes a method to combine the advantages of both survey techniques and ecological forms of analysis that allows for meaningful comparisons with the underlying populations from which recruits are drawn. In so doing we solve a number of problems when approaching rare and extreme forms of political behaviour. Building on
29

existing contaminated case-control designs, we demonstrate: 1) how best to incorporate area-level random effects when the number of observations for a given unit is small; 2) how to account for spatial autocorrelation in this setup; 3) how to regularize coefficients to guard against separation; and 4) provide the model listings in STAN to apply this approach to similar types of data.
Following this approach, we are able to robustly recover individual fixed effects for relevant demographic characteristics net of context, as well as the proportion of unexplained variance attributable to unobserved spatial effects. We demonstrate the potential of this technique with data on ISIS recruits across nine countries in the MENA.
Our implementation of the technique also makes an empirical contribution to the literature on extremism. We find confirmation that recruits tend to be highly educated and we have some mixed support for the relative deprivation hypothesis. Strikingly, we also find that a large proportion of variance is attributable to unexplained spatial confounding. In this, a key lesson is that with such rare forms of political behaviour, unobserved contextual factors are likely to play a large role.
The implication here is that future work should focus attention on obtaining precise estimates of potential local-level confounders. Often, we have only limited data on the characteristics of individual cases, and the characteristics of controls are naturally constrained by the richness of the information we have for our cases. Nevertheless, obtaining richer ecological measures at a subnational level could yet advance this agenda, and provide further insights into the role of contextual factors net of individual-level drivers. Here, promising avenues include the measurement of sub- and cross-national recruitment networks (e.g., Rosenblatt 2020) as well as the use of nontraditional data sources to derive granular, time-varying ecological data (e.g., Chi et al. 2021).
30

References
ArabBarometer. Arab barometer wave iii technical report. Technical report, International Development Research Centre, United States Institute for Peace, University of Michigan, Princeton University, 2014.
C. A. Bail, F. Merhout, and P. Ding. Using Internet search data to examine the relationship between anti-Muslim and pro-ISIS sentiment in U.S. counties. Science Advances, 4(6):eaao5948, June 2018.
G. Baio. Bayesian methods in health economics. CRC Press, 2012.
C. Barrie and N. Ketchley. Is protest a safety valve against ISIS in Tunisia?, 2018. URL https://www.washingtonpost.com/news/monkey-cage/wp/2018/12/ 10/is-protest-a-safety-valve-against-isis-in-tunisia/.
M. R. Beissinger, A. A. Jamal, and K. Mazur. Explaining Divergent Revolutionary Coalitions: Regime Strategies and the Structuring of Participation in the Tunisian and Egyptian Revolutions. Comparative Politics, 48(1):1­24, 2015.
E. Benmelech and E. F. Klor. What Explains the Flow of Foreign Fighters to ISIS? Terrorism and Political Violence, 32(7):1458­1481, 2018.
J. Besag and C. Kooperberg. On conditional and intrinsic autoregressions. Biometrika, 82(4):733­746, 1995.
J. Besag, J. York, and A. Molli´e. Bayesian image restoration, with two applications in spatial statistics. Annals of the institute of statistical mathematics, 43(1):1­20, 1991.
M. Biggs and S. Knauss. Explaining Membership in the British National Party: A Multilevel Analysis of Contact and Threat. European Sociological Review, 28(5): 633­646, Oct. 2012. ISSN 0266-7215.
G. Blair, C. C. Fair, N. Malhotra, and J. N. Shapiro. Poverty and Support for Militant Politics: Evidence from Pakistan. American Journal of Political Science, 57(1):30­48, 2013.
F. R. Campante and D. Chor. Why was the Arab World Poised for Revolution? Schooling, Economic Opportunities, and the Arab Spring. Journal of Economic Perspectives, 26(2):167­188, May 2012.
B. Carpenter, A. Gelman, M. D. Hoffman, D. Lee, B. Goodrich, M. Betancourt, M. Brubaker, J. Guo, P. Li, and A. Riddell. Stan: A probabilistic programming language. Journal of statistical software, 76(1), 2017.
D. Centola and M. Macy. Complex Contagions and the Weakness of Long Ties. American Journal of Sociology, 113(3):702­734, Nov. 2007. Publisher: The University of Chicago Press.
31

G. Chi, H. Fang, S. Chatterjee, and J. E. Blumenstock. Micro-Estimates of Wealth for all Low- and Middle-Income Countries. arXiv:2104.07761 [cs, econ, q-fin], Apr. 2021. URL http://arxiv.org/abs/2104.07761. arXiv: 2104.07761.
T. S. Clark, D. A. Linzer, et al. Should i use fixed or random effects. Political Science Research and Methods, 3(2):399­408, 2015.
D. Corstange. Sensitive Questions, Truthful Answers? Modeling the List Experiment with LISTIT. Political Analysis, 17(1):45­63, 2009. Publisher: Cambridge University Press.
J. C. Davies. Toward a Theory of Revolution. American Sociological Review, 27(1):5, Feb. 1962.
S. Devarajan, L. Mottaghi, Q.-T. Do, A. Brockmeyer, C. Joubert, K. Bhatia, and M. Abdel Jelil. Economic and social inclusion to prevent violent extremism. Technical report, World Bank, 2016.
B. Dodwell, D. Milton, and D. Rassler. The Caliphate's Global Workforce: An Inside Look at the Islamic State's Foreign Fighter Paper Trail. Technical report, Combating Terrorism Center, Apr. 2016.
D. R. Fisher, K. T. Andrews, N. Caren, E. Chenoweth, M. T. Heaney, T. Leung, L. N. Perkins, and J. Pressman. The science of contemporary street protest: New efforts in the United States. Science Advances, 5(10):eaaw5461, Oct. 2019.
D. Gambetta and S. Hertog. Engineers of Jihad: The Curious Connection Between Violent Extremism and Education. Princeton University Press, Princeton, 2016.
A. Gelman and J. Hill. Data analysis using regression and multilevel/hierarchical models. Cambridge university press, 2006.
A. Gelman, A. Jakulin, M. G. Pittau, Y.-S. Su, et al. A weakly informative default prior distribution for logistic and other regression models. The annals of applied statistics, 2(4):1360­1383, 2008.
J. Ghosh, Y. Li, R. Mitra, et al. On the use of cauchy prior distributions for bayesian logistic regression. Bayesian Analysis, 13(2):359­383, 2018.
M. Gouda and M. Marktanner. Muslim Youth Unemployment and Expat Jihadism : Bored to Death? Studies in Conflict & Terrorism, 42(10):878­897, Oct. 2019.
S. Grewal, A. Yildirim, and S. Williamson. Counting the Black Flags: Measuring Support for ISIS through Endorsement Experiments. Working paper, 2020.
T. R. Gurr. Why Men Rebel. Princeton University Press, Princeton, 1970.
32

G. Heinze. Logistic regression with rare events: problems and solutions. Medical University of Vienna: CeMSIIS-Section for Clinical Biometrics. https://www. eio. upc. edu/ca/seminari/docs/georg-heinze-logistics-regression-withrare-eventsproblems-and-solutions. pdf, 2017.
G. Heinze and M. Schemper. A solution to the problem of separation in logistic regression. Statistics in medicine, 21(16):2409­2419, 2002.
S. Hertog, P. Neumann, and S. Maher. Great expectations or nothing to lose? socioeconomic correlates of joining the islamic state, 2021.
M. D. Hoffman and A. Gelman. The no-u-turn sampler: adaptively setting path lengths in hamiltonian monte carlo. J. Mach. Learn. Res., 15(1):1593­1623, 2014.
J. Kawalerowicz and M. Biggs. Anarchy in the UK: Economic Deprivation, Social Disorganization, and Political Grievances in the London Riot of 2011. Social Forces, 94(2):673­698, Dec. 2015.
N. Ketchley and M. Biggs. The Educational Contexts of Islamist Activism: Elite Students and Religious Institutions in Egypt. Mobilization, 22(1):57­76, 2017.
G. King and L. Zeng. Logistic regression in rare events data. Political analysis, 9(2): 137­163, 2001.
A. B. Krueger. What Makes a Terrorist: Economics and the Roots of Terrorism. Princeton University Press, Princeton, 2017.
A. B. Krueger and J. Maleckova. Education, Poverty and Terrorism: Is There a Causal Connection? Journal of Economic Perspectives, 17(4):119­144, 2003.
T. Lancaster and G. Imbens. Case-control studies with contaminated controls. Journal of Econometrics, 71(1-2):145­160, 1996.
B. Lia. Globalisation and the Future of Terrorism: Patterns and Predictions. Routledge, London, 2005.
D. J. Lunn, A. Thomas, N. Best, and D. Spiegelhalter. Winbugs-a bayesian modelling framework: concepts, structure, and extensibility. Statistics and computing, 10(4): 325­337, 2000.
J. Lyall, G. Blair, and K. Imai. Explaining Support for Combatants during Wartime: A Survey Experiment in Afghanistan. The American Political Science Review, 107 (4):679­705, 2013.
A. Malik and B. Awadallah. The Economics of the Arab Spring. World Development, 45:296­313, 2013.
33

D. McAdam and R. Paulsen. Specifying the Relationship Between Social Ties and Activism. American Journal of Sociology, 99(3):640­667, 1993.
E. B. D. Mesquita. The Quality of Terror. American Journal of Political Science, 49 (3):515­530, 2005.
T. Mitts. From Isolation to Radicalization: Anti-Muslim Hostility and Support for ISIS in the West. American Political Science Review, 113(1):173­194, Feb. 2019.
M. Morris, K. Wheeler-Martin, D. Simpson, S. J. Mooney, A. Gelman, and C. DiMaggio. Bayesian hierarchical spatial models: Implementing the besag york molli´e model in stan. Spatial and spatio-temporal epidemiology, 31:100301, 2019.
K.-D. Opp and C. Gern. Dissident Groups, Personal Networks, and Spontaneous Cooperation: The East German Revolution of 1989. American Sociological Review, 58 (5):659, Oct. 1993.
G. Østby, H. Urdal, and K. Dupuy. Does Education Lead to Pacification? A Systematic Review of Statistical Studies on Education and Political Violence. Review of Educational Research, 89(1):46­92, Feb. 2019.
R. A. Pape. Opinion | What an analysis of 377 Americans arrested or charged in the Capitol insurrection tells us. Washington Post, 2021. ISSN 0190-8286. URL https://www.washingtonpost.com/opinions/2021/04/06/ capitol-insurrection-arrests-cpost-analysis/.
M. Plummer et al. Jags: A program for analysis of bayesian graphical models using gibbs sampling. In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, pages 1­10. Vienna, Austria, 2003.
A. Riebler, S. H. Sørbye, D. Simpson, and H. Rue. An intuitive bayesian spatial model for disease mapping that accounts for scaling. Statistical methods in medical research, 25(4):1145­1165, 2016.
N. Rosenblatt. All Jihad is Local: What ISIS' Files Tell Us About Its Fighters. Technical Report I, New America, 2018.
N. Rosenblatt. Localism as Secrecy: Efficiency-Secrecy Tradeoffs in the Recruitment of ISIS Foreign Fighters. arXiv:2011.12290 [physics], Nov. 2020. URL http://arxiv. org/abs/2011.12290. arXiv: 2011.12290.
B. Rosenfeld. Reevaluating the middle-class protest paradigm: A case-control study of democratic protest coalitions in russia. American Political Science Review, 111(4): 637­652, 2017.
C. T. Rota, J. J. Millspaugh, D. C. Kesler, C. P. Lehman, M. A. Rumble, and C. M. Jachowski. A re-evaluation of a case­control model with contaminated controls for resource selection studies. Journal of animal ecology, 82(6):1165­1173, 2013.
34

O. Roy. The Failure of Political Islam. Harvard University Press, Cambridge, MA, 1994.
P. Selb and S. Munzert. Estimating constituency preferences from sparse survey data using auxiliary geographic information. Political Analysis, pages 455­470, 2011.
D. Simpson, H. Rue, A. Riebler, T. G. Martins, S. H. Sørbye, et al. Penalising model component complexity: A principled, practical approach to constructing priors. Statistical science, 32(1):1­28, 2017.
D. Sterman and N. Rosenblatt. All Jihad is Local: ISIS in North Africa and the Arabian Peninsula. Technical Report II, New America, 2018.
G. M. Tezcu¨r. Ordinary People, Extraordinary Risks: Participation in an Ethnic Rebellion. American Political Science Review, 110(2):247­264, May 2016.
P. Verwimp. Foreign Fighters in Syria and Iraq and the Socio-Economic Environment They Faced at Home. Perspectives on Terrorism, 10(6):68­81, 2016.
A. Y. Zelin. Tunisian foreign fighters in iraq and syria. Technical report, Washington Institute for Near East Policy, 2018.
35

Appendix

Table of Contents

A Sample ISIS data

A2

A.1 Independent variable details . . . . . . . . . . . . . . . . . . . . . . . A3

B STAN listings

A6

C Cases and observations

A8

D District-level population histograms

A10

E Convergence diagnostics

A11

F Posterior densities of regression coefficients

A15

G Residual Area-Level Analysis

A17

A1

A Sample ISIS data
Figure A.1 provides a representative example of a single border document for one fighter. Details here are not real but provide a representative example in translation of the information included in the original Arabic documents.

  

,46 5 ,% !   

E ,

Name and first name

Abdul Karim

1

2

Nom de guerre

Abu Hamza al-Maghrebi

3

Mother's name

4

Blood type

 5

Date of birth

 6

Marital status

 7

Place of Residence

 8

Education level

 9

Level of Shari'ia

 1

Occupation prior to arrival

 0

1

Countries transited

 1

- + 1

Point of entry and contact

2

1

Who recommended

 3

1

Date of entry

,. 4

1

Previous combat experience

 5

1

Fighter; Martyr; Suicide Bomber?

 6

 1

Specialization

7

 1

Current place of work

8

 1

Items of luggage

9

2

Level of hearing

0

2 Phone number and emergency contact

1

Layla A
11/01/1981 (1) Married ( ) Single
Cairo, Doki Technical diploma in Engineering
(*) Low ( ) Medium ( ) High Chef None
Jarablus, Abu Abdi Abu Abdi
01/09/2013 None
Suicide bomber ( *) Admin ( ) Security ( ) Shara'i ( ) Fighter
Suitcase
Wife 123456789 Father 876543210

2

Date and place of death

2

2

Notes

3

  

_ 6 _   ,. - + 

Figure A.1: Example of border document (details changed).

A2

A.1 Independent variable details

Table A.1: Individual-level variable codings across border documents and survey data

Variable coledu age married student lowstat

Border Documents ABIII

1 if Education level mentions "university" Date of entry - Date of birth 1 if Marital status is "married" 1 if Occupation prior to arrival is "student" 1 if Occupation prior to arrival is agricultural or manual/unemployed

1 if q1003 >5 (or >4 for Tunisia; >6 for Yemen) q1001
q1010
q1004 = 3 (Student)
q1004 = 5 (Unemployed) or q1010 = 4/5 (Agricultural or manual worker)

A3

Table A.2: Egypt district-level covariates

Variable Population density Population % Christian % University % Agriculture
% Mursi
Unemployment rate
Killed at Rabaa
Post-revolutionary protest

Details

Source

number of individuals in district/district area in km^2 number of individuals in district aged 10 or over percentage of individuals in district recorded as Christian percentage of individuals in district who are university educated percentage individuals employed in agriculture denominated by total active population

2006 Census 2006 Census 2006 Census 2006 Census
2006 Census

percent of total votes

in district for Muham-

mad Mursi in the first

round of the 2012

presidential election

number individu-

als aged without

employment denomi-

nated by total active

population

number of deaths

of individuals from

district at the 2013

Rabaa

Massacre

(square-rooted)

number of protests

recorded in district

in 12 months after

Jan 25 Revolution

(square-rooted)

El-Masry and Ketchley (2021) 2006 Census Ketchley and Biggs (2017) Barrie and Ketchley (2019)

A4

Table A.3: Tunisia district-level covariates

Variable

Details

Source

Population Population density % University % Agriculture
Unemployment rate

number of individuals in district aged 10 or over number of individuals in district aged 10 or over/district area in km^2 percentage population with higher education certificate denominated by total population percentage individuals employed in agriculture denominated by total active population aged 15 or over number individuals aged 18-59 without employment denominated by total active population aged 18-59

2014 Census 2014 Census 2014 Census 2014 Census
2014 Census

Graduate unemployment rate
% Ennahda 2011
% Ennahdha 2014
Post-revolutionary protests
Distance to Libya

number individuals

with higher education

certificate

without

employment denomi-

nated by total active

population aged 18-59

percentage of total

votes in district for

Ennahdha in 2011

election

percentage of total

votes in district for

Ennahdha in 2014

election

number of protests

recorded in district

in 12 months after

Jan 14 Revolution

(square-rooted)

distance to Libyan bor-

der from centroid of

target district (square-

rooted)
A5

2014 Census
INS Tunisia INS Tunisia Barrie and Ketchley (2019) NA

B STAN listings

Listing 1: STAN Data Declaration Block.

1 data { 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 }

int <lower = 1> n; int <lower = 1> p; matrix[n, p] X; int <lower = 0> Y[n];

// total number of observations // number of covariates in design matrix // design matrix
// vector of labels

int <lower = 1> N_dist; int <lower = 1> N_gov;

// number of small -areas // number of large -areas

int <lower = 1> dist_id[n]; int <lower = 1> gov_id[n];

// small -area id // large -area id

int <lower=0> N_dist_edges;

// Data for improper , efficient spatial prior:

int <lower=1, upper=N_dist > node1[N_dist_edges];

// node1[i] adjacent to node2[i]

int <lower=1, upper=N_dist > node2[N_dist_edges];

// and node1[i] < node2[i]

real scaling_factor;

// scaling factor derived from the adjacency matrix

vector[N_gov] log_offset; vector[N_gov] theta;

// offset // Pr(Y = 1 | r = 1, s = 1)

Listing 2: STAN Parameters Declaration Block.

1 parameters {

2

vector[p] beta;

// fixed effects coefficients

3

vector[N_dist] phi;

// small -area random effect - main

4

vector[N_dist] psi;

// small -area random effect - spatial

5

vector[N_gov] eta;

// large -area random effect

6

7

real <lower = 0,upper = 1> lambda;

// mixing weight

8

9

real <lower = 0> sigma;

// sd of small -area random effect

10

real <lower = 0> tau_eta;

// precision of large -area random effect

11 }

A6

Listing 3: STAN Transformed Parameters Block.

1 transformed parameters{

2

vector[N_dist] gamma;

// convoluted small -area effect

3

vector[n] mu;

// logit -scale propensity to be a recruit

4

vector[n] mu_star;

// out -of -sample logit -scale propensity

5

real <lower = 0, upper = 1> rho[n];

// propensity to be a recruit

6

real <lower = 0, upper = 1> rho_star[n];

// out -of -sample propensity to be a

recruit

7

8

real <lower = 0> tau;

// precision of small -area random effect

9

real <lower = 0> sigma_eta;

// sd of large -area random effect

10

11

matrix <lower = 0, upper = 1>[2,N_gov] xi;

// probability of being labeled a

recruit

12

13

sigma_eta = sqrt(1/tau_eta);

// large -area scale

14

tau = pow(sigma ,-2);

// small -area precision

15

16

17

gamma = sqrt(1-lambda) * phi + sqrt(lambda / scaling_factor) * psi ;

18

// variance of each component should be approximately equal to 1

19

20

21

mu = log_offset[gov_id] + X * beta + gamma[dist_id]*sigma + eta[gov_id]*sigma_eta ;

22

mu_star = X * beta + gamma[dist_id]*sigma + eta[gov_id]*sigma_eta ;

23

// linear function of the logit -scale propensity to be a recruit

24

25

for(i in 1:n){

26

rho[i] = inv_logit(mu[i]);

// propensity to be a recruit

27

}

28

29

30

for(j in 1:N_gov){

31

xi[1,j] = theta[j];

32

xi[2,j] = 0;

33

}

34

// defining the propensities of being labeled a recruit for each of the candidate models in

the mixture

35 }

Listing 4: STAN Model Declaration Block.

1 model {

2

3

beta [1] ~ cauchy(0, 10); // prior on intercept

4

for(i in 2:p){

5

beta[i] ~ cauchy(0, 2.5);

// prior on fixed -effects , excluding the intercept

6

}

7

8

phi ~ normal(0,1);

// unstructured random effect on small -area

9

target += -0.5 * dot_self(psi[node1] - psi[node2]);

// ICAR prior

10

sum(psi) ~ normal(0, 0.01 * N_dist);

// soft sum -to -zero , equivalent to mean(psi) ~ normal

(0 ,0.01)

11

lambda ~ beta(0.5,0.5);

// mixing weight prior

12

sigma ~ normal(0,1);

// half -normal prior for small -area sd

13

14

eta ~ normal(0,1);

// random effect on large area

15

tau_eta ~ gamma(1,1);

// conjugate gamma prior on large -area precision

16

17

for (i in 1:n){

18

target += log_mix(rho[i],

19

bernoulli_lpmf(Y[i] | xi[1,gov_id[i]] ),

20

bernoulli_lpmf(Y[i] | xi[2,gov_id[i]] ) );

// labels distributed as mixture of bernoulli

distributions

21

}

22 }

A7

log( n. estimated cases )

231 462 694 925 1156

C Cases and observations

50

40

% Cases & N. Obs by Country

n. observations

6

8

10

Sampled Cases v. Estimated Cases

q

q q

q qq

q q q

upper-estimate q lower-estimate
best-fit line corr: ( 0.84 , 0.826 ) mad: ( 2.466 , 2.311 )

30

% cases

20

4

10

2

0 Kuwait Yemen Algeria Jordan Lebanon
Libya Egypt Morocco Tunisia
0

2

4

6

8

10

log( n. sampled cases )

Figure C.1: Left: display of the % cases and number of observations by country in our sample. Right: a comparison of the log-number of cases in our sample, with the lower and higher log-estimates of recruits number, derived for most countries from Benmelech and Klor (2020), and for Yemen from Cook and Vale (2018).

A8

A9

Algeria Kuwait Morocco

n. observations

n. observations

n. observations

% Cases & N. Obs by Governorate Egypt
Lebanon
Tunisia

Figure C.2: Left y-axis (in black): % of cases out of total observations from the given district. Right y-axis (in purple): number of observations per district. Dotted vertical line: last district with zero cases.

% cases 0 20 40 60 80 100 Draa Tafilalet

% cases 0 20 40 60 80 100 Mubarak Al-Kabeer

Guelmim Oued Noun Souss Massa

Hawalli

Oriental Casablanca Settat

Al Farwaniyah

Marrakech Safi Rabat Sale Kenitra

Al Kuwayt

Tangier Tetouan Al Hoceima Fez Meknes

Al Ahmadi

Beni Mellal Khenifra 0 54 108 161 215 269

Al Jahrah 0 54 108 161 215 269

% cases 0 20 40 60 80 100 Ain-Temouchent Annaba Bejaia Biskra Bordj Bou Arrer Djelfa El Bayadh El Oued El-Tarf Guelma Jijel Khenchela Laghouat M'Sila Medea Mila Mostaganem Ouargla Oum El Bouaghi Relizane Saida Sidi Bel Abbes Skikda Souk-Ahras Tebessa Tiaret Tipaza Tissemsilt Tizi Ouzou Tlemcen Setif Ghardaia Mascara Batna Oran Ain-Defla Boumerdes Alger Blida Constantine Bechar 0 54 108 161 215 269

% cases
0 20 40 60 80 100
Tozeur Sfax
Jendouba Béja
Le Kef Gafsa Nabeul Gabès Kairouan Siliana Zaghouan Ben Arous (Tunis Sud) Mahdia Sousse Kassérine Tataouine Monastir Manubah Sidi Bou Zid Tunis Médenine Ariana Kebili Bizerte
0 54 108 161 215 269

% cases 0 20 40 60 80 100 El Nabatieh
Mount Lebanon
South
Beirut
Bekaa
North
Akkar 0 54 108 161 215 269

% cases
0 20 40 60 80 100
Assiut Aswan Beni Suef Luxor Menia Menoufia
Qena Red Sea
Suhag Fayoum Damietta
Giza Ismailia Behera Kafr El-Shikh
Cairo Kalyoubia
Suez Sharkia Dakahlia Alexandria Matrouh North Sinai Port Said
0 54 108 161 215 269

n. observations

n. observations

n. observations

Jordan Libya Yemen

% cases
0 20 40 60 80 100
Abyan Ad Dali' Al Bayda Al Jawf Al Maharah Al Mahwit
Amran Dhamar
Hajjah Lahj
Raymah Sa'dah
Shabwah Ta'iz
Hadramawt Ibb
Al Hodeidah Sana'a Aden Ma'rib
0 54 108 161 215 269

% cases
0 20 40 60 80 100
Al Jabal Al Akhdar Al Jabal Al Gharbi
Aljfara Aljufra Alkufra Almargeb Almarj
Ghat Murzuq
Nalut Sebha Ubari Wadi Ashshati Misrata Zwara Tripoli Tobruk
Sirt Benghazi
Derna Ejdabia
0 54 108 161 215 269

% cases 0 20 40 60 80 100 Ajlun Aqaba Irbid Jarash Ma`an Madaba Mafraq Karak Amman Zarqa Tafilah Balqa 0 54 108 161 215 269

n. observations

n. observations

n. observations

D District-level population histograms
Egypt Popultation by District (2006)
mean size: 521842

8

6

frequency

4

2

0

0 500000

1500000 2500000 count

3500000

Tunisia Popultation (10+) by District (2014)
mean size: 41010

8

6

frequency

4

2

0

0 20000 40000 60000 80000 100000 count
Figure D.1: Histograms of population size per districts.

A10

E Convergence diagnostics
Convergence Diagnostics

Rhat 0.85 0.90 0.95 1.00 1.05 1.10 1.15

0 2000 4000 6000 8000 Index of Parameters

12000

Figure E.1: Gelman-Rubin Statistics for the Bird's Eye model. the parameter lp , representing the overall likelihood of the model, is highlighted in blue.

Convergence Diagnostics

Convergence Diagnostics

Rhat 0.85 0.90 0.95 1.00 1.05 1.10 1.15
Rhat 0.85 0.90 0.95 1.00 1.05 1.10 1.15

0

500 1000 1500 2000

Index of Parameters

0

500 1000 1500 2000 2500

Index of Parameters

(a) R^ - Egypt.

(b) R^ - Tunisia.

Figure E.2: Gelman-Rubin Statistics for the Worm's Eye models for Egypt and Tunisia. The parameter lp , representing the overall likelihood of the model, is highlighted in blue.

A11

beta[1] -9

beta[2] 0.2

beta[3] 3

-10 -11 -12 -13
9500 -2
-4
-6
9500

9600 9600

9700

9800

beta[4]

9700

9800

beta[7]

0.1

0.0

9900

-0.1

10000

9500

0.1

0.0

-0.1

-0.2

9900

-0.3

10000

9500

9600 9600

9700

9800

beta[5]

9700

9800

beta[8]

2

1

0

9900 10000

9500

-0.15

-0.20

-0.25

-0.30

-0.35

-0.40

9900

-0.45

10000

9500

9600 9600

9700

9800

beta[6]

9700

9800

9900 10000
chain 1 2 3 4
9900 10000

-0.5 0.1
-0.6
0.0 -0.7

9500

9600

9700

9800

9900

-0.1

10000

9500

9600

9700

9800

9900 10000

Figure E.3: Traceplot for the Bird's Eye Model

A12

beta[1]

beta[2]

1.5

beta[3]

beta[4] 5

beta[5]

-12.5

1.0

5

1 0

-15.0 0.5

-5

0

0

-17.5 0.0

-10

-5

-1

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

beta[6] 1.0
0.5

beta[7]

beta[8]

1.5 0

1.0

beta[9] 6

beta[10] 2

-1

4 0

0.0
-0.5 9500 9600 9700 9800 beta[11]
2

-2
9900 10000 9500 9600 9700 9800 beta[12]
2

0.5
0.0 9900 10000 9500 9600 9700 9800 9900 10000
beta[13] 2

2 0
9500
4

-2
9600 9700 9800 9900 10000 9500 beta[14] 4

9600 9700 9800 9900 10000 beta[15]

chain 1 2 3 4

1

1

0

3 2

0 0
-2
-1 -1

2 0
1

-2

-4

-2

-2

0

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

beta[16] 4

beta[17]

1 2
0 0
-1
-2 -2

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

Figure E.4: Traceplot for the Worm's Eye Model: Egypt

A13

beta[1]

beta[2]

beta[3]

beta[4]

beta[5]

-8 0.75
-9 0.50
-10

-5

0.25

10

-10

0.00

-15

5

-0.25

0.25 -11

-20

-0.50

0

-25

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

beta[6]

-0.25

beta[7]

beta[8]

beta[9]

beta[10] 1.0

-0.25

0.00

0.5

-0.50

0.5

-0.50

-0.75

-0.25

0.0

0.0

-0.75

-1.00

-0.50

-0.5

-0.5

chain

-1.00

-1.25

-1.0

-1.0

1

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

2

beta[11] 1.5

beta[12]

beta[13] 1.5

beta[14]

beta[15] 3

1 1.0

4

1.0

1.0

1

0.5

0.5

0.5

0

0.0

0.0

0.0

-1

-0.5

-0.5

-0.5

-1.0

-1.0

-2

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

0
-1
-2 9500 9600 9700 9800 9900 10000

beta[16] 1.0

beta[17] 2

beta[18] 1

0.5

1

0

0.0

0

-1

-0.5

-1

9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000 9500 9600 9700 9800 9900 10000

Figure E.5: Traceplot for the Worm's Eye Model: Tunisia

A14

F Posterior densities of regression coefficients
Figures F.1 and F.2 display the posterior density of fixed-effect coefficients at the individual and district levels for Egypt and Tunisia respectively.

Density 0.00 0.10 0.20

Density 0.0 0.6 1.2

Density 0.0 0.2 0.4

intercept
E[beta_1] = -14.211 sd(beta_1) = 1.136 Pr(beta_1<0) = 1

coledu
E[beta_2] = 0.607 sd(beta_2) = 0.297 Pr(beta_2>0) = 0.98 mean(X) = 0.28 sd(X) = 0.45

age
E[beta_3] = 0.083 sd(beta_3) = 2.08 Pr(beta_3>0) = 0.44 mean(X) = 38.32 sd(X) = 13.83

-20 -15 -10

-5

0

logit probability of recruitment

age2
E[beta_4] = -2.2 sd(beta_4) = 2.559 Pr(beta_4<0) = 0.858 mean(X) = 1659.68 sd(X) = 1197.19

-2

0

2

4

logit probability of recruitment

married
E[beta_5] = 0.061 sd(beta_5) = 0.376 Pr(beta_5>0) = 0.574 mean(X) = 0.72 sd(X) = 0.45

1.0

-5

0

5

10

logit probability of recruitment

student
E[beta_6] = 0.158 sd(beta_6) = 0.252 Pr(beta_6>0) = 0.744 mean(X) = 0.04 sd(X) = 0.19

Density

Density 0.0 0.4 0.8

Density 0.00 0.10 0.20

0.0

-15

-10

-5

0

5

logit probability of recruitment

lowstat
E[beta_7] = -1.093 sd(beta_7) = 0.505 Pr(beta_7<0) = 0.994 mean(X) = 0.26 sd(X) = 0.44

-4

-2

0

2

4

logit probability of recruitment

coledu_lowstat
E[beta_8] = 0.62 sd(beta_8) = 0.285 Pr(beta_8>0) = 0.976 mean(X) = 0.03 sd(X) = 0.17

-2

0

2

4

logit probability of recruitment

population_density
E[beta_9] = 1.797 sd(beta_9) = 0.936 Pr(beta_9>0) = 0.996 mean(X) = 14809.8 sd(X) = 34630.65

Density 0.0 0.2 0.4

Density 0.0 0.5 1.0 1.5

Density 0.0 0.4

-4

-2

0

2

logit probability of recruitment

total_population_2006
E[beta_10] = -0.366 sd(beta_10) = 0.849 Pr(beta_10<0) = 0.68 mean(X) = 454231.54 sd(X) = 562242.41

-2

0

2

4

logit probability of recruitment

christian_2006_pct
E[beta_11] = -0.154 sd(beta_11) = 0.731 Pr(beta_11<0) = 0.57 mean(X) = 5.21 sd(X) = 6.74

-2 0

2

4

6

8 10

logit probability of recruitment

university_2006_pct
E[beta_12] = -0.053 sd(beta_12) = 0.782 Pr(beta_12<0) = 0.498 mean(X) = 10.06 sd(X) = 8.51

Density 0.0 0.2 0.4

Density 0.0 0.2 0.4

Density 0.0 0.2 0.4

-6 -4 -2 0

2

4

6

logit probability of recruitment

agriculture_2006_pct
E[beta_13] = -1.14 sd(beta_13) = 1.166 Pr(beta_13<0) = 0.836 mean(X) = 25.64 sd(X) = 19.62

-4

-2

0

2

4

logit probability of recruitment

mursi_vote_2012_pct
E[beta_14] = -0.001 sd(beta_14) = 0.983 Pr(beta_14<0) = 0.482 mean(X) = 24.96 sd(X) = 11.06

-6

-4

-2

0

2

4

logit probability of recruitment

sqrt_killed_at_rabaa
E[beta_15] = 1.741 sd(beta_15) = 0.747 Pr(beta_15>0) = 0.988 mean(X) = 1.3 sd(X) = 1.1

Density 0.0 0.2 0.4

Density 0.0 0.2 0.4

Density 0.00 0.15 0.30

-8 -6 -4 -2 0

2

4

logit probability of recruitment

unemployment_2013q4_pct
E[beta_16] = -0.33 sd(beta_16) = 0.901 Pr(beta_16<0) = 0.634 mean(X) = 12.97 sd(X) = 2.55

-6 -4 -2 0 2 4 6
logit probability of recruitment
protest_post_Mubarak
E[beta_17] = -0.496 sd(beta_17) = 0.752 Pr(beta_17<0) = 0.738 mean(X) = 7.24 sd(X) = 15.81

-2

0

2

4

6

logit probability of recruitment

Density 0.0 0.2 0.4

Density 0.0 0.2 0.4

-6 -4 -2 0

2

4

6

logit probability of recruitment

-4

-2

0

2

4

logit probability of recruitment

Figure F.1: Posterior density of fixed-effect coefficients for the Egypt-specific model.

A15

Density 0.00 0.06 0.12

intercept
E[beta_1] = -9.252 sd(beta_1) = 0.675 Pr(beta_1<0) = 1

coledu
E[beta_2] = 0.447 sd(beta_2) = 0.15 Pr(beta_2>0) = 1 mean(X) = 0.2 sd(X) = 0.4

age
E[beta_3] = 5.149 sd(beta_3) = 2.574 Pr(beta_3>0) = 0.992 mean(X) = 36.45 sd(X) = 15.88

Density 0.0 1.0 2.0

Density 0.0 0.2 0.4

-15

-10

-5

0

logit probability of recruitment

age2

E[beta_4] = -12.195 sd(beta_4) = 3.715 Pr(beta_4<0) = 1 mean(X) = 1580.59 sd(X) = 1448.96

-3 -2 -1 0 1 2 3 4
logit probability of recruitment
married
E[beta_5] = -0.126 sd(beta_5) = 0.173 Pr(beta_5<0) = 0.766 mean(X) = 0.48 sd(X) = 0.5

0

5

10

15

logit probability of recruitment

student
E[beta_6] = -0.537 sd(beta_6) = 0.141 Pr(beta_6<0) = 1 mean(X) = 0.1 sd(X) = 0.3

Density 0.0 1.0 2.0 3.0

Density 0.0 1.0 2.0

Density 0.00 0.04 0.08

-25 -20 -15 -10 -5 0
logit probability of recruitment
lowstat
E[beta_7] = -0.731 sd(beta_7) = 0.162 Pr(beta_7<0) = 1 mean(X) = 0.34 sd(X) = 0.47

-3 -2 -1 0 1 2 3
logit probability of recruitment
coledu_lowstat
E[beta_8] = -0.329 sd(beta_8) = 0.137 Pr(beta_8<0) = 0.992 mean(X) = 0.04 sd(X) = 0.19

-4 -3 -2 -1 0 1 2 3
logit probability of recruitment
pop_10plus_2014
E[beta_9] = -0.089 sd(beta_9) = 0.29 Pr(beta_9<0) = 0.618 mean(X) = 46773.22 sd(X) = 22786.49

Density 0.0 0.6 1.2

Density 0.0 1.0 2.0 3.0

Density 0.0 1.0 2.0

-4

-2

0

2

logit probability of recruitment

population_density
E[beta_10] = 0.058 sd(beta_10) = 0.327 Pr(beta_10>0) = 0.568 mean(X) = 18065.51 sd(X) = 34085.21

-3 -2 -1 0 1 2 3
logit probability of recruitment
pct_agri_2014
E[beta_11] = 0.254 sd(beta_11) = 0.353 Pr(beta_11>0) = 0.772 mean(X) = 10.37 sd(X) = 10.84

-4

-2

0

2

4

logit probability of recruitment

pct_higher_edu_2014
E[beta_12] = -0.064 sd(beta_12) = 0.401 Pr(beta_12<0) = 0.578 mean(X) = 11.65 sd(X) = 6.78

Density 0.0 0.4 0.8

Density 0.0 0.4 0.8

Density 0.0 0.4 0.8 1.2

-4

-2

0

2

4

logit probability of recruitment

unemp_rate_2014
E[beta_13] = 0.035 sd(beta_13) = 0.431 Pr(beta_13>0) = 0.548 mean(X) = 15.82 sd(X) = 5.85

-4

-2

0

2

4

logit probability of recruitment

dip_unemp_rate_2014
E[beta_14] = -0.399 sd(beta_14) = 0.531 Pr(beta_14<0) = 0.786 mean(X) = 24.37 sd(X) = 9.55

-4

-2

0

2

4

logit probability of recruitment

sqrt_distance_to_libya
E[beta_15] = 0.13 sd(beta_15) = 0.566 Pr(beta_15>0) = 0.61 mean(X) = 18.13 sd(X) = 3.68

Density 0.0 0.3 0.6

Density 0.0 0.4 0.8

Density 0.0 0.4 0.8

-4

-2

0

2

4

logit probability of recruitment

sqrt_post_rev_protest_events
E[beta_16] = 0.095 sd(beta_16) = 0.253 Pr(beta_16>0) = 0.66 mean(X) = 2.77 sd(X) = 3.2

-4

-2

0

2

4

logit probability of recruitment

pct_nahdha_2014
E[beta_17] = 0.386 sd(beta_17) = 0.573 Pr(beta_17>0) = 0.782 mean(X) = 28.78 sd(X) = 12.54

-4

-2

0

2

4

logit probability of recruitment

pct_nahdha_2011
E[beta_18] = -0.24 sd(beta_18) = 0.507 Pr(beta_18<0) = 0.69 mean(X) = 37.5 sd(X) = 11.78

Density 0.0 0.4 0.8

Density 0.0 0.4

Density 0.0 0.5 1.0 1.5

-2

0

2

4

logit probability of recruitment

-4

-2

0

2

4

logit probability of recruitment

-4

-2

0

2

4

logit probability of recruitment

Figure F.2: Posterior density of fixed-effect coefficients for the Tunisia-specific model.

A16

G Residual Area-Level Analysis
We are satisfied that the spatial pattern implied by the adjacency matrix derived from the fully connected graph is completely extracted from the residuals, as shown by the relatively uniform color pallet of the rightmost map in Figure G.2, and most importantly the posterior distribution of the residuals' Moran's I in Figure G.1, which is normally distributed around the expected null value.
Global Auto-correlation Diagnostics
E[I(Y)]: 0 mean I(Y): 0.203 mean I(res.): 0

15

10

Frequency

5

0

-0.10

-0.05

0.00

0.05

0.10

0.15

0.20

Moran's I

Figure G.1: Posterior distribution of Moran's I, a coefficient of global spatial auto-

correlation. The adjacency matrix implied by Figure 5a is used as the weight matrix.

I(Y ) indicates the coefficient value prior to spatial modeling; I(res) shows the complete

nullification of auto-correlation as a result of the ICAR prior. The expected value under

the

null

distribution,

E [I (Ynull )],

is

calculated

as

. -1
(n1+nu)-1

Figure G.2 displays the observed number of recruits per area, along with the residual for each governorate. In G.2b the residual is calculated as resl = y¯l - ¯l l  1, . . . , L.13 A first concern is the presence of spatial autocorrelation in the recruitment data, which could bias individual-level coefficients. The spatial distribution in Figure G.2a seem to suggest the possibility of spillover effects around high-density coastal areas. This is confirmed by the Moran's I (I(Y )), which shows statistically significant spatial autocorrelation.14
13We treat the unlabeled Arab Barometer records as controls in calculating residuals, as the prevalence of recruitment is so rare.
14As I(Y) is an observed, not modeled, quantity, it carries no uncertainty around it; it is reasonable to assume that the distribution of the I(Y ) would be the same as that of the I(res) in terms of its shape and variance, and only differ as a result of the mean paramater. This is what is commonly assumed under standard hypothesis testing. Hence, it is easy to see that by applying the extremely narrow simulated variance around the I(Y ) dotted line, there would be a 0 probability of that distribution crossing the E[I(Y )] line, and hence we can say the I(Y ) is highly significant. Calculating the significance of I(Y ) in frequentist terms, using the ape package, reveals a p-value of 0. We plot and describe our calculation for Moran's I in Appendix Figure G.1

A17

Number of Recruits: Spatial Distribution

Residual: Spatial Distribution

0

20

40

60

80

(a)

-4 -2 0 2 4
(b)

Figure G.2: Spatial distribution of observations (a) and residuals (b) at the Governorate level. (a) presents the spatial distribution of recruits; areas for which we have only ArabBarometer `control' observations are in grey; white areas indicate instance in which we have neither controls nor cases.

We display below the spatial distribution of the point estimates for Governorate and Country-level random effects in Figure G.3. The corresponding prediction intervals for country and governorate effects are available upon request.It is worth noting that part of the reason for heightened recruitment propensity around the eastern Governorates could be the increasing proximity to Syria and the ISIS caliphate itself, as well as higher proportions of refugees from destabilized regions of Syria, and in general more potential for pro-ISIS unobservable network-dynamics. We see a strong residual effect in Tunisia, highlighting unobserved but systematic variance in favour of recruitment , while Algeria, Yemen and, to some extent, Egypt, show significant negative effects on recruitment over and above their spatial and unstructured Governorate-level Variance.
Figure G.4 presents the Egypt and Tunisia fully-connected graphs used to derive the district-level adjacency matrices fed to the ICAR model. Again, a small number of adjustments were made to connect islands and ensure full-connectivity.
The residual plots in Figure G.6, along with the Moran's I presented in Figure G.5, convincingly show we have extracted all spatial variance from the observations: the resulting Moran's Is are distributed around the null-value, and for both Egypt and Tunisia we have a significant I for the unmodeled observations.
Figures G.7 and G.8 present the spatial distribution of point-estimates for the District and Governorate effects of Egypt and Tunisia respectively. The spatial distribution for Egypt indicates a substantially heightened propensity of recruitment in northeast-

A18

Governorate Effect - Unstructured

Governorate Effect - Spatial

-4 -2 0 2 4
(a)
Governorate Effect - Total

-4 -2 0 2 4
(b)
Country Effects - Unstructured

-4 -2 0 2 4
(c)

-4 -2 0 2 4
(d)

Figure G.3: Spatial distribution of: (a) the unstructured Governorate-level effect - ; (b) the spatial Governorate level effect - ; (c) the total Governorate effect -  = ( 1 - ) +  /s); (d) the unstructured Country effect - .

A19

(a)

(b)

Figure G.4: Fully-connected graphs of (a) Egypt and (b) Tunisia at the District level.

Global Auto-correlation Diagnostics
E[I(Y)]: -0.002 mean I(Y): 0.054 mean I(res.): -0.006

Global Auto-correlation Diagnostics
E[I(Y)]: -0.001 mean I(Y): 0.085 mean I(res.): 0.001

5 10 15 20 25

Frequency

5 10 15 20 25

Frequency

0

0

-0.3

-0.2

-0.1

0.0

0.1

Moran's I

-0.05

0.00

0.05

0.10

Moran's I

(a)

(b)

Figure G.5: Posterior distribution of Moran's I for Egypt (a) and Tunisia (b). The adjacency matrices implied by Figure G.4 are used as the weight matrices.

A20

ern regions. No similar pattern is evident in Tunisia, though the mid-eastern costal areas do display systematically lower spatial recruitment effects than the rest of the country. Both countries estimate a number of highly significant district-level effects, which account for large portions of the variance in recruitment of both countries, with highly significant effects ranging from -5 to +5 logit-points . In Tunisia, we also find evidence of a positive Bizerte Governorate effect on recruitment, and a negative Sfax effect. Clearly, in order to be a recruit you must be subjected to unobserved area-level heterogeneity; individual-level covariates alone cannot counteract the underlying rarity of the event, as highlighted by the intercepts.
A21

Number of Recruits: Spatial Distribution

Residual: Spatial Distribution

6

-4 -2 0 2 4

4

2

0

(a)
Number of Recruits: Spatial Distribution

(b)
Residual: Spatial Distribution

-4 -2 0 2 4

0 5 10 15 20 25

(c)

(d)

Figure G.6: Spatial distribution of Egyptian observations (a) and residuals (b); Tunisian observations (c) and residuals (d) at the District level. (a) and (c) present the spatial distribution of recruits; areas for which we have only Arab-Barometer `control' observations are in grey, whilst white areas indicate instance in which we have neither controls nor cases.

A22

Rank College Education Age Married Student Low-Status P^r(r = 1)

1

1

22

1

1

1

0.00018

2

1

22

0

1

1

0.00016

3

1

27

1

1

1

0.00012

4

1

27

0

1

1

0.00010

5

1

22

1

0

1

0.00008

6

1

22

0

0

1

0.00007

7

1

22

1

1

0

0.00005

8

1

27

1

0

1

0.00005

9

1

35

1

1

1

0.00005

10

1

22

0

1

0

0.00005

Table G.1: Top 10 recruitable theoretical profiles, living in the average district, according to the Egypt model. Profiles are ordered by predicted probability of recruitment net of sampling protocol.

Rank College Education Age Married Student Low-Status P^r(r = 1)

1

1

21

0

0

0

0.05285

2

1

24

0

0

0

0.04525

3

1

21

1

0

0

0.04154

4

1

24

1

0

0

0.03551

5

0

21

0

0

0

0.01785

6

1

31

0

0

0

0.01765

7

0

24

0

0

0

0.01521

8

0

21

1

0

0

0.01392

9

1

31

1

0

0

0.01377

10

0

24

1

0

0

0.01185

Table G.2: Top 10 recruitable theoretical profiles, living in the average district, according to the Tunisia model. Profiles are ordered by predicted probability of recruitment net of sampling protocol.

A23

District Effect - Unstructured

District Effect - Spatial

-4 -2 0 2 4

-4 -2 0 2 4

(a)
District Effect - Total

(b)
Governorate Effect - Unstructured

-4 -2 0 2 4

-4 -2 0 2 4

(c)

(d)

Figure G.7: Egypt's Spatial distribution of: (a) the unstructured Governorate-level effect - ; (b) the spatial Governorate level effect - ; (c) the total Governorate effect -  = ( 1 - ) +  /s); (d) the unstructured Country effect - .

A24

District Effect - Unstructured

District Effect - Spatial

-4 -2 0 2 4

-4 -2 0 2 4

(a)
District Effect - Total

(b)
Governorate Effect - Unstructured

-4 -2 0 2 4

-4 -2 0 2 4

(c)

(d)

Figure G.8: Tunisia's Spatial distribution of: (a) the unstructured Governorate-level effect - ; (b) the spatial Governorate level effect - ; (c) the total Governorate effect -  = ( 1 - ) +  /s); (d) the unstructured Country effect - .

A25

0.15

0.10

Density

quantile: 0 q quantile: 0.1
quantile: 0.5 quantile: 0.9 quantile: 1
no college edu. age: 60
not married not a student
low status

no college edu. age: 60 married
not a student high status
q

no college edu. age: 35 married
not a student high status

college edu. age: 35 married student
low status
college edu. age: 22 married student
low status

0.05

0.00

-20

-15

-10

-5

logit probability of recruitment

Figure G.9: Worm's eye (Egypt) Distribution of the predicted probabilities' MCMC mean across a variety of hypothetical profiles. The distribution is presented on the logit scale to be more informative.

0.15

0.10

quantile: 0 q quantile: 0.1
quantile: 0.5 quantile: 0.9 quantile: 1
no college edu. age: 62
college edu. not married age: 62 student married high status student
low status q

college edu. age: 21
not married student
low status

college edu. age: 31 married
not a student high stcaotullsege edu.
age: 21 not married not a student high status

Density

0.05

0.00

-30

-25

-20

-15

-10

-5

0

logit probability of recruitment

Figure G.10: Worm's eye (Tunisia) Distribution of the predicted probabilities' MCMC mean across a variety of hypothetical profiles. The distribution is presented on the logit scale to be more informative.

A26

