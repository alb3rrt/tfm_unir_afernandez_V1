arXiv:2106.00607v1 [math.NA] 1 Jun 2021

Extended retraction maps: a seed of geometric integrators
M. Barbero-Lin~´an1 and D. Mart´in de Diego2
1Departamento de Matema´tica Aplicada, Universidad Polit´ecnica de Madrid, Av. Juan de Herrera 4, 28040 Madrid, Spain,
2Instituto de Ciencias Matema´ticas (CSIC-UAM-UC3M-UCM), C/Nicol´as Cabrera 13-15, 28049 Madrid, Spain
2 June 2021

Abstract
The classical notion of retraction map used to approximate geodesics is extended and rigorously defined to become a powerful tool to construct geometric integrators. Using the geometry of the tangent and cotangent bundles, we are able to tangently and cotangent lift such a map so that these lifts inherit the same properties as the original one and they continue to be extended retraction maps. In particular, the cotangent lift of this new notion of retraction map is a natural symplectomorphism, what plays a key role for constructing geometric integrators and symplectic methods. As a result, a wide range of numerical methods are recovered and canonically constructed by using different extended retraction maps, as well as some operations with Lagrangian submanifolds.
Keywords: retraction maps, symplectic methods, discrete variational calculus, canonical transformations of the tangent and cotangent bundles.
2020 Mathematics Subject Classification: 37M15, 65P10, 70G45, 53D22.

Contents

1 Introduction

2

2 Retraction maps

4

3 Lift of extended retraction maps

7

3.1 Tangent lift of retraction maps . . . . . . . . . . . . . . . . . . . 9

3.2 Cotangent lift of retraction maps . . . . . . . . . . . . . . . . . . 11

3.3 Duality between the cotangent and the tangent lift of extended

retraction maps . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14

3.4 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

1

1 Introduction 2

4 Retractions associated to SODEs

18

4.1 Newmark method from an extended retraction map . . . . . . . 19

4.2 Retraction maps associated with discrete second order equations 21

5 Construction of geometric integrators from retraction maps 22 5.1 Geometric integrators in Hamiltonian framework . . . . . . . . . 23 5.2 Geometric integrators in Lagrangian framework . . . . . . . . . . 26 5.3 Discrete variational calculus . . . . . . . . . . . . . . . . . . . . . 28

6 Composition of geometric integrators

29

6.1 Symplectic symmetric methods . . . . . . . . . . . . . . . . . . . 31

7 Conclusions and future work

32

7.1 Reduced systems and systems with holonomic constraints . . . . 32

7.2 Discrete gradient methods . . . . . . . . . . . . . . . . . . . . . . 33

7.3 Higher-order retractions and higher order lagrangian systems . . 33

7.4 Geometric integration of Dirac systems . . . . . . . . . . . . . . . 34

7.5 Morse families for Lagrangian submanifolds and symplectic in-

tegration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

A Lagrangian submanifolds

35

1 Introduction

The notion of retraction map is an essential tool in different research areas like

optimization theory, numerical analysis, interpolation (see [Absil, Mahony, and

Sepulchre 2008] and references therein). For instance, in optimization theory,

the goal is to find a value x in a differentiable manifold M such that f (x) is the

minimum of a function f : M  R. In the case that M is a linear space as Rn

equipped with the standard inner product, the notions of gradient or Hessian

of the function f are properly defined and give us useful local information to

localize the possible candidates to minimize f . Moreover, gradient descent or

Newton's method can also be used to search for a solution.

Riemannian geometry allows us to introduce similar concepts to gradient

and Hessian in a differentiable manifold paving the way for optimization. But

we need another important ingredient: how to move on a manifold. In Rieman-

nian geometry this notion is given by the exponential map. On a Riemannian

manifold (M, g) (or more generally a semi-Riemannian manifold) remember

that any geodesic  : I  R  M with initial velocity  (0) =  in the tan-

gent space of M at x, TxM , is locally obtained using the exponential map

expx : U  TxM  M by expx(t) = (t) (see for instance [do Carmo 1992]).

However, only in simple examples it is possible to explicitly compute the ex-

ponential map of a Riemannian manifold. Therefore, efficient approximations

of geodesics are crucial for designing algorithms on manifolds. Here is where

retraction maps play an important role (see [Absil and Malick 2012, Absil,

Mahony, and Sepulchre 2008] and references therein).

Roughly speaking, retraction maps provide a way to select a smooth curve

on a differentiable manifold given an initial position and velocity. Such a curve

is an approximation of the Riemannian exponential map. More specifically, a

retraction is typically defined as a local C1-map Rx : Ux  TxM  M such

that Rx(0x) = x and

d dt

t=0 Rx(t) = T0xRx() = 

for all   TxM , where we

1 Introduction 3

use the identification T0x TxM  TxM . Observe that, since we are using first order approximations, this definition is independent of the initial Riemannian

metric (see [Abraham and Marsden 1978]). However, for second or higher order

retractions the particular Riemannian metric does play a role. The property

d dt

t=0 Rx(t)

=



implies

that

dg(Rx(t), (t))

=

O(t2 ),

where

dg

denotes

the

Riemannian distance (see [Shub 1986]).

For our purposes we will need a more general definition of a retraction map.

We construct an extended retraction map Rd : U  T M  M ×M in Definition

2.2, where the image of   U is now two "nearby" points of M . As an example,

if we have a Riemannian manifold (M, g), with associated exponential map exp,

then

an

extended

retraction

map

is

Rd()

=

(expM

()

(-

1 2



),

expM

()

(

1 2

)),

where M : T M  M is the canonical projection. We precisely discuss the

properties of these extended retraction maps in Section 2. We understand such

maps as discretizations of the tangent bundle because they take values in two

copies of the configuration manifold. That is why they are denoted by Rd.

In numerical analysis, if we have a vector field X on M and we want to find

a numerical approximation of the integral curves, a natural idea is to use an

extended retraction map and consider the following first order discrete equation:

hX(M (Rd-1(xk, xk+1))) = Rd-1(xk, xk+1) .

(1.1)

Given an initial condition x0 we can solve the implicit system (1.1) to find a

sequence {xk} which is an approximation of {x(kh)}, where x(t) is the integral

curve of X with initial condition x0 and h is the time step. For instance, if

M is the vector space Rn and Rd(x, v) =

x

-

v 2

,

x

+

v 2

, then Equation (1.1)

becomes

xk+1 - xk h

=X

xk + xk+1 2

.

Our main interest in this article consists of designing numerical methods for second order differential equations (SODEs) and mainly for Hamilton's equations. For instance, a second order differential equation x¨ = f (x, x ) is geometrically represented by a special vector field

(x, x )

=

x

 x

+

f

(x,

x )

 x

,

which is now defined on the tangent bundle T M of M [Abraham and Marsden 1978]. These vector fields are called SODEs.
On the other hand, it is well-known that the classical Hamiltonian equations are defined on the cotangent bundle T M of the manifold M . Therefore, we face the problem of how, given a retraction map on M , we can lift it to the tangent and cotangent bundles.
In Section 3.1, we lift an extended retraction map on a manifold to the tangent bundle using the canonical involution. This tangent lift makes possible to define geometric discretizations of SODEs in Section 4.
In Section 3.2 we lift an extended retraction map on a manifold to the cotangent bundle using well-known constructions from symplectic geometry. We show in Section 3.3 that this cotangent lift is nothing else than the dual construction of the above-mentioned tangent lift. Moreover, it is essential to prove that the cotangent lift of an extended retraction map is always a symplectomorphism because that makes possible to construct symplectic integrators for Hamilton's equations and Euler-Lagrange equations in Section 5.

2 Retraction maps 4

In Section 3.4 we carefully work out a few examples of the extended retraction maps on different manifolds.
In Section 5.3 we compare the geometric integrators from Section 5.1 with the theory of discrete variational calculus [Marsden and West 2001].
Our definitions of cotangent lift of extended retraction maps combined with composition of Lagrangian submanifolds lead to the construction of general symplectic methods for Hamilton's equation in Section 6.
Along the paper we show how well-known geometric methods (Newmark, St¨ormer-Verlet, etc) are obtained using the new tools described here. Hence, the work developed in this paper opens the path to define geometric integrators for more complex mechanical systems that may include forced systems, system with constraints, optimal control problems, Dirac systems, etc. We have briefly described future research lines in Section 7. Appendix A summarizes the most important notions from symplectic geometry and composition of Lagrangian submanifolds used in the paper.

2 Retraction maps

A retraction map plays the role of generalizing the linear-search methods in Euclidean spaces to general manifolds. On a manifold with nonzero curvature to move along the tangent line does not guarantee that the motion stays on the manifold. The retraction map provides the tool to define the notion of moving in a direction of a tangent vector while staying on the manifold. That is why retraction maps have been widely used to construct numerical integrators of ordinary differential equations, since it allows us to move from a point and a velocity to one nearby point and then discretize the differential equation.
The first definition of retraction map found in the literature is the following one.
Definition 2.1. [Absil, Mahony, and Sepulchre 2008, Chapter 4] A retraction map on a manifold M is a smooth mapping R from the tangent bundle T M onto M . Let Rx denote the restriction of R to TxM , the following properties are satisfied:
1. Rx(0x) = x where 0x denotes the zero element of the vector space TxM .
2. With the canonical identification T0x TxM  TxM , Rx satisfies

DRx(0x) = T0x Rx = IdTxM ,

(2.1)

where IdTxM denotes the identity mapping on TxM .
The condition (2.1) is known as local rigidity condition since, given   TxM , the curve (t) = Rx(t) has  as tangent vector at x, i.e.

 (t) = DRx(t),  and, in consequence, (0) = IdTxM () =  .

This notion connects with the geometric interpretation of the exponential map exp on Riemannian manifolds given in [do Carmo 1992, Chapter 3.2]. Therefore the image of  through the exponential map is a point on the Riemannian manifold obtained by moving along a geodesic a length equal to the norm of  starting with the velocity /  , that is,

expx() = (  ) ,

2 Retraction maps 5

where  is the unit speed geodesic such that (0) = x and  (0) = /  . Remember that the exponential map is a typical example of a retraction
map. With all that in mind we are able to generalize the property of local rigidity in Definition 2.1 that allows a discretization of the tangent bundle of the configuration manifold opening a new path to construct numerical integrators.
After studying the contribution studied in [Cuell and Patrick 2009, Marrero, Mart´in de Diego, and Mart´inez 2016] we define a generalization of the retraction map in Definition 2.1. Given a point and a velocity, we obtain two nearby points that are not necessarily equal to the initial base point. As discussed in the sequel, numerical methods will be recovered from this new notion of retraction map.
Definition 2.2. A map Rd : U  T M  M × M given by
Rd(x, v) = (R1(x, v), R2(x, v)),

where U is an open neighborhood of the zero section of T M , defines an extended retraction map on M if it satisfies
1. Rd(x, 0) = (x, x), 2. T0x Rx2 - T0xRx1 : T0x TxM  TxM  TxM is equal to the identity map on
TxM for any x in M , where Rxi denotes the restrictions of Ri, i = 1, 2, to TxM .
If R1(x, v) = x, the two properties in Definition 2.2 guarantee that the both properties in Definition 2.1 are satisfied. Thus, as mentioned, Definition 2.2 generalizes Definition 2.1.
Proposition 2.3. Let Rd be an extended retraction map on M , Rd is a local diffeomorphism from some neighborhood of the zero section of T M .

Proof. Let (xi) be local coordinates for M centered at x, and (xi, vi) be the
corresponding induced coordinates on T M . By the definition of the extended retraction map, the Jacobian matrix of Rd at (xi, 0) is locally written as

Id Id

R1 Rv2 v

(x, (x,

0) 0)

,

where Id denotes the identity matrix. Note that the regularity of that Jacobian matrix is equivalent to the invertibility of the following matrix

Id 0

R2 v

R1 v
(x, 0)

(x, 0)

-

R1 v

(x,

0)

=

Id

R1 v

(x,

0)

0

Id

,

due to the property 2 in Definition 2.2. Therefore, the inverse function theorem guarantees that Rd is a local diffeomorphism from some neighborhood of the identity section to its image.

There is a general and interesting way to obtain extended retraction maps from the usual retraction maps. The following result is very useful for the Examples 2.6 and 2.7.

2 Retraction maps 6

Proposition 2.4. Let R : T M  M be a retraction map as in Definition 2.1. For any   [0, 1] the map Rd : T M  M × M given by
Rd(x, v) = (R(x, -v), R(x, (1 - )v))
is an extended retraction map on M .

Proof. From the definition of retraction map it is immediate that Rd(x, 0) = (R(x, 0), R(x, 0)) = (x, x) and T0x Rx2 - T0x Rx1 = (1 - ) T0x Rx +  T0xRx  IdTxM .

The extended retraction map can be associated with known numerical meth-
ods constructed from a retraction map. For step size h and retraction map Rh(x, v) = x + h v on the Euclidean space, one possible extended retraction map is Rdh(x, v) = (x, x + h v) that corresponds with a first order integrator method as described, for instance, in [McLachlan and Perlmutter 2006]. How-
ever, other extended retraction maps may be defined from the same retraction
map to construct different integrators. For example, for step size h and the above retraction map Rh we define:

Rdh(x, v) = (R-h/2(x, v), Rh/2(x, v)) ,

that corresponds with a second order method as described in [McLachlan and Perlmutter 2006].
Example 2.5. Let us provide some examples of retractions typically used in the literature for the construction of numerical methods, see [Iserles 2009], that can be associated with extended retractions maps satisfying the properties in Definition 2.2.

1. The explicit Euler method: Rd(x, v) = (x, x + v).

2. The midpoint rule: Rd(x, v) =

x

-

v 2

,

x

+

v 2

.

3. The -method: Rd(x, v) = (x -  v, x + (1 - ) v) where   [0, 1].

As known, for   {0, 1/2}, we recover the first two maps from the third one. All these methods are defined on the Euclidean vector space Rn.
Example 2.6. Given a Riemannian manifold (M, g) and the associated exponential map expx : TxM  M we can define the following map

Rd(x, ) = (expx(-/2), expx(/2)) ,

(2.2)

that satisfies the properties in Definition 2.2. Let us give some specific examples
of extended retraction maps that can be associated with the exponential map. For instance, on the sphere S2 with the Riemannian metric induced by the
restriction of the standard metric on R3 we have that

expx() = cos(  ) x + sin(  )

 

,

  TxS2 .

Thus we move along the greatest circle that are the geodesics on the sphere. Remember that expx(0x) = x and the exponential map is a continuous map. Hence, we can define the following extended retraction map on M :

Rd(x, ) = cos

 2

x - sin

 2

 

, cos

 2

x + sin

 2

 

.

(2.3)

3 Lift of extended retraction maps 7

Another option is to use as a retraction map on the sphere the projection

Rx() =

x+ x+

that leads to the following extended retraction map:

Rd(x, ) =

x - /2 x - /2

,

x + /2 x + /2

.

Proposition 2.4 for  = 1/2 guarantees that both maps are extended retraction maps.
Example 2.7. Consider a Lie group G and denote by g its Lie algebra. It is a fact that any element  in the Lie algebra is in one-to-one correspondence with a left-invariant vector field on G, X = TeLg(), where e is the identity element of G and Lg : G  G denotes the left-translation map. If  : R  G is an integral curve of X with initial condition (0) = e, then we can generate a map between the Lie algebra and the Lie group called the exponential map: exp() = (1). It is possible to check that the map R : T G  G given by

(g, X) - g exp(TgLg-1 (X))

is a retraction map where X(g)  TgG. Then, we define an extended retraction map on the Lie group G, Rd : T G  G × G, as follows

Rd(g, X) =

g exp

-

1 2

Tg

Lg-1

(X

)

, g exp

1 2

Tg

Lg-1

(X

)

.

The properties in Definitions 2.1 and 2.2 are satisfied because the tangent map Te exp is the identity map.
In the case of SO(3) = {A  GL(3, R) | AAT = AT A = Id3, det A = 1} we have that an element (A, X)  T SO(3) is given by a pair of matrices such that A  SO(3) and XAT + AXT = 0. Therefore, the Lie algebra so(3) is the set of skew-symmetric matrices:  = AT X  so(3). The above retraction map for SO(3) becomes:
R(A, X) = A exp(AT X) .
The exponential map could be replaced by the Cayley transformation:

cay : so(3) - SO(3)  - cay() = (Id3 - /2)-1(Id3 + /2) ,

where Id3 stands for the identity matrix. Then we define the following retraction map Rcay : T SO(3)  SO(3):
Rcay(A, X) = A cay(AT X) = A(Id3 - AT X/2)-1(Id3 + AT X/2) . (2.4)

As shown in Proposition 2.4, we obtain the following extended retraction map Rd,cay : T SO(3)  SO(3) × SO(3):

Rd,cay(A, X) = (Rcay(A, -X/2), Rcay(A, X/2)) = A(Id3 + AT X/4)-1(Id3 - AT X/4), A(Id3 - AT X/4)-1(Id3 + AT X/4) .

3 Lift of extended retraction maps
We can construct extended retraction maps, as described in Definition 2.2, on any manifold. When studying mechanical systems, it may be useful to define

3 Lift of extended retraction maps 8

extended retraction maps on the tangent bundle for the Lagrangian framework or on the cotangent bundle for the Hamiltonian framework. As extended retraction maps can be defined on different manifolds, we introduce the notation RdT M so that the superscript tells us the domain of such a map. Thus, the map RdT M : T M  M × M is called an extended retraction map on M . The name of the map emphasizes where the image takes values. Note that M could be equal to the tangent bundle T Q or to the cotangent bundle T Q depending on the dynamics under study.
Here, we are interested in constructing specific extended retraction maps on the tangent and cotangent bundle obtained from an extended retraction map on the base manifold. The objective is to generate geometric integrators for mechanical systems by using a suitable notion of lifted retraction maps to the tangent and cotangent bundles to encompass both the Lagrangian and the Hamiltonian framework.
We first review the notion of tangent and cotangent lift of a map between manifolds, see [Marsden and Ratiu 1999].
Let M1 and M2 be n-dimensional manifolds and F : M1  M2 be a smooth map. The tangent lift T F : T M1  T M2 of F is defined by

T F (vx) = TxF (vx)  TF (x)M2 ,

where vx  TxM1 ,

and TxF is the tangent map of F whose matrix is the Jacobian matrix of F at x  M1 in a local chart.
As the tangent map TxF is linear, the dual map TxF : TF(x)M2  TxM1 is defined as follows:

(TxF )(2), vx = 2, TxF (vx) for every vx  TxM1.
Note that (TxF )(2)  TxM1. To define the cotangent lift in Section 3.2, we need the cotagent lift of the
inverse of the extended retraction map. So, we fix the notation for such a cotangent lift.

Definition 3.1. Let F : M1  M2 be a diffeomorphism. The vector bundle morphism F : T M1  T M2 defined by
F = T F -1

is called the cotangent lift of F -1.

In other words, F (x) = TF(x)F -1(x) where x  TxM1. Obviously, (T F -1)  (T F ) = IdT M2 .
We quickly review here some notions from symplectic geometry, see Appendix A for more details. Denote by M : T M  M the canonical projection of the cotangent bundle and define the Liouville 1-form M  1(T M ) by M (x), Xx = x, Tx M (Xx ) where Xx  Tx T M and denote by M = -dM the canonical symplectic 2-form on T M . Thus (T M, M ) is a
symplectic manifold. For a diffeomorphism F : M1  M2, we recall the well-
known proposition for symplectic manifolds in [Libermann and Marle 1987].

Proposition 3.2. Let F : M1  M2 be a diffeomorphism. The cotangent

lift F : T M1  T M2 of F -1 is a symplectomorphism for the symplectic

manifolds (T M1, M1 ) form is preserved by the

and (T M2, pull-back of

F^M: 2

).

In other words, the symplectic 2-

F (M2 ) = M1 where F  : 2(T M2)  2(T M1) .

3.1 Tangent lift of retraction maps 9

Equivalently, the inverse of the cotangent lift F -1 : T M2  T M1 is also a symplectomorphism.
Some expressions in coordinates will be useful in the sequel. Take local coordinates q = (q1, . . . , qn) on M1 and x = (x1, . . . , xn) on M2 and induced coordinates (q, v) on T M1 and (x, u) on T M2, respectively. If F : M1  M2 is written in local coordinates as (q1, . . . , qn)  (F 1(q), . . . , F n(q)) Then

T F (q, v) =

F i(q) ;

F i qj

(q)vj

.

Taking now induced coordinates (q, p) on T M1 and (x, r) on T M2 we have that

F (q, p) =

F

i

(q);

pj



(F 

-1)j qi

(F

(q))

.

If we consider the matrices,

DqF =

F i qj

(q)

1i,jdim M1

and

DF (q)F -1 =



(F -1)i xj

(F

(q))

.
1i,jdim M2

Note that

DF (q)F -1 = [DqF ]-1 .

When we restrict the previous maps T F and F to a fiber we induce the maps

TqF : TqM1  TF (q)M2 v - DqF vT

and Fq :
Consequently,

TqM1  TF(q)M2 p - ((DqF )-1)T pT = p(DqF )-1 .
FF-(1q) : TF(q)M2  TqM1 r - rDqF .

(3.1)

3.1 Tangent lift of retraction maps
We prove that if we suitably lift the extended retraction map Rd : T Q  Q × Q on Q in Definition 2.2, we obtain a new extended retraction on the tangent bundle T Q. These constructions are able to provide a geometric framework to obtain numerical integrators for second-order differential equations (SODEs), see Section 4, and for the dynamics of mechanical systems as shown in Sections 5 and 6.
Remember that the notation RdT T Q for an extended retraction map on T Q makes clear the manifold to be discretized, that is, RdT T Q : T T Q  T Q × T Q. To define it from an extended retraction map Rd : T Q  Q × Q on Q is necessary to use the canonical involution map Q that shows the double vector bundle structure of the vector bundle T T Q and defines a vector bundle isomorphism, as described for instance in [Tulczyjew 1976a, Tulczyjew and Urban´ski 1999].
Let us recall here the definition of the canonical involution. Let Q be a smooth manifold of dimension n, Q : T Q  Q be the canonical tangent

3.1 Tangent lift of retraction maps 10

bundle projection and T T Q the double tangent bundle of Q. The manifold T T Q naturally admits two vector bundle structures. The first vector bundle structure is the canonical one with vector bundle projection T Q : T T Q  T Q. For the second vector bundle structure of T T Q, the vector bundle projection is given by T Q : T T Q  T Q. The canonical involution Q : T T Q  T T Q is a vector bundle isomorphism (over the identity of T Q) between the two previous vector bundles. In fact, Q is characterized by the following condition: let  : U  R2  Q be a smooth map on an open subset U of R2 defined by

(t, s)  (t, s)  Q,

then

Q

 t

 s

(t,

s)

=

 s

 t

(t,

s).

Note that Q is an involution of T T Q, that is, 2Q = IdT T Q. If (q, v) are canonical fibered coordinates of T Q and (q, v, q, v) are the corresponding local
fibered coordinates of T T Q, then

Q(q, v, q, v) = (q, q, v, v).
Having all this in mind, remember that the tangent lift of a vector field X on Q does not define a vector field on T Q. It is necessary to consider the composition Q  T X to obtain a vector field on T Q that is called complete lift Xc of the vector field X. A similar trick must be used to lift an extended retraction map from T Q to T T Q as shown in the following diagram.

T TO Q
Q Q
 TTQ

RTd

/ TQ×TQ

O

TRd / T (Q × Q)

T Q

Q×Q

 TQ

Rd

 / Q×Q

The following proposition shows that TRd  Q is an extended retraction map on T Q. Note that T (Q × Q) and T Q × T Q are trivially identified. From now on, such a map is denoted by RdT to emphasize it is obtained by tangently litfing Rd.
Proposition 3.3. If Rd is an extended retraction map on Q, then RdT = TRd  Q is an extended retraction map on T Q.

Proof. In local coordinates (q, v, q, v) of T T Q we have that TRd(q, v, q, v) = (Rd(q, v), D(q,v)Rd(q, v) (q, v )T ) and

RdT (q, q, v, v ) = (Rd(q, v), D(q,v)Rd (q, v )T ) .

Remember the abuse of notation because T (Q × Q) and T Q × T Q are trivially identified.
Let us prove that the properties in Definition 2.2 are satisfied.

3.2 Cotangent lift of retraction maps 11

1. As Rd is an extended retraction map on Q such that Rd(vq) = (R1(vq), R2(vq)) for vq  TqQ. We know that Rd(q, 0) = (q, q) for all q  Q. Consequently, D0q Ri = Idn×n for all i = 1, 2. Thus,

RdT (q, q, 0, 0) = (Rd(q, 0), D(q,0)Rd (q, 0)T ) = (q, q, q, q)  (q, q; q, q) ,

where we use the natural identification between T (Q × Q) and T Q × T Q.
2. For the second property, knowing that Rd(q, v) = (R1(q, v), R2(q, v)) we write RdT (q, q, v, v) = ((T R1)(q, v; q, v), (T R2)(q, v; q, v)) .
We need to compute

T(0,0)(q,q) (TRi)(q,q) : T(0,0)(q,q) T(q,q)T Q  T(q,q)T Q  T(q,q)T Q ,

for i = 1, 2, to prove that the map T(0,0)(q,q) (TR2)(q,q)-T(0,0)(q,q) (TR1)(q,q) is the identity map understood as an application from T(q,q)T Q to itself.

At (q, q, 0, 0), the linear map T(0,0)(q,q) (TRi)(q,q) is given by the following

matrix

vRi(q, 0) qvRi(q, 0)

0 vRi(q, 0)

.

Using again the properties of the extended retraction map Rd, the Jacobian matrix of T(0,0)(q,q) (TR2)(q,q) - T(0,0)(q,q) (TR1)(q,q) is:

vR2(q, 0) - vR1(q, 0) q(vR2(q, 0) - vR1(q, 0))

0 vR2(q, 0) - vR1(q, 0)

= Id2n×2n ,

as needed. Note that qv(R2 - R1)(q, 0) = 0 because v(R2 - R1)(q, 0) = Idn×n.

Remark 3.4. If we use the retraction map obtained from the exponential map of a Riemmanian metric g as in Equation (2.2), then the tangent lift of this specific retraction map is associated with the complete lift of g, denoted by gC , which is a semi-riemannian metric on T Q (see details in [Yano and Ishihara 1973, Anahory Simoes, Marrero, and Mart´in de Diego 2020]).

3.2 Cotangent lift of retraction maps

To encompass the Lagrangian and Hamiltonian dynamics together to build numerical integrators, we are interested in defining a very particular notion of
extended retraction map on the cotangent bundle.
Given a extended retraction map Rd : T Q  Q × Q we know that the cotangent lift Rd : T T Q  T (Q × Q) is a symplectomorphism between the symplectic manifolds (T T Q, T Q) and (T (Q × Q), Q×Q) as mentioned in Proposition 3.2.
According to Definition 3.1, in local coordinates (q, v, pq, pv) for T T Q the cotangent lift of Rd is given by:

Rd :

T T Q - T (Q × Q)

(q, v, pq, pv) - Rd(q, v), (pq, pv) (D(q,v)Rd)-1

3.2 Cotangent lift of retraction maps 12

where (D(q,v)Rd)-1 is the inverse of the Jacobian matrix of Rd.
We use the cotangent lift Rd of the extended retraction map on Q to define an extended retraction map on T Q that must be a map from T T Q to T Q × T Q.
For this purpose it is necessary to use the canonical symplectomorphism Q : T T Q  T T Q between double vector bundles (see [Tulczyjew 1976b, Tulczyjew and Urban´ski 1999]). Locally,

Q :

T T Q - T T Q

(q, p, q, p) - (q, q, p, p).

As described in [Tulczyjew 1976b], the symplectomorphism Q is between the sympletic manifold (T T Q, dT Q) and the natural symplectic manifold (T T Q, T Q). Recall that in local coordinates (q, p, q, p) for T T Q, the symplectic form dT Q has the following expression: dT Q = dq  dp + dq  dp. Moreover, we need the diffeomorphism
 : T Q × T Q - T (Q × Q) (q0, p0; q1, p1) - (q0, q1, -p0, p1)
which is also a symplectomorphism between (T (Q × Q), Q×Q) and (T Q × T Q, 12 = pr2Q - pr1Q), where pri : T (Q × Q)  T Q × T Q denotes the projection into the i­th factor of the cartesian product in the image.
The following diagram shows how to define the extended retraction map on T Q from the one on Q.

T T Q
Q
 T T Q

RTd  / T Q × T Q O
-1
Rd / T (Q × Q)

T Q

Q×Q

 TQ

Rd

 / Q×Q

Now we prove that RdT  is an extended retraction map on T Q according to Definition 2.2. From now on, it will be called the cotangent lift of Rd. Proposition 3.5. Let Rd : T Q  Q × Q be an extended retraction map on Q as in Definition 2.2. Then RdT  = -1  Rd  Q : T T Q  T Q × T Q is an extended retraction map on T Q.

Proof. Let us compute the cotangent lift of the tangent map of Rd for local coordinates (q, v, pq, pv) of T T Q:

Rd(q, v, pq, pv) = Rd(q, v), (pq, pv)(D(q,v)Rd)-1 .

Expressing the inverse of (DRd)-1 as a matrix with two blocks (DRd)-i 1  M2n×n, i = 1, 2, that is
(D(q,v)Rd)-1 = (D(q,v)Rd)-1 1 (D(q,v)Rd)2-1

and

(D(q,v)Rd)-1 =

qR1(q, v) qR2(q, v)

vR1(q, v) vR2(q, v)

-1
.

3.2 Cotangent lift of retraction maps 13

We can write

RdT


(q,

p,

q,

p)

=

R1(q, q), -(p, p)(D(q,q)Rd)-1 1; R2(q, q), (p, p)(D(q,q)Rd)-2 1

.

Let us check if it satisfies the properties in Definition 2.2:

1. Note that the Jacobian matrix of Rd at (q, 0) is

D(q,0)Rd =

Id Id

vR1(q, 0) vR2(q, 0)

.

As vR2(q, 0) - vR1(q, 0) = Id, the inverse is

(D(q,0)Rd)-1 =

Id + vR1(q, 0) -Id

-vR1(q, 0) Id

.

Thus,

RdT  (q, p, 0, 0) = (R1(q, 0), -(0, p)(D(q,0)Rd)-1 1; R2(q, 0), (0, p)(D(q,0)Rd)-2 1) ,

and it is straightforward that RdT (q, p, 0, 0) = (q, p; q, p).

2.

We must prove that T(q,p,0,0)

RdT 

2 (q,p)

-T(q,p,0,0)

RdT 

1 (q,p)

is

the

identity

map from T(q,p,0,0)T T Q  T(q,p)T Q to itself.

Let us compute the following derivatives for i = 1, 2:

d dt t=0

RdT 

i
(q, p, tq, tp) .

For instance, for i = 1 we have

d dt t=0

RdT 

1
(q, p, tq, tp)

=

d dt

t=0

R1(q, tq), -(tp, p)(D(q,tq)Rd)-1 1

.

Using the expression for the derivative of an inverse matrix, we have that

d dt

(D(q,tq)Rd)-1
t=0

is

equal

to

-

Id + A -Id

-A Id

vqR1(q, 0) vvR1(q, 0) vqR2(q, 0) vvR2(q, 0)

Id + A -A -Id Id

=





vvR1(q, 0) - vvR2(q, 0) vvR2(q, 0) - vvR1(q, 0)

where A = vR1(q, 0) and () denotes terms that are not explicitly needed in the computations. We have used that qv(R2 - R1)(q, 0) = 0 since v(R2 - R1)(q, 0) = Idn×n. Thus,

d dt

t=0

R1(q, tq), -(tp,

p)(D(q,tq)Rd)1-1

=

vR1(q, 0) p(vvR1(q, 0) - vvR2(q, 0))

0 -Id - vR1(q, 0) T

q p

Analogously,

d dt

t=0

R2(q, tq), (tp, p)(D(q,tq)Rd)-2 1

=

vR2(q, 0) p(vvR1(q, 0) - vvR2(q, 0))

0 - vR1(q, 0) T

q p

3.3 Duality between the cotangent and the tangent lift of extended retraction maps 14

As a result,

vR2(q, 0) C

0 -vR1(q, 0)

-

vR1(q, 0) C

0 -Id - vR1(q, 0)

=

Id 0

0 Id

where C = p(vvR1(q, 0) - vvR2(q, 0)).

As the composition of symplectomorphisms is a symplectomorphism [Libermann and Marle 1987], the following result is straightforward.

Proposition 3.6. Let Rd : T Q  Q × Q be a retraction map on Q, then RdT  = -1  Rd  Q : T (T Q)  T Q × T Q is a symplectomorphism between (T (T Q), dT Q) and (T Q × T Q, 12).

As a consequence,

RdT 


(12) = dT Q .

The above result is essential to obtain symplectic methods in the following
sections.
When constructing numerical integrators in Section 5 for Hamiltonian systems, the inverse map of RdT  : T T Q  T Q×T Q is useful. Using Proposition 3.5 we specifically write the inverse map

RdT 

-1

=

-Q1



-1
Rd





:

T

Q

×

T

Q



T

T

Q

.

In local coordinates (q0, p0; q1, p1) for T Q × T Q and using (3.1), it is quite simple to compute the inverse map

RdT  -1 (q0, p0; q1, p1) = -Q1 Rd-1(q0, q1), (-p0, p1) DR- d 1(q0,q1)Rd . (3.2) Remember that Q-1(q, v, pq, pv) = (q, pv, v, pq).

3.3 Duality between the cotangent and the tangent lift of extended retraction maps

After introducing both the tangent and cotangent lift of extended retraction
maps, we show here the existing duality between the two maps. For an extended retraction map on Q, we consider the tangent lift RdT :
T T Q  T Q × T Q defined by RdT = T Rd  Q and the corresponding cotangent lift RdT  = -1  Rd  Q : T T Q  T Q × T Q. As mentioned earlier, T T Q is a symplectic manifold with the 2-form dT Q that induces a natural pairing as follows. Let v  T T Q and let w  T T Q such that T Q(w) = T Q(v), the pairing ·, · T induced by the symplectic structure of T T Q is given by

v, Q(w)

T

=

d dt

v(t), w~(t) (0) =

Q(v), w

,

where Q : T T Q  T T Q, v : I  T Q and w~ : I  T Q satisfy  v(0) = v and  w~(0) = w~ with w~ = Q(w) and Q  v = Q  w~.

3.4 Examples 15

Proposition 3.7. The tangent lift and the cotangent lift of an extended retraction map on Q satisfy the following equality:

(q0 , q1 ), RdT (w) =

RdT 

-1
(q0 , q1 ), w

T
,

where w  T T Q, (Rd)-1(q0, q1) = T Q(w) and the pairing ·, · T is induced by the symplectic structure of T T Q.

Proof. Observe that

(q0 , q1 ), RdT (w)

=

-1
(Rd  )(q0 , q1 ), Q(w)

=

(Q)-1

-1

T

Rd   (q0 , q1 ) , w

=

RdT 

-1
(q0 , q1 ), w

T
.

3.4 Examples

We resume Examples 2.5, 2.6, 2.7 to construct the lifts of extended retractions
maps described in the previous sections. In other words, we define extended retraction maps on T Q and T Q starting from an extended retraction map on Q.

Example 3.8. We focus now on the mid-point rule described in Example 2.5 to

define the tangent and cotangent lift of that extended retraction map. Assume

that Q is a vector space and let Rd : T Q  Q × Q be the extended retraction

map induced by the mid-point rule as follows Rd(q, v) =

q

-

1 2

v,

q

+

1 2

v

.

If

we compute the inverse map Rd-1(q0, q1) =

q0

+ 2

q1

,

q1

-

q0

, we construct

the sequence of points that will be used either for optimization or numerical

integration as the discrete flow

d : Q × Q  Q

(q0, q1) 

Q  Rd-1 (q0, q1) = Q

q0

+ 2

q1

,

q1

-

q0

=

q0

+ q1 2

.

Thus, the mid-point rule is recovered.

To define the tangent lift of the extended retraction map RdT : T T Q 

T Q × T Q on T Q we first need to compute the tangent map whose matrix is

 DRd = Id
Id

-1221IdId .

The tangent lift of Rd is given by:

RdT (q, q, v, v) = (T Rd  Q) (q, q, v, v) = T Rd(q, v; q, v)

=

q

-

1 2

v, q +

1 2

v;

q -

1 2

v ,

q

+

1 2

v ,



q

-

1 2

v, q -

1 2

v ;

q+

1 2

v,

q

+

1 2

v ,

,

3.4 Examples 16

where we naturally identify elements of T (Q × Q) with elements of T Q × T Q. We can also compute the inverse map:

RdT -1 (q0, v0; q1, v1) =

q0

+ 2

q1

,

v0

+ 2

v1

;

q1

-

q0,

v1

-

v0

.

To compute the cotangent lift of Rd, that it, RdT  : T T Q  T Q × T Q, we

first need the tangent map of the inverse map Rd-1(q0, q1) =

q0

+ 2

q1

,

q1

-

q0

:

DRd-1 =

1 2

Id

-Id

1 2

Id

Id

.

Thus the cotangent lift of Rd-1 is given by:

Rd(q, v, pq, pv) = Rd(q, v), (pq, pv)(D(q,v)Rd-1)

=

q

-

1 2

v,

q

+

1 2

v;

pq 2

-

pv ,

pq 2

+ pv

.

Finally, the cotangent lift of Rd is the following extended retraction map on T Q:

RdT  (q, p, q, p) = -1  Rd  Q (q, p, q, p) = -1  Rd (q, q, p, p)

= -1

q

-

1 2

q,

q

+

1 2

q;

p 2

-

p,

p 2

+

p

=

q-

1 2

q, p -

p 2

;

q+

1 2

q,

p

+

p 2

.

(3.3)

The inverse map RdT  -1 : T Q × T Q  T T Q is given by:

RdT T Q

-1
(q0, p0; q1, p1) =

q0

+ 2

q1

,

p0

+ 2

p1

,

q1

-

q0,

p1

-

p0

.

(3.4)

Example 3.9. Let us lift the extended retraction map in Example 2.6. To simplify the computations we consider the retraction map that fixes the first point (compared with (2.3)) as follows

 Rd(x, ) = x, cos (  ) x + sin (  )  .

Remember that x · xT = 1 and x · T = 0 because the manifold Q is the sphere S2.
The tangent map of Rd is given by the matrix

D(x,)Rd =

Id cos (  ) Id

0 N (x, )

,

where

Nij

= - sin (



)

j xi 

+

cos

(



)

j i 

+

sin

(



 



2 - i 3

i

,

for i = j ,

)

·



-i 

j
3

,

for i = j ,

3.4 Examples 17

are the entries of the invertible matrix N (x, ). Thus, the tangent lift of Rd is the following extended retraction map on T Q:

RdT (x, x , , ) = (T Rd  Q) (x, x , , ) = T Rd(x, ; x , )

=

x, cos (  ) x + sin (  )

 

, x , cos(



) x + N (x, ) 



x, x ; cos (  ) x + sin (  )

 

, cos(  ) x + N (x, ) 

.

To compute the tangent

the cotangent lift of map of the inverse

Rd, map

RRdTd-1:

T T Q  T Q × or, equivalently,

T Q, we first need the inverse of the

tangent map:

DRd-1 = (DRd)-1 =

Id - cos(  ) N -1

0 N -1

.

Thus the cotangent lift of Rd-1 is given by: Rd(x, , px, p) = Rd(x, ), (px, p) D(x,)Rd -1 .
Finally, the extended retraction map on T Q is obtained as follows:

RdT  (x, p, x , p) = -1  Rd  Q (x, p, x , p) = -1  Rd (x, x , p, p)

= -1

x, cos ( x ) x + sin ( x )

x x

; p - cos ( x ) pN -1, p N -1



x, -p + cos ( x ) pN -1 ; cos ( x ) x + sin ( x )

x x

, p N -1

.

Example 3.10. Let us lift the extended retraction map in Example 2.7. As in the previous example, to simplify the computations we consider the extended retraction map Rd,cay : T SO(3)  SO(3) × SO(3) that fixes the first point (compared with (2.4)) as follows:

Rd,cay(A, X) = A, A cay(AT X) = A, A Id3 - AT X/2 -1 Id3 + AT X/2 .

The tangent map of Rd,cay is given by the matrix

D(A,X)Rd,cay = =

Id

cay(AT

X)

+

A

d dA

cay(AT

X)

X

Id M

0 N

.

0

A

d dX

cay(AT

X)

AT

Thus, RdT,cay(A, A , X, X ) = (T Rd,cay  Q) (A, A , X, X ) = T Rd(A, X, A , X ) = A, A cay(AT X), A, M A + N X  A, A; A cay(AT X), M A + N X ,

4 Retractions associated to SODEs 18

where N is an invertible matrix. To compute the extended retraction map RdT,cay : T T Q  T Q × T Q on T Q as the cotangent lift of Rd, we first need the tangent map of the inverse map Rd-,1cay or, equivalently, the inverse of the tangent map:

DRd-,1cay = (DRd,cay)-1 =

Id -N -1M

0 N -1

.

Thus the cotangent lift of Rd-,1cay is given by:

Rd,cay(A, X, pA, pX ) = Rd,cay(A, X), (pA, pX ) (DRd,cay)-1 (A, X) .

Finally, the extended retraction map on T Q is obtained as follows:

RdT,cay(A, p, A , p) = -1  Rd,cay  Q (A, p, A , p) = -1  Rd,cay (A, A , p, p) = -1 A, A cay(AT A ), p - pN -1M, pN -1 = A, pN -1M - p; A cay(AT A ), pN -1 .

4 Retractions associated to SODEs

The tangent lift of extended retraction maps defined in Section 3 appears nat-
urally when geometrically designing discretizations of second order differential
equations (SODEs). Remember that a second order differential equation is a
vector field  such that T Q() = T Q(). This implies that the vector field  is a section of the second order tangent bundle T (2)Q, as described in [de Le´on and Rodrigues 1985]. Locally, if we take coordinates (qi) on Q and induced coordinates (qi, qi) on T Q, then



=

qi

 qi

+

i

(q

,

q)

 qi

.

To find the integral curves of  is equivalent to solve the following system of second order differential equations:

d2qi dt2

=

i

q,

dq dt

.

Now, we want to discretize these equations using the notion of extended retraction map defined on T Q as in Definition 2.2. Here we have two options: we could directly define an extended retraction map on T Q denoted by RdT T Q : T T Q  T Q × T Q or we could tangently lift an extended retraction map on Q to obtain RdT : T T Q  T Q × T Q as defined in Proposition 3.3.
Let us consider in general that we have an extended retraction map on T Q,
RdT T Q : T T Q  T Q × T Q ,
given by RdT T Q(q, v, q, v) = RT T Q 1 (q, v, q, v ), RT T Q 2 (q, v, q, v ) . Note that RT T Q i (q, v, q, v )  T Q for i = 1, 2.

4.1 Newmark method from an extended retraction map 19

A first option for discretizing a SODE  consists of the following implicit discrete equation:

RT T Q 2  h (qk, vk) = RT T Q 1  h (qk+1, vk+1) ,

(4.1)

where h is a positive small real number that determines the step size. The numerical method starts from the initial data (qk, vk)  Tqk Q, then the Equation (4.1) is solved implicitly to obtain (qk+1, vk+1)  Tqk+1Q. Section 4.1 shows that an extended retraction map on T Q, not coming from a tangent lift, recovers Newmark method using the discretization method in (4.1). Geometrically, these methods given in (4.1) are based on the structure of groupoid of an implicit difference equation, in this case T Q × T Q  T Q (see [Iglesias-Ponte, Marrero, Mart´in de Diego, and Padro´n 2013] for more details).
A second option for discretizing a SODE consists of the following numerical scheme:

h

T Q  RdT T Q -1

(qk, vk; qk+1, vk+1)

=

RdT T Q

-1
(qk, vk; qk+1, vk+1) .

(4.2) As in (4.1), the numerical method is usually implicit. We will focus on this discretization process in Sections 4.2 and 5 when constructing geometric integrators for mechanical systems.
Let us do a simple example to show that the numerical schemes in (4.1) and (4.2) are usually different.

Example 4.1. Consider the extended retraction map on T Q obtained from a tangent lift in Example 3.8 and the inverse map:

RdT (q, q, v, v ) =

q

-

1 2

v,

q

-

1 2

v

;

q

+

1 2

v

,

q

+

1 2

v

,

RdT -1 (q0, v0; q1, v1) =

q0

+ 2

q1

,

v0

+ 2

v1

;

q1

-

q0,

v1

-

v0

.

The method in Equation (4.1) becomes:

qk+1 - qk h

=

vk + vk+1 2

,

vk+1 - vk h

=

1 2

((qk ,

vk )

+

(qk+1,

vk+1))

.

However, for the same extended retraction map on T Q the method in (4.2) is given by the following equations:

qk+1 - qk h

=

vk + vk+1 2

,

vk+1 - vk h

=



qk

+ qk+1 2

,

vk

+ vk+1 2

.

4.1 Newmark method from an extended retraction map

An example of discretization using Equation (4.1) is the Newmark method [New-

mark 1959], a classical time-stepping method very common in structural me-

chanical codes. For simplicity, we consider a typical mechanical Lagrangian

L : T Rn - R:

L(q, q)

=

1 2

qM

qT

-

V (q) ,

4.1 Newmark method from an extended retraction map 20

where (q, q)  T Rn, M is a positive definite constant matrix and V is a potential function. The corresponding Euler-Lagrange equations are:

q¨ = -M -1V (q) ,

(4.3)

where  denotes the gradient of the potential function. The Newmark methods are widely used in simulations of such mechanical
systems, including even external forces [Kane, Marsden, Ortiz, and West 2000]. To construct the method two real parameters  and  are selected so that the algorithm determines (qk+1, qk+1) in terms of (qk, qk) as follows:

qk+1

=

qk

+

hqk

+

h2 2

((1

-

2)ak

+

2ak+1)

qk+1 = qk + h ((1 - )ak + ak+1) ,

(4.4)

where ak = -M -1V (qk) and ak+1 = -M -1V (qk+1). We show here that the family of Newmark methods can be obtained from
an extended retraction map on the tangent bundle T Q. Let us define RdT T Q : T T Rn  R4n  T Rn × T Rn  R2n × R2n by

RT T Q 1 (q, v, q, v ) =

q

-

1 2

q

+

1 2

(

-

2 )v ,

v

-

v

,

RT T Q 2 (q, v, q, v ) =

q

+

1 2

q

+

1 2

(

-

2 )v ,

v

+

(1

-

)v

.

The Jacobian matrix of RdT T Q is



Id



0 Id

0 Id 0

-

1 2

Id

0

1 2

Id

0 Id

0

1 2

(

-

2)

Id

- Id

1 2

(

-

2)

Id

 

.

(1 - ) Id

It is straightforward that RdT T Q satisfies both properties in Definition 2.2. Hence, RdT T Q is an extended retraction map on T Q.
The Euler-Lagrange equations (4.3) can be rewritten as the submanifold S of T (2)Q  T T Q,
S = {(q, q, a) | a = -M -1V (q)} ,

with the natural inclusion i : T (2)Q  T T Q, i(q, q, a) = (q, q, q, a). Hence, the dynamics induced by the Newmark method is equivalent to the
following algorithm:
1. Take an initial position and velocity (qk, qk). 2. Evaluate ak = -M -1V (qk).
3. Solve the system obtained from (4.1):

RT T Q 2 (qk, qk; hqk, hak) = RT T Q 1 (qk+1, qk+1; hqk+1, hak+1) , (4.5) where ak+1 = -M -1V (qk+1).

4.2 Retraction maps associated with discrete second order equations 21

Observe that Equation (4.5) is equal to

qk

+

h 2

qk

+

h2 2

(

-

2)ak

=

qk+1

-

h 2

qk+1

-

h2 2

(

-

2)ak+1

,

qk + h(1 - )ak = qk+1 - hak+1 .

After algebraic manipulation, they are equivalent to the well-known Newmark
method in Equation (4.4). Notet that if  = 1/2 and  = 1/4, then RdT T Q is precisely the tangent lift of
the extended retraction map on Q coming from the mid-point rule as described
in Example 3.8.

4.2 Retraction maps associated with discrete second order equations
In this section we briefly discuss the possibility to find a discrete version of a second order differential equation (SODE) using a second order discrete equation (SOdE).
According to [Marsden and West 2001], a SOdE is given by a map d : Q × Q  Q × Q × Q × Q such that
d(q0, q1) = (q0, q1, q1, ~d(q0, q1)) .
Given an extended retraction map on Q and a second order vector field , we wonder if, under any assumption, the tangent lift of the extended retraction map, RdT , could define a discrete second order equation d. The specific question is: When does an extended retraction map Rd make Diagram (4.6) commutative?

TTQ

RTd

/ TQ×TQ

T

Q

IdTQ/ ;

T

T
 Q

Q

(Rd ,Rd )
 Q×Q×Q×Q

R- d 1 O  Rd d5

Q×Q

(4.6)

Proposition 4.2. Let Q be a vector space and  be a SODE. If Rd : T Q  Q × Q is the extended retraction map on Q defined from the -method:

Rd(q, v) = (q -  v, q + (1 - ) v),

(4.7)

then Diagram (4.6) is commutative, that is,

(Rd, Rd)  RdT    Rd-1 : Q × Q  Q × Q × Q × Q

defines a second order discrete equation (SOdE).

Proof. Let (q, v) local coordinates for T Q. Let Rd(q, v) = Rd1(q, v), Rd2(q, v) , we compute

RdT   (q, v) = T(q,v)Rd1((q, v)), T(q,v)Rd2((q, v)) .

5 Construction of geometric integrators from retraction maps 22

If we apply now (Rd, Rd) : T Q × T Q  Q × Q × Q × Q, the resulting expression

defines a SOdE if and only if the second and third component are equal, that

is,

Rd2(T(q,v)Rd1((q, v))) = Rd1(T(q,v)Rd2((q, v))).

(4.8)

It is a straightforward computation to verify that the extended retraction maps defined from the -method in (4.7) satisfy Equation (4.8).

In fact, the above proposition could be stated more generally. Any extended retraction map that satisfies Equation (4.8) defines a SOdE by the tangent lift of that map.
Equation (4.8) is equivalent to the commutativity of the following diagram:

T (2)Q  T T Q T R2d O

TQ



 T (2)Q  T T Q

T R1d

/ TQ
R1d
 Q O
R2d
/ TQ

(4.9)

In particular, if the extended retraction map Rd : T Q  Q × Q is defined from a standard retraction map as in Definition 2.1, that is, Rd1 = Q, then Diagram (4.9) becomes

T (2)Q  T T Q T R2d O



TQ

Q



 T (2)Q  T T Q

T R1d

/ TQ
R1d
 /Q
O
R2d
/ TQ

since (Q  T Rd2)() = (Rd2  T Q)(). Therefore any standard retraction map defines a SOdE d.

5 Construction of geometric integrators from
retraction maps
In this section we describe how geometric integrators are obtained for both Hamiltonian and Euler-Lagrange equations by discretizing their equations using extended retraction maps. In Section 5.3, we establish the relation with discrete variational calculus where the variational principles are discretized to obtain the discrete flow (see [Marsden and West 2001]).
In Section 5.1 we look at the Hamiltonian framework [Abraham and Marsden 1978]. Hamiltonian systems have the property that the associated flow is a symplectic transformation. As described in [Sanz-Serna and Calvo 1994, Hairer, Lubich, and Wanner 2010, Blanes and Casas 2016], it is important to define numerical methods that also preserve that property. Remember that a

5.1 Geometric integrators in Hamiltonian framework 23

numerical one-step method is called symplectic if the one-step map, in other
words, the discrete flow, is symplectic whenever the method is applied to a
smooth Hamiltonian system.
Second, we describe geometric integrators obtained from the Lagrangian
viewpoint in Section 5.2.
In order to describe Hamiltonian and Lagrangian mechanics, we consider the symplectic manifold (T Q, Q) that has the musical isomorphisms Q : X(T Q)  1(T Q) defined by Q (X) =  where iX Q =  (see for instance [Libermann and Marle 1987]). The inverse of Q is denoted by Q , that is, Q = (Q )-1.

5.1 Geometric integrators in Hamiltonian framework
Let H : T Q  R be a Hamiltonian function with corresponding Hamiltonian vector field XH derived from Hamilton's equations:

iXH Q = dH .

The triple (T Q, Q, H) defines a Hamiltonian system. Equivalently, an integral curve of XH is solution to Hamilton's equations:

dqi dt

=

H pi

,

dpi dt

=

-

H qi

,

where (qi, pi) are canonical coordinates on T Q (see [Abraham and Marsden 1978]). In other words, a solution  : I  T Q of Hamilton's equations must satisfy

Q ( (t)) = dH((t)) , equivalently  (t) =  (dH((t))) . An extended retraction map on T Q, that is, RdT T Q : T (T Q)  T Q × T Q defines the following numerical integrator for step size h:

RdT T Q -1 (q0, p0; q1, p1) =  h dH

T Q  RdT T Q -1 (q0, p0; q1, p1)

.

Equivalently, similar to Equation (4.2), we have

(5.1)

h XH

T Q  RdT T Q -1

(q0, p0; q1, p1)

=

RdT T Q

-1
(q0, p0; q1, p1).

(5.2) This numerical integrator may be defined for any extended retraction map on T Q. However, if such a map is the cotangent lift of an extended retraction map of Q (see Section 3.2), then the numerical integrator is symplectic as stated in the following proposition.

Proposition 5.1. Let Rd : T Q  Q × Q be an extended retraction map on Q and H : T Q  R be a Hamiltonian function. Equation (5.1) written for the cotangent lift of Rd, that is, RdT  , defines a symplectic integrator of the Hamiltonian system (T Q, Q, H).

Proof. Lagrangian submanifolds are defined in Appendix A. As the submanifold dH T Q  RdT  -1 (q0, p0; q1, p1) in Equation (5.1) is Lagrangian on

5.1 Geometric integrators in Hamiltonian framework 24

(T T Q, T Q), Proposition 3.6 guarantees that Equation (5.1) determines a Lagrangian submanifold of (T Q × T Q, 12). Locally, such a manifold can be expressed as the graph of a local symplectomorphism  : T Q  T Q, see [Libermann and Marle 1987] for more details. Consequently, the geometric method obtained from Equation (5.1) is symplectic.

Let us use the above result to obtain some of the symplectic numerical methods known in the literature.
Example 5.2. Let H : T Q  R be a Hamiltonian function, the cotangent lift (3.3), (3.4) of the extended retraction map associated to the mid-point rule in Example 3.8 used in Equation (5.1) leads to the following equations:

q0

+ 2

q1

,

p0

+ 2

p1

,

q1

-

q0,

p1

-

p0

=

q0

+ 2

q1

,

p0

+ 2

p1

,

h

H p

q0

+ 2

q1

,

p0

+ 2

p1

,

-h

H q

q0

+ 2

q1

,

p0

+ 2

p1

.

Equivalently, the equations describe the following symplectic integrator:

q1 - q0 h

=

H p

q0

+ 2

q1

,

p0

+ 2

p1

,

p1 - p0 h

=

-

H q

q0

+ 2

q1

,

p0

+ 2

p1

.

The above integrator corresponds with an implicit second-order symplectic method with initial condition (q0, p0).
Example 5.3. The extended retraction map on Q, Rd(q, v) = (q - v, q) , is lifted to the cotangent bundle as follows

RdT  :

T T Q -

T Q × T Q

(q, p, q, p) - (q - q, p, q, p + p) .

As RdT  -1 (q0, p0, q1, p1) = (q1, p0, q1 - q0, p1 - p0), Equation (5.1) leads to the following symplectic method:

q1 - q0 h

=

H p

(q1,

p0)

,

p1 - p0 h

=

-

H q

(q1, p0)

.

For

a

Hamiltonian

H(p, q)

=

1 2

pM

pT

+V

(q),

with

M

a

constant

positive

definite

matrix, the integrator is an explicit symplectic method.

Example 5.4. Now consider a Hamiltonian function H : T S2  R on T S2 that we identify with the tangent bundle T S2:

T S2  {(x, p)  R3 × R3 | x = 1, x · p = 0} .

For the discretization of the corresponding Hamiltonian equations we will use the retraction map Rd : T S2  S2 × S2 given by

Rd(x, ) =

x,

x+ x+

,

5.1 Geometric integrators in Hamiltonian framework 25

whose inverse is precisely:

Rd-1(x0, x1) =

x0,

x1 x0 · x1

- x0

,

whenever it is well defined. Now, we will compute the inverse of the cotangent lift of the extended retraction map given in Equation (3.2), that is,

RdT  -1 (x0, p0; x1, p1) = -Q1 Rd-1(x0, x1), (-p0, p1) DR- d 1(x0,x1)Rd .
Having in mind the definition of T S2, it can be computed that the matrix DR- d 1(x,y)Rd is equal to:

DR- d 1(x,y)Rd =

Id3×3 0 (x · y) Id3×3 C

where C is the matrix with entries

cij =

(x · y) 1 + (x · y)yixi - yi2 (x · y) [(x · y)yixj - yiyj]

if i = j, if i = j .

Therefore,

RdT 

-1
(x0, p0; x1, p1) =

x0, p1C ;

x0

1 ·

x1

x1

- x0, -p0

+ (x0

· x1)p1

.

As a result, we obtain the following symplectic integrator for Hamilton's equations:

xk

1 · xk+1

xk+1

-

xk

=

h

H p

(xk ,

pk+1 C )

,

-pk

+

(xk

·

xk+1 )pk+1

=

-h

H q

(xk ,

pk+1 C )

.

Remark 5.5. Another option to construct geometric integrators is to use an expression similar to (4.1) but now adapted for Hamiltonian vector fields, that is,

RdT T Q

2
 hXH

(qk, pk) =

RdT T Q

1
 hXH

(qk+1, pk+1) .

Note that here the extended retraction map on T Q does not have to be the cotangent lift of one on Q. However, even if the cotangent lift is considered, the method is not necessarily symplectic. For instance, for the extended retraction map coming from the mid-point rule in Examples 2.5 and 3.8, we obtain the symmetric second-order method:

qk+1 - qk h

=

1 2

H p

(qk ,

pk )

+

H p

(qk+1,

pk+1 )

,

pk+1 - pk h

=

-

1 2

H q

(qk ,

pk )

+

H q

(qk+1, pk+1)

.

However, this method is not symplectic because, in general, dqk+1  dpk+1 - dqk  dpk = 0 when restricted to the numerical scheme..

5.2 Geometric integrators in Lagrangian framework 26

Remark 5.6. Observe that our method give us a constructive way to derive symplectic integrators for Hamiltonian systems. It will be interesting to compare our methods with other previous approaches ([Leok and Zhang 2011]), specially when the configuration space is a Lie group and we can use wellknown retraction maps such as exponential maps and other approximations. See [Iserles, Munthe-Kaas, Nø rsett, and Zanna 2000, Bou-Rabee and Marsden 2009, Celledoni, Marthinsen, and Owren 2014, Bogfjellmo and Marthinsen 2016].

5.2 Geometric integrators in Lagrangian framework
Let us consider a regular Lagrangian function L : T Q  R so that there exists a second-order vector field L on T Q and Euler-Lagrange equations are given by
iL L = dEL,
where EL is the energy function and L is the symplectic Lagrange 2-form obtained by the pull-back of the Legendre map F L : T Q  T Q of the natural symplectic form on T Q, that is, L = (F L)Q (see [Abraham and Marsden 1978] for more details).
As in (4.2), an extended retraction map on T Q, that is, RdT T Q : T T Q  T Q × T Q, defines the following numerical integrator:

RdT T Q h L

T Q  RdT T Q -1 (q0, v0; q1, v1)

= (q0, v0; q1, v1). (5.3)

Equivalently,

h L

T Q  RdT T Q -1

(q0, v0; q1, v1)

=

RdT T Q

-1
(q0, v0; q1, v1).

As the Lagrangian function is regular, we could move to the Hamiltonian framework and construct a symplectic numerical integrator using the cotangent lift of a retraction map on Q as in Proposition 5.1. It remains to prove if the obtained numerical integrator is an extended retraction map on T Q as described in Definition 2.2.
Remember that the manifold (T Q×T Q, 1L-0L) is symplectic. Locally, the symplectic 2-form is given by 1L -0L = (F L-1, F L-1)(dqi1 dp1i -dqi0 dp0i ).
Proposition 5.7. Let Rd : T Q  Q × Q be an extended retraction map on Q and L : T Q  R be a regular Lagrangian function. The two following facts are satisfied:
(a) the map RdL = (F L-1, F L-1)  RdT   T F L : T T Q  T Q × T Q defines a symplectic numerical integrator of the Euler-Lagrange equations for L;
(b) the above-mentioned map RdL is an extended retraction map on T T Q.
Proof. First, we prove property (a). As the Lagrangian function is regular, the Legendre map is a local diffeomorphism. Propositions 3.2 and 5.1 guarantee that RdL is a symplectomorphism because it is a composition of symplectomorphisms. Hence, RdL defines a symplectic numerical integrator in Equation (5.3).
The diagram below shows the constructive process for RdL:

5.2 Geometric integrators in Lagrangian framework 27

T Q × T Q

(F L-1,F L-1)

/ TQ×TQ

fRTd T T Q o TFL

sssRsLdssssss9

TTQ

Q×Q

O
XH
T Q o FL

O LsssRssdsssss9 TQ

In other words, the Lagrangian submanifold Im L of T T Q, (T F L) (dT Q) is preserved by RdL and the numerical method in Equation (5.3) is symplectic.
For (b), we must prove the properties in Definition 2.2 for the map RdL : T T Q  T Q × T Q.

1. Note that RdL(vq, 0vq ) = (vq, vq) because

RdL(vq, 0vq ) = (F L-1, F L-1)  RdT  F L(vq); 0FL(vq) = (F L-1, F L-1) (F L(vq); F L(vq)) = (vq, vq) .

The second equality is true because RdT  is an extended retraction map on T Q as shown in Proposition 3.5.

2.

We must prove that T(q,v,0,0)

RdL

2 (q,v)

-

T(q,v,0,0)

RdL

1 (q,v)

is

the

identity

map from T(q,v,0,0)T T Q  T(q,v)T Q to itself.

Let us first compute it for i = 1, 2:

d dt

F L-1
t=0

RdT 

i
(T F L) (q, v, t q, t v)

=DF

L-1

(q,

L v

)

T(q,

L v

,0,0)

RdT 

i
D3,4 (T F L)(q,v,0,0)

Note that D3,4 (T F L)(q,v,0,0) is the fiber derivative of the tangent map T F L. Knowing that the tangent map is linear on the fiber, together with the fact that RdT  is an extended retraction map on T Q and it satisfies the second property in Definition 2.2, we can conclude that the map RdL satisfies the second property for being an extended retraction map on T Q.

It can be proved that only for a very specific extended retraction map Rd on Q and Lagrangian function, the retraction map RdL of T T Q is the tangent lift of Rd.

Corollary

5.8.

Let

L(q, v)

=

1 2

vT

Mv

-

V

(q)

be

the

Lagrangian

function,

being M a positive-definite symmetric constant mass matrix and V the potential

function. If Rd : T Q  Q × Q is the extended retraction map on Q given by the mid-point rule in Example 2.5, then RdL is the tangent lift of Rd.

Proof. The Legendre transformation for L in the corollary is F L(q, v) = (q, M v) and the inverse map is F L-1(q, p) = (q, M -1p). Thus,

RdL(q, v, q, v ) = Rd1(q, q), -(v , v)DRd-1(q, q),1; Rd2(q, q), (v , v)DRd-1(q, q),2

5.3 Discrete variational calculus 28

where A,i denotes the ith column of the matrix A. This expression is equal to the tangent lift RdT if
-(v , v)DRd-1(q, q),1 = D(q,v)Rd1(q, v)(q, v)T (v , v)DRd-1(q, q),2 = D(q,v)Rd2(q, v)(q, v)T .
Both equalities are satisfied if the extended retraction map Rd is given by the mid-point rule, see Example 2.5.
Example 5.9. Let us consider a Lagrangian second-order vector field given by q¨ = -M -1 V (q). The numerical method in Equation (5.3) for the mid-point rule described in Example 3.8 becomes:

RdT

h L

q0 + q1 , v0 + v1

2

2

= (q0, v0, q1, v1)

RdT

q0

+ 2

q1

,

v0

+ 2

v1

,

h(q1

-

q0),

-h

M

-1

V

q0 + q1 2

= (q0, v0, q1, v1) .

Given (q0, v0), the numerical integrator is defined implictly by

v0 + v1 2

=

q1

- q0 h

,

v1 - v0 h

= -M -1 V

q0 + q1 2

.

After some straightforward computations, we obtain that this discrete method is rewritten as an implicit second order discrete equation given by:

q2

- 2q1 + q0 h2

=

-

1 2

M

-1

V

q0 + q1 2

+V

q1 + q2 2

In the next subsection we will explore the relation of these methods with discrete variational calculus.

5.3 Discrete variational calculus

As mentioned in [Marsden and West 2001], a usual way to design symplectic integrators from a Lagrangian system consists of discretizing the variational principle using a discrete Lagrangian map. Many of these discrete maps are obtained from a continuous Lagrangian map and a retraction map on Q by discretizing the continuous action as follows

S(q0, q1) =

h
L(q(t), q(t)) dt  hL
0

1 h

Rd-1(q0,

q1

)

= Lhd (q0, q1) ,

where q(t) is the unique solution of the Euler-Lagrange equations such that

q(0) vq 

= Tq

q0 Q

and then

q(h) = q1

1 h

Rd-1

(q0,

with q1) =

h
1 h

enough small. Observe that if Rd-1(q0, q1) = vq  TqQ. Therefore, the discrete Lagrangian

Lhd : Q × Q  R is defined by Lhd = h

L



1 h

Rd-1

.

If we consider the Hamiltonian function H(p, q) = p, q -L(q, q) then we can

simultaneously consider the discretization of both the Lagrangian and Hamil-

tonian framework. The following diagram is commutative by construction (see

6 Composition of geometric integrators 29

[Tulczyjew 1976a] for the left-hand side of the diagram):

T

QohXHFLhTTd- Q> LT1TTQOO QQo

o o

1 h

(RTd



)-1

1 h

Rd

-1

1 h

R- d 1

T Q × T Q O
-1
T (Q × Q) O
dLhd
Q×Q

In

this

diagram

we

understand

that

the

multiplication

by

1/h

in

1 h

Rd-1

is

with

respect respect

to to

the the

vector vector

bundle bundle

structure structure

given by Q : T Q  given by T Q : T T

Q, Q

h1 RTd-Q1

with and

1 h

(RdT



)-1

with

respect

to

T Q

:

T T Q



T Q.

Therefore, we have that

RdT 

hXH

FL

1 h

Rd-1(qk

,

qk+1

)

= -1

hdL

1 h

(Rd-1

)(qk

,

qk+1

)

= -1 d Lhd (qk, qk+1) .

(5.4)

Using the previous equation and (5.2) we obtain

-1 d Lhd (qk, qk+1) = (qk, pk; qk+1, pk+1)

(5.5)

and the discrete variational equations in [Marsden and West 2001] are recovered:

pk = -D1Lhd (qk, qk+1) , pk+1 = D2Lhd (qk, qk+1) .

These equations lead to the well-known discrete Euler-Lagrange equations:

D1Lhd (qk, qk+1) + D2Lhd (qk-1, qk) = 0 .

Example 5.10. Given a regular Lagrangian L : T Q  R, where Q is a vector

space and consider as discrete Lagrangian Lhd (q0, q1) = hL

, q0+q1 q1-q0

2

h

Us-

ing Example 3.8, the left-hand side of Equation (5.4) and the right-hand side

of (5.5), we obtain the following integrator:

pk+1 - pk h

=

L q

qk

+ qk+1 2

,

qk+1 - h

qk

,

pk + pk+1 2

=

L q

qk

+ qk+1 2

,

qk+1 - h

qk

.

6 Composition of geometric integrators
The construction of symplectic integrators based on extended retraction maps is closely related to the notion of Lagrangian submanifolds, as already appears in Section 5. For instance, Equation (5.2) defines the following Lagrangian submanifold of the symplectic manifold (T Q × T Q, 12)
Lh = (q, q )  T Q × T Q | (q, q ) = RdT  (h XH (q ))

6 Composition of geometric integrators 30

where q = (T Q  RdT  -1)(q, q )  T Q. Now, we will use some well-known properties of Lagrangian submanifolds as
the composition of Lagrangian submanifolds (see Appendix A and [Guillemin and Sternberg 1990] for more details) to describe a particularly elegant method to construct high-order methods from a given low-order integrator (see Hairer, Lubich, and Wanner [2010]). To be more precise, we are going to geometrically describe the composition of two (or more) geometric integrators defined by different extended retraction maps. As a particular example, we will recover the well-known St¨ormer-Verlet method, a second-order symplectic method.
Let Rd,1 and Rd,2 : T Q  Q × Q be two extended retraction maps on Q and H : T Q  R be a Hamiltonian function, using Equation (5.2) we define two Lagrangian submanifolds of (T Q × T Q, 12) as follows:

Lh1/2 = (qk, pk; qk+1/, pk+1/2)  T Q × T Q |  k,k+1/2  T Q s. t.

(qk, pk; qk+1/2, pk+1/2) = RdT,1

h 2

XH

k,k+1/2

,

Lh2/2 = (qk+1/2, pk+1/2; qk+1, pk+1)  T Q × T Q |  k+1/2,k+1  T Q s. t.

(qk+1/2, pk+1/2; qk+1, pk+1) = RdT,2

h 2

XH

k+1/2,k+1

,

where k,k+1/2 = T Q  RdT,1 -1 (qk, pk; qk+1/2, pk+1/2)  T Q ,
k+1/2,k+1 = T Q  RdT,2 -1 (qk, pk; qk+1/2, pk+1/2)  T Q .

After some technical conditions of clean intersection (see [Guillemin and Sternberg 2013]) we compose the above two Lagrangian submanifolds,

Lh2/2  Lh1/2 = (q, q )  T Q × T Q |  q  T Q with (q, q )  Lh1/2, (q , q )  Lh2/2 ,

obtaining an immersed Lagrangian submanifold. Thus, it generates a new symplectic integrator. Moreover, it is possible to compose more than two Lagrangian submanifolds to generate more involved methods where the intermediate points q play the role of micro-nodes (see [Marsden and West 2001, Leok and Shingel 2012, Campos 2014]).
Example 6.1. Let Q = Rn, we consider the two extended retraction maps Rd,1(q, v) = (q, q + v) and Rd,2(q, v) = (q - v, q). Then, we compute their corresponding cotangent lifts, RdT,1 and RdT,2 as described in Section 3.2, and obtain

Lh1/2 = Lh2/2 =

(qk, pk; qk+1/2, pk+1/2)

pk+1/2 qk+1/2

= =

pk qk

- +

h2h2 pqHH((qqkk,,

pk+1/2) pk+1/2)

(qk+1/2, pk+1/2; qk+1, pk+1)

pk+1

=

pk+1/2

-

h 2

q

H

(qk+1,

pk+1/2)

qk+1

=

qk+1/2

+

h 2

pH

(qk+1

,

pk+1/2 )

6.1 Symplectic symmetric methods 31

The composition Lh2/2 Lh1/2 gives a new symplectic integrator that corresponds with the St¨ormer-Verlet method [Hairer, Lubich, and Wanner 2010]:

pk+1/2

=

pk

-

h 2

q

H

(qk,

pk+1/2) ,

qk+1

-

h 2

p

H

(qk+1

,

pk+1/2

)

=

qk

+

h 2

p

H

(qk,

pk+1/2 )

,

pk+1

=

pk+1/2

-

h 2

q

H

(qk+1,

pk+1/2)

.

When discrete Lagrangian functions are given as in Section 5.3, Equations (5.2) and (5.5) can be expressed as Lagrangian submanifolds of (T Q × T Q, 12) and many of the methods described in [Marsden and West 2001, Leok and Shingel 2012] are recovered.
For instance, for a small positive step size h, we consider the following two
extended retraction maps on Q, Rd,i : T Q  Q × Q:

Rd,1

q,

h 2

v

=

q,

q

+

h 2

v

,

with inverse

Rd-,11(q0, q1) =

q0,

q1 - q0 h/2

,

Rd,2

q,

h 2

v

=

q

-

h 2

v,

q

,

with inverse

Rd-,12(q0, q1) =

q1,

q1 - q0 h/2

.

We define the discrete Lagrangian functions Ld,i = h L  (Rd,i)-1 : Q × Q  R such that the image of (-1  dLd,i) define the Lagrangian submanifolds Li of the symplectic manifold (T Q × T Q, 12). The submanifolds Li define a discrete dynamical system whose equations are locally described by
Li = {(q0, p0; q1, p1)  T Q × T Q | p0 = -D1Lid(q0, q1), p1 = D2Lid(q0, q1)} .
The composition
L2  L1 = {(1, 2) |  1/2  T Q s. t. (1, 1/2)  L1 , (1/2, 2)  L2} .
has associated the dynamics given by the discrete Lagrangian L3d(q0, q2) = L1d(q0, q1) + L2d(q1, q2), that plays the role of generating function (see also [de Le´on, Jim´enez, and Mart´in de Diego 2012]). The discrete equations are
p0 = -D1L1d(q0, q1) , 0 = D2L1d(q0, q1) + D1L2d(q1, q2) , p2 = D2L2d(q1, q2) .

6.1 Symplectic symmetric methods
If we have a Lagrangian submanifold L of (T Q×T Q, 12), then the transpose L defined by
L = {(q, q )  T Q × T Q | (q , q)  L} is also a Lagrangian submanifold of (T Q × T Q, 12).
For a Hamiltonian function and an extended retraction map on T Q, we consider the following Lagrangian submanifold used in the previous section:
Lh = (q, q )  T Q × T Q |  q  T Q s. t. (q; q ) = RdT  (h XH (q )) .

7 Conclusions and future work 32
As described in [Hairer, Lubich, and Wanner 2010, Marsden and West 2001], the composition of symplectic methods (seen here as Lagrangian submanifolds) gives rise to new symplectic methods. For instance, the Lagrangian submanifold
Lh/2  Lh/2 
is another way to interpret the St¨ormer-Verlet method considered in the previous section. Definition 6.2. A symplectic method defined by Lh is symmetric if
Lh  = L-h .
Proposition 6.3. Let  : Q × Q  Q × Q be the inversion map defined by (q, q) = (q, q). If Rd(vq) = (Rd(-vq)) for all vq  TqQ, then Lh is symmetric.
Proof. Observe that
(Lh) = (q , q)  T Q × T Q |  q  T Q s. t. (q ; q ) = RdT  (h XH (q )) .
As RdT  = -1  Rd  Q : T T Q  T Q × T Q is the cotangent lift of Rd, we have
RdT  (XH (q )) = -1    Rd  Q (-XH (q )) = T Q RdT  (-XH (q ))
where T Q : T Q × T Q  T Q × T Q is the corresponding inversion on T Q. Thus, we immediately deduce that (Lh) = L-h.
7 Conclusions and future work
In this paper we have introduced the lift of a new notion of retraction maps to tangent and cotangent bundles which are the phase spaces of mechanical systems. These lifts allow us to derive geometric integrators for systems defined by a Lagrangian or Hamiltonian function. Standard constructions in symplectic geometry, as well as properties of Lagrangian submanifolds, create a geometric framework to obtain several well-known symplectic integrators. Our geometric point of view opens the door for new types of applications of retraction maps, as well as, for the construction of geometric (symplectic) integrators following simple rules (lifting of retractions, composition and generating functions for Lagrangian submanifolds, etc). Now, we will mention some promising future research lines.
7.1 Reduced systems and systems with holonomic constraints
The notion of lift of retraction maps can be easily extended to the Lie algebroid setting using the Lie algebroid prolongation [de Le´on, Marrero, and Mart´inez 2005]. This theory covers all the examples of reduced systems by symmetry groups. Therefore, combining both constructions we can directly apply our

7.2 Discrete gradient methods 33

results to the construction of geometric integrators for Lagrangian or Hamiltonian functions invariant under the action of a symmetry Lie group [Weinstein 1996, Marrero, Mart´in de Diego, and Mart´inez 2006]. It is also well-known how to produce geometric integrators for systems subject to holonomic constraints. Thus, it will be interesting to produce constrained geometric integrators using our approach and compare them with [Leimkuhler and Reich 2004, McLachlan, Modin, Verdier, and Wilkins 2014].

7.2 Discrete gradient methods

In general for ordinary differential equations in Rn in skew-gradient form, i.e. x = (x)H(x) where x  Rn and (x) is a skew-symmetric matrix, it is
clear that H is a first integral. Using discretizations of the gradient H(x)
it is possible to define a class of integrators that preserve exactly the first
integral H (see [Gonzalez 2000, McLachlan, Quispel, and Robidoux 1999]). They are defined as follows: let H : Rn  R be a differentiable function, then H : R2N - RN is a discrete gradient of H if it is continuous and satisfies

H(x, x)T (x - x) = H(x) - H(x) , H(x, x) = H(x) ,

for all x, x  Rn , for all x  Rn .

(7.1)

For a Hamiltonian system H : T Q  R, we can generalize the previous construction by using an extended retraction map RdT T Q : T T Q  T Q×T Q on a general differentiable manifold T Q. We define a discrete gradient as a map
dH : T Q × T Q - T T Q that makes the following diagram commutative

T Q × T Q
RdT T  Q -1
 T T Q

dH T Q

/ T T Q
T Q
 / T Q

Similar to (7.1), dH must verify the following properties:

dH(x, x), RdT T Q -1 (x, x) = H(x) - H(x) , dH(x, x) = dH(x) ,

for all x, x  T Q , for all x  T Q .

In this case, an energy preserving integrator would be

RdT T Q

-1
(x, x) = (x)(dH (x, x))

where x = TQ

RdT T Q

-1
(x, x)

.

We will explore this possibility in

a future paper (see also [Celledoni, Marthinsen, and Owren 2014, Celledoni, Eidnes, Owren, and Ringholm 2020], for the case of extension to manifolds, in special, Riemannian manifolds).

7.3 Higher-order retractions and higher order lagrangian systems
Another topic to explore is the use of higher-order retraction maps since in this paper we have only focused on first-order retraction maps. Remember that,

7.4 Geometric integration of Dirac systems 34

for instance, a second-order retraction map Rx : T M  M on a Riemannian

manifold M is a retraction map such that, for all x  M and all   TxM ,

the

curve

c(t)

=

Rx(t)

has

zero

acceleration

at

t

=

0,

that

is,

d2c dt2

(0)

=

0,

mimicking the case of Riemannian geodesics [Absil, Mahony, and Sepulchre

2008, Absil and Malick 2012, Boumal, Absil, and Cartis 2019]. It would be

interesting to study the relation of higher-order retractions with the order of

the obtained numerical methods.

Another topic of interest is related with the discretization of higher-order

Lagrangian systems L : T (k)Q  R using appropriate higher-order lifts of

retraction maps. These constructions will be useful for interpolation problems

on manifolds and for optimal control problems (see [Crouch and Silva Leite

1995, Gay-Balmaz, Holm, Meier, Ratiu, and Vialard 2012, Colombo, Ferraro,

and Mart´in de Diego 2016]).

7.4 Geometric integration of Dirac systems
Dirac structures were introduced in [Courant and Weinstein 1988, Courant 1990] as a way to unify presymplectic and Poisson geometries giving a way to collect in the same geometric framework many situations of interest in mechanics and mathematical physics. As an example we can think of the Dirac structure D  T T Q  T T Q induced by the canonical symplectic structure Q, that is
D = {(Xq , q )  T T Q  T T Q | iXq Q = q } .
For a Hamiltonian system H : T Q  R, we can write Hamilton's equations as

Xq  dH(q)  Dq ,

(7.2)

with q  TqQ. As studied in the literature, Dirac structures are more general than the above example. They can be given by a Poisson tensor, for instance, or could not satisfy the integrability condition admitting new generalizations as in the case of nonholonomic constraints (see [Barbero Lin~a´n, Cendra, Garc´ia Toran~o, and Mart´in de Diego 2019]). Moreover, it is also interesting to study the case of Dirac systems where the dynamics is not induced by a function on the cotangent bundle (as in the case of standard Hamiltonian dynamics), but for a general Lagrangian submanifold S of (T T Q, T Q) (as in the case of singular Lagrangians, optimal control theory, etc). Now, Equation (7.2) must be replaced by
Xq  Sq  Dq .
Extended retraction maps could also be used here to deduce geometric integrators. Let Rd : T Q  Q × Q be an extended retraction map on Q, the cotangent lift of Rd defines the following geometric integrator

RdT 

-1
(qk , pk; qk+1, pk+1)  Sk,k+1  Dk,k+1

where T Q (RdT  )-1(qk, pk; qk+1, pk+1) = k,k+1. We will study in a forthcoming paper the design of Dirac integrators using the lift of the retraction maps, their geometrical properties (preservation of the associated presymplectic foliation, etc.) and compare them with other approaches on this topic ([Leok and Ohsawa 2011, Leok and Shingel 2012]).

7.5 Morse families for Lagrangian submanifolds and symplectic integration 35
7.5 Morse families for Lagrangian submanifolds and symplectic integration
In this paper it is clear the close relationship between the design of different symplectic methods and the construction of Lagrangian submanifolds. The notion of a Morse family or phase function was introduced in [Ho¨rmander 1971] (see also [Weinstein 1979]) and it is possible to prove that locally any Lagrangian submanifold is the image of a Lagrangian immersion generated by a Morse family. In a recent paper [Barbero Lin~a´n, Cendra, Garc´ia Toran~o, and Mart´in de Diego 2019], we have combined Dirac structures and Morse families to obtain a geometric formalism that unifies most of the scenarios in mechanics (constrained calculus, nonholonomic systems, optimal control theory, higher-order mechanics, etc.), as the examples in the paper show. Employing the techniques introduced here we aim to study the construction of geometric integrators for all the above-mentioned cases, as well as, the notion of Morse family to construct new geometric integrators.
A Lagrangian submanifolds
We review here the main properties of Lagrangian submanifolds needed in the paper. More details can be found in [Libermann and Marle 1987, Weinstein 1971, Guillemin and Sternberg 2013].
A symplectic manifold (M, ) is a differentiable manifold M with a nondegenerate closed 2-form  on M . Therefore, for each x  M , (TxM, x) is a symplectic vector space and, in particular, M is even dimensional. The vector bundle isomorphisms  =  : T M  T M and  = ()-1 : T M  T M are defined fiberwise.
Let (M, ) be a symplectic manifold. An immersed submanifold, or immersion, f : N  M is Lagrangian if so is the space T f (TxN ) as a subspace of Tf(x)M , for each point x  N . Note that an immersion f : N  M is Lagrangian if only if f  = 0 and the dimension of N is half the dimension of M.
A fundamental example of a symplectic manifold is the cotangent bundle T Q of an arbitrary manifold Q. It is equipped with a canonical exact symplectic structure Q = -dQ where Q is the canonical 1-form on T Q, defined as follows. Denote by Q : T Q  Q the canonical projection, then
(Q)q (Xq ) = q, Tq Q(Xq ) ,
where Xq  Tq T Q, q  T Q and q  Q. In canonical bundle coordinates (qi, pi) on T Q the projection reads Q(qi, pi) = qi, and one finds easily that Q has coordinate expression Q = pidqi. The 2-form Q = -dQ is a symplectic form on T Q whose local expression is
Q = dqi  dpi .
Darboux's theorem states that for an arbitrary symplectic manifold (M, ), there exist local coordinates (qi, pi) in a neighbourhood of each point in M such that  = dqi  dpi. It follows that all symplectic manifolds are locally isomorphic.
As described in [S´niatycki and Tulczyjew 1972/73, Guillemin and Sternberg 2013] two symplectic manifolds can be composed to construct a Lagrangian

REFERENCES 36

submanifold in the product of symplectic manifolds. Let (Mi, i) be symplec-

tic manifolds. A Lagrangian relation, where M1- denotes

submanifold L of the manifold M1

M1- × M2 is called a with the symplectic

canonical form -.

Thus L is a subset of M1 × M2 and is a Lagrangian submanifold for the sym-

plectic form 2 - 1. Any symplectomorphism f : M1  M2 defines a canonical

relation with the graph of f , Lf .

If L1  M1 × M2 and L2  M2 × M3, the composition L2  L1 is a subset

of M1 × M3 such that for any (1, 3)  L2  L1 there exists 2  M2 such

that (1, 2)  L1 and (2, 3)  L2. Let pri2 : Li  M2 be the projection of

Li onto M2. Let F  M1 × M2 × M2 × M3 be given by the inverse image of

the diagonal set M2 = {(2, 2)} through (pr12 × pr22)-1, that is,

F = (pr12 × pr22)-1(M2 ) .

This set is not guaranteed to be a submanifold and the restriction of 13 : M1 × M2 × M2 × M3  M1 × M3 to F is not necessarily an embedding. As a set it is true that L2  L1 = 13(F ).
Theorem A.1. [Guillemin and Sternberg 2013, Chapter 4.1, Theorem 8] If the canonical relations L1 and L2 intersect cleanly, then their composition L2  L1 is an immersed Lagrangian submanifold of M1- × M2.
Theorem A.2. [Guillemin and Sternberg 2013, Chapter 4.2, Theorem 10] If the canonical relations L1 and L2 intersect cleanly and the projection 13 restricted to F onto M1 × M3, denoted by , is proper and the inverse image of every point in L2  L1 by  is connected, then L2  L1 is a canonical relation and  is a smooth fibration with compact connected fibers.

When the hypotheses of the previous theorem are satisfied, it is said that L2 and L1 are composable.
Consequently, two Lagrangian submanifolds of the original two symplectic manifolds can be composed to obtain a Lagrangian submanifold in the new space.

Acknowledgements
The authors acknowledge financial support from the Spanish Ministry of Science and Innovation, under grants PID2019-106715GB-C21, the Spanish National Research Council, through the "Ayuda extraordinaria a Centros de Excelencia Severo Ochoa" R&D (CEX2019-000904-S) and I-Link Project (Ref: linkA20079) from CSIC (CEX2019-000904-S). MBL has been financially supported by "Programa propio de I+D+I de la Universidad Polit´ecnica de Madrid: Ayudas dirigidas a j´ovenes investigadores doctores para fortalecer sus planes de investigaci´on".

References
R. Abraham and J.E. Marsden. Foundations of mechanics. Benjamin/Cummings Publishing Co. Inc. Advanced Book Program, Reading, Mass., 1978. Second edition, revised and enlarged, With the assistance of Tudor Ra¸tiu and Richard Cushman.

REFERENCES 37
P.-A. Absil and J. Malick. Projection-like retractions on matrix manifolds. SIAM J. Optim., 22(1):135­158, 2012. ISSN 1052-6234. doi: 10.1137/ 100802529. URL https://doi.org/10.1137/100802529.
P.-A. Absil, R. Mahony, and R. Sepulchre. Optimization algorithms on matrix manifolds. Princeton University Press, Princeton, NJ, 2008. ISBN 978-0-691-13298-3. doi: 10.1515/9781400830244. URL https://doi.org/10.1515/9781400830244. With a foreword by Paul Van Dooren.
A. Anahory Simoes, J. C. Marrero, and D. Mart´in de Diego. Jacobi fields in nonholonomic mechanics. arXiv:2004.10457v2, 2020.
M. Barbero Lin~a´n, H. Cendra, E. Garc´ia Toran~o, and D. Mart´in de Diego. Morse families and Dirac systems. J. Geom. Mech., 11(4): 487­510, 2019. ISSN 1941-4889. doi: 10.3934/jgm.2019024. URL https://doi.org/10.3934/jgm.2019024.
S. Blanes and F. Casas. A concise introduction to geometric numerical integration. Monographs and Research Notes in Mathematics. CRC Press, Boca Raton, FL, 2016. ISBN 978-1-4822-6342-8.
G. Bogfjellmo and H. Marthinsen. High-order symplectic partitioned Lie group methods. Found. Comput. Math., 16(2):493­530, 2016. doi: 10.1007/ s10208-015-9257-9. URL https://doi.org/10.1007/s10208-015-9257-9.
N. Bou-Rabee and J. E. Marsden. Hamilton-Pontryagin integrators on Lie groups. I. Introduction and structure-preserving properties. Found. Comput. Math., 9(2):197­219, 2009. doi: 10.1007/s10208-008-9030-4. URL https://doi.org/10.1007/s10208-008-9030-4.
N. Boumal, P.-A. Absil, and C. Cartis. Global rates of convergence for nonconvex optimization on manifolds. IMA J. Numer. Anal., 39(1): 1­33, 2019. ISSN 0272-4979. doi: 10.1093/imanum/drx080. URL https://doi.org/10.1093/imanum/drx080.
C. M. Campos. High order variational integrators: a polynomial approach. In Advances in differential equations and applications, volume 4 of SEMA SIMAI Springer Ser., pages 249­258. Springer, Cham, 2014. doi: 10.1007/978-3-319-06953-1\ 24. URL https://doi.org/10.1007/978-3-319-06953-1_24.
E. Celledoni, H. Marthinsen, and B. Owren. An introduction to Lie group integrators--basics, new developments and applications. J. Comput. Phys., 257(part B):1040­1061, 2014. ISSN 0021-9991. doi: 10.1016/j.jcp.2012.12. 031. URL https://doi.org/10.1016/j.jcp.2012.12.031.
E. Celledoni, S. Eidnes, B. Owren, and T. Ringholm. Energypreserving methods on Riemannian manifolds. Math. Comp., 89(322): 699­716, 2020. ISSN 0025-5718. doi: 10.1090/mcom/3470. URL https://doi.org/10.1090/mcom/3470.
L. Colombo, S. Ferraro, and D. Mart´in de Diego. Geometric integrators for higher-order variational systems and their application to optimal control. J. Nonlinear Sci., 26(6):1615­1650, 2016.

REFERENCES 38

T. Courant and A. Weinstein. Beyond Poisson structures. In Action hamiltoniennes de groupes. Troisi`eme th´eor`eme de Lie (Lyon, 1986), volume 27 of Travaux en Cours, pages 39­49. Hermann, Paris, 1988.

T.J. Courant. Dirac manifolds. Trans. Amer. Math. Soc., 319(2):631­661, 1990.

P. Crouch and F. Silva Leite. The dynamic interpolation problem: on Riemannian manifolds, Lie groups, and symmetric spaces. J. Dynam. Control Systems, 1(2):177­202, 1995. ISSN 1079-2724.

C. Cuell and G. W. Patrick. Geometric discrete analogues of tangent bundles and constrained Lagrangian systems. J. Geom. Phys., 59(7):976­997, 2009. ISSN 0393-0440. doi: 10.1016/j.geomphys.2009.04.005.

M. de Le´on and P. R. Rodrigues. Generalized classical mechanics and field theory, volume 112 of North-Holland Mathematics Studies. North-Holland Publishing Co., Amsterdam, 1985. A geometrical approach of Lagrangian and Hamiltonian formalisms involving higher order derivatives, Notes on Pure Mathematics, 102.

M. de Le´on, J. C. Marrero, and E. Mart´inez. Lagrangian submanifolds and dynamics on Lie algebroids. J. Phys. A, 38(24):R241­R308, 2005. ISSN 0305-4470. doi: 10.1088/0305-4470/38/24/R01. URL https://doi.org/10.1088/0305-4470/38/24/R01.

M. de Le´on, F. Jim´enez, and D. Mart´in de Diego. Hamiltonian dynamics and constrained variational calculus: continuous and discrete settings. J. Phys. A, 45(20):205204, 29, 2012. ISSN 1751-8113. doi: 10.1088/1751-8113/45/ 20/205204. URL https://doi.org/10.1088/1751-8113/45/20/205204.

M. P. do Carmo. Riemannian geometry. Mathematics: The-

ory & Applications. Birkh¨auser Boston, Inc., Boston, MA, 1992.

ISBN 0-8176-3490-8.

doi: 10.1007/978-1-4757-2201-7.

URL

https://doi.org/10.1007/978-1-4757-2201-7. Translated from the

second Portuguese edition by Francis Flaherty.

F. Gay-Balmaz, D. D. Holm, D. M. Meier, T. S. Ratiu, and F.-X. Vialard. Invariant higher-order variational problems. Comm. Math. Phys., 309(2): 413­458, 2012. ISSN 0010-3616.

O. Gonzalez. Time integration and discrete Hamiltonian systems. In Mechanics: from theory to computation, pages 257­275. Springer, New York, 2000.

V. Guillemin and S. Sternberg. Symplectic techniques in physics. Cambridge University Press, Cambridge, second edition, 1990. ISBN 0-521-38990-9.

V. Guillemin and S. Sternberg. Semi-classical analysis. International Press, Boston, MA, 2013. ISBN 978-1-57146-276-3.

E. Hairer, C. Lubich, and G. Wanner. Geometric numerical integration, volume 31 of Springer Series in Computational Mathematics. Springer, Heidelberg, 2010. ISBN 978-3-642-05157-9. Structure-preserving algorithms for ordinary differential equations, Reprint of the second (2006) edition.

L. Ho¨rmander. Fourier integral operators. I. Acta Math., 127(1-2):79­183, 1971.

REFERENCES 39

D. Iglesias-Ponte, J. C. Marrero, D. Mart´in de Diego, and E. Padro´n. Discrete dynamics in implicit form. Discrete Contin. Dyn. Syst., 33(3):1117­ 1135, 2013. ISSN 1078-0947. doi: 10.3934/dcds.2013.33.1117. URL https://doi.org/10.3934/dcds.2013.33.1117.

A. Iserles. A first course in the numerical analysis of differential equations. Cambridge Texts in Applied Mathematics. Cambridge University Press, Cambridge, second edition, 2009. ISBN 978-0-521-73490-5.

A. Iserles, H. Z. Munthe-Kaas, S. P. Nø rsett, and A. Zanna. Lie-group methods. In Acta numerica, 2000, volume 9 of Acta Numer., pages 215­365. Cambridge Univ. Press, Cambridge, 2000. doi: 10.1017/S0962492900002154. URL https://doi.org/10.1017/S0962492900002154.

C. Kane, J. E. Marsden, M. Ortiz, and M. West. Variational in-

tegrators and the Newmark algorithm for conservative and dis-

sipative mechanical systems. Internat. J. Numer. Methods En-

grg., 49(10):1295­1325, 2000. ISSN 0029-5981. doi: 10.1002/

1097-0207(20001210)49:10 1295::AID-NME993 3.3.CO;2-N.

URL

https://doi.org/10.1002/1097-0207(20001210)49:10<1295::AID-NME993>3.3.CO;2-N.

B. Leimkuhler and S. Reich. Simulating Hamiltonian dynamics, volume 14 of Cambridge Monographs on Applied and Computational Mathematics. Cambridge University Press, Cambridge, 2004. ISBN 0-521-77290-7.

M. Leok and T. Ohsawa. Variational and geometric structures of discrete Dirac mechanics. Found. Comput. Math., 11(5):529­562, 2011. ISSN 1615-3375. URL https://doi.org/10.1007/s10208-011-9096-2.

M. Leok and T. Shingel. General techniques for constructing variational integrators. Front. Math. China, 7(2):273­303, 2012. ISSN 1673-3452. doi: 10.1007/ s11464-012-0190-9. URL https://doi.org/10.1007/s11464-012-0190-9.

M. Leok and J. Zhang. Discrete Hamiltonian variational integrators. IMA J. Numer. Anal., 31(4):1497­1532, 2011. doi: 10.1093/imanum/drq027. URL https://doi.org/10.1093/imanum/drq027.

P. Libermann and C.-M. Marle. Symplectic geometry and analytical mechanics, volume 35 of Mathematics and its Applications. D. Reidel Publishing Co., Dordrecht, 1987. Translated from the French by Bertram Eugene Schwarzbach.

J. C. Marrero, D. Mart´in de Diego, and E. Mart´inez. Discrete Lagrangian and Hamiltonian mechanics on Lie groupoids. Nonlinearity, 19(6):1313­1348, 2006. doi: 10.1088/0951-7715/19/6/006. URL https://doi.org/10.1088/0951-7715/19/6/006.

J. C. Marrero, D. Mart´in de Diego, and E. Mart´inez. On the exact discrete lagrangian function for variational integrators theory and applications. Preprint arXiv:1608.01586v1, 2016.

J.E. Marsden and T.S. Ratiu. Introduction to mechanics and symmetry, volume 17 of Texts in Applied Mathematics. Springer-Verlag, New York, second edition, 1999. ISBN 0-387-98643-X. doi: 10.1007/978-0-387-21792-5. URL

REFERENCES 40

http://dx.doi.org/10.1007/978-0-387-21792-5. A basic exposition of classical mechanical systems.

J.E. Marsden and M. West.

Discrete mechanics and

tional integrators.

Acta Numer., 10:357­514, 2001.

0962-4929.

doi:

10.1017/S096249290100006X.

http://dx.doi.org/10.1017/S096249290100006X.

variaISSN URL

R. McLachlan and M. Perlmutter. Integrators for nonholonomic mechanical systems. J. Nonlinear Sci., 16(4):283­328, 2006. ISSN 0938-8974. doi: 10. 1007/s00332-005-0698-1.

R. I. McLachlan, G. R. W. Quispel, and N. Robidoux. Geometric integration using discrete gradients. R. Soc. Lond. Philos. Trans. Ser. A Math. Phys. Eng. Sci., 357(1754):1021­1045, 1999. ISSN 1364-503X. doi: 10.1098/rsta. 1999.0363. URL https://doi.org/10.1098/rsta.1999.0363.

R. I. McLachlan, K. Modin, O. Verdier, and M. Wilkins. Geometric generalisations of SHAKE and RATTLE. Found. Comput. Math., 14(2): 339­370, 2014. ISSN 1615-3375. doi: 10.1007/s10208-013-9163-y. URL https://doi.org/10.1007/s10208-013-9163-y.

N.M. Newmark. A method of computation for structural dynamics. ASCE J. of the Engineering Mechanics Division, 85(EM 3):67­94, 1959.

J. M. Sanz-Serna and M. P. Calvo. Numerical Hamiltonian problems, volume 7 of Applied Mathematics and Mathematical Computation. Chapman & Hall, London, 1994. ISBN 0-412-54290-0.

M. Shub. Some remarks on dynamical systems and numerical analysis. In Dynamical systems and partial differential equations (Caracas, 1984), pages 69­91. Univ. Simon Bolivar, Caracas, 1986.

J. S´niatycki and W. M. Tulczyjew.

Generating forms of La-

grangian submanifolds.

Indiana Univ. Math. J., 22:267­275,

1972/73. ISSN 0022-2518. doi: 10.1512/iumj.1972.22.22021. URL

https://doi-org.proxy.queensu.ca/10.1512/iumj.1972.22.22021.

W. M. Tulczyjew. Les sous-vari´et´es lagrangiennes et la dynamique lagrangienne. C. R. Acad. Sci. Paris S´er. A-B, 283(8):Av, A675­A678, 1976a.

W. M. Tulczyjew. Les sous-vari´et´es lagrangiennes et la dynamique hamiltonienne. C. R. Acad. Sci. Paris S´er. A-B, 283(8):Av, 15­18, 1976b.

W. M. Tulczyjew and P. Urban´ski. A slow and careful Legendre transformation for singular Lagrangians. Acta Phys. Polon. B, 30(10):2909­2978, 1999. ISSN 0587-4254. The Infeld Centennial Meeting (Warsaw, 1998).

A. Weinstein. Symplectic manifolds and their Lagrangian submanifolds. Advances in Math., 6:329­346, 1971. ISSN 0001-8708.

A. Weinstein. Lectures on symplectic manifolds, volume 29 of CBMS Regional Conference Series in Mathematics. American Mathematical Society, Providence, R.I., 1979. ISBN 0-8218-1679-9. Corrected reprint.

REFERENCES 41
A. Weinstein. Lagrangian mechanics and groupoids. In Mechanics day (Waterloo, ON, 1992), volume 7 of Fields Inst. Commun., pages 207­231. Amer. Math. Soc., Providence, RI, 1996.
K. Yano and S. Ishihara. Tangent and cotangent bundles: differential geometry. Marcel Dekker, Inc., New York, 1973. Pure and Applied Mathematics, No. 16.

