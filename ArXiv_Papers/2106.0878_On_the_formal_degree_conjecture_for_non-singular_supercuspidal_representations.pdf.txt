arXiv:2106.00878v1 [math.RT] 2 Jun 2021

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS
KAZUMA OHARA
Abstract. We prove the formal degree conjecture for non-singular supercuspidal representations based on Schwein's work [Sch21] proving the formal degree conjecture for regular supercuspidal representations. The main difference between our work and Schwein's work is that in nonsingular case, the Deligne­Lusztig representations can be reducible, and the S-groups are not necessary abelian. Therefore, we have to compare the dimensions of irreducible constituents of the Deligne­Lusztig representations and the dimensions of irreducible representations of Sgroups.
1. Introduction
Let F be a non-archimedean local field of residue characteristic p, and let G be a connected reductive group over F . For an essentially discrete series representation  of G(F ), we can consider a positive constant d() called the formal degree of . In some sense, we can consider the formal degree as a generalization of the dimension of a finite-dimensional representation.
Recall that there is a conjectural correspondence called the local Langlands correspondence between the set of irreducible representations of G(F ), and a set of pairs (, ), where  : WF × SL2(C)  LG is an L-parameter, and  is an irreducible representation of the S-group 0(Ssc), which is determined by . In [HII08b], Hiraga, Ichino, and Ikeda proposed a conjecture called the formal degree conjecture, which predicts that the formal degree d() can be described by using the pair (, ) attached to . More precisely, they predicted that the formal degree d() of  is equal to
dim() · |(0, , Ad, )| , 0(S )
where  denotes the -factor defined in [HII08b, 1], and 0(S ) is a finite group determined by . The formal degree conjecture depends itself on a conjectural correspondence, the local Langlands
correspondence. Hence, in order to verify the formal degree conjecture, we must first have access to a candidate for the local Langlands correspondence. In [Kal19b], Kaletha defined and constructed a large class of supercuspidal representations which he calls regular, and gave a candidate for the local Langlands correspondence for regular supercuspidal representations. Kaletha's construction starts with a pair (S, ), where S is a tame elliptic maximal torus, and  is a character of S(F ) which satisfy some conditions. From the pair (S, ), he constructed a generic cuspidal G-datum of [Yu01], and then he obtained a regular supercuspidal representation by Yu's construction. In [Sch21], Schwein calculated the formal degrees of supercuspidal representations which are obtained by Yu's construction and proved that the formal degree conjecture is true for the local Langlands correspondence in [Kal19b].
On the other hand, in [Kal19c], Kaletha defined and constructed a wider class of supercuspidal representations which he calls non-singular, and also gave a candidate for the local Langlands correspondence for non-singular supercuspidal representations. In this paper, we prove that the formal degree conjecture also holds for the local Langlands correspondence in [Kal19c].
Kaletha's construction of non-singular supercuspidal representations and the local Langlands correspondence for them are very similar to the one for regular supercuspidal representations. Therefore, we can apply the arguments in [Sch21] in our case. However, both in the automorphic side and the Galois side, there are some differences. In the case of regular supercuspidal representations, the Deligne­Lusztig representations appearing in the construction are irreducible, so we can calculate the formal degrees of the regular supercuspidal representations by using the dimension
2020 Mathematics Subject Classification. 22E50. 1

2

KAZUMA OHARA

formula for Deligne­Lusztig representations. Moreover, in this case, the S-groups are abelian, so the factor of the dimension dim() of the irreducible representation of the S-group in the formal degree conjecture is equal to 1. In the non-singular case, however, the Deligne­Lusztig representations appearing in the construction are not necessary irreducible, and the S-groups are not necessary abelian. Kaletha constructed the bijections between the sets of irreducible constituents of the Deligne­Lusztig representations and some sets of irreducible representations of the S-groups, from which he constructed the local Langlands correspondence for non-singular supercuspidal representations. We compare the dimensions of an irreducible constituent of the Deligne­Lusztig representation and the corresponding representation of the S-group, and by using this comparison, we prove the formal degree conjecture for non-singular case.
We sketch the outline of this paper. In Section 3, we state the formal degree conjecture. In Section 4, we explain Yu's construction of supercuspidal representations [Yu01] and the calculation of the formal degrees of these representations [Sch21]. In Section 5, we review the definition and the construction of non-singular supercuspidal representations [Kal19c]. Here, we explain the description of the sets of irreducible constituents of the Deligne­Lusztig representations in [Kal19c]. In Section 6, we introduce the notions of torally wild L-parameters and torally wild L-packet data, which are defined in [Kal19c], and explain the way to construct L-packets from these data. In Section 7, we explain the parametrization of the elements in the L-packet by irreducible representations of the S-group. Section 8 is our essential part. In this section, we prove a variant of [Kal19c, Proposition B.3]. Using the results of this section, we calculate the formal degrees of non-singular supercuspidal representations in Section 9. Finally, in Section 10, we prove that the formal degree conjecture holds for the local Langlands correspondence for non-singular supercuspidal representations.
Acknowledgment. I am deeply grateful to my supervisor Noriyuki Abe for his enormous support and helpful advice. He checked the draft and gave me useful comments. I would also like to thank Tasho Kaletha. He answered my question about twisted Yu's construction and sent me a preliminary copy of their paper about twisted Yu's construction. I am supported by the FMSP program at Graduate School of Mathematical Sciences, the University of Tokyo.
2. Notation and assumptions
Let F be a non-archimedean local field of residue characteristic p, and let kF be its residue field. We fix an algebraic closure F of F and write F sep for the separable closure of F in F . We denote by kF be the residue field of F sep. We write F u for the maximal unramified extension of F . For a field extension E over F , we write OE for its ring of integers.
We denote by F the absolute Galois group Gal(F sep/F ) of F , and by WF the Weil group of F . We also denote by IF the inertia subgroup of F , by PF the wild inertia subgroup of F , and by Frob the geometric Frobenius element in F /IF . For r  0, let WFr be the r-th subgroup of WF in its upper numbering filtration computed with respect to the unique discrete valuation ordF on F × with the value group Z. For a representation  of WF , the depth of  is defined as
depth() = inf{r  R0 | (WFr ) = 1}.
For a field extension E over F , we compute the upper numbering filtration {WEr }rR0 of the Weil group WE of E by using the unique extension of ordF to E×. We compute the depth of a representation of WE by using this filtration. We also define the filtration {Er×}rR>0 of E× as
Er× = {x  E× | ordF (x - 1)  r}. Here, we write the unique extension of ordF to E× by the same symbol. We let Er×+ = s>rEs× for r  0.
Let G be a connected reductive group over F that splits over a tamely ramified extension of F . We denote by Gder the derived subgroup of G, by Z(G) the center of G, by Z the center of Gder, and by A the maximal split central torus of G. Let Ga denote the reductive group G/A. For a maximal torus T of G, we also define T a be the torus T /A.
For a connected reductive group H defined over F or kF , we denote by dim(H) the dimension of H and denote by rank(H) the absolute rank of H. For a maximal torus T of H, let X(T ) be the character group of T , X(T ) be the cocharacter group of T , and R(H, T ) be the absolute root system of H with respect to T . For a root   R(H, T ), we denote by  the corresponding coroot.

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 3
When H is defined over F , we denote by H and LH the dual group of H and the L-group of H respectively.
We assume that p is an odd prime, is not a bad prime for any irreducible factor of the absolute root system of G in the sense of [SS70, 4.1], dose not divide the number of connected components of Z(G), and dose not divide the order of the fundamental group of Gder. Let q be the cardinality of kF , and let expq : R  R be the function t  qt.
For a connected reductive group H over F , we denote by B(H, F ) the enlarged Bruhat­Tits building of H over F and denote by Bred(H, F ) the reduced building of H over F . If T is a maximal, maximally split torus of HE := H ×F E for a field extension E over F , then A(T, E) and Ared(T, E) denote the apartment of T inside the Bruhat­Tits building B(HE, E) and reduced building Bred(HE, E) of HE over E respectively. For any y  B(H, F ), we denote by [y] the projection of y on the reduced building and by H(F )y (resp. H(F )[y]) the subgroup of H(F ) fixing y (resp. [y]). For y  B(H, F ) and r  R0 = R0  {r+ | r  R0}, we write H(F )y,r for the Moy­Prasad filtration subgroup of H(F ) of depth r [MP94, MP96]. In the case that H is a torus, we omit the notion y and write H(F )r for the Moy-Prasad filtration subgroup of H(F ) of depth r, which dose not depend on y. For an irreducible representation  of H(F ), we denote by depth() the depth of  in the sense of [MP96, Theorem 3.5].
For a group H and an H-module M , we denote by M H and MH its invariant and coinvariant respectively. If H is a cyclic group generated by   H, let M  and M denote M H and MH respectively.
For a finite-dimensional representation  of a group H, we denote by dim() the dimension of . Suppose that K is a subgroup of H and h  H. We denote hKh-1 by hK. If  is a representation of K, let h denote the representation x  (h-1xh) of hK.
Throughout the paper, we fix a prime number  = p and an isomorphism C  Q.
3. The formal degree conjecture
In this section, we explain the formal degree conjecture [HII08b, Conjecture 1.4] of Hiraga, Ichino, and Ikeda.
Let (, V ) be an essentially discrete series representation of G(F ), i. e., it becomes a discrete series representation after twisting by a character of G(F ). We note that all supercuspidal representations of G(F ) are essentially discrete series representations. When  is a discrete series representation, the formal degree of  associated with a Haar measure µ on G(F )/A(F ) is defined by the positive constant deg(, µ) which satisfies
((g)u, u)((g)v, v) dµ(g) = deg(, µ)-1(u, v)(u, v)
G(F )/A(F )
for all u, u, v, v  V , where (·, ·) denotes an invariant hermitian inner product on V . In general, we define the formal degree of  as the formal degree of any discrete series representation of G(F ) obtained from  by twisting by a character of G(F ). We fix a level-zero additive character  of F , and let µ be the Haar measure on G(F )/A(F ) attached to  as in [GG99]. We write d() = deg(, µ).
Remark 3.1. In [HII08b], Hiraga, Ichino, and Ikeda use a different Haar measure to state the formal degree conjecture. However, the conjecture is modified in [HII08a], in which the Haar measure above is used.
Let  : WF × SL2(C)  LG be a discrete L-parameter. We write S for the centralizer of (WF × SL2(C)) in G. Let (G)der be the derived subgroup of G, (G)ad be its adjoint group, and (G)sc be the simply connected cover of (G)der. Let Sad be the image of S in (G)ad and Ssc be the preimage of Sad in (G)sc. We also define S be the preimage of S via the natural map Ga  G. For these groups, let 0() denote the groups of connected components.
It is believed that the L-parameter  determines a finite set (G) of irreducible representations of G(F ) called L-packet, whose elements are indexed by a set of irreducible representations of 0(Ssc) [Art06]. We now state the formal degree conjecture, which depends on the conjectural correspondence above.

4

KAZUMA OHARA

Conjecture 3.2 ([HII08b, Conjecture 1.4]). Let  be a discrete L-parameter which corresponds to the L-packet (G). Assume that   (G) corresponds to the representation  of 0(Ssc). Then
d() = dim() · |(0, , Ad, )| , 0(S )
where  is the -factor defined in [HII08b, 1].

4. Yu's construction and formal degree

In this section, we review Yu's construction of supercuspidal representations in [Yu01] and the

calculations An input

of for

the formal degrees of these representations, which are done in [Sch21]. Yu's construction of supercuspidal representations of G(F ) is a tuple  =

(-G ,

y,

-r ,

-1,

- )

called a generic cuspidal G-datum, where D1: -G = G0 G1 . . . Gd = G is a sequence of twisted Levi subgroups of G that split

over a tamely ramified extension of F , i. e., there exists a tamely ramified extension E

of F such that GiE is split for 0  i  d, and G0E G1E . . . GdE = GE is a split Levi sequence in GE in the sense of [Yu01, Section 1]; we assume that Z(G0)/Z(G) is

anisotropic;

D2: y is a point in B(G0, F )  A(T, E) whose projection on the reduced building of G0(F )

is a vertex, where T is a maximal torus of G0 (hence of Gi) whose splitting field E is a

tamely ramified extension of F ; D3: -r = (r0, . . . , rd) is a sequence of real numbers satisfying

0 < r0 < r1 < · · · < rd-1  rd (d > 0),

0  r0

(d = 0);

D4: -1 is an irreducible representation of G0(F )[y] such that -1 G0(F )y,0 is the inflation

of -a cuspidal representation of G0(F )y,0/G0(F )y,0+; D5:  = (0, . . . , d) is a sequence of characters, where

i

is

a

character

of

Gi(F );

we

assume that i is trivial on Gi(F )y,ri+ but non-trivial on Gi(F )y,ri for 0  i  d - 1. If rd-1 < rd, we assume that d is trivial on Gd(F )y,rd+ but non-trivial on Gd(F )y,rd , otherwise we assume that d = 1. Moreover, we assume that i is Gi+1-generic of depth

ri relative to y in the sense of [Yu01, Section. 9] for 0  i  d - 1.

From this datum, Yu constructed a pair (Kd, d) consisting of a compact-mod-center open sub-

group and its irreducible representation, and obtained an irreducible supercuspidal representation

 = indKG(dF ) d of G(F ), where indKG(dF ) d denotes the compactly induced representation [Yu01, Theorem 15.1]. The formal degree of  is calculated in [Sch21]. Recall that A denotes the maximal split central torus of G, and Ga denotes the reductive group G/A. We also define Ga,i = Gi/A

for 0  i  d. Let (Ga,i)[y] be the reductive quotient of the special fiber of the connected parahoric group scheme of Ga,i associated to y, which is a reductive group over kF .

Proposition 4.1 ([Sch21, Theorem A]). Let  be a generic cuspidal G-datum. Then, the formal degree d() of  is equal to

[Ga,0(F

dim(-1) )[y] : Ga,0(F

)y,0+]

expq

1 2

dim(Ga)

+

1 2

dim((Ga,0)[y])

+

1 2

d-1

ri

i=0

R(Gi+1, T ) - R(Gi, T )

.

5. An review of non-singular supercuspidal representations
In this section, we review the definition and the construction of non-singular supercuspidal representations [Kal19c]. The construction of non-singular supercuspidal representations starts with a tame kF -non-singular elliptic pair (S, ), i. e., S is a tame elliptic maximal torus of G, and  is a character of S(F ) which satisfy the conditions in [Kal19c, Definition 3.4.1]. From the pair (S, ), Kaletha constructed the tuple
(Gi)di=0, y, (ri)di=0, (S,-1), (i)di=0

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 5

which satisfies the conditions D1, D2, D3, and D5 in Section 4, where (S,-1) is a possibly reducible representation of G0(F )[y] such that -1 G0(F )y,0 is the inflation of a cuspidal representation of G0(F )y,0/G0(F )y,0+. Hence, for each irreducible constituent -1 of (S,-1), the tuple

(Gi)di=0, y, (ri)di=0, -1, (i)di=0

is a generic cuspidal G-datum. Then, we obtain a supercuspidal representation of G(F ) from this datum by the construction of Yu. An irreducible supercuspidal representation of G(F ) obtained in this way is called non-singular.
We explain the construction of the tuple

(Gi)di=0, y, (ri)di=0, (S,-1), (i)di=0

from a tame kF -non-singular elliptic pair (S, ).

First, we consider a tame kF -non-singular elliptic pair (S, ) of depth-zero. In this case, let d = r0 = 0, 0 be trivial, and -1 = .
Let [y] be the unique Frobenius-fixed point in Ared(S, F u). According to [Kal19b, Lemma 3.4.3],

the point [y] is a vertex of Bred(G, F ). We chose y  B(G, F ) whose projection on Bred(G, F ) is

[y].

There exists a unique smooth integral model of G whose group of OF u - points equal to the stabilizer G(F u)[y] of [y] in G(F u). Let G[y] be the quotient of the special fiber of this model modulo its unipotent radical. Then G[y] is a smooth kF -group scheme. Let G[y] be its neutral connected component, which is the reductive quotient of the special fiber of the parahoric group

scheme of G associated to the vertex [y]. We have G[y](kF ) = G(F )[y]/G(F )y,0+ and G[y](kF ) = G(F )y,0/G(F )y,0+ [Kal19c, Section 3]. We also define the corresponding kF -group schemes S and S satisfying S(kF ) = S(F )/S(F )0+ and S(kF ) = S(F )0/S(F )0+. Finally, we put Gy = S · G[y]. Then, Lang's theorem implies that G[y](kF ) = S(F )G(F )y,0/G(F )y,0+. We regard  as a character of S(kF ).

In [Kal19c], Kaletha extended the theory of [DL76] for disconnected groups and defined the

representation (GS[y,] ) of G[y](kF ) from the pair (S, ). Then, we obtain the representation (S,) of

G(F )[y]

by

inflating

G[y]
(S,

)

to

G(F )[y].

We

explain

the

construction

of

(GS[y,] ).

Let U  G[y] be the unipotent radical of a Borel subgroup of G[y] containing S, and let Fr

denote the Frobenius endomorphism of G[y]. We define the corresponding Deligne­Lusztig variety

Y G[y]
U

=

{gU



G[y]/U

|

g-1Fr(g)



U

·

Fr (U)}.

The

group

G[y](kF )

acts

on

Y G[y]
U

by

the

left

multiplication

and

S(kF )

acts

on

Y G[y]
U

by

the

right

multiplication, so these groups act on the -adic cohomology group Hci(YUG[y] , Q). We define

Hci(YUG[y] , Q) = {v  Hci(YUG[y] , Q) | v · s = (s)v s  S(kF )}.

Then, G[y](kF ) acts on Hci(YUG[y] , Q). According to [Kal19c, Corollary 2.6.3], this component vanishes for all but one i, namely i = d(U), where d(U) denotes the number of root hyperplanes
separating the Weyl chambers of U and Fr (U) respectively. We define the representation (GS[y,] ) of G[y](kF ) by the action of G[y](kF ) on Hcd(U)(YUG[y] , Q).

Remark 5.1. Replacing G[y] with G[y] in the construction above, we define the representation

G[y]
(S,)

of

G[y](kF ).

Similarly, replacing G[y] with G[y], S with S, and  with  :=  S , we

define

the

representation

G[y]
(S ,  )

of G[y](kF ).

We

note

that

G[y]
(S ,  )

is the usual Deligne­Lusztig

representation of G[y] arising from the pair (S, ). According to [Kal19c, Corollary 2.6.4] and

[Kal19c,

Remark

2.6.5],

(GS[y,] )

is

isomorphic

to

the

induced

representation

Ind  G[y](kF ) G[y]

G
[y]

(kF

)

(S,)

and

the

representation

G[y]
(S,)

is

obtained

by

endowing

G[y]
(S ,  )

with

a

structure

of

G[y](kF )-representation.

These results are used later in Section 9.

6

KAZUMA OHARA

Next, we consider a tame kF -non-singular elliptic pair (S, ) of general depth. From (S, ), we obtain a sequence of twisted Levi subgroups
-G = S = G-1  G0 . . . Gd = G in G and a sequence of real numbers -r = (0 = r-1, r0, . . . , rd) as explained below (see [Kal19b, 3.6]). Let E be the splitting field of S. For each positive real number r, we define
Rr = {  R(G, S) | (  NE/F  )(Er×) = 1},
where NE/F denotes the norm map S(E)  S(F ). We also define Rr+ = s>rRs for r  0. Let rd-1 > rd-2 > · · · > r0 > 0 be the breaks of this filtration i. e., the positive real numbers r with Rr+ = Rr. We set in addition r-1 = 0 and rd = depth(). For each 0  i  d, we define Gi be the connected reductive subgroup of G with maximal torus S and root system Rri-1+. We set G-1 = S. According to [Kal19b, Lemma 3.6.1], the subgroups Gi are twisted Levi subgroups of G.
We next recall the definition of a Howe factorization.

aDcetefirns i-tio=n

5.2 ([Kal19b, (-1, . . . , d),

Definition 3.6.2]). A Howe factorization of (S, ) is a sequences where i is a character of Gi(F ) with the following properties.

of

char-

(1)

d

=

i S(F );

i=-1

(2) For all 0  i  d, the character i is trivial on the image of Gisc(F ), where Gisc(F ) denotes the simply connected cover of the derived subgroup of Gi;

(3) For all 0  i < d, i is Gi+1-generic of depth ri relative to y in the sense of [Yu01, Section. 9]. For i = d, d is trivial if rd-1 = rd and has depth rd otherwise. For i = -1, -1 is trivial if G0 = S and otherwise satisfies -1 S(F )0+ = 1.

According to [Kal19b, Proposition 3.6.7], (S, ) has a Howe factorization. We take a Howe factorization - . Then, (S, -1) is a tame kF -non-singular elliptic pair of G0, and the character -1 is of depth-zero. Applying the construction above for the pair (S, -1), we have the representation (S,-1) of G0(F )[y]. In this way, we obtain the tuple
(Gi)di=0, y, (ri)di=0, (S,-1), (i)di=0

from a tame kF -non-singular elliptic pair (S, ) .
If the pair (S, ) is regular in the sense of [Kal19b, Definition 3.7.5], the representation (S,-1) is irreducible, and the tuple

(Gi)di=0, y, (ri)di=0, (S,-1), (i)di=0

is a generic cuspidal G-datum [Kal19b, Proposition 3.7.8]. Applying the construction of Yu to
this datum, we obtain a regular supercuspidal representation (S,) and the formal degree of (S,) is computed by combining Proposition 4.1 and the dimension formula for the Deligne­Lusztig
representations, which is done in [Sch21, Corollary 52].
In our case, however, the representation (S,-1) can be reducible. Hence, in order to obtain a non-singular supercuspidal representation, we have to take an irreducible constituent of (S,-1). We explain the description of the set [(S,-1)] of irreducible constituents of (S,-1) [Kal19c, Section 3]. We note that the set [(S,-1)] dose not denote a multiset.
First, we assume that  is of depth-zero. Let N (S, G)(F ) be the stabilizer of the pair (S, ) in G(F ) by the conjugate action, and N (S, G[y])(kF ) be the stabilizer of the pair (S, ) in G[y](kF ) by the conjugate action. An element G(F ) that normalizes S also normalizes Ared(S, F u) and acts on Ared(S, F u) Frobenius-equivalently, hence fixes the point [y]. Therefore, we get the inclusion
map N (S, G)(F )  G(F )[y]. Hence, we obtain a natural map p : N (S, G)(F )  N (S, G[y])(kF ). Let Irr(N (S, G)(F ), ) be the set of irreducible representations of N (S, G)(F ) whose restriction
to S(F ) is -isotypic, and let Irr(N (S, G[y])(kF ), ) be the set of irreducible representations of N (S, G[y])(kF ) whose restriction to S(kF ) is -isotypic.

Lemma 5.3. The natural map p : N (S, G)(F )  N (S, G[y])(kF ) induces a bijection

Irr(N (S, G)(F ), )  Irr(N (S, G[y])(kF ), ).

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 7
Proof. The image of S(F ) via the natural map p : N (S, G)(F )  N (S, G[y])(kF ) is equal to S(kF ), and [Kal19c, Lemma 3.2.2] implies that the induced map
N (S, G)(F )/S(F ) - N (S, G[y])(kF )/S(kF )
is an isomorphism. Since the image of p contains S(kF ), this isomorphism implies that p is a surjection. Let ker p denote the kernel of p. Then, p indeces an isomorphism
N (S, G)(F )/ ker p  N (S, G[y])(kF ),
and we can identify the set Irr(N (S, G[y])(kF ), ) with the subset of Irr(N (S, G)(F ), ) consisting of the the representations whose restriction to ker p is trivial.
On the other hand, since p induces an isomorphism
N (S, G)(F )/S(F ) - N (S, G[y])(kF )/S(kF ),
ker p is contained in S(F ). Hence, ker p is equal to the kernel of the restriction p S(F ) : S(F )  S(kF ) = S(F )/S(F )0+, which is equal to S(F )0+. Since  is trivial on S(F )0+, we conclude that every element in Irr(N (S, G)(F ), ) is trivial on ker p. Therefore, we obtain a bijection
Irr(N (S, G)(F ), )  Irr(N (S, G[y])(kF ), ).

In

[Kal19c,

2.7],

Kaletha

defined

an

action

RG[y] ,
U

of

N (S, G[y])(kF )

on

Hcd(U)(YUG[y] , Q)

whose

restriction to S(kF ) is -1-isotypic.

The

action

RG[y] ,
U

commutes

with

the

action

of

G[y](kF )

by

(GS[y,] ). Therefore, we obtain a representation of G[y](kF ) × N (S, G[y])(kF ) on Hcd(U)(YUG[y] , Q).

Let G(S[y,],) denote this G[y](kF ) × N (S, G[y])(kF )-representation. For   Irr(N (S, G[y])(kF ), ),

we define

G(S[y,],,) = HomN (S,G[y])(kF ) (, G(S[y,],)),

where  denotes the contragradient representation of . It is a representation of G[y](kF ).

Proposition 5.4 ([Kal19c, Theorem 2.7.7]). The map   (GS[y,],,) is a bijection

Irr(N (S, G[y])(kF ), ) - (GS[y,] ) ,

where

G[y]
(S,

)

denotes the set of irreducible constituents in (GS[y,] ). Moreover, the multiplicity of

(GS[y,],,) in (GS[y,] ) is equal to the dimension of .

For   Irr(S, G)(F ), let (S,,) be the representation of G(F )[y] obtained by the inflation of (GS[y,],,). Here, we regard  as an element of Irr(N (S, G[y])(kF ), ) by the bijection

Irr(N (S, G)(F ), )  Irr(N (S, G[y])(kF ), ).

of Lemma 5.3.

Corollary 5.5. The map   (S,,) is a bijection

Irr(N (S, G)(F ), ) - (S,) . Moreover, the multiplicity of (S,,) in (S,) is equal to the dimension of .

We depth. of real

now consider the general case. Let From the pair (S, ), we obtain a numbers -r , and we take a Howe

s(eSq,ue)nbceesaotfatmwe-iskteFd-nLoenv-isisnugbuglaroruepllsip-Gticapnadiraosfegqeuneenrcael decomposition  of (S, ) as above. As in the case of

depth-zero, we define N (S, G)(F ) be the stabilizer of the pair (S, ) in G(F ) by the conjugate action. We also define the groups N (S, G0)(F )-1 and N (S, G0)(F ) similarly. According to [Kal19c, Lemma 3.4.5], the natural inclusion G0(F )  G(F ) gives the identification

N (S, G0)(F )-1 = N (S, G0)(F ) = N (S, G)(F ).

8

KAZUMA OHARA

Let Irr(N (S, G)(F ), ) be the set of irreducible representations of N (S, G)(F ) whose restric-

tion to S(F ) is -isotypic, and let Irr(N (S, G0)(F )-1 , -1) be the set of irreducible represen-

tations of N (S, G0)(F )-1 = N (S, G)(F ) whose restriction to S(F ) is -1-isotypic. Put 0 =

d i=0

-i 1

G0(F ).

Then,





-1

:=

0



is

a

bijection

Irr(N (S, G)(F ), )  Irr(N (S, G0)(F )-1 , -1).

Therefore, Corollary 5.5 implies the following result.

Corollary

5.6.

The

map






(S,-1 ,-1 )

is

a

bijection

Irr(N (S, G)(F ), ) - (S,-1) .

Moreover,

the

multiplicity

of


(S,-1 ,-1 )

in

(S,-1)

is

equal

to

the

dimension

of

.

Let   Irr(N (S, G)(F ), ). We define the non-singular representation (S,,) of G(F ) be the representation obtained from the generic cuspidal G-datum

(Gi

)di=0

,

y

,

(ri

)di=0

,


(S,-1,-1

)

,

(i

)di=0

by the twisted Yu's construction defined in [FKS].

Remark 5.7. We need not to concern ourselves with the precise definition of the twisted Yu's
construction, but only need to know that the supercuspidal representation obtained by twisted
Yu's construction from a generic cuspidal G-datum  = (-G , y, -r , -1, - )

is the representation indKG(dF )(d  e), where e is a sign character of Kd and indKG(dF )(d  e) denotes the compactly induced representation. According to [Sch21, Lemma 18], the formal degree of the

representation  is equal to

dim(d)

vol(Kd/(Kd  A))

and the formal degree of the representation indKG(dF )(d  e) is equal to

dim(d  vol(K d /(K d

e)  A))

,

where vol(Kd/(Kd  A)) denotes the volume of Kd/(Kd  A) with respect to the Haar measure µ on G(F )/A(F ) defined in Section 3. Since dim(d) = dim(d  e), the formal degree of two representations are equal.

We also define the supercuspidal representation (S,) of G(F ), which is possibly reducible, as the representation obtained form the datum
(Gi)di=0, y, (ri)di=0, (S,-1), (i)di=0
by the twisted Yu's construction. Then the set [(S,)] of irreducible constituents of (S,) is described as follows.

Proposition 5.8 ([Kal19c, Corollary 3.4.7]). The map   (S,,) is a bijection Irr(N (S, G)(F ), ) - [(S,)].
Moreover, the multiplicity of (S,,) in (S,) is equal to the dimension of .

6. Torally wild L-parameters and torally wild L-packet data

In [Kal19c], Kaletha defined the notions of torally wild L-parameters and torally wild L-packet data. First, we recall the definitions of these notions.

Definition 6.1 ([Kal19c, Definition 4.1.2]). A discrete L-parameter  : WF - LG
is called torally wild if the projection of (PF ) on G is contained in a maximal torus of G. If p dose not divide the order of the Weyl group of G, any discrete L-parameter  : WF  LG
is torally wild [Kal19c, Lemma 4.1.3].

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 9
Definition 6.2 ([Kal19c, Definition 4.1.4]). A torally wild L-packet datum is a tuple (S, j, 0, ), where
(1) S is a torus of dimension equal to the absolute rank of G, defined over F and splits over a tamely ramified extension of F ;
(2) j : S  G is an embedding of complex reductive groups whose G-conjugacy class is F stable, i. e., for any   F , the embedding   j  -1 : S  G is G-conjugate to j;
(3) 0 = (0 )0R(G,S0) is tamely ramified -data for R(G, S0), as explained below; (4)  : S(F )  C× is a character,
subject to the condition that (S, ) is a tame F -non-singular elliptic pair in the sense of [Kal19c, Definition 3.4.1].
We explain the third point. Let G be the quasi-split inner form of G. As explained in [Kal19b, 5.1], the embedding j determines a F -stable conjugacy class of embeddings j : S  G. By choosing an embedding j : S  G, and pulling back the root system R(G, jS), we obtain a F invariant root system R(G, S)  X(S), which dose not depend on the choice of j. Let E be the splitting field of S. For each positive real number r, we define
Rr = {  R(G, S) | (  NE/F  )(Er×) = 1},
where NE/F denotes the norm map S(E)  S(F ). We also define Rr+ = s>rRs for r  0. Let S0 be the connected component of the intersection of the kernels of all elements of R0+ and R(G, S0) be the image of R(G, S)\R0+ under the restriction map X(S)  X(S0).
We now recall the definition of -data (see [LS87, 2.5]). Let R = R(G, S) or R(G, S0). For   R, let  be the stabilizer of  in F and F be the corresponding fixed subfield of F sep. We also define ± be the stabilizer of the set {, -} and F± be the corresponding fixed subfield of F sep. We say that  is symmetric if F/F± is a quadratic extension, and asymmetric if F = F±. Let Rsym denote the set of symmetric roots  in R. For   Rsym, we say that  is unramified (resp. ramified) if the extension F/F± is unramified (resp. ramified).
A set of -data for R consists of characters  : F×  C×, one for each   R, having the properties - = - 1, () =   -1 for each   F , and  F±× is the non-trivial quadratic character of F±× which is trivial on the image of the norm map F×  F±× for   Rsym. A set of -data  = ()R for R is called unramified (resp. tamely ramified) if each character  is unramified (resp. tamely ramified), i. e., trivial on OF× . (resp. trivial on (F)×0+). We also say that a set of -data  = ()R for R is minimally ramified, if  = 1 for asymmetric ,  is unramified for unramified symmetric , and  is tamely ramified for ramified symmetric .
Kaletha defined the notion of morphisms between torally wild L-packet data [Kal19c, Defini-
tion 4.1.6] and gave a bijection between the set of G-conjugacy classes of torally wild L-parameters and the set of isomorphism classes of torally wild L-packet data [Kal19c, Proposition 4.1.8]. We recall the way to construct torally wild L-parameters from torally wild L-packet data briefly.
Let (S, j, 0, ) be a torally wild L-packet datum. From the -data 0 for R(G, S0), we obtain -data  = () for R(G, S) as follows. For   R(G, S)\R0+, we let  = 0  NF/F0 , where 0 denotes the image of  via the restriction map X(S)  X(S0), and NF/F0 denotes the norm map F×  F×0 . For   R0+, we let  be trivial if  is asymmetric and be the non-trivial unramified quadratic character if  is unramified symmetric. We note that since (S, ) is a tame F -non-singular elliptic pair, the action of IF on R0+ preserves a set of positive roots. Hence, every symmetric root   R0+ is unramified.
We extend j to an L-embedding Lj : LS  LG by using this -data as in [Kal19a, 6.1] (see also [LS87, 2.6]). Then, let  = Lj  S , where S : WF  LS is the L-parameter attached to the character  via the local Langlands correspondence for tori [Yu09, Theorem 7.5]. In this way, we
obtain from the tuple (S, j, 0, ) a torally wild L-parameter . Finally, we explain the construction of the L-packet associated with a torally wild L-parameter
 [Kal19c, 4.2]. Let (S, j, 0, ) be the torally wild L-packet datum whose isomorphism class corresponds to the G-conjugacy class of . As explained in [Kal19c, 4.2], we may assume that the -data for R(G, S) obtained from  as in [Kal19c, 3.5] is equal to the -data for R(G, S)
obtained from 0 as above. As explained in [Kal19b, 5.1], the embedding j determines the class of admissible embeddings j : S  G. Then, we define the L-packet (G) as the union of [(jS,j)],

10

KAZUMA OHARA

where j : S  G ranges over the G(F )-conjugacy classes of admissible embeddings defined over F , and j is a character of jS(F ) defined by j(j(s)) = (s) for s  S(F ). The resulting L-packet
(G) dose not depend on the choice of torally wild L-packet datum (S, j, 0, ) which satisfies the above condition.

7. Endoscopy

Let  be a torally wild L-parameter which corresponds to the torally wild L-packet datum (S, j, 0, ). We regard Z as a subgroup of S by using an admissible embedding j : S  G. We note that this structure dose not depend on the choice of an embedding j (see [Kal19b, 5.1]). Let
[S]+ be the preimage of SF via the map S/Z  S. We also define the group S+ be the preimage
of S via the map G/Z  G. For these groups, we denote by 0() the groups of connected components.
In the previous section, we define the L-packet (G) associated with a torally wild L-parameter . In [Kal19c, 4.4, 4.5], Kaletha constructed a bijection between (G) and a set of irreducible representations of 0(S+) satisfying some conditions.
Remark 7.1. The formulation of the local Langlands correspondence in [Kal19c] uses the group 0(S+) to parametrize the elements of L-packets. On the other hand, the formulation of the local Langlands correspondence of [Art06], on which Conjecture 3.2 depends, uses the group 0(Ssc) as explained in Section 3. However, in [Kal18, 4.6], Kaletha gave a dimension-preserving bijection between sets of irreducible representations of two different S-groups which is compatible with both formulations of the local Langlands correspondence, and proved that the local Langlands correspondence in [Kal19c] implies the one in [Art06]. Therefore, it is enough to prove Conjecture 3.2 for the formulation in [Kal19c].

The bijection above is given by combining the bijections [(jS,j)]  Irr(0(S+), )

for all admissible embeddings j : S  G, where  is the character of 0([S]+) which is determined by j as in [Kal19c, 4.4], and Irr(0(S+), ) denotes the set of irreducible representations of 0(S+)
whose restriction to 0([S]+) contains . Here, we regard 0([S]+) as a subgroup of 0(S+) by using j (see [Kal19c, Corollary 4.3.4]).
We now explain the bijection

[(jS,j)]  Irr(0(S+), )

in [Kal19c]. First, we assume that  is essentially of depth-zero in the sense of [Kal19c, 4.5]. Proposition 5.8 implies that the map   (jS,j,) is a bijection

(1)

Irr(N (jS, G)(F )j , j)  [(jS,j)].

Let 2 be the pushout of j : jS(F )  C× and the inclusion jS(F )  N (jS, G)(F )j . Then,

we obtain the extension

1  C× 

2

N (jS, G)(F )j jS(F )

 1,

and [Kal19c, Lemma C.5] implies that there exists a natural dimension-preserving bijection

(2)

Irr(N (jS, G)(F )j , j)  Irr( 2, id),

where Irr( 2, id) denotes the set of irreducible representations of 2 whose restriction to C× is id-isotypic.
On the other hand, according to [Kal19c, Corollary 4.3.4], there exists an exact sequence

1  0([S]+)  0(S+)  (S, G)(F )  1, where (S, G) denotes the F -invariant subgroup of the automorphism group of S defined in [Kal19b, 5.1], and (S, G)(F ) denotes the stabilizer of  in (S, G)(F ). Let 0(S+) be the

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 11

stabilizer of  in 0(S+) by the conjugate action, and (S, G)(F ), be the stabilizer of  in (S, G)(F ) by the conjugate action. Then, we obtain an exact sequence

1  0([S]+)  0(S+)  (S, G)(F ),  1

from the exact sequence above. We define 1 be the pushout of  : 0([S]+)  C× and the map 0([S]+)  0(S+) above. Then, we obtain the extension

1  C×  1  (S, G)(F ),  1,

and [Kal19c, Lemma C.5] implies that there exists a natural bijection

(3)

Irr(0(S+), )  Irr( 1, id),

where Irr( 1, id) denotes the set of irreducible representations of 1 whose restriction to C× is id-isotypic. The bijection (3) is a composition of the natural dimension-preserving bijection

Irr(0(S+), )  Irr( 1, id)

and the bijection Irr(0(S+), )  Irr(0(S+), )
given by the induced representation (see the proof of [Kal19c, Lemma C.5]). Here, Irr(0(S+), )
denotes the set of irreducible representations of 0(S+) whose restriction to 0([S]+) is -isotypic. Hence, for   Irr(0(S+), ), the dimension of the representation of 1 which corresponds to  via the bijection (3) is
0(S+)/0(S+) -1 · dim().
Moreover, [Kal19b, Lemma 3.4.10] and [Kal19c, Lemma E.1] imply that j gives an isomorphism

(S, G)(F ), - N (jS, G)(F )j /jS(F ), and [Kal19c, Proposition 4.5.1] implies that the extensions

1  C×  1  C× 

2

N (jS, G)(F )j jS(F )

 (S, G)(F ),

1

1  (S, G)(F ),  1

above are isomorphic. Therefore, there exists a dimension-preserving bijection

(4)

Irr( 1, id)  Irr( 2, id).

By combining the bijections (1), (2), (3), (4), we obtain a bijection
[(jS,j)]  Irr(0(S+), ).
We now consider the general case. Recall that we obtain a sequence of twisted Levi subgroups -G = jS = G-1  G0 . . . Gd = G

from the pair (jS, j ). As explained in [Kal19c, 4.4],  is decomposed as  =L jG0,G  G0 , where G0 : WF  LG0 is the torally wild L-parameter of G0 corresponding to the torally wild L-packet datum (S, j, , ), which is essentially of depth-zero, and LjG0,G : LG0  LG is the extension of
G0  G obtained from the -data 0 for R(G, S0) as in [Kal19a, 6.1]. Moreover, the L-embedding LjG0,G induces the identification S+ = S+G0 . In particular, there exists a canonical dimensionpreserving bijection

(5)

Irr(0(S+), )  Irr(0(S+G0 ), ).

On the other hand, regarding (jS, j) as a tame F -non-singular elliptic pair of G0, we obtain the supercuspidal representation (Gj0S,j) of G0(F ). According to Proposition 5.8, we obtain a bijection

Irr(N (jS, G0)(F )j , j )  [(Gj0S,j)].

Since N (jS, G)(F )j = N (jS, G0)(F )j [Kal19b, Lemma 3.6.5], we obtain a bijection

(6)

[(Gj0S,j)]  Irr(N (jS, G0)(F )j , j )  Irr(N (jS, G)(F )j , j )  [(jS,j)].

12

KAZUMA OHARA

Combining the bijections (5), (6) and the bijection

[(Gj0S,j)]  Irr(0(S+G0 ), ) obtained from depth-zero case, we obtain a bijection

(7)

[(jS,j)]  Irr(0(S+), ).

for general case. For   Irr(0(S+), ), we write  for the element in [(jS,j)] which corresponds to  via the
bijection (7).

8. Key lemma

In this section, we prove a variant of [Kal19c, Proposition B.3] to compare the dimension of 
and the formal degree of . Contrary to the conventions of the rest of the paper, in this section only, we use the notations
below. Let G be a locally profinite group, H  G be an open normal subgroup of finite index. We assume that G/H is abelian. Let N  G be a closed subgroup, write NH = N  H, and let S  NH be an abelian open normal subgroup of N of finite index.
The group N acts on G by the conjugate action, and we can form G  N . Since H is a normal
subgroup of G, we can also define the subgroup H  N of G  N . Since G/H is abelian, H  N is a normal subgroup of G  N .
Let  be a smooth character of S and Irr(NH , ) be the set of irreducible representations of NH whose restriction to S is -isotypic. We assume that N normalizes the character , and every element in Irr(NH , ) is 1-dimensional. Let  be a smooth of finite-length semisimple representation of H  N . We assume that for s  S, s-1  s acts on  by (s). We also assume that

(1)

EndH () =

C · (n-1  n);

nNH /S

(2) For each g  G, the representation g1( H) is isomorphic to  H if g  H · N , and g1( H) and  H have no common irreducible constituents otherwise;
(3) Every irreducible constituent of  H has the same dimension.

Remark 8.1. We define the representation  of H × NH by (h, n) = (hn-1  n). Since S is of finite index in N , so is NH , and  is semisimple. Then [Kal19c, Lemma B.1] and the first condition
above imply that for every   Irr(NH , ), there exists exactly one irreducible constituent  of  H such that the multiplicity of    in  is non-zero. Moreover, in this case, the multiplicity of    in  is 1. Hence, the third condition above implies that every   Irr(NH , ) has the same the multiplicity in  NH .

Let IndHGNN  be the induced representation on the space

{f : G  N   | f (xy) = (x)f (y) (x  H  N, y  G  N )}.

We define the representation I of G × N by I(g, n) = IndHGNN  (gn-1  n). Since H is of finite index in G, IndHGNN  and I are semisimple. For f  IndHGNN , g  G, n  N, s  S, we obtain

(IndHGNN )(s-1  s)f (g  n) = f (g  n)(s-1  s) = f gns-1n-1  ns = f (ns-1n-1  nsn-1)(g  n) = (ns-1n-1  nsn-1)f (g  n) = (nsn-1)f (g  n) = (s)f (g  n).

Therefore, (1, s) acts on I by  for s  S. Let Irr(N, ) be the set of irreducible representations of N whose restriction to S is -isotypic,
and [I G] be the set of irreducible constituents of the G-representation I G.

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 13

The representation I is decomposed as

I =

(  )m, ,

[I G ],Irr(N ,)

where m, is the multiplicity of    in I.

Lemma 8.2. (1) We have m,  {0, 1}, and for any   Irr(N, ), there exists exactly one   [I G] such that m, = 1. So the condition m, = 1 defines a correspondence

Irr(N, )  [I G].

(2) For   Irr(N, ), we write   [I G] for the unique G-representation with m, = 1. Then,

dim( ) dim()

=

|G/H| · dim() |N/S|

.

Proof. The first claim follows from [Kal19c, Lemma B.1] and [Kal19c, Proposition B.3]. We prove the second claim. Let   Irr(N, ). Because of the first claim, dim() is equal to
the multiplicity of  in (I) N , which is equal to the dimension of

HomN (, (I) N ).
We write N  = {n-1  n | n  N }  G  N . By the isomorphism N   N defined by n-1  n  n, we regard  as a representation of N . Then,

HomN (, (I) N ) = HomN (, (IndHGNN ) N )

= HomN (,

IndNN

 

g

(H

N

)g

).

gN \(GN )/(HN )

Let C be a complete system of a representatives for G/HN . For g  G, h  H, n1, n2  N , we obtain
(n1-1  n1)(g  1)(h  n2) = ghn1-1  n1n2.
This calculation implies that the set {g  1 | g  C}
is a complete system of a representatives for N \(G  N )/(H  N ). Therefore, we obtain

HomN (,

IndNN

 

g

(H

N

)

g)

=

HomN (,

IndNN


 g1(H

N

)

g1).

gN \(GN )/(HN )

gC

For g  C, h  H, n  N , we obtain

(g  1)(h  n)(g-1  1) = ghng-1n-1  n,

which is an element of N  if and only if ghng-1n-1 = n-1, i. e., h = n-1. Moreover, in the case h = n-1, we obtain

(g  1)(h  n)(g-1  1) = (g  1)(n-1  n)(g-1  1) = n-1  n.

Let (NH ) be the set

{n-1  n | n  NH }.

Then, the calculations above imply that for g  C,

N  g1 (H  N ) = (NH ),

and the conjugate action of g  1 on (NH ) is trivial. Hence, we deduce that

HomN (,

IndNN

 

g1(H

N

)

g1)

=

HomN (,

IndN(NH ) )

gC

gC

14

KAZUMA OHARA

By the isomorphism N   N, n-1  n  n, (NH ) maps to NH . Therefore, by regarding  as a representation of NH by the isomorphism NH  (NH )  H  N , which is equal to  NH in Remark 8.1, we obtain

HomN (,

IndN(NH )  NH ) = HomN (,

IndNNH  NH )

gC

gC

=

HomN (, IndNNH  NH )

gC

 HomNH (,  NH ).
gC

According to Remark 8.1, there exists an integer m such that  NH is decomposed as



m

 NH = 

 .

Irr(NH ,)

Since every element in Irr(NH , ) is 1-dimensional, we obtain

m

=

dim() |Irr(NH , )|

=

dim() |NH /S|

.

Therefore, if we write the multiplicity of   Irr(NH , ) in  NH by m(), the dimension of HomN (, (I) N ) is equal to

|C| · m ·

m() = |G/HN | · m ·

m()

Irr(NH ,)

Irr(NH ,)
= |G/HN | · m · dim()

=

|G/HN |

· dim() |NH /S|

·

dim()

=

dim()

·

|G/H| · dim() |N/S|

.

This completes the proof.

9. Formal degree of non-singular supercuspidal representations

In this section, we calculate the formal degree of non-singular supercuspidal representations.
Let (S, ) be a tame kF -non-singular elliptic pair and   Irr(N (S, G)(F ), ). We calculate the formal degree of (S,,) defined in Section 5. Since (S,,) is constructed by twisted Yu's construction from the generic cuspidal G-datum

(-G ,

y,

-r ,


(S,-1,-1

),

- ),

Proposition 4.1 and Remark 5.7 imply that the formal degree d((S,,)) of (S,,) is equal to

dim((S,-1,-1)) [Ga,0(F )[y] : Ga,0(F )y,0+

]

expq

1 2

dim(Ga)

+

1 2

dim(Ga,0)[y])

+

1 2

d-1
ri

i=0

R(Gi+1, S) - R(Gi, S)

.

Next, we calculate dim((S,-1,-1)) by using the result in Section 8. We apply Lemma 8.2 for,

G = G0[y](kF ) = G0(F )[y]/G0(F )y,0+, H = G0[y](kF ) = S(F )G0(F )y,0/G0(F )y,0+,

S = S(kF ) = S(F )/S(F )0+,

N = N (S, G0[y])(kF )-1 ,

NH

=

N



H

=

N

(S,

G0

 [y]

)(kF

)-1

,

 = (-1)-1.

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 15

According to [Kal19c, Corollary 2.2.2] and [Kal19c, Proposition 2.3.3], every element in

Irr(N

(S,

G0

 [y

])(kF

)-1

,

(-1

)-1

)

is 1-dimensional.

In

the

proof

of

[Kal19c,

Theorem

2.7.7],

Kaletha

defined

an

action

C G0

 [y]

,

U

of

N (S, G0[y])(kF

)-1

on

Hcd(U)

G0
(YU

 [y]

,

Q

)-1

.

The

action

C G0

 [y]

,

U

dose

not

commute

with

the

action

of

 , G0

 [y]

(S,-1 )

but

instead translates it as

G0
CU

 [y]

,

(n)



G0

 [y]

(S,-1

)

(h)

=

G0

 [y]

(S,-1

)

(nhn-1

)



G0
CU

 [y]

,

(n)

for

n  N (S, G0[y])(kF )-1

and

h  G0[y](kF ).

Therefore,

by

using

G0
CU

 [y]

,

(n),

we

can

extend

the

representation

G0

 [y]

(S,-1 )

to

a

representation



of

H  N = G0[y](kF )  N (S, G0[y])(kF )-1 .

Kaletha

also

defined

an

action

C G0[y],
U

of

N (S, G0[y])(kF )-1

on

Hcd(U)(YUG0[y] , Q)-1 ,

which

satisfies

CUG0 [y] , (n)

=

G0 [y]
(S,-1

)

(n)



RUG0 [y] , (n)

for

n



N (S, G0[y])(kF )-1



G0[y](kF ).

Using

this

action,

he

extended

the

representation

G0 [y]
(S,-1 )

to a representation  of

G  N = G0[y](kF )  N (S, G0[y])(kF )-1

and proved that

  Ind . G0[y](kF )N (S,G0[y])(kF )-1

G0

 [y]

(kF

)N

(S,G0

[y]

)(kF

)-1

Therefore,

we

obtain

that

the

representation

G0 [y] ,
(S,-1 )

is

isomorphic

to

the

representation

(g, n) 

Ind  G0[y](kF )N (S,G0[y])(kF )-1

G0

 [y]

(kF

)N

(S,G0

[y]

)(kF

)-1

(gn-1  n)

of G0[y](kF ) × N (S, G0[y])(kF )-1 .

Since

the

restriction

of

RG0[y] ,
U

to

S(kF )

is

(-1)-1-isotypic,

the

action

of

s-1



s

by



is

the

multiple of (-1)-1(s) for s  S(kF ). In particular, the action of s-1  s by  is also the multiple

of (-1)-1(s) for s  S(kF ).

We will verify the assumptions in section 8;

(1)

EndH () =

C · (n-1  n);

nNH /S

(2) For each g  G, the representation g1( H) is isomorphic to  H if g  H · N , and g1( H) and  H have no common irreducible constituents otherwise;
(3) Every irreducible constituent of  H has the same dimension.

The first two conditions are verified in the proof of [Kal19c, Theorem 2.7.7]. We consider the third

point.

We

note

that



H

is

isomorphic

to

 , G0

 [y]

(S,-1 )

which

is

obtained

by

endowing

G0

 [y]

(S ,  )

with

a

structure of G0[y](kF )-representation (see Remark 5.1).

in

Let N (S, G0[y](kF )

G0[y])(kF )-1 and N (S by the conjugate action

,

G0

 [y]

)(kF

)-1

be

the

respectively. For  =

stabilizer of the pair (S, -1) and

N (S,

G0

 [y]

)(kF

)-1

or

N

(S,

G0

 [y]

(S, )(kF

-1) )-1 ,

we define Irr(, -1) be the set of irreducible representations of  whose restriction to S(kF ) is

-1-isotypic. According to [Kal19c, Corollary 2.2.2] and [Kal19c, Proposition 2.3.3], every element

in

Irr(N

(S,

G0

 [y]

)(kF

)-1

,

-1

)

and

Irr(N

(S

,

G0

 [y]

)(kF

)-1

,

-1

)

are

1-dimensional.

It

is

shown

in

the

proof

of

[Kal19c,

Theorem

2.7.7]

that

the

irreducible

constituents

of

G0

 [y]

(S ,-1 )

are

indexed

by

the

set

Irr(N

(S

,

G0

 [y]

)(kF

)-1

,

-1

),

and

the

irreducible

constituents

of

G0

 [y]

(S,-1 )

are

indexed

by

the set Irr(N (S, G0[y])(kF )-1 , -1).

16

KAZUMA OHARA

We

now

explain

the

relationship

between

the

irreducible

constituents

of

G0

 [y]

(S ,-1 )

and

the

ir-

reducible constituents representation  of N

(oSf, GG(S00,[y[y]-]1))(.kFL)et-1



Irr(N (S,

G0

 [y]

)(kF

whose restriction to

)-1 , N (S,

-1) and E

G0

 [y]

)(kF

)-1

be the set is equal to

of .

the

Lemma 9.1. The cardinality of the set E is equal to

N

(S

,

G0

 [y]

)(kF

)-1

/N

(S,

G0

[y])(kF

)-1

.

In particular, it is independent of .

Proof. Since E is an N (S, G0[y])(kF )-1 /N (S, G0[y])(kF )-1 -torsor, it is enough to show that E

is not empty. According to [Kal19c, Proposition 2.3.3], there exists an extension  of -1 to

N

(S

,

G0

 [y]

)(kF

)-1

.

Then,

 · (  ) N (S,G0[y])(kF )-1 -1

is

a

character

of

N

(S,

G0

 [y]

)(kF

)-1

/S(kF

).

Since

N

(S

,

G0

 [y]

)(kF

)-1

/S(kF

)

is

abelian

[Kal19c,

Corollary 2.2.2], we can extend

 · (  ) N (S,G0[y])(kF )-1 -1

to

a

character



of

N

(S

,

G0

 [y]

)(kF

)-1

/S(kF

).

Then,



·

is

an

element

of

E.

In the proof of [Kal19c, Theorem 2.7.7], Kaletha proved that the irreducible constituent of

G0

 [y]

(S,-1 )

corresponding

to



is

the

direct

sum

of

the

irreducible

constituents

of

G0

 [y]

(S ,-1 )

corre-

sponding to   E.

On the other hand, According to [Kal19c, 2.3], the conjugate action of the kF -point of the

adjoint

group

of

G0[y]

on

the

set

of

irreducible

constituents

of

G0

 [y]

(S ,  )

is

transitive.

In

particular,

every

irreducible

constituent

of

G0

 [y]

(S ,  )

has

the

same

dimension.

Let m denote the dimension

of

irreducible

constituents

of

 . G0

 [y]

(S ,  )

Then,

the argument above implies that the dimensions of

irreducible

constituents

of

G0

 [y]

(S,-1 )

are

equal

to

m·

N

(S,

G0

[y])(kF

)-1

/N

(S,

G0

 [y]

)(kF

)-1

.

In particular, the third assumption is verified. Now, Lemma 8.2 implies the following theorem, which is a generalization of [Sch21, Corollary 52].

Theorem 9.2. The formal degree d((S,,)) of (S,,) is equal to

dim() · expq

1 2

dim(Ga)

+

1 2

rank((Ga,0)[y])

+

1 2

d-1 i=0

ri

R(Gi+1, S) - R(Gi, S)

|N (S, G)(F )/S(F )| |Sa(F )/Sa(F )0+|

.

Proof. Recall that the formal degree d((S,,)) of (S,,) is equal to

dim((S,-1,-1)) [Ga,0(F )[y] : Ga,0(F )y,0+]

expq

1 2

dim(Ga)

+

1 2

dim((Ga,0)[y])

+

1 2

d-1

ri

R(Gi+1, S) - R(Gi, S)

i=0

.

According

to

Lemma

8.2,

the

dimension

of


(S,-1 ,-1 )

is

equal

to

dim() N (S, G0[y])(kF )-1 /S(kF )

G0

[y](kF

)/G0

 [y]

(kF

)

dim((GS0[y,])).

According to [Kal19c, Lemma 3.2.2] and [Kal19c, Lemma 3.4.5], we obtain the isomorphism

N (S, G0[y])(kF )-1 /S(kF )  N (S, G0)(F )-1 /S(F )  N (S, G)(F )/S(F ).

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 17

Moreover, [CAR85, Corollary 6.4.3] and [DL76, Corollary 7.2] imply that the dimension dim(G(S0[y,] ))

of

G0

 [y]

(S ,  )

is

equal

to

[G0

 [y]

(kF

)

:

S(kF

)]

.

expq

1 2

dim(G0[y]) - dim(S)

Therefore, we obtain

G0[y](kF )/G0[y](kF ) dim(G(S0[y,]))

=[G0(F )[y] : S(F )G0(F )y,0] · expq

[G0[y](kF ) : S(kF )]

1 2

dim(G0[y]) - dim(S)

=[G0(F )[y]

:

S(F )G0(F )y,0]

·

[G0(F )y,0 : S(F )0G0(F )y,0+]

expq

1 2

dim(G0[y]) - dim(S)

=[Ga,0(F )[y]

:

Sa(F )Ga,0(F )y,0]

·

expq

[Ga,0(F )y,0 : Sa(F )0Ga,0(F )y,0+]

1 2

dim((Ga,0)[y]) - rank((Ga,0)[y])

.

Then, the claim follows from a computation.

10. Comparison

In this section, we prove that Kaletha's construction of the local Langlands correspondence

[Kal19c] for torally wild L-parameters satisfies Conjecture 3.2.

Let  be a torally wild L-parameter which corresponds to the torally wild L-packet datum

(S, j, 0, ). Conjugating  in G if necessary, we may assume that the image T of j : S  G is F -stable. As explained in [Kal19c, 4.2], we may assume that the -data for R(G, S) obtained from  as in [Kal19c, 3.5] is equal to the -data for R(G, S) obtained from 0 as in Section 6. We need not to concern ourselves with the precise way to obtain the -data () for R(G, S) from , but we only need to know that each  is tamely ramified of finite order. In particular, the hypothesis of [Sch21, Corollary 67] is satisfied, hence [Sch21, Corollary 67] also holds in our

situation.

Let j : S  G be an admissible embedding defined over F . By using j, we regard A as a

subgroup of S, and let Sa denote the torus S/A.

Assume that   [(jS,j)] corresponds to   Irr(0(S+), ) via the bijection (7). We write  = (jS,j,j) for some j  Irr(N (jS, G)(F )j , j). By the construction of the bijection (7), we obtain

dim(j) =

dim() 0(S+)/0(S+)

.

On the other hand, Theorem 9.2 implies that the formal degree of (jS,j,j) is equal to

dim(j) · expq

1 2

dim(Ga)

+

1 2

rank((Ga,0)[y])

+

1 2

d-1 i=0

ri

R(Gi+1, jS) - R(Gi, jS)

N (jS, G)(F )j /jS(F ) |Sa(F )/Sa(F )0+|

.

Therefore, we conclude that the formal degree of (jS,j,j) is equal to

dim() · expq

1 2

dim(Ga)

+

1 2

rank((Ga,0)[y])

+

1 2

d-1 i=0

ri

R(Gi+1, jS) - R(Gi, jS)

0(S+)/0(S+) N (jS, G)(F )j /jS(F ) |Sa(F )/Sa(F )0+|

.

Next, we calculate the -factor. We apply the calculation of |(0, , Ad, )| in [Sch21, Section 4] for our situation. Recall that  = LjS , where S : WF  LS is the L-parameter for the character , and Lj : LS  LG is an extension of j defined by using the -data for R(S, G) obtained from 0. Combining with the adjoint representation Ad of LG on g/zF , we define the representation
Ad   of WF . Here, g and z are the Lie algebras of G and its center respectively. We calculate the absolute value |(0, Ad  )| of the -factor.

18

KAZUMA OHARA

As explained in [Sch21, 4.3], the representation Ad   decomposes as a direct sum

g/zF =: V = Vtoral  Vroot,

where Vtoral = t/zF , and

Vroot =

g.

R(G,S)

Here, t denotes the Lie algebra of T , and g is the usual -eigenspace for T , where  is interpreted as a root of (G, T ) via the map j : S  T . Now, we explain the calculation of |(0, Vtoral)| and |(0, Vroot)| [Sch21, Section 4].
First, we explain the calculation of |(0, Vtoral)|. As explained in [Sch21, 4.4],
Vtoral  C  X (Sa)
as representations of WF . Let M = X(Sa)IF and write M  for the dual lattice of M . Then, |(0, Vtoral)| is calculated as follows.

Lemma 10.1 ([Sch21, Lemma 69]). The absolute value |(0, Vtoral)| is equal to

expq

1 2

(dim(Sa)

+

rank(M

))

|MFrob| (kF ×  M )Frob

.

Remark 10.2. In [Sch21, Section 4], Schwein assumes that the L-parameter  is regular in the sense of [Kal19b, Definition 5.2.3]. However, the argument in [Sch21, Lemma 69] dose not require the regularity condition. Hence, [Sch21, Lemma 69] also holds in our situation.

Next, we explain the calculation of |(0, Vroot)| [Sch21, 4.5]. Let R(G, S) be the set of F -orbits in R(G, S). The root summand Vroot decomposes as a direct sum

Vroot =

V,

R(G,S)

where
V = V.

Moreover, by choosing   , we can identify V with the induced representations IndW WF , where W denotes the stabilizer of  in WF , and  denotes the character of W defined in [Sch21, 4.5]. Schwein calculated the depths of characters  [Sch21, Corollary 71, Lemma 74] to obtain the value of |(0, Vroot)|. We will follow his arguments in our situation.
For   R(G, S), let  be the stabilizer of  in F and F be the corresponding fixed subfield of F sep. We consider the character

  NF/F   : F×  C×,

where NF/F denotes the norm map S(F)  S(F ). Recall that the depth of   NF/F   is defined as
inf{r  R>0 |   NF/F   (F)×r = 1}.

Lemma 10.3 ([Sch21, Corollary 71]). If the depth of   NF/F   is positive, then it is equal to the depth of .

Proof. We recall that [Sch21, Corollary 67] also holds in our situation. Then, the claim follows from the same argument as [Sch21, Corollary 71].

The case where the depth of   NF/F   is equal to 0 is as follows.
Lemma 10.4 ([Sch21, Lemma 74]). If the depth of   NF/F   is equal to 0, then the depth of  is equal to 0. Moreover,  is not an unramifed character, i. e.,  is not trivial on the inertia subgroup of W.

ON THE FORMAL DEGREE CONJECTURE FOR NON-SINGULAR SUPERCUSPIDAL REPRESENTATIONS 19

Proof. According to [Sch21, Lemma 72] and [Sch21, Remark 73], the claim follows when jS is
maximally unramified in G in the sense of [Kal19b, Definition 3.4.2]. Moreover, according to [Kal19a, Proposition 6.9], we obtain the decomposition Lj = LjG0,G 
LjS,G0, where G0 is the twisted Levi subgroup of G with maximal torus jS and satisfying R(G0, S) =
R0+, LjS,G0 : LS  LG0 is the extension of S  G0 obtained from the unique minimally ramified
-data for R(G0, S), and LjG0,G : G0  G is the extension of G0  G obtained from the -data 0 for R(G, S0) [Kal19a, 6.1]. Since the depth of   NF/F   is equal to 0, we obtain from the definition of R0+ that   R(G0, S). From the construction of LjG0,G, we obtain that the embedding g0  g is LjG0,G-equivariant, where g0 denotes the Lie algebra of G0. In this way, we reduce the case G = G0, where jS is maximally unramified in G.

Now, we calculate |(0, Vroot)|. Recall that the F -non-singular pair (jS, j ) determines a sequence of twisted Levi subgroups
-G = jS = G-1  G0 . . . Gd = G
and a sequence of real numbers -r = (0 = r-1, r0, . . . , rd) [Kal19b, 3.6].

Lemma 10.5 ([Sch21, Lemma 76]). The absolute value |(0, Vroot)| is equal to

expq

1 2

|R(G,

jS)|

+

1 2

d
ri( R(Gi+1, jS) - R(Gi, jS) )

.

i=0

Proof. The claim follows from Lemma 10.3 and 10.4 as [Sch21, Lemma 76].

Combining Lemma 10.1 and Lemma 10.5, we obtain the following result.

Proposition 10.6. The absolute value |(0, , Ad, )| is equal to

|MFrob| (kF ×  M )Frob

expq

1 2

dim(Ga)

+

1 2

rank(M )

+

1 2

d
ri( R(Gi+1, jS) - R(Gi, jS) )

.

i=0

According to [Sch21, Lemma 78], the rank of M = X(Sa)IF is equal to the rank of (Ga,0)[y]. Moreover, according to [Kal15, Lemma 5.13, Lemma 5.17, Lemma 5.18], we see

|MFrob| (kF ×  M )Frob

0([S]) = |Sa(F )/Sa(F )0+| ,

where [S] denotes the preimage of SF via the map S/A  S, and 0([S]) denotes the group of connected components of [S] (see [Sch21, Section 5]). Hence, we obtain

0([S]) · expq |(0, , Ad, )| =

1 2

dim(Ga)

+

1 2

rank((Ga,0)[y]

)

+

1 2

d-1 i=0

ri

|Sa(F )/Sa(F )0+|

R(Gi+1, jS) - R(Gi, jS)

.

Therefore, to prove Conjecture 3.2, it is enough to show the following lemma.

Lemma 10.7.

0(S+)/0(S+) N (jS, G)(F )j /jS(F ) = 0(S ) . 0([S])

Proof. According to [Kal19c, Proposition 4.3.2], j induces an exact sequence
1  SF  S  (S, G)(F )  1.
From this exact sequence, we obtain an exact sequence
1  0([S])  0(S )  (S, G)(F )  1. Therefore, the right hand side of the lemma is equal to |(S, G)(F )|.
On the other hand, [Kal19b, Lemma 3.4.10] and [Kal19c, Lemma E.1] imply that j gives an isomorphism
(S, G)(F ), - N (jS, G)(F )j /jS(F ).

20

KAZUMA OHARA

Moreover, [Kal19c, Corollary 4.3.4] and its pull back along the inclusion (S, G)(F ),  (S, G)(F ) give the two exact sequences
1  0([S]+)  0(S+)  (S, G)(F )  1,
1  0([S]+)  0(S+)  (S, G)(F ),  1. Hence, we obtain that
(LHS) = 0(S+)/0(S+) N (jS, G)(F )j /jS(F ) = 0(S+)/0([S]+) 0(S+)/0([S]+) -1 |(S, G)(F ),| = |(S, G)(F )| |(S, G)(F ),|-1 |(S, G)(F ),| = |(S, G)(F )| = (RHS).

References

[Art06] James Arthur, A note on L-packets, Pure Appl. Math. Q. 2 (2006), no. 1, Special Issue: In honor of John

H. Coates. Part 1, 199­217. MR 2217572

[CAR85] R. W. CARTER, Finite groups of lie type : conjugacy classes and complex characters, Pure Appl. Math.

44 (1985).

[DL76] P. Deligne and G. Lusztig, Representations of reductive groups over finite fields, Ann. of Math. (2) 103

(1976), no. 1, 103­161. MR 393266

[FKS] Jessica Fintzen, Tasho Kaletha, and Loren Spice, A twisted Yu construction, Harish-Chandra characters,

and endoscopy, in preparation.

[GG99] Benedict H. Gross and Wee Teck Gan, Haar measure and the Artin conductor, Trans. Amer. Math. Soc.

351 (1999), no. 4, 1691­1704. MR 1458303

[HII08a] Kaoru Hiraga, Atsushi Ichino, and Tamotsu Ikeda, Correction to: "Formal degrees and adjoint -factors"

[J. Amer. Math. Soc. 21 (2008), no. 1, 283­304; mr2350057], J. Amer. Math. Soc. 21 (2008), no. 4,

1211­1213. MR 2425185

[HII08b]

, Formal degrees and adjoint -factors, J. Amer. Math. Soc. 21 (2008), no. 1, 283­304. MR 2350057

[Kal15] Tasho Kaletha, Epipelagic L-packets and rectifying characters, Invent. Math. 202 (2015), no. 1, 1­89.

MR 3402796

[Kal18]

, Global rigid inner forms and multiplicities of discrete automorphic representations, Invent. Math.

213 (2018), no. 1, 271­369. MR 3815567

[Kal19a]

, On L-embeddings and double covers of tori over local fields, arXiv e-prints (2019),

arXiv:1907.05173.

[Kal19b]

, Regular supercuspidal representations, J. Amer. Math. Soc. 32 (2019), no. 4, 1071­1170.

MR 4013740

[Kal19c]

, Supercuspidal L-packets, arXiv e-prints (2019), arXiv:1912.03274.

[LS87] R. P. Langlands and D. Shelstad, On the definition of transfer factors, Math. Ann. 278 (1987), no. 1-4,

219­271. MR 909227

[MP94] Allen Moy and Gopal Prasad, Unrefined minimal K-types for p-adic groups, Invent. Math. 116 (1994),

no. 1-3, 393­408. MR 1253198

[MP96]

, Jacquet functors and unrefined minimal K-types, Comment. Math. Helv. 71 (1996), no. 1, 98­121.

MR 1371680

[Sch21] David Schwein, Formal Degree of Regular Supercuspidals, arXiv e-prints (2021), arXiv:2101.00658.

[SS70] Tonny A Springer and Robert Steinberg, Conjugacy classes, Seminar on algebraic groups and related finite

groups, Springer, 1970, pp. 167­266.

[Yu01] Jiu-Kang Yu, Construction of tame supercuspidal representations, J. Amer. Math. Soc. 14 (2001), no. 3,

579­622. MR 1824988

[Yu09]

, On the local Langlands correspondence for tori, Ottawa lectures on admissible representations of

reductive p-adic groups, Fields Inst. Monogr., vol. 26, Amer. Math. Soc., Providence, RI, 2009, pp. 177­

183. MR 2508725

graduate school of mathematical science, the university of tokyo, 3-8-1 komaba, meguroku, tokyo 153-8914, japan.
Email address: kohara@ms.u-tokyo.ac.jp

