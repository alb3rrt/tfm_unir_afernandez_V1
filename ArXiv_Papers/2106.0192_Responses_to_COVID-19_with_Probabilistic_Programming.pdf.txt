arXiv:2106.00192v1 [cs.CE] 1 Jun 2021

Responses to COVID-19 with Probabilistic Programming
ASSEM ZHUNIS and TUNG-DUONG MAI, KAIST, Republic of Korea SUNDONG KIM, Institute for Basic Science, Republic of Korea
The COVID-19 pandemic left its unique mark on the 21st century as one of the most significant disasters in history, triggering governments all over the world to respond with a wide range of interventions. However, these restrictions come with a substantial price tag. It is crucial for governments to form anti-virus strategies that balance the trade-off between protecting public health and minimizing the economic cost. This work proposes a probabilistic programming method to quantify the efficiency of major non-pharmaceutical interventions. We present a generative simulation model that accounts for the economic and human capital cost of adopting such strategies, and provide an end-to-end pipeline to simulate the virus spread and the incurred loss of various policy combinations. By investigating the national response in 10 countries covering four continents, we found that social distancing coupled with contact tracing is the most successful policy, reducing the virus transmission rate by 96% along with a 98% reduction in economic and human capital loss. Together with experimental results, we open-sourced a framework to test the efficacy of each policy combination.
CCS Concepts: · Theory of computation  Probabilistic computation; · Social and professional topics  Governmental regulations; · Applied computing  Health informatics.
Additional Key Words and Phrases: COVID-19, probabilistic programming, SEIRD model, simulation, economic impact, policy making
1 INTRODUCTION
The ongoing COVID-19 pandemic is one of the most challenging pandemics in human history, infecting more than 170 million people worldwide with more than 3.5 million fatalities as of May 30, 2021 [14]. Rapid and easy transmission of COVID-19 leads to a high and fast-growing caseload, overwhelmingly straining the healthcare systems of many countries. Governments are pushed to apply prompt and effective interventions to protect public health. Such policies include lockdown, social distancing, contact tracing, hygiene and mask mandates. However, countries differ on these measures and their stringency due to differences in public acceptance, the political climate, or government priority. Thus, many interventions were applied considering the individual socioeconomic status of countries. Furthermore, most countries lacked experience in handling the pandemic, only a handful have successfully brought the pandemic under control. The world has witnessed how the initial response to the virus dictated the trajectory of the virus spread.
Apart from its health impact, coronavirus has affected the economic state of the world with various restrictions imposed by governments to mitigate the virus spread. The pandemic already caused a bigger recession than the Great Depression [68]. On April 18, 2020, in 158 out of 181 countries, workplaces were temporarily closed, which hurts companies in the absence of essential workers due to multiple waves of the pandemic [22]. As reported by Mandel et al., lockdown generates more than 33% drop in global output at its peak and more than 9% drop in annual GDP [41]. Furthermore, adverse economic effects of lockdown could even diffuse to the neighboring countries by supply chains [27]. Thus, governments should carefully take economic context into account when making policy decisions.
Both authors contributed equally to this research. Supported by the Institute for Basic Science (IBS-R029-C2).
Authors' addresses: Assem Zhunis, zhunis.assem@kaist.ac.kr; Tung-Duong Mai, john_mai_2605@kaist.ac.kr, KAIST, 291 Daehak-ro, Daejeon, Republic of Korea, 34141; Sundong Kim, Institute for Basic Science, 55 Expo-ro, Daejeon, Republic of Korea, 34126, sundong@ibs.re.kr.

2

Zhunis and Mai, et al.

Fig. 1. Project pipeline. First, we infer COVID-19 related parameters such as basic reproduction number 0, incubation rate , recovery rate , and mortality rate  using the compartmental model. Second, we apply the change-point model to infer policy efficiencies from different countries. Finally, using inferred parameters from previous steps and economic parameters from real-world data, we run the generative model in artificial country simulation to estimate the economic cost for different policy combinations.
This paper proposes a probabilistic programming method to evaluate the strategies imposed by different countries and point out which policies are the most successful in the initial response to the crisis. To provide insights on the effectiveness of initial responses to the pandemic, we analyzed data from 10 countries covering four continents. Moreover, we present a method to balance economic trade-offs of adopting specific policies by providing a generative model that considers the economic context of a given country. Given the recent focus on vaccination efforts, we also examine the effect of vaccination in the containment of the coronavirus in Israel and the United States.
To quantitatively express and analyze the success and failure of different countries, we utilize a probabilistic approach to tackle the COVID-19 transmission dynamics. As illustrated in Figure 1, our approach has three major components:
(1) Infer COVID-19 statistics by the compartmental model (§ 4). (2) Estimate policy strengths by the change-point model (§ 5). (3) Simulate virus in the context of policy combinations considering the economic loss by the
generative model. (§ 6).
The compartmental model is to understand the representative statistics of the virus transmission dynamics, including recovery time, incubation time, reproduction number (0), and mortality rate. We infer the baseline statistics by fitting the SEIRD compartmental model on the Swedish data before the Swedish government imposed any policies. We assume that these statistics represent the original virus features unaffected by any human interventions. The obtained statistics serve as the default parameters for later modeling parts.
With the change-point model, we estimate the strength of the policies applied to curb the virus spread. Countries around the world impose various interventions with different degrees. Furthermore, the populations worldwide are largely not homogeneous; therefore, the same policy could have different outcomes in different populations. Instead of capturing all these complicated

Responses to COVID-19 with Probabilistic Programming

3

factors, we choose cases where a particular policy can viably represent the upper bound of these policy's efficiency, i.e., the maximum reduction in infection rate. This provides a good idea of how effective each policy would be if applied in full force. To find these upper bounds, we investigate the countries with a successful initial response to the pandemic that stringently applied a given measure, such as China for lockdown or Singapore for social distancing. As these countries curbed the first wave of the spread by firmly applying a particular measure, we can consider the effect in these countries as the maximum effect the measure could perform. The measure will introduce an abrupt change in caseload growth with a significant drop in growth rate, starting from a change point in the timeline. We utilize the growth rate before and after this change-point to detect the effect of each measure. We run several experiments on countries with different initial responses to the pandemic. The efficiency of the initial policies is represented in terms of the transmission rate change after the policy establishment. Inference result suggests that all major interventions are effective in reducing the virus spread. For example, contact tracing coupled with social distancing yields 96% reduction in the virus transmission rate, achieving the same effect as lockdown and outperforming all other policies.
The last part of our study includes simulating the virus in an imaginary country that follows all virus and policy statistics inferred from the previous parts. Our generative model is to support decision-makers to solve optimization problems having opposing objectives: public health and the economy. Stringent measures indeed incur economic collapse, but loosening the measures could lead to a devastating crisis. Therefore, the trade-off should be considered carefully. Our model predicts the trajectory of the pandemic, including cases, deaths, and recoveries. Moreover, we incorporate the economic cost into the simulation to address the economic trade-off of policy establishments. By controlling parameters, we estimate how the pandemic plays out in different scenarios and conclude which policy combination can effectively mitigate the virus in public health and economic dimensions. Simulation results suggest contact tracing coupled with social distancing incurs the lowest economic and human capital loss.
With all these analyses, we provide a simple but insightful model to analyze several features of a pandemic: severity of the disease, policy efficiency, and economic impact. This will help to understand the success and failure of each country in its response to the pandemic. It could be used as a playbook to to better prepare for a possible pandemic in the future. For reproducibility, the code and datasets used in the paper are available at https://git.io/JGcPW.
The rest of this paper is organized as follows. In Section 2, we review related work. In Section 3, we introduce the dataset. In Sections 4 and 5, we propose our compartmental model and estimate policy strength by change-point model, respectively. With this model and economic viewpoint, we simulate an artificial country by changing policies in Section 6. We conclude the paper in Section 7.

2 RELATED WORK
2.1 Compartmental models
Most of the epidemic models divide the target population into a certain number of compartments, consisting of individuals with identical statuses concerning a given disease. The foundations of the entire approach to epidemiology based on compartmental models were laid by public health physicians in the early 1900s. One of the first applications of the compartmental model was made by R. Ross, who demonstrated the dynamics of the transmission of malaria between mosquitoes and humans and consequently was awarded the Nobel Prize in Medicine in 1902 [60, 63]. Since then, compartmental models are still widely used to simulate the spread of a variety of infections [7].
One of the most popular extensions of the SIR model is the SEIR model [39], a traditional method used to simulate infectious disease that incubates inside the hosts for a while before the

4

Zhunis and Mai, et al.

hosts become infectious. The SEIR model considers the incubation period by introducing a new compartment  (Exposed) to the compartmental system. This model and its modifications were already adapted to simulate the COVID-19 virus in many countries [3, 56, 78]. In this work, we use a modified version of the model--SEIRD [58] with the death compartment .

2.2 Probabilistic algorithms
The Markov chain Monte Carlo (MCMC) is a large class of sampling algorithms widely used for probabilistic problems. MCMC was first introduced in 1953 as a new method to simulate the distribution of states for the system of idealized molecules [45]. However, the application of the algorithm did not limit itself to the physics field. It was later adapted and generalized by Hastings [24] to focus on statistical problems, opening its application to a wide range of applications. Due to its ability to handle complex types of analyses, the MCMC approach was widely used in finance [15, 30], communication [1, 16], computational biology [21], linguistics [19, 67] and other fields with probabilistic settings. By no surprise, these methods are widely popular for estimating effects in complex epidemiological analyses as well [23, 36]. For example, Cauchemez et al. has shown how to model influenza transmission using the Bayesian MCMC approach [10], and lots of variations of MCMC methods were used to infer features of an Ebola virus and analyze its transmission mechanism [38, 47]. Recent reports are also benefited from the Bayesian MCMC methods to infer COVID-19 virus transmission dynamics. Zhou et al. implemented such inference based on a probabilistic compartmental model using daily confirmed COVID-19 cases and applied it to six states of the United States [79].
MCMC algorithms are also successfully applied to change-point models. The objective is to detect the abrupt property changes lying behind the time-series data [9]. Recent work showed that MCMC algorithms with Bayesian parameter inference could be used to detect change-points in COVID-19 spread using SIR and SEIR epidemiological models of South Africa [42]. According to their results, South Africa experienced two change-points: the first at the time of the national lockdown and the second after the massive screening and testing program. Dehning adopted a similar approach, Jonas et al., to the case study of coronavirus spread in Germany by utilizing SIR models with MCMC sampling for detecting change-points in effective growth rate that correlates well with the times of publicly announced interventions [13]. Following these examples, we applied the change point model with an extended SEIRD epidemiology model to identify where policies affected the COVID-19 virus transmission rate in 10 countries with different interventions.

2.3 Policy strength estimation
A wide range of work was done to estimate the efficiencies of the policies imposed by different countries to prevent COVID-19. Many of them were focused on the individual country cases considering their unique demographic features [12, 32, 46], while other reports compared many countries by the independent effects of a single category of policy [4, 11, 66]. For instance, Iwata et al. used Bayesian method analysis [28]. They did not reveal the effectiveness of school closures that occurred in Japan in mitigating the risk of coronavirus infection in the nation. Another recent work by Sharov et al. used a modified SIR model to compare the effectiveness of lockdown measures introduced during the coronavirus pandemic in 13 European countries, comparing them to two baseline countries (Sweden and Iceland) that did not implement the lockdown policies. For evaluation, this work used the herd immunity level and time of formation to indicate the effectiveness of lockdown measures [64]. According to Sharov's results, lockdown and no-lockdown modes of containment led to roughly similar results.

Responses to COVID-19 with Probabilistic Programming

5

There are also reports considering multiple policies across the globe [22, 29]. One example is work by Flaxman, S., Mishra, S., Gandy, A. et al. [17], which investigates effects of applied nonpharmaceutical interventions (NPIs) across 11 European countries for the period from the start of the COVID-19 epidemics. According to their results, major non-pharmaceutical interventions, like lockdowns, have had a significant effect on reducing transmission of the virus. However, a subsequent study by Haug et al. [25], which assessed the efficacy of 6,068 NPIs across 226 countries and gave a detailed analysis of the country-specific 'what-if' scenarios, showed different results. They analyzed the impact of government interventions on the effective reproduction number  by combining several analytical approaches. By utilizing statistical, inference, and artificial intelligence tools, they concluded that combinations of some less disruptive and less costly NPIs could be as effective as more expensive and harsh ones like national lockdowns. Brauner et al. came to the same conclusion by analyzing 41 countries during the first wave of the pandemic. According to their study, less harsh NPIs can be more effective in mitigating COVID-19 transmission than more strict stay-at-home orders[8].
However, one of the significant limitations of recent studies is that none of them perform a comprehensive analysis considering the economic factors that affect the efficiencies of the policies. There were some reports regarding the economic cost of the pandemic situation across the globe [40]. For example, McKibbin and Fernando et al. simulated a global economic model to explore seven scenarios, which differ in the proportion of the population who become infected or dead [43]. According to their estimations, in a scenario where COVID-19 develops into a global pandemic, the cost of lost economic output begins to escalate into trillions of dollars [44]. However, they do not include the effect of policy interventions in their simulations. To address this limitation, we propose another method of cost estimations by involving policy effects in § 6.
3 DATASET
For our analysis, we used virus data from two sources that are available online. The first dataset is taken from Kaggle. This COVID-19-related dataset1 was collected from the John Hopkins University dashboard2 and Worldometers website3. The data for Israel and the US was taken from the COVID19 Data Repository by the Center for Systems Science and Engineering (CSSE) at Johns Hopkins University4. Both datasets report the number of confirmed, death, and recovered cases for each day since the first confirmed case across the globe, divided by countries, regions, and provinces. The plots of daily confirmed cases for 10 countries used for analysis can be found in Figures 2 and 3.
4 ANALYZE COVID-19 STATISTICS BY COMPARTMENTAL MODEL
In this section, we will introduce the proposed methodology to infer SARS-CoV-2 virus statistics. We will first present the SEIRD epidemiological compartmental model and the corresponding probabilistic programming model to infer several virus statistics. Then, we perform inference on the Sweden data to infer the important virus statistics.
4.1 Compartmental SEIRD Model
The most basic compartmental model, namely the SIR model, uses three compartments of Susceptible (S), Infectious (I), and Recovered (R). Each individual can move from a compartment to another compartment, resembling the progress of the disease. We could use S, I and R to denote the number of individuals in their respective compartments. For the COVID-19 case, there is an incubation
1https://www.kaggle.com/imdevskp/corona-virus-report?select=full_grouped.csv 2https://coronavirus.jhu.edu/map.html 3https://www.worldometers.info/coronavirus/ 4https://git.io/Jvoxz

6

Zhunis and Mai, et al.

Daily Confirmed Cases

Daily Confirmed Cases

2000 1500 1000 500
0 Feb 1, 2020

Apr 1, 2020

Jun 1, 2020

1200 1000 800 600 400 200
0 Feb 1, 2020

Apr 1, 2020

Jun 1, 2020

14000

Policy start: Jan 22, 2020

12000

10000

8000

6000

4000

2000

0 Feb 1, 2020 Mar 1, 2020 Apr 1, 2020

(a) Sweden

500

Policy start: Mar 21, 2020

800

400 600
300

200

400

100

200

(b) Japan
Policy start: Feb 25, 2020

0

0

Feb 1, 2020 Apr 1, 2020 Jun 1, 2020

Feb 1, 2020 Mar 1, 2020 Apr 1, 2020

(c) China

80

Policy start: Mar 25, 2020

60

40

20

0 Feb 1, 2020 Apr 1, 2020

Jun 1, 2020

Daily Confirmed Cases

(d) Australia
2500 2000 1500 1000 500
0 Mar 1, 2020

Apr 15, 2020

(e) Korea

May 30, 2020

1400 1200 1000 800 600 400 200
0 Feb 1, 2020

(f) New Zealand
Policy start: Apr 7, 2020
Apr 1, 2020 Jun 1, 2020

(g) Canada

(h) Singapore

Fig. 2. Daily number of confirmed cases of 8 countries. Vertical red lines indicate the date when a certain policy was established. In the case of Sweden and Japan, we consider the time period before the policy establishment. For Canada, the policy was established gradually. Thus, the exact dates of policy start for this country are not determined.

Daily(iCnotnhfiorusmaenddCs)ases

300

Vaccination start: Dec 14, 2020 12

250

10

200

8

150

6

100

4

50

2

0

0 Jun 1, 2020 Oct 1, 2020 Feb 1, 2021 Mar 22, 2020

Vaccination start: Dec 20, 2020 Sep 8, 2020 Feb 25, 2021

(a) United states

(b) Israel

Fig. 3. Daily number of confirmed cases of the countries in a timeline in which we investigate the effect of vaccines.

Responses to COVID-19 with Probabilistic Programming

7

period in which people are infected but not yet infectious. Hence, we adapted the epidemiological SEIRD model [58] for our simulations, extending the SIR model with the E compartment of exposed individuals and the D compartment for deaths.
· Susceptible (S): Individuals in the compartment are neither infected nor immune to the diseases and, hence, could contract the disease. If the susceptible individuals contract the disease (via contact with an infectious individual), they progress to the Exposed compartment.
· Exposed (E): Individuals in the compartment are infected but unable to pass the disease to susceptible individuals. If the Exposed individuals finish their incubation period and can infect others, they progress to the Infectious compartment.
· Infected (I): Individuals in the compartment are infected and pass the disease to susceptible individuals. If the Infectious individuals recover from the disease and carry immunity or die from the disease, they progress to the Recovered (or Resistant) and Dead compartments, respectively.
· Recovered (R): Individuals in the compartment are immune to the disease. If the Recovered individuals lose their immunity, they progress to the Susceptible compartment.
· Dead (D): Individuals in the compartment cannot progress to any other compartment.
The below differential equations (Eq. 1­5) describe the transition between compartments [58].

 = -   + ,

(1)

 



=

 

- ,

(2)

 



=  -,

(3)





=  (1 - ) - ,

(4)





= ,

(5)



 =  +  +  +  + ,

(6)

where the effective reproduction number ( ) is the expected number of people that each infected

individual can transmit the virus to during the outbreak, the basic reproduction number (0) is the

natural

reproduction

number

when

there

is

no

intervention,

the

incubation

time

(

=

1)


is

the

average

time

in

which

an

individual

is

exposed

but

not

yet

infectious,

the

recovery

time

(

=

1)


is

the average time after which an the infected case become concluded (recovered/dead), the case

fatality proportion  is the proportion of fatal cases among all concluded cases, and the waning

time

(

=

1 ) is the time


that recovered

individuals retain immunity. In this

work,

we assume

people carry lifelong immunity to the disease upon recovery ( = 0), and the population stays

constant over time and is equal to N.

4.2 Scaling Up with Probabilistic Programming
To implement the probabilistic models, we used the probabilistic programming language Pyro [6]. For this particular inference task, we adopted Pyro's Epidemiology framework [59] for scaling up our experiments with a restricted class of stochastic discrete-time discrete-count compartmental models. This framework uses the MCMC algorithm to fit the SEIRD model to infer COVID-19related parameters: reproduction number 0, recovery time, incubation time, transmission rate, and mortality rate.

8

Zhunis and Mai, et al.

MCMC is a stochastic algorithm that repeatedly generates random samples describing the distribution of parameters of interest (in our case, COVID-19 related parameters), where a new sample is generated based on the previous sample, thereby creating a Markov chain. The Markov chain has a stationary probability  () such that if the chain ever arrives at  (), it will keep sampling from  () forever. Therefore, the goal of MCMC is to design a transition probability to make the stationary distribution equate the target probability (i.e.  () =  ()). Starting from an initial random sample, the algorithm guides the Markov chain to the stationary distribution, which we force to be the same as our target distribution [2].
A popular instance of the MCMC method is the Metropolis-Hastings algorithm that uses sampled proposal probability distribution (also called the kernel), followed by an acceptance criterion that chooses to accept or discard the new sample by comparing how likely the proposal distribution is to differ from the true next-state probability distribution. For optimizing the sampling process, we used an instance of the Metropolis-Hastings algorithm, namely the Hamiltonian Monte Carlo (HMC) algorithm with the No-U-Turn Sampler (NUTS). The HMC algorithm avoids random walk behavior by taking steps informed by the first-order gradient information [26]. It utilizes an approximate Hamiltonian dynamics simulation, which is then corrected by a Metropolis acceptance step [5, 48]. HMC reduces the correlation between successive sampled states, allowing the algorithm to converge much faster with fewer Markov chain samples. However, since HMC is highly sensitive to two hyper-parameters: step size  and the number of steps , the No-U-Turn Sampler (NUTS) is used to adaptively set these parameters [26]. Thus, we can perform HMC without any manual hyperparameter tuning.
4.3 Fitting SEIRD Model to Sweden ­ The Reference Country
We ran the model on the Swedish data before April 1st, 2020. We chose this early stage of the COVID19 pandemic since Sweden did not impose any strict policies and aimed to achieve herd immunity [18]. We assumed that the virus transmission rate was unaffected by any interventions, so we used Sweden as a baseline case and perform the experiments to infer unaffected COVID-19 parameters. To run our probabilistic model, we set the prior according to the estimations of the World Health Organization [54]. It was reported that mild cases typically recovered within two weeks, the incubation period was on average 5­6 days, and 0 was typically around 2. Mortality and recovery rates differed depending on the region and stage of the virus spread, but the case-fatality rate was roughly 2.5%.
The obtained posterior values for Swedish data are shown in Table 1. For more accurate results, we ran the model 6 times and reported the averaged values. The results are reasonable enough to use in our further simulations.

Parameter

Abbreviation

Value

Recovery time

1/

16.33 days

Incubation time

1/

5.27 days

Basic reproduction number

0

2.64

Case-fatality rate



2.5%

Table 1. Inference results of COVID-19 virus parameters without any interventions. According to model's estimations it takes around 16 days to recover after being infected, 5 days for symptoms to develop after the exposure and mortality rate is equal to 2.5%.

Responses to COVID-19 with Probabilistic Programming

9

5 ESTIMATION OF POLICY STRENGTH BY THE CHANGE-POINT MODEL
This section introduces a change-point methodology to quantify the efficiency of the major interventions applied worldwide to mitigate the COVID-19 spread. First, we briefly introduce the mathematical model behind the change-point method. Second, we continue with a brief description of a corresponding probabilistic programming model that detects change-points in the course of the caseload after the country applied policies and calculates the magnitude of the change. Next, we elaborate on several countries' data to conclude the efficiencies of investigated policies and give a summary of our findings in the final subsection.
5.1 Mathematical Model of the Change-point Method

w2

w1

Fig. 4. Graphical representation of a mathematical model. The green line represents a log-scaled case counts.
Due to some interventions, the graph bends at the change-point, as indicated by the black dotted line. The
change-point divides the graph into two intervals: blue and red. Both lines have different slopes, 1 and 2, respectively, which represent the virus transmission rates before and after the intervention took came into effect. To calculate the efficiency of the intervention, we use the formula 1 - 2/1. The data for early Chinese cases was used for this example. Here, the calculated 1 - 2/1 value represents the efficiency of the lockdown policy of China back in early 2020.

The mathematical model of the change-point method is based on the SEIRD compartmental model (see § 4.1) with some simple assumptions and new tems we describe below. The transmission rate  is the number of susceptible individuals that an infected individual can infect in a day, which is calculated as  = . At the very beginning, almost everyone in our setting is in the Susceptible compartment, so we can assume that  is equal to the total population size  , or  =  . With this approximation, Eq. (1) can be rewritten as follows:



= - = -

(7)



Additionally, since the incubation period is much shorter than the recovery time, we can ignore the E, R, and D compartments at the initial stage of the simulation. Thus, we can approximate the total population size as  =  +  and Eq. (3) becomes:



= 

(8)



The size of the Infected compartment rises exponentially with the rate  =  (that is, on day , the number of infected cases is calculated as  ). Due to the exponential nature, it is appropriate to

10

Zhunis and Mai, et al.

investigate the case counts using a log scale. In the log scale, the exponential spread is represented as a linear line, with the transmission rate of the virus  represented by the slope .
Consider a toy example in Fig. 4. In the beginning, the graph is a steep line with the slope 1 (representing a rapid, exponential spread). After a corresponding policy is applied, the graph bends and becomes less steep with the slope 2  1 (slower spread). Therefore, the graph roughly consists of 2 lines of different slopes, 1 and 2, with a separation point in-between, which we call a change-point (the black dotted vertical line in the graph). The slope 1 and 2 represent the transmission rates before and after the change-point. Since 1 and 2 represent the transmission rates before and after the policy takes its effect, we can define the strength of the target intervention in terms of their ratio[61]:

Policy efficiency = 1 - 2 = 1 - 2

(9)

1

1

Given the incubation period, we expect the policy will show effect after around 2 to 4 weeks after the policy establishment.

5.2 Probabilistic Programming Model of the Change-point Method
As was mentioned in the Related Work section (see § 2.2), probabilistic models were successfully used to detect change-points in transmission rates of coronavirus. In the present subsection, we describe the change-point model adapted from [61], which we used to compare the efficiencies of major policies applied by different countries.

5.2.1 Likelihood Choice. In our probabilistic setting, the likelihood corresponds to the log-scaled line of accumulated confirmed cases. Following the example of [61], we chose piece-wise linear regression and added the StudentT noise, which is more robust w.r.t the outliers than conventional Gaussian noise. We define  as the change-point in the range [0, 1], with 0 and 1 being the start and end of the simulation time period, respectively. The likelihood can be modeled as follows:

 =  +  + ,

(10)

where

,  = 1, 1, if  <  2, 2, if  > 

   (2, 0, 2)

Note that the weights 1 and 2 correspond to slopes before and after the change-point in Eq.(9) of our mathematical model.

5.2.2 Prior Choice. Here we illustrate the choice of parameters' priors used as input for our

probabilistic model to draw samples from, following the work [61]. For weights, we use normal

distribution, with 2 having the mean equal to zero as we expect the slope to drop significantly after the change-point.

1   (0.5, 0.25) 2   (0, 0.25)

(11)

For bias terms, we set the priors to be from normal distribution. However, this time, we adjust

the bias priors for each country adaptively since bias is sensitive to each country's course of the

caseload. Following [61], we assign the mean of y in the first and fourth quartiles to 1 and 2, respectively. For 1 to be relatively flat the standard deviation 1 is set to 1. 2 is set to 0.252

Responses to COVID-19 with Probabilistic Programming

11

1   (1, 1) 2   (2, 2)

(12)

We use Beta distribution to model the change-point , and assume that the change is more likely to occur in the second half of the date range.

  (4, 3)

(13)

Lastly, we use the HMC algorithm with NUTS [26] for the inference step, described in § 4.2.

5.3 Inferring efficiencies of major policies with the Change-point Method
We investigate major initial interventions applied by several countries to mitigate the virus spread. For more accurate results, we chose nine countries presented in Table 2 that strongly imposed corresponding policies, assuming that they were applied to the fullest extend. In this experiment, we focused on five main policy categories:
· Lockdown: A lockdown is an intervention that forces people to stay where they are. It includes a gathering ban, closure of non-critical services, and strict transportation restrictions. People cannot freely enter or exit their designated areas, and economic activities are essentially suspended.
· Social distancing: Social distancing includes interventions or measures intended to maintain a physical distance between people, including a gathering limit or closure of non-essential services. It can be considered as a partial or a soft lockdown.
· Contact tracing and social distancing: Contact tracing is the policy that investigates the close contacts of infected cases and then tests and quarantines them. Investigating the countries with successful contact tracing campaigns revealed that they coupled the contact tracing intervention with social distancing (e.g., South Korea, Australia, and Vietnam). For this reason, instead of addressing contact tracing separately, we merged it with social distancing to be closer to the real-world scenario.
· Mask and hygiene mandate: Almost every country imposed a mask mandate sometime in their COVID-19 timeline response. Since it is always coupled with other restrictions, separating the effect of mask mandate from other interventions is a challenging task. Because the changepoint method cannot be applied in this case, we proposed a different approach to this issue, discussed in § 5.4.4.
· Vaccine: With the recent roll-out of vaccines worldwide, we also examine the effect of recent vaccination campaigns in Israel and the US. The effectiveness of the vaccines depends on several factors, including the time it takes to approve, manufacture, and deliver them to the population, as well as improvements, and the development of other vaccine variations, and the proportion of the population vaccinated. While there are many reports on the effectiveness of several vaccines in laboratory settings [31, 33], the early effects of the vaccinations on a large scale have yet to be studied in more detail. Assuming that vaccination campaigns can result in the same effects on virus mitigation as any other policy that the government may enact, we also analyze the effectiveness of the vaccination programs by applying the same change-point model.
By using the probabilistic programming model described in the previous section, we detected the amount of time the policy needed to take effect after establishment, the change-point, and policy strength for each case. In all experiments, results have converged to the values consistent with our priors. The posteriors also fit well with the actual data (Fig. 5­10). The summary of

12

Zhunis and Mai, et al.

policy efficiencies is shown in Table 2. In the next section, we discuss the results in more detail by investigating each policy separately by the country.

Policy

Country

Started from Strength Take effect

Lockdown Lockdown Contact tracing and distancing Contact tracing and distancing Social distancing / soft lockdown Social distancing / soft lockdown Mask and hygiene Vaccine Vaccine No intervention (Herd immunity)

China New Zealand South Korea Australia Canada Singapore Japan US Israel Sweden

Jan 2020 Mar 2020 Feb 2020 Mar 2020 Mar 2020 Mar 2020 Feb 2020 Dec 2020 Dec 2020 Mar 2020

0.98

16 days

0.95

8 days

0.96

8 days

0.96

10 days

0.70

­

0.78

20 days

0.30

­

0.73

35 days

0.88

59 days

0

­

Table 2. Countries and policies used for analysis. Policy strength and time to take effect are inferred by change-point model. Countries and their major policies are listed according to the starting time and strength. In extreme policies such as lockdowns, the effect comes quickly, but there are side effects to be described later in § 6.3.

5.4 Discussion of the results of the Change-point Method
5.4.1 Lockdown. We investigate the lockdown interventions imposed in China and New Zealand. Both countries applied a strict lockdown as their initial strategy to combat the virus spread. The COVID-19 pandemic emerged in China, with the very first case confirmed on December 10, 2019 [70]. New Zealand recorded its first case on February 28, 2020 [74].

w = 0.0065
250

w = 0.2806

200

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

Density

150

100 50 0 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35

(a) Fitted graph for China with change-point on (b) Posterior distribution of weights (transmission

February 8, 2020.

rate) before and after change-point.

Fig. 5. Posterior for China. As the initial epicenter of the outbreak, cases in China skyrocketed in January 2020. China started applying a swift and stringent lockdown from January 23, 2020 [70], starting with the city of Wuhan, and managed to largely bring the outbreak under control in February, 2020. The growth rate was suppressed staggeringly from 0.2806 to a mere 0.0065, with the change-point estimated around February 8, 2020.

Both countries experienced a swift reduction in infection after the application of lockdown. With a strong centralized government, China could force a lockdown from January 23, 2020, starting with

Responses to COVID-19 with Probabilistic Programming

13

w = 0.2406

w = 0.0125

Density

175

Weight posterior before CP Mean weight before CP

150

Weight posterior after CP Mean weight after CP

125

100

75

50

25

0 0.00 0.05 0.10 0.15 0.20 0.25 0.30 0.35

(a) Fitted graph for New Zealand with change-point (b) Posterior distribution of weights (transmission

on April 2, 2020.

rate) before and after change-point.

Fig. 6. Posterior for New Zealand. After the confirming the first case, New Zealand experienced a rapid spread of the diseases. The government imposed a strong lockdown from March 25, 2020 [74] and brought the outbreak under control in February, 2020. The growth rate declined from 0.2406 to 0.0125. The change-point was around April 2, 2020.

the epicenter of Wuhan city and Hubei province. The lockdown was overwhelmingly stringent, with a travel ban, a stay-at-home order, and transportation suspension. Other Chinese cities quickly followed suit with similar measures. Our model shows that the policy took its effect around February 8, 2020, with a 98% reduction in the transmission rate.
New Zealand recorded its first case on February 28, 2020. The New Zealand government introduced a four-tier alert level system and imposed a lockdown on most of the country's population and economy from March 25, 2020 [74]. The policy seemed to take effect around April 2, 2020, with a 95% reduction in the infection rate.
From these observations, we can conclude that a lockdown is capable of quickly curbing infections. We took the average efficacy of the two mentioned countries, 96% as the efficacy of the lockdown for our further experiments.
5.4.2 Social Distancing. We investigated the social distancing imposed in Canada and Singapore. Both countries applied social distancing or soft lockdown mandates in their initial strategy to combat the virus spread. The first COVID-19 case in Canada was confirmed on January 2, 2020 [72]. Around March­April, 2020, the Canadian government started to apply several restrictions to maintain social distancing [72].
The first COVID-19 case in Singapore was confirmed on January 2, 2020 [37]. The government introduced a soft lockdown (dubbed a circuit-breaker), which included a stay-at-home order and cordon sanitaire5. Contact tracing was not extensively utilized until a later stage of the pandemic [69, 75].
Both countries saw a considerable drop in the infection rate. Canada applied the restriction from around March to April, and the policy had an effect on around February 8, 2020, with a 70% reduction in the infection rate. Singapore applied the circuit-breaker on April 7, 2020, and the change-point was determined to be on April 27, 2020, with a 78% reduction in the infection rate.
It is evident that social distancing had a considerable effect on reducing the infection rate. We took the average efficacy of the two mentioned countries, 74%, as the efficacy of social distancing.
5A cordon sanitaire is the restriction of movement of people into or out of a defined geographic area, such as a community, region, or country.

14

Zhunis and Mai, et al.

500

w = 0.0163

400

w = 0.0551

300

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

Density

200

100

0

0.02

0.03

0.04

0.05

0.06

(a) Fitted graph for Canada with change-point on (b) Posterior distribution of weights (transmission

April 28, 2020.

rate) before and after change-point.

Fig. 7. Posterior for Canada. Canada recorded a total of more than 10,000 cases up to early April. The government imposed various restrictions in March-April [72] and reduced the transmission rate from 0.0551 to 0.0163. The change-point point was around April 28, 2020.

250
w = 0.0261
200
w = 0.1212
150

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

Density

100

50

0 0.02 0.04 0.06 0.08 0.10 0.12

(a) Fitted graph for Singapore with change-point (b) Posterior distribution of weights (transmission

on April 27, 2020.

rate) before and after change-point.

Fig. 8. Posterior for Singapore. Singapore saw a rapid growth of the caseload among migrant workers around April 2020, and a 'circuit-breaker' was imposed on April 7 [69] that brought the outbreak under control in late April, with the growth rate declining from 0.1212 to 0.0261. The change-point point was around April 27, 2020.

5.4.3 Contact Tracing and Social Distancing. Australia and South Korea both utilized a contact tracing strategy coupling with social distancing as their initial strategy to combat the virus spread.
The first COVID-19 case in Australia was confirmed on January 25, 2020. On March 21, 2020, the Australian government imposed social distancing rules, with the closure of "non-essential" services. Swift recruitment of a large contact tracing workforce took place in March 2020 [71].
In South Korea, the first COVID-19 case was confirmed on January 20, 2020 [73]. The government raised the alert level to "Serious" on February 25, 2020, announced guidelines to limit trips and outdoor activities, and imposed emergency safety measures from basic hygiene rules to selfquarantine and social distancing [37]. Health officials implemented extensive movement and contact tracing to identify and inform exposed individuals [37].
Both countries experienced a swift reduction in infection after applying their social distancing coupling with contact tracing. In Australia, the policy seemed to take effect after 10 days (around

Responses to COVID-19 with Probabilistic Programming

15

w = 0.1928

w = 0.0085

Density

300

Weight posterior before CP

Mean weight before CP

250

Weight posterior after CP

Mean weight after CP

200

150

100

50

0 0.000 0.025 0.050 0.075 0.100 0.125 0.150 0.175 0.200

(a) Fitted graph for Australia with change-point (b) Posterior distribution of weights (transmission

on March 31.

rate) before and after change-point.

Fig. 9. Posterior for Australia. After the confirming the first case, Australia recorded almost 10,000 cases before the end of March. With social distancing and contact tracing efforts from March 21, 2020 [71], Australia contained the spread, with a decline in the growth rate from 0.1928 to 0.0086. The change-point point was around March 31, 2020.

800

600
w = 0.0106

Density

w = 0.2587

400

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

200

0 0.00 0.05 0.10 0.15 0.20 0.25

(a) Fitted graph for South Korea with change-point (b) Posterior distribution of weights (transmission

on March 4, 2020.

rate) before and after change-point.

Fig. 10. Posterior for South Korea. South Korea was the second epicenter of the outbreak after the superspreader event of Patient 31. The government relied on social distancing and extensive contact tracing to avoid a stringent lockdown, starting shortly after the Patient 31 event (around February 25, 2020) [37, 73], and brought the outbreak under control in March, with a decline in the growth rate from 0.2587 to 0.0106. The change-point point was around March 4, 2020.

March 31, 2020), with a 96% reduction in the infection rate. In South Korea, the policy showed effects on March 4, 2020, 8 days after the policy establishment, with an identical reduction in the infection rate.
It is evident that the social distancing when coupled with contact tracing can quickly curb the spread of infection. We take the average efficacy of the two mentioned countries, 96%, as the overall efficacy. Thus, contact tracing could push the efficiency of social distancing to the same level as the lockdown.

16

Zhunis and Mai, et al.

5.4.4 Effect of Mandating Masks and Hygiene. We could not use the Changing-point model for masks and hygiene because they are hard to separate from other policies. However, we can indirectly represent the transmission rate via effective reproduction numbers. The transmission rate is proportional to reproduction number:
 = 
Therefore, we can use the reproduction number ratio.

Policy efficiency = 1 - 2 = 1 - 2 = 1 - 2

1

1

1

We compared the effective reproduction number  of Japan before policies were applied with

the basic reproduction number 0 of Sweden from Table 1, which is equal to 2.64.

The reason why we chose Japan lies in its cultural practices, which list the culture of wearing

masks, very little physical contact (such as hugging or shaking hands), and not wearing shoes in

the house [35]. We expect the reproduction number in Japan to be lower even if there is no strict

policy applied. The average effective reproduction number  for Japan after 6 runs was equal to

1.84. Thus, the efficiency of the hygiene and masks mandates is equal to 1 - 1.84/2.64 = 0.30.

5.4.5 Vaccine. The US and Israel both have a sweeping and widespread vaccination program. The results obtained by our method for US and the Israel are plotted in Figures 11 and 12, respectively. The US started the vaccine program on December 14, 2020 [55], while Israel started their campaign on December 20, 2020 [62]. These two countries experienced a swift reduction in infection after the vaccine program started. In the US, the policy seemed to show effect around January 18, 2021 with a 73% reduction in the infection rate. In Israel, the policy produced effects on February 18, 2021 with an 88% reduction in transmission rate. According to our results, in both cases, vaccination successfully mitigated the virus spread.

w = 0.0126

w = 0.0034

Density

2000 1500 1000

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

500

0 0.002 0.004 0.006 0.008 0.010 0.012

(a) Fitted graph with change-point on January 18, (b) Posterior distribution of weights (transmission

2021

rate) before and after change-point.

Fig. 11. Posterior for the US. The US recorded more than 20 million cases when they start vaccine program on December 14, 2020 [55], US sees the growth rate declined by 73%, from 0.0126 to 0.0034. The change-point point was around January 18, 2021

However, most countries lack a swift and large-scale vaccination due to different reasons, including the delay in vaccine production, financial difficulties, or vaccine hesitancy [77]. Thus, in most countries, the fraction of vaccinated population fall far below the herd immunity threshold according to the current data 6. The starts of vaccination programs can also leads to some incautiousness
6https://ourworldindata.org/grapher/share-people-fully-vaccinated-covid

Responses to COVID-19 with Probabilistic Programming

17

w = 0.0120

w = 0.0014

2000 1500

Weight posterior before CP Mean weight before CP Weight posterior after CP Mean weight after CP

Density

1000

500

0

0.002 0.004 0.006 0.008 0.010 0.012

(a) Fitted graph with change-point on February 17, (b) Posterior distribution of weights (transmission

2021

rate) before and after change-point.

Fig. 12. Posterior for Israel. Israel recorded more than 30,000 cases when they started the vaccination program on December 20, 2020 [62]. After the vaccination took its affect, the growth rate declined by 88%, from 0.0120 to 0.0014. The change-point point was around February 17, 2021.

2500 2000 1500 1000 500
0 Jan 1, 2021

Vaccination start: Feb 28, 2021 Feb 15, 2021 Apr 1, 2021

(a) Thailand after vaccination on Feb 28.

350000 300000 250000 200000 150000 100000 50000
0 Jan 1, 2021

Vaccination start: Jan 16, 2021 Feb 15, 2021 Apr 1, 2021

(b) India after vaccination campaign on Jan 16.

Fig. 13. Vaccine fails to mitigate virus in Thailand and India.

and fatigue that may have already driven up cases in many countries like India and Thailand. From Figure. 13, we can see that after the vaccination campaign started [49, 76] the number of cases increased drastically. It is possible that the reason for such an outcome lies in weakening awareness of coronavirus in the population after the vaccination campaigns start. People may have developed more relaxed attitude towards restrictions, which consequently may have caused these spikes in confirmed cases. We conclude that large-scale campaigns and accountability of the population in vaccination establishment play a key role in its success.
5.5 Summary of Change-point Method's Results & Limitations
5.5.1 Policy overview. In Section 5, we evaluated the effectiveness of major policies based on the observed statistics. We found that social distancing, lockdown, and contact tracing are all effective in controlling the pandemic, with lockdown having the highest impact on the transmission rate (on average 96% efficacy for China and New Zealand). It was also found that a combination of social distancing with contact tracing was shown to have an effect comparable to the lockdown (also

18

Zhunis and Mai, et al.

96% efficacy for South Korea and Singapore). The policy usually takes effect from 8-20 days after enforcement.
We also estimated the vaccination campaigns' efficiency. We found that although in countries like Israel and the US, vaccination effectively mitigated the virus spread (on average 81% efficacy for Israel and the US), other countries like Thailand and India failed to bring virus spread under control. Moreover, it seems that vaccination programs were followed by a rapid increase in the confirmed case statistics in such countries. We suppose that reason for such controversial behavior lies in the lack of a large-scale vaccination program, as well as differences in public responsibility awareness.
5.5.2 Limitations. This analysis was based on assumptions, where we boldly ignore the inherent differences between countries and populations. Complex factors such as the acceptance or awareness of the general public could affect the policy's effectiveness. It is evident that some Asian countries tend to perform better in containing the diseases, which we attribute to the collectivist nature and (usually) centralized government. For example, countries with experience with previous epidemics (China and Vietnam with SARS and South Korea with MERS) also tended to perform better thanks to previous experience in handling similar outbreaks.
However, it is too early to conclude that stringent policies like lockdowns are the most successful at mitigating the COVID-19 pandemic, since the side effect of applying the policy should also be considered. Considering that the most efficient policies by our estimations may not be the most effective ones in terms of economic cost, we conducted additional experiments to address this issue.

6 SIMULATION BY GENERATIVE MODEL
Having the virus statistics and policy capacities, we are ready to run our simulation experiments. Since all variables are already inferred, we can use a simple generative model to predict how pandemic plays out in different scenarios. To address the trade-off between public health protection and economic loss, we estimate the cost of the policies and the total loss for given caseloads and death tolls. We tried out multiple policy combinations to figure out what might be the best policy to fight the pandemic in our experimental setting.

6.1 Model
To simulate the infection and fatality cases, we used the SEIRD (see Eq. 5). We follow the differential equations Eq. 1­6 and the virus and policy statistic derived in § 4­5. However, the fatality rate will not stay constant as we considered the hospital capacity.

6.2 Assumption
We used an imaginary country with a population of 1 million. In addition to the parameters we inferred from previous results, we applied some additional assumptions:
· The hospital capacity is 60 per 100,000 capita (0.06%). Among OECD countries, the number of critical care beds ranges from 3.3 to 33.9 beds per 100,000 capita [50], and the number of hospital beds ranges from 50 to 1,300 beds per 100,000 capita [51]. Since countries might adapt normal bed into critical care beds to treat COVID-19 patients amid the health crisis, we use 60 critical care beds per 100,000 capita, which is already double the figure for the most resourceful country (33.9 for Germany)
· 6% of the total cases are required to stay in the intensive care units (ICU).

Responses to COVID-19 with Probabilistic Programming

19

Preliminary data on a subset of 7,162 COVID-19 patients age 19 and older with known health history in the US, from November 12, 2020 to March 28, 2020, found that 6% requires ICU treatment.7 · ICU-required cases will die without ICU treatment. With treatment, the death rate for cases admitted to ICU is 60%. Data from Washington, Seattle, and California suggests mortality rates reported in patients with severe COVID-19 in the ICU range from 50­65% [53].
We also estimate the economic and human capital cost for each policy:
· Lockdown: 10% of GDP per year · Distancing: 5% of GDP per year · Hygiene & masks: $2 per day per capita. · Infection: $300 per infection per day (until recovered). · Contact-tracing: $6,400 per new case. · Death: $7 million per death
These estimations are reasonably set based on the following facts:
· Research suggests that global output shrinks by about 33% at the peak of a lockdown, with an annual impact of over 9% of the annual GDP [41].
· The value of one human life is estimated to be A$5.0M ($3.48M) in Australia in 2020 [52] and $10M in America in 2017 [34].
· In South Korea, the treatment's average daily cost for a mild patient is 180,000­260,000 ($158­$229) and for severe patients is 650,000 ($572) [65].
· The costs of a contact tracing policy include the administrative (monetary) cost and the total quarantine days of the second-generation contacts. The standard contact tracing policy, where all close contacts are requested to quarantine for 14 days from the day of exposure, is estimated to cost 62.1 quarantine days and $189 per index case [57]. We assume contact tracing is done on every confirmed case, and each quarantine day costs $100 (South Korea's government quarantine facility costs 100,000­150,000 ($88­$130) per day).8 The total costs can be estimated as about $6,400 per case ($6,210 for 62.1 quarantine days and $189 for administrative cost).
· Price of a mask in South Korea is normally set around $2 and $1.2 under the government rationing scheme [20].
6.3 Lockdown Only Delays the Virus Spread
We ran the model without any policy and with the lockdown applied from day 30 to 60. As you can see from Fig. 14, applying lockdown for 1 month simply postpones the virus spread. Another problem is that it significantly hits the country's economy, so it cannot be applied for a long time. Thus, even though lockdown is estimated to have the highest efficiency of 0.96, it might not be the best policy to apply. So further experiments are required to identify how, when, and for how long the policies should be applied.
6.4 Best Initial Response: Social Distancing With Contact Tracing
Finally, we want to devise the best initial response to the virus. Using the inferred statistics, we conducted experiments on the policies and performed simulations to develop the optimal policy with minimal loss (both economic loss and life loss). We designed an imaginary country with a population of 1 million and a GDP of $30,000 per capita. The country had a population of 1 million,
7https://www.tfah.org/wp-content/uploads/2020/04/COVIDunderlyingconditions040320.pdf 8https://kr.usembassy.gov/022420-covid-19-information/

20

Zhunis and Mai, et al.

Susceptible Exposed

Infected Recovered

106 8×105 6×105 4×105 2×105
0

No policy Lockdown Policy start Policy end

100 Days 200

300

6×104 5×104 4×104 3×104 2×104
104 0 0

No policy Lockdown Policy start Policy end

100 Days 200

300

(a) Susceptible cases

1.5×105 1.25×105
105 7.5×104
5×104 2.5×104
0 0

No policy Lockdown Policy start Policy end

100 Days 200

300

(b) Exposed cases 8×105

6×105

4×105 2×105
0 0

No policy Lockdown Policy start Policy end

100 Days 200

300

(c) Infected cases
6×104 5×104 4×104 3×104 2×104
104 0 0

Death cases

(d) Recovered cases

No policy Lockdown Policy start Policy end

100 Days 200

300

(e) Death cases

Fig. 14. A lockdown delays the virus spread, but cannot prevent it. In this simulation the lockdown policy was imposed from day 30 to day 60 (total 1 month). The grey graph represents the baseline situation with no policy applied, the green graph indicates the case when a lockdown is applied. The blue and red lines mark the start and end of the lockdown, respectively. We can see that although lockdown sharply decreases the number of exposed and infected cases, it cannot prevent the virus from spreading after the lockdown is lifted on day 60. The number of exposed and infected cases rise again. Given the cost of the lockdown, it is impossible to maintain it for long periods of time, making it less preferable to less costly policies. Thus, conclusion is in alignment with those of prior works [25, 64].

and the simulation spanned three months. We assume that policy-makers revised the policy every month, and a policy is applied exhaustively, partially (50% efficacy), or not applied at all. Policies could be applied together. The goal was to minimize the cost.
6.4.1 Results. The after three months results for some important policy combinations are shown in Table 3. The full loss trajectories of important policies is shown in Fig. 15.
The best policy identified so far is contact tracing with social distancing, with a loss of around 2 billion dollars. Without intervention, the loss in the imaginary nation is $197.9 billion. When scaled up to the US scale, this figure reaches $77 trillion only for the first three months.

Responses to COVID-19 with Probabilistic Programming

21

Table 3. Loss regarding some applied policies (more results are available in our repository.)

Policy combination

Total Cases Total Deaths Total Loss (billion $)

Optimal policy* Contact tracing and distancing Lockdown Social distancing Mask and hygiene mandate No policy

10,734 11,003 11,003 22,478 201,929 592,136

577 591 591 1,138 8,941 28,018

4.526 4.569 4.933 8.437 63.400 197.927

* Optimal policy: Contact tracing and distancing for three months with additional hygiene and mask mandate for the first month.

1012

No policy (worst)

Hygiene & Mask

1011

Distancing Lockdown

Distancing + tracing

Optimal policy

1010

Loss ($)

1090

20 Day4(s0) from star6t0

80

Fig. 15. The (daily) accumulated loss incurred in each intervention. Social distancing coupled with contact tracing incurred the least loss, followed by lockdown, social distancing, masks and hygiene mandates and no policy incurring the biggest lost.

Generally, social distancing coupling with contact tracing incurs less loss than lockdown or social distancing. They are all strong interventions compared to a masks and hygiene mandates. However, they all significantly save a tremendous loss compared to doing nothing or only doing the mask and hygiene mandates. The human cost for mild intervention seems to be significantly lower than the economic cost of the strong intervention. Nonetheless, the masks and hygiene mandates still halved the loss that we suffer when we do nothing.
Contact tracing coupled with social distancing reduces the economic and human capital loss by 98% compared to doing nothing. Although as efficient as lockdown (§ 5), the economic and human capital costs are at least 8% less in a 3 month period. The optimal policy in our setting is contact tracing and social distancing for three months with additional hygiene and masks mandates for the first month. Hygiene and masks mandates plays some role in minimizing the loss, albeit the improvement is marginal.
Therefore, we can conclude that quarantine and contact tracing are the most efficient policies in our setting. Indeed, we can see that countries that enjoyed the initial success in controlling the virus cases, e.g., South Korea, Vietnam, or Australia applied social distancing and contact tracing as their primary policies.

22

Zhunis and Mai, et al.

6.5 Limitations and Implications
Due to the challenge of separating the policy effects, our study has some limitations within which our findings need to be interpreted carefully. First, we have investigated major policies applied in relatively wealthy countries. For economic loss estimations, we utilized policies' costs reported from various developed countries using different sources. Depending on the parameters adjusted for a particular country, the results might be different.
We provide a flexible end-to-end pipeline, which could be tailored to each country's specific needs. Given the unique socioeconomic state, the feasible stringency and price tag of the policies vary across the countries. One could adjust the corresponding parameters to adapt to their own situation. The resilience to control model's parameters also allows countries to see how the pandemic will play out under different scenarios and build their own strategies based on the model's output. Decision-makers could simulate some hypothetical situations and see the resulting cases, deaths, and capital loss, which assist them in making informed decisions for their citizens.

7 CONCLUSION
Recent research on COVID-19 propagation analysis has provided a deeper understanding of the transmission processes occurring during the past 1.5 years. Epidemiological models point out the key factors that affect the spread of the virus, including the basic reproduction number, virus incubation period, and daily infection number. In the present study, we have moved one step further to gauge the efficacy of the early-stage policy to respond to the pandemic, with economic factors related to the policy itself and its benefits of slowing down the virus. Sophisticated analysis from 10 countries suggests that social distancing, coupled with contact tracing, is the most efficient policy among major interventions. From the data of Asian countries, we derive meaningful results that close contact tracing could provide protection to citizens from the pandemic comparable to lockdowns, without inducing as much cost. Going one step further, we carefully designed a simulated country and gauged the efficacy of each policy combination. Our testbed allows endusers to control various parameters suitable for their country's situation. Through the process of overcoming COVID-19, we are gaining a clearer understanding of the trade-off between virus prevention and economic loss. As we have seen in many countries, it is crucial to identify each policy's efficiencies and costs and to estimate the best time and intensity to impose them before it is too late. We hope that our research will assist every nation in responding to possible future pandemics.

REFERENCES
[1] Wael A Al-Qaq, Michael Devetsikiotis, and J-K Townsend. 1995. Stochastic gradient optimization of importance sampling for the efficient simulation of digital communication systems. IEEE Transactions on Communications 43, 12 (1995), 2975­2985.
[2] Christophe Andrieu, Nando De Freitas, Arnaud Doucet, and Michael I Jordan. 2003. An introduction to MCMC for machine learning. Machine learning 50, 1 (2003), 5­43.
[3] Suwardi Annas, Muh. Isbar Pratama, Muh. Rifandi, Wahidah Sanusi, and Syafruddin Side. 2020. Stability analysis and numerical simulation of SEIR model for pandemic COVID-19 spread in Indonesia. Chaos, Solitons & Fractals 139 (2020), 110072. https://doi.org/10.1016/j.chaos.2020.110072
[4] Alex Arenas, Wesley Cota, Jesus Gomez-Gardenes, Sergio Gómez, Clara Granell, Joan T Matamalas, David SorianoPanos, and Benjamin Steinegger. 2020. Derivation of the effective reproduction number R for COVID-19 in relation to mobility restrictions and confinement. medRxiv (2020).
[5] M. J. Betancourt and Mark Girolami. 2013. Hamiltonian Monte Carlo for Hierarchical Models. arXiv:1312.0906 [stat.ME] [6] Eli Bingham, Jonathan P. Chen, Martin Jankowiak, Fritz Obermeyer, Neeraj Pradhan, Theofanis Karaletsos, Rohit
Singh, Paul Szerlip, Paul Horsfall, and Noah D. Goodman. 2018. Pyro: Deep Universal Probabilistic Programming. Journal of Machine Learning Research (2018).

Responses to COVID-19 with Probabilistic Programming

23

[7] Fred Brauer. 2008. Compartmental Models in Epidemiology. Springer Berlin Heidelberg, Berlin, Heidelberg, 19­79. https://doi.org/10.1007/978-3-540-78911-6_2
[8] Jan M Brauner, Sören Mindermann, Mrinank Sharma, David Johnston, John Salvatier, Tomás Gavenciak, Anna B Stephenson, Gavin Leech, George Altman, Vladimir Mikulik, et al. 2021. Inferring the effectiveness of government interventions against COVID-19. Science 371, 6531 (2021).
[9] Stephen Brooks. 1998. Markov chain Monte Carlo method and its application. Journal of the royal statistical society: series D (the Statistician) 47, 1 (1998), 69­100.
[10] Simon Cauchemez, F Carrat, C Viboud, AJ Valleron, and PY Boelle. 2004. A Bayesian MCMC approach to study transmission of influenza: application to household longitudinal data. Statistics in medicine 23, 22 (2004), 3469­3487.
[11] Matteo Chinazzi, Jessica T Davis, Marco Ajelli, Corrado Gioannini, Maria Litvinova, Stefano Merler, Ana Pastore y Piontti, Kunpeng Mu, Luca Rossi, Kaiyuan Sun, et al. 2020. The effect of travel restrictions on the spread of the 2019 novel coronavirus (COVID-19) outbreak. Science 368, 6489 (2020), 395­400.
[12] Ramit Debnath and Ronita Bardhan. 2020. India nudges to contain COVID-19 pandemic: A reactive public policy analysis using machine-learning based topic modelling. PloS one 15, 9 (2020), e0238972.
[13] Jonas Dehning, Johannes Zierenberg, F Paul Spitzner, Michael Wibral, Joao Pinheiro Neto, Michael Wilczek, and Viola Priesemann. 2020. Inferring COVID-19 spreading rates and potential change points for case number forecasts. medRxiv (2020).
[14] Ensheng Dong, Hongru Du, and Lauren Gardner. 2020. An interactive web-based dashboard to track COVID-19 in real time. The Lancet infectious diseases 20, 5 (2020), 533­534.
[15] Bjørn Eraker. 2001. MCMC analysis of diffusion models with application to finance. Journal of Business & Economic Statistics 19, 2 (2001), 177­191.
[16] Behrouz Farhang-Boroujeny, Haidong Zhu, and Zhenning Shi. 2006. Markov chain Monte Carlo algorithms for CDMA and MIMO communication systems. IEEE transactions on Signal Processing 54, 5 (2006), 1896­1909.
[17] Seth Flaxman, Swapnil Mishra, Axel Gandy, H Juliette T Unwin, Thomas A Mellan, Helen Coupland, Charles Whittaker, Harrison Zhu, Tresnia Berah, Jeffrey W Eaton, et al. 2020. Estimating the effects of non-pharmaceutical interventions on COVID-19 in Europe. Nature 584, 7820 (2020), 257­261.
[18] Quentin Fottrell. 2020. Sweden embraced herd immunity, while the U.K. abandoned the idea -- so why do they both have high COVID-19 fatality rates? https://on.mktw.net/34dOR66
[19] Jeff Gill. 2008. Is partial-dimension convergence a problem for inferences from MCMC algorithms? Political Analysis (2008), 153­178.
[20] Amihai Glazer. 2021. Price controls don't work ­ but mask rationing is the exception that proves the rule. https: //bit.ly/3hYHzLA
[21] Ankur Gupta and James B Rawlings. 2014. Comparison of parameter estimation methods in stochastic chemical kinetic models: examples in systems biology. AIChE Journal 60, 4 (2014), 1253­1268.
[22] Thomas Hale, Anna Petherick, Toby Phillips, and Samuel Webster. 2020. Variation in government responses to COVID-19. Blavatnik school of government working paper 31 (2020), 2020­11.
[23] Ghassan Hamra, Richard MacLehose, and David Richardson. 2013. Markov chain Monte Carlo: an introduction for epidemiologists. International journal of epidemiology 42, 2 (2013), 627­634.
[24] W Keith Hastings. 1970. Monte Carlo sampling methods using Markov chains and their applications. (1970). [25] Nils Haug, Lukas Geyrhofer, Alessandro Londei, Elma Dervic, Amélie Desvars-Larrive, Vittorio Loreto, Beate Pinior,
Stefan Thurner, and Peter Klimek. 2020. Ranking the effectiveness of worldwide COVID-19 government interventions. Nature human behaviour 4, 12 (2020), 1303­1312. [26] Matthew D. Homan and Andrew Gelman. 2014. The No-U-Turn Sampler: Adaptively Setting Path Lengths in Hamiltonian Monte Carlo. J. Mach. Learn. Res. 15, 1 (Jan. 2014), 1593­1623. [27] Hiroyasu Inoue and Yasuyuki Todo. 2020. Propagation of the economic impact of lockdowns through supply chains. VOX, CEPR Policy Portal, April 16 (2020). [28] Kentaro Iwata, Asako Doi, and Chisato Miyakoshi. 2020. Was school closure effective in mitigating coronavirus disease 2019 (COVID-19)? Time series analysis using Bayesian inference. International Journal of Infectious Diseases 99 (2020), 57­61. [29] Yothin Jinjarak, Rashad Ahmed, Sameer Nair-Desai, Weining Xin, and Joshua Aizenman. 2020. Accounting for global COVID-19 diffusion patterns, January­April 2020. Economics of disasters and climate change 4, 3 (2020), 515­559. [30] Michael Johannes and Nicholas Polson. 2010. MCMC methods for continuous-time financial econometrics. In Handbook of Financial Econometrics: Applications. Elsevier, 1­72. [31] Ian Jones and Polly Roy. 2021. Sputnik V COVID-19 vaccine candidate appears safe and effective. The Lancet 397, 10275 (2021), 642­643. [32] Andrius Kavaliunas, Pauline Ocaya, Jim Mumper, Isis Lindfeldt, and Mattias Kyhlstedt. 2020. Swedish policy analysis for Covid-19. Health Policy and Technology 9, 4 (2020), 598­612.

24

Zhunis and Mai, et al.

[33] Jerome H Kim, Florian Marks, and John D Clemens. 2021. Looking beyond COVID-19 vaccine phase 3 trials. Nature medicine 27, 2 (2021), 205­211.
[34] Thomas J Kniesner and W Kip Viscusi. 2019. The value of a statistical life. Forthcoming, Oxford Research Encyclopedia of Economics and Finance (2019), 19­15.
[35] Rochelle Kopp. 2020. Does Japan's culture explain its low COVID-19 numbers? https://bit.ly/3wuua22 [36] Andrew B Lawson. 1995. MCMC methods for putative pollution source problems in environmental epidemiology.
Statistics in Medicine 14, 21-22 (1995), 2473­2485. [37] David Lee and Jaehong Lee. 2020. Testing on the move: South Korea's rapid response to the COVID-19 pandemic.
Transportation Research Interdisciplinary Perspectives 5 (2020), 100111. [38] Phenyo E Lekone and Bärbel F Finkenstädt. 2006. Statistical inference in a stochastic epidemic SEIR model with control
intervention: Ebola as a case study. Biometrics 62, 4 (2006), 1170­1177. [39] Michael Y Li and James S Muldowney. 1995. Global stability for the SEIR model in epidemiology. Mathematical
biosciences 125, 2 (1995), 155­164. [40] Shlomo Maital and Ella Barzani. 2020. The global economic impact of COVID-19: A summary of research. Samuel
Neaman Institute for National Policy Research 2020 (2020), 1­12. [41] Antoine Mandel and Vipin Veetil. 2020. The economic cost of COVID lockdowns: An out-of-equilibrium analysis.
Economics of Disasters and Climate Change 4, 3 (2020), 431­451. [42] Rendani Mbuvha and Tshilidzi Marwala. 2020. Bayesian inference of COVID-19 spreading rates in South Africa. PloS
one 15, 8 (2020), e0237126. [43] Warwick McKibbin and Roshen Fernando. 2020. The economic impact of COVID-19. Economics in the Time of COVID-19
45 (2020). [44] Warwick McKibbin and Roshen Fernando. 2020. The global macroeconomic impacts of COVID-19: Seven scenarios.
Asian Economic Papers (2020), 1­55. [45] Nicholas Metropolis, Arianna W Rosenbluth, Marshall N Rosenbluth, Augusta H Teller, and Edward Teller. 1953.
Equation of state calculations by fast computing machines. The journal of chemical physics 21, 6 (1953), 1087­1092. [46] Elias Naumann, Katja Möhring, Maximiliane Reifenscheid, Alexander Wenz, Tobias Rettig, Roni Lehrer, Ulrich Krieger,
Sebastian Juhl, Sabine Friedel, Marina Fikel, et al. 2020. COVID-19 policies in Germany and their social, political, and psychological consequences. European Policy Analysis 6, 2 (2020), 191­202. [47] D Ndanguza, JM Tchuenche, and H Haario. 2013. Statistical data analysis of the 1995 Ebola outbreak in the Democratic Republic of Congo. Afrika Matematika 24, 1 (2013), 55­68. [48] Radford M. Neal. 2012. MCMC using Hamiltonian dynamics. arXiv:1206.1901 [stat.CO] [49] Reuter News. 2021. Thailand starts COVID-19 vaccination campaign. https://reut.rs/3umlNUG [50] OECD. 2020. Beyond Containment: Health systems responses to COVID-19 in the OECD. Technical Report. OECD. [51] OECD. 2020. Hospital beds. https://doi.org/10.1787/0191328e-en [52] Australia Office of Best Practice Regulation. 2020. Best Practice Regulation Guidance Note: Value of statistical life. https://bit.ly/3unsGoO [53] Eduardo Oliveira, Amay Parikh, Arnaldo Lopez-Ruiz, Maria Carrilo, Joshua Goldberg, Martin Cearras, Khaled Fernainy, Sonja Andersen, Luis Mercado, Jian Guan, and et al. 2021. ICU outcomes and survival in patients with severe COVID-19 in the largest health care system in central Florida. PLOS ONE (2021). [54] World Health Organization. 2020. Coronavirus disease (COVID-19). https://bit.ly/34ic0Ey [55] Elizabeth M Painter, Emily N Ussery, Anita Patel, Michelle M Hughes, Elizabeth R Zell, Danielle L Moulia, Lynn Gibbs Scharf, Michael Lynch, Matthew D Ritchey, Robin L Toblin, et al. 2021. Demographic characteristics of persons vaccinated during the first month of the COVID-19 vaccination program--United States, December 14, 2020­January 14, 2021. Morbidity and Mortality Weekly Report 70, 5 (2021), 174. [56] Gaurav Pandey, Poonam Chaudhary, Rajan Gupta, and Saibal Pal. 2020. SEIR and Regression Model based COVID-19 outbreak predictions in India. arXiv preprint arXiv:2004.00958 (2020). [57] Andrew Perrault, Marie Charpignon, Jonathan Gruber, Milind Tambe, and Maimuna Majumder. 2020. Designing Efficient Contact Tracing Through Risk-Based Quarantining. NBER Working Papers (2020). https://ideas.repec. org/p/nbr/nberwo/28135.html [58] Nicola Piovella. 2020. Analytical solution of SEIR model describing the free spread of the COVID-19 pandemic. Chaos, Solitons & Fractals 140 (2020), 110243. https://doi.org/10.1016/j.chaos.2020.110243 [59] Pyro. 2021. Epidemiology . https://bit.ly/3fiv2kq [60] Kumaravel Rajakumar and Martin Weisse. 1999. Centennial year of Ronald Ross' epic discovery of malaria transmission: an essay and tribute. Southern medical journal 92, 6 (1999), 567­571. [61] Jonathan Ramkissoon. 2020. Detecting Changes in COVID-19 Cases with Bayesian Models. https://bit.ly/2Qd7GCN [62] Ehud Rinott, Ilan Youngster, and Yair E Lewis. 2021. Reduction in COVID-19 patients requiring mechanical ventilation following implementation of a national COVID-19 vaccination program--Israel, December 2020­February 2021.

Responses to COVID-19 with Probabilistic Programming

25

Morbidity and Mortality Weekly Report 70, 9 (2021), 326. [63] Ronald Ross. 1911. Some quantitative studies in epidemiology. Nature 87 (1911), 466­467. [64] Konstantin S Sharov. 2020. Creating and applying SIR modified compartmental model for calculation of COVID-19
lockdown efficiency. Chaos, Solitons & Fractals 141 (2020), 110295. [65] Han soo Lee. 2020. Korea's Covid-19 treatment costs far lower than US. https://bit.ly/3oOPKvB [66] Alexandra Teslya, Thi Mui Pham, Noortje G Godijk, Mirjam E Kretzschmar, Martin CJ Bootsma, and Ganna Rozhnova.
2020. Impact of self-imposed prevention measures and short-term government-imposed social distancing on mitigating and delaying a COVID-19 epidemic: A modelling study. PLoS medicine 17, 7 (2020), e1003166. [67] Martin T Wells, George Casella, and Christian P Robert. 2004. Generalized accept-reject sampling schemes. In A festschrift for herman rubin. Institute of Mathematical Statistics, 342­347. [68] David C Wheelock. 2020. Comparing the COVID-19 recession with the Great Depression. Available at SSRN 3745250 (2020). [69] Wikipedia. 2021. 2020 Singapore circuit-breaker measure. https://w.wiki/3NcQ [70] Wikipedia. 2021. COVID-19 lockdown in China. https://w.wiki/3NcS [71] Wikipedia. 2021. COVID-19 pandemic in Australia. https://w.wiki/3NcK [72] Wikipedia. 2021. COVID-19 pandemic in Canada. https://w.wiki/3NcU [73] Wikipedia. 2021. COVID-19 pandemic in Korea. https://w.wiki/3NcL [74] Wikipedia. 2021. COVID-19 pandemic in New Zealand. https://w.wiki/3NcR [75] Wikipedia. 2021. COVID-19 pandemic in Singapore. https://w.wiki/3NcT [76] Wikipedia. 2021. COVID-19 vaccination in India. https://w.wiki/3NcN [77] Olivier J Wouters, Kenneth C Shadlen, Maximilian Salcher-Konrad, Andrew J Pollard, Heidi J Larson, Yot Teerawattananon, and Mark Jit. 2021. Challenges in ensuring global access to COVID-19 vaccines: production, affordability, allocation, and deployment. The Lancet 397, 10278 (2021), 1023­1034. https://doi.org/10.1016/S01406736(21)00306-8 [78] Zifeng Yang, Zhiqi Zeng, Ke Wang, Sook-San Wong, Wenhua Liang, Mark Zanin, Peng Liu, Xudong Cao, Zhongqiang Gao, Zhitong Mai, et al. 2020. Modified SEIR and AI prediction of the epidemics trend of COVID-19 in China under public health interventions. Journal of thoracic disease 12, 3 (2020), 165. [79] Tianjian Zhou and Yuan Ji. 2020. Semiparametric Bayesian inference for the transmission dynamics of COVID-19 with a state-space model. Contemporary Clinical Trials 97 (2020), 106146.

