arXiv:2106.00889v1 [physics.flu-dyn] 2 Jun 2021

High-Order Large-Eddy Simulations of a Ducted Wind Turbine
Chi Ding  , Bin Zhang  , Chunlei Liang  , Kenneth D. Visser § , and Guangming Yao ¶ Clarkson University, Potsdam, NY, 13676, USA
A high-order flux reconstruction method coupled with a high-order sliding mesh method is applied to analyze the performance of a ducted wind turbine at a Reynolds number of 1.25 × 106. To investigate the impacts of the duct, axial flow simulations are also performed for the corresponding open-rotor turbine. It is shown that the ducted turbine has higher thrust and power outputs than the open rotor. Vorticity and velocity fields of two configurations are also visualized and analyzed to show the differences. To evaluate the effects of yawed flows, simulations are carried out for both turbines under five different yaw angles  = 0, ±15, ±30. The results reveal that the ducted wind turbine has higher power outputs than the open counterpart at all tested yaw angles.
I. Introduction
energy has gained growing popularity due to its clean and renewable property. One promising way to harvest
Wwind energy is the ducted wind turbine (DWT), also known as the diffuser-augmented wind turbine (DAWT).
Compared with conventional wind turbines, a DWT is equipped with a duct in order to increase power output, and has the potential to exceed the Beltz limit [1]. To design an efficient DWT, accurate estimates of its loads and the flow fields are of crucial importance. In addition, it is quite often that a DWT operates under yawed inflow conditions when it is surrounded by buildings in urban environment, or is installed with yawed misalignments. There is thus a natural need to study the loads under yawed conditions.
Many efforts have been made to numerically study DWTs. Fletcher [2] used the Blade Element Momentum (BEM) method to investigate DWTs. Georgalas et al. [3] combined the lifting-line approach for the rotors and the lifting-surface method for the ducts to study DWTs with large tip clearance. Recently, one of the most popular ways to study DWT is the CFD actuator-disk (CFD-AD) method, which models the rotor by an actuator disk and simulate the flow fields by CFD methods. The first research using the CFD-AD method was done by Hansen et al. [4]. This method was also employed to investigate a turbine with a flanged diffuser [5]. Venters et al.[6] utilized the CFD-AD method to study the effects of a duct's geometrical parameters on the rotor's performance. With increasing computational power, it is now possible to perform more accurate CFD simulations of a complete DWT without simplifications of the geometries.
High-order CFD methods (third and above orders) are more accurate and efficient than low-order methods[7]. The most popular high-order methods include the Discontinuous Galerkin (DG) methods[8, 9], the Spectral Element (SE) method[10, 11], the Spectral Difference (SD) method[12­15], and the Flux Reconstruction (FR) method[16, 17]. Among them, the SD and the FR methods are based on the differential form governing equations, and are among the most efficient high-order methods. The FR method has an additional advantage that this scheme provides a unifying framework that many existing high-order schemes, e.g. DG and SD schemes, and even some new schemes can be recovered by choosing different correction functions[16]. The FR method has seen a lot of progress recently. Jameson et al.[18] performed a nonlinear stability analysis for the FR method. Many researchers have successfully extended FR schemes to mixed elements [19­23]. More recent developments about the FR scheme can be found in a review paper[24].
To deal with flows over rotating objects, Zhang et al. [25, 26] introduced the curved dynamic mortar concept and applied it to the development of high-order sliding-mesh SD and FR methods. These methods were later extended to sliding-deforming meshes [27] and to deal with 3D geometries [28]. Zhang et al. [29­31] further introduced the transfinite mortar concept that has no geometric error and makes a sliding-mesh method arbitrarily high-order accurate in space and high-order in time. This method has been applied to simulate flows around rotating cylinders of
Graduate Student in the Department of Mechanical and Aeronautical Engineering, chid@clakrson.edu Research Assistant Professor in the Department of Mechanical and Aeronautical Engineering, bzhang@clarkson.edu Professor in the Department of Mechanical and Aeronautical Engineering, and AIAA Associate Fellow, cliang@clarkson.edu §Associate Professor in the Department of Mechanical and Aeronautical Engineering, AIAA Senior Member, kvisser@clarkson.edu ¶Associate Professor in the Department of Mathematics, gyao@clarkson.edu
1

different cross-sectional shapes [32], flapping wings for energy harvesting [33], and more recently the first high-order eddy-resolving simulation of flow over a marine propeller [34]
This study employs the solver developed by Zhang et al. to study the loads and flow fields of a wind turbine in a ducted and an open configurations. The geometries, including the duct and the rotors, are represented accurately using curved high-order meshes. Both axial flow and yawed flow cases are simulated in this work. The rest of paper is organized as follows: Section II introduces the numerical methods including the FR method and the sliding-mesh method based on the concept of dynamic mortar element. Then the simulation setup is given in Section III. Following that, we present and analyze the numerical results in Section IV. Finally, Section V concludes this paper.

II. Numerical Methods

A. The Governing Equations

1. The Physical Equations We numerically solve the following three-dimensional unsteady Navier-Stokes equations in a conservative form,

Q F G H

+ + + = 0,

(1)

   

where Q is the vector of conservative variables, F, G, and H are the flux vectors in each coordinate direction. These terms have the following expressions,

Q = [    ] ,

(2)

F = Finv (Q) + Fvis (Q, Q),

(3)

G = Ginv (Q) + Gvis (Q, Q),

(4)

H = Hinv (Q) + Hvis (Q, Q),

(5)

where  is fluid density, ,  and  are the velocity components,  is the total energy per volume defined as



=

/(

-

1)

+

1 2

(2

+

2

+

2),



is

pressure,



is

the

ratio

of

specific

heats

and

is

set

to

1.4.

The

fluxes

have

been

split into inviscid and viscous parts. The inviscid fluxes are only functions of the conservative variables and have the

following expressions,

  

  

  

















 2 +  





  





  













Finv

=

 



 ,

Ginv

=

 

2

+



 

,

Hinv

=

 



 .

(6)

















  





  

 

2

+



 













( + )

 

(

+

)

 

(

+

)













The viscous fluxes are functions of the conservative variables and their gradients. The expressions are

Fvis = - 0     +  +  +  ,

(7)

Gvis = - 0     +  +  +  ,

(8)

Hinv = - 0     +  +  +  ,

(9)

where   is shear stress tensor which is related to velocity gradients as   = (,  +  ,) +   , ,  is dynamic viscosity,  = -2/3 based on Stokes' hypothesis,   is the Kronecker delta,  is thermal conductivity,  is temperature that is related to density and pressure through the ideal gas law  = , where  is the gas constant.

2

2. The Computational Equations
As will be discussed later, we map each moving grid element from the physical space to a stationary standard cubic element in the computational space where the equations are solved. Assume the mapping is:  = ,  = (, , , ),  = (, , , ) and  = (, , , ), where (, , , ) are the computational time and space. It can be shown that the
flow equations will take the following conservative form in the computational space,

Q + F + G + H = 0,

(10)

   

and the computational variable and fluxes are related to the physical ones through

Q

Q









F 

=

|J |J -1

F 

,

G

G

(11)





H

H





where |J | is determinant of the Jacobian matrix and J -1 is the inverse Jacobian matrix, and their expressions are

1000

|J | = (, , , ) = 





 ,

(, , , )     

(12)

   

10 0 0

J -1 =  (, , ,  ) = 





 .

(, , , )    

(13)

   

Besides the flow equations, the Geometric Conservation Law(GCL) [35] also needs to be numerically satisfied to ensure free-stream preservation on moving grids. The GCL equations and the steps for solving them are described in [30, 31, 34]

B. The Flux Reconstruction Method

The meshes in this work consist of hexahedral elements only. The first step of the FR method is to map each hexahedral element to a standard cubic element of unit size, i.e., 0  , ,   1.This can be done using the following

iso-parametric mapping,



 ()

 



 

=



 (,

,

)

 

(

)

,

(14)





  =1 

 



(

)

 





where  is the number of nodes of a hexahedral element,  (detailed expressions can be found in [36]) is the shape function of the -th node, and (, , ) are the coordinates of the -th node. Next, solution points (SPs, denoted by )

and flux points (FPs, denoted by   ) are defined along each coordinate direction in the standard element. Fig. 1 shows a schematic of the distribution of the SPs and FPs in the  -  plane for a fourth-order FR method. Generally, for an

-th order FR scheme, there are  SPs and FPs in each direction, where the SPs are in the interior and the FPs are on

the boundaries of the standard element. The SPs and FPs are chosen as the Legendre points in this work.

3

Fig. 1 Schematic of solution points (circles) and flux points (squares) in the  -  plane for a fourth-order FR method.

Subsequently, Lagrange interpolation bases are defined at each SP. For instance, at the -th SP we have

 ()

=


(
=1,

 

-  - 

).

(15)

The resulting bases also form a basis of polynomials of degrees less than or equal to  - 1, i.e., P -1.These interpolation bases allow the construction of solution and flux polynomials inside each element through tensor products. For example,



  

Q(, , ) =

Q   ()  () ( ),

(16)

=1 =1 =1



  

F(, , ) =

F   ()  () ( ),

(17)

=1 =1 =1

where the subscript    denotes the discrete value at the   -th SP. All these polynomials are in P -1, -1, -1. The above solution and flux polynomials are continuous within each element, but discontinuous across cell boundaries. Therefore, common values need to be defined on cell boundaries. There are various ways to calculate these common values. In this work, the common solution is calculated as the average of the discontinuous values from the two sides of a boundary; the common inviscid fluxes are computed using the Rusanov solver[37]; the common viscous fluxes are computed from the common solutions and common gradients. There is one more issue: after taking the first-order spatial derivatives in the governing equations, the three flux terms become elements in P -2, -1, -1, P -1, -2, -1, and P -1, -1, -2, respectively, and are inconsistent with the solution term. To fix this issue, the original fluxes need to be reconstructed. This is done by using correction functions that are polynomials of degree no less than . Taking the flux in the  direction as an example, the reconstructed flux polynomial is

F = F(, ,  ) + [Fcom (0, ,  ) - F(0, ,  )] ·  () + [Fcom (1, ,  ) - F(1, ,  )] ·  (),

(18)

where F is form (17); Fcom represents the common flux on a cell boundary;  and  are the left and right correction

functions, and are required to satisfy

 L

(0)

=

1,

 L

(1)

=

0,

 R

(

0)

=

0,

 R

(1)

=

1,

(19)

which ensures that

F(0, ,  ) = Fcom (0, ,  ), F(1, ,  ) = Fcom (1, ,  )

(20)

i.e., the reconstructed fluxes still take the common values at cell interfaces. In this work, we have employed the  correction function[16]. The other two fluxes are reconstructed in the same way. Finally, the governing equations can be written in the following residual form,

 = - F + G + H = R  , , ,  = 1, 2, · · · , ,

(21)



  





4

where R  is the residual at the (, , )-th SP. This system can be time marched explicitly or implicitly. In the present work, we choose a four-stage three-order explicit Runge-Kutta method. More details can be found in [38, 39] .
C. A Sliding Interface Method In three-dimensions, we consider two types of sliding interfaces as depicted in Fig. 2: one is annular, and the other
is cylindrical. To simplify the explanation, we have required the mesh to only unmatch in the azimuthal direction but match in the radial (for annular sliding) or axial (for cylindrical sliding) direction. We also require equal mesh size in the azimuthal direction. These restrictions are imposed for explanation purposes only and can be easily lifted in practice. More details can be found in our previous papers [25­31, 34].

Fig. 2 Two types of sliding meshes: left, annular sliding; right, cylindrical sliding.
Since the SPs on the two sides of a nonconforming sliding interface do not match, we aim to find the best-possible common values of a variable on the two sides of a sliding interface. This can be achieved by least-squares projections using mortar elements as the intermediate medium. A mortar element is formed by the overlapping region of two cell faces. Taking the cylindrical sliding interfaces as an example, based on the assumptions we have made, a cell face has two mortar elements as sketched in Fig. 3. The first step is to map a cell face and the mortars to standard ones as shown in the same figure, using, for example, iso-parametric mapping or transfinite mapping.

Fig. 3 Map curved cell face and mortars to straight ones.

Let the ( ,  ) denote the mortar space, then the computational and the mortar spaces are related as

 =  +  ,  = 

(22)

where 0  , , ,   1, and  and  are the offset and scaling of a mortar with respect to a cell face. Let  represent the variable of interest, and obviously it can be represented by the following polynomials on a cell

5

face  and on the left side of a mortar ,



 (,

)

=










()



(),

(23)

=1 =1



, (

,

)

=





,






(

) (

),

(24)

=1 =1

where




and

, 



are

the

discrete

values

at

the

(,

 ) -th

SP

on



and

the

left

side

of

,

respectively.

The

(,




),

s

are

unknown, and can be obtained through the following projection (refer to Fig. 4a)

 1 1

(, ( ,  ) -  (, )) ( ) ( )d d = 0, ,  = 1, 2, ...,  .

(25)

00

Considering the relations in (25), it can be shown that the above two-dimensional projections is equivalent to the one-dimensional one,

1

(, ( ,   ) -  (,   )) ( )d = 0,  = 1, 2, ...,  .

(26)

0

where   is the coordinate of the -th SP. Evaluating the above equation for all the ,s, we will get a system of equations

, 

,

about


1:

,



.

Repeating

this

process

for

every

,

we

will

obtain

every




. The values on the right side of a mortar,

i.e.,the

(,


)

,

,

can

be

obtained

in

the

same

way.

(a)

(b)

Fig. 4 Projection between face and mortar: (a) from face to the left side of a mortar, (b) from two mortars back to a face.

After that, we can compute a common value on the mortar, e.g., through averaging or Riemann solver. Let us denote this common values as . We then project this common variable back to a cell face from mortars as shown in Fig. 4b.
And the projection is

 2  1 ( (, ) - 1 ( ,  )) () ()dd

00
(27)

 1 1

+

( (, ) - 2 ( ,  )) () ()dd = 0, ,  = 1, 2, ...,  .

2 0

where  represents the polynomial of the unknown common variable on face . Similarly, this projection is equivalent

to the following one-dimensional projection,

 2

1

( (,   ) - 1 ( ,   )) ()d + ( (,   ) - 2 ( ,   )) ()d = 0,  = 1, 2, ...,  . (28)

0

2

from

which


1: , 

are

obtained,

and

then

also

every




by

representing

this

process

for

.

6

III. Simulation Setup
A. Geometry The ducted wind turbine was designed by Prof. Visser at Clarkson University. Fig. 5 illustrates the duct and rotor
in both the front and lateral views. As shown in Fig. 5, the inlet radius of the duct is 0.456m, and the exit radius is 1.832m. For the duct section, the width is 0.612m, and the angle of attack is 25. The rotor has three 1.5m long blades, and the cylindrical hub is closed by two hemispherical ends of which the diameter is 0.456m. The rotor in the open configuration has the same size as that of the ducted configuration.

Fig. 5 The ducted wind turbine geometry: left, front view; right, lateral view.
B. Computational Mesh In this study, unstructured hexahedral meshes are used for the simulation. Each computation mesh consists of a
rotating part and a stationary part. The rotating part includes the rotor. Fig. 6 shows the surface mesh of the duct, the rotor, and the front sliding interface, for the ducted case. For this case, the rotating subdomain has two sliding interfaces. One interface is visible in Fig. 6b, and the other interface is behind the duct. The height of the first mesh layer on the blades is set to 6 × 10-3 , and the first off-wall solution point is located 2.8 × 10-4 away from the blades (for the fifth-order scheme). Fig. 7 illustrates the surface meshes on the rotor and sliding interfaces for the open-rotor

(a)

(b)

Fig. 6 Computational mesh of the ducted configuration: (a) rotor and duct, (b) sliding interface.

configuration. It can be seen that the mesh distribution of the rotor is almost the same as that of the ducted one, and this rotating subdomain has three sliding interfaces: two in the axial direction, and one in the azimuthal direction. The radius of this rotating part is 1.5 , and is larger than that of the ducted case because we need more space to achieve a smooth transition from the blade tip to the azimuthal sliding interface on which an orthogonal mesh distribution is needed. Both the ducted and open-rotor cases have the same cylindrical farfield as shown in Fig. 8. The inlet is located 6 ahead of the rotor, and its radius is 30 . The outlet is placed 24 behind the rotor. The blockage ratio

7

(a)

(b)

Fig. 7 Computational mesh of the open-rotor configuration: (a) rotor, (b) sliding interfaces.

is 0.44%. For the ducted case, the rotating part has 29,469 hexahedral elements, and the stationary part has 262,941 elements. In total, the mesh has 292,410 elements. A fifth-order FR scheme in space is employed, and the resulting number of degrees of freedom is 36.6 million. The open case has 38,454 hexahedral elements on the rotating subdomain, and 258,621 elements on the stationary subdomain. The resulting number of degrees of freedom is 37.1 million.
For the boundary conditions, the inlet is treated as a Dirichlet boundary, the outlet, and the outer boundary as characteristic farfields. The duct and blade surfaces are set as no-slip adiabatic walls. The freestream Mach number  is set to 0.08 to ensure that the compressibility effect is negligible.

(a)

(b)

(c)

Fig. 8 Computational mesh of the ducted wind turbine: (a) overall view, (b) front view (c) lateral view.

C. Nondimensional Parameters

Table 1 Operating conditions.

Parameter

Value

Freestream velocity

10 m/s

Kinematic vicosity 1.4616 × 10-5

Rotation axis

x-direction

Rotation speed -26.18 rad/s

The operating conditions for the wind turbine are listed in Table 1. Based on this table, two governing nondimensional parameter can be obtained. One is the Reynolds' number  = / = 1.25 × 106, where  is the freestream

8

velocity,  is the duct's exit radius, and  is kinematic viscosity. Since the Reynolds number is very high, the flow
around the turbine will become quite turbulent, and the simulation may become unstable due to the aliasing error[18], To reduce the instability, a filter reported in [40] (with strength  = 0.5) is employed during the simulation.
Another governing parameter is the nondimensional angular speed  = / = -4.79. For the present work, the nondimensional time step size is  / = 2.5 × 10-5, which means that the turbine rotates 0.0069 degrees per
time step and thus the turbine's rotation can be simulated accurately. All the simulations are run over 37.5 time units (about 27 revolutions). From  / = 25, we start to collect data to
compute the averaged flow field. The averaging calculation is performed over around 9.5 revolutions. For the rotating
part, we can obtain the phase-averaged statistics. For the stationary part, the time-averaged statistics can be computed.

IV. Results and Discussions
A. Axial Flow
1. Load Analysis To study the loads on the turbine quantitatively, two performance characteristics are calculated: thrust coefficient
 , and power coefficient . They are defined as below.



 =

(29)

1 2

2







 =

1 2

3





(30)

where  is the thrust acted on the rotor,  is the torque in the x-direction, and  is the area of the rotor rotation plane. It should be noted that in this study we only consider the thrust acted on the rotor rather than on all the components. Fig. 9 demonstrates the time histories of  and  for the two configurations. In both cases, thrust and power outputs have reached a steady state with high-frequency fluctuations caused by the turbulent flows.
Table 2 lists the mean values and the r.m.s (root-mean-square) deviations of  and , their pressure and viscous components. For both configurations, the pressure contributions for  and  are dominant, and the r.m.s values are about two magnitudes smaller than corresponding mean values. It can be seen that the rotor in the ducted case has larger mean loads than its open-rotor counterpart. Both the mean  and the mean  of the ducted case are about 50% higher than that of the open-rotor case. The ducted case also has a higher root-mean-square deviations for  and  than the open-rotor case, i.e., the load fluctuations for the ducted one are stronger.

Table 2 Loads for the ducted and open-rotor cases.

Ducted



 , 

 ,



, 

,

mean 9.47E-01 9.47E-01 1.97E-04 5.60E-01 5.61E-01 -1.19E-03

r.m.s 1.43E-02 1.43E-02 1.46E-06 8.30E-03 8.29E-03 1.25E-05

mean 6.30E-01 6.30E-01 1.97E-04 3.61E-01 3.62E-01 -1.31E-03 Open-rotor
r.m.s 6.13E-03 6.13E-03 8.28E-07 2.03E-03 2.03E-03 4.81E-06

To better understand the load distributions on the blades, we plot the phase-averaged pressure contours on the blade surfaces in Figs. 10 and 11. For the ducted configuration, the upstream face experiences a higher pressure than the downstream face. Thus the rotor experience a drag force pointed towards x-direction. The outboard part of blades, especially the area around the leading edge, has a higher pressure difference, which means the loads concentrate in this region.
For comparison, the open rotor's phase-averaged pressure contours are given in Fig. 11. A similar pressure distribution as the ducted one is observed. One major difference is that the downstream face has smaller low pressure

9

(a) Ducted
(b) Open-rotor Fig. 9 Time histories of loads in the two configurations

(a) upstream

(b) downstream

Fig. 10 Phase-averaged pressure contours of the blades in the ducted configuration.

area than that of the ducted configuration, which leads to a lower  than the ducted one. For the ducted case, the phase-averaged pressure contours at different streamwise locations are shown in Fig. 12. It can be seen that due to the pressure difference between two sides of the blade, all three blade sections experience a torque pointed towards the negative x-axis. This torque direction is the same as the rotation direction, which means a positive work is done on the rotor and the wind energy is transferred to the rotor's mechanical energy. High pressure difference appears on the outboard region, which means most of torque comes from this region. We also plot the phase-averaged pressure field around the open rotor in Fig. 13. A similar trend for pressure distribution is observed. The rotor in this configuration also experiences a torque in the same direction as its rotation, and has the main load on the blades' outboard part.

10

(a) upstream

(b) downstream

Fig. 11 Phase-averaged pressure contours of the blades in the open-rotor configuration.

(a) x=0.03R

(b) x=0.04R

(c) x=0.05R

Fig. 12 Phase-averaged pressure contours of the ducted configuration at different streamwise locations.

(a) x=0.03R

(b) x=0.04R

(c) x=0.05R

Fig. 13 Phase-averaged pressure contours of the open-rotor configuration at different streamwise locations.

2. Wake Dynamics To investigate the wake dynamics of the two configurations, isosurfaces of instantaneous Q-criterion colored by the
streamwise velocity are plotted in Figs. 14 and 15. For the ducted case, as shown in Fig.14, a lot of vortices are shed from the duct's inner surface. The wake area is wrapped by these small vortex structures from the duct exit to  = 10.

11

To obtain more details, in Fig. 14, we also plot isosurfaces of Q-criterion with the area  >= 0.5 blanked. It is seen that a lot of trailing vortices are generated, and they are well resolved even up to  = 10, which means the wake area is filled with small flow structures.
Fig. 14 Isosurface of instantaneous Q-criterion  2/ = 15 of the ducted case.
Fig. 15 Isosurface of instantaneous Q-criterion  2/ = 15 of the open-rotor case. Fig.15 presents Q-criterion isosurfaces of the open-rotor case. As can be seen, this case has much stronger and more coherent tip vortices compared with the ducted case. When the area  >= 0.5 is blanked, we can clearly see that a hub
12

vortex is formed just behind the hub end and remains stable for a very long distance. Compared with the ducted case, the flow around the open rotor does not have strong vortices shedding off from blade trailing edges, and thus has a load with smaller r.m.s deviation values.
The velocity vector can be decomposed into three components: streamwise velocity , radial velocity  , and azimuthal velocity   . Time-averaged values of these components are visualized in the central  -  plane in Figs. 16, 17, and 18.

(a) Dcuted

(b) Open-rotor

Fig. 16 Time-averaged streamwise velocity contours in the central x-y plane

As shown in Fig.16, both the ducted and open-rotor cases have an area with low streamwise velocity behind the hub
end. For the ducted configuration, the low-velocity area expands in the radial direction as the flow moves downstream. After  = 4, this area begins to shrink. On the contrary, the low-speed area of the open-rotor case almost keeps its radial size until  = 9, and then gradually vanishes, of which the shape is similar as the hub vortex shown in Fig. 15.

(a) Dcuted

(b) Open-rotor

Fig. 17 Time-averaged radial velocity contours in the central x-y plane

Fig. 17a presents the time-averaged radial velocity contour for the ducted case. The area around the duct has a large positive radial velocity because the duct's diverging shape make the flow travels away from the central axis. Another high radial velocity region appears near the hub end, which means that the flow expands after it moves past the end. For the open-rotor case, there is no high radial velocity region like the ducted one.

(a) Dcuted

(b) Open-rotor

Fig. 18 Time-averaged azimuthal velocity contours in the central x-y plane

Fig. 18 demonstrates the time-averaged azimuthal velocity fields in the x-y plane. In the open-rotor case, two high azimuthal velocity zones near the central line appear, which means that at this place the flow rotates quickly around the central axis, and is consistent with the hub vortex seen in Fig. 15. For the ducted case, only the flow around the hub end rotates quickly.

13

(a) x=R

(b) x=3R

(c) x=5R

(d) x=7R

(e) x=9R

Fig. 19 Time-averaged streamwise velocity contours for the ducted case at different streamwise locations

To obtain more details of the streamwise velocity field, we plot the time-averaged streamwise velocity contours at five different streamwise locations for the ducted and open-rotor configurations in Figs. 19 and 20, respectively. From Fig. 19a, it can be observed that a circular low-velocity region at the central part, which are circumscribed by two ring regions with higher velocity. The central circular area corresponds to the wake just behind the hub end, and the inner ring region corresponds to the wake behind the area between the duct and the hub. As the flow moves downstream, boundaries between these regions become unclear due to the momentum exchange between different regions. At  = 9, these areas are totally mixed together. In Fig. 20, we can also see three regions for the open-rotor configuration. However, the

(a) x=R

(b) x=3R

(c) x=5R

(d) x=7R

(e) x=9R

Fig. 20 Time-averaged streamwise velocity contours for the open-rotor case at different streamwise locations.

area of the central low-velocity circular region is much less than that in Fig.19, The inner ring region is formed by the
flow past the rotor's blades. The central area keeps its shape until x=9R. The boundary between two ring areas become obscure after  = 3. However, these region are not blended together even when the flow moves downstream to  = 9.
One explanation for this difference is that the ducted turbine's wake is filled with small flow structures, and thus has a
higher rate of momentum exchange, which leads to the difference of velocity between regions disappear more quickly.
To quantitatively compare the two configurations' wakes, time-averaged streamwise velocity profiles are plotted in Fig. 21. Overall these profiles are symmetrical about  = 0. The wake behind the ducted turbine has more velocity loss. When  = , the ducted configuration has an almost stationary flow in the area -0.5  /  0.5, which corresponds to the hub wake. As || increases, the velocity of the ducted turbine increases quickly, and then has two local maximum / = 0.3 at /  1, i.e. the duct exit radius. The flow at  =  continues to recover as || increase, and reach the freestream velocity / = 1 when ||/  1.2. By contrast, the open-rotor case has a spike around  = 0 with a local minimum / = 0, and recovers quickly to / = 1 when ||/  1.
When the flow moves downstream, the ducted case's velocity profiles has only one minimum for   3, and is still smaller than that of the open-rotor one when   7. When  = 9, the two profiles have a similar shape with a minimum value /  0.2. Among other regions, the ducted case's velocity is smaller than the open-rotor one. The open-rotor configuration keeps its spike at  = 0 until  = 7. The locations where two profiles reach the steady state
remain unchanged.

14

(a) x=R

(b) x=3R

(c) x=5R

(d) x=7R

(e) x=9R

Fig. 21 Time-averaged streamwise velocity profiles at different streamwise locations in the central x-y plane.

B. Yawed Flow
This section focuses on the yawed flows. To facilitate the description, two geometric parameters: yaw angle and azimuthal angle, are defined and shown in Fig. 22. In this study, yaw angle is denoted as the angle between the x-axis and the flow direction in the central x-y plane. Azimuthal angle is defined as angle between the blade axis and the horizontal line shown in Fig.22. Initial azimuthal angles for three blades are 30, 150, and 270. For the yawed flow,

(a) Yaw angle

(b) Azimuthal angle

Fig. 22 Two angle definitions0 for yawed flow.

we consider five different yaw angles: 0, ±15, and ±30 for two configurations. Fig 23 compares the time-averaged
 of two configurations for different yawed conditions. It can be seen that both the ducted turbine and the open-rotor turbine's  are symmetrical about  = 0, and decrease with the growing yaw angle magnitude. Even though the ducted turbine experiences a larger drop on  (about 0.2) from 0 to 30 than the open-rotor one (about 0.04), the
ducted rotor experiences a larger thrust on every yawed angle. To compare the relative change, in Fig. 23b we normalize both configurations'  by their own  at  = 0. It can be found that relative changes of  for the open-rotor cases are smaller than that of the ducted ones. Especially, for  = ±30, the open rotor only experiences about 6% thrust drop,
much less than the 20% for the ducted case.
As shown in Fig. 24, the   curves for yawed conditions have a similar trend as the  curves, which have a symmetry about  = 0 and see a drop as the yaw angle grows. The ducted turbine has more power output than the open rotor in all yawed cases, and experiences a drop by 0.12 on its   value when  = ±30. In comparison, the open
rotor only decreases by 0.05. In terms of the relative change in  , the ducted configuration has a much larger drop (about 30%) for  = ±30, whereas the open-rotor case only drops by about 18%. The   values are symmetric with

15

(a) 

(b) Normalized 

Fig. 23 Time-averaged  for two configurations under yawed flow.

respect to  = 0, and decrease as  increases. The ducted rotor have more power output than the open rotor on all yawed angles. For  = ±15, relative changes for two configurations are similar (around 5%). However, the ducted configuration has a much larger relative decrease on power output (about 30%) for  = ±30. The open-rotor case only
experiences around 18% decrease on  .

(a) 

(b) Normalized 

Fig. 24 Time-averaged  for the two configurations under yawed flows.

 , i.e., the azimuthal-averaged  can be computed by averaging  values at the time instant when the azimuthal angle is equal to a given value, like 90. Fig. 25 shows  of blade 1 for  = 0, ±15, which is normalized by the
corresponding  . We see that all yawed cases have a sine-like fluctuation during one period. One major cause is the
blade advancing and retreating effects reported in [41]. When the turbine blade rotates in yawed flows, it will move
upstream during half of the rotation period, and move downstream during the other half of the period, which results
in the variation of the relative velocity and then the variation of angle of attack. Thus a fluctuation in thrust is seen during one revolution. When  = 0,  remain stable around  for both configurations. Both cases have a 180 phase difference for  values between  = 15 and  = -15. For  = -15, ducted cases has a maximum at  = 180, whereas open-rotor cases has its maximum at around  = 120 and has a larger amplitude (about 1.1). As shown in Fig. 26, For  = ±30, these  curves have the same phase difference between the positive yaw angle and the negative yaw

16

(a) Ducted

(b) Open-rotor

Fig. 25 Azimuthal-averaged  of the blade 1 for yaw angle  = 0, ±15.

angle. Both configurations' maximum values appear at  = 120. However the ducted one has a larger amplitude (about 1.3), and has another local maximum at around  = 250 due to the duct's effects.

(a) Ducted

(b) Open-rotor

Fig. 26 Azimuthal-averaged  of the blade 1 for yaw angle  = 0, ±30.

V. Conclusion
In this study, we perform high-order large eddy simulations for a wind turbine under two configurations: ducted and open-rotor.
For the axial flow situation, a comparison of the thrust coefficient  and the power coefficient  between the two cases is made. It is found that the ducted one has higher mean values for thrust and power output than its bare counterpart, and also has higher r.m.s deviation values, which means stronger load fluctuations. To better understand the load distribution, time-averaged pressure fields on the blade surfaces and near-blade regions. We see that the two configurations experience a drag force pointed towards the x axis, and a torque pointed towards the negative x axis, and the load concentrates on the outboard part of the blades, especially around the leading edges. To investigate the wake dynamics, Q-criterion isosurfaces are plotted. It is found that the wake of the ducted turbine is filled with small flow
17

structures, whereas the open rotor has a coherent hub vortex and weak tip vortices that are dissipated quickly by the flow. The time-averaged velocity contours for three components: ,  , and   are also presented. We found that the ducted case has a larger low-velocity wake area behind the hub end. In comparison, the open-rotor configuration has a thinner band region with low streamwise velocity and high azimuthal velocity. Streamwise velocity contours at different streamwise locations reveal that the wake behind the ducted rotor has a faster rate of momentum exchange.
For the yawed flow situations, we compare  and  of the two configurations. For all tested yaw angles, the ducted one has a higher thrust and power output than its bare counterpart. However, the ducted case experiences a larger drop on  and  in both absolute and relative senses. We also compute  , i.e., the azimuthal-averaged  , for one blade. Due to the blade advancing and retreating effect, each yawed case's curve has some fluctuations. And there is a 180 phase difference between two flows with the same magnitude but opposite signs.
To better understand the performance of the ducted wind turbine, we will perform simulations for different tip speed ratios in the future.
Acknowledgments
The authors would like to express our acknowledgments to Clarkson University for financial support through the IGNITE Fellowship Program.
References
[1] Oka, N., Furukawa, M., Yamada, K., Kawamitsu, K., Kido, K., and Oka, A., "Aerodynamic design optimization of wind-lens turbine," ASME 2013 Fluids Engineering Division Summer Meeting, 2013.
[2] Fletcher, C. A., "Computational analysis of diffuser-augmented wind turbines," Energy Conversion and Management, Vol. 21, No. 3, 1981, pp. 175­183.
[3] Georgalas, G., Koras, A., and Raptis, S., "Parameterization of The Power Enhancement Calculated for Ducted Rotors with Large Tip Clearance." Wind Engineering, Vol. 15, 1991.
[4] Hansen, M. O. L., Sørensen, N. N., and Flay, R. G. J., "Effect of Placing a Diffuser around a Wind Turbine," Wind Energy, Vol. 3, No. 4, 2000, pp. 207­213.
[5] Ohya, Y., Uchida, T., Karasudani, T., Hasegawa, M., and Kume, H., "Numerical Studies of Flow around a Wind Turbine Equipped with a Flanged-Diffuser Shroud Using an Actuator-Disk Model," Wind Engineering, Vol. 36, No. 4, 2012, pp. 455­472.
[6] Venters, R., Helenbrook, B. T., and Visser, K. D., "Ducted wind turbine optimization," Journal of Solar Energy Engineering, Vol. 140, No. 1, 2018.
[7] Wang, Z. J., Fidkowski, K., Abgrall, R., Bassi, F., Caraeni, D., Cary, A., Deconinck, H., Hartmann, R., Hillewaert, K., Huynh, H. T., et al., "High-order CFD methods: current status and perspective," International Journal for Numerical Methods in Fluids, Vol. 72, No. 8, 2013, pp. 811­845.
[8] Reed, W. H., and Hill, T. R., "Triangular mesh methods for the neutron transport equation," Tech. rep., Los Alamos Scientific Lab., N. Mex.(USA), 1973.
[9] Cockburn, B., Karniadakis, G. E., and Shu, C.-W., Discontinuous Galerkin methods: theory, computation and applications, Vol. 11, Springer Science & Business Media, 2012.
[10] Patera, A. T., "A spectral element method for fluid dynamics: laminar flow in a channel expansion," Journal of computational Physics, Vol. 54, No. 3, 1984, pp. 468­488.
[11] Karniadakis, G., and Sherwin, S., Spectral/hp element methods for computational fluid dynamics, Oxford University Press, 2013.
[12] Kopriva, D. A., and Kolias, J. H., "A conservative staggered-grid Chebyshev multidomain method for compressible flows," Journal of computational physics, Vol. 125, No. 1, 1996, pp. 244­261.
[13] Kopriva, D. A., "A conservative staggered-grid Chebyshev multidomain method for compressible flows. II. A semi-structured method," Journal of computational physics, Vol. 128, No. 2, 1996, pp. 475­488.
18

[14] Kopriva, D. A., "A staggered-grid multidomain spectral method for the compressible Navier­Stokes equations," Journal of computational physics, Vol. 143, No. 1, 1998, pp. 125­158.
[15] Liu, Y., Vinokur, M., and Wang, Z. J., "Spectral difference method for unstructured grids I: Basic formulation," Journal of Computational Physics, Vol. 216, No. 2, 2006, pp. 780­801.
[16] Huynh, H. T., "A flux reconstruction approach to high-order schemes including discontinuous Galerkin methods," AIAA paper 2007-4079, 2007.
[17] Huynh, H. T., "A reconstruction approach to high-order schemes including discontinuous Galerkin for diffusion," AIAA paper 2009-403, 2009.
[18] Jameson, A., Vincent, P. E., and Castonguay, P., "On the non-linear stability of flux reconstruction schemes," Journal of Scientific Computing, Vol. 50, No. 2, 2012, pp. 434­445.
[19] Castonguay, P., Williams, D., Vincent, P., Lopez, M., and Jameson, A., "On the development of a high-order, multi-GPU enabled, compressible viscous flow solver for mixed unstructured grids," 20th AIAA Computational Fluid Dynamics Conference, 2011, p. 3229.
[20] Haga, T., Gao, H., and Wang, Z., "A high-order unifying discontinuous formulation for 3-D mixed grids," 48th AIAA Aerospace Sciences Meeting Including the New Horizons Forum and Aerospace Exposition, 2010, p. 540.
[21] Haga, T., Gao, H., and Wang, Z. J., "A high-order unifying discontinuous formulation for the Navier-Stokes equations on 3D mixed grids," Mathematical Modelling of Natural Phenomena, Vol. 6, No. 3, 2011, pp. 28­56.
[22] Lu, Y., Yuan, X., and Dawes, W., "Investigation of 3D internal flow using new flux-reconstruction high order method," Turbo Expo: Power for Land, Sea, and Air, Vol. 44748, American Society of Mechanical Engineers, 2012, pp. 2195­2216.
[23] Vincent, P., Farrington, A., Witherden, F., and Jameson, "An extended range of stable-symmetric-conservative Flux Reconstruction correction functions," Computer Methods in Applied Mechanics and Engineering, Vol. 296, 2015, pp. 248­272.
[24] Wang, Z. J., and Huynh, H. T., "A review of flux reconstruction or correction procedure via reconstruction method for the Navier-Stokes equations," Mechanical Engineering Reviews, Vol. 3, No. 1, 2016, pp. 15­00475­15­00475.
[25] Zhang, B., and Liang, C., "A simple, efficient, high-order accurate sliding-mesh interface approach to FR/CPR method on coupled rotating and stationary domains," AIAA paper 2015-1742, 2015.
[26] Zhang, B., and Liang, C., "A simple, efficient, and high-order accurate curved sliding-mesh interface approach to spectral difference method on coupled rotating and stationary domains," Journal of Computational Physics, Vol. 295, 2015, pp. 147­160.
[27] Zhang, B., Liang, C., Yang, J., and Rong, Y., "A 2D parallel high-order sliding and deforming spectral difference method," Computers & Fluids, Vol. 139, 2016, pp. 184­196.
[28] Zhang, B., and Liang, C., "A high-order sliding-mesh spectral difference solver for simulating unsteady flows around rotating objects," 31st Symposium on Naval Hydrodynamics, Monterey, CA, 2016.
[29] Zhang, B., Qiu, Z., and Liang, C., "A flux reconstruction method with nonuniform sliding-mesh interfaces for simulating rotating flows," AIAA paper 2018-1094, 2018.
[30] Zhang, B., and Liang, C., "A conservative high-order method utilizing dynamic transfinite mortar elements for flow simulation on curved sliding meshes," arXiv preprint arXiv:2009.04400, 2020.
[31] Zhang, B., and Liang, C., "A high-order sliding-mesh method for flow simulation about complex 3D rotating geometries," Under review, 2021.
[32] Zhang, B., and Liang, C., "High-order numerical simulation of flows over rotating cylinders of various cross-sectional shapes," AIAA paper 2019-3430, 2019.
[33] Zhang, B., and Liang, C., "High-order numerical simulation of flapping wing for energy harvesting," AIAA paper 2019-3338, 2019.
[34] Zhang, B., Ding, C., and Liang, C., "High-Order Implicit Large-Eddy Simulation of Flow over a Marine Propeller," Computers & Fluids, 2021, p. 104967.
19

[35] Thomas, P. D., and Lombard, C. K., "Geometric conservation law and its application to flow computations on moving grids," AIAA Journal, Vol. 17, 1979, pp. 1030­1037.
[36] Bathe, K.-J., Finite Element Procedures, Klaus-Jurgen Bathe, 2006. [37] Rusanov, V. V., "Calculation of interaction of non-steady shock waves with obstacles," Journal of Computational and
Mathematical Physics USSR, Vol. 1, 1961, pp. 267­279. [38] Spiteri, R. J., and Ruuth, S. J., "A new class of optimal high-order strong-stability-preserving time discretization methods,"
SIAM Journal on Numerical Analysis, Vol. 40, 2002, pp. 469­491. [39] Ruuth, S., "Global optimization of explicit strong-stability-preserving Runge-Kutta methods," Mathematics of Computation,
Vol. 75, No. 253, 2006, pp. 183­207. [40] Fischer, P., and Mullen, J., "Filter-based stabilization of spectral element methods," Comptes Rendus de l'Academie des Sciences
Series I Mathematics, Vol. 332, No. 3, 2001, pp. 265­270. [41] Schulz, C., Letzgus, P., Lutz, T., and Krämer, E., "CFD study on the impact of yawed inflow on loads, power and near wake of a
generic wind turbine," Wind Energy, Vol. 20, No. 2, 2017, pp. 253­268.
20

